---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html">Contribute a project on Hadamard matrices</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="253437332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253437332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253437332">(Sep 15 2021 at 15:50)</a>:</h4>
<p>I am going to PR the definition of Hadamard matrices (and basic results) in my project: <a href="https://github.com/l534zhan/my_project">https://github.com/l534zhan/my_project</a>.<br>
This is the definition currently used there.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">Hadamard_matrix</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">I</span> <span class="n">I</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">one_or_neg_one</span> <span class="o">[]:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="o">(</span><span class="n">H</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">H</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span>
<span class="o">(</span><span class="n">orthogonal_rows</span> <span class="o">[]:</span> <span class="n">H.has_orthogonal_rows</span><span class="o">)</span>
</code></pre></div>
<p>Does anyone suggest changing the definition?</p>



<a name="253437409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253437409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253437409">(Sep 15 2021 at 15:51)</a>:</h4>
<p>I would advise putting that in <a class="stream" data-stream-id="116395" href="/#narrow/stream/116395-maths">#maths</a> so that more people see it.</p>



<a name="253437609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253437609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253437609">(Sep 15 2021 at 15:52)</a>:</h4>
<p>Why do you want to restrict the coefficients to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi></mrow><annotation encoding="application/x-tex">\mathbb{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85556em;vertical-align:-0.16667em;"></span><span class="mord mathbb">Q</span></span></span></span>?</p>



<a name="253438059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438059">(Sep 15 2021 at 15:55)</a>:</h4>
<p>Because <code>Q</code> is easy to work with. I can use <code>Z</code>, but <code>Z</code> will make some following lemmas more complicated as coercions are then needed. Using <code>R</code> will make some lemmas <code>noncomputalbe</code>.</p>



<a name="253438094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438094">(Sep 15 2021 at 15:55)</a>:</h4>
<p>Should I use <code>Z</code>?</p>



<a name="253438116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438116">(Sep 15 2021 at 15:55)</a>:</h4>
<p>Hmm... That sounds wrong.</p>



<a name="253438172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438172">(Sep 15 2021 at 15:55)</a>:</h4>
<p>You shouldn't have to use concrete structures. Is there a PR I can look at?</p>



<a name="253438328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438328">(Sep 15 2021 at 15:56)</a>:</h4>
<p>I have done several closed PRs for this project. The next PR will be the definition.</p>



<a name="253438352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438352">(Sep 15 2021 at 15:56)</a>:</h4>
<p>Indeed, I would be interested in having a look as well (although <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>  will certainly beat me  <span aria-label="racecar" class="emoji emoji-1f3ce" role="img" title="racecar">:racecar:</span> )</p>



<a name="253438369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438369">(Sep 15 2021 at 15:56)</a>:</h4>
<p>The closed PRs are not about Hadamard matrices though.</p>



<a name="253438402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438402">(Sep 15 2021 at 15:57)</a>:</h4>
<p>Then please @ me when your PR is out!</p>



<a name="253438454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438454">(Sep 15 2021 at 15:57)</a>:</h4>
<p>What are the things you want to have a look at?</p>



<a name="253438508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438508">(Sep 15 2021 at 15:57)</a>:</h4>
<p>Well, in general it is strange that to define a matrix with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span> you need to work over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi></mrow><annotation encoding="application/x-tex">\mathbb{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85556em;vertical-align:-0.16667em;"></span><span class="mord mathbb">Q</span></span></span></span>; I would suggest working over a very general type with an instance of <code>1 </code> and <code>-1</code> and only restrict to rings/fields when needed.</p>



<a name="253438599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438599">(Sep 15 2021 at 15:58)</a>:</h4>
<p>What are you using about <code>ℚ</code>? Its <code>ring</code>,<code>field</code>, <code>linear_ordered_field</code> structure?</p>



<a name="253438778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438778">(Sep 15 2021 at 15:59)</a>:</h4>
<p>The file contains the definition and the lemmas is <code>main2.lean</code>. Maybe you can have a look at that file.</p>



<a name="253438801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438801">(Sep 15 2021 at 15:59)</a>:</h4>
<p>Oh yeah, if you really just need the presence of <code>1</code> and <code>-1</code>, you should simply assume <code>has_one</code> and <code>has_neg</code>.</p>



<a name="253438898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253438898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253438898">(Sep 15 2021 at 15:59)</a>:</h4>
<p>That is indeed more general.</p>



<a name="253439178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439178">(Sep 15 2021 at 16:01)</a>:</h4>
<p>For lemmas about the determinants, I guess I need to use a ring or a field.</p>



<a name="253439393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439393">(Sep 15 2021 at 16:01)</a>:</h4>
<p>Because <code>1</code> is by default assumed to be a natural, you'll probably need a lot of type annotations. But these are harmless and you shouldn't take that as a sign that not using <code>ℚ</code> will make you need casts.</p>



<a name="253439474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439474">(Sep 15 2021 at 16:02)</a>:</h4>
<p>A ring would probably be enough, although some things are already true over semi-rings. The good thing is that you can try to put basically <em>no</em> structure and let Lean complain whenever something is needed: it will say that it can't find the correct type instance (for example, if you set your coefficients to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span> it won't like your <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>), and then you can improve things little by little.</p>



<a name="253439573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439573">(Sep 15 2021 at 16:02)</a>:</h4>
<p>Note also that instead of <code>class Hadamard_matrix</code> you likely want <code>structure matrix.is_hadamard</code>.</p>
<p>Using <code>Hadamard_matrix</code> as a typeclass is unlikely to be helpful to you here</p>



<a name="253439586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439586">(Sep 15 2021 at 16:02)</a>:</h4>
<p>Filippo, that's all I'm doing <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span> Don't sell my secrets like that!</p>



<a name="253439733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439733">(Sep 15 2021 at 16:03)</a>:</h4>
<p>OOOPS, sorry <span aria-label="angel" class="emoji emoji-1f47c" role="img" title="angel">:angel:</span> <span aria-label="lol" class="emoji emoji-1f606" role="img" title="lol">:lol:</span></p>



<a name="253439956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253439956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253439956">(Sep 15 2021 at 16:04)</a>:</h4>
<p>So, we will be happier with the more general condition <code>has_one</code> <code>has_neg</code> in the definition?</p>



<a name="253440021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440021">(Sep 15 2021 at 16:05)</a>:</h4>
<p>Cool. I will generalise it!</p>



<a name="253440037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440037">(Sep 15 2021 at 16:05)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.has_orthogonal_rows">docs#matrix.has_orthogonal_rows</a> needs a semiring, right?</p>



<a name="253440145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440145">(Sep 15 2021 at 16:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253439573">said</a>:</p>
<blockquote>
<p>Note also that instead of <code>class Hadamard_matrix</code> you likely want <code>structure matrix.is_hadamard</code>.</p>
<p>Using <code>Hadamard_matrix</code> as a typeclass is unlikely to be helpful to you here</p>
</blockquote>
<p>This is certainly a valid point, but may be you can speculate a bit more to help <span class="user-mention" data-user-id="408694">@Alex Zhang</span> with the difference between the two approaches?</p>



<a name="253440252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440252">(Sep 15 2021 at 16:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253440037">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.has_orthogonal_rows">docs#matrix.has_orthogonal_rows</a> needs a semiring, right?</p>
</blockquote>
<p>Yeah. I think so.</p>



<a name="253440264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440264">(Sep 15 2021 at 16:06)</a>:</h4>
<p>I think perhaps it would be best for Alex to PR what they have right now, so that we can point out where our suggestions make things easier</p>



<a name="253440364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440364">(Sep 15 2021 at 16:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="408694">Alex Zhang</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253440252">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253440037">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.has_orthogonal_rows">docs#matrix.has_orthogonal_rows</a> needs a semiring, right?</p>
</blockquote>
<p>Yeah. I think so.</p>
</blockquote>
<p>Actually it just needs <code>[has_mul α] [add_comm_monoid α]</code>.</p>
<p>In principle you could use <code>[has_mul α] [add_comm_monoid α] [has_neg α] [has_one α]</code>, but I think that's probably ridiculous and you should just assume <code>ring α</code>.</p>



<a name="253440589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440589">(Sep 15 2021 at 16:08)</a>:</h4>
<p>If you do that, please put a TODO next to the <code>variables</code>, in case we later change the hierarchy and a more appropriate typeclass appears.</p>



<a name="253440620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440620">(Sep 15 2021 at 16:08)</a>:</h4>
<p>Yeah. <code>[has_mul α] [add_comm_monoid α] [has_neg α] [has_one α]</code> is the condition, which usually yields at least a semiring a think.</p>



<a name="253440882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440882">(Sep 15 2021 at 16:10)</a>:</h4>
<p>I will relax the conditions the make things more general in the PR (no need to keep <code>Q</code>).</p>



<a name="253440931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253440931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253440931">(Sep 15 2021 at 16:10)</a>:</h4>
<p>The <code>has_neg</code> suggests that you even want a <code>ring</code></p>



<a name="253441048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441048">(Sep 15 2021 at 16:11)</a>:</h4>
<p>right right</p>



<a name="253441084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441084">(Sep 15 2021 at 16:11)</a>:</h4>
<p>At best I could see you wanting to relax to a <code>non_assoc_ring</code> in future (if that ever existed)</p>



<a name="253441220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441220">(Sep 15 2021 at 16:12)</a>:</h4>
<p>That is exactly the thing I was thinking about</p>



<a name="253441492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441492">(Sep 15 2021 at 16:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253440264">said</a>:</p>
<blockquote>
<p>I think perhaps it would be best for Alex to PR what they have right now, so that we can point out where our suggestions make things easier</p>
</blockquote>
<p>Should I keep it as a <code>class</code> or change it to a <code>structure</code>. I don't fully know the effects of doing this.</p>



<a name="253441594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441594">(Sep 15 2021 at 16:14)</a>:</h4>
<p>Leave it as <code>class</code> for the initial PR and I'll add a comment to show you where things get simpler if its a structure</p>



<a name="253441595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441595">(Sep 15 2021 at 16:14)</a>:</h4>
<p>A <code>class</code> is a <code>structure</code> that typeclass inference can use.</p>



<a name="253441650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441650">(Sep 15 2021 at 16:14)</a>:</h4>
<p>But you may as well rename it to <code>is_hadamard</code> now</p>



<a name="253441814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441814">(Sep 15 2021 at 16:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253441595">said</a>:</p>
<blockquote>
<p>A <code>class</code> is a <code>structure</code> that typeclass inference can use.</p>
</blockquote>
<p>Not just that I think. If so, there is no need to remove the tag.</p>



<a name="253441953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253441953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253441953">(Sep 15 2021 at 16:15)</a>:</h4>
<p>Well, Eric is not only proposing to change from <code>class</code> to <code>structure</code>. That's my point.</p>



<a name="253442288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253442288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253442288">(Sep 15 2021 at 16:17)</a>:</h4>
<p>OK, nice. <del>I will do this PR after having my dinner. </del> (I have been caught up with something else.)</p>



<a name="253442712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253442712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253442712">(Sep 15 2021 at 16:19)</a>:</h4>
<p>Thanks a lot for your suggestions!</p>



<a name="253443287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253443287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253443287">(Sep 15 2021 at 16:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="408694">Alex Zhang</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253441814">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253441595">said</a>:</p>
<blockquote>
<p>A <code>class</code> is a <code>structure</code> that typeclass inference can use.</p>
</blockquote>
<p>Not just that I think. If so, there is no need to remove the tag.</p>
</blockquote>
<p>Well, one question you might ask yourself is: would you plan to start a lemma about Hadamard matrices writing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">hadamard_matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">bla</span> <span class="o">:=</span>
</code></pre></div>
<p>or </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">hadamard_matrix</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">bla</span> <span class="o">:=</span>
</code></pre></div>
<p>You will go for <code>structure</code> in the former case and for <code>class</code> in the latter.</p>



<a name="253443488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253443488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253443488">(Sep 15 2021 at 16:23)</a>:</h4>
<p>Yes exactly. To emphasize, this is the difference being bundling and not bundling a Hadamard matrix.</p>



<a name="253443572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253443572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253443572">(Sep 15 2021 at 16:23)</a>:</h4>
<p>in the first case, this info is part of the object. In the second case, it is a distinct proof.</p>



<a name="253443694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253443694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253443694">(Sep 15 2021 at 16:24)</a>:</h4>
<p>No way is better than the other in general, but in that particular case I think it makes sense to leave it unbundled.</p>



<a name="253443813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253443813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253443813">(Sep 15 2021 at 16:25)</a>:</h4>
<p>At any rate, from my own experience, this is quite puzzling at the beginning. The best way (for me) was to develop a feeling using   <code>mathlib</code> rather than dwelling in precise definitions -- but that's just a personal point.</p>



<a name="253444211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444211">(Sep 15 2021 at 16:27)</a>:</h4>
<p><span class="user-mention" data-user-id="408694">@Alex Zhang</span> I can certainly recommend the reading of the beautiful paper  <a href="https://dl.acm.org/doi/10.1145/3372885.3373824">https://dl.acm.org/doi/10.1145/3372885.3373824</a> by the whole <code>mathlib</code> community, if you haven't read that already: it is very useful about this <code>structure</code> vs <code>class</code> debate.</p>



<a name="253444217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444217">(Sep 15 2021 at 16:27)</a>:</h4>
<p>I personally prefer the second one. I would like to just make <code>is_hadamard</code> a "bundled proposition" rather than a bundled structure containing the carrier.</p>



<a name="253444227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444227">(Sep 15 2021 at 16:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300245">Filippo A. E. Nuccio</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253443287">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="408694">Alex Zhang</span> <a href="#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices/near/253441814">said</a>:<br>
e question you might ask yourself is: would you plan to start a lemma about Hadamard matrices writing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">hadamard_matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">bla</span> <span class="o">:=</span>
</code></pre></div>
<p>or </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">hadamard_matrix</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">bla</span> <span class="o">:=</span>
</code></pre></div>
<p>You will go for <code>structure</code> in the former case and for <code>class</code> in the latter.</p>
</blockquote>
<p>This is not the remark I was making</p>



<a name="253444323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444323">(Sep 15 2021 at 16:27)</a>:</h4>
<p>I think <code>is_hadarmard</code> should remain unbundled like <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.is_diag">docs#matrix.is_diag</a>, unless we come up with a convincing use case</p>



<a name="253444393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444393">(Sep 15 2021 at 16:28)</a>:</h4>
<p>And since <code>is_diag</code> isn't a typeclass, <code>is_hadamard</code> probably shouldn't be either</p>



<a name="253444453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444453">(Sep 15 2021 at 16:28)</a>:</h4>
<p>You mean that it will probably never happen that Lean will need to infer that a certain matrix is a Hadamard one?</p>



<a name="253444473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444473">(Sep 15 2021 at 16:28)</a>:</h4>
<p>I agree with Eric, it should be an unbundled <code>structure</code>, not <code>class</code>.</p>
<p>The rule of thumb I use for typeclasses is that they are <em>type</em>classes: they basically only work well when their parameters are <em>types</em>. (My intuition suggests this is basically because the logic used to find instances only contains <code>∧</code> and <code>→</code>, not <code>=</code>, so once you get (non-definitional) equalities, you enter a world of suffering.)</p>



<a name="253444724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253444724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253444724">(Sep 15 2021 at 16:30)</a>:</h4>
<p>For example, if you have somethingl ike <code>is_hadamard (diagonal (a * b))</code> then you can't actually rewrite <code>a * b</code> to <code>b * a</code> because the typeclass system can't guess that <code>is_hadamard (diagonal (a * b))</code> also works for <code>is_hadamard (diagonal (b * a))</code>.</p>



<a name="253445006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253445006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253445006">(Sep 15 2021 at 16:31)</a>:</h4>
<p>If you need an equality between two <code>Type</code>s, then you are already screwed for other reasons, so typeclasses don't create extra pain :P</p>



<a name="253520652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253520652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253520652">(Sep 16 2021 at 02:51)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="113489" href="/#narrow/stream/113489-new-members/topic/Contribute.20a.20project.20on.20Hadamard.20matrices">#new members &gt; Contribute a project on Hadamard matrices</a> by <span class="user-mention silent" data-user-id="110087">Scott Morrison</span></p>



<a name="253520940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253520940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253520940">(Sep 16 2021 at 02:56)</a>:</h4>
<p>An alternative take on Anne's rule of thumb is that if you're using typeclass search as a <em>prover</em>, then you're probably doing it wrong. You don't want to be telling typeclass search "please go prove this matrix is a Hadamard matrix".</p>



<a name="253549699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253549699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253549699">(Sep 16 2021 at 09:02)</a>:</h4>
<p>This looks very cool, great work!</p>
<p>I think it's fine to define the property "H is a Hadamard matrix" for H a matrix over any ring, but when you actually develop the theory there's no reason to consider general rings. You get exactly the same Hadamard matrices over any ring of characteristic zero. Also, why can't you work directly with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>? Do you need division somewhere?</p>
<p>I think you should also consider bundling the matrix and the proof, and work with the bundled version when doing things like the Sylvester construction. It should lead to more concise code and you can write some coercions to e.g. view a bundled Hadamard matrix as a function. Fundamentally, a Hadamard matrix is a combinatorial gadget. It's great that you can represent a Hadamard matrix as, well, a matrix, because it lets you do algebraic manipulations. But morally this is just a representation. Bundling is more in line with this view.</p>
<p>Some more practical advice: you can use <a href="https://leanprover-community.github.io/mathlib_docs/find/fin_prod_fin_equiv">docs#fin_prod_fin_equiv</a> to define <code>fin_Kronecker</code>. You might also like to define something like <code>exists_Hadamard_of_order (n : ℕ) : nonempty (Hadamard_matrix (fin n))</code>. Then you can write Hadamard's conjecture as <code>def Hadamard_conjecture : Prop := ∀ k, exists_Hadamard_of_order (4 * k)</code>. And your results can be neatly summarized as saying something about <code>exists_Hadamard_of_order n</code> for different <code>n</code>, which helps the reader understand exactly what has been proved.</p>



<a name="253568409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253568409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253568409">(Sep 16 2021 at 11:50)</a>:</h4>
<blockquote>
<p>Do you need division somewhere?</p>
</blockquote>
<p>You need division to state results about the inverse of a hadamard matrix, although perhaps those aren't that interesting.</p>



<a name="253574600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253574600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253574600">(Sep 16 2021 at 12:41)</a>:</h4>
<p>Ok, that makes sense. I think the inverse itself isn't very interesting, but you want some way to go from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi><mo>=</mo><mi>n</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">AB = nI</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>A</mi><mo>=</mo><mi>n</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">BA = nI</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> when <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> isn't a zero-divisor. There's an argument for this that works in a general <code>comm_ring</code> (using <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.mul_adjugate">docs#matrix.mul_adjugate</a>), but maybe it's more comfortable to work in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi></mrow><annotation encoding="application/x-tex">\mathbb Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85556em;vertical-align:-0.16667em;"></span><span class="mord mathbb">Q</span></span></span></span>.</p>



<a name="253576274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253576274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253576274">(Sep 16 2021 at 12:54)</a>:</h4>
<p>I'm afraid you're rowing in the wrong direction, David. In an ideal world, we would never refer to concrete structures but merely to their properties (possibly even when these properties identify the concrete structure up to isomorphism, like being an canonically ordered bottom commutative monoid with successors for ℕ). I personally changed a few results about ℚ that were in mathlib to apply to any <code>field</code>, because coercing was a pain.</p>



<a name="253576541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253576541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253576541">(Sep 16 2021 at 12:56)</a>:</h4>
<p>Explicit your assumptions by instances instead of using concrete structures. If your proof requires more structure than the optimal proof, fine, because this will be noticeable by the instances.</p>



<a name="253576911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253576911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253576911">(Sep 16 2021 at 12:59)</a>:</h4>
<p>The current pain is ℝ. It has many properties that we didn't bother yet to reflect in the typeclass system, like being a <code>complete_linear_ordered_field</code> (I guess?), for example.</p>



<a name="253577051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253577051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253577051">(Sep 16 2021 at 13:00)</a>:</h4>
<p>And I mean, the entire convexity refactor I'm undertaking now is precisely to eradicate concrete structures from <code>analysis.convex.*</code></p>



<a name="253577301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253577301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253577301">(Sep 16 2021 at 13:01)</a>:</h4>
<p>Even when the structure is unique up to isomorphism, it's nice to abstract it away. For example, we don't have Jensen's inequality for concave functions even though it's just the dual of the convex one because ℝ is hardcoded in it, so we can't replace with it <code>order_dual ℝ</code>.</p>



<a name="253594222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253594222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253594222">(Sep 16 2021 at 14:49)</a>:</h4>
<p>I'm all in favour of generalisation and abstraction. It's great that you generalise convexity for example, since it makes sense to talk about it over different fields. But this situation is more like <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.choose">docs#nat.choose</a>. Should <code>nat.choose</code> take values in an arbitrary semiring instead of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span>? Certainly the definition makes sense, and you can still prove properties about it. But once you have the nat-version you can map it to any semiring, so what is really the benefit?</p>



<a name="253599221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253599221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253599221">(Sep 16 2021 at 15:21)</a>:</h4>
<p>Well, the reason here is that you know <code>n.choose k</code> is a natural, and this definition reflects that without needing further arguments. But reducing the number of arguments as such comes at the cost of having to work with <code>nat.cast</code> all over the place as soon as you leave <code>ℕ</code>. In that particular case, I think it's a fine cost to pay. For Hadamard matrices, I'm very circonspect.</p>



<a name="253599497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/253599497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#253599497">(Sep 16 2021 at 15:23)</a>:</h4>
<p>If anything, it makes a lot more sense to consider <code>n.choose k</code> mod 2 than to consider a Hadamard matrix over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mn>2</mn><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}/2\mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mord">/2</span><span class="mord mathbb">Z</span></span></span></span></p>



<a name="255208996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Contribute%20a%20project%20on%20Hadamard%20matrices/near/255208996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Contribute.20a.20project.20on.20Hadamard.20matrices.html#255208996">(Sep 28 2021 at 12:39)</a>:</h4>
<p>I left away for travelling, and I am back now and can continue the PRs!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>