---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/seminormed.20group.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html">seminormed group</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="230753439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230753439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230753439">(Mar 17 2021 at 19:35)</a>:</h4>
<p>I recently introduced in mathlib <code>pseudo_emetric_space</code> and <code>pseudo_metric_space</code>, with the basic API (essentially I kept what worked out of the box for metric spaces). The next step we need for the LTE is <code>semi_normed_group</code>  and I started working on it. (I know, pseudometric but seminormed... this seems the standard terminology).</p>
<p>The natural definition is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">semi_normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">has_norm</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">pseudo_metric_space</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">dist_eq</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">norm</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">))</span>
</code></pre></div>
<p>Just replace <code>metric_space</code> with <code>pseudo_metric_space</code> in the current definition. But how to define <code>normed_group</code>? One possibility is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">semi_normed_group</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">norm_eq_zero_if</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div>
<p>and then putting an instance of a <code>metric_space</code> on a <code>normed_group</code>. I started with this approach but then I realized I had to modify by hand several construction about <code>normed_group</code>. For example for subgroups we currently have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">add_subgroup.normed_group</span> <span class="o">{</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">add_subgroup</span> <span class="n">E</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">normed_group</span> <span class="n">s</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">norm</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">norm</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">E</span><span class="o">),</span>
  <span class="n">dist_eq</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">dist_eq_norm</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">E</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>
<p>and it becomes something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">add_subgroup.normed_group</span> <span class="o">{</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">add_subgroup</span> <span class="n">E</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">normed_group</span> <span class="n">s</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">norm_eq_zero_if</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">coe_norm_subgroup</span><span class="o">,</span> <span class="n">norm_eq_zero</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">subtype.eq</span> <span class="n">h</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="bp">..</span><span class="n">add_subgroup.semi_normed_group</span> <span class="n">s</span> <span class="o">}</span>
</code></pre></div>
<p>The proof is not hard, but is really different (because we are not proving the same thing...). If I have to do this for the bunch of proof in <code>analysis/normed_space/basic</code> no problem, but I am wondering if this is the good approach.</p>



<a name="230753700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230753700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230753700">(Mar 17 2021 at 19:37)</a>:</h4>
<p>I am asking  because for <code>pseudo_metric</code> this didn't happen, the definition of a metric space is clearly a pseudometric space such that <code>d(x,y)=  0 → x = y</code>, and this becomes literally the previous definition</p>



<a name="230754450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754450">(Mar 17 2021 at 19:43)</a>:</h4>
<p>Does it work to say,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">semi_normed_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">metric_space</span> <span class="n">α</span>
</code></pre></div>



<a name="230754531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754531">(Mar 17 2021 at 19:43)</a>:</h4>
<p>I ask because this is how linear maps (<a href="https://leanprover-community.github.io/mathlib_docs/find/linear_map">docs#linear_map</a>) are done, just combining several existing structures with no new fields:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">linear_map</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">M₂</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">)</span>
  <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M₂</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M₂</span><span class="o">]</span>
  <span class="kd">extends</span> <span class="n">add_hom</span> <span class="n">M</span> <span class="n">M₂</span><span class="o">,</span> <span class="n">M</span> <span class="bp">→</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">M₂</span>
</code></pre></div>



<a name="230754675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754675">(Mar 17 2021 at 19:45)</a>:</h4>
<p>I would hope that Heather's suggestion works.</p>



<a name="230754696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754696">(Mar 17 2021 at 19:45)</a>:</h4>
<p>You will need <code>set_option old_structure_cmd true</code> for that.</p>



<a name="230754748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754748">(Mar 17 2021 at 19:45)</a>:</h4>
<p>It says</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="bp">'</span><span class="kd">structure</span><span class="bp">'</span> <span class="n">header</span><span class="o">,</span> <span class="n">field</span> <span class="bp">'</span><span class="n">to_pseudo_metric_space'</span> <span class="k">from</span> <span class="bp">'</span><span class="n">metric_space'</span> <span class="n">has</span> <span class="n">already</span> <span class="n">been</span> <span class="n">declared</span>
</code></pre></div>



<a name="230754832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754832">(Mar 17 2021 at 19:46)</a>:</h4>
<p>that's exactly why you need to put that set_option thing before you try it</p>



<a name="230754904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754904">(Mar 17 2021 at 19:46)</a>:</h4>
<p>Ops, I answered before seeing Johan's answer</p>



<a name="230754910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230754910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230754910">(Mar 17 2021 at 19:46)</a>:</h4>
<p>But it only works if <code>semi_normed_group</code> is also an old structure</p>



<a name="230755009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230755009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230755009">(Mar 17 2021 at 19:47)</a>:</h4>
<p>and some of these things aren't, and my instinctive fix (just make them old structures) is...a bad idea? Or just something we can fix with automation when we all finally move to the new structure command?</p>



<a name="230755467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230755467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230755467">(Mar 17 2021 at 19:51)</a>:</h4>
<p>The definition gives no error, but the first result for <code>normed_group</code> is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- Construct a normed group from a translation invariant distance -/</span>
<span class="kd">def</span> <span class="n">normed_group.of_add_dist</span> <span class="o">[</span><span class="n">has_norm</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">metric_space</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">(</span><span class="n">H1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">:</span><span class="n">α</span><span class="o">,</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="bp">=</span> <span class="n">dist</span> <span class="n">x</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">≤</span> <span class="n">dist</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">z</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">))</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">dist_eq</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">H1</span><span class="o">,</span> <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">sub_eq_add_neg</span><span class="o">,</span> <span class="bp">←</span> <span class="n">add_right_neg</span> <span class="n">y</span><span class="o">],</span> <span class="n">apply</span> <span class="n">H2</span> <span class="o">},</span>
    <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">H2</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="n">y</span><span class="o">)</span> <span class="mi">0</span> <span class="n">y</span><span class="o">,</span> <span class="n">rwa</span> <span class="o">[</span><span class="n">sub_add_cancel</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span> <span class="o">}</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>
<p>and Lean says</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="kd">structure</span> <span class="n">value</span> <span class="o">{</span><span class="bp">...</span><span class="o">},</span> <span class="n">expected</span> <span class="n">type</span> <span class="n">is</span> <span class="n">known</span><span class="o">,</span> <span class="n">but</span> <span class="n">it</span> <span class="n">is</span> <span class="n">not</span> <span class="n">a</span> <span class="kd">structure</span>
  <span class="n">normed_group</span> <span class="n">α</span>
</code></pre></div>



<a name="230755720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230755720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230755720">(Mar 17 2021 at 19:53)</a>:</h4>
<p>I don't know if this is possible, but I am trying to minimize the amount of code to be rewritten (and no problem if it is quite a lot, I just want to be sure I am doing this in the correct way)</p>



<a name="230755841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230755841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230755841">(Mar 17 2021 at 19:54)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> what does <code>#print normed_group</code> look like? Before and after your change.</p>



<a name="230755875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230755875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230755875">(Mar 17 2021 at 19:54)</a>:</h4>
<p>Ideally, it would look the same (up to permutation of the fields)</p>



<a name="230756037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756037">(Mar 17 2021 at 19:55)</a>:</h4>
<p>In current mathlib:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[class]</span>
<span class="kd">structure</span> <span class="n">normed_group</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u_5</span>
<span class="n">fields</span><span class="o">:</span>
<span class="n">normed_group.to_has_norm</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="n">α</span><span class="o">],</span> <span class="n">has_norm</span> <span class="n">α</span>
<span class="n">normed_group.to_add_comm_group</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="n">α</span><span class="o">],</span> <span class="n">add_comm_group</span> <span class="n">α</span>
<span class="n">normed_group.to_metric_space</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="n">α</span><span class="o">],</span> <span class="n">metric_space</span> <span class="n">α</span>
<span class="n">normed_group.dist_eq</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">∥</span>
</code></pre></div>



<a name="230756191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756191">(Mar 17 2021 at 19:57)</a>:</h4>
<p>You can also keep the current mathlib definition, and register by hand an instance from <code>normed_group</code> to <code>semi_normed_group</code>.</p>



<a name="230756252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756252">(Mar 17 2021 at 19:57)</a>:</h4>
<p>Using  Heather's idea</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">normed_group</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u_5</span>
<span class="n">constructors</span><span class="o">:</span>
<span class="n">normed_group.mk</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_5</span><span class="o">}</span> <span class="o">[</span><span class="n">_to_has_norm</span> <span class="o">:</span> <span class="n">has_norm</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">_to_add_comm_group</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span>
<span class="o">[</span><span class="n">_to_pseudo_metric_space</span> <span class="o">:</span> <span class="n">pseudo_metric_space</span> <span class="n">α</span><span class="o">],</span>
  <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">∥</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="o">)</span> <span class="bp">→</span> <span class="n">normed_group</span> <span class="n">α</span>
</code></pre></div>



<a name="230756270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756270">(Mar 17 2021 at 19:57)</a>:</h4>
<p>Hmm... not at all the same thing</p>



<a name="230756400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756400">(Mar 17 2021 at 19:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> is seminormed group, I allow the norm to vanish on a nonzero element (but the algebraic structure is still a group)</p>



<a name="230756480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756480">(Mar 17 2021 at 19:59)</a>:</h4>
<p>Yes, so a normed group is in particular a seminormed_group, so there is an instance in this direction.</p>



<a name="230756594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756594">(Mar 17 2021 at 20:00)</a>:</h4>
<p>It can be automatic if <code>normed_group</code> is defined by extending <code>semi_normed_group</code>, or registered manually otherwise.</p>



<a name="230756680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756680">(Mar 17 2021 at 20:00)</a>:</h4>
<p>Probably that is the best thing to do</p>



<a name="230756707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756707">(Mar 17 2021 at 20:00)</a>:</h4>
<p>Yes, this what I did at the beginning</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">semi_normed_group</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">norm_eq_zero_if</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div>



<a name="230756761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756761">(Mar 17 2021 at 20:00)</a>:</h4>
<p>No, that's not what Sebastien means</p>



<a name="230756796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756796">(Mar 17 2021 at 20:00)</a>:</h4>
<p>He means that you don't change the definition at all.</p>



<a name="230756852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756852">(Mar 17 2021 at 20:01)</a>:</h4>
<p>Ah, I see!</p>



<a name="230756866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230756866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230756866">(Mar 17 2021 at 20:01)</a>:</h4>
<p>But directly after it, you write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span> <span class="n">semi_normed_group</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">_</span>
</code></pre></div>



<a name="230757494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230757494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230757494">(Mar 17 2021 at 20:05)</a>:</h4>
<p>OK, I have to see if this really works with all the various result, but it seems what I was looking for</p>



<a name="230773491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230773491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230773491">(Mar 17 2021 at 21:54)</a>:</h4>
<p>It seems to work better! But I think I am missing something regarding the product. Currently I have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- seminormed group instance on the product of two seminormed groups, using the sup norm. -/</span>
<span class="kd">instance</span> <span class="n">prod.semi_normed_group</span> <span class="o">:</span> <span class="n">semi_normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">norm</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">max</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span><span class="o">,</span>
  <span class="n">dist_eq</span> <span class="o">:=</span> <span class="k">assume</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">),</span>
    <span class="k">show</span> <span class="n">max</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.1</span> <span class="n">y.1</span><span class="o">)</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.2</span> <span class="n">y.2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">max</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">∥</span><span class="o">),</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">dist_eq_norm</span><span class="o">]</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">prod.norm_def</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="bp">=</span> <span class="o">(</span><span class="n">max</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">prod.nnnorm_def</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">nnnorm</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">max</span> <span class="o">(</span><span class="n">nnnorm</span> <span class="n">x.1</span><span class="o">)</span> <span class="o">(</span><span class="n">nnnorm</span> <span class="n">x.2</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">x.norm_def</span><span class="o">,</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">coe_nnnorm</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span> <span class="n">exact_mod_cast</span> <span class="n">this</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">norm_fst_le</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">≤</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="o">:=</span>
<span class="n">le_max_left</span> <span class="n">_</span> <span class="n">_</span>

<span class="kd">lemma</span> <span class="n">norm_snd_le</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span> <span class="bp">≤</span> <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="o">:=</span>
<span class="n">le_max_right</span> <span class="n">_</span> <span class="n">_</span>

<span class="kd">lemma</span> <span class="n">norm_prod_le_iff</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">:</span>
  <span class="bp">∥</span><span class="n">x</span><span class="bp">∥</span> <span class="bp">≤</span> <span class="n">r</span> <span class="bp">↔</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">≤</span> <span class="n">r</span> <span class="bp">∧</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span> <span class="bp">≤</span> <span class="n">r</span> <span class="o">:=</span>
<span class="n">max_le_iff</span>
</code></pre></div>
<p>for the product of <code>semi_normed_group</code> and then</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- normed group instance on the product of two normed groups, using the sup norm. -/</span>
<span class="kd">instance</span> <span class="n">prod.normed_group</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">norm</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">max</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span><span class="o">,</span>
  <span class="n">dist_eq</span> <span class="o">:=</span> <span class="k">assume</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">),</span>
    <span class="k">show</span> <span class="n">max</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.1</span> <span class="n">y.1</span><span class="o">)</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.2</span> <span class="n">y.2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">max</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">∥</span><span class="o">),</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">dist_eq_norm</span><span class="o">]</span> <span class="o">}</span>
</code></pre></div>
<p>for the product of  <code>normed_group</code>. So for example on the product of two normed group there are now two instances of seminormed group (coming from the normed groups product and from the product of the induced semigroups)... is this a problem?</p>
<p>I tried to compile and I have small but strange errors, for example in <code>analysis/normed_space/add_torsor.lean</code> now</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">uniform_continuous_vadd</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">V</span> <span class="bp">×</span> <span class="n">P</span><span class="o">,</span> <span class="n">x.1</span> <span class="bp">+ᵥ</span> <span class="n">x.2</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">lipschitz_with.prod_fst.vadd</span> <span class="n">lipschitz_with.prod_snd</span><span class="o">)</span><span class="bp">.</span><span class="n">uniform_continuous</span>
</code></pre></div>
<p>doesn't work, it says</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">lipschitz_with.prod_fst.vadd</span>
<span class="n">term</span>
  <span class="n">lipschitz_with.prod_fst</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">lipschitz_with</span> <span class="mi">1</span> <span class="n">prod.fst</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">lipschitz_with</span> <span class="bp">?</span><span class="n">m_5</span> <span class="bp">?</span><span class="n">m_6</span>
</code></pre></div>
<p>But </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">uniform_continuous_vadd</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">V</span> <span class="bp">×</span> <span class="n">P</span><span class="o">,</span> <span class="n">x.1</span> <span class="bp">+ᵥ</span> <span class="n">x.2</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">((</span><span class="bp">@</span><span class="n">lipschitz_with.prod_fst</span> <span class="n">V</span> <span class="n">P</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">vadd</span> <span class="n">lipschitz_with.prod_snd</span><span class="o">)</span><span class="bp">.</span><span class="n">uniform_continuous</span>
</code></pre></div>
<p>works</p>



<a name="230773898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230773898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230773898">(Mar 17 2021 at 21:57)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> if the two instances are defeq, it's not a problem</p>



<a name="230774041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230774041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230774041">(Mar 17 2021 at 21:58)</a>:</h4>
<p>You can check this by</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">seminormed_group.prod</span> <span class="n">X</span> <span class="n">Y</span> <span class="o">(</span><span class="bp">@</span><span class="n">normed_group.to_seminormed_group_</span><span class="o">)</span> <span class="n">etc</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">normed_group.to_seminormed_group</span> <span class="o">(</span><span class="n">X</span> <span class="bp">\</span><span class="n">times</span> <span class="n">Y</span><span class="o">)</span> <span class="n">_</span> <span class="o">:=</span>
<span class="n">rfl</span>
</code></pre></div>



<a name="230776746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230776746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230776746">(Mar 17 2021 at 22:10)</a>:</h4>
<p>This works... I have to investigate a little what is going on...</p>



<a name="230788371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/230788371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#230788371">(Mar 17 2021 at 23:53)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/6746">#6746</a>  if someone is insterested</p>



<a name="231246717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/231246717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#231246717">(Mar 21 2021 at 22:54)</a>:</h4>
<p>Does someone have an idea why in <a href="https://github.com/leanprover-community/mathlib/issues/6746">#6746</a>  I got some weird problems related to products? In <code>analysis/normed_space/basic</code> I have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- seminormed group instance on the product of two seminormed groups, using the sup norm. -/</span>
<span class="kd">instance</span> <span class="n">prod.semi_normed_group</span> <span class="o">:</span> <span class="n">semi_normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">norm</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">max</span> <span class="bp">∥</span><span class="n">x.1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="n">x.2</span><span class="bp">∥</span><span class="o">,</span>
  <span class="n">dist_eq</span> <span class="o">:=</span> <span class="k">assume</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">),</span>
    <span class="k">show</span> <span class="n">max</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.1</span> <span class="n">y.1</span><span class="o">)</span> <span class="o">(</span><span class="n">dist</span> <span class="n">x.2</span> <span class="n">y.2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">max</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="bp">∥</span> <span class="bp">∥</span><span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">∥</span><span class="o">),</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">dist_eq_norm</span><span class="o">]</span> <span class="o">}</span>
</code></pre></div>
<p>and</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- normed group instance on the product of two normed groups, using the sup norm. -/</span>
<span class="kd">instance</span> <span class="n">prod.normed_group</span> <span class="o">:</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span> <span class="bp">..</span><span class="n">prod.semi_normed_group</span> <span class="o">}</span>
</code></pre></div>
<p>Everything works in that file, but for example in <code>analysis/calculus/fderiv</code> suddenly</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">has_strict_fderiv_at_fst</span> <span class="o">:</span> <span class="n">has_strict_fderiv_at</span> <span class="n">prod.fst</span> <span class="o">(</span><span class="n">fst</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="n">F</span><span class="o">)</span> <span class="n">p</span> <span class="o">:=</span>
</code></pre></div>
<p>doesn't work anymore, while</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">has_strict_fderiv_at_fst</span> <span class="o">:</span> <span class="n">has_strict_fderiv_at</span> <span class="o">(</span><span class="n">fst</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">fst</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="n">F</span><span class="o">)</span> <span class="n">p</span> <span class="o">:=</span>
</code></pre></div>
<p>is OK. This is not a big deal, but while working of the continuation of the PR (introducing <code>semi_normed_group_hom</code> and similar things) I see this weird behavior several times, so I think I did something wrong.</p>



<a name="231246825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/231246825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#231246825">(Mar 21 2021 at 22:56)</a>:</h4>
<p>The definition of <code>semi_normed_group</code> and of <code>normed_group</code> is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- A seminormed group is an additive group endowed with a norm for which `dist x y = ∥x - y∥`</span>
<span class="sd">defines a pseudometric space structure. -/</span>
<span class="kd">class</span> <span class="n">semi_normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">has_norm</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">pseudo_metric_space</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">dist_eq</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">norm</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">))</span>

<span class="sd">/-- A normed group is an additive group endowed with a norm for which `dist x y = ∥x - y∥` defines</span>
<span class="sd">a metric space structure. -/</span>
<span class="kd">class</span> <span class="n">normed_group</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">has_norm</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">metric_space</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">dist_eq</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">dist</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">norm</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">))</span>

<span class="sd">/-- A normed group is a seminormed group. -/</span>
<span class="kd">@[priority 100]</span> <span class="c1">-- see Note [lower instance priority]</span>
<span class="kd">instance</span> <span class="n">semi_normed_group_of_normed_group</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">semi_normed_group</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">dist_eq</span> <span class="o">:=</span> <span class="n">normed_group.dist_eq</span> <span class="o">}</span>
</code></pre></div>



<a name="260027388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260027388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260027388">(Nov 02 2021 at 17:11)</a>:</h4>
<p>Eh! I just read the <a href="https://leanprover-community.github.io/blog/posts/contributions-to-mathlib-from-lte-about-normed-groups/">blogpost</a> and the first thing I thought is that we have <a href="https://leanprover-community.github.io/mathlib_docs/find/seminorm">docs#seminorm</a>. Should we link <a href="https://leanprover-community.github.io/mathlib_docs/find/semi_normed_group">docs#semi_normed_group</a> and <code>seminorm</code> somehow?</p>



<a name="260028000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260028000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260028000">(Nov 02 2021 at 17:16)</a>:</h4>
<p>Probably doesn't hurt. There can also be glue with <a href="https://leanprover-community.github.io/mathlib_docs/find/valuation">docs#valuation</a> I guess?</p>



<a name="260033562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260033562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260033562">(Nov 02 2021 at 17:54)</a>:</h4>
<p>Ah, I didn't know that! Was it already there? <code>normed_group</code> uses <code>has_norm</code>, that has no assumption.</p>



<a name="260034077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260034077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260034077">(Nov 02 2021 at 17:57)</a>:</h4>
<p>Yeah, <span class="user-mention silent" data-user-id="132889">Jean Lo</span> did that back in 2019. To be fair though, this is more of a convex analysis thing.</p>



<a name="260034323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260034323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260034323">(Nov 02 2021 at 17:59)</a>:</h4>
<p>Maybe there's a way to generalize both approaches?</p>



<a name="260034380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260034380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260034380">(Nov 02 2021 at 17:59)</a>:</h4>
<p>Note that I'm adding <em>a lot</em> to <code>analysis.seminorm</code> in <a href="https://github.com/leanprover-community/mathlib/issues/9097">#9097</a></p>



<a name="260034705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260034705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260034705">(Nov 02 2021 at 18:02)</a>:</h4>
<p>I think the main difference is that <code>semi_normed_group</code> is about a group with a fixed seminorm, while <code>seminorm</code> is more to manipulate several seminorms on a given <del>group</del> module.</p>



<a name="260036531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/seminormed%20group/near/260036531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/seminormed.20group.html#260036531">(Nov 02 2021 at 18:17)</a>:</h4>
<p>Ah OK, it's not exactly the same. It surely doesn't hurt to link the two notion, but I think that <code>semi_normed_group</code> will not be used a lot.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>