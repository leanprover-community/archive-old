---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html">`simp` lemmas for `matrix.mul` vs `has_mul.mul`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="187248955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187248955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187248955">(Feb 03 2020 at 10:22)</a>:</h4>
<p>The <code>simp</code> lemma <code>matrix.mul_eq_mul : M * N = matrix.mul M N</code> seems to imply that the canonical representation for matrix multiplication is <code>matrix.mul</code>. I'm seeing a lot of <code>simp</code> lemmas using <code>has_mul.mul</code>, e.g. <code>matrix.det_mul : det (M * N) = det M * det N</code>. Is there a reason for this, or should I standardise these lemmas to use <code>matrix.mul</code>?</p>



<a name="187250060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187250060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187250060">(Feb 03 2020 at 10:36)</a>:</h4>
<p>Good question.<br>
I'm not sure if I like it that <code>matrix.mul</code> is the standard simp form. For square matrices <code>M * N</code> is certainly better, because it unlocks a boatload of simp-lemmas from algebra.</p>



<a name="187260120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187260120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187260120">(Feb 03 2020 at 13:12)</a>:</h4>
<p>On the other hand, a lot of these lemmas (I estimate from quickly looking over some relevant files) will hold for rectangular matrices as well, so duplication seems unavoidable either way.</p>



<a name="187260556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187260556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187260556">(Feb 03 2020 at 13:18)</a>:</h4>
<p>I guess the true generalisation will be to state everything in terms of composition of morphisms in a category, which has its own API problems...</p>



<a name="187270326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187270326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187270326">(Feb 03 2020 at 15:11)</a>:</h4>
<p>Doesn't <code>has_mul.mul</code> force the matrices to be the same size (and therefore square)?</p>



<a name="187270347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187270347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187270347">(Feb 03 2020 at 15:11)</a>:</h4>
<p>It does.</p>



<a name="187271509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187271509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187271509">(Feb 03 2020 at 15:24)</a>:</h4>
<p>So having simp turn <code>matrix.mul</code> to <code>*</code>, which could only fire for square matrices, wouldn't be a good idea. If A is m x m and B is m x m and C is m x n then <code>(A.mul B).mul C = A.mul (B.mul C)</code> might first turn <code>A.mul B</code> into <code>A * B</code>, then get stuck unless there is a simp lemma for <code>(A * B).mul C</code>.</p>



<a name="187272044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187272044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187272044">(Feb 03 2020 at 15:29)</a>:</h4>
<p>So maybe we shouldn't have a simp lemma in either direction, and let the user decide.</p>



<a name="187305248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187305248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187305248">(Feb 03 2020 at 21:18)</a>:</h4>
<p>You want to use <code>commute</code> or something but <code>simp</code> is messing up your <code>*</code>?</p>



<a name="187341888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187341888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187341888">(Feb 04 2020 at 09:26)</a>:</h4>
<p>The specific motivation for the question was that I want to define a few extra <code>simp</code> lemmas and was unsure how to state them, but I've encountered before that <code>matrix.det_mul</code> didn't fire because <code>matrix.mul_eq_mul</code> removed the <code>*</code>s.</p>



<a name="187441312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%60simp%60%20lemmas%20for%20%60matrix.mul%60%20vs%20%60has_mul.mul%60/near/187441312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.60simp.60.20lemmas.20for.20.60matrix.2Emul.60.20vs.20.60has_mul.2Emul.60.html#187441312">(Feb 05 2020 at 10:29)</a>:</h4>
<p>Since the discussion petered out with only the conclusion that rewriting <code>matrix.mul</code> to <code>has_mul</code> is not what we want, <a href="https://github.com/leanprover-community/mathlib/pull/1959" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/1959">I've made a PR with the changes I suggested</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>