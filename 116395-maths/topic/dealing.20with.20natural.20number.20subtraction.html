---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html">dealing with natural number subtraction</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="189231276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189231276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189231276">(Feb 27 2020 at 16:47)</a>:</h4>
<p>What's the best way to solve this goal?  y-x is a subtraction of natural numbers and I need to convince Lean that by h : x &lt; y, it coincides with the ring subtraction.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">int</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">universe</span> <span class="n">u</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">classical</span><span class="bp">.</span><span class="n">prop_decidable</span>

<span class="n">def</span> <span class="n">ex1</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">z</span>

<span class="n">def</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span>
<span class="n">def</span> <span class="n">odd</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span>

<span class="kn">lemma</span> <span class="n">even_or_odd</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">or</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">even_plus_even_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">and</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">even</span> <span class="n">m</span><span class="o">))</span> <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">even_minus_even_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">even</span> <span class="n">m</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">))</span>
  <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">odd_minus_odd_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">odd</span> <span class="n">m</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">))</span>
  <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">mul_cancel</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span><span class="bp">*</span><span class="n">b</span> <span class="bp">=</span> <span class="n">a</span><span class="bp">*</span><span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">halving_first</span> <span class="o">(</span><span class="n">n</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="mi">2</span><span class="bp">*</span><span class="n">n</span> <span class="bp">=</span> <span class="n">x</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span><span class="err">^</span><span class="mi">2</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span><span class="n">a</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">,</span> <span class="bp">∃</span><span class="n">b</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">,</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">a</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">b</span><span class="err">^</span><span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="k">have</span> <span class="n">zero_lt_two</span> <span class="o">:=</span> <span class="n">lt_trans</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">lt_succ_self</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">lt_succ_self</span> <span class="mi">1</span><span class="o">),</span>
<span class="k">have</span> <span class="n">xeo</span> <span class="o">:=</span> <span class="n">even_or_odd</span> <span class="n">x</span><span class="o">,</span>
<span class="k">have</span> <span class="n">yeo</span> <span class="o">:=</span> <span class="n">even_or_odd</span> <span class="n">y</span><span class="o">,</span>
<span class="n">cases</span> <span class="n">xeo</span> <span class="k">with</span> <span class="n">x_even</span> <span class="n">x_odd</span><span class="o">,</span>
<span class="n">cases</span> <span class="n">yeo</span> <span class="k">with</span> <span class="n">y_even</span> <span class="n">y_odd</span><span class="o">,</span>
<span class="k">have</span> <span class="n">sum_even</span> <span class="o">:=</span> <span class="n">even_plus_even_is_even</span> <span class="n">y</span> <span class="n">x</span> <span class="bp">⟨</span><span class="n">y_even</span><span class="o">,</span> <span class="n">x_even</span><span class="bp">⟩</span><span class="o">,</span>
<span class="k">have</span> <span class="n">diff_even</span> <span class="o">:=</span> <span class="n">even_minus_even_is_even</span> <span class="n">y</span> <span class="n">x</span> <span class="bp">⟨</span><span class="n">y_even</span><span class="o">,</span> <span class="n">x_even</span><span class="o">,</span> <span class="n">le_of_lt</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">even</span> <span class="n">at</span> <span class="n">sum_even</span><span class="o">,</span>
<span class="n">cases</span> <span class="n">sum_even</span> <span class="k">with</span> <span class="n">sum&#39;</span> <span class="n">sum_ev</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">even</span> <span class="n">at</span> <span class="n">diff_even</span><span class="o">,</span>
<span class="n">cases</span> <span class="n">diff_even</span> <span class="k">with</span> <span class="n">diff&#39;</span> <span class="n">diff_ev</span><span class="o">,</span>
<span class="n">use</span> <span class="n">sum&#39;</span><span class="o">,</span>
<span class="n">use</span> <span class="n">diff&#39;</span><span class="o">,</span>
<span class="k">have</span> <span class="n">claim</span> <span class="o">:</span> <span class="mi">2</span><span class="bp">*</span><span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="o">(</span><span class="n">sum&#39;</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">diff&#39;</span><span class="err">^</span><span class="mi">2</span><span class="o">),</span>
<span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
<span class="k">have</span> <span class="n">claim&#39;</span> <span class="o">:</span> <span class="mi">2</span><span class="bp">*</span><span class="o">(</span><span class="n">x</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="n">y</span><span class="err">^</span><span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">4</span><span class="bp">*</span><span class="o">(</span><span class="n">sum&#39;</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="n">diff&#39;</span><span class="err">^</span><span class="mi">2</span><span class="o">),</span>
<span class="k">have</span> <span class="n">thing</span> <span class="o">:</span> <span class="mi">4</span><span class="bp">*</span><span class="o">(</span><span class="n">sum&#39;</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="n">diff&#39;</span><span class="err">^</span><span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">sum&#39;</span><span class="o">)</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">diff&#39;</span><span class="o">)</span><span class="err">^</span><span class="mi">2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">thing</span><span class="o">,</span>
<span class="n">rw</span> <span class="o">(</span><span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="n">sum_ev</span><span class="o">),</span>
<span class="n">rw</span> <span class="o">(</span><span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="n">diff_ev</span><span class="o">),</span>
<span class="c1">-- ring doesn&#39;t work due the subtraction of natural numbers.</span>
<span class="c1">--   (Which takes n - m to be zero if n &lt; m.)</span>
<span class="c1">-- How to convince Lean that y-x is ring subtraction as a consequence of h?</span>
<span class="kn">end</span>
</pre></div>



<a name="189231684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189231684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189231684">(Feb 27 2020 at 16:51)</a>:</h4>
<p>Why not try to write a separate lemma which states exactly what you want to use at this point?</p>



<a name="189231718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189231718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189231718">(Feb 27 2020 at 16:52)</a>:</h4>
<p>(Any Lean proof longer than 10 lines needs refactoring into smaller chunks. :-)</p>



<a name="189232237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189232237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189232237">(Feb 27 2020 at 16:56)</a>:</h4>
<p>The <code>extract_goal</code> tactic is really useful for this.</p>



<a name="189235097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189235097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189235097">(Feb 27 2020 at 17:28)</a>:</h4>
<p>I'm trying it to no avail...</p>



<a name="189235179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189235179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189235179">(Feb 27 2020 at 17:29)</a>:</h4>
<p>See prelim below</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">int</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">universe</span> <span class="n">u</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">classical</span><span class="bp">.</span><span class="n">prop_decidable</span>

<span class="n">def</span> <span class="n">ex1</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">z</span>

<span class="n">def</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span>
<span class="n">def</span> <span class="n">odd</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span>

<span class="kn">lemma</span> <span class="n">even_or_odd</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">or</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">even_plus_even_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">and</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">even</span> <span class="n">m</span><span class="o">))</span> <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">even_minus_even_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">even</span> <span class="n">n</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">even</span> <span class="n">m</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">))</span>
  <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">odd_minus_odd_is_even</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">odd</span> <span class="n">m</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">))</span>
  <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">mul_cancel</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span><span class="bp">*</span><span class="n">b</span> <span class="bp">=</span> <span class="n">a</span><span class="bp">*</span><span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">prelim</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="k">have</span> <span class="n">lem</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="bp">*</span><span class="n">y</span><span class="o">,</span>
<span class="k">have</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">zero_le</span> <span class="n">x</span><span class="o">,</span>
<span class="k">have</span> <span class="n">thing</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">mul_le_mul_left</span> <span class="n">x</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">h</span><span class="o">),</span>
<span class="k">have</span> <span class="n">thing&#39;</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">mul_lt_mul_of_pos_right</span> <span class="n">h</span> <span class="o">(</span><span class="n">lt_of_le_of_lt</span> <span class="n">a</span> <span class="n">h</span><span class="o">),</span>
<span class="n">exact</span> <span class="n">lt_of_le_of_lt</span> <span class="n">thing</span> <span class="n">thing&#39;</span><span class="o">,</span>

<span class="k">have</span> <span class="n">claim</span> <span class="o">:</span> <span class="o">(</span><span class="n">y</span><span class="bp">-</span><span class="n">x</span><span class="o">)</span><span class="err">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="n">x</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span><span class="err">^</span><span class="mi">2</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">*</span><span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_two</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_two</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_two</span><span class="o">,</span>
<span class="k">have</span> <span class="n">thing</span> <span class="o">:</span> <span class="n">y</span><span class="bp">*</span><span class="n">y</span> <span class="bp">=</span> <span class="n">y</span><span class="bp">*</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">*</span><span class="n">x</span> <span class="bp">+</span> <span class="n">x</span><span class="bp">*</span><span class="n">x</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span>
  <span class="n">exact</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_add_cancel</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">lem</span><span class="o">))</span>
<span class="o">},</span>
<span class="n">rw</span> <span class="n">add_comm</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">thing</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">add_assoc</span><span class="o">,</span>
<span class="c1">-- what the heck should I do next?</span>
<span class="kn">end</span>
</pre></div>



<a name="189235807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189235807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189235807">(Feb 27 2020 at 17:36)</a>:</h4>
<p>You definitely want to take advantage of the fact that this would be trivial to prove if you were in <code>int</code> rather than <code>nat</code>: you could just use <code>ring</code>. So the strategy should be:</p>
<ul>
<li>Use injectivity of the map from <code>nat</code> to <code>int</code> to show that it suffices to prove this after coercing both sides to <code>int</code></li>
<li>Push the coercion from <code>nat</code> to <code>int</code> inwards (hopefully <code>push_cast</code> will assist you here)</li>
<li>Possibly have to do some explicit work using the hypothesis <code>h</code> to push the coercion over the subtraction (but ideally <code>push_cast</code> will help you even here)</li>
<li>Call <code>ring</code> (or even better, state the result in <code>int</code> as a separate lemma, proved with <code>by ring</code>, and apply that lemma)</li>
</ul>



<a name="189236038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236038">(Feb 27 2020 at 17:38)</a>:</h4>
<p>For the first step, I would type in:</p>
<div class="codehilite"><pre><span></span>import tactic.basic

example (x y : ℕ) (h : (x : ℤ) = (y : ℤ)) : x = y := by library_search
</pre></div>



<a name="189236054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236054">(Feb 27 2020 at 17:39)</a>:</h4>
<p>to learn what the name of the lemma about injectivity is</p>



<a name="189236067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236067">(Feb 27 2020 at 17:39)</a>:</h4>
<p>it says: <code>int.of_nat.inj</code></p>



<a name="189236198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236198">(Feb 27 2020 at 17:40)</a>:</h4>
<p>Unfortunately <code>push_cast</code> does the wrong thing at the next step...</p>



<a name="189236529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236529">(Feb 27 2020 at 17:43)</a>:</h4>
<p>Here's another approach:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">prelim</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">cases</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">exists_eq_add_of_lt</span> <span class="n">h</span><span class="o">)</span> <span class="k">with</span> <span class="n">w</span> <span class="n">hw</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">hw</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">w</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">w</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">omega</span><span class="o">),</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>


<p>but this is a dirty hack -- what Scott is suggesting is morally the correct thing to do I think.</p>



<a name="189236613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236613">(Feb 27 2020 at 17:44)</a>:</h4>
<p>I'm just observing that because the subtractions are not too bad, you can remove them without too much trouble (replace y with x+w+1) and then <code>ring</code> works anyway.</p>



<a name="189236730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236730">(Feb 27 2020 at 17:45)</a>:</h4>
<p>It turns out <code>library_search</code> leads you down the wrong track here. It suggests <code>int.of_nat.inj</code>, but this introduces the explicit function <code>int.of_nat</code>, which then doesn't play well with <code>push_cast</code>. Using <code>suggest</code> instead of <code>library_search</code> identifies as the 3rd suggestion the lemma <code>int.coe_nat_inj</code>, which is better.</p>



<a name="189236912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236912">(Feb 27 2020 at 17:47)</a>:</h4>
<p>Then</p>
<div class="codehilite"><pre><span></span>example (x y : ℕ) (h : x &lt; y) :
  2 * (x ^ 2 + y ^ 2) = (y + x) ^ 2 + (y - x) ^ 2 :=
begin
  apply int.coe_nat_inj,
  push_cast,
end
</pre></div>


<p>gives us the goal</p>
<div class="codehilite"><pre><span></span>(↑0 + 1 + 1) * (↑(x ^ 2) + ↑(y ^ 2)) = ↑((y + x) ^ 2) + ↑((y - x) ^ 2)
</pre></div>


<p>which ... suggests that we haven't correctly tagged lemmas with <code>push_cast</code>! It's lame that <code>↑2</code> has been converted to <code>↑0 + 1 + 1</code>, and it's lame that <code>↑(x ^ 2)</code> hasn't been converted to <code>(↑x) ^ 2</code>.</p>



<a name="189236917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189236917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189236917">(Feb 27 2020 at 17:47)</a>:</h4>
<p>To get the <code>norm_cast</code> approach to work I'd like to have <code>x &lt;= y -&gt; ↑y - ↑x = ↑(y - x)</code>. It should be all downhill from there.</p>



<a name="189237117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237117">(Feb 27 2020 at 17:49)</a>:</h4>
<p>Scott -- I've started with the int result and am trying to get back to the nat result with <code>norm_cast</code>. You're going the other way. </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">prelim</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">this</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="c1">-- this involves ↑y - ↑x which can&#39;t be normcasted down to ↑(y - x)</span>
<span class="kn">end</span>
</pre></div>



<a name="189237131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237131">(Feb 27 2020 at 17:49)</a>:</h4>
<p>There's a big <code>norm_cast</code> PR in progress <a href="https://github.com/leanprover-community/mathlib/pull/1103" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/1103">here</a>.</p>



<a name="189237309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237309">(Feb 27 2020 at 17:51)</a>:</h4>
<p>Where does one obtain a <code>has_pow ℤ ℕ</code> instance from??</p>



<a name="189237328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237328">(Feb 27 2020 at 17:51)</a>:</h4>
<p>algebra.group_power?</p>



<a name="189237370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237370">(Feb 27 2020 at 17:52)</a>:</h4>
<p>That's where I usually look...</p>



<a name="189237395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237395">(Feb 27 2020 at 17:52)</a>:</h4>
<p><span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span>, what's the state of that PR? Do you know if anyone is looking after it?</p>



<a name="189237429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237429">(Feb 27 2020 at 17:52)</a>:</h4>
<p>I would ask <span class="user-mention" data-user-id="213273">@Paul-Nicolas Madelaine</span> and <span class="user-mention" data-user-id="110596">@Rob Lewis</span>.</p>



<a name="189237582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237582">(Feb 27 2020 at 17:54)</a>:</h4>
<p>Still waiting on input from Paul-Nicolas.</p>



<a name="189237979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189237979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189237979">(Feb 27 2020 at 17:58)</a>:</h4>
<p>OK so doing it the other way works fine once you use <code>library_search</code> (thank you thank you thank you <span class="user-mention" data-user-id="110087">@Scott Morrison</span> <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span> <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span> <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span> ) to figure out that bit about y - x :-)</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">prelim</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">this</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">y</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">int</span><span class="bp">.</span><span class="n">coe_nat_sub</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">h</span><span class="o">)</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">this</span>
<span class="kn">end</span>
</pre></div>



<a name="189238048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189238048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189238048">(Feb 27 2020 at 17:59)</a>:</h4>
<p>It's interesting that <code>norm_cast</code> worked really well and <code>push_cast</code> did all sorts of crazy things.</p>



<a name="189238438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189238438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189238438">(Feb 27 2020 at 18:02)</a>:</h4>
<p>Here's my version, with the "finding the right lemmas" cruft at the top left in, for pedagogical purposes:</p>
<div class="codehilite"><pre><span></span>import tactic.norm_cast
import tactic.ring
import algebra.group_power

example (x y : ℕ) (h : (x : ℤ) = (y : ℤ)) : x = y := by suggest

example (x : ℕ) : ((x^2 : ℕ) : ℤ) = (x : ℤ)^2 := by library_search

-- This attribute is missing, and should be added to mathlib
attribute [push_cast] int.coe_nat_pow

example (x y : ℕ) : ((x - y : ℕ) : ℤ) = (x : ℤ) - (y : ℤ) := by suggest
-- down the list we find `int.coe_nat_sub`

#print int.coe_nat_sub

example (x y : ℕ) (h : x ≤ y) :
  2 * (x ^ 2 + y ^ 2) = (y + x) ^ 2 + (y - x) ^ 2 :=
begin
  apply int.coe_nat_inj,
  push_cast,
  rw int.coe_nat_sub h, -- it would be nice if `push_cast` managed this itself.
  ring,                 -- the output is a bit wonky here
  simp,
end
</pre></div>



<a name="189238726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189238726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189238726">(Feb 27 2020 at 18:05)</a>:</h4>
<p>Oh so it does come out nice in the end.</p>



<a name="189238836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189238836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189238836">(Feb 27 2020 at 18:06)</a>:</h4>
<p>Related: <code>library_search</code> suggested <code>int.coe_nat_sub.reversed</code> for me, which I was surprised by; you can <code>#check int.coe_nat_sub.reversed</code> to see what it says (and compare with <code>int.coe_nat_sub</code>). But if you right click and go to definition then something surprising happens!</p>



<a name="189238925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189238925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189238925">(Feb 27 2020 at 18:07)</a>:</h4>
<p>Why use <code>suggest</code> when you can use <code>library_search</code>? Oh -- because your lemma isn't even true!</p>



<a name="189239677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189239677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189239677">(Feb 27 2020 at 18:14)</a>:</h4>
<p>Thanks very much, Scott and Kevin.  I followed Scott's latest approach</p>



<a name="189248088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189248088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189248088">(Feb 27 2020 at 19:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span>, can you point me to an example of copying priorities? I want priorities on <code>move_cast</code> lemmas to to copied to the synthesised <code>push_cast</code> lemmas.</p>



<a name="189248310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189248310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189248310">(Feb 27 2020 at 19:35)</a>:</h4>
<p>Scratch that.</p>



<a name="189250798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189250798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189250798">(Feb 27 2020 at 19:59)</a>:</h4>
<p>I'm no expert but I did notice once that there seems to be a mixture of whether lemmas of the form <code>((0 : a) : b)  = 0</code> are marked as <code>squash_cast</code> or `elim_cast. Likewise with 1 instead of zero. Can that be problematic?</p>



<a name="189251629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189251629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189251629">(Feb 27 2020 at 20:09)</a>:</h4>
<p>All this will be obsolete when the new <code>norm_cast</code> will land.</p>



<a name="189281192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189281192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189281192">(Feb 28 2020 at 03:38)</a>:</h4>
<p>Just a basic question, if a is an integer, and one is given the hypothesis 0 ≤ a, how do you get the natural number whose integer cast equals a?</p>



<a name="189281357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189281357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189281357">(Feb 28 2020 at 03:43)</a>:</h4>
<p>There is a theorem <code>int.eq_coe_of_zero_le</code> that gives an existential, or you can use <code>int.to_nat</code> or <code>int.nat_abs</code></p>



<a name="189281837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189281837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189281837">(Feb 28 2020 at 03:56)</a>:</h4>
<p>Thanks</p>



<a name="189282060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282060">(Feb 28 2020 at 04:03)</a>:</h4>
<p>What's the best way to get from a &gt; 0 and b &lt; 0 to a*b &lt; 0 in the <em>integers</em>?  I looked in int\basic.lean and found nothing that does anything like this</p>



<a name="189282102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282102">(Feb 28 2020 at 04:04)</a>:</h4>
<p>That's a general theorem about ordered rings</p>



<a name="189282106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282106">(Feb 28 2020 at 04:04)</a>:</h4>
<p>Yeah, so is there a Lean command for it?</p>



<a name="189282122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282122">(Feb 28 2020 at 04:04)</a>:</h4>
<p>it looks like you want a <code>mul</code> to be <code>neg</code> given <code>pos</code> and <code>neg</code>. Let me look that up...</p>



<a name="189282130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282130">(Feb 28 2020 at 04:05)</a>:</h4>
<p>oh hey <code>mul_neg_of_pos_of_neg</code> :)</p>



<a name="189282253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189282253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189282253">(Feb 28 2020 at 04:08)</a>:</h4>
<p>Mario's method is an excellent one, but there's also</p>
<div class="codehilite"><pre><span></span>example (a b : ℤ) (ha : 0 &lt; a) (hb : b &lt; 0) : a * b &lt; 0 := by library_search
</pre></div>


<p>(which reports the same answer)</p>



<a name="189283440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189283440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicholas McConnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189283440">(Feb 28 2020 at 04:41)</a>:</h4>
<p>Okay, I confess, I should try using "by library_search" more often</p>



<a name="189283496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189283496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189283496">(Feb 28 2020 at 04:42)</a>:</h4>
<p>(Unfortunately you do need to have the right imports open, which sometimes is a deal-breaker if you really don't know yet what you're looking for. The advantage of Mario's method is that if you can guess at least a fragment of the name, you can search for it across all files in mathlib.)</p>



<a name="189284921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189284921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189284921">(Feb 28 2020 at 05:22)</a>:</h4>
<p>By the way, it may not have been obvious, but my first comment "that's a general theorem about ordered rings" was actually a search clue. When looking for an algebraic lemma, you should ask yourself if it is a theorem about general algebraic structures of some kind like rings or fields, or if they are particular to the specific set you are working over (e.g. things about natural number subtraction). If they are general, they will usually be in the root namespace (and be in one of the <code>algebra/</code> files), and if they are specific then they will be in <code>data.int.basic</code> or <code>data.nat.basic</code> or similar and will be in that type's namespace.</p>



<a name="189284945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189284945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189284945">(Feb 28 2020 at 05:23)</a>:</h4>
<p><span class="user-mention" data-user-id="263857">@Nicholas McConnell</span> It seems that you want to know about the <code>lift</code> tactic.</p>



<a name="189284995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189284995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189284995">(Feb 28 2020 at 05:24)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/master/docs/tactics.md#lift" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/docs/tactics.md#lift">https://github.com/leanprover-community/mathlib/blob/master/docs/tactics.md#lift</a></p>



<a name="189285022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189285022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189285022">(Feb 28 2020 at 05:25)</a>:</h4>
<p>From the docs:</p>
<blockquote>
<p>If <code>n : ℤ</code> and <code>hn : n ≥ 0</code> then the tactic <code>lift n to ℕ using hn</code> creates a new constant of type <code>ℕ</code>, also named <code>n</code> and replaces all occurrences of the old variable <code>(n : ℤ)</code> with <code>↑n</code> (where <code>n</code> in the new variable). It will remove <code>n</code> and <code>hn</code> from the context. </p>
</blockquote>



<a name="189285610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189285610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Ashworth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189285610">(Feb 28 2020 at 05:41)</a>:</h4>
<p>&lt;_&lt; I would've thought this would be named descend since natural numbers are a subset of the integers</p>



<a name="189285654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189285654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Ashworth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189285654">(Feb 28 2020 at 05:42)</a>:</h4>
<p>I don't understand when a thing is a lift or when it is a descent, probably</p>



<a name="189285664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189285664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189285664">(Feb 28 2020 at 05:43)</a>:</h4>
<p>That's because there are two very much conflicting naming traditions</p>



<a name="189286353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189286353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189286353">(Feb 28 2020 at 06:04)</a>:</h4>
<p>Does the lift tactic in fact let you go both ways? (my reading of the documentation is yes but I thought of typing this question before I thought of typing code into a lean interpreter)</p>



<a name="189286430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189286430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189286430">(Feb 28 2020 at 06:06)</a>:</h4>
<p>I don't think so, depending on what you mean by "both ways". The <code>lift</code> tactic allows you to take a variable from a "superset" and produce an element of the "subset" with the same name</p>



<a name="189286503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189286503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189286503">(Feb 28 2020 at 06:08)</a>:</h4>
<p>I think you have correctly inferred what I meant by "both ways" and answered my question</p>



<a name="189286520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189286520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189286520">(Feb 28 2020 at 06:09)</a>:</h4>
<p>I guess the other way is just coercion</p>



<a name="189286522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dealing%20with%20natural%20number%20subtraction/near/189286522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dealing.20with.20natural.20number.20subtraction.html#189286522">(Feb 28 2020 at 06:09)</a>:</h4>
<p>If you have an element of the subset and want an element of the superset, you don't need the tactic, because you can just use the coe</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>