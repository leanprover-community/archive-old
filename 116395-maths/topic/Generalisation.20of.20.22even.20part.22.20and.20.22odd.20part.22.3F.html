---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html">Generalisation of "even part" and "odd part"?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="290228980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290228980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290228980">(Jul 20 2022 at 12:39)</a>:</h4>
<p>If we have <code>n = 2^k * n'</code> where <code>n'</code> is odd, we might call <code>2^k</code> and <code>n'</code> the "even part" and "odd part" of <code>n</code> respectively.  Is there standard terminology for the generalisation of this to arbitrary prime <code>p</code> (when we have <code>n = p^k * n'</code> for <code>n'</code> not divisible by <code>p</code>)?</p>



<a name="290229144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290229144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290229144">(Jul 20 2022 at 12:41)</a>:</h4>
<p>The <code>k</code> is called the <code>p</code>-adic valuation of <code>n</code>.</p>



<a name="290229978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290229978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290229978">(Jul 20 2022 at 12:50)</a>:</h4>
<p>For context, I'm interested in proving generalisations of the lemmas at the beginning of <span class="user-mention" data-user-id="282271">@Bolton Bailey</span> and <span class="user-mention" data-user-id="479997">@Sean Golinski</span>'s <a href="https://github.com/leanprover-community/mathlib/pull/12254">#12254</a></p>



<a name="290231284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290231284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290231284">(Jul 20 2022 at 13:03)</a>:</h4>
<p>in some ways this is just <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.pow_factorization_dvd">docs#nat.pow_factorization_dvd</a></p>



<a name="290232280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290232280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290232280">(Jul 20 2022 at 13:12)</a>:</h4>
<p>Indeed, the idea would be to re-phrase lemmas like <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.pow_factorization_dvd">docs#nat.pow_factorization_dvd</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.prime.pow_dvd_iff_dvd_pow_factorization">docs#nat.prime.pow_dvd_iff_dvd_pow_factorization</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.not_dvd_div_pow_factorization">docs#nat.not_dvd_div_pow_factorization</a>, and also to prove general versions of <code>mul_two_power_part</code> and <code>mul_odd_part</code> from <a href="https://github.com/leanprover-community/mathlib/pull/12254">#12254</a>.  So it would be nice to have some more concise notation for <code>p ^ n.factorization p</code> and <code>n / p ^ n.factorization p</code>.</p>



<a name="290232883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290232883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290232883">(Jul 20 2022 at 13:17)</a>:</h4>
<p>I would use <code>nat.pow_vp</code> or <code>nat.inv_vp_norm</code> (<code>nat.inv_val_norm</code>?) for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><msub><mi>v</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">p^{v_p(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>, but I am not aware if there is a standard name for this object.</p>



<a name="290621821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290621821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290621821">(Jul 23 2022 at 16:30)</a>:</h4>
<p>I'm having a basic difficulty in getting this to work as I'd like.  A simplified <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.factorization.basic</span>

<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">@[reducible]</span>
<span class="kd">def</span> <span class="n">even_part</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n.factorization</span> <span class="mi">2</span>

<span class="kd">lemma</span> <span class="n">pow_factorization_dvd</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">even_part</span> <span class="n">n</span> <span class="bp">∣</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">even_part</span><span class="o">],</span>  <span class="c1">-- if this is commented out, the next line fails</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">factors_count_eq</span><span class="o">],</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>I'd like to be able to write lemmas in terms of <code>even_part</code> (or, in reality, in terms of the generalisation to arbitrary <code>p</code>), but in a way that makes this name transparent to Lean.  I thought making the definition <code>reducible</code> would do this, but the above <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> shows that it doesn't: when the goal is <code>even_part n ∣ n </code>, <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.factors_count_eq">docs#nat.factors_count_eq</a> can't find a match for <code>n.factorization p</code>.</p>
<p>I've also tried changing the <code>@[reducible] def</code> to <code>abbreviation</code>, but that also doesn't work.  Is there any way to get what I want?</p>



<a name="290621967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290621967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290621967">(Jul 23 2022 at 16:34)</a>:</h4>
<p>Specifically, what I want is to be able to write <code>even_part n</code> in theorem statements etc. and for Lean to treat this as if I'd written <code>2 ^ n.factorization 2</code>.  But I don't want to have to explicitly unfold or rewrite <code>even_part</code>, or make a <code>simp</code> lemma that automatically rewrites it away, since that voids the purpose of having the notation.</p>



<a name="290622152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290622152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290622152">(Jul 23 2022 at 16:39)</a>:</h4>
<p>Can you use <code>notation</code>?</p>



<a name="290622335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290622335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290622335">(Jul 23 2022 at 16:42)</a>:</h4>
<p>Ah, yes, <code>notation `even_part` n := 2 ^ (nat.factorization n 2)</code> works!  Thanks!</p>



<a name="290622601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290622601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290622601">(Jul 23 2022 at 16:48)</a>:</h4>
<p>Oh, except that it immediately gets rewritten to <code>2 ^ (nat.factorization n 2)</code> in the goal of the lemma, which I was hoping to avoid.</p>



<a name="290622815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290622815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290622815">(Jul 23 2022 at 16:53)</a>:</h4>
<p>That's strange, normally notation is also used in the goal view.</p>



<a name="290622962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290622962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290622962">(Jul 23 2022 at 16:56)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.factorization.basic</span>

<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">notation</span> <span class="bp">`</span><span class="n">even_part</span><span class="bp">`</span> <span class="n">n</span> <span class="o">:=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="o">(</span><span class="n">nat.factorization</span> <span class="n">n</span> <span class="mi">2</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">pow_factorization_dvd'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">even_part</span> <span class="n">n</span><span class="o">)</span> <span class="bp">∣</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- At this point the goal is ` 2 ^ (n.factorization) 2 ∣ n`</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">factors_count_eq</span><span class="o">],</span>  <span class="c1">-- and hence this rewrite works</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290623895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290623895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290623895">(Jul 23 2022 at 17:14)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/nat.factorization">docs#nat.factorization</a> gives a <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp">docs#finsupp</a>, so there's a <code>has_coe_to_fun</code> coercion in there. I've found that pretty printing notation that involves a coercion like that tends to be unreliable.</p>



<a name="290624922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290624922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290624922">(Jul 23 2022 at 17:35)</a>:</h4>
<p>Not sure if it's relevant to what you're doing, but I did some work with the even and odd parts of factorisation over here: <a href="https://github.com/Ruben-VandeVelde/flt/blob/1c4d172fa4ab02ff70da13e384b11b019ad4b58a/src/odd_prime_or_four.lean">https://github.com/Ruben-VandeVelde/flt/blob/1c4d172fa4ab02ff70da13e384b11b019ad4b58a/src/odd_prime_or_four.lean</a></p>



<a name="290626440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290626440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290626440">(Jul 23 2022 at 18:14)</a>:</h4>
<p>Ok, perhaps I might have to accept that any notation I define for this will be unfolded in the goal view.  But I guess it would still be useful to have it to simplify lemma statements.</p>



<a name="290627407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290627407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290627407">(Jul 23 2022 at 18:39)</a>:</h4>
<p>So how do I generalise from <code>even_part</code> to a function of two arguments?  If I write the following, I get a <code>λ</code> in the goal state which blocks the <code>rw</code>.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.factorization.basic</span>
<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">notation</span> <span class="bp">`</span><span class="n">padic_part</span><span class="bp">`</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">n</span> <span class="n">p</span><span class="o">,</span> <span class="n">p</span> <span class="bp">^</span> <span class="o">(</span><span class="n">nat.factorization</span> <span class="n">n</span> <span class="n">p</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">pow_factorization_dvd</span> <span class="o">(</span><span class="n">n</span> <span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">padic_part</span> <span class="n">n</span> <span class="n">p</span><span class="o">)</span> <span class="bp">∣</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- The goal state here is `(λ (n p : ℕ), p ^ (n.factorization) p) n p ∣ n`</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">factors_count_eq</span><span class="o">],</span>  <span class="c1">-- and so this rewrite fails</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290627425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290627425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290627425">(Jul 23 2022 at 18:39)</a>:</h4>
<p>(Sorry, I'm aware that these are very elementary questions, but I can't find answers in the various documentation I've searched through.)</p>



<a name="290629047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290629047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290629047">(Jul 23 2022 at 19:19)</a>:</h4>
<p>The p-adic valuation is also known as "ord":</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.factorization</span>
<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">notation</span> <span class="bp">`</span><span class="n">ord</span><span class="o">[</span><span class="bp">`</span> <span class="n">p</span> <span class="bp">`</span><span class="o">]</span><span class="bp">`</span> <span class="n">n</span><span class="o">:</span><span class="n">max</span> <span class="o">:=</span> <span class="n">p</span> <span class="bp">^</span> <span class="o">(</span><span class="n">nat.factorization</span> <span class="n">n</span> <span class="n">p</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">pow_factorization_dvd</span> <span class="o">(</span><span class="n">n</span> <span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">:</span> <span class="n">ord</span><span class="o">[</span><span class="n">p</span><span class="o">]</span> <span class="n">n</span> <span class="bp">∣</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- The goal state here is `(λ (n p : ℕ), p ^ (n.factorization) p) n p ∣ n`</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">factors_count_eq</span><span class="o">],</span>  <span class="c1">-- rewrite succeeds</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290629208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290629208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290629208">(Jul 23 2022 at 19:23)</a>:</h4>
<p>The <code>max</code> precedence makes it so <code>ord[p]</code> is as if it were function application. One weakness of this notation is that it <em>must</em> be applied otherwise it's a parse error. But you can still write <code>λ n, ord[2] n</code>.</p>



<a name="290629348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290629348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290629348">(Jul 23 2022 at 19:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> <a href="#narrow/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F/near/290626440">said</a>:</p>
<blockquote>
<p>Ok, perhaps I might have to accept that any notation I define for this will be unfolded in the goal view.</p>
</blockquote>
<p>I hope it'll be fixed someday, so maybe it's fine if we pretend for now that it does work?</p>



<a name="290630472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290630472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290630472">(Jul 23 2022 at 19:54)</a>:</h4>
<p>Fantastic, thanks, that works nicely</p>



<a name="290630557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290630557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290630557">(Jul 23 2022 at 19:57)</a>:</h4>
<p>One odd detail is that when I put the cursor over <code>ord</code> in the document, the popup is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">has_pow.pow</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">self</span> <span class="o">:</span> <span class="n">has_pow</span> <span class="n">α</span> <span class="n">β</span><span class="o">],</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span>
<span class="c1">-------</span>
<span class="n">n.factorization</span> <span class="n">is</span> <span class="n">the</span> <span class="n">finitely</span> <span class="n">supported</span> <span class="n">function</span> <span class="n">ℕ</span> <span class="bp">→₀</span> <span class="n">ℕ</span> <span class="n">mapping</span> <span class="n">each</span> <span class="n">prime</span> <span class="n">factor</span> <span class="n">of</span> <span class="n">n</span> <span class="n">to</span> <span class="n">its</span> <span class="n">multiplicity</span> <span class="k">in</span> <span class="n">n.</span>
</code></pre></div>
<p>Is this a bug?</p>



<a name="290630936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290630936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290630936">(Jul 23 2022 at 20:07)</a>:</h4>
<p>Also, can anyone suggest a suitable name for <code>n / ord[p] n</code>, the generalisation of "odd part"?   I've provisionally called it <code>coord[p] n</code>, but that's not a good name because of the clash with <em>coordinates</em>.</p>



<a name="290630987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290630987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290630987">(Jul 23 2022 at 20:08)</a>:</h4>
<p>(I'm open to the answer that this should just be spelled <code>n / ord[p] n</code> and not given its own notation.  But it might still be good to have a name for it for use in lemma names.)</p>



<a name="290685571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290685571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290685571">(Jul 24 2022 at 15:22)</a>:</h4>
<p><span class="user-mention" data-user-id="422543">@Stuart Presnell</span> Sorry, I'm not sure what I was thinking, but <code>ord[p] n</code> should be <code>nat.factorization n p</code>.  Maybe <code>ord_proj[p] n</code> for the projection onto the <code>p</code> part and <code>ord_compl[p] n</code> for the projection onto the "orthogonal complement"?</p>



<a name="290697904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290697904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290697904">(Jul 24 2022 at 20:18)</a>:</h4>
<p>Yes, I was wondering about that when I came back to look at it again this morning.  Thanks for the suggestions!</p>



<a name="290795180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290795180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290795180">(Jul 25 2022 at 17:54)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/15589">#15589</a><br>
Thanks to everyone for your help</p>



<a name="290934088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290934088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Ang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290934088">(Jul 26 2022 at 18:10)</a>:</h4>
<p>Just curious: is it not possible to reuse the code in src/number_theory/padics/padic_val.lean ?</p>



<a name="290934909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290934909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290934909">(Jul 26 2022 at 18:16)</a>:</h4>
<p>I see the p-adic valuation in there (which I think should be the same as <code>nat.factorization</code>, though the definition is different), but I'm not sure there's the p-part of a number</p>



<a name="290990662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Generalisation%20of%20%22even%20part%22%20and%20%22odd%20part%22%3F/near/290990662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Generalisation.20of.20.22even.20part.22.20and.20.22odd.20part.22.3F.html#290990662">(Jul 27 2022 at 05:38)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/nat.factorization">docs#nat.factorization</a> is defined as <code>padic_val_nat p n</code> for <code>p.prime</code> (and zero otherwise), in the form of a finsupp <code>ℕ →₀ ℕ</code> to use the extensive finsupp API.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>