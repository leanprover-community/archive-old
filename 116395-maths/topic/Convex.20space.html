---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Convex.20space.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html">Convex space</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="256866525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256866525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256866525">(Oct 09 2021 at 12:27)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span>, at least the <code>prod</code> instances work perfectly!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.prod</span>
<span class="kn">import</span> <span class="n">linear_algebra.affine_space.basic</span>

<span class="n">open_locale</span> <span class="n">affine</span>

<span class="kd">variables</span> <span class="o">{</span><span class="bp">𝕜</span> <span class="n">V</span> <span class="n">V₁</span> <span class="n">V₂</span> <span class="n">E</span> <span class="n">E₁</span> <span class="n">E₂</span> <span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">Vi</span> <span class="n">Ei</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">,</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">variables</span> <span class="o">(</span><span class="bp">𝕜</span> <span class="n">E</span><span class="o">)</span>

<span class="kd">class</span> <span class="n">convex_space</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">segment_map</span> <span class="o">:</span> <span class="bp">𝕜</span> <span class="bp">→</span> <span class="bp">𝕜</span> <span class="bp">→</span> <span class="n">E</span> <span class="bp">→</span> <span class="n">E</span> <span class="bp">→</span> <span class="n">E</span><span class="o">)</span>

<span class="kn">section</span> <span class="n">prod</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">convex_space</span> <span class="bp">𝕜</span> <span class="n">E₁</span><span class="o">]</span> <span class="o">[</span><span class="n">convex_space</span> <span class="bp">𝕜</span> <span class="n">E₂</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">convex_space</span> <span class="bp">𝕜</span> <span class="o">(</span><span class="n">E₁</span> <span class="bp">×</span> <span class="n">E₂</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">segment_map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">convex_space.segment_map</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x.1</span> <span class="n">y.1</span><span class="o">,</span> <span class="n">convex_space.segment_map</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x.2</span> <span class="n">y.2</span><span class="o">⟩,</span>
<span class="kd">end</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">prod</span>

<span class="kn">section</span> <span class="n">pi</span>
<span class="kd">variables</span> <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">convex_space</span> <span class="o">(</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">Ei</span> <span class="n">i</span><span class="o">)]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">convex_space</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">,</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">,</span> <span class="n">Ei</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">segment_map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">convex_space.segment_map</span> <span class="o">(</span><span class="n">a</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="n">i</span><span class="o">)</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">pi</span>

<span class="kd">variables</span> <span class="o">{</span><span class="bp">𝕜</span> <span class="n">E</span><span class="o">}</span>

<span class="kn">section</span> <span class="n">affine</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">affine_space</span> <span class="n">V</span> <span class="n">E</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V₁</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">V₁</span><span class="o">]</span> <span class="o">[</span><span class="n">affine_space</span> <span class="n">V₁</span> <span class="n">E₁</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V₂</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">V₂</span><span class="o">]</span> <span class="o">[</span><span class="n">affine_space</span> <span class="n">V₂</span> <span class="n">E₂</span><span class="o">]</span>
  <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">ring</span> <span class="o">(</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">Vi</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">module</span> <span class="o">(</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">Vi</span> <span class="n">i</span><span class="o">)]</span>
  <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">affine_space</span> <span class="o">(</span><span class="n">Vi</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">Ei</span> <span class="n">i</span><span class="o">)]</span>

<span class="kn">section</span>
<span class="kn">include</span> <span class="n">V</span>

<span class="kd">instance</span> <span class="n">affine_space.to_convex_space</span> <span class="o">:</span> <span class="n">convex_space</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">segment_map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">_</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">a</span> <span class="bp">•</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-ᵥ</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+ᵥ</span> <span class="n">x</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kn">include</span> <span class="n">V₁</span> <span class="n">V₂</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">affine_space.to_convex_space</span> <span class="bp">𝕜</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="bp">@</span><span class="n">prod.add_torsor</span> <span class="n">V₁</span> <span class="n">E₁</span> <span class="n">V₂</span> <span class="n">E₂</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">prod.convex_space</span> <span class="bp">𝕜</span> <span class="n">E₁</span> <span class="n">E₂</span> <span class="n">_</span> <span class="n">_</span> <span class="o">:=</span>
<span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">affine_space.to_convex_space</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">Vi</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">Ei</span> <span class="n">i</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">pi.module'</span> <span class="n">ι</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">Vi</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">pi.add_torsor</span> <span class="n">ι</span> <span class="n">Vi</span> <span class="n">_</span> <span class="n">Ei</span> <span class="n">_</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">pi.convex_space</span> <span class="n">ι</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">Ei</span> <span class="n">_</span> <span class="o">:=</span>
<span class="gr">sorry</span> <span class="c1">--totally unrelated diamond issue?</span>

<span class="kd">end</span> <span class="n">affine</span>

<span class="kn">section</span> <span class="n">module</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">semiring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">E₁</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E₁</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">E₂</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E₂</span><span class="o">]</span>
  <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">semiring</span> <span class="o">(</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">add_comm_monoid</span> <span class="o">(</span><span class="n">Ei</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">module</span> <span class="o">(</span><span class="bp">𝕜</span><span class="n">i</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">Ei</span> <span class="n">i</span><span class="o">)]</span>

<span class="kd">instance</span> <span class="n">module.to_convex_space</span> <span class="o">:</span> <span class="n">convex_space</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">segment_map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">a</span> <span class="bp">•</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">•</span> <span class="n">y</span> <span class="o">}</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">module.to_convex_space</span> <span class="bp">𝕜</span> <span class="o">(</span><span class="n">E₁</span> <span class="bp">×</span> <span class="n">E₂</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="bp">@</span><span class="n">prod.module</span> <span class="bp">𝕜</span> <span class="n">E₁</span> <span class="n">E₂</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">prod.convex_space</span> <span class="bp">𝕜</span> <span class="n">E₁</span> <span class="n">E₂</span> <span class="n">_</span> <span class="n">_</span>
  <span class="o">:=</span>
<span class="n">rfl</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">module.to_convex_space</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="bp">@</span><span class="n">pi.module'</span> <span class="n">ι</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">Ei</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">pi.convex_space</span> <span class="n">ι</span> <span class="bp">𝕜</span><span class="n">i</span> <span class="n">Ei</span> <span class="n">_</span>
  <span class="o">:=</span>
<span class="n">rfl</span>

<span class="kd">end</span> <span class="n">module</span>
</code></pre></div>



<a name="256868260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256868260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256868260">(Oct 09 2021 at 12:55)</a>:</h4>
<p>This <code>pi</code> instance also works for defeqness with <code>module</code>. I didn't manage to try for <code>affine_space</code> because I seem to be getting another completely unrelated diamond...</p>



<a name="256868401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256868401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256868401">(Oct 09 2021 at 12:57)</a>:</h4>
<p>I've updated the snippet above.</p>



<a name="256869133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256869133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256869133">(Oct 09 2021 at 13:07)</a>:</h4>
<p>And here's the dreaded diamond vector space diamond.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">[</span><span class="n">ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">affine_space.to_convex_space</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="n">E</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">module.to_convex_space</span> <span class="bp">𝕜</span> <span class="n">E</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">:=</span>
<span class="n">rfl</span> <span class="c1">--fails</span>
</code></pre></div>
<p>It is actually unprovable because I haven't required the two weights to sum up to <code>1</code> in <code>segment_map</code>. Should I add it?</p>



<a name="256873244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256873244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256873244">(Oct 09 2021 at 14:14)</a>:</h4>
<p>Even if you add it, we can't make it <code>rfl</code>.</p>



<a name="256873260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256873260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256873260">(Oct 09 2021 at 14:15)</a>:</h4>
<p>And I don't know what to do.</p>



<a name="256874715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256874715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256874715">(Oct 09 2021 at 14:39)</a>:</h4>
<p>Yeah, I know we can't, because it requires using <code>h : a + b = 1</code> <span aria-label="worried" class="emoji emoji-1f61f" role="img" title="worried">:worried:</span></p>



<a name="256874799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256874799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256874799">(Oct 09 2021 at 14:40)</a>:</h4>
<p>My point was that at least we could make the instances propeq, because they currently are not (they differ on the junk values of <code>segment_map</code>).</p>



<a name="256877421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256877421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256877421">(Oct 09 2021 at 15:22)</a>:</h4>
<p>If <code>𝕜</code> is a ring there would be no problem, right? You could define <code>segment_map</code> for a <code>module</code> using the same sort of formula as for an <code>affine_space</code> (and then just drop the redundant second argument of <code>segment_map</code> completely)</p>



<a name="256877584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256877584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256877584">(Oct 09 2021 at 15:26)</a>:</h4>
<p>Do we really need convex spaces over semirings?</p>



<a name="256877890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256877890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256877890">(Oct 09 2021 at 15:31)</a>:</h4>
<p>EDIT: Ah yes, I see what you mean</p>



<a name="256877926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256877926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256877926">(Oct 09 2021 at 15:31)</a>:</h4>
<p>But then there's no point in defining convex spaces anymore.</p>



<a name="256878225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878225">(Oct 09 2021 at 15:36)</a>:</h4>
<p>I am working on <a href="https://github.com/leanprover-community/mathlib/tree/convex_space">branch#convex_space</a></p>



<a name="256878630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878630">(Oct 09 2021 at 15:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256877926">said</a>:</p>
<blockquote>
<p>But then there's no point in defining convex spaces anymore.</p>
</blockquote>
<p>I think I'm missing some context on why you're interested in convex spaces in the first place</p>



<a name="256878700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878700">(Oct 09 2021 at 15:44)</a>:</h4>
<p>I'm defining convex spaces to be able to generalize convexity to both affine spaces and modules. The convexity refactor generalized convexity to modules, and now we want it in affine spaces.</p>



<a name="256878823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878823">(Oct 09 2021 at 15:46)</a>:</h4>
<p>Isn't a module an affine space?</p>



<a name="256878845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878845">(Oct 09 2021 at 15:47)</a>:</h4>
<p>Not if it isn't over a ring but just a semiring, that's the point.</p>



<a name="256878898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878898">(Oct 09 2021 at 15:48)</a>:</h4>
<p>(mathlib's <code>module</code>, mathematicians' semimodule)</p>



<a name="256878909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878909">(Oct 09 2021 at 15:48)</a>:</h4>
<p>Well then that gets back to my original question, why do we care about convexity over semirings</p>



<a name="256878922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878922">(Oct 09 2021 at 15:48)</a>:</h4>
<p>But also, I think there is more than one notion of affine space</p>



<a name="256878947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256878947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256878947">(Oct 09 2021 at 15:48)</a>:</h4>
<p>Oh? Is there one that doesn't intrinsically require substraction?</p>



<a name="256879056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879056">(Oct 09 2021 at 15:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256878909">said</a>:</p>
<blockquote>
<p>Well then that gets back to my original question, why do we care about convexity over semirings</p>
</blockquote>
<p>And, for that, ask <span class="user-mention" data-user-id="308899">@Yakov Pechersky</span></p>



<a name="256879076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879076">(Oct 09 2021 at 15:51)</a>:</h4>
<p>There is <a href="https://ncatlab.org/nlab/show/affine+space#unbiased_definition">https://ncatlab.org/nlab/show/affine+space#unbiased_definition</a>. Basically it means you have a "linear combination" operation <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>n</mi></msup><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A^n \to A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> for each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>∈</mo><msup><mi>k</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">(c_1, \ldots, c_n) \in k^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c_1 + \cdots + c_n = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, and they have to satisfy the equations expected of general linear combinations.</p>



<a name="256879090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879090">(Oct 09 2021 at 15:51)</a>:</h4>
<p>Note that under this definition, the empty set would also be considered an affine space unless you explicitly rule it out</p>



<a name="256879095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879095">(Oct 09 2021 at 15:51)</a>:</h4>
<p>Ah well that's what I'm trying to define here <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="256879254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879254">(Oct 09 2021 at 15:54)</a>:</h4>
<p>cf <a href="https://ncatlab.org/nlab/show/convex+space">https://ncatlab.org/nlab/show/convex+space</a></p>



<a name="256879875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256879875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256879875">(Oct 09 2021 at 16:04)</a>:</h4>
<p>In my mind the whole point of an affine space is that it is a homogeneous object which looks everywhere locally like the thing it's modelled on. Additive groups look the same everywhere locally because left or right addition by a fixed element is a bijection, so affine spaces over additive groups are reasonable objects. The definition does not use negation explicitly but it's using it implicitly to make the definition capture the concept which mathematicians are trying to model. If one defines affine spaces over modules then I could imagine that the naive definition is not the useful one because monoids like {0,2,3,4,5,...} look different near 0 to how they look near 37 so you can't be a homogeneous space (another word for affine space) over this object because the object itself isn't homogeneous. </p>
<p>This reminds me of group actions. The definition of a group action doesn't mention inverses so it can in theory be made for monoids. However if you make it for monoids then there are two possibilities -- a multiplicative map into End(S) or a multiplicative map into Aut(S). For groups these are equivalent but for monoids they are not and so one has to decide which one is the useful one rather than just choosing one randomly because it's just what happens to be what you get if you write down the standard group definition (which doesn't assume actions are invertible because this follows from the group axioms) and then apply it to monoids.</p>



<a name="256880273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880273">(Oct 09 2021 at 16:11)</a>:</h4>
<p>Part of the confusion is that mathlib (and Kevin) uses "affine space" in the sense of a torsor, but in the context of convexity there's another, more obviously relevant notion: something where you can form affine combinations.</p>



<a name="256880595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880595">(Oct 09 2021 at 16:16)</a>:</h4>
<p>Yes, totally agreed! All I want is an affine-combinations space.</p>



<a name="256880705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880705">(Oct 09 2021 at 16:18)</a>:</h4>
<p>You can have torsors for an abelian group (and probably even more general objects but my rant above is suggesting that they might not be useful objects for monoids) but for this notion of affine space I guess you need a 1? And presumably for semirings it's the same situation --the definition we normally use happens to make sense but it's not clear (at least to me) that it's the useful one if there's no subtraction</p>



<a name="256880762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880762">(Oct 09 2021 at 16:19)</a>:</h4>
<p>For example any set would be an affine space (in the sense of linear combinations) over the naturals this way, right?</p>



<a name="256880768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880768">(Oct 09 2021 at 16:19)</a>:</h4>
<p>Any torsor for an abelian group is an affine space (in the sense of linear combinations) over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span></p>



<a name="256880871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880871">(Oct 09 2021 at 16:21)</a>:</h4>
<p>Right, affine spaces over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span> is just the trivial theory (maybe plus the assumption that it is nonempty)</p>



<a name="256880881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880881">(Oct 09 2021 at 16:21)</a>:</h4>
<p>Is that actually used though?</p>



<a name="256880884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880884">(Oct 09 2021 at 16:21)</a>:</h4>
<p>But then affine spaces over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{R}_{\ge 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.934069em;vertical-align:-0.24517899999999998em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24517899999999998em;"><span></span></span></span></span></span></span></span></span></span> are the convex spaces.</p>



<a name="256880894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880894">(Oct 09 2021 at 16:21)</a>:</h4>
<p>I see!</p>



<a name="256880950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880950">(Oct 09 2021 at 16:22)</a>:</h4>
<p>Yeah, anything is a convex space over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span>, and every set is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span>-convex.</p>



<a name="256880976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256880976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256880976">(Oct 09 2021 at 16:23)</a>:</h4>
<p>So you could do that, but it doesn't really matter because you could also define "convex space" directly with the nonnegativity assumption built in, and of course <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{R}_{\ge 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.934069em;vertical-align:-0.24517899999999998em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24517899999999998em;"><span></span></span></span></span></span></span></span></span></span> is the positive cone of a ring.</p>



<a name="256881003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881003">(Oct 09 2021 at 16:23)</a>:</h4>
<p>Is there a use for convex spaces which aren't subspaces of something sensible like a torsor for a real vector space?</p>



<a name="256881077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881077">(Oct 09 2021 at 16:24)</a>:</h4>
<p>The nLab page has <a href="https://ncatlab.org/nlab/show/convex+space#examples">examples</a>, apparently being embeddable in a torsor for a vector space is a kind of "cancellability" condition.</p>



<a name="256881093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881093">(Oct 09 2021 at 16:25)</a>:</h4>
<p>Yeah, precisely because you get negation.</p>



<a name="256881235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881235">(Oct 09 2021 at 16:27)</a>:</h4>
<p>The question I think is whether there is a use where the <em>free</em> convex spaces (i.e. the spaces parameterizing convex linear combinations) are themselves not embeddable in a module over a ring, and this is what I'm skeptical about</p>



<a name="256881333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881333">(Oct 09 2021 at 16:28)</a>:</h4>
<p>so basically, convexity over a noncancellative semiring</p>



<a name="256881488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881488">(Oct 09 2021 at 16:31)</a>:</h4>
<p>This I have no idea. But we can definitely come up with examples. What about <code>ennreal</code>-convexity, for example?</p>



<a name="256881545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881545">(Oct 09 2021 at 16:32)</a>:</h4>
<p>it's the same as ordinary convexity, because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span> doesn't lie in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p>



<a name="256881622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881622">(Oct 09 2021 at 16:33)</a>:</h4>
<p>So what I said above wasn't a precise characterization, it's more like just <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo>⊂</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">[0, 1] \subset R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> has to be cancellative in some sense, or something.</p>



<a name="256881825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881825">(Oct 09 2021 at 16:36)</a>:</h4>
<p>For context, Yakov was interested in tropical geometry, where the usual stuff happens in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb R_{\ge 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.934069em;vertical-align:-0.24517899999999998em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24517899999999998em;"><span></span></span></span></span></span></span></span></span></span>.</p>



<a name="256881861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881861">(Oct 09 2021 at 16:37)</a>:</h4>
<p>But this is cancellative so the pathologies (non-homogeneity) I was concerned about don't show up.</p>



<a name="256881877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881877">(Oct 09 2021 at 16:37)</a>:</h4>
<p>So I guess this could be converted to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span>-convexity, but at the price of coercing everywhere.</p>



<a name="256881969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881969">(Oct 09 2021 at 16:38)</a>:</h4>
<p>By <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span>-convexity do you mean the useless notion (must be able to do <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>v</mi><mo>+</mo><mi>b</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">av+bw</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a+b=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> with no positivity constraints, so it's just an affine space) or the usual notion?</p>



<a name="256881974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256881974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256881974">(Oct 09 2021 at 16:39)</a>:</h4>
<p>I meant the usual one</p>



<a name="256882718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882718">(Oct 09 2021 at 16:50)</a>:</h4>
<p>Also when people talk about convexity in tropical geometry, I think they mean convexity in the usual sense (involving the usual multiplication on the reals), right?</p>



<a name="256882846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882846">(Oct 09 2021 at 16:52)</a>:</h4>
<p>Apparently not. <a href="https://arxiv.org/pdf/math/0308254.pdf">https://arxiv.org/pdf/math/0308254.pdf</a></p>



<a name="256882864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882864">(Oct 09 2021 at 16:53)</a>:</h4>
<p>And the tropical semiring is most definitely <strong>not</strong> cancellative.</p>



<a name="256882889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882889">(Oct 09 2021 at 16:53)</a>:</h4>
<p>What are you referencing specifically?</p>



<a name="256882962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882962">(Oct 09 2021 at 16:54)</a>:</h4>
<p>Their definition of "tropical convexity"</p>



<a name="256882999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256882999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256882999">(Oct 09 2021 at 16:55)</a>:</h4>
<p>Really?</p>



<a name="256883003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883003">(Oct 09 2021 at 16:55)</a>:</h4>
<p><code>𝕜</code>-tropical convexity is precisely <code>tropical 𝕜</code>-convexity.</p>



<a name="256883011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883011">(Oct 09 2021 at 16:55)</a>:</h4>
<p><a href="/user_uploads/3121/wBAgpLnC1YrZ0cM-mf17A0Jj/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/wBAgpLnC1YrZ0cM-mf17A0Jj/image.png" title="image.png"><img src="/user_uploads/3121/wBAgpLnC1YrZ0cM-mf17A0Jj/image.png"></a></div>



<a name="256883060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883060">(Oct 09 2021 at 16:56)</a>:</h4>
<p>This one?</p>



<a name="256883080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883080">(Oct 09 2021 at 16:56)</a>:</h4>
<p>Yeah</p>



<a name="256883209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883209">(Oct 09 2021 at 16:58)</a>:</h4>
<p>I am not quite sure of what happened to <code>a + b = 1</code>.</p>



<a name="256883212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883212">(Oct 09 2021 at 16:58)</a>:</h4>
<p>How so?</p>



<a name="256883269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883269">(Oct 09 2021 at 17:00)</a>:</h4>
<p>Theorically, <code>1 : tropical 𝕜</code>is <code>0 : 𝕜</code>, so it should translate to <code>min a b = 0</code>, which isn't the case here?</p>



<a name="256883338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883338">(Oct 09 2021 at 17:00)</a>:</h4>
<p>It seems much more like being a <code>tropical 𝕜</code>-module, right?</p>



<a name="256883359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256883359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256883359">(Oct 09 2021 at 17:00)</a>:</h4>
<p>Yeah actually</p>



<a name="256887588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256887588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256887588">(Oct 09 2021 at 18:04)</a>:</h4>
<p>If you're used to thinking about vector spaces, then you might be surprised by the notion of "module over a ring" which allows weird non-free modules, but that doesn't mean it's not a good notion</p>



<a name="256887636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256887636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256887636">(Oct 09 2021 at 18:05)</a>:</h4>
<p>I would assume that this unbiased notion of affine combination space is also the good one for general semirings</p>



<a name="256887709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256887709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256887709">(Oct 09 2021 at 18:06)</a>:</h4>
<p>Is there a reason to believe it's not?</p>



<a name="256888457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256888457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256888457">(Oct 09 2021 at 18:18)</a>:</h4>
<p>That's where I'm coming from, indeed.</p>



<a name="256888721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256888721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256888721">(Oct 09 2021 at 18:22)</a>:</h4>
<p>But the monoid action is an example where the naive approach ("just copy the axioms for a group action") gives you something which you might not want, because you have to add the extra axiom that m*_ is bijective, which is automatic in the group case.</p>



<a name="256888842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256888842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256888842">(Oct 09 2021 at 18:24)</a>:</h4>
<p>Put another way, there are two definitions of group action, both of which make sense for monoids and give different structures</p>



<a name="256889509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256889509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256889509">(Oct 09 2021 at 18:34)</a>:</h4>
<p>Right, but why would you require m* to be bijective? It's like saying modules have to be free</p>



<a name="256890926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256890926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256890926">(Oct 09 2021 at 18:57)</a>:</h4>
<p>I'm saying that I've seen the definition of a group action on a set given as being a multiplicative map from G to Aut(S) and I'm observing that this definition makes sense for monoids, and I'm deducing that just because a random mathlib definition makes sense in some larger generality doesn't mean it's the "correct" definition in some larger generality, and the proof is that there are two definitions of a group action both of which make sense for monoids and become different concepts</p>



<a name="256891048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256891048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256891048">(Oct 09 2021 at 18:59)</a>:</h4>
<p>The definition of monoid actions definitely doesn't ask for bijective maps.</p>



<a name="256891076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256891076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256891076">(Oct 09 2021 at 18:59)</a>:</h4>
<p>Sure</p>



<a name="256891181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256891181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256891181">(Oct 09 2021 at 19:00)</a>:</h4>
<p>But you can't deduce from this that an arbitrary definition which makes sense in more generality is "correct" in that greater generality</p>



<a name="256891189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256891189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256891189">(Oct 09 2021 at 19:00)</a>:</h4>
<p>And my argument gives a proof that this can't always be true</p>



<a name="256891445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256891445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256891445">(Oct 09 2021 at 19:04)</a>:</h4>
<p>Another reason to talk about convexity in <code>nnreal</code>-semimodules: the set of invariant measures of a map is convex.</p>



<a name="256892318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256892318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256892318">(Oct 09 2021 at 19:18)</a>:</h4>
<p>Ahah! This example is interesting because one thing we forgot is that having negative elements in the base (semi)ring also affects the space. That's because an <code>add_comm_monoid</code> acted on by a <code>ring</code> through <code>module</code> is promotable to an <code>add_comm_group</code>, negation in the space being <code>-1 • x</code>.</p>



<a name="256892365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256892365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256892365">(Oct 09 2021 at 19:19)</a>:</h4>
<p>So, by forcing the scalars to be a <code>ring</code> , we a fortiori force the space to be an <code>add_comm_group</code>.</p>



<a name="256893393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256893393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256893393">(Oct 09 2021 at 19:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256891181">said</a>:</p>
<blockquote>
<p>But you can't deduce from this that an arbitrary definition which makes sense in more generality is "correct" in that greater generality</p>
</blockquote>
<p>Sure, you can't deduce that "unbiased affine combination space" is a good notion just because it specializes to give affine spaces over fields. But still, I think it's definitely a good notion. For example, it specializes to give both the usual affine spaces and convex spaces, the category of such spaces is monadic over Type (so it's a nice algebraic notion), it has a forgetful functor from the category of semimodules, and you get the usual restriction-of-scalar functors (which is to say that you'll get lots of examples of these spaces). What's there not to like? In general this kind of space won't be a torsor for some semimodule, but I think this is just like how modules aren't generally free, and rings don't generally have unique factorisation (i.e., it's not  necessarily a sign that you have the wrong notion).</p>



<a name="256902557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256902557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256902557">(Oct 09 2021 at 22:08)</a>:</h4>
<p>If you've put some thought into it and understand that it's the correct definition then that's fine :-) My point is only that this needs to be done. Thanks for doing it :-)</p>



<a name="256930066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256930066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256930066">(Oct 10 2021 at 06:28)</a>:</h4>
<p>Should I understand that I have your blessing for defining them? <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span> How should they be called?</p>



<a name="256981244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981244">(Oct 10 2021 at 20:15)</a>:</h4>
<p>You could say <code>affine_combination_space</code> to distinguish from the torsor <code>affine_space</code>, but it's a mouthful</p>



<a name="256981350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981350">(Oct 10 2021 at 20:16)</a>:</h4>
<p>Is <code>convex_space</code> fine?</p>



<a name="256981373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981373">(Oct 10 2021 at 20:16)</a>:</h4>
<p>What do you mean by <code>convex_space</code>?</p>



<a name="256981386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981386">(Oct 10 2021 at 20:16)</a>:</h4>
<p>The above</p>



<a name="256981412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981412">(Oct 10 2021 at 20:17)</a>:</h4>
<p>What's bothering me with this name is that we never have to restrict to positive coefficients.</p>



<a name="256981418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981418">(Oct 10 2021 at 20:17)</a>:</h4>
<p>So an affine combination space over a semiring <code>R</code>?</p>



<a name="256981422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981422">(Oct 10 2021 at 20:17)</a>:</h4>
<p>Yeah</p>



<a name="256981538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256981538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256981538">(Oct 10 2021 at 20:19)</a>:</h4>
<p>It's a nice name I suppose, but maybe a bit misleading since <code>R</code> can have negative elements</p>



<a name="256982639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256982639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256982639">(Oct 10 2021 at 20:35)</a>:</h4>
<p>To be clear, I'm not at all an expert on this, and agree that it's not clear what the best definition to formalise is. After thinking about this some more, my armchair understanding is that affine combination space isn't a very good notion for <em>every</em> semiring <code>R</code>, although it makes sense when <code>R</code> is a ring, or has enough multiplicative inverse (like <code>nnreal</code>). It was pointed out above that every set is an affine combination space over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span> in a unique way. But in fact there is a sensible notion of convex subsets in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>-modules like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">Z</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\Z^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>, which you can use also to define convex functions (those for which the upper graph is convex); you just won't get it from thinking about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">Z</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\Z^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> as an affine combination space over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span>.</p>
<p>In this situation, you might prefer to use  something like the "slice category" definition mention on nlab. Namely, say an affine space over a semiring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>-semimodule <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> together with a linear map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>:</mo><mi>P</mi><mo>→</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">w : P \to R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>. Think of an element of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> as a kind of weighted sum, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> as giving its weight, so really <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w^{-1}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> is what you would normally think of as the underlying type of an affine space, but if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> doesn't have enough multiplicative inverses then this type doesn't tell you very much about all of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>. Now you get a "forgetful functor" <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>↦</mo><mi>M</mi><mo>×</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">M \mapsto M \times R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69433em;vertical-align:-0.011em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> from semimodules to affine spaces. Taking <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">R = \N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span>, I believe you can understand convex subsets of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">Z</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\Z^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> in terms of the "underlying" affine space.</p>



<a name="256983349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256983349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256983349">(Oct 10 2021 at 20:46)</a>:</h4>
<p>With that definition, would <code>{0, 2}</code> be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>-convex in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>?</p>



<a name="256983980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256983980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256983980">(Oct 10 2021 at 20:57)</a>:</h4>
<p>I haven't been following this discussion at all, but I do think it's worthwhile to mention that the axioms of a convex space (or whatever you want to call it) can be formalized as an abstract algebraic gadget, without reference to any ring or semirng.<br>
Essentially, consider a commutative monoid with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, say <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, endowed with a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>:</mo><mi>R</mi><mo>→</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">\sigma : R \to R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>3</mn></msup><mo>→</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">R^3 \to R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> denoted <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>↦</mo><msub><mi>C</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,a,b) \mapsto C_x(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>. Think of this as a signature (in the sense of first order logic), and consider the axioms appearing in <a href="https://ncatlab.org/nlab/show/convex-space">nlab#convex-space</a> which can all be written down without reference to any (semi)ring, given the data above (where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span> should take the place of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">1-t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>), together with axioms like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma(1) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">\sigma(\sigma(t)) = t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>.</p>



<a name="256984222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984222">(Oct 10 2021 at 21:00)</a>:</h4>
<p>(I don't know if these axioms actually give the same theory that's satisfied by all rings, but it's certainly contained in there.)</p>



<a name="256984237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984237">(Oct 10 2021 at 21:01)</a>:</h4>
<p>I see that the focus moved to "what is the right super-general definition?". I think that instead of this we should decide what example do we care about, then write a definition that will work in these cases. Whoever starts caring about a use case not covered by the current definition may refactor.</p>



<a name="256984257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984257">(Oct 10 2021 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> How exactly do you suggest to encode this in Lean?</p>



<a name="256984330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984330">(Oct 10 2021 at 21:02)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">cing</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span> <span class="n">monoid_with_zero</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">sigma</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">\</span><span class="n">to</span> <span class="n">A</span><span class="o">)</span>
<span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">\</span><span class="n">to</span> <span class="n">A</span> <span class="bp">\</span><span class="n">to</span> <span class="n">A</span> <span class="bp">\</span><span class="n">to</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">...</span> <span class="kd">axioms</span>
</code></pre></div>



<a name="256984338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984338">(Oct 10 2021 at 21:02)</a>:</h4>
<p>That's what I started doing on <a href="https://github.com/leanprover-community/mathlib/tree/convex_space">branch#convex_space</a>, right?</p>



<a name="256984364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984364">(Oct 10 2021 at 21:03)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> And what is a <code>convex_space</code>?</p>



<a name="256984366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984366">(Oct 10 2021 at 21:03)</a>:</h4>
<p>I haven't yet gone through all the axioms, but this is certainly where I was heading.</p>



<a name="256984367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984367">(Oct 10 2021 at 21:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256984338">said</a>:</p>
<blockquote>
<p>That's what I started doing on <a href="https://github.com/leanprover-community/mathlib/tree/convex_space">branch#convex_space</a>, right?</p>
</blockquote>
<p>It looks like you're working with semirings, rigght?</p>



<a name="256984376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984376">(Oct 10 2021 at 21:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256984364">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> And what is a <code>convex_space</code>?</p>
</blockquote>
<p>The analogue of a module over a <code>cing</code></p>



<a name="256984385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984385">(Oct 10 2021 at 21:03)</a>:</h4>
<p>Only because they give me a <code>1</code>. I could relax to <code>add_monoid</code> + <code>has_one</code>.</p>



<a name="256984442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984442">(Oct 10 2021 at 21:04)</a>:</h4>
<p>Well, I want, e.g. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma(0) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> to be such a gadget as well... no addition necessary</p>



<a name="256984447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984447">(Oct 10 2021 at 21:04)</a>:</h4>
<p>Wait sorry what's a <code>cing</code>? <span aria-label="astonished" class="emoji emoji-1f632" role="img" title="astonished">:astonished:</span></p>



<a name="256984465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984465">(Oct 10 2021 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> Is there any specific example you care about where this generality is important?</p>



<a name="256984507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984507">(Oct 10 2021 at 21:05)</a>:</h4>
<p>This is the smallest reasonable algebraic theory where one can define the analogue of Milnor K-theory, but I don't know if anything meaningful can be said about such gadgets in the abstract</p>



<a name="256984577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984577">(Oct 10 2021 at 21:06)</a>:</h4>
<p>I have these examples in my head:</p>
<ul>
<li>real vector spaces;</li>
<li>vector spaces over rational numbers;</li>
<li>affine spaces over real or rational numbers;</li>
<li><code>nnreal</code>-semimodules, including measures.</li>
</ul>



<a name="256984583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984583">(Oct 10 2021 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256984465">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> Is there any specific example you care about where this generality is important?</p>
</blockquote>
<p>The interval <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> would also be an example.</p>



<a name="256984620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984620">(Oct 10 2021 at 21:07)</a>:</h4>
<p>I'm talking about convex spaces, not instances of <code>cing</code>.</p>



<a name="256984627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984627">(Oct 10 2021 at 21:07)</a>:</h4>
<p>I assume going from my definition of convex space to your abstract gadgets is a rather independent step, right?</p>



<a name="256984654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984654">(Oct 10 2021 at 21:07)</a>:</h4>
<p>Ah, well I think "modules" over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> in this sense should be the usual convex spaces (well, maybe there would be some weird quotients)</p>



<a name="256984705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984705">(Oct 10 2021 at 21:08)</a>:</h4>
<p>I don't think that we should generalize for the sake of generalization.</p>



<a name="256984706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984706">(Oct 10 2021 at 21:08)</a>:</h4>
<p>I'm not against it, but clearly refactoring from semimodules to convex/unbiased affine spaces is gonna be some sleepless nights already.</p>



<a name="256984741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984741">(Oct 10 2021 at 21:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/256984705">said</a>:</p>
<blockquote>
<p>I don't think that we should generalize for the sake of generalization.</p>
</blockquote>
<p>Category-theory-phobic <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="256984768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984768">(Oct 10 2021 at 21:09)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> The main problem I see with any definition is that once we have a theory that covers both modules over <code>nnreal</code>s and real affine spaces, we get a diamond for real vector spaces.</p>



<a name="256984782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984782">(Oct 10 2021 at 21:09)</a>:</h4>
<p>Yes <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span>, I agree, this would not solve any diamond issues.</p>



<a name="256984837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984837">(Oct 10 2021 at 21:10)</a>:</h4>
<p>(Sorry, i have to run! I would be happy to discuss this laterr!)</p>



<a name="256984880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/256984880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#256984880">(Oct 10 2021 at 21:10)</a>:</h4>
<p>Well, there's no way around that diamond. So why not go for it anyway? Having a theory accessible through a def is better than not having it at all.</p>



<a name="257041634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257041634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257041634">(Oct 11 2021 at 10:11)</a>:</h4>
<p>Wait, once we have <code>convex_space</code>, what would be the point of <code>affine_space</code>? Maybe we can generalize the definition of <code>affine_space</code> rather than defining a new class.</p>



<a name="257045190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257045190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257045190">(Oct 11 2021 at 10:45)</a>:</h4>
<p>Yes, it might be a good idea to change the definition of <code>affine_space</code> to be an affine combination space. You would get a different API, since you wouldn't have an unbundled vector space parameter. Instead you could define "the module associated to an affine space", and prove that any nonempty affine space over a ring is a torsor for this module.</p>



<a name="257106594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257106594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257106594">(Oct 11 2021 at 19:24)</a>:</h4>
<p>BTW, this will solve the diamond. We can have a definition (not an instance) <code>add_torsor.to_affine_space</code> and a type class saying that add torsor and affine space structures agree.</p>



<a name="257106595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257106595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257106595">(Oct 11 2021 at 19:24)</a>:</h4>
<p>BTW, this will solve the diamond. We can have a definition (not an instance) <code>add_torsor.to_affine_space</code> and a type class saying that add torsor and affine space structures agree.</p>



<a name="257106596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257106596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257106596">(Oct 11 2021 at 19:24)</a>:</h4>
<p>But this is a large refactor</p>



<a name="257106758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257106758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257106758">(Oct 11 2021 at 19:26)</a>:</h4>
<p>And you shouldn't add an instance of add torsor with a manually constructed module because the additive group in the definition of add torsor is an out param</p>



<a name="257115751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257115751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257115751">(Oct 11 2021 at 20:57)</a>:</h4>
<p>What do you plan to use as the basic operation in the new <code>affine_space</code>? Something like <code>Π (x y : R), x + y = 1  → P → P → P</code>?</p>



<a name="257131895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257131895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257131895">(Oct 12 2021 at 00:15)</a>:</h4>
<p>Or <code>affine_comb (f : P →₀ R) (hf : f.sum id = 1) : P</code>?</p>



<a name="257132464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257132464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257132464">(Oct 12 2021 at 00:23)</a>:</h4>
<p>I think the laws are (a lot?) easier to state for the second form</p>



<a name="257134433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257134433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257134433">(Oct 12 2021 at 00:53)</a>:</h4>
<p>In the first form the axioms will be similar to those in <a href="https://ncatlab.org/nlab/show/convex+space#definition">https://ncatlab.org/nlab/show/convex+space#definition</a></p>



<a name="257134510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257134510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257134510">(Oct 12 2021 at 00:54)</a>:</h4>
<p>But building <code>affine_comb</code> from the binary operation is not trivial.</p>



<a name="257137479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257137479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257137479">(Oct 12 2021 at 01:37)</a>:</h4>
<p>Note that the vast bulk of lemmas about <code>affine_space</code> are really lemmas about <code>add_torsor</code> for a module (they involve vectors, they don't involve affine combinations), and, similarly, most of the lemmas about <code>affine_subspace</code> are really about a sub-torsor as they also involve vectors (constrained so that the subgroup is a submodule). So if you redefine <code>affine_space</code>, existing lemmas (that currently use the <code>affine_space</code> notation) should probably change to be about <code>add_torsor</code> and something similar should be done for renaming <code>affine_subspace</code>.</p>



<a name="257158569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257158569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257158569">(Oct 12 2021 at 07:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/257106596">said</a>:</p>
<blockquote>
<p>But this is a large refactor</p>
</blockquote>
<p>I have time to spare. I'm a Cambridge student <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="257158719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257158719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257158719">(Oct 12 2021 at 07:07)</a>:</h4>
<p>So are we heading towards changing <code>affine_space</code> from an abbreviation of <code>add_torsor</code> to an unbiased affine space?</p>



<a name="257493827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257493827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257493827">(Oct 14 2021 at 07:51)</a>:</h4>
<p>The definition of a monoid action will imply that invertible elements map to invertible elements, because it maps the unit element of the monoid to identity. But think of a semigroup action, where semigroups are just associative laws, possibly without unit — then a group action would not be a semigroup action of a group. </p>
<p>Similar question : a monoid action can be defined either as a map $M\times X \to X$ (plus axioms) or as a morphism of monoids from $M$ to the monoid of self-maps of $X$. For mathematicians, both are rapidly equivalent, and we switch from one to another (Bourbaki has a stylistic convention, speaks of action and of operation), but for automatic formalization, how are the two reconciled?  </p>
<p>And for actions of topological monoids, the first definition is the good one, namely, the continuity of the map $M\times X\to X$, because for most applications, eg, representations of topological groups on Hilbert spaces, the map $M\to \operatorname{Aut}(X)$ is not continuous.</p>



<a name="257494167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257494167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257494167">(Oct 14 2021 at 07:54)</a>:</h4>
<p>(Tip: Zulip needs double <code>$$</code>s around maths.)<br>
We tend to focus on the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">M × X → X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> approach. It can be easily combined with nice notation, and works well together with forgetting structure. (E.g. a module is a monoid action. And it is the <em>exact</em> same map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">M × X → X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, but for the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>→</mo><mtext>End</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M → \text{End}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">End</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> you would need to change the version of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>End</mtext></mrow><annotation encoding="application/x-tex">\text{End}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">End</span></span></span></span></span> that you are considering.)</p>



<a name="257508014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257508014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257508014">(Oct 14 2021 at 09:47)</a>:</h4>
<p>I lost track of the discussion. Can someone explain me what I should do?</p>



<a name="257508632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257508632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257508632">(Oct 14 2021 at 09:53)</a>:</h4>
<p>I think you should define unbiased affine combination spaces over a semiring <code>R</code>, and call it <code>affine_space R</code></p>



<a name="257508675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257508675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257508675">(Oct 14 2021 at 09:53)</a>:</h4>
<p><code>affine_space R P</code>, rather?</p>



<a name="257509022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509022">(Oct 14 2021 at 09:56)</a>:</h4>
<p>I mean something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">affine_space'</span> <span class="o">(</span><span class="bp">𝕜</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">affine_comb</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→₀</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">f.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">E</span><span class="o">)</span>
<span class="c1">-- more axioms</span>
</code></pre></div>



<a name="257509083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509083">(Oct 14 2021 at 09:57)</a>:</h4>
<p>Do you know what axioms I need?</p>



<a name="257509209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509209">(Oct 14 2021 at 09:58)</a>:</h4>
<p>You want an "associativity axiom", which says that an affine combination of affine combinations is ... some affine combination. And a "unitality" axiom which says that if you combine just one point with weight one, you get that point</p>



<a name="257509235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509235">(Oct 14 2021 at 09:58)</a>:</h4>
<p>Is that it?</p>



<a name="257509481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509481">(Oct 14 2021 at 10:00)</a>:</h4>
<p>I think so. This is a general way of stating axioms for algebraic theories (you just have the two axioms for algebras over a monad)</p>



<a name="257509611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257509611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257509611">(Oct 14 2021 at 10:02)</a>:</h4>
<p>Okay. And what about this?<br>
<span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/116395-maths/topic/Convex.20space/near/257106595">said</a>:</p>
<blockquote>
<p>BTW, this will solve the diamond. We can have a definition (not an instance) <code>add_torsor.to_affine_space</code> and a type class saying that add torsor and affine space structures agree.</p>
</blockquote>



<a name="257510443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257510443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257510443">(Oct 14 2021 at 10:09)</a>:</h4>
<p>The associativity axiom is going to be quite painful expressed in terms of finitely supported functions!</p>



<a name="257510499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257510499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257510499">(Oct 14 2021 at 10:09)</a>:</h4>
<p>It would be much easier to state in terms of indexing types.</p>



<a name="257510750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257510750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257510750">(Oct 14 2021 at 10:12)</a>:</h4>
<p>Do you mean <code>affine_comb (ι : Type*) (f : ι →₀ 𝕜) (hf : f.sum (λ x, id) = 1) : E</code> or <code>affine_comb (ι : Type*) [fintype ι] (f : ι → 𝕜) (hf : ∑ x : ι, f x = 1) : E</code>?</p>



<a name="257510979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257510979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257510979">(Oct 14 2021 at 10:14)</a>:</h4>
<p>I think you need something more complicated: you need an indexing type, and both a function into k and a function into E</p>



<a name="257510986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257510986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257510986">(Oct 14 2021 at 10:14)</a>:</h4>
<p>(to tell you the weights, and the points)</p>



<a name="257511056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257511056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257511056">(Oct 14 2021 at 10:15)</a>:</h4>
<p>It's still going to be a little awkward with indexing types for universe reasons</p>



<a name="257511298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257511298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257511298">(Oct 14 2021 at 10:17)</a>:</h4>
<p>Oh yeah of course. I mean, this is really about putting <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.center_mass">docs#finset.center_mass</a> (or <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.affine_combination">docs#finset.affine_combination</a>) inside the typeclass.</p>



<a name="257511305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257511305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257511305">(Oct 14 2021 at 10:17)</a>:</h4>
<p>Maybe, since the type is finite anyways, you should use <code>Type</code></p>



<a name="257511443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257511443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257511443">(Oct 14 2021 at 10:19)</a>:</h4>
<p>I guess you can define a universe-polymorphic <code>affine_comb</code> after the fact</p>



<a name="257511694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257511694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257511694">(Oct 14 2021 at 10:21)</a>:</h4>
<p>By the same logic, you could just use <code>fin n</code> as the indexing type but then it's again a little awkward to state associativity</p>



<a name="257512046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257512046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257512046">(Oct 14 2021 at 10:24)</a>:</h4>
<p>I don't think it's too bad in terms of finsupp. Here's the statement of associativity, modulo two sorries (edit: hopefully it's right this time)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">v</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→₀</span> <span class="n">R</span> <span class="bp">//</span> <span class="n">v.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">}</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="n">α</span><span class="o">}</span>

<span class="kd">def</span> <span class="n">map</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">T</span> <span class="n">R</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">T</span> <span class="n">R</span> <span class="n">β</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">v.val.map_domain</span> <span class="n">f</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩</span>
<span class="kd">def</span> <span class="n">μ</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">T</span> <span class="n">R</span> <span class="o">(</span><span class="n">T</span> <span class="n">R</span> <span class="n">α</span><span class="o">))</span> <span class="o">:</span> <span class="n">T</span> <span class="n">R</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">v.val.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">w</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">•</span> <span class="n">w.val</span><span class="o">),</span> <span class="gr">sorry</span><span class="o">⟩</span>
<span class="kd">def</span> <span class="n">associativity</span> <span class="o">(</span><span class="n">comb</span> <span class="o">:</span> <span class="n">T</span> <span class="n">R</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∀</span> <span class="n">v</span><span class="o">,</span> <span class="n">comb</span> <span class="o">(</span><span class="n">μ</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">comb</span> <span class="o">(</span><span class="n">map</span> <span class="n">comb</span> <span class="n">v</span><span class="o">)</span>
</code></pre></div>



<a name="257512386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257512386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257512386">(Oct 14 2021 at 10:27)</a>:</h4>
<p>For the convex version we have <a href="https://leanprover-community.github.io/mathlib_docs/find/pmf">docs#pmf</a>, though it's limited to <code>real</code></p>



<a name="257560395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257560395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257560395">(Oct 14 2021 at 16:04)</a>:</h4>
<p>Given that <code>affine_space</code> is used quite widely, what do you think of first defining <code>affine_space'</code> and slowly refactor? Or do you prefer that I instead first rename all the <code>affine_space</code> to <code>add_torsor</code>?</p>



<a name="257626860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Convex%20space/near/257626860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Convex.20space.html#257626860">(Oct 15 2021 at 00:12)</a>:</h4>
<p>You definitely need to define some kind of <code>def</code> for affine combinations (separate from that appearing in the type class) after the fact, even apart from any universe issues with index types, simply to get a version which is a bundled affine map (whatever form of affine maps makes sense with this affine space definition; I suppose that's maps that preserve affine combinations, with the linkage to linear maps then becoming something defined only for the type class that asserts propositional equality between the affine combinations in the definition and the affine combinations derived from the <code>add_torsor</code> structure).</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>