---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html">Faulhaber's Theorem (sum of kth powers)</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="226874769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226874769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226874769">(Feb 18 2021 at 20:27)</a>:</h4>
<p>Here's a proof of Faulhaber's theorem:<br>
<a href="https://github.com/mo271/faulhaber/blob/master/src/faulhaber_with_power_series.lean">https://github.com/mo271/faulhaber/blob/master/src/faulhaber_with_power_series.lean</a><br>
I did this together with Fabian Kruse. <br>
I think there are some lemmas in that proof that might be nice to have in mathlib. It's probably looking quite ugly to more experienced lean users, but at least I see a "goals accomplished <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span>" in the end.</p>
<p>Is there a linter for lean somewhere?</p>



<a name="226874957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226874957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226874957">(Feb 18 2021 at 20:28)</a>:</h4>
<p>Well done!</p>



<a name="226874996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226874996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226874996">(Feb 18 2021 at 20:28)</a>:</h4>
<p>There isn't a style linter. But you can write <code>#lint</code> at the bottom of the file to get some useful feedback</p>



<a name="226875141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226875141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226875141">(Feb 18 2021 at 20:29)</a>:</h4>
<p>Things like: your theorem doesn't use hypothesis <code>h</code>, or this <code>def</code> is missing a docstring (all <code>def</code>s in mathlib are required to have docstrings), or a lemma that shouldn't be marked <code>simp</code>, etc...</p>



<a name="226875248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226875248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226875248">(Feb 18 2021 at 20:30)</a>:</h4>
<p>There's a very basic style linter script used in mathlib's CI that just checks things like line length, but you might have to do some hacking to get it to run outside of mathlib: <a href="https://github.com/leanprover-community/mathlib/blob/master/scripts/lint-style.sh">https://github.com/leanprover-community/mathlib/blob/master/scripts/lint-style.sh</a></p>



<a name="226876011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226876011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226876011">(Feb 18 2021 at 20:35)</a>:</h4>
<p>I guess I only care about the formatting and linting for the stuff I'd submit as a pr to mathlib. Reading naming conventions and code style guide now..</p>



<a name="226876234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226876234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226876234">(Feb 18 2021 at 20:36)</a>:</h4>
<p>I think the whole thing would be welcome in mathlib, if you have the energy! (but of course it's reasonable to start by PR'ing just some of the supporting lemmas)</p>



<a name="226877012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877012">(Feb 18 2021 at 20:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_power_series'</span><span class="o">:</span>
  <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">))</span> <span class="bp">=</span> <span class="n">X</span> <span class="o">:=</span>
</code></pre></div>
<p>I think <span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span> recently brought this to mathlib (-;</p>



<a name="226877055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877055">(Feb 18 2021 at 20:42)</a>:</h4>
<p>Cool, I suppose small PRs are prefered, so submitting each of relevant lemmas separately is preferred to one larger PR</p>



<a name="226877201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877201">(Feb 18 2021 at 20:43)</a>:</h4>
<p>Yeah, certainly for a first PR I would aim for ~50 lines</p>



<a name="226877264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877264">(Feb 18 2021 at 20:44)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">expk</span>
</code></pre></div>
<p><del>I think this is <code>power_series.exp</code></del></p>



<a name="226877312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877312">(Feb 18 2021 at 20:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226877012">said</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_power_series'</span><span class="o">:</span>
  <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">))</span> <span class="bp">=</span> <span class="n">X</span> <span class="o">:=</span>
</code></pre></div>
<p>I think <span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> recently brought this to mathlib (-;</p>
</blockquote>
<p>That's great. I thought I had just synced I can't see it in bernoulli.lean</p>



<a name="226877315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877315">(Feb 18 2021 at 20:44)</a>:</h4>
<p>Ooh, scratch that... I can't read</p>



<a name="226877378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877378">(Feb 18 2021 at 20:45)</a>:</h4>
<p>what was recently added is bernoulli_odd_eq_zero, which is most useful here of course..</p>



<a name="226877423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877423">(Feb 18 2021 at 20:45)</a>:</h4>
<p>Let me check the sources</p>



<a name="226877699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877699">(Feb 18 2021 at 20:47)</a>:</h4>
<p>You are right... I'm too sloppy in my feedback. Sorry.</p>



<a name="226877809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877809">(Feb 18 2021 at 20:48)</a>:</h4>
<p>good, I though there were some secret branches beside master or search was broken or something...</p>



<a name="226877930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226877930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226877930">(Feb 18 2021 at 20:49)</a>:</h4>
<p>I think Ashvni has a Bernoulli polynomial branch, but I suggested that she waited until this PR was accepted before she made the next PR. I'll see if her next branch is ready.</p>



<a name="226878955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226878955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226878955">(Feb 18 2021 at 20:55)</a>:</h4>
<p>Looking forward to seeing what   <span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span>  has!</p>



<a name="226890355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226890355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226890355">(Feb 18 2021 at 22:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226877012">said</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_power_series'</span><span class="o">:</span>
  <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">))</span> <span class="bp">=</span> <span class="n">X</span> <span class="o">:=</span>
</code></pre></div>
<p>I think <span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> recently brought this to mathlib (-;</p>
</blockquote>
<p>Hello! Glad to know Faulhaber's theorem is on the way :) <br>
Also, the above theorem is in mathlib in bernoulli.lean, the name is <code>bernoulli_power_series</code>.</p>



<a name="226891585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226891585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226891585">(Feb 18 2021 at 22:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226874769">said</a>:</p>
<blockquote>
<p>Here's a proof of Faulhaber's theorem:<br>
<a href="https://github.com/mo271/faulhaber/blob/master/src/faulhaber_with_power_series.lean">https://github.com/mo271/faulhaber/blob/master/src/faulhaber_with_power_series.lean</a><br>
I did this together with Fabian Kruse. <br>
I think there are some lemmas in that proof that might be nice to have in mathlib. It's probably looking quite ugly to more experienced lean users, but at least I see a "goals accomplished <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span>" in the end.</p>
<p>Is there a linter for lean somewhere?</p>
</blockquote>
<p>Also, I believe <code>expk</code> and <code>exp_inv</code> are now in <code>mathlib</code>,  as <code>rescale k (exp ℚ)</code> and <code>exp_mul_exp_neg_eq_one</code> respectively.</p>



<a name="226892074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226892074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226892074">(Feb 18 2021 at 22:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226878955">said</a>:</p>
<blockquote>
<p>Looking forward to seeing what   <span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span>  has!</p>
</blockquote>
<p>The next PR (which I can make once <code>leanpkg build</code> confirms everything is okay) will be about Bernoulli polynomials. Here is the branch : <a href="https://github.com/leanprover-community/mathlib/tree/bernoulli-polynomials">https://github.com/leanprover-community/mathlib/tree/bernoulli-polynomials</a></p>



<a name="226892242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226892242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226892242">(Feb 18 2021 at 22:18)</a>:</h4>
<p><span class="user-mention" data-user-id="313038">@Moritz Firsching</span> Here's a style thing. Rather than doing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="bp">...</span> <span class="o">:</span> <span class="bp">...</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="bp">...</span><span class="o">,</span>
  <span class="bp">...</span><span class="o">,</span>
<span class="kd">end</span><span class="o">,</span>
</code></pre></div>
<p>you can do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="bp">...</span> <span class="o">:</span> <span class="bp">...</span><span class="o">,</span>
<span class="o">{</span> <span class="bp">...</span><span class="o">,</span>
  <span class="bp">...</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>



<a name="226908492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226908492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226908492">(Feb 19 2021 at 01:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253861">Thomas Browning</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226892242">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> Here's a style thing. Rather than doing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="bp">...</span> <span class="o">:</span> <span class="bp">...</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="bp">...</span><span class="o">,</span>
  <span class="bp">...</span><span class="o">,</span>
<span class="kd">end</span><span class="o">,</span>
</code></pre></div>
<p>you can do</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="bp">...</span> <span class="o">:</span> <span class="bp">...</span><span class="o">,</span>
<span class="o">{</span> <span class="bp">...</span><span class="o">,</span>
  <span class="bp">...</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Is this the recommended style now? I pretty much exclusively use the former as I always like there to be only 1 goal at a time wherever you click.</p>



<a name="226908784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226908784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226908784">(Feb 19 2021 at 01:22)</a>:</h4>
<p>That's still be the case inside the <code>{ ... }</code>.</p>



<a name="226908942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226908942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226908942">(Feb 19 2021 at 01:24)</a>:</h4>
<p>You shouldn't use <code>have := begin end</code> in tactic mode, because that nests a tactic block inside a term inside a tactic block, which takes longer to parse/elaborate and also leads to more nested contexts in error messages</p>



<a name="226909015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226909015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226909015">(Feb 19 2021 at 01:25)</a>:</h4>
<p>In <code>have : T, { ... }</code> the <code>...</code> is still part of the main tactic block structure</p>



<a name="226909335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226909335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226909335">(Feb 19 2021 at 01:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="308899">Yakov Pechersky</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226908784">said</a>:</p>
<blockquote>
<p>That's still be the case inside the <code>{ ... }</code>.</p>
</blockquote>
<p>Of course, I was just explaining my weird internal reasoning <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> of not liking having two goals after writing comma lol.</p>



<a name="226909420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226909420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226909420">(Feb 19 2021 at 01:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226908942">said</a>:</p>
<blockquote>
<p>You shouldn't use <code>have := begin end</code> in tactic mode, because that nests a tactic block inside a term inside a tactic block, which takes longer to parse/elaborate and also leads to more nested contexts in error messages</p>
</blockquote>
<p>Very good to know thanks, should we add this to the style guide then (assuming its not already there and I'm not missing it).</p>



<a name="226909706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226909706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226909706">(Feb 19 2021 at 01:34)</a>:</h4>
<p>Looks like there are a few (&lt; 10) instances of this pattern in mathlib, at least one due to me...</p>



<a name="226909787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226909787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226909787">(Feb 19 2021 at 01:35)</a>:</h4>
<p>It's not a really big deal, certainly nested tactic blocks come up in patterns like <code>exact foo (by simp) bar</code>, but if you want to shove a whole sequence of tactics in there you can always pop it out as a subgoal using <code>refine</code></p>



<a name="226931397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226931397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226931397">(Feb 19 2021 at 08:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226890355">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226877012">said</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_power_series'</span><span class="o">:</span>
  <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">))</span> <span class="bp">=</span> <span class="n">X</span> <span class="o">:=</span>
</code></pre></div>
<p>I think <span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> recently brought this to mathlib (-;</p>
</blockquote>
<p>Hello! Glad to know Faulhaber's theorem is on the way :) <br>
Also, the above theorem is in mathlib in bernoulli.lean, the name is <code>bernoulli_power_series</code>.</p>
</blockquote>
<p>I think <code>bernoulli_power_series</code> in bernoulli.lean is the version with bernoulli numbers without the (-1)^n (which only makes a difference for <code>bernoulli 1</code>, but still it is a different power series. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_power_series</span> <span class="o">:</span>
  <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">X</span> <span class="bp">*</span> <span class="n">exp</span> <span class="n">ℚ</span>
</code></pre></div>
<p>In our proof for <code>bernoulli_power_series'</code> we use <code>bernoulli_power_series</code> this essentially then just follows by substituting (-X) for (X). </p>
<p>In general some formulas would be prettier using a definition <code>bernoulli' n := (-1)^n*bernoulli n</code>. Wikipedia says  the convention currently used in lean is "sometimes used in the older literature".   However for Faulhaber's theorem the formula becomes slightly prettier with lean's definition, since using the convention with <code>bernoulli 1 = + 1/2</code>, there is no (-1)^k appearing. I have no strong opinion on what convention is better.</p>



<a name="226932004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226932004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226932004">(Feb 19 2021 at 08:16)</a>:</h4>
<p>Eberl told me that when he was thinking about this stuff in Isabelle he couldn't figure out which one was "the canonical Bernoulli number" so just did both, which is why we also have both. Eberl told me that Knuth had a strong opinion about which one was "right" but that he couldn't really understand it. Knuth's opinion might be biased towards combinatorial applications anyway. My gut feeling is that it's something to do with the fact that the Riemann zeta function has a functional equation relating <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\zeta(s)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\zeta(1-s)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> and the two conventions somehow correspond to the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1-s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> points of view -- but there's something funny going on with the pole at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s=1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> which makes things inevitably asymmetric. Note that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s=1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> is in some sense the only positive odd integer value of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> for which we understand <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\zeta(s)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> in some sense.</p>



<a name="226932724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226932724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226932724">(Feb 19 2021 at 08:24)</a>:</h4>
<p>What do you mean by "we also have both"? I see only the comment "To get the "minus" convention, just use <code>(-1)^n * bernoulli n</code>." But then the formula for the corresponding power series is missing, and  <code>(-1)^n * bernoulli n</code> isn't used in any theorems or lemmas. The zeta function stuff makes sense.</p>



<a name="226933131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226933131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226933131">(Feb 19 2021 at 08:29)</a>:</h4>
<p><a href="http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html">http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html</a></p>



<a name="226934683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226934683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226934683">(Feb 19 2021 at 08:46)</a>:</h4>
<p>Wow! That's pretty polemic</p>



<a name="226935307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226935307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226935307">(Feb 19 2021 at 08:53)</a>:</h4>
<p>Oh, in some earlier version of the work we had <code>bernoulli_neg n := ...</code> for the other variant. </p>
<p>What convinced me that this was just bikeshedding was that the formula for sum of k'th powers for i&lt;n and i&lt;=n are different, of course they differ by n^k, and if you write down the polynomials of degree k+1 representing these sums then the smaller one has coefficient -1/2*n^k and the larger one +1/2*n^k. So asking about which one is best is like arguing which is best out of &lt; and &lt;=. It's not surprising that the computer scientists prefer &lt; for sums (because it's more functorial) and the number theorists prefer &lt;= (because product of power series uses i+j=n so 0&lt;=i&lt;=n). e.g. Knuth likes -1/2 and Conway likes +1/2.</p>



<a name="226935653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226935653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226935653">(Feb 19 2021 at 08:57)</a>:</h4>
<p>The other issue is that Bernoulli polynomials have this internal symmetry s -&gt; 1-s, related again I think to the functional equation of the zeta function, and the bernoulli numbers are either the values are 0 of these polynomials, or the values at 1, depending on which convention you use. The zeta function has a pole at 1 and everyone agrees with this, and I think that the two conventions are in some sense some weird consequence of this.</p>



<a name="226947304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226947304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226947304">(Feb 19 2021 at 10:50)</a>:</h4>
<p><code>bernoulli_neg</code> is now on its way! (<a href="https://github.com/leanprover-community/mathlib/pull/6309">https://github.com/leanprover-community/mathlib/pull/6309</a>) Unfortunately, I removed the <code>bernoulli_neg_power_series</code> version at the last moment, so a proof exists in previous commits. I could take a look and PR that too, if you need it, <span class="user-mention" data-user-id="313038">@Moritz Firsching</span> .</p>



<a name="226955806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226955806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226955806">(Feb 19 2021 at 12:22)</a>:</h4>
<p>Is "negative Bernoulli number" standard terminology?</p>



<a name="226955874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226955874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226955874">(Feb 19 2021 at 12:23)</a>:</h4>
<p>Otherwise I would suggest calling them <code>bernoulli'</code> or something like that.</p>



<a name="226956329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226956329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226956329">(Feb 19 2021 at 12:27)</a>:</h4>
<p>They're called bernoulli and bernoulli' in <a href="https://www.isa-afp.org/browser_info/current/AFP/Bernoulli/Bernoulli.html">Isabelle</a>, however the primed one is our bernoulli. Perhaps we should go with the "all the computer algebra packages say B_1=-1/2" idea and rename our original bernoulli numbers to the primed ones?</p>



<a name="226956845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226956845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226956845">(Feb 19 2021 at 12:32)</a>:</h4>
<p>It would be good to be consistent, to the extent possible.</p>



<a name="226957236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957236">(Feb 19 2021 at 12:37)</a>:</h4>
<p>Yeah I am now concerned that our choice of +1/2 is not used in pari-gp or on the Wolfram Alpha page. Wikipedia used two notations for them (and of course 99% of the time people are only talking about the even ones so you can use B_n unambiguously). Maybe we should redefine bernoulli to be bernoulli' and bernoulli_neg to be bernoulli.</p>



<a name="226957260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957260">(Feb 19 2021 at 12:37)</a>:</h4>
<p>In sagemath bernoulli(1) is -1/2, so I guess switching the names between bernoulli and bernoulli_neg might make sense.</p>



<a name="226957396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957396">(Feb 19 2021 at 12:38)</a>:</h4>
<p>The guy from the Manifesto thinks we made the right choice, isn't it? <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="226957446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957446">(Feb 19 2021 at 12:39)</a>:</h4>
<p>Yeah I'm not sure I'm going to place too much weight on the manifesto guy.</p>



<a name="226957602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957602">(Feb 19 2021 at 12:41)</a>:</h4>
<p>Ok so I'm assuming it's -1/2 in mathematica given that that's what it says on the wolfram alpha page, so I am definitely behind switching names. I'm not suggesting a refactor of the maths, just putting primes everywhere. I hadn't realised there was some essentially universally-agreed upon convention, I'd just read Wikipedia which as I say tended to treat both cases independently and not get drawn about "the" value of B(1).</p>



<a name="226957745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957745">(Feb 19 2021 at 12:42)</a>:</h4>
<p>is it ok to have "+" or "-" in a name, then we could take bernoulli+ and bernoulli- or since utf is working we could go with  bernoulli♯  bernoulli♭ <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="226957825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226957825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226957825">(Feb 19 2021 at 12:43)</a>:</h4>
<p><code>+</code> and <code>-</code> won't work</p>



<a name="226960464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226960464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226960464">(Feb 19 2021 at 13:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226947304">said</a>:</p>
<blockquote>
<p><code>bernoulli_neg</code> is now on its way! (<a href="https://github.com/leanprover-community/mathlib/pull/6309">https://github.com/leanprover-community/mathlib/pull/6309</a>) Unfortunately, I removed the <code>bernoulli_neg_power_series</code> version at the last moment, so a proof exists in previous commits. I could take a look and PR that too, if you need it, <span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> .</p>
</blockquote>
<p>Yes, so to summarize, I think it would be useful to have :<br>
 (1) <code>bernoulli n</code>, defined to be consistent with sagemath, parigp etc, so that bernoulli 1 = -1/2<br>
 (2) <code>bernoulli' n</code>, defined in a way that bernoulli' 1 = 1/2 substituting the name "bernoulli'" for "bernoulli" everywhere. This would mean for example that there will be already a lemma bernoulli' = 1/2.<br>
 (3) a new power_series lemma for the new bernoulli<br>
 (4) perhaps even a lemma like lemma <code>bernoulli_to_bernoulli' (n:ℕ): bernoulli n = (-1)^n * bernoulli' n</code>  and <br>
<code>bernoulli'_to_bernoulli (n:ℕ) bernoulli' n = (-1)^n * bernoulli n</code>, one of which should be true by definition. <br>
 (5) possibly something like <code>∀ x : ℕ , 1 &lt; n → bernoulli n = (-1)^n * bernoulli n</code>.</p>



<a name="226961582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226961582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226961582">(Feb 19 2021 at 13:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226957825">said</a>:</p>
<blockquote>
<p><code>+</code> and <code>-</code> won't work</p>
</blockquote>
<p><code>bernoulli«+»</code> and <code>bernoulli«-»</code> are legal... (and identical to <code>«bernoulli+»</code> and <code>«bernoulli-»</code>)</p>



<a name="226965249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226965249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226965249">(Feb 19 2021 at 13:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226960464">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226947304">said</a>:</p>
<blockquote>
<p><code>bernoulli_neg</code> is now on its way! (<a href="https://github.com/leanprover-community/mathlib/pull/6309">https://github.com/leanprover-community/mathlib/pull/6309</a>) Unfortunately, I removed the <code>bernoulli_neg_power_series</code> version at the last moment, so a proof exists in previous commits. I could take a look and PR that too, if you need it, <span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> .</p>
</blockquote>
<p>Yes, so to summarize, I think it would be useful to have :<br>
 (1) <code>bernoulli n</code>, defined to be consistent with sagemath, parigp etc, so that bernoulli 1 = -1/2<br>
 (2) <code>bernoulli' n</code>, defined in a way that bernoulli' 1 = 1/2 substituting the name "bernoulli'" for "bernoulli" everywhere. This would mean for example that there will be already a lemma bernoulli' = 1/2.<br>
 (3) a new power_series lemma for the new bernoulli<br>
 (4) perhaps even a lemma like lemma <code>bernoulli_to_bernoulli' (n:ℕ): bernoulli n = (-1)^n * bernoulli' n</code>  and <br>
<code>bernoulli'_to_bernoulli (n:ℕ) bernoulli' n = (-1)^n * bernoulli n</code>, one of which should be true by definition. <br>
 (5) possibly something like <code>∀ x : ℕ , 1 &lt; n → bernoulli n = (-1)^n * bernoulli n</code>.</p>
</blockquote>
<p>I am not a fan of changing the definition of <code>bernoulli_neg</code> or <code>bernoulli</code> (since I have now done it twice). I think <code>bernoulli_pos</code> and <code>bernoulli_neg</code> are clear? If not, <code>bernoulli'</code> and <code>bernoulli</code> seem okay too. Everything except (3) exists in the new PR, and I can add (3) soon.</p>



<a name="226965389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226965389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226965389">(Feb 19 2021 at 13:53)</a>:</h4>
<p>Just to be clear -- we're not suggesting changing any of the actual mathematics, just the names of the functions.</p>



<a name="226965545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/226965545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#226965545">(Feb 19 2021 at 13:54)</a>:</h4>
<p>And the new theorem doesn't have to be added in this PR either, but you may as well make the name change</p>



<a name="227122390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/227122390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#227122390">(Feb 20 2021 at 22:13)</a>:</h4>
<p>So I have prepared a commit with the first step towards Faulhaber's theorem.  For this I would like to obtain write access to the mathlib repo, please. My github username is mo271.</p>



<a name="227122524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/227122524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#227122524">(Feb 20 2021 at 22:15)</a>:</h4>
<p><span class="user-mention" data-user-id="313038">@Moritz Firsching</span> invitation sent!</p>



<a name="227122850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/227122850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#227122850">(Feb 20 2021 at 22:20)</a>:</h4>
<p>Many thanks, that was quick! Made the pull request..</p>



<a name="227739554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/227739554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#227739554">(Feb 25 2021 at 09:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226965249">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="313038">Moritz Firsching</span> <a href="#narrow/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers)/near/226960464">said</a>:</p>
<blockquote>
<p>[...]<br>
 (3) a new power_series lemma for the new bernoulli<br>
[...]</p>
</blockquote>
<p>I am not a fan of changing the definition of <code>bernoulli_neg</code> or <code>bernoulli</code> (since I have now done it twice). I think <code>bernoulli_pos</code> and <code>bernoulli_neg</code> are clear? If not, <code>bernoulli'</code> and <code>bernoulli</code> seem okay too. Everything except (3) exists in the new PR, and I can add (3) soon.</p>
</blockquote>
<p>I think the it's quite good to have now <code>bernoulli</code> and <code>bernoulli'</code>, thanks <span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span>!</p>
<p><a href="https://github.com/leanprover-community/mathlib/pull/6409">https://github.com/leanprover-community/mathlib/pull/6409</a> contains a proof of Faulhaber that uses the new lemmas I added during the last few days. It depends on a version of (3), namely:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="o">(</span><span class="n">exp</span> <span class="n">ℚ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">power_series.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">bernoulli</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">nat.factorial</span> <span class="n">n</span><span class="o">))</span> <span class="bp">=</span> <span class="n">X</span>
</code></pre></div>
<p>(this is using the new definition of <code>bernoulli</code>). Are you planning to add that <span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span> ?</p>



<a name="227743817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/227743817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#227743817">(Feb 25 2021 at 10:04)</a>:</h4>
<p>I have an almost complete proof, but if you have a proof ready, pls feel free to go ahead with it!</p>



<a name="228063301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/228063301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#228063301">(Feb 27 2021 at 15:03)</a>:</h4>
<p>Made a combination of both of our proofs here: <a href="https://github.com/leanprover-community/mathlib/pull/6456">https://github.com/leanprover-community/mathlib/pull/6456</a></p>



<a name="230468312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Faulhaber%27s%20Theorem%20%28sum%20of%20kth%20powers%29/near/230468312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Faulhaber's.20Theorem.20(sum.20of.20kth.20powers).html#230468312">(Mar 16 2021 at 07:14)</a>:</h4>
<p>Faulhaber's Theorem has now all dependencies resolved and is ready for review here: <a href="https://github.com/leanprover-community/mathlib/pull/6409">#6409</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>