---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/reversing.20the.20coefficients.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html">reversing the coefficients</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="200078636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200078636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200078636">(Jun 08 2020 at 10:13)</a>:</h4>
<p>in maths this would be notated as <code>x ^ deg f * f(1/x)</code></p>



<a name="200078640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200078640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200078640">(Jun 08 2020 at 10:13)</a>:</h4>
<p>this reverses the coefficients</p>



<a name="200078695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200078695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200078695">(Jun 08 2020 at 10:14)</a>:</h4>
<p>this is a monoid isomorphism if the ring is an integral domain I think</p>



<a name="200078703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200078703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200078703">(Jun 08 2020 at 10:14)</a>:</h4>
<p>should we put this in mathlib?</p>



<a name="200082943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200082943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200082943">(Jun 08 2020 at 11:06)</a>:</h4>
<p>Looks good to me. <code>polynomial.reverse</code>?</p>



<a name="200083879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200083879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200083879">(Jun 08 2020 at 11:18)</a>:</h4>
<p>this does not preserve addition of polynomials of different degrees</p>



<a name="200083909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200083909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200083909">(Jun 08 2020 at 11:19)</a>:</h4>
<p>and it is not even a bijection: the reverse of X^n is 1</p>



<a name="200083949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200083949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200083949">(Jun 08 2020 at 11:19)</a>:</h4>
<p>Right. But it shows up sufficiently often that it should have it's own definition in mathlib.</p>



<a name="200084628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200084628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200084628">(Jun 08 2020 at 11:28)</a>:</h4>
<p>I think we can be sure that reverse^3 = reverse</p>



<a name="200084642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200084642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200084642">(Jun 08 2020 at 11:28)</a>:</h4>
<p>(what is the name for this)</p>



<a name="200084662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200084662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200084662">(Jun 08 2020 at 11:29)</a>:</h4>
<p>Galois insertion</p>



<a name="200085470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085470">(Jun 08 2020 at 11:38)</a>:</h4>
<p>Maybe this should be parameterized on the maximum degree and treated as a bijection on the submodule of deg &lt;= n polynomials?</p>



<a name="200085500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085500">(Jun 08 2020 at 11:39)</a>:</h4>
<p>I don't think it is true that reverse^3 = reverse</p>



<a name="200085520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085520">(Jun 08 2020 at 11:39)</a>:</h4>
<p>why not?</p>



<a name="200085545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085545">(Jun 08 2020 at 11:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200085470">said</a>:</p>
<blockquote>
<p>Maybe this should be parameterized on the maximum degree and treated as a bijection on the submodule of deg &lt;= n polynomials?</p>
</blockquote>
<p>then we lose the fact that reverse is a monoid homomorphism</p>



<a name="200085605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085605">(Jun 08 2020 at 11:40)</a>:</h4>
<p>add monoid hom?</p>



<a name="200085617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085617">(Jun 08 2020 at 11:40)</a>:</h4>
<p>or monoid hom</p>



<a name="200085625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085625">(Jun 08 2020 at 11:40)</a>:</h4>
<p>monoid hom</p>



<a name="200085683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085683">(Jun 08 2020 at 11:41)</a>:</h4>
<p><code>reverse(pq) = x^(deg(pq)) (pq)(1/x) = x^(deg p + deg q) p(1/x) q(1/x) = [x^(deg p) p(1/x)] [x^(deg q) q(1/x)] = reverse(p) reverse(q)</code></p>



<a name="200085694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085694">(Jun 08 2020 at 11:41)</a>:</h4>
<p>the equality <code>deg(pq) = deg p + deg q</code> needs integral domain</p>



<a name="200085768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085768">(Jun 08 2020 at 11:42)</a>:</h4>
<p>I don't think you lose the monoid hom property, you just get some kind of graded multiplicativity property among the elements of the family</p>



<a name="200085874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085874">(Jun 08 2020 at 11:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200083949">said</a>:</p>
<blockquote>
<p>Right. But it shows up sufficiently often that it should have it's own definition in mathlib.</p>
</blockquote>
<p>citation?</p>



<a name="200085897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085897">(Jun 08 2020 at 11:43)</a>:</h4>
<p>My algebra course notes</p>



<a name="200085958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200085958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200085958">(Jun 08 2020 at 11:44)</a>:</h4>
<p>To me without fixing the power of x this seems like a very awkward operation for the reasons Kevin noted</p>



<a name="200086065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086065">(Jun 08 2020 at 11:45)</a>:</h4>
<p>and I thought we had already established that <code>deg</code> is not a very well behaved function and the graded family of submodules deg p &lt;= n plays much better</p>



<a name="200086086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086086">(Jun 08 2020 at 11:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> If you fix the degree, it will become</p>
<div class="codehilite"><pre><span></span><code><span class="n">reverse</span> <span class="o">(</span><span class="n">deg</span> <span class="n">p</span> <span class="bp">+</span> <span class="n">deg</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span> <span class="bp">=</span> <span class="n">reverse</span> <span class="o">(</span><span class="n">deg</span> <span class="n">p</span><span class="o">)</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">reverse</span> <span class="o">(</span><span class="n">deg</span> <span class="n">q</span><span class="o">)</span> <span class="n">q</span>
</code></pre></div>



<a name="200086149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086149">(Jun 08 2020 at 11:46)</a>:</h4>
<p>I think it's <code>reverse (m + n) (p * q) = reverse m p * reverse n q</code>, right?</p>



<a name="200086170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086170">(Jun 08 2020 at 11:46)</a>:</h4>
<p>depends on how you totalize reverse m I guess</p>



<a name="200086171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086171">(Jun 08 2020 at 11:46)</a>:</h4>
<p>but sure</p>



<a name="200086191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086191">(Jun 08 2020 at 11:47)</a>:</h4>
<p>I think the right behavior is to drop coefficients that are flipped past zero</p>



<a name="200086235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086235">(Jun 08 2020 at 11:47)</a>:</h4>
<p>does this satisfy the property?</p>



<a name="200086742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086742">(Jun 08 2020 at 11:53)</a>:</h4>
<p>Not without additional assumptions: <code>reverse 1 (x^2 + 1) = 1</code> but <code>reverse 2 (x^4 + 2x^2 + 1) = x^2 + 2</code></p>



<a name="200086811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200086811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200086811">(Jun 08 2020 at 11:54)</a>:</h4>
<p>I think it holds as long as at least one of <code>m</code> and <code>n</code> is more than its polynomial's degree</p>



<a name="200087049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087049">(Jun 08 2020 at 11:57)</a>:</h4>
<p>that is a bit unfortunate</p>



<a name="200087164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087164">(Jun 08 2020 at 11:58)</a>:</h4>
<p>Obviously this all works out much better in Laurent series</p>



<a name="200087209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087209">(Jun 08 2020 at 11:59)</a>:</h4>
<p>looks like there just is no section to the monoid surjection R[X] -&gt; R[X]/(X^n)</p>



<a name="200087381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087381">(Jun 08 2020 at 12:01)</a>:</h4>
<p>wait how does this work in laurent series</p>



<a name="200087436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087436">(Jun 08 2020 at 12:01)</a>:</h4>
<p>i dont think the result is still a Laurent series</p>



<a name="200087518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087518">(Jun 08 2020 at 12:02)</a>:</h4>
<p>Sending x^n to x^{d-n} sounds like it takes Laurent series to Laurent series to me</p>



<a name="200087554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087554">(Jun 08 2020 at 12:02)</a>:</h4>
<p>Ah, I mean Laurent polynomial</p>



<a name="200087567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087567">(Jun 08 2020 at 12:02)</a>:</h4>
<p>ah ok</p>



<a name="200087613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087613">(Jun 08 2020 at 12:03)</a>:</h4>
<p>(is a Laurent polynomial a Laurent series with finitely many nonzero terms?)</p>



<a name="200087622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087622">(Jun 08 2020 at 12:03)</a>:</h4>
<p>yeah that sounds like cheating though</p>



<a name="200087627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087627">(Jun 08 2020 at 12:03)</a>:</h4>
<p>yes</p>



<a name="200087722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087722">(Jun 08 2020 at 12:04)</a>:</h4>
<p>It pretty much is cheating, it's basically solving the problem by fiat</p>



<a name="200087773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087773">(Jun 08 2020 at 12:05)</a>:</h4>
<p>It's pushing the work into defining the appropriate truncation map from Laurent polynomials to polynomials</p>



<a name="200087789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087789">(Jun 08 2020 at 12:05)</a>:</h4>
<p>This probably extends to group rings where the monomials take exponents in a group</p>



<a name="200087865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200087865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200087865">(Jun 08 2020 at 12:06)</a>:</h4>
<p>this is just a special case of R[G] being a bifunctor</p>



<a name="200090859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200090859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200090859">(Jun 08 2020 at 12:37)</a>:</h4>
<p>The only times I've had to reverse polynomials, they were char polys, so monic and the degree was a constant which was everywhere</p>



<a name="200091656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200091656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200091656">(Jun 08 2020 at 12:45)</a>:</h4>
<p>And I guess typically the constant coefficient was nonzero...</p>



<a name="200095998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200095998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200095998">(Jun 08 2020 at 13:20)</a>:</h4>
<p>I was actually reminded by this when it was implicitly used in <a href="https://math.berkeley.edu/~hwl/papers/witt.pdf">the paper I linked in the Witt vector paper</a> where every monic polynomial splits in some ring and as a consequence every polynomial with constant coefficient 1 splits</p>



<a name="200097232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200097232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200097232">(Jun 08 2020 at 13:30)</a>:</h4>
<p>So I was in exactly this situation where the only polynomials I ever reversed were either monic or had constant coeff 1. It's a bijection between these two things, perhaps even an iso of multiplicative monoids</p>



<a name="200116438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200116438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200116438">(Jun 08 2020 at 15:42)</a>:</h4>
<p>I vote for having a name for <code>x ^ n * f(1 / x)</code> where <code>deg f ≤ n</code>. If it has better properties in case <code>n = deg f</code>, then we can have two names.</p>



<a name="200117165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/200117165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#200117165">(Jun 08 2020 at 15:47)</a>:</h4>
<p>My thoughts are to associate the name to <code>x ^ n * f(1 / x)</code> without the constraint but with <code>deg f ≤ n</code> being the soft domain of the function. I don't think it will be used enough to justify the added convenience of no side assumptions in the multiplication theorem</p>



<a name="205944903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205944903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205944903">(Aug 04 2020 at 18:47)</a>:</h4>
<p>Reviving this, I'll note that some version of reverse would have been immensely useful when defining <code>next_coeff</code></p>



<a name="205945127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205945127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205945127">(Aug 04 2020 at 18:48)</a>:</h4>
<p>and sooner or later we will need to define Laurent polynomials and Laurent series. I imagine defining Laurent polynomials as <code>monoid_algebra _ Z</code> would be fine, but I'm not sure if there's any way to flesh out their API except copy-pasting the ridiculous amount of code on polynomials</p>



<a name="205945269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205945269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205945269">(Aug 04 2020 at 18:49)</a>:</h4>
<p>doubly-infinite Laurent series could similarly be defined by duplicating the API of power series</p>



<a name="205945497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205945497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205945497">(Aug 04 2020 at 18:51)</a>:</h4>
<p>and Laurent series could be defined either as a <code>subring</code> of doubly-infinite Laurent series or as pairs <code>(order : Z, x : power_series)</code> where <code>x</code> has a nonzero constant term</p>



<a name="205945556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205945556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205945556">(Aug 04 2020 at 18:51)</a>:</h4>
<p>You can't multiply arbitrary doubly infinite series.</p>



<a name="205946178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205946178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205946178">(Aug 04 2020 at 18:56)</a>:</h4>
<p>What do you mean by "doubly-infinite Laurent series"?</p>



<a name="205946764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205946764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205946764">(Aug 04 2020 at 19:01)</a>:</h4>
<p>In case it's not clear: <br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>T</mi><mi>i</mi></msup><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>T</mi><mi>i</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex"> (\sum_{i = -\infty}^\infty T^i) \cdot  (\sum_{i = -\infty}^\infty T^i) = ?</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.182705em;vertical-align:-0.35804100000000005em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35804100000000005em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.182705em;vertical-align:-0.35804100000000005em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35804100000000005em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mclose">?</span></span></span></span>.</p>



<a name="205947622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205947622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205947622">(Aug 04 2020 at 19:08)</a>:</h4>
<p>And then Puiseux series and then Hahn series <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="205949113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205949113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205949113">(Aug 04 2020 at 19:24)</a>:</h4>
<p>Since polynomial rings,  power series rings, and localizations already exist, why not define the laurent polynomials resp. laurent series as the localization of polynomials resp. power series at the element <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>?</p>



<a name="205965603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205965603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205965603">(Aug 04 2020 at 21:53)</a>:</h4>
<p>You can do some things with doubly-infinite Laurent series, defined as above, but you’re right, they’re not a ring, so they’re probably better made ad hoc for compex analysis applications later</p>



<a name="205965701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205965701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205965701">(Aug 04 2020 at 21:54)</a>:</h4>
<p>Defining the others with localisation, however, sounds like it could be done now</p>



<a name="205966187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205966187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205966187">(Aug 04 2020 at 22:00)</a>:</h4>
<p>If you have some sort of topology on your base ring making it complete then you can look at doubly infinite power series which converge in certain regions, and these can be rings</p>



<a name="205966212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205966212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205966212">(Aug 04 2020 at 22:00)</a>:</h4>
<p>Such things come up in p-adic Hodge theory</p>



<a name="205966255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/205966255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#205966255">(Aug 04 2020 at 22:00)</a>:</h4>
<p>These usually show up as completions of localizations though.</p>



<a name="208815753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208815753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208815753">(Sep 02 2020 at 12:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200086065">said</a>:</p>
<blockquote>
<p>and I thought we had already established that <code>deg</code> is not a very well behaved function and the graded family of submodules deg p &lt;= n plays much better</p>
</blockquote>
<p>I probably was one of the people helping to establish this -- but I now realise that <code>deg </code> is very well-behaved: it's a valuation (or more precisely 37^(-deg) is). You should think of it as the size of the pole at 0 of f(T^{-1}). Note that in p-adic numbers the valuation is 37^(+something). The sign difference means that the nice submodules coming from the p-adic valuation are v &gt;= n, whereas the nice submodules coming from the degree valuation are d &lt;= n.</p>



<a name="208815975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208815975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208815975">(Sep 02 2020 at 12:30)</a>:</h4>
<p>You are not allowed to use <code>0.37</code> as a junk value, only <code>37</code>. So your post should read "<code>37^(-deg)</code> is".</p>



<a name="208816091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208816091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208816091">(Sep 02 2020 at 12:32)</a>:</h4>
<p>Fixed, thanks.</p>



<a name="208816311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208816311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208816311">(Sep 02 2020 at 12:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208815753">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200086065">said</a>:</p>
<blockquote>
<p>and I thought we had already established that <code>deg</code> is not a very well behaved function and the graded family of submodules deg p &lt;= n plays much better</p>
</blockquote>
<p>I probably was one of the people helping to establish this -- but I now realise that <code>deg </code> is very well-behaved: it's a valuation (or more precisely 37^(-deg) is). You should think of it as the size of the pole at 0 of f(T^{-1}). Note that in p-adic numbers the valuation is 37^(+something). The sign difference means that the nice submodules coming from the p-adic valuation are v &gt;= n, whereas the nice submodules coming from the degree valuation are d &lt;= n.</p>
</blockquote>
<p>Indeed!  This is why I called <code>at_infty</code> the <code>reverse</code> that I was defining.  But I think that it is not yet implemented, unfortunately.</p>



<a name="208817255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817255">(Sep 02 2020 at 12:42)</a>:</h4>
<p><code>deg</code> only makes mathematical sense if it is allowed to take a -infty like value at zero</p>



<a name="208817275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817275">(Sep 02 2020 at 12:42)</a>:</h4>
<p>but that doesn't play well with lean's types</p>



<a name="208817280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817280">(Sep 02 2020 at 12:42)</a>:</h4>
<p>yes, and that's exactly why Johan wrote group_with_zero</p>



<a name="208817481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817481">(Sep 02 2020 at 12:44)</a>:</h4>
<p>I agree that deg is basically a valuation, but I'm not convinced valuations are any easier to work with than deg</p>



<a name="208817519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817519">(Sep 02 2020 at 12:45)</a>:</h4>
<p>no, but it frames your understanding of what you can expect from them.</p>



<a name="208817568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817568">(Sep 02 2020 at 12:45)</a>:</h4>
<p>the family of submodules approach seems much more formal friendly</p>



<a name="208817643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208817643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208817643">(Sep 02 2020 at 12:46)</a>:</h4>
<p>but if you've written thousands of lines of a code in a perfectoid project whose line 1 is the definition of a valuation, then you get a feeling for them :-)</p>



<a name="208849209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208849209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208849209">(Sep 02 2020 at 16:12)</a>:</h4>
<p>Perhaps the lesson is that the family of submodules approach is useful for valuations, among which is <code>deg</code>...</p>



<a name="208928205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928205">(Sep 03 2020 at 07:11)</a>:</h4>
<p>In case people find it useful, I have defined a command <code>at_infty</code> taking as input a polynomial <code>p</code> and returning the polynomial <code>at_infty p</code>, whose coefficients are reversed, starting from <code>nat_degree p</code>.  The <code>0</code> polynomial is sent to itself.  I have not yet proved that <code>at_infty</code> maps products of polynomials to products, though.</p>
<p>The relevant Lean file is here:</p>
<p><a href="https://gist.github.com/adomani/f1c468b8812a55e12e95bff954b3596f">https://gist.github.com/adomani/f1c468b8812a55e12e95bff954b3596f</a></p>



<a name="208928676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928676">(Sep 03 2020 at 07:17)</a>:</h4>
<p>Nice! <span class="user-mention" data-user-id="321459">@Damiano Testa</span> If you clean this up a bit, I think it would make a really nice first PR</p>



<a name="208928709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928709">(Sep 03 2020 at 07:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208928676">said</a>:</p>
<blockquote>
<p>Nice! <span class="user-mention silent" data-user-id="321459">Damiano Testa</span> If you clean this up a bit, I think it would make a really nice first PR</p>
</blockquote>
<p>I will try!  Sadly, I thought that I had already cleaned it up...  Ahahaha</p>



<a name="208928781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928781">(Sep 03 2020 at 07:18)</a>:</h4>
<p>It's hard to learn those tricks out of the blue. It might be very helpful to do the cleaning up in a pair programming session</p>



<a name="208928810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928810">(Sep 03 2020 at 07:18)</a>:</h4>
<p>I'll be leaving on a camping trip in 30 minutes... so I can't really help before Monday.</p>



<a name="208928811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928811">(Sep 03 2020 at 07:18)</a>:</h4>
<p>If you are offering, I am happy to do it now</p>



<a name="208928820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928820">(Sep 03 2020 at 07:18)</a>:</h4>
<p>ok, then I will wait!</p>



<a name="208928824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928824">(Sep 03 2020 at 07:18)</a>:</h4>
<p>But I'm sure others can help with it.</p>



<a name="208928831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928831">(Sep 03 2020 at 07:18)</a>:</h4>
<p>have fun on your camping trip!</p>



<a name="208928835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208928835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208928835">(Sep 03 2020 at 07:19)</a>:</h4>
<p>Thanks!</p>



<a name="208934127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208934127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208934127">(Sep 03 2020 at 08:16)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> I did a cleanup pass to put it in my understanding of mathlib style.</p>
<ol>
<li>Make sure to use two spaces for indentation</li>
<li>Curly braces and operators need one space around them</li>
<li>If you use <code>simp</code> or <code>tidy</code>, make sure it is a finishing tactic.  Otherwise use <code>squeeze_simp</code> to get a <code>simp only [...]</code>, or <code>tidy?</code> to get some tactic block to clean up.</li>
<li>Join consecutive <code>rw</code> tactics into a single <code>rw [...]</code> tactic.  Sometimes you can merge this with <code>simp</code>.</li>
<li>It's usually better to use named fields rather than positional ones.</li>
<li>I prefer parentheses for quantifier variables, but I don't think that's required.</li>
<li>Usually, <code>by exact</code> is unnecessary, and you can set the proof term with <code>:=</code>.</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span><span class="bp">.</span><span class="n">degree</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kn">lemma</span> <span class="n">finset_of_bounded</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">nN</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="err">∈</span> <span class="n">S</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">}</span> <span class="o">:</span> <span class="n">S</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span>
<span class="n">set</span><span class="bp">.</span><span class="n">finite</span><span class="bp">.</span><span class="n">subset</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">finite_le_nat</span> <span class="n">N</span><span class="o">)</span> <span class="n">nN</span>

<span class="kn">lemma</span> <span class="n">le_degree_of_mem_supp</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">a</span> <span class="err">∈</span> <span class="n">p</span><span class="bp">.</span><span class="n">support</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">nat_degree</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">p</span><span class="bp">.</span><span class="n">mem_support_to_fun</span><span class="o">,</span>
  <span class="n">contrapose</span><span class="o">,</span>
  <span class="n">push_neg</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">coeff_eq_zero_of_nat_degree_lt</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">rev_at</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="bp">+</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">i</span> <span class="bp">-</span> <span class="n">N</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">rev_invol</span> <span class="o">{</span><span class="n">N</span> <span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">rev_at</span> <span class="n">N</span> <span class="o">(</span><span class="n">rev_at</span> <span class="n">N</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="n">i</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">,</span>
  <span class="o">{</span> <span class="k">have</span> <span class="n">min10</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">min_zero</span> <span class="mi">1</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">NiN</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">N</span> <span class="n">i</span><span class="o">),</span>
    <span class="n">convert</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_sub_self</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">h</span><span class="o">,</span> <span class="n">min10</span><span class="o">,</span> <span class="n">NiN</span><span class="o">],</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">not_le</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">iN</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_le_of_lt</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_pos_of_lt</span> <span class="n">h</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">Ni0</span> <span class="o">:</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">omega</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">min1iN</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">i</span> <span class="bp">-</span> <span class="n">N</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">min_eq_left</span> <span class="n">iN</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">min1iN</span><span class="o">,</span> <span class="n">Ni0</span><span class="o">,</span> <span class="n">min1iN</span><span class="o">],</span> <span class="o">},</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">rev_support</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">b</span> <span class="err">∈</span> <span class="n">p</span><span class="bp">.</span><span class="n">support</span> <span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">rev_at</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span> <span class="n">b</span><span class="o">}</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">finset_of_bounded</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">),</span>
  <span class="n">rintros</span> <span class="n">n</span> <span class="bp">⟨</span><span class="n">rn</span><span class="o">,</span> <span class="n">rnsupp</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">zerr</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">rn</span> <span class="o">:=</span> <span class="n">zero_le</span> <span class="n">rn</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">rle</span> <span class="o">:</span> <span class="n">rn</span> <span class="bp">≤</span> <span class="n">nat_degree</span> <span class="n">p</span> <span class="o">:=</span> <span class="n">le_degree_of_mem_supp</span> <span class="n">rn</span> <span class="n">rnsupp</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">rneq</span> <span class="o">:</span> <span class="o">(</span><span class="n">rn</span> <span class="bp">-</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">rle</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">rn</span> <span class="bp">-</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">rneq</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">min_zero</span> <span class="mi">1</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">],</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">rn</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">at_infty</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="o">(</span><span class="n">rev_support</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">to_finset</span><span class="o">,</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">p</span><span class="bp">.</span><span class="n">to_fun</span> <span class="o">(</span><span class="n">rev_at</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span> <span class="n">i</span><span class="o">)),</span> <span class="k">begin</span>
  <span class="n">intros</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">finite</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_support_iff</span><span class="o">,</span> <span class="n">ne</span><span class="bp">.</span><span class="n">def</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">mem_set_of_eq</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">hb₂</span><span class="bp">⟩</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">subst</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">congr_arg</span> <span class="n">p</span><span class="bp">.</span><span class="n">to_fun</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">rev_invol</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">rev_at</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">exact</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="n">rev_invol</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">,</span> <span class="o">},</span>
<span class="kn">end</span><span class="bp">⟩</span>
</code></pre></div>



<a name="208935120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208935120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208935120">(Sep 03 2020 at 08:26)</a>:</h4>
<p>One more simplification: in <code>rev_support</code>, one sequence of tactics had the effect of substituting a variable in another expression.  If you use <code>rintros</code>, you can place <code>rfl</code> where that equality is to auto-substitute.  (I updated the message above.)</p>



<a name="208935347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208935347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208935347">(Sep 03 2020 at 08:29)</a>:</h4>
<p>Also, in <code>le_degree_of_mem_supp</code>, the variable <code>a</code> can be implicit, as it can be inferred from <code>a ∈ p.support</code>.</p>



<a name="208935766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208935766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208935766">(Sep 03 2020 at 08:32)</a>:</h4>
<p>With Sebastien's suggestion, a few more simplifications, some (questionably better?) renamings, and using <code>function.involutive</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span><span class="bp">.</span><span class="n">degree</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">open</span> <span class="n">function</span> <span class="n">polynomial</span>

<span class="kn">lemma</span> <span class="n">finset_of_bounded</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">nN</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="err">∈</span> <span class="n">S</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">}</span> <span class="o">:</span> <span class="n">S</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span>
<span class="n">set</span><span class="bp">.</span><span class="n">finite</span><span class="bp">.</span><span class="n">subset</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">finite_le_nat</span> <span class="n">N</span><span class="o">)</span> <span class="n">nN</span>

<span class="kn">lemma</span> <span class="n">le_degree_of_mem_supp</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">a</span> <span class="err">∈</span> <span class="n">p</span><span class="bp">.</span><span class="n">support</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">nat_degree</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">p</span><span class="bp">.</span><span class="n">mem_support_to_fun</span><span class="o">,</span>
  <span class="n">contrapose</span><span class="o">,</span>
  <span class="n">push_neg</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">coeff_eq_zero_of_nat_degree_lt</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">rev_at</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="bp">+</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">i</span> <span class="bp">-</span> <span class="n">N</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">rev_at_invol</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">involutive</span> <span class="o">(</span><span class="n">rev_at</span> <span class="n">N</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_sub_self</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">NiN</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">N</span> <span class="n">i</span><span class="o">),</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">h</span><span class="o">,</span> <span class="n">NiN</span><span class="o">],</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">not_le</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">Ni0</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">omega</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">iN</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_le_of_lt</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_pos_of_lt</span> <span class="n">h</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">min1iN</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">i</span> <span class="bp">-</span> <span class="n">N</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">min_eq_left</span> <span class="n">iN</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">Ni0</span><span class="o">,</span> <span class="n">min1iN</span><span class="o">],</span> <span class="o">},</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">rev_at_support</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">b</span> <span class="err">∈</span> <span class="n">p</span><span class="bp">.</span><span class="n">support</span><span class="o">),</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">rev_at</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span> <span class="n">b</span><span class="o">}</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">finset_of_bounded</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">),</span>
  <span class="n">rintros</span> <span class="n">n</span> <span class="bp">⟨</span><span class="n">rn</span><span class="o">,</span> <span class="n">rnsupp</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">rle</span> <span class="o">:</span> <span class="n">rn</span> <span class="bp">≤</span> <span class="n">nat_degree</span> <span class="n">p</span> <span class="o">:=</span> <span class="n">le_degree_of_mem_supp</span> <span class="n">rnsupp</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">rn</span> <span class="bp">-</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">rle</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">min_zero</span> <span class="mi">1</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">rn</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">at_infty</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="o">(</span><span class="n">rev_at_support</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">to_finset</span><span class="o">,</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">p</span><span class="bp">.</span><span class="n">to_fun</span> <span class="o">(</span><span class="n">rev_at</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span> <span class="n">i</span><span class="o">)),</span> <span class="k">begin</span>
  <span class="n">intros</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">finite</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_support_iff</span><span class="o">,</span> <span class="n">ne</span><span class="bp">.</span><span class="n">def</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">mem_set_of_eq</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">congr_arg</span> <span class="n">p</span><span class="bp">.</span><span class="n">to_fun</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">rev_at_invol</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">rev_at</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">exact</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">rev_at_invol</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">,</span> <span class="o">},</span>
<span class="kn">end</span><span class="bp">⟩</span>
</code></pre></div>



<a name="208938116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208938116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208938116">(Sep 03 2020 at 08:54)</a>:</h4>
<p>Dear <span class="user-mention" data-user-id="306601">@Kyle Miller</span> and <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span>, thank you very much for your input!  I was with a student, but I will take a look at your improvements and will learn them for future use!</p>



<a name="208938124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208938124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208938124">(Sep 03 2020 at 08:54)</a>:</h4>
<p>One more thing that's needed is to add <code>/-- documentation comments -/</code> for the definitions.</p>



<a name="208939026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208939026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208939026">(Sep 03 2020 at 09:03)</a>:</h4>
<p>I guess also <code>p.to_fun</code> is sort of against the API for polynomials.  It should probably be <code>p.coeff</code> instead:</p>
<div class="codehilite"><pre><span></span><code><span class="n">noncomputable</span> <span class="n">def</span> <span class="n">at_infty</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="o">(</span><span class="n">rev_at_support</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">to_finset</span><span class="o">,</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">p</span><span class="bp">.</span><span class="n">coeff</span> <span class="o">(</span><span class="n">rev_at</span> <span class="o">(</span><span class="n">nat_degree</span> <span class="n">p</span><span class="o">)</span> <span class="n">i</span><span class="o">)),</span> <span class="k">begin</span>
  <span class="n">intros</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">finite</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_support_iff</span><span class="o">,</span> <span class="n">ne</span><span class="bp">.</span><span class="n">def</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">mem_set_of_eq</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">congr_arg</span> <span class="n">p</span><span class="bp">.</span><span class="n">coeff</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">rev_at_invol</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">rev_at</span> <span class="n">p</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">exact</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">rev_at_invol</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">,</span> <span class="o">},</span>
<span class="kn">end</span><span class="bp">⟩</span>
</code></pre></div>



<a name="208940993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208940993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208940993">(Sep 03 2020 at 09:23)</a>:</h4>
<p>You should also prove a lemma which identifies the coefficients of <code>at_infty p</code>, along with other lemmas that are likely to be useful (if you have a particular use in mind, it may suggest such lemmas).</p>



<a name="208941240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208941240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208941240">(Sep 03 2020 at 09:25)</a>:</h4>
<p>Just so we are all on the same page: we are not aiming for readability of the final code, correct?</p>
<p>for instance is</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">rev_at_invol</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">involutive</span> <span class="o">(</span><span class="n">rev_at</span> <span class="n">N</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">N</span> <span class="n">i</span><span class="o">),</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">h</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_sub_self</span> <span class="n">h</span><span class="o">],</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">not_le</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="o">(</span><span class="n">h</span><span class="o">)),</span> <span class="n">min_eq_left</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_le_of_lt</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_pos_of_lt</span> <span class="n">h</span><span class="o">))],</span> <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>


<p>preferable to</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">rev_at_invol</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">involutive</span> <span class="o">(</span><span class="n">rev_at</span> <span class="n">N</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">rev_at</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_sub_self</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">NiN</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_le</span> <span class="n">N</span> <span class="n">i</span><span class="o">),</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="n">h</span><span class="o">,</span> <span class="n">NiN</span><span class="o">],</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">not_le</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">Ni0</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">omega</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">iN</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">i</span> <span class="bp">-</span> <span class="n">N</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_le_of_lt</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_pos_of_lt</span> <span class="n">h</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">min1iN</span> <span class="o">:</span> <span class="n">min</span> <span class="mi">1</span> <span class="o">(</span><span class="n">i</span> <span class="bp">-</span> <span class="n">N</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">min_eq_left</span> <span class="n">iN</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">Ni0</span><span class="o">,</span> <span class="n">min1iN</span><span class="o">],</span> <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>


<p>?</p>



<a name="208941382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208941382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208941382">(Sep 03 2020 at 09:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208940993">said</a>:</p>
<blockquote>
<p>You should also prove a lemma which identifies the coefficients of <code>at_infty p</code>, along with other lemmas that are likely to be useful (if you have a particular use in mind, it may suggest such lemmas).</p>
</blockquote>
<p>Ok, I will include that as well!  I was going to also prove that <code>at_infty</code> is "close to" an involution</p>



<a name="208942127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208942127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208942127">(Sep 03 2020 at 09:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208941240">said</a>:</p>
<blockquote>
<p>Just so we are all on the same page: we are not aiming for readability of the final code, correct?</p>
</blockquote>
<p>I think it depends on how readable you think it should be.  Part of mathlib style seems to be to not care about readability of trivial statements.</p>
<p>I usually avoid writing proof terms that are too nested, which is why I kept it in the second form rather than putting it into the first.  If it were <code>rw</code> rather than <code>simp</code>, I might go with the first, but that's because you can still step through each rewrite, where <code>simp</code> does things in a more opaque way.</p>



<a name="208942219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208942219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208942219">(Sep 03 2020 at 09:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208942127">said</a>:</p>
<blockquote>
<p>I usually avoid writing proof terms that are too nested, which is why I kept it in the second form rather than putting it into the first.  If it were <code>rw</code> rather than <code>simp</code>, I might go with the first, but that's because you can still step through each rewrite, where <code>simp</code> does things in a more opaque way.</p>
</blockquote>
<p>Ok, thank you for your input!</p>



<a name="208942383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208942383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208942383">(Sep 03 2020 at 09:37)</a>:</h4>
<p>(These are just my tastes in functional programming -- I'm not an authority in any way, to be clear!)</p>



<a name="208942933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208942933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208942933">(Sep 03 2020 at 09:43)</a>:</h4>
<p>Sure, but your comments help me, nonetheless!</p>



<a name="208952987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208952987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208952987">(Sep 03 2020 at 11:32)</a>:</h4>
<p>Re readability: I think the philosophy is that short assertions which are obvious to any mathematician can be golfed to obscurity, because nobody wants to read the actual proof that deg(fg)=deg(f)deg(g) in an integral domain, it's obvious. Longer proofs which might naturally be proved in tactic mode can still be heavily golfed, because the shorter the code, the quicker it will compile, but if you want to flag something about your proof then you can do it in the module docstring at the top of the file.</p>



<a name="208953643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208953643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208953643">(Sep 03 2020 at 11:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208952987">said</a>:</p>
<blockquote>
<p>Re readability: I think the philosophy is that short assertions which are obvious to any mathematician can be golfed to obscurity, because nobody wants to read the actual proof that deg(fg)=deg(f)deg(g) in an integral domain, it's obvious. Longer proofs which might naturally be proved in tactic mode can still be heavily golfed, because the shorter the code, the quicker it will compile, but if you want to flag something about your proof then you can do it in the module docstring at the top of the file.</p>
</blockquote>
<p>Thanks!  I like the suggestion of obscuring into the code steps that are completely clear!  As I find that most of these results are pretty straightforward mathematically, I may opt for a shorter version, when I can find one!</p>



<a name="208953722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208953722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208953722">(Sep 03 2020 at 11:40)</a>:</h4>
<p>Is there a way to have <code>rw</code> only rewrite something, but not everything?</p>



<a name="208953830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208953830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208953830">(Sep 03 2020 at 11:41)</a>:</h4>
<p><a href="https://leanprover-community.github.io/extras/conv.html">https://leanprover-community.github.io/extras/conv.html</a></p>



<a name="208953914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208953914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208953914">(Sep 03 2020 at 11:42)</a>:</h4>
<p>also read <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/rewrite.20at.20a.20specific.20variable.3F">https://leanprover.zulipchat.com/#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/rewrite.20at.20a.20specific.20variable.3F</a></p>



<a name="208953953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208953953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208953953">(Sep 03 2020 at 11:42)</a>:</h4>
<p>Ah, I had read about <code>conv</code> and have never been able to use it...  I will try once more!  Thanks!</p>



<a name="208954007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208954007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208954007">(Sep 03 2020 at 11:43)</a>:</h4>
<p>If you post a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> where you can't get <code>conv</code> to work we could help.</p>



<a name="208954807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208954807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208954807">(Sep 03 2020 at 11:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/208954007">said</a>:</p>
<blockquote>
<p>If you post a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> where you can't get <code>conv</code> to work we could help.</p>
</blockquote>
<p>While trying to produce a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>, I realized that I may not have found the minimal path to my proof.  I will try to streamline everything and will post something again, once I have a shorter question.</p>
<p>Thanks for the offer of help, though!</p>



<a name="208962444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/208962444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#208962444">(Sep 03 2020 at 13:00)</a>:</h4>
<p>I would like to prove that the degree of <code>at_infty p</code> is the <code>degree p - p.support.inf</code>.  Unfortunately, this assertion is riddled with <code>with_bot</code>s and <code>option</code>s and I cannot even produce a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>.  Of course, the only issue arises with <code>p=0</code>, since otherwise all the <code>with_bot</code> and <code>option</code>s really are not there.  Nevertheless, I am unable to navigate this.  Can someone write for me a lemma asserting the mathematical fact that <code>degree (at_infty p) = degree p - p.support.inf</code>, whenever there are no weird options and it is <code>none</code> otherwise?</p>
<p>Thank you very much!</p>



<a name="209184747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/209184747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#209184747">(Sep 05 2020 at 16:10)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> There is also <code>nat_degree</code>... does that make your life easier?</p>



<a name="209184792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/209184792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#209184792">(Sep 05 2020 at 16:10)</a>:</h4>
<p>It takes values in <code>nat</code>, and it is equal to <code>p.degree</code>, except for <code>p = 0</code>.</p>



<a name="209185492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/209185492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#209185492">(Sep 05 2020 at 16:29)</a>:</h4>
<p>Thanks!  I found the command, but have been having some difficulties navigating between the two: many lemmas intertwine between the two notions and I have been unable to separate them effectively</p>



<a name="209185619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/209185619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#209185619">(Sep 05 2020 at 16:32)</a>:</h4>
<p>Yup... it's a bit of a dark art to figure out which one is best for the application at hand (-;</p>



<a name="212055198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212055198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212055198">(Oct 02 2020 at 10:04)</a>:</h4>
<p>Dear All,</p>
<p>in case anyone is interested, I wrote a proof of the equality </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">reverse</span> <span class="o">(</span><span class="n">f</span><span class="bp">*</span><span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="n">reverse</span> <span class="n">f</span> <span class="bp">*</span> <span class="n">reverse</span> <span class="n">g</span>
</code></pre></div>

<p>in the case in which the leading coefficients do not multiply to zero.  This assumption can be dropped, modifying slightly the definition of <code>reverse</code> (in the file, the modification is called <code>reflect _ </code>).</p>
<p>The proof is essentially by induction on the number of terms of a polynomial: this might already exist in Lean, in which case the file can be substantially shortened!</p>
<p>If anyone has any comments, I would be more than happy to hear them, though maybe in an hour, since I am going for lunch right now!</p>
<p><a href="https://gist.github.com/adomani/4490b69b4a8627e24dae54decaf3f888">https://gist.github.com/adomani/4490b69b4a8627e24dae54decaf3f888</a></p>



<a name="212058395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212058395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212058395">(Oct 02 2020 at 10:43)</a>:</h4>
<p>Awesome! I don't think we have that induction principle. Looking forward to the PRs (-;</p>



<a name="212096515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212096515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212096515">(Oct 02 2020 at 16:19)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4364">#4364</a></p>



<a name="212097375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212097375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212097375">(Oct 02 2020 at 16:26)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Great! But it's a rather big PR, I think. Can you split it in two?</p>



<a name="212097558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212097558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212097558">(Oct 02 2020 at 16:28)</a>:</h4>
<p>I can probably move stuff from there to data.polynomial.degree.basic, though maybe it will have to wait until Monday</p>



<a name="212098203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212098203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212098203">(Oct 02 2020 at 16:33)</a>:</h4>
<p>Btw, <span class="user-mention" data-user-id="112680">@Johan Commelin</span> does moving stuff around count as splitting or not?</p>



<a name="212100005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212100005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212100005">(Oct 02 2020 at 16:50)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> I think that with PRs that are &lt;= 300 lines you get more and better reviews. See also the following blog post<br>
<a href="https://unhashable.com/stacked-pull-requests-keeping-github-diffs-small/">https://unhashable.com/stacked-pull-requests-keeping-github-diffs-small/</a></p>



<a name="212123448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212123448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212123448">(Oct 02 2020 at 20:16)</a>:</h4>
<p>I left some reviews on the first few lemmas, and agree that a lot of stuff should be moved, and then you should split it into multiple PRs, classified mostly on which files you're editing.</p>



<a name="212123628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212123628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212123628">(Oct 02 2020 at 20:17)</a>:</h4>
<p>Ok, do I need to create separate branches for each file that I want to edit?</p>



<a name="212123698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212123698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212123698">(Oct 02 2020 at 20:18)</a>:</h4>
<p>Also, thank you very much for the reviews and the interest!</p>



<a name="212124353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124353">(Oct 02 2020 at 20:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/212123628">said</a>:</p>
<blockquote>
<p>Ok, do I need to create separate branches for each file that I want to edit?</p>
</blockquote>
<p>No, but I'd try to get 2 or 3 PRs each editing only 2 or 3 files if you can.</p>



<a name="212124474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124474">(Oct 02 2020 at 20:24)</a>:</h4>
<p>For instance, all the stuff that's really about <code>finset</code>s or <code>finset.min', finset.max'</code> without getting into polynomials could be a good PR to start with.</p>



<a name="212124509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124509">(Oct 02 2020 at 20:25)</a>:</h4>
<p>Ok, I will learn how to split the PR!</p>



<a name="212124530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124530">(Oct 02 2020 at 20:25)</a>:</h4>
<p>I am reading your comment right now: they are super helpful!</p>



<a name="212124581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124581">(Oct 02 2020 at 20:26)</a>:</h4>
<p>I will answer and edit the file properly once I am on the computer, likely on Monday</p>



<a name="212124678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212124678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212124678">(Oct 02 2020 at 20:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/212124509">said</a>:</p>
<blockquote>
<p>Ok, I will learn how to split the PR!</p>
</blockquote>
<p>I think the easiest thing to do is just to start a new branch and copy-paste, then once that PR merges into master, you merge master back into your original PR. I'm no git expert though, so other people might have better suggestions.</p>



<a name="212125108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212125108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212125108">(Oct 02 2020 at 20:31)</a>:</h4>
<p>This is already a better suggestion than what I had in mind: I was going to copy the files outside of the branch and then gradually add a trickle of lemmas in small chunks!</p>



<a name="212125176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212125176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212125176">(Oct 02 2020 at 20:31)</a>:</h4>
<p>Johan's link of <a href="https://unhashable.com/stacked-pull-requests-keeping-github-diffs-small/">https://unhashable.com/stacked-pull-requests-keeping-github-diffs-small/</a> is a great git guide to how to stack the PR. That way you can break it out in manageable pieces in more robsut ways than just copy-paste.</p>



<a name="212125269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212125269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212125269">(Oct 02 2020 at 20:32)</a>:</h4>
<p>But rather, piecewise add things though commits. A git commit doesn't have to commit an entire file, it can be just a piece of it (often called a hunk).</p>



<a name="212125638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212125638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212125638">(Oct 02 2020 at 20:35)</a>:</h4>
<p>Ok, I was reading the file, but will need to experiment with it, before I feel comfortable with its content!</p>



<a name="212145229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212145229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212145229">(Oct 03 2020 at 00:57)</a>:</h4>
<p>Because mathlib uses the "squash merge" strategy for dealing with PRs, remember that your commit history on a PR branch is completely irrelevant. You can make it as messy as you like!</p>
<p>In particular, I'd recommend not bothering with <code>git rebase</code> (and please don't force push to PR branches). You can just keep merging master into later branches as earlier PR branches get merged.</p>



<a name="212155210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155210">(Oct 03 2020 at 05:59)</a>:</h4>
<p>Is there a good strategy for using git to revert the accidental edits to the weird vscode file?</p>



<a name="212155774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155774">(Oct 03 2020 at 06:16)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>git checkout master -- path/to/weird/vscode/file
git commit
</code></pre></div>



<a name="212155775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155775">(Oct 03 2020 at 06:16)</a>:</h4>
<p>What versions do you have in git history?</p>



<a name="212155787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155787">(Oct 03 2020 at 06:17)</a>:</h4>
<p>If you want to revert all your edits in a file restoring the version from <code>HEAD</code>, then <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>



<a name="212155793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155793">(Oct 03 2020 at 06:18)</a>:</h4>
<p>If you want to revert only some of your edits, then it's less trivial but is still possible.</p>



<a name="212155843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155843">(Oct 03 2020 at 06:18)</a>:</h4>
<p>There are git GUIs that let you revert specific chunks of the current <code>git diff</code>.</p>



<a name="212155901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155901">(Oct 03 2020 at 06:20)</a>:</h4>
<p>Of course, you can do the same in command line (e.g., add good edits using <code>git add -p</code>, then commit, then see <span class="user-mention" data-user-id="112680">@Johan Commelin</span> 's answer) but it's less convenient.</p>



<a name="212155983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212155983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212155983">(Oct 03 2020 at 06:23)</a>:</h4>
<p>I use Emacs + magit, and it allows me to compare any two revisions (or compare any revision to the current version) and apply/revert specific hunks of the diff. I guess, other GUIs and editor plug-ins should have similar functionality.</p>



<a name="212157679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212157679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212157679">(Oct 03 2020 at 07:08)</a>:</h4>
<p>Dear All,</p>
<p>I still do not feel comfortable with doing several small PRs, but I have broken up the main file into 4 files.  Two of them, <code>to_basic</code> and <code>to_trailing_degree</code> contain lemmas that I think should go into the corresponding files.  The remaining two files are called <code>erase_leading</code> and <code>reverse</code>.</p>
<p><code>erase_leading</code> introduces and establishes some properties of the polynomial <code>f - f.leading_coeff * X ^ f.nat_degree</code>.<br>
<code>reverse</code> proves that reversal of the coefficients is essentially multiplicative.</p>
<p>I hope that this is a reasonable compromise, while I understand how to produce smaller PRs!</p>



<a name="212157940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212157940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212157940">(Oct 03 2020 at 07:16)</a>:</h4>
<p>In case it helps navigate the PR, the implications among the files are a linear order:</p>
<p><code>to_basic &lt; to_trailing_degree &lt; erase_leading &lt; reverse_mul</code></p>



<a name="212419126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212419126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212419126">(Oct 06 2020 at 12:23)</a>:</h4>
<p>Dear All,</p>
<p>I took into account the comments that I received on the big PR and have now broken it into small bits.  As I am not completely sure about how to do incremental PRs, I have decided to simply upload the files one at a time.  The first one is <a href="https://github.com/leanprover-community/mathlib/issues/4475">#4475</a>, which contains a few extra lemmas added to the file <code>data/polynomial/degree/basic</code>.  Once this one receives some (hopefully positive!) feedback, I will gradually introduce the rest of the code.</p>



<a name="212423409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212423409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212423409">(Oct 06 2020 at 12:59)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> I left some comments.</p>



<a name="212423439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/reversing%20the%20coefficients/near/212423439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/reversing.20the.20coefficients.html#212423439">(Oct 06 2020 at 13:00)</a>:</h4>
<p>Thank you!  I will look at them right now!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>