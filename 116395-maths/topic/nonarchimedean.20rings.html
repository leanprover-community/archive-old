---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/nonarchimedean.20rings.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html">nonarchimedean rings</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="227089909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227089909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227089909">(Feb 20 2021 at 12:55)</a>:</h4>
<p>I've pushed a definition of nonarchimedean normed ring with the Gauss norm to the branch "nonarchimedean", but then realized that I could do the same definition for more general nonarchimedean topological ring. I'm just putting this here to see if anyone has any thoughts on whether increasing the level of generality seems sensible/desirable.</p>



<a name="227090912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227090912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227090912">(Feb 20 2021 at 13:12)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/tree/nonarchimedean">branch#nonarchimedean</a></p>



<a name="227092419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227092419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227092419">(Feb 20 2021 at 13:41)</a>:</h4>
<p>Did you take a look at what we did in the perfectoid project? I think we developed a bunch of theory</p>



<a name="227092714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227092714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227092714">(Feb 20 2021 at 13:47)</a>:</h4>
<p>Havent looked at it too carefully, maybe I'll take a closer look</p>



<a name="227102938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227102938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227102938">(Feb 20 2021 at 16:42)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean-perfectoid-spaces/tree/master/src/for_mathlib/nonarchimedean">https://github.com/leanprover-community/lean-perfectoid-spaces/tree/master/src/for_mathlib/nonarchimedean</a></p>



<a name="227103347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227103347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227103347">(Feb 20 2021 at 16:50)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> modulo tidying up proofs, is all this stuff PR-able or should there be some changes because of what has happened in mathlib since 2019?</p>



<a name="227108335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227108335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227108335">(Feb 20 2021 at 18:19)</a>:</h4>
<p>Ok yeah I found this, and put it in my copy of mathlib and there are errors, but they mostly seem minor. I'll get to work on fixing them up and push</p>



<a name="227173785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227173785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227173785">(Feb 21 2021 at 15:17)</a>:</h4>
<p>From a mathlib design perspective, which looks most sensible? I like the second class definition best, but the "def" definition is what was in the perfectoid project.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[to_additive]</span>
<span class="kd">class</span> <span class="n">nonarchimedean_topological_group</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>

<span class="kd">@[to_additive]</span>
<span class="kd">class</span> <span class="n">nonarchimedean_topological_group</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="kd">extends</span> <span class="n">group</span> <span class="n">G</span><span class="o">,</span> <span class="n">topological_space</span> <span class="n">G</span><span class="o">,</span> <span class="n">topological_group</span> <span class="n">G</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>

<span class="kd">@[to_additive]</span>
<span class="kd">def</span> <span class="n">topological_group.nonarchimedean</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span>
</code></pre></div>



<a name="227175050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227175050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227175050">(Feb 21 2021 at 15:38)</a>:</h4>
<p>I'd propose either option 1, or a variant:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[to_additive]</span>
<span class="kd">class</span> <span class="n">nonarchimedean_topological_group</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">topological_group</span> <span class="n">G</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>
</code></pre></div>
<p>since that matches the level of bundling of <a href="https://leanprover-community.github.io/mathlib_docs/find/topological_group">docs#topological_group</a></p>



<a name="227175161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227175161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227175161">(Feb 21 2021 at 15:40)</a>:</h4>
<p>In 2018 there were various ideas about how we should be making things like this. We now know what we're doing a lot better, in the sense that we experimented with various design decisions and now have a much better understanding of what works.</p>



<a name="227228476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227228476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227228476">(Feb 22 2021 at 07:30)</a>:</h4>
<p>I think Eric's suggestion is the best</p>



<a name="227865294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/227865294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#227865294">(Feb 26 2021 at 00:52)</a>:</h4>
<p>Some ramblings: given a nonarchimedean topological ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, a set of indeterminates <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><msub><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">(X_i)_{i \in I}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"><span></span></span></span></span></span></span></span></span></span> for some indexing set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> and a finite set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> for each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> (the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> must satisfy some topological hypothesis, which I'm ignoring for the moment), then a restricted power series is an expression <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mrow><mi>ν</mi><mo>:</mo><mi>I</mi><mo>→</mo><mi mathvariant="double-struck">N</mi><mtext> finitely supported</mtext></mrow></msub><msub><mi>c</mi><mi>ν</mi></msub><msup><mi>X</mi><mi>ν</mi></msup></mrow><annotation encoding="application/x-tex">\sum_{\nu: I \to \mathbb{N} \text{ finitely supported}} c_\nu X^\nu</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mathbb mtight">N</span></span><span class="mord text mtight"><span class="mord mtight"> finitely supported</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span></span></span></span> such that for every open subgroup <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>⊂</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">U \subset R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, the set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>ν</mi><mi mathvariant="normal">∣</mi><msub><mi>c</mi><mi>ν</mi></msub><mo>∉</mo><msup><mi>T</mi><mi>ν</mi></msup><mi>U</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{ \nu | c_\nu \not \in T^\nu U \}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">}</span></span></span></span> is finite. Here <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mi>ν</mi></msup><mo>=</mo><msub><mo>∏</mo><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow></msub><msubsup><mi>T</mi><mi>i</mi><mrow><mi>ν</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">T^\nu = \prod_{i \in I} T_i^{\nu(i)}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.37188em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span></span>. This suggests the definition (note I haven't specified the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are finite in this definition, need to add this)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">mv_strict_power_series</span> <span class="o">(</span><span class="n">σ</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">nonarchimedean_topological_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">mv_power_series</span> <span class="n">σ</span> <span class="n">R</span> <span class="bp">//</span>
  <span class="bp">∀</span> <span class="n">U</span> <span class="o">:</span> <span class="n">open_add_subgroup</span> <span class="n">R</span><span class="o">,</span>
    <span class="o">{</span><span class="n">n</span> <span class="bp">|</span> <span class="o">(</span><span class="n">coeff</span> <span class="n">R</span> <span class="n">n</span> <span class="n">f</span><span class="o">)</span> <span class="bp">∉</span> <span class="o">((</span><span class="bp">∏</span> <span class="n">s</span> <span class="k">in</span> <span class="n">n.support</span><span class="o">,</span> <span class="o">(</span><span class="n">T</span> <span class="n">s</span><span class="o">)</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span> <span class="n">s</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="n">U</span> <span class="o">:</span> <span class="n">set</span> <span class="n">R</span><span class="o">))}</span><span class="bp">.</span><span class="n">finite</span><span class="o">}</span>
</code></pre></div>
<p>But on the other hand if you assume that for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> we have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T_i = \{a_i\}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>∈</mo><msup><mi>R</mi><mo>×</mo></msup></mrow><annotation encoding="application/x-tex">a_i \in R^\times</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">×</span></span></span></span></span></span></span></span></span></span></span> (which is an important special case but isn't quite general enough to do everything you want), then you can sort of cheat and switch <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>ν</mi></msub><mo>∈</mo><msup><mi>T</mi><mi>ν</mi></msup><mi>U</mi></mrow><annotation encoding="application/x-tex">c_\nu \in T^\nu U</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>a</mi><mi>ν</mi></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mi>ν</mi></msub><mo>∈</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">(a^\nu)^{-1} c_\nu \in U</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>. Here <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>ν</mi></msup><mo>=</mo><msub><mo>∏</mo><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow></msub><msubsup><mi>a</mi><mi>i</mi><mrow><mi>ν</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a^\nu = \prod_{i \in I} a_i^{\nu(i)}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.37188em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.06366em;">ν</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span></span>. Then you can write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">mv_strict_power_series</span> <span class="o">(</span><span class="n">σ</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">nonarchimedean_topological_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">units</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">mv_power_series</span> <span class="n">σ</span> <span class="n">R</span> <span class="bp">//</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→₀</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="bp">∏</span> <span class="n">s</span> <span class="k">in</span> <span class="n">n.support</span><span class="o">,</span> <span class="o">((</span><span class="n">T</span> <span class="n">s</span><span class="o">)</span><span class="bp">⁻¹.</span><span class="n">val</span><span class="o">)</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span> <span class="n">s</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="n">coeff</span> <span class="n">R</span> <span class="n">n</span> <span class="n">f</span><span class="o">))</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">nhds</span> <span class="mi">0</span><span class="o">)}</span>
</code></pre></div>
<p>which gives you access to all of the filter machinery. But sadly I don't immediately see how to use the filter machinery outside of this special case: there's probably something clever that I'm not seeing yet.</p>



<a name="228878001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/228878001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#228878001">(Mar 05 2021 at 00:50)</a>:</h4>
<p>Does this look sensible? I'm getting errors later on about maximum class-instance depth reached, and I feel like it's because <a href="https://leanprover-community.github.io/mathlib_docs/find/topological_ring.to_topological_add_group">docs#topological_ring.to_topological_add_group</a> already exists, but I want to say that whenever you have <code>nonarchimedean_topological_ring R</code> you also get <code>nonarchimedean_topological_add_group R</code> but my current approach seems to give rise to two different instances of <code>topological_add_group R</code>.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">topology.algebra.ring</span>
<span class="kn">import</span> <span class="n">topology.algebra.open_subgroup</span>
<span class="kn">import</span> <span class="n">data.set.basic</span>
<span class="kn">import</span> <span class="n">group_theory.subgroup</span>
<span class="kn">import</span> <span class="n">algebra.ring.prod</span>

<span class="kd">class</span> <span class="n">nonarchimedean_topological_add_group</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">add_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">topological_add_group</span> <span class="n">G</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_add_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>

<span class="sd">/--A topological group is non-archimedean if every neighborhood of 1 contains an open subgroup.-/</span>
<span class="kd">@[to_additive]</span>
<span class="kd">class</span> <span class="n">nonarchimedean_topological_group</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">topological_group</span> <span class="n">G</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_subgroup</span> <span class="n">G</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>

<span class="kd">class</span> <span class="n">nonarchimedean_topological_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">topological_ring</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_nonarchimedean</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">U</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="bp">∃</span> <span class="n">V</span> <span class="o">:</span> <span class="n">open_add_subgroup</span> <span class="n">R</span><span class="o">,</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="n">set</span> <span class="n">R</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">U</span><span class="o">)</span>

<span class="kd">instance</span> <span class="n">nonarchimedean_topological_ring.to_nonarchimedean_topological_add_group</span>
  <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">t</span><span class="o">:</span> <span class="n">nonarchimedean_topological_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
<span class="n">nonarchimedean_topological_add_group</span> <span class="n">R</span> <span class="o">:=</span> <span class="o">{</span><span class="bp">..</span><span class="n">t</span><span class="o">}</span>
</code></pre></div>



<a name="228878548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/228878548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#228878548">(Mar 05 2021 at 00:56)</a>:</h4>
<p>Nevermind, the issue was that I had added</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[to_additive]</span>
<span class="kd">instance</span> <span class="n">emb_of_na</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→*</span> <span class="n">H</span><span class="o">)</span> <span class="o">(</span><span class="n">emb</span> <span class="o">:</span> <span class="n">open_embedding</span> <span class="n">f</span><span class="o">)</span> <span class="o">:</span> <span class="n">nonarchimedean_topological_group</span> <span class="n">H</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">is_nonarchimedean</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">hU</span><span class="o">,</span> <span class="k">have</span> <span class="n">h₁</span> <span class="o">:</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">U</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">nhds</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="k">from</span>
    <span class="kd">by</span> <span class="o">{</span><span class="n">apply</span> <span class="n">emb.continuous.tendsto</span><span class="o">,</span> <span class="n">rwa</span> <span class="n">is_group_hom.map_one</span> <span class="n">f</span><span class="o">},</span>
  <span class="k">let</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">hV</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">is_nonarchimedean</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">U</span><span class="o">)</span> <span class="n">h₁</span> <span class="k">in</span>
    <span class="o">⟨{</span><span class="n">is_open'</span> <span class="o">:=</span> <span class="n">emb.is_open_map</span> <span class="n">_</span> <span class="n">V.is_open</span><span class="o">,</span> <span class="bp">..</span><span class="n">subgroup.map</span> <span class="n">f</span> <span class="n">V</span><span class="o">},</span>
      <span class="n">set.image_subset_iff.2</span> <span class="n">hV</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>
<p>which seems like a pretty bad idea</p>



<a name="228896183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/nonarchimedean%20rings/near/228896183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/nonarchimedean.20rings.html#228896183">(Mar 05 2021 at 04:25)</a>:</h4>
<p>Right, that should be a lemma, not an instance (-;</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>