---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html">✔ gcd_monoid</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="303530539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303530539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303530539">(Oct 11 2022 at 22:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300245">Filippo A. E. Nuccio</span> has marked this topic as resolved.</p>



<a name="303535329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303535329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303535329">(Oct 11 2022 at 23:16)</a>:</h4>
<p>I think <code>casesI dedicated_lemma</code> is not "equally annoying" as <code>haveI := instance_whose_name_was_probably_autogenerated_and_with_not_enough_explicit_arguments</code>.</p>



<a name="303535400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303535400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303535400">(Oct 11 2022 at 23:16)</a>:</h4>
<p>This is what we do for <code>finite -&gt; fintype</code>. See <a href="https://leanprover-community.github.io/mathlib_docs/find/nonempty_fintype">docs#nonempty_fintype</a></p>



<a name="303536395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303536395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303536395">(Oct 11 2022 at 23:28)</a>:</h4>
<p>I think the following is easy enough?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.fintype.basic</span>
<span class="kn">local</span> <span class="kn">attribute</span> <span class="o">[</span><span class="kd">instance</span><span class="o">]</span> <span class="n">nonempty_fintype</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">finite</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">casesI</span> <span class="o">(</span><span class="n">infer_instance</span> <span class="o">:</span> <span class="n">nonempty</span> <span class="bp">$</span> <span class="n">fintype</span> <span class="n">α</span><span class="o">),</span> <span class="n">refl</span> <span class="o">}</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">finite</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">haveI</span> <span class="o">:</span> <span class="n">fintype</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">classical.choice</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">refl</span> <span class="o">}</span>
</code></pre></div>



<a name="303537922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303537922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303537922">(Oct 11 2022 at 23:44)</a>:</h4>
<p>But yes <code>casesI nonempty_fintype α,</code> is indeed shorter, and a lemma probably suffices for our case. I think we just need the lemma <code>[unique_factorization_monoid α] → nonempty (normalized_gcd_monoid α)</code>; once we get the <code>normalized_gcd_monoid α</code>, we would get <code>normalization_monoid α</code> and <code>gcd_monoid α</code> for free. We don't need instances going from <code>nonempty (normalized_gcd_monoid α)</code> to <code>nonempty (gcd_monoid α)</code> etc. and it doesn't seem like we can define a universal <code>nonempty_lift</code> instance that works for all classes.</p>



<a name="303538310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303538310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303538310">(Oct 11 2022 at 23:49)</a>:</h4>
<p>Oh sorry I take that back, it's possible that we already have a <code>normalization_monoid</code> instance but want to put an arbitrary <code>gcd_monoid</code> instance on some type, in which case we don't want an arbitrarily chosen <code>normalized_gcd_monoid</code> instance. And instances from <code>nonempty (normalized_gcd_monoid α)</code> to <code>nonempty (gcd_monoid α)</code> and alike would be necessary if we want theorems with <code>[nonempty (gcd_monoid α)]</code> as an argument to automatically apply to <code>unique_factorization_monoid</code>.</p>



<a name="303539302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303539302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303539302">(Oct 12 2022 at 00:01)</a>:</h4>
<p>So we probably want all of the arrows below to be instances:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>                                       <span class="n">normalized_gcd_monoid</span> <span class="bp">→</span>        <span class="n">gcd_monoid</span>
                                          <span class="bp">↓</span>                                <span class="bp">↓</span>
<span class="n">unique_factorization_monoid</span> <span class="bp">→</span> <span class="n">nonempty</span> <span class="n">normalized_gcd_monoid</span> <span class="bp">→</span> <span class="n">nonempty</span> <span class="n">gcd_monoid</span>           <span class="bp">→</span> <span class="n">is_integrally_closed</span>
                                                             <span class="bp">↘</span> <span class="n">nonempty</span> <span class="n">normalization_monoid</span>
                                                                           <span class="bp">↑</span>
                                                                        <span class="n">normalization_monoid</span>
</code></pre></div>



<a name="303540838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303540838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303540838">(Oct 12 2022 at 00:19)</a>:</h4>
<p>I guess it's impossible to define some meta-instance that generates the following instances automatically; maybe it's doable via automation with a new attribute? Or maybe it should be built into Lean because it won't cause loops?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">nonempty</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonempty</span> <span class="o">(</span><span class="n">nonempty</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">--fails</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonempty</span> <span class="o">(</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">--fails</span>
</code></pre></div>



<a name="303548927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303548927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303548927">(Oct 12 2022 at 02:06)</a>:</h4>
<p>Forget what I said above: the following simple instance makes the above two examples work, and the linters are actually happy about it (as long as the priority is set to &lt;1000)!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">nonempty_intro</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonempty</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨‹</span><span class="n">α</span><span class="o">›⟩</span>
</code></pre></div>



<a name="303550173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20gcd_monoid/near/303550173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20gcd_monoid.html#303550173">(Oct 12 2022 at 02:27)</a>:</h4>
<p>Still not sure how we should "lift" an instance to <code>nonempty</code> though. If an instance has <code>nonempty ...</code> as the conclusion, then every argument could have a <code>nonempty</code> added and it will still be a valid instance. Maybe during an instance search, if the target is <code>nonempty ...</code>, then every subgoal generated should have a <code>nonempty</code> around it? This sounds like it has to be achieved by modifying Lean itself, but could it be achieved via some meta code?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>