---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html">✔ destructuring products</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="304834398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304834398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304834398">(Oct 18 2022 at 20:24)</a>:</h4>
<p>I do not understand what happens here:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">G</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="o">(</span> <span class="n">f</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.1</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.2</span><span class="o">))</span>
<span class="kd">def</span> <span class="n">F</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">⟩⟩,</span> <span class="o">(</span> <span class="n">f</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">=</span> <span class="n">G</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">funext</span><span class="o">,</span>
  <span class="n">refl</span> <span class="c1">--it fails</span>
<span class="kd">end</span>

<span class="c1">--with implicit Types</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">B</span> <span class="n">Z</span> <span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">f₁</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">×</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">)</span> <span class="o">(</span><span class="n">g₁</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">×</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">W</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">G₁</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">×</span> <span class="n">Z</span> <span class="bp">×</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span> <span class="bp">×</span> <span class="n">W</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="o">(</span> <span class="n">f₁</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.1</span><span class="o">),</span> <span class="n">g₁</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.2</span><span class="o">))</span>
<span class="kd">def</span> <span class="n">F₁</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">×</span> <span class="n">Z</span> <span class="bp">×</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span> <span class="bp">×</span> <span class="n">W</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">⟩⟩,</span> <span class="o">(</span> <span class="n">f₁</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">),</span> <span class="n">g₁</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">F₁</span> <span class="bp">=</span> <span class="n">G₁</span> <span class="o">:=</span>  <span class="c1">--does not typecheck</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>The first equality <code>F=G</code> looks <code>refl</code> to me, but it is not. And in the second, the statement does not even typecheck (it cannot infer the types of <code>G₁</code> and <code>F₁</code>).</p>



<a name="304835027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835027">(Oct 18 2022 at 20:29)</a>:</h4>
<p>Are you sure you want to say that <code>F = G</code> where both <code>F</code> and <code>G</code> are functions of types?</p>



<a name="304835121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835121">(Oct 18 2022 at 20:29)</a>:</h4>
<p>What do you mean?</p>



<a name="304835128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835128">(Oct 18 2022 at 20:29)</a>:</h4>
<p>I would expect you to have meant <code>F A X Y f g = G A X Y f g</code></p>



<a name="304835156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835156">(Oct 18 2022 at 20:30)</a>:</h4>
<p>Ah I see</p>



<a name="304835206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835206">(Oct 18 2022 at 20:30)</a>:</h4>
<p>Right</p>



<a name="304835273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835273">(Oct 18 2022 at 20:30)</a>:</h4>
<p>And for the second one, <code>F f₁ g₁ = G f₁ g₁</code></p>



<a name="304835294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835294">(Oct 18 2022 at 20:30)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">=</span> <span class="n">G</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">funext</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">_x</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">snd</span><span class="o">,</span>
  <span class="n">refl</span>
<span class="kd">end</span>
</code></pre></div>
<p>You just need to do more cases :-)</p>



<a name="304835504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835504">(Oct 18 2022 at 20:31)</a>:</h4>
<p>Ah ok, I guess that the point is that <code>(x.y).fst = x</code> is not <code>rfl</code>?</p>



<a name="304835710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835710">(Oct 18 2022 at 20:33)</a>:</h4>
<p>That one is <code>rfl</code>, it's the other way that isn't: <code>(xy.1, xy.2)=xy</code> isn't <code>rfl</code> in Lean 3 (but it is in Lean 4)</p>



<a name="304835749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835749">(Oct 18 2022 at 20:33)</a>:</h4>
<p><code>snd : X × Y</code> so you need to do cases on it.</p>



<a name="304835752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835752">(Oct 18 2022 at 20:33)</a>:</h4>
<p>Oh, great. I see, thanks.</p>



<a name="304835827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304835827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304835827">(Oct 18 2022 at 20:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300245">Filippo A. E. Nuccio</span> has marked this topic as resolved.</p>



<a name="304949069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304949069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304949069">(Oct 19 2022 at 12:55)</a>:</h4>
<p>Fun fact: In Lean4 this is <code>rfl</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variable</span> <span class="o">(</span><span class="n">A</span> <span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">G</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span> <span class="bp">=&gt;</span> <span class="o">(</span> <span class="n">f</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.1</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">p.1</span><span class="o">,</span> <span class="n">p.2.2</span><span class="o">))</span>
<span class="kd">def</span> <span class="n">F</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">×</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">Y</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">⟩⟩</span> <span class="bp">=&gt;</span> <span class="o">(</span> <span class="n">f</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">=</span> <span class="n">G</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="304978577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304978577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304978577">(Oct 19 2022 at 15:19)</a>:</h4>
<p>Is this enough reason to regard <code>λ ⟨a, ⟨x, y⟩⟩ =&gt; (f (a, x), g (a, y))</code> as a good definition now? Or is it still awkward in practice (e.g. because it displays as <code>_match_1</code> or whatever)</p>



<a name="304987472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/%E2%9C%94%20destructuring%20products/near/304987472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/.E2.9C.94.20destructuring.20products.html#304987472">(Oct 19 2022 at 16:00)</a>:</h4>
<p>It displays as </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">case</span> <span class="n">h.h.h</span>
<span class="n">A</span><span class="bp">✝</span><span class="n">X</span><span class="bp">✝</span><span class="n">Y</span><span class="bp">✝</span><span class="o">:</span> <span class="kt">Type</span>
<span class="n">f</span><span class="o">:</span> <span class="n">A</span><span class="bp">✝</span> <span class="bp">×</span> <span class="n">X</span><span class="bp">✝</span> <span class="bp">→</span> <span class="n">X</span><span class="bp">✝</span>
<span class="n">g</span><span class="o">:</span> <span class="n">A</span><span class="bp">✝</span> <span class="bp">×</span> <span class="n">Y</span><span class="bp">✝</span> <span class="bp">→</span> <span class="n">Y</span><span class="bp">✝</span>
<span class="n">AXY</span><span class="o">:</span> <span class="kt">Type</span>
<span class="bp">⊢</span> <span class="o">(</span><span class="k">fun</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=&gt;</span>
    <span class="k">match</span> <span class="n">x</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">y</span><span class="o">)))</span> <span class="bp">=</span>
  <span class="n">G</span> <span class="n">A</span> <span class="n">X</span> <span class="n">Y</span>
</code></pre></div>
<p>which is a bit nicer than <code>_match_1</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>