---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/memory.20issue.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html">memory issue</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="259085082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085082">(Oct 26 2021 at 11:56)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> Hello! How much memory should I expect for some of those <code>simple_graph</code> files to consume? 3.5Gb+? Or am I doing something wrong?</p>



<a name="259085144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085144">(Oct 26 2021 at 11:57)</a>:</h4>
<p>Oh no! Certainly not!</p>



<a name="259085165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085165">(Oct 26 2021 at 11:57)</a>:</h4>
<p>Did you download caches using <code>leanproject get-cache</code> and then restart the server?</p>



<a name="259085281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085281">(Oct 26 2021 at 11:58)</a>:</h4>
<p>I did. This one, for instance, is already at 1.6Gb and going up <a href="/user_uploads/3121/gdtE6wz9Q3udEpB482tFUu_S/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/gdtE6wz9Q3udEpB482tFUu_S/image.png" title="image.png"><img src="/user_uploads/3121/gdtE6wz9Q3udEpB482tFUu_S/image.png"></a></div>



<a name="259085383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085383">(Oct 26 2021 at 12:00)</a>:</h4>
<p>reached 2.6Gb and I killed it</p>



<a name="259085550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085550">(Oct 26 2021 at 12:00)</a>:</h4>
<p>Did you avoid modifying files far earlier in the import tree?</p>



<a name="259085706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085706">(Oct 26 2021 at 12:02)</a>:</h4>
<p>Yeah, files are intact</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">git</span> <span class="n">status</span>
<span class="n">No</span> <span class="n">ramo</span> <span class="n">walks_and_trees</span>
<span class="n">Your</span> <span class="n">branch</span> <span class="n">is</span> <span class="n">up</span> <span class="n">to</span> <span class="n">date</span> <span class="k">with</span> <span class="bp">'</span><span class="n">origin</span><span class="bp">/</span><span class="n">walks_and_trees'.</span>

<span class="n">nothing</span> <span class="n">to</span> <span class="n">commit</span><span class="o">,</span> <span class="n">working</span> <span class="n">tree</span> <span class="n">clean</span>
</code></pre></div>



<a name="259085740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085740">(Oct 26 2021 at 12:02)</a>:</h4>
<p>what does <code>leanproject check</code> say?</p>



<a name="259085795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085795">(Oct 26 2021 at 12:03)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">leanproject</span> <span class="n">check</span>
<span class="n">Some</span> <span class="n">mathlib</span> <span class="n">oleans</span> <span class="n">files</span> <span class="n">seem</span> <span class="n">older</span> <span class="n">than</span> <span class="n">their</span> <span class="n">source.</span>
<span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">set</span> <span class="n">their</span> <span class="n">modification</span> <span class="n">time</span> <span class="n">to</span> <span class="n">now</span> <span class="o">(</span><span class="n">y</span><span class="bp">/</span><span class="n">n</span><span class="o">)</span> <span class="bp">?</span>
</code></pre></div>



<a name="259085884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085884">(Oct 26 2021 at 12:04)</a>:</h4>
<p>that's bad</p>



<a name="259085896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085896">(Oct 26 2021 at 12:04)</a>:</h4>
<p>maybe because I did <code>get-cache</code> on <code>master</code>?</p>



<a name="259085904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085904">(Oct 26 2021 at 12:04)</a>:</h4>
<p>Ah yes!</p>



<a name="259085938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259085938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259085938">(Oct 26 2021 at 12:04)</a>:</h4>
<p>You need to do <code>get-cache</code> on the branch you want. Oleans files differ from branch to branch.</p>



<a name="259086099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086099">(Oct 26 2021 at 12:06)</a>:</h4>
<p>note that you should not follow <code>check</code>'s advice and change the modification times on the oleans, this is basically lying to lean about the olean files and can cause files to have missing theorems and such</p>



<a name="259086147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086147">(Oct 26 2021 at 12:07)</a>:</h4>
<p>it's an okay thing to do if you just want to get out of orange bar hell but it has side effects</p>



<a name="259086150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086150">(Oct 26 2021 at 12:07)</a>:</h4>
<p>I had done <code>get-cache</code> on <code>master</code>, but then I did <code>get-cache</code> on this branch</p>



<a name="259086362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086362">(Oct 26 2021 at 12:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/memory.20issue/near/259086099">said</a>:</p>
<blockquote>
<p>note that you should not follow <code>check</code>'s advice and change the modification times on the oleans, this is basically lying to lean about the olean files and can cause files to have missing theorems and such</p>
</blockquote>
<p>This is actually an outdated advice, from the time when Lean was using timestamps to decide what to recompile</p>



<a name="259086372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086372">(Oct 26 2021 at 12:09)</a>:</h4>
<p>Ths whole <code>check</code> command is outdated.</p>



<a name="259086443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086443">(Oct 26 2021 at 12:10)</a>:</h4>
<p>It's using hashes now, I guess? Is there an analogous check to do?</p>



<a name="259086499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086499">(Oct 26 2021 at 12:10)</a>:</h4>
<p>the analogous override would be <code>lean --old</code> I guess</p>



<a name="259086514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086514">(Oct 26 2021 at 12:10)</a>:</h4>
<p>I'm cloning mathlib again. won't call <code>leanproject build</code> this time and will go straight to the branch and call <code>leanproject get-cache</code></p>



<a name="259086569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086569">(Oct 26 2021 at 12:11)</a>:</h4>
<p>I will eventually understand these things</p>



<a name="259086832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259086832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259086832">(Oct 26 2021 at 12:14)</a>:</h4>
<p>Was <code>get-cache</code> supposed to solve any of these issues related to olean files out of sync though?</p>



<a name="259087164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259087164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259087164">(Oct 26 2021 at 12:18)</a>:</h4>
<p>Yup, that's what it does. But you need to do it on the correct commit (it looks automatically for the latest commit on a branch) and restart the server afterwards.</p>



<a name="259087265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259087265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259087265">(Oct 26 2021 at 12:19)</a>:</h4>
<p>Okay, then something went wrong. I will try again and see what happens. I'm starting from a clean clone of mathlib</p>



<a name="259092832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/memory%20issue/near/259092832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/memory.20issue.html#259092832">(Oct 26 2021 at 13:06)</a>:</h4>
<p>This seems to be something related to some specific lean files</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>