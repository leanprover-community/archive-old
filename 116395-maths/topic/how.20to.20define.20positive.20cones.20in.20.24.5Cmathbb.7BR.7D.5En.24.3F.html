---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html">how to define positive cones in $\mathbb{R}^n$?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="292928662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292928662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292928662">(Aug 11 2022 at 13:20)</a>:</h4>
<p>I want to define the <a href="https://leanprover-community.github.io/mathlib_docs/find/convex_cone.positive">docs#convex_cone.positive</a> consisting of vectors of a finite size <code>n</code> with all coordinates non-negative. If I try </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="n">convex_cone.positive</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span>
</code></pre></div>
<p>I get the following error: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="bp">ùïú</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">,</span>
<span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_3</span><span class="o">,</span>
<span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_4</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">E</span><span class="o">,</span>
<span class="n">_inst_2</span> <span class="o">:</span> <span class="n">module</span> <span class="n">‚Ñù</span> <span class="n">E</span>
<span class="bp">‚ä¢</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span>
</code></pre></div>
<p>I'm getting really lost in the various instance hierarchies in trying to define this. Any suggestions on how to do this?</p>



<a name="292928698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292928698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292928698">(Aug 11 2022 at 13:20)</a>:</h4>
<p>That should be obvious.</p>



<a name="292928743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292928743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292928743">(Aug 11 2022 at 13:20)</a>:</h4>
<p>Are you importing <a href="https://leanprover-community.github.io/mathlib_docs/find/pi.ordered_smul">docs#pi.ordered_smul</a>?</p>



<a name="292928954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292928954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292928954">(Aug 11 2022 at 13:22)</a>:</h4>
<p>Didn't know about this file. Let me try.</p>



<a name="292929037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929037">(Aug 11 2022 at 13:23)</a>:</h4>
<p>Same error even with the import</p>



<a name="292929071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929071">(Aug 11 2022 at 13:23)</a>:</h4>
<p>Give me a MWE, I'll fix it.</p>



<a name="292929170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929170">(Aug 11 2022 at 13:24)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.cone.basic</span>
<span class="kn">import</span> <span class="n">algebra.order.module</span>

<span class="k">#check</span> <span class="n">convex_cone.positive</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span>
</code></pre></div>



<a name="292929305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929305">(Aug 11 2022 at 13:24)</a>:</h4>
<p><code>analysis.cone.basic</code> doesn't exist</p>



<a name="292929390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929390">(Aug 11 2022 at 13:25)</a>:</h4>
<p>typo, <code>convex</code></p>



<a name="292929419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929419">(Aug 11 2022 at 13:25)</a>:</h4>
<p><code>analysis.convex.basic</code></p>
<p>sorry</p>



<a name="292929462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929462">(Aug 11 2022 at 13:25)</a>:</h4>
<p><a href="https://tqft.net/mathlib/analysis/convex/cone">file#analysis/convex/cone</a>, actually</p>



<a name="292929729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292929729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292929729">(Aug 11 2022 at 13:27)</a>:</h4>
<p>my vscode is stuck, 1 min, will fix the MWE</p>



<a name="292930162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292930162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292930162">(Aug 11 2022 at 13:30)</a>:</h4>
<p>ok here's is the corrected mwe </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.convex.cone</span>
<span class="kn">import</span> <span class="n">algebra.order.module</span>

<span class="k">#check</span> <span class="n">convex_cone.positive</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span>
</code></pre></div>
<p>and the error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="bp">‚ä¢</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span>
</code></pre></div>



<a name="292932724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292932724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292932724">(Aug 11 2022 at 13:45)</a>:</h4>
<p>Okay, this is really weird.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.order.module</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">noncomputable</span> <span class="kd">example</span> <span class="o">:</span> <span class="n">linear_ordered_field</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">mul_action_with_zero</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_add_comm_group</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">-- fails</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.ordered_smul'</span> <span class="n">‚Ñù</span> <span class="n">_</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">‚Ñù</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="c1">-- works</span>
</code></pre></div>



<a name="292933140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292933140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292933140">(Aug 11 2022 at 13:47)</a>:</h4>
<p>TC inference does try unifying<code>pi.ordered_smul'</code> but then it fails to find <code>linear_ordered_field ‚Ñù</code>, even though it's clearly there.</p>



<a name="292933331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292933331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292933331">(Aug 11 2022 at 13:49)</a>:</h4>
<p>Looking at the trace, it might be because it finds a huge term for <code>ordered_add_comm_monoid (fin 2 ‚Üí ‚Ñù)</code>. Maybe it would also help if <a href="https://leanprover-community.github.io/mathlib_docs/find/ordered_smul">docs#ordered_smul</a> only assumed <a href="https://leanprover-community.github.io/mathlib_docs/find/has_smul">docs#has_smul</a>, not <a href="https://leanprover-community.github.io/mathlib_docs/find/smul_with_zero">docs#smul_with_zero</a>.</p>



<a name="292936839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292936839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292936839">(Aug 11 2022 at 14:08)</a>:</h4>
<p>Should I try removing it? I don't think my laptop can handle this deep a change though lol. I can only push this change to mathlib and wait for CI.</p>



<a name="292938256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292938256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292938256">(Aug 11 2022 at 14:16)</a>:</h4>
<p>Is <a href="https://leanprover-community.github.io/mathlib_docs/find/pi.ordered_smul">docs#pi.ordered_smul</a> true more generally without needing <code>linear_ordered_field</code>?</p>



<a name="292949722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292949722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292949722">(Aug 11 2022 at 15:15)</a>:</h4>
<p>But this shouldn't cause problems for <code>‚Ñù</code> modules, no?</p>



<a name="292950539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/292950539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#292950539">(Aug 11 2022 at 15:19)</a>:</h4>
<p>Yes it should be. Looks like everything got dumped into the same section by accident.</p>



<a name="293048663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/293048663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#293048663">(Aug 12 2022 at 05:29)</a>:</h4>
<p>Should I create an Issue for now?</p>



<a name="293049103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/293049103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#293049103">(Aug 12 2022 at 05:36)</a>:</h4>
<p>Am still trying to fix it, fwiw</p>



<a name="293049637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/293049637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#293049637">(Aug 12 2022 at 05:46)</a>:</h4>
<p>Oh, oops, thank you so much! I saw your reply one min after I posted <a href="https://github.com/leanprover-community/mathlib/pull/16021">#16021</a></p>



<a name="294104875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294104875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294104875">(Aug 18 2022 at 15:01)</a>:</h4>
<p>I cleaned up <code>algebra.order.smul</code> and <code>algebra.order.module</code>, but that still didn't the error, so in # I am adding yet another redundant instance.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.order.module</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">Œπ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">noncomputable</span> <span class="kd">example</span> <span class="o">:</span> <span class="n">linear_ordered_field</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">mul_action_with_zero</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_add_comm_group</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="n">infer_instance</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">Œπ</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">-- fails</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">ordered_smul</span> <span class="n">‚Ñù</span> <span class="o">(</span><span class="n">Œπ</span> <span class="bp">‚Üí</span> <span class="n">‚Ñù</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.ordered_smul'</span> <span class="n">Œπ</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="c1">-- works</span>
</code></pre></div>
<p>(MWE on <a href="https://github.com/leanprover-community/mathlib/pull/16131">#16131</a> when removing <code>pi.ordered_smul''</code>)<br>
cc <span class="user-mention" data-user-id="245078">@Apurva Nakade</span></p>



<a name="294213793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294213793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294213793">(Aug 19 2022 at 07:17)</a>:</h4>
<p>Thank you! Do you have a general sense of why this is happening? Are there some diamonds being created which prevents lean from infering the correct instance?</p>



<a name="294214194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294214194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294214194">(Aug 19 2022 at 07:21)</a>:</h4>
<p>No, I don't understand why Lean fails to find <code>linear_ordered_field ‚Ñù</code> within the search for <code>ordered_smul ‚Ñù (Œπ ‚Üí ‚Ñù)</code>.</p>



<a name="294214518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294214518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294214518">(Aug 19 2022 at 07:24)</a>:</h4>
<p>Maybe <span class="user-mention" data-user-id="238446">@Anne Baanen</span> will have an idea?</p>



<a name="294216662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294216662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294216662">(Aug 19 2022 at 07:47)</a>:</h4>
<p>It's the standard pi typeclass issue for dependent type classes</p>



<a name="294217731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294217731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294217731">(Aug 19 2022 at 07:56)</a>:</h4>
<p>Yes, but why is it failing given that we have <a href="https://leanprover-community.github.io/mathlib_docs/find/pi.ordered_smul'">docs#pi.ordered_smul'</a>?</p>



<a name="294218896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294218896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294218896">(Aug 19 2022 at 08:06)</a>:</h4>
<p>Because that's about <code>@module (ring.to_semiring)</code> or similar, but here you need <code>@module (comm_semiring.to_semiring)</code> or similar</p>



<a name="294219007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294219007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294219007">(Aug 19 2022 at 08:07)</a>:</h4>
<p>(or more likely, the same problem but for the <code>add_comm_monoid</code> argument since that's about a pi type)</p>



<a name="294219376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294219376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294219376">(Aug 19 2022 at 08:10)</a>:</h4>
<p>But surely that doesn't matter? This kind of mismatch happens all over the place.</p>



<a name="294271240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294271240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294271240">(Aug 19 2022 at 13:55)</a>:</h4>
<p>Yeah, and it causes problems all over the place too</p>



<a name="294271419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294271419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294271419">(Aug 19 2022 at 13:56)</a>:</h4>
<p>See for instance <a href="https://github.com/leanprover-community/mathlib/blob/be87e2504a0c96de2efb63d3f80098edf5f00085/src/analysis/normed_space/matrix_exponential.lean#L66-L93">these lines</a> which provide <a href="https://leanprover-community.github.io/mathlib_docs/find/function.algebra_ring">docs#function.algebra_ring</a> and friends</p>



<a name="294271667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/how%20to%20define%20positive%20cones%20in%20%24%5Cmathbb%7BR%7D%5En%24%3F/near/294271667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/how.20to.20define.20positive.20cones.20in.20.24.5Cmathbb.7BR.7D.5En.24.3F.html#294271667">(Aug 19 2022 at 13:57)</a>:</h4>
<p>It's possible having a <code>function.module_ring</code> shortcut instance would solve the <code>ordered_smul</code> problem being faced here.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>