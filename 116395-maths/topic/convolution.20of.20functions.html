---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/convolution.20of.20functions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html">convolution of functions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="269237246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269237246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269237246">(Jan 25 2022 at 10:32)</a>:</h4>
<p>I am planning to define the <a href="https://en.wikipedia.org/wiki/Convolution">convolution of two functions</a>.<br>
Is anyone already working on this? (<span class="user-mention" data-user-id="268315">@Anatole Dedecker</span> <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span>)</p>



<a name="269237373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269237373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269237373">(Jan 25 2022 at 10:34)</a>:</h4>
<p>This is not directly related, but Alex and I have incidence algebras over at <a href="https://github.com/leanprover-community/mathlib/tree/incidence_algebra">branch#incidence_algebra</a>.</p>



<a name="269245621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269245621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269245621">(Jan 25 2022 at 11:56)</a>:</h4>
<p>Yaël, is there any relation at all?</p>



<a name="269245720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269245720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269245720">(Jan 25 2022 at 11:57)</a>:</h4>
<p>Multiplication in the incidence algebra is a convolution.</p>



<a name="269250215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269250215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269250215">(Jan 25 2022 at 12:38)</a>:</h4>
<p>I think that is a different meaning of the word convolution: <a href="https://en.wikipedia.org/wiki/Dirichlet_convolution">https://en.wikipedia.org/wiki/Dirichlet_convolution</a></p>



<a name="269254572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269254572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269254572">(Jan 25 2022 at 13:14)</a>:</h4>
<p>It's analogous at least.</p>



<a name="269257738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269257738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269257738">(Jan 25 2022 at 13:42)</a>:</h4>
<p>True</p>



<a name="269259081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269259081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269259081">(Jan 25 2022 at 13:52)</a>:</h4>
<p>Questions about design decisions: </p>
<ul>
<li>Convolution takes 2 functions as arguments. Currently I have the domain of these functions as an additive (topological/measurable) additive group. This group carries some measure that is invariant under translation (so I cleaned this notion up a bit: <a href="https://github.com/leanprover-community/mathlib/pull/11655">#11655</a>). </li>
<li>For many results I also want the measure to be invariant under negation. Is there a name for this property on measures? </li>
<li>Also, do we want the the domain group to be able to be multiplicative? This is going to be a nightmare though: <code>to_additive</code> won't be happy that we want to additivize the group operation on the domain, but not on the codomain.</li>
<li>Should I try to make the codomain a <code>normed_ring</code>? Or is<code>is_R_or_C</code> enough?</li>
</ul>



<a name="269260096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260096">(Jan 25 2022 at 14:00)</a>:</h4>
<p>I think we also want allow the two functions to land in different places. We could have one function (seen as a weight function) landing in real number and the other one (seen as a function we want to average)in a real vector space.</p>



<a name="269260184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260184">(Jan 25 2022 at 14:00)</a>:</h4>
<p>When we want to apply convolution to smoothing functions.</p>



<a name="269260219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260219">(Jan 25 2022 at 14:01)</a>:</h4>
<p>I see, good point.</p>



<a name="269260243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260243">(Jan 25 2022 at 14:01)</a>:</h4>
<p>Again, have a look at <a href="https://github.com/leanprover-community/mathlib/tree/incidence_algebra">branch#incidence_algebra</a> <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="269260283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260283">(Jan 25 2022 at 14:01)</a>:</h4>
<p>Everything there is done in terms of scalar actions.</p>



<a name="269260312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260312">(Jan 25 2022 at 14:01)</a>:</h4>
<p>Yaël, this is pretty difficult because you merge master very often</p>



<a name="269260388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260388">(Jan 25 2022 at 14:02)</a>:</h4>
<p>We should probably look at the diff with the last master you merged</p>



<a name="269260401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260401">(Jan 25 2022 at 14:02)</a>:</h4>
<p>What does this have to do with anything? You can just compare on Github?</p>



<a name="269260512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269260512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269260512">(Jan 25 2022 at 14:03)</a>:</h4>
<p>Here, you see the file and it's all clean: <a href="https://github.com/leanprover-community/mathlib/compare/incidence_algebra">https://github.com/leanprover-community/mathlib/compare/incidence_algebra</a></p>



<a name="269263366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269263366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269263366">(Jan 25 2022 at 14:23)</a>:</h4>
<p>If you open a <code>WIP</code> PR, then it will be easier to compare.</p>



<a name="269263522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269263522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269263522">(Jan 25 2022 at 14:24)</a>:</h4>
<p>I'm planning on opening a PR for the first half soonish, but sure</p>



<a name="269263922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269263922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269263922">(Jan 25 2022 at 14:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="111080">Floris van Doorn</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/269237246">said</a>:</p>
<blockquote>
<p>I am planning to define the <a href="https://en.wikipedia.org/wiki/Convolution">convolution of two functions</a>.<br>
Is anyone already working on this? (<span class="user-mention silent" data-user-id="268315">Anatole Dedecker</span> <span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span>)</p>
</blockquote>
<p>That would be great!</p>
<p><span class="user-mention" data-user-id="253861">@Thomas Browning</span> is working on Pontryagin duals, and there's a connection: the Pontryagin dual of a locally compact abelian topological group <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is canonically homeomorphic to the space of characters of the Banach algebra defined on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L^1(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span> by convolution.  This enters into the proof of the general Plancherel theorem (their <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> spaces are canonically isomorphic).</p>
<p>Thomas and I <a href="https://github.com/leanprover-community/mathlib/pull/11304#issuecomment-1010205794">discussed this</a> briefly before but I don't know which part of the subject he's working on currently.</p>



<a name="269264188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269264188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269264188">(Jan 25 2022 at 14:29)</a>:</h4>
<p>Here you go: <a href="https://github.com/leanprover-community/mathlib/pull/11656">#11656</a></p>



<a name="269266032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269266032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269266032">(Jan 25 2022 at 14:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="111080">Floris van Doorn</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/269259081">said</a>:</p>
<blockquote>
<ul>
<li>Also, do we want the the domain group to be able to be multiplicative? This is going to be a nightmare though: <code>to_additive</code> won't be happy that we want to additivize the group operation on the domain, but not on the codomain.</li>
</ul>
</blockquote>
<p>I think yes, eventually, eg for the Selberg trace formula.  But it could maybe just be a TODO for now.</p>



<a name="269295350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/269295350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#269295350">(Jan 25 2022 at 17:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/269263922">said</a>:</p>
<blockquote>
<p>Thomas and I <a href="https://github.com/leanprover-community/mathlib/pull/11304#issuecomment-1010205794">discussed this</a> briefly before but I don't know which part of the subject he's working on currently.</p>
</blockquote>
<p>Right now, I'm still showing that the Pontryagin dual is a topological group, but I'm getting close.</p>



<a name="272292228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272292228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272292228">(Feb 17 2022 at 17:19)</a>:</h4>
<p>Update:<br>
Until today I was working on a definition of convolution where one function is scalar-valued and the other function is vector-valued: (<code>𝕜</code> is a normed field and <code>E</code> is a normed space over it)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">convolution</span> <span class="o">[</span><span class="n">has_sub</span> <span class="n">G</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">μ</span> <span class="o">:</span> <span class="n">measure</span> <span class="n">G</span> <span class="bp">.</span> <span class="n">volume_tac</span><span class="o">)</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">E</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="bp">∫</span> <span class="n">t</span><span class="o">,</span> <span class="n">f</span> <span class="n">t</span> <span class="bp">•</span> <span class="n">g</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span> <span class="bp">∂</span><span class="n">μ</span>
</code></pre></div>
<p>However, it seems to work with convolution of vector-valued functions properly, we need a generalization where both functions are vector valued, and there is some continuous bilinear map to "multiply" the two function values: (<code>E</code> and <code>E'</code> are normed spaces over <code>𝕜</code>)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">convolution</span> <span class="o">[</span><span class="n">has_sub</span> <span class="n">G</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">E'</span><span class="o">)</span> <span class="o">(</span><span class="n">L</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">E'</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">F</span><span class="o">)</span>
  <span class="o">(</span><span class="n">μ</span> <span class="o">:</span> <span class="n">measure</span> <span class="n">G</span> <span class="bp">.</span> <span class="n">volume_tac</span><span class="o">)</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">F</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="bp">∫</span> <span class="n">t</span><span class="o">,</span> <span class="n">L</span> <span class="o">(</span><span class="n">f</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">t</span><span class="o">))</span> <span class="bp">∂</span><span class="n">μ</span>
</code></pre></div>
<p>The reason is the following. Suppose that I want to write down that the derivative of <code>f ⋆ g</code> is <code>f' ⋆ g</code>. If <code>f</code> is a function in 1 variable, this is fine, and we get something like <code>has_deriv_at (f ⋆ g) ((deriv f ⋆ g) x₀) x₀</code>. However, if <code>f</code> is a function in multiple variables, then <code>fderiv 𝕜 f</code> is a linear map, and no longer a scalar value (so the old definition of <code>convolution</code> is not applicable). <br>
We can state this with the new definition:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">precompL</span> <span class="o">(</span><span class="n">L</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">E'</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">F</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">E''</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">E</span><span class="o">)</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">E'</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="o">(</span><span class="n">E''</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">...</span>
<span class="kd">lemma</span> <span class="o">(</span><span class="bp">...</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_fderiv_at</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⋆</span><span class="o">[</span><span class="n">L</span><span class="bp">;</span> <span class="n">μ</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="o">((</span><span class="n">fderiv</span> <span class="bp">𝕜</span> <span class="n">f</span> <span class="bp">⋆</span><span class="o">[</span><span class="n">L.precompL</span> <span class="n">G</span><span class="bp">;</span> <span class="n">μ</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="n">x₀</span><span class="o">)</span> <span class="n">x₀</span>
</code></pre></div>
<p>Note that we could have used the old definition for directional derivatives, but then we would not get to use all the properties of <code>fderiv</code>.<br>
I looked with <span class="user-mention" data-user-id="110031">@Patrick Massot</span>, and all books we looked at so far only define convolution for scalar-valued function, and prove differentiation properties only using directional derivatives. However, it seems useful, and I expect that this generality will be useful in other applications as well.</p>
<p>Additional advantages of the new definition: </p>
<ul>
<li>This generalization also makes it possible to use <code>@[to_additive]</code> everywhere (since we no longer have a multiplicative <code>mul</code>/<code>smul</code> that cannot become additive)</li>
<li>The definition now also is a lot more symmetric than before (the definition is still asymmetric, but at least the type is symmetric in the two functions)</li>
</ul>



<a name="272295710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272295710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272295710">(Feb 17 2022 at 17:40)</a>:</h4>
<p>But... <code>smul</code> can become additive. What about <code>vadd</code>?</p>



<a name="272295843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272295843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272295843">(Feb 17 2022 at 17:41)</a>:</h4>
<p>Else, I agree that this looks like a useful generalization.</p>



<a name="272298105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272298105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272298105">(Feb 17 2022 at 17:57)</a>:</h4>
<p>You need a bilinear map. Vadd isn't bilinear</p>



<a name="272298376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272298376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272298376">(Feb 17 2022 at 17:58)</a>:</h4>
<p>Does it make sense to use semilinear maps here? I don't know the answer.</p>



<a name="272303431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272303431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272303431">(Feb 17 2022 at 18:34)</a>:</h4>
<p><code>smul</code> neither. What do you mean?</p>



<a name="272303769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272303769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272303769">(Feb 17 2022 at 18:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/272295710">said</a>:</p>
<blockquote>
<p>But... <code>smul</code> can become additive. What about <code>vadd</code>?</p>
</blockquote>
<p>There is no <code>smul</code> in the new version of the definition (and in most lemmas about it)</p>



<a name="272309410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272309410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272309410">(Feb 17 2022 at 19:19)</a>:</h4>
<p>In algebraic geometry, an analogue of convolution is called <a href="https://en.m.wikipedia.org/wiki/Fourier%E2%80%93Mukai_transform">Fourier-Mukai transform</a>.  In that context, you do exactly what you are suggesting: you multiply the functions by a "kernel" before integrating one of the variables out.</p>



<a name="272310197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272310197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272310197">(Feb 17 2022 at 19:26)</a>:</h4>
<p>(In that same context, things are even more general, you integrate <code>f t * g s * K t s</code> over <code>t</code>.  The case of the "normal" convolution is when <code>f</code> and <code>g</code> have the same/dual domain and <code>K</code> is a δ-function supported in the antidiagonal.)</p>



<a name="272314543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272314543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matthew Ballard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272314543">(Feb 17 2022 at 20:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/272309410">said</a>:</p>
<blockquote>
<p>In algebraic geometry, an analogue of convolution is called <a href="https://en.m.wikipedia.org/wiki/Fourier%E2%80%93Mukai_transform">Fourier-Mukai transform</a>.  In that context, you do exactly what you are suggesting: you multiply the functions by a "kernel" before integrating one of the variables out.</p>
</blockquote>
<p>This is often also called an integral transform.</p>



<a name="272324442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272324442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272324442">(Feb 17 2022 at 21:23)</a>:</h4>
<p>If <code>f : G → E</code> and <code>g : G → F</code> can you convolute them to get <code>f.g : G → E ⊗ F</code> and then get everything else from that?</p>



<a name="272346371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272346371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272346371">(Feb 18 2022 at 00:56)</a>:</h4>
<p>Or even maybe <code>G → E × F</code>? Is linearity actually needed here?</p>



<a name="272486720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/272486720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Will Sawin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#272486720">(Feb 19 2022 at 02:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/116395-maths/topic/convolution.20of.20functions/near/272346371">said</a>:</p>
<blockquote>
<p>Or even maybe <code>G → E × F</code>? Is linearity actually needed here?</p>
</blockquote>
<p>Yes, for the integration.</p>



<a name="279537590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/279537590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#279537590">(Apr 20 2022 at 12:42)</a>:</h4>
<p>I made a sequence of PRs ending in <a href="https://github.com/leanprover-community/mathlib/pull/13540">#13540</a> that provides an API for convolutions.</p>
<p>Notable properties:</p>
<ul>
<li>Prove that when one of the functions has compact support and is <code>C^n</code> and the other function is locally integrable, the convolution is <code>C^n</code>.</li>
<li>Compute the total derivative of the convolution (when one of the functions has compact support)</li>
<li>Prove that when taking the convolution with functions that "tend to the Dirac delta function", the convolution tends to the original function.</li>
</ul>



<a name="279551214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/convolution%20of%20functions/near/279551214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/convolution.20of.20functions.html#279551214">(Apr 20 2022 at 14:34)</a>:</h4>
<p>I guess I need to PR approximate units now so that you can have a def for "tend to the Dirac delta function." <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>