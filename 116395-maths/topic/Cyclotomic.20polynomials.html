---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Cyclotomic.20polynomials.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html">Cyclotomic polynomials</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="210404787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210404787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210404787">(Sep 17 2020 at 15:16)</a>:</h4>
<p>Hi, I am (slowly) starting to work with cyclotomic polynomials. At the moment I have defined them as the minimal polynomial of exp(2<em>pi</em>I/n). In this way the irreducibility and rationality of the coefficients  are of course for free, the main result being about the degree (I didn't check yet what is in mathlib to prove that the coefficients are integers).  Do you see any specific reason to follow the other way? I mean, defining them as something like Prod (X - zeta) for zeta a primitive root of unity and then prove the rest. I randomly chose my approach so I am ready to change my mind :)</p>



<a name="210408763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210408763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210408763">(Sep 17 2020 at 15:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>



<a name="210409646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210409646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210409646">(Sep 17 2020 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> the main lemma is to show that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∏</mo><mrow><mi>d</mi><mo>∣</mo><mi>n</mi></mrow></msub><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mo>=</mo><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\prod_{d \mid n} \Phi_d = X^n - 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mrel mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>



<a name="210410302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410302">(Sep 17 2020 at 15:57)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Yes, of course. My question was if you see any reason to prefer one of the following definitions for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ψ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\Psi_d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:<br>
1) minimal polynomial of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exp(2\pi i/n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal">i</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br>
2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∏</mo><mrow><mi>ζ</mi><mo>∈</mo><msup><mi>μ</mi><mo>∗</mo></msup></mrow></msub><mo stretchy="false">(</mo><mi>X</mi><mo>−</mo><mi>ζ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\prod_{{\zeta} \in \mu^\ast} (X - \zeta)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07378em;">ζ</span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6183428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>μ</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\mu^\ast</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8831359999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> is the set of primitive root of unity.</p>



<a name="210410358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410358">(Sep 17 2020 at 15:57)</a>:</h4>
<p>I prefer 1</p>



<a name="210410390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410390">(Sep 17 2020 at 15:57)</a>:</h4>
<p>because it's in Z[x] automatically</p>



<a name="210410449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410449">(Sep 17 2020 at 15:58)</a>:</h4>
<p>then you prove that its coercion to C[x] is 2</p>



<a name="210410455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410455">(Sep 17 2020 at 15:58)</a>:</h4>
<p>Defining integral polynomials by first defining them as rational polynomials and then proving that the coefficients are integral is a bit of a pain. If you can avoid it, I would recommend that.</p>



<a name="210410607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410607">(Sep 17 2020 at 15:59)</a>:</h4>
<p>Perfect! It is what I have already written, for the same reason (almost, I am struggling with some stupid identity of complex numbers that does not want to be proved...)</p>



<a name="210410649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410649">(Sep 17 2020 at 15:59)</a>:</h4>
<p>Aren't minimal polynomials (for algebraic things over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>) defined as generators of ideals in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{Q}[X]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span> and hence as polynomials over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>?</p>



<a name="210410916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410916">(Sep 17 2020 at 16:01)</a>:</h4>
<p>Or is there something in mathlib that tells you the minimal polynomial over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span> assuming the element is integral?</p>



<a name="210410977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210410977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210410977">(Sep 17 2020 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I do not see any way of defining them directly as elements of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{Z}[X]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">Z</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span>,  unless mathlib knows about algebraic integers.</p>



<a name="210411016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210411016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210411016">(Sep 17 2020 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> I will check it.</p>



<a name="210413865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210413865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210413865">(Sep 17 2020 at 16:21)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> I think I might start with something like</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span><span class="bp">.</span><span class="n">div</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span>
<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">polynomial</span>

<span class="n">noncomputable</span>
<span class="n">def</span> <span class="n">cyclotomic</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">polynomial</span> <span class="n">R</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">X</span> <span class="bp">-</span> <span class="mi">1</span>
<span class="bp">|</span> <span class="n">n</span><span class="bp">@</span><span class="o">(</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="err">∏</span> <span class="n">i</span> <span class="o">:</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">//</span> <span class="n">i</span> <span class="err">∣</span> <span class="n">n</span><span class="o">},</span> <span class="k">have</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">i</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
                                <span class="n">cyclotomic</span> <span class="n">i</span>

<span class="kn">end</span> <span class="n">polynomial</span>
</code></pre></div>



<a name="210413946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210413946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210413946">(Sep 17 2020 at 16:22)</a>:</h4>
<p>This is very minimal. The definition is as crazy as it is, because Lean needs to know that the inductive definition is well-founded.</p>



<a name="210414000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414000">(Sep 17 2020 at 16:23)</a>:</h4>
<p>So the first thing we should now do, is show that we can just take the product that we want, without the crazy <code>have</code> statement, and the subtype of <code>fin n</code>.</p>



<a name="210414082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414082">(Sep 17 2020 at 16:23)</a>:</h4>
<p>I will think about it, now what I wrote is rather different, since it uses the minimal polynomial of a primitive root of unity...</p>



<a name="210414088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414088">(Sep 17 2020 at 16:23)</a>:</h4>
<p>After that, we should prove things about <code>cyclotomic \C n</code> (that <code>e ^ (2 * pi / n)</code> is a root, etc).</p>



<a name="210414226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414226">(Sep 17 2020 at 16:24)</a>:</h4>
<p>Then show that the product formula holds over <code>\C</code>. And deduce it for <code>\Z</code>, since <code>\Z \to \C</code> is injective.</p>



<a name="210414428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414428">(Sep 17 2020 at 16:26)</a>:</h4>
<p>By the way, I am stuck with the very stupid fact that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mi mathvariant="normal">/</mi><mi>n</mi><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\exp(2 \pi i/n)^n = 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal">i</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>. This is of course only my fault, but I can't finish this proof (I tried some basic tactic and I can do a long proof, but I am sure there must be something very quick)?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">special_functions</span><span class="bp">.</span><span class="n">trigonometric</span>

<span class="kn">lemma</span> <span class="n">stupid</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="o">(</span><span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">real</span><span class="bp">.</span><span class="n">pi</span><span class="bp">*</span><span class="n">complex</span><span class="bp">.</span><span class="n">I</span><span class="bp">/</span><span class="n">n</span><span class="o">))</span><span class="bp">^</span><span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">complex</span><span class="bp">.</span><span class="n">exp_nat_mul</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp_eq_one_iff</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
  <span class="n">use</span> <span class="mi">1</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210414450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210414450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210414450">(Sep 17 2020 at 16:26)</a>:</h4>
<p>Actually, the definition can just be</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">cyclotomic</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">polynomial</span> <span class="n">R</span>
<span class="bp">|</span> <span class="n">n</span> <span class="o">:=</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="err">∏</span> <span class="n">i</span> <span class="o">:</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">//</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="err">∣</span> <span class="n">n</span><span class="o">},</span> <span class="k">have</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">i</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
                                <span class="n">cyclotomic</span> <span class="n">i</span>
</code></pre></div>



<a name="210415082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415082">(Sep 17 2020 at 16:30)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> you can prove that it's integral over Z</p>



<a name="210415286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415286">(Sep 17 2020 at 16:32)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">stupid</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">real</span><span class="bp">.</span><span class="n">pi</span><span class="bp">*</span><span class="n">complex</span><span class="bp">.</span><span class="n">I</span><span class="bp">/</span><span class="n">n</span><span class="o">))</span><span class="bp">^</span><span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp_nat_mul</span><span class="o">,</span>
      <span class="n">mul_div_cancel&#39;</span> <span class="bp">_</span> <span class="o">(</span><span class="k">show</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact_mod_cast</span> <span class="n">h</span><span class="o">),</span>
      <span class="n">complex</span><span class="bp">.</span><span class="n">exp_eq_one_iff</span><span class="o">],</span>
  <span class="n">use</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210415315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415315">(Sep 17 2020 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>



<a name="210415444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415444">(Sep 17 2020 at 16:34)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Thank you very much! I guess it takes some time to become used to write proofs this way...</p>



<a name="210415539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415539">(Sep 17 2020 at 16:34)</a>:</h4>
<p>You were pretty close already</p>



<a name="210415793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415793">(Sep 17 2020 at 16:37)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> Leaving of from your start, the following three lines also close the goal:</p>
<div class="codehilite"><pre><span></span><code>  <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">assumption_mod_cast</span><span class="o">,</span>
  <span class="n">field_simp</span> <span class="o">[</span><span class="n">this</span><span class="o">],</span>
  <span class="n">ring</span><span class="o">,</span>
</code></pre></div>



<a name="210415808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415808">(Sep 17 2020 at 16:37)</a>:</h4>
<p>Yes, I  thought that someting like <code>ring</code> would have done the job, but maybe it doesn't like multiplicative inverse (it's called ring and not field...)</p>



<a name="210415822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415822">(Sep 17 2020 at 16:37)</a>:</h4>
<p>First, you tell Lean that <code>n</code> is nonzero, viewed as complex number.</p>



<a name="210415837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415837">(Sep 17 2020 at 16:37)</a>:</h4>
<p>Ah, there is <code>field_simp</code>!</p>



<a name="210415838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415838">(Sep 17 2020 at 16:37)</a>:</h4>
<p>Then <code>field_simp</code> can use that fact to cancel the division.</p>



<a name="210415864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210415864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210415864">(Sep 17 2020 at 16:37)</a>:</h4>
<p>After that, the goal is almost trivial, but because we are lazy, we use ring to close it (-;</p>



<a name="210416049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210416049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210416049">(Sep 17 2020 at 16:39)</a>:</h4>
<p>I think that </p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">also_stupid</span> <span class="o">:</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">real</span><span class="bp">.</span><span class="n">pi</span> <span class="bp">*</span> <span class="n">complex</span><span class="bp">.</span><span class="n">I</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span>
</code></pre></div>


<p>should be added to the library, also.</p>



<a name="210416296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210416296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210416296">(Sep 17 2020 at 16:41)</a>:</h4>
<p>Yes, I think that at least for psychological reasons  we should explicitly have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>π</mi><mi>i</mi></mrow></msup><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e^{\pi i } + 1 = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.907994em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>.</p>



<a name="210416490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210416490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210416490">(Sep 17 2020 at 16:43)</a>:</h4>
<p>That one does exist! <a href="https://leanprover-community.github.io/mathlib_docs/find/complex.exp_pi_mul_I">docs#complex.exp_pi_mul_I</a></p>



<a name="210416588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210416588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210416588">(Sep 17 2020 at 16:44)</a>:</h4>
<p>(As of last week -- <a href="https://github.com/leanprover-community/mathlib/issues/3746">#3746</a> <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> )</p>



<a name="210421117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421117">(Sep 17 2020 at 17:18)</a>:</h4>
<p>I guess we'll need to prove</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">X_pow_sub_one_eq_prod</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">=</span>
  <span class="err">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">X</span> <span class="bp">-</span> <span class="n">C</span> <span class="o">(</span><span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">real</span><span class="bp">.</span><span class="n">pi</span> <span class="bp">*</span> <span class="n">complex</span><span class="bp">.</span><span class="n">I</span> <span class="bp">*</span> <span class="n">i</span> <span class="bp">/</span> <span class="n">n</span><span class="o">)))</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210421441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421441">(Sep 17 2020 at 17:20)</a>:</h4>
<p>Another very stupid problem: how do I prove that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X^n - 1 \neq 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>? Sorry for the  question, but I had a look at the proof that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X \neq 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> and it is quite difficult to understand.</p>



<a name="210421539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421539">(Sep 17 2020 at 17:21)</a>:</h4>
<p>This might be an intermediate step</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">roots_X_pow_sub_one</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">roots</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">=</span>
  <span class="n">multiset</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">real</span><span class="bp">.</span><span class="n">pi</span> <span class="bp">*</span> <span class="n">complex</span><span class="bp">.</span><span class="n">I</span> <span class="bp">*</span> <span class="n">i</span> <span class="bp">/</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">multiset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210421581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421581">(Sep 17 2020 at 17:21)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> it isn't true if n = 0! ;)</p>



<a name="210421619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421619">(Sep 17 2020 at 17:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210421441">said</a>:</p>
<blockquote>
<p>Another very stupid problem: how do I prove that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X^n - 1 \neq 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>? Sorry for the  question, but I had a look at the proof that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X \neq 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> and it is quite difficult to understand.</p>
</blockquote>
<p>Of course you will need to use somewhere that <code>1 \ne 0</code></p>



<a name="210421637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421637">(Sep 17 2020 at 17:22)</a>:</h4>
<p>Right, and <code>n \ne 0</code></p>



<a name="210421699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421699">(Sep 17 2020 at 17:22)</a>:</h4>
<p>Yes, that's not the problem <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n \neq 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> is in the assumptions!</p>



<a name="210421785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421785">(Sep 17 2020 at 17:23)</a>:</h4>
<p>It would be good if we had a tactic that could do those</p>



<a name="210421935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421935">(Sep 17 2020 at 17:24)</a>:</h4>
<p>Note that there is a lemma <code>X_pow_sub_C_ne_zero</code></p>



<a name="210421966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210421966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210421966">(Sep 17 2020 at 17:24)</a>:</h4>
<p>Together with <code>C_1</code>, that will make the proof easy.</p>



<a name="210422104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210422104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210422104">(Sep 17 2020 at 17:25)</a>:</h4>
<p>OK, I have to improve my skills in finding what already is in mathlib :)</p>



<a name="210423369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210423369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210423369">(Sep 17 2020 at 17:35)</a>:</h4>
<p>I finished the definition of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ψ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\Psi_d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> as minimal polynomial over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span> of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>i</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exp(2\pi i /d))</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal">i</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> (so this is not the same definition proposed by <span class="user-mention" data-user-id="112680">@Johan Commelin</span>  but it is the one I have in my mind). In particular <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ψ</mi><mi>d</mi></msub><mo>∈</mo><mi mathvariant="bold">Q</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\Psi_d \in \mathbf{Q}[X]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span> is irreducible. Tomorrow I will try to prove that it is actually in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{Z}[X]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">Z</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span> and see if I can prove the formula for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>d</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X^d - 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>. Thank you for all your comments!!</p>



<a name="210423868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210423868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210423868">(Sep 17 2020 at 17:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210421785">said</a>:</p>
<blockquote>
<p>It would be good if we had a tactic that could do those</p>
</blockquote>
<p>This probably mainly needs a test suite</p>



<a name="210424647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210424647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210424647">(Sep 17 2020 at 17:44)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">roots_X_pow_sub_one</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">roots</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">=</span>
  <span class="n">multiset</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">real</span><span class="bp">.</span><span class="n">pi</span> <span class="bp">*</span> <span class="n">complex</span><span class="bp">.</span><span class="n">I</span> <span class="bp">*</span> <span class="n">i</span> <span class="bp">/</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">multiset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">C_1</span><span class="o">],</span>
  <span class="n">by_cases</span> <span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">hn</span><span class="o">,</span> <span class="n">div_zero</span><span class="o">,</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">card_zero</span><span class="o">,</span> <span class="n">roots_zero</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast_zero</span><span class="o">,</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">map_const</span><span class="o">,</span>
      <span class="n">multiset</span><span class="bp">.</span><span class="n">range_zero</span><span class="o">,</span> <span class="n">ring_hom</span><span class="bp">.</span><span class="n">map_one</span><span class="o">,</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">repeat_zero</span><span class="o">,</span> <span class="n">pow_zero</span><span class="o">,</span> <span class="n">sub_self</span><span class="o">]</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">X_pow_sub_C_ne_zero</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">pos_of_ne_zero</span> <span class="n">hn</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">),</span>
  <span class="n">symmetry</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">eq_iff_le_not_lt</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">le_iff_subset</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">multiset</span><span class="bp">.</span><span class="n">mem_map</span><span class="o">,</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">mem_range</span><span class="o">,</span> <span class="n">mem_roots</span> <span class="n">H</span><span class="o">,</span>
        <span class="n">is_root</span><span class="o">,</span> <span class="n">eval_sub</span><span class="o">,</span> <span class="n">eval_pow</span><span class="o">,</span> <span class="n">eval_X</span><span class="o">,</span> <span class="n">eval_C</span><span class="o">,</span> <span class="n">sub_eq_zero</span><span class="o">],</span>
      <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp_nat_mul</span><span class="o">,</span> <span class="n">complex</span><span class="bp">.</span><span class="n">exp_eq_one_iff</span><span class="o">],</span>
      <span class="n">use</span> <span class="n">i</span><span class="o">,</span>
      <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">assumption_mod_cast</span><span class="o">,</span>
      <span class="n">field_simp</span> <span class="o">[</span><span class="n">this</span><span class="o">],</span>
      <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">nodup_map_on</span> <span class="bp">_</span> <span class="o">(</span><span class="n">multiset</span><span class="bp">.</span><span class="n">nodup_range</span> <span class="n">n</span><span class="o">),</span>
      <span class="n">sorry</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">card_lt_of_lt</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">multiset</span><span class="bp">.</span><span class="n">card_map</span><span class="o">,</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">card_range</span><span class="o">,</span> <span class="err">←</span> <span class="n">not_le</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">card_roots_X_pow_sub_C</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">pos_of_ne_zero</span> <span class="n">hn</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">}</span>
<span class="kn">end</span>
</code></pre></div>


<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span></p>



<a name="210424729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210424729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210424729">(Sep 17 2020 at 17:45)</a>:</h4>
<p>Still has one sorry left.</p>



<a name="210426477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426477">(Sep 17 2020 at 17:57)</a>:</h4>
<p>Do we know anything like: two monic polynomials over <code>\C</code> are equal if they have the same roots?</p>



<a name="210426583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426583">(Sep 17 2020 at 17:58)</a>:</h4>
<p>What is the type of <code>roots f</code>?</p>



<a name="210426620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426620">(Sep 17 2020 at 17:58)</a>:</h4>
<p><code>multiset</code> right?</p>



<a name="210426710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426710">(Sep 17 2020 at 17:59)</a>:</h4>
<p><code>eq_prod_roots_of_splits</code></p>



<a name="210426712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426712">(Sep 17 2020 at 17:59)</a>:</h4>
<p>Otherwise why would anyone ever use <code>multiset.map</code>?</p>



<a name="210426796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210426796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210426796">(Sep 17 2020 at 17:59)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Thank you. My code looks A LOT less sophisticated than your :D  In any case I think I can prove that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo>=</mo><msub><mo>∏</mo><mrow><mi>d</mi><mi mathvariant="normal">∣</mi><mi>n</mi></mrow></msub><msub><mi mathvariant="normal">Ψ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">X^n - 1 = \prod_{d | n} \Psi_d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in a week or so.</p>



<a name="210427897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210427897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210427897">(Sep 17 2020 at 18:06)</a>:</h4>
<p>We should probably also decide whether the <code>0</code>th cyclotomic polynomial is <code>X ^ 0 - 1</code> or the empty product...</p>



<a name="210428147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428147">(Sep 17 2020 at 18:08)</a>:</h4>
<p><code>roots 0</code> seems to be defined as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\varnothing</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">∅</span></span></span></span>.</p>



<a name="210428166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428166">(Sep 17 2020 at 18:09)</a>:</h4>
<p>I don't understand why you can't make it in Z[X] using <a href="https://leanprover-community.github.io/mathlib_docs/find/minimal_polynomial">docs#minimal_polynomial</a></p>



<a name="210428292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428292">(Sep 17 2020 at 18:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210428166">said</a>:</p>
<blockquote>
<p>I don't understand why you can't make it in Z[X] using <a href="https://leanprover-community.github.io/mathlib_docs/find/minimal_polynomial">docs#minimal_polynomial</a></p>
</blockquote>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210410916">said</a>:</p>
<blockquote>
<p>Or is there something in mathlib that tells you the minimal polynomial over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span> assuming the element is integral?</p>
</blockquote>
<p>Cool. I didn't know that existed.</p>



<a name="210428384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428384">(Sep 17 2020 at 18:11)</a>:</h4>
<p>Yes, integral coefficients is not a problem.</p>



<a name="210428385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428385">(Sep 17 2020 at 18:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210427897">said</a>:</p>
<blockquote>
<p>We should probably also decide whether the <code>0</code>th cyclotomic polynomial is <code>X ^ 0 - 1</code> or the empty product...</p>
</blockquote>
<p>Clearly it should be a degree 2 polynomial so that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>deg</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\deg (\Phi_n) = \phi(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">de<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> holds with <a href="#narrow/stream/116395-maths/topic/Arithmetic.20Functions/near/209952965">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Arithmetic.20Functions/near/209952965</a></p>



<a name="210428542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210428542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210428542">(Sep 17 2020 at 18:12)</a>:</h4>
<p>Clearly <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\varphi(0) = -\infty</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">∞</span></span></span></span> since that's the degree of the zero polynomial.</p>



<a name="210429294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210429294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210429294">(Sep 17 2020 at 18:18)</a>:</h4>
<p>I think <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Phi_0 = 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> is a sensible choice.</p>



<a name="210439236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210439236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210439236">(Sep 17 2020 at 19:31)</a>:</h4>
<p>In the <code>X</code>-adic topology <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∏</mo><mrow><mi>i</mi><mo>∣</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow></msub><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\prod_{i \mid 0, i \ne 0} \Phi_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∣</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> converges to <code>-1</code>. Does that tell us anything about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\Phi_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>?</p>



<a name="210439288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210439288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210439288">(Sep 17 2020 at 19:31)</a>:</h4>
<p>I was thinking of the fact that the limit of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">Z</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\widehat{\mathbf{Z}}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.92611em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.92611em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span></span></span><span class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg height="0.24em" preserveAspectRatio="none" viewBox="0 0 1062 239" width="100%"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span></span></span></span> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> with respect to divisibility.</p>



<a name="210439862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210439862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210439862">(Sep 17 2020 at 19:36)</a>:</h4>
<p>Right, maybe <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> counts not the number of units in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mi>n</mi><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}/n\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span>, but in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="double-struck">Z</mi><mo>^</mo></mover><mi mathvariant="normal">/</mi><mi>n</mi><mover accent="true"><mi mathvariant="double-struck">Z</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat\mathbb{Z}/n\hat\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.20233em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9523299999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span><span style="top:-3.25789em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9523299999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span><span style="top:-3.25789em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>.</p>



<a name="210440178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440178">(Sep 17 2020 at 19:38)</a>:</h4>
<p>So then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(0)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span> should be infinity, and the degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\Phi_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> should be ... hmm, it never really matches up.</p>



<a name="210440197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440197">(Sep 17 2020 at 19:38)</a>:</h4>
<p>Ha. Do you know this fun paper by Lenstra about profinite Fibonacci numbers?</p>



<a name="210440210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440210">(Sep 17 2020 at 19:38)</a>:</h4>
<p>Nope...</p>



<a name="210440257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440257">(Sep 17 2020 at 19:39)</a>:</h4>
<p><a href="http://www.math.leidenuniv.nl/~hwl/papers/fibo.pdf">http://www.math.leidenuniv.nl/~hwl/papers/fibo.pdf</a></p>



<a name="210440452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440452">(Sep 17 2020 at 19:40)</a>:</h4>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span></span></span></span> can be extended to functions on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">Z</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\widehat{\mathbf{Z}}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.92611em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.92611em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span></span></span><span class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg height="0.24em" preserveAspectRatio="none" viewBox="0 0 1062 239" width="100%"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span></span></span></span> in the way you said, and the fact that it's multiplicative boils down to the isomorphism</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">Z</mi><mo stretchy="true">^</mo></mover><mo>≅</mo><msub><mo>∏</mo><mi>p</mi></msub><msub><mi mathvariant="bold">Z</mi><mi>p</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\widehat{\mathbf{Z}} \cong \prod_p \mathbf{Z}_p. </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.92611em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.92611em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span></span></span><span class="svg-align" style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.68611em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg height="0.24em" preserveAspectRatio="none" viewBox="0 0 1062 239" width="100%"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></p>



<a name="210440561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210440561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210440561">(Sep 17 2020 at 19:41)</a>:</h4>
<p>Or maybe it should be extended to supernatural numbers.</p>



<a name="210441432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210441432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210441432">(Sep 17 2020 at 19:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/210409646">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> the main lemma is to show that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∏</mo><mrow><mi>d</mi><mo>∣</mo><mi>n</mi></mrow></msub><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mo>=</mo><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\prod_{d \mid n} \Phi_d = X^n - 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mrel mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
</blockquote>
<p>There's also the corresponding statement in the other direction, but I don't see any sign of Möbius inversion in mathlib.</p>



<a name="210441560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210441560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210441560">(Sep 17 2020 at 19:49)</a>:</h4>
<p>Nope, I guess it is popping up higher and higher on our "most-wanted" list (-;</p>



<a name="210443175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210443175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210443175">(Sep 17 2020 at 20:02)</a>:</h4>
<p>See also <a href="#narrow/stream/116395-maths/topic/Perfect.20Numbers/near/201455256">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Perfect.20Numbers/near/201455256</a> for some discussion on moebius stuff</p>



<a name="210462378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210462378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210462378">(Sep 17 2020 at 23:08)</a>:</h4>
<p>I am really confused by polynomials... how do I prove <code>(polynomial.X ^ n - 1).monic</code>? It should be done by <code>polynomial.monic_X_pow_sub</code> but I do not see how. Here of course <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n &gt; 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>.</p>



<a name="210464681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210464681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210464681">(Sep 17 2020 at 23:43)</a>:</h4>
<p>OK, I figured out a (very ugly) proof :)</p>



<a name="210484978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210484978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210484978">(Sep 18 2020 at 07:05)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kn">lemma</span> <span class="n">nat</span><span class="bp">.</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">lt_succ_iff</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">↔</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">cases</span> <span class="n">m</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">iff_of_true</span> <span class="o">(</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">bot_lt_coe</span> <span class="bp">_</span><span class="o">)</span> <span class="n">bot_le</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">some_eq_coe</span><span class="o">,</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_lt_coe</span><span class="o">,</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_le_coe</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">lt_succ_iff</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">monic_X_pow_sub&#39;</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hpn</span> <span class="o">:</span> <span class="n">p</span><span class="bp">.</span><span class="n">degree</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">monic</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">cases</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_zero</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">lt_zero_iff</span><span class="o">,</span> <span class="n">degree_eq_bot</span><span class="o">]</span> <span class="n">at</span> <span class="n">hpn</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">hpn</span><span class="o">,</span> <span class="n">pow_zero</span><span class="o">,</span> <span class="n">sub_zero</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">monic_one</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">with_bot</span><span class="bp">.</span><span class="n">lt_succ_iff</span> <span class="n">at</span> <span class="n">hpn</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">monic_X_pow_sub</span> <span class="n">hpn</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">monic_X_pow_sub_one</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">monic</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">refine</span> <span class="n">monic_X_pow_sub&#39;</span> <span class="o">(</span><span class="n">lt_of_le_of_lt</span> <span class="n">degree_one_le</span> <span class="bp">_</span><span class="o">),</span>
  <span class="n">rwa</span> <span class="o">[</span><span class="err">←</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_zero</span><span class="o">,</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_lt_coe</span><span class="o">]</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210485443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210485443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210485443">(Sep 18 2020 at 07:12)</a>:</h4>
<p>Why the prime on <code>monic_X_pow_sub'</code>. Was there already a lemma <code>monic_X_pow_sub</code>? What could it say, if not the statement you proved?</p>



<a name="210485480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210485480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210485480">(Sep 18 2020 at 07:13)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">monic_X_pow_sub</span> <span class="o">:</span> <span class="err">?</span><span class="n">M_3</span><span class="bp">.</span><span class="n">degree</span> <span class="bp">≤</span> <span class="err">↑?</span><span class="n">M_4</span> <span class="bp">→</span> <span class="o">(</span><span class="n">X</span> <span class="bp">^</span> <span class="o">(</span><span class="err">?</span><span class="n">M_4</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="err">?</span><span class="n">M_3</span><span class="o">)</span><span class="bp">.</span><span class="n">monic</span>
</code></pre></div>



<a name="210519755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210519755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210519755">(Sep 18 2020 at 13:44)</a>:</h4>
<p>Do we have some form of Gauss lemma in mathlib? I see that people are working on it for UFD, but I need it just for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span> (to prove that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is irreducible over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>).</p>



<a name="210534458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/210534458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#210534458">(Sep 18 2020 at 15:20)</a>:</h4>
<p>Nope, I don't think so</p>



<a name="215222846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215222846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215222846">(Nov 01 2020 at 02:36)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4861">#4861</a> should have the version of Gauss's Lemma that you want.</p>



<a name="215222863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215222863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215222863">(Nov 01 2020 at 02:37)</a>:</h4>
<p>What else do we need for Cyclotomic polynomials, Moebius inversion?</p>



<a name="215222919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215222919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215222919">(Nov 01 2020 at 02:38)</a>:</h4>
<p>At some point we might need them when working with cyclotomic fields</p>



<a name="215222938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215222938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215222938">(Nov 01 2020 at 02:39)</a>:</h4>
<p>Or maybe I have your question the wrong way around</p>



<a name="215223624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215223624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215223624">(Nov 01 2020 at 02:59)</a>:</h4>
<p>Anyway, <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span>, let me know if there are any other prereqs you need for cyclotomic polynomials.</p>



<a name="215254310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215254310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215254310">(Nov 01 2020 at 17:48)</a>:</h4>
<p>That's a great news! I am almost ready to submit a first PR with all the basic results (integral coefficients and the product formula). With Gauss lemma I will be able to prove irreducibility. I do not need Moebius inversion to prove this :)</p>



<a name="215254667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215254667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215254667">(Nov 01 2020 at 17:58)</a>:</h4>
<p>Ok, sweet. Hopefully Gauss’s lemma merges by the time your second PR is ready, and I’ll try to get Moebius inversion ready for a third one on the degree formula.</p>



<a name="215255247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215255247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215255247">(Nov 01 2020 at 18:15)</a>:</h4>
<p>You mean that the degree is  <code>φ n</code>? I already have it... with my definition (product of <code>X - \zeta</code>, for <code>\zeta</code> a primitive root of unity in <code>\C</code>) it follows from results about primitive roots that already are in mathlib.</p>



<a name="215257856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215257856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215257856">(Nov 01 2020 at 19:19)</a>:</h4>
<p>There's a fairly cheap proof that there are infinitely many primes congruent to 1 mod <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> using cyclotomic polynomials. That would be a cool thing to have.</p>



<a name="215258529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215258529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215258529">(Nov 01 2020 at 19:36)</a>:</h4>
<p>I will try to do it.</p>



<a name="215866291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215866291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215866291">(Nov 06 2020 at 16:04)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4914">#4914</a> has been merged <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span> Congrats <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span aria-label="clink" class="emoji emoji-1f942" role="img" title="clink">:clink:</span></p>



<a name="215875673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215875673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215875673">(Nov 06 2020 at 17:13)</a>:</h4>
<p>Thank you! Just for fun I am trying to compute explicitly <code>cyclotomic 105 ℤ</code>... we will see if it is doable.</p>



<a name="215880364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215880364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215880364">(Nov 06 2020 at 17:48)</a>:</h4>
<p>The famous counterexample!</p>



<a name="215880467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215880467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215880467">(Nov 06 2020 at 17:49)</a>:</h4>
<p>Lean 3 is not designed to do computations, and polynomials are noncomputable, and complex numbers are noncomputable, so I am not at all optimistic that this will succeed :-)</p>



<a name="215884494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215884494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215884494">(Nov 06 2020 at 18:22)</a>:</h4>
<p>Yes, of course that's not what Lean is designed for, but still we can prove stuff like <code>a ^ 2 - b ^ 2 = (a + b) * (a - b)</code> in any commutative ring, so we can do <em>some</em> computations. I am curious to see how far one can go using <code>ring</code>.</p>



<a name="215891440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215891440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215891440">(Nov 06 2020 at 19:18)</a>:</h4>
<p>Good luck <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="215891756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215891756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215891756">(Nov 06 2020 at 19:20)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> What's the computation method here? I can help if you actually want to do this</p>



<a name="215892256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892256">(Nov 06 2020 at 19:25)</a>:</h4>
<p><a href="https://en.wikipedia.org/wiki/Cyclotomic_polynomial#Fundamental_tools">https://en.wikipedia.org/wiki/Cyclotomic_polynomial#Fundamental_tools</a></p>



<a name="215892263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892263">(Nov 06 2020 at 19:25)</a>:</h4>
<p>But we don't have Mobius yet...</p>



<a name="215892319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892319">(Nov 06 2020 at 19:26)</a>:</h4>
<p>I guess we can try working with polynomial division. But I'm not sure if <code>norm_num</code> is good for something like that.</p>



<a name="215892387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892387">(Nov 06 2020 at 19:26)</a>:</h4>
<p>Maybe a specific "plugin" could do it?</p>



<a name="215892421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892421">(Nov 06 2020 at 19:26)</a>:</h4>
<p>a plugin could do it</p>



<a name="215892441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892441">(Nov 06 2020 at 19:26)</a>:</h4>
<p>but actually we don't need polynomial division since it's exact. Just prove the multiplication</p>



<a name="215892560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892560">(Nov 06 2020 at 19:27)</a>:</h4>
<p>Especially if you allow the user to supply lots of hints this can be done pretty efficiently without too much extra stuff</p>



<a name="215892726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892726">(Nov 06 2020 at 19:29)</a>:</h4>
<p>I think the relevant theorem for computing cyclotomic 105 is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi_{np}(x)=\Phi_n(x^p)/\Phi_n(x)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> does not divide <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></p>



<a name="215892777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892777">(Nov 06 2020 at 19:29)</a>:</h4>
<p>is this proven?</p>



<a name="215892848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215892848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215892848">(Nov 06 2020 at 19:30)</a>:</h4>
<p>Nope, almost no rules are proven (in mathlib). I don't know if Riccardo has more stuff on a branch</p>



<a name="215893073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215893073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215893073">(Nov 06 2020 at 19:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/215892441">said</a>:</p>
<blockquote>
<p>but actually we don't need polynomial division since it's exact. Just prove the multiplication</p>
</blockquote>
<p>This only works if you already know the answer. Which we do in this case... but still</p>



<a name="215893310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215893310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215893310">(Nov 06 2020 at 19:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20polynomials/near/215892726">said</a>:</p>
<blockquote>
<p>I think the relevant theorem for computing cyclotomic 105 is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi_{np}(x)=\Phi_n(x^p)/\Phi_n(x)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> does not divide <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></p>
</blockquote>
<p>Another alternative is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∏</mo><mrow><mi>d</mi><mo>∣</mo><mi>n</mi></mrow></msub><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\prod_{d\mid n}\Phi_d(x)=x^n-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mrel mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> giving a recursive procedure for computing them -- and I believe that this _is_ in mathlib.</p>



<a name="215893474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215893474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215893474">(Nov 06 2020 at 19:35)</a>:</h4>
<p>that sounds far less efficient though, since you would have to calculate all the polynomials leading up to it</p>



<a name="215893502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215893502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215893502">(Nov 06 2020 at 19:35)</a>:</h4>
<p>although I guess it's fine if you intend to make a table with all of them</p>



<a name="215893599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215893599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215893599">(Nov 06 2020 at 19:36)</a>:</h4>
<p>wikipedia seems to make an exception to the table for 105</p>



<a name="215897691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215897691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215897691">(Nov 06 2020 at 20:07)</a>:</h4>
<p>105 is the first counterexample to the conjecture "all coefficients are 0 or +-1" IIRC</p>



<a name="215897731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215897731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215897731">(Nov 06 2020 at 20:07)</a>:</h4>
<p>No, that is not proven. What I am doing now is using that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> satisfies <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⋅</mo><mo stretchy="false">(</mo><msub><mo>∏</mo><mrow><mi>i</mi><mi mathvariant="normal">∣</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi><mo>&lt;</mo><mi>n</mi></mrow></msub><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P \cdot (\prod_{i|n , i &lt; n}\Phi_i) = X^n -1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">P = \Phi_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. It is bit painful to explicitly write down the set of divisors, but it seems to it is doable.</p>



<a name="215897870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215897870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215897870">(Nov 06 2020 at 20:08)</a>:</h4>
<p>Yes, that's why I am trying with 105... I do not want to make a list until there :)</p>



<a name="215897944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215897944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215897944">(Nov 06 2020 at 20:09)</a>:</h4>
<p>Ah, I see that you predicted my strategy :)</p>



<a name="215898521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215898521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215898521">(Nov 06 2020 at 20:15)</a>:</h4>
<p>are you trying to prove that 105 is a counterexample, or that it's the first one?</p>



<a name="215899085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215899085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215899085">(Nov 06 2020 at 20:20)</a>:</h4>
<p>I am just curious to see if I am able to give the explicit formula for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mn>105</mn></msub></mrow><annotation encoding="application/x-tex">\Phi_{105}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. It is just for fun :D</p>



<a name="215899768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215899768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215899768">(Nov 06 2020 at 20:27)</a>:</h4>
<p>For example, is there a simple way to automatize the fact that <code>{a, b, c}.card = 3</code> (with the correct assumptions on <code>a b c</code>)?</p>



<a name="215899855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215899855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215899855">(Nov 06 2020 at 20:28)</a>:</h4>
<p>I mean, it's not difficult, but it becomes quickly quite annoying if we have four or more elements..</p>



<a name="215900247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215900247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215900247">(Nov 06 2020 at 20:32)</a>:</h4>
<p>You should use <code>nat.factors</code>, which is a list</p>



<a name="215900269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215900269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215900269">(Nov 06 2020 at 20:32)</a>:</h4>
<p>you can get lean to prove <code>[a, b, c].length = 3</code> pretty easily</p>



<a name="215924731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215924731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215924731">(Nov 07 2020 at 01:39)</a>:</h4>
<p>If you don't mind wasting RAM and CPU time I have proof of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">cyclotomic_105</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">105</span> <span class="n">ℤ</span> <span class="bp">=</span>
  <span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">6</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">7</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">9</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">12</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">13</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">14</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">15</span>
  <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">16</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">17</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">20</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">22</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">24</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">26</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">28</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">31</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">32</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">33</span> <span class="bp">+</span>
  <span class="n">X</span> <span class="bp">^</span> <span class="mi">34</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">35</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">36</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">39</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">40</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">41</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">42</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">43</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">46</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">47</span> <span class="bp">+</span>
  <span class="n">X</span> <span class="bp">^</span> <span class="mi">48</span>
</code></pre></div>
<p><span aria-label="rolling on the floor laughing" class="emoji emoji-1f923" role="img" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>



<a name="215926759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215926759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215926759">(Nov 07 2020 at 02:21)</a>:</h4>
<p>what's the proof?</p>



<a name="215941976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215941976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215941976">(Nov 07 2020 at 06:58)</a>:</h4>
<p>how many lines is the proof? is it "readable"?</p>



<a name="215942672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215942672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215942672">(Nov 07 2020 at 07:21)</a>:</h4>
<p>Well done! Getting lean to calculate is hard work!</p>



<a name="215951318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215951318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215951318">(Nov 07 2020 at 11:43)</a>:</h4>
<p>You can read the proof here (remove the last <code>ring</code> if you want to save your RAM)</p>
<p><a href="https://webusers.imj-prg.fr/~riccardo.brasca/files/cyclotomic105.lean">https://webusers.imj-prg.fr/~riccardo.brasca/files/cyclotomic105.lean</a></p>
<p>I think it is long but very readable.</p>
<p>Essentially the lemma that allows the computation of cyclotomic polynomial is <code>compute_cyclotomic</code> at the very beginning. Because of this I have to explicitly  compute the set of (proper) divisors of  <code>105 = 3 * 5 * 7</code>.</p>
<p>At first I tried to be general, working with two distinct primes  <code>p</code> and <code>q</code>. To prove that <code>(p * q).nat.divisors = {1, p, q, p * q}</code> I use  <code>arithmetic_function.sigma 0 n</code> to prove that  it has four elements (there must be a simpler way...) and then I prove by hand that <code>{1, p, q, p * q}</code> has four elements and it is included in <code>(p * q).nat.divisors = {1, p, q, p * q}</code>. This is in the sections <code>preliminaries</code> and <code>semiprime</code>.<br>
Then I do the same for three primes <code>p q w</code>, in the section <code>three_primes</code>. Again everything is trivial but I got lazy in proving that <code>{1, p, q, w, p * q, p * w, q * w, p * q * w}</code> has eight elements and I didn't do it in general (all the rest is done).</p>
<p>I can now start computing cyclotomic polynomials, in section <code>cyclotomic</code>. For one prime it is easy (not that, funny enough, the lemma <code>polynomial.cyclotomic_of_prime</code> that is the only one that deserves to be in mathlib, it's not used at the end). Also for two primes there are no problems, I used <code>norm_num</code> as least as possible, only to prove that <code>3, 5, 7</code> are primes and pairwise disjoints.</p>
<p>The ugliest part is in section <code>one_hundred_five</code>, where I used <code>norm_num</code> to prove stuff like <code>15 ≠ 21</code>, that can be done in general. I prove, very ugly, by hand, that <code>{1, 3, 5, 7, 15, 21, 35}</code> has seven elements .  This requires proving, by hand, stuff like <code>not_mem_15</code> that say <code>15 ∉ ({1, 3, 5, 7}</code>. For some reasons  <code>finset.card_insert_of_not_mem</code> inserts the new element at "the end" of the set, while <code>finset.prod_insert</code> does it "at the beginning" at the set, so I also wrote <code>not_mem_15'</code> (I didn't spent too much time thinking about why this happens).</p>
<p>In any case, I have <code>nat.proper_divisors (105) = {1, 3, 5, 7, 15, 21, 35}</code>  and so in the proof of <code>cyclotomic_105</code> I can use <code>inset.prod_insert not_mem_?'</code> several times.  Given that I already have computed all the other cyclotomic polynomials, at the end I just let <code>ring</code> doing the job.</p>



<a name="215953098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953098">(Nov 07 2020 at 12:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Certainly it shouldn't be hard for <code>norm_num</code> to compute <code>nat.proper_divisors (105) = {1, 3, 5, 7, 15, 21, 35}</code>, right?</p>



<a name="215953603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953603">(Nov 07 2020 at 12:52)</a>:</h4>
<p>Isn't there also some recurrence relation which could be used to split off a single prime at a time? then you wouldn't need to deal with all this <code>finset</code> stuff</p>



<a name="215953605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953605">(Nov 07 2020 at 12:52)</a>:</h4>
<p>When I started thinking about it it was really strange, and very different from how we (humans) think about it. For example, I have no idea how to prove that <code>finset.range 105 = {0, 1, ..., 104}</code> (the dots are just for readability, in Lean I would have written all the numbers) except by showing that the set on the right is included in the one on the left and then comparing the cardinalities. And still, showing that <code>{0, 1, ..., 104}</code> by hand it is super long. Probably, as Kevin said, this is not what Lean is designed for.</p>



<a name="215953671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953671">(Nov 07 2020 at 12:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> This is possible, I looked for it but I didn't find anything useful about <code>nat.divisors</code>. If you meant for cyclotomic polynomials, at the moment my strategy is the only one available in mathlib.</p>



<a name="215953844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953844">(Nov 07 2020 at 12:59)</a>:</h4>
<p>Wikipedia says that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msup><mi>X</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi_{np}(X) = \Phi_n(X^p) / \Phi_n(X)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> prime and not dividing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>. Then you could prove a theorem like the one you have, that says that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msup><mi>X</mi><mi>p</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X) \cdot \Phi_n(X) = \Phi_n(X^p)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P = \Phi_{np}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, and apply it twice to get from 3 to 15 to 105 (say).</p>



<a name="215953849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953849">(Nov 07 2020 at 12:59)</a>:</h4>
<p>Is your comment about <code>nat.divisors</code> related to this?</p>



<a name="215953935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215953935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215953935">(Nov 07 2020 at 13:01)</a>:</h4>
<p>Regarding computation: the vision is that the library of tactics you need for these things just doesn't happen to exist yet. By analogy, you'd probably also have a hard time proving <code>prime 101</code> without  tactic support.</p>



<a name="215954060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954060">(Nov 07 2020 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Yes, of course this is entirely possible, and more interesting. I just wrote the basic of cyclotomic polynomials and I think I will work on something that for me is more interesting (like the irreducibility). I was just curious to see if this computation was doable in Lean, and I realized that  the problems are not where I was expecting them: <code>ring</code> is very powerful and has no problem in doing long calculations, but I struggled in proving things like that <code>{1,2,3,4,5,6}</code> has six elements.</p>



<a name="215954091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954091">(Nov 07 2020 at 13:05)</a>:</h4>
<p>As you say the reason is clear, both computation and stuff like that require some tactic to do the work for us, and we have better tactic for computations, simply because they are needed far more often than tactic to handle explicit numbers.</p>



<a name="215954302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954302">(Nov 07 2020 at 13:11)</a>:</h4>
<p>This one is true by <code>rfl</code> as it happens: <code>example : ({1,2,3,4,5,6} : finset ℕ).card = 6 := rfl</code></p>



<a name="215954348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954348">(Nov 07 2020 at 13:12)</a>:</h4>
<p>although you wouldn't want to use this method if the numbers were a lot larger</p>



<a name="215954357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954357">(Nov 07 2020 at 13:12)</a>:</h4>
<p>and it might be better to avoid using this on general principles</p>



<a name="215954593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954593">(Nov 07 2020 at 13:18)</a>:</h4>
<p>otherwise, it's clearly in the range of problems that <code>simp</code> and <code>norm_num</code> could solve if they teamed up, but I can't figure out how to make them do it</p>



<a name="215954625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954625">(Nov 07 2020 at 13:19)</a>:</h4>
<p>I didn't even thought about trying <code>rfl</code>... why it works ? It must do some checks, for example to avoid <code>({1, 1} : finset ℕ).card = 2</code>.</p>



<a name="215954710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954710">(Nov 07 2020 at 13:21)</a>:</h4>
<p>Basically because the relevant parts of <code>finset</code> are constructive given a <code>decidable_eq</code> instance for the type involved (<code>ℕ</code> in this case)</p>



<a name="215954865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954865">(Nov 07 2020 at 13:24)</a>:</h4>
<p>so reducing <code>({1,2,3,4,5,6} : finset ℕ).card</code> does basically the computation that you wrote out, except that in order to test whether elements of <code>ℕ</code> are equal, it uses the <code>decidable_eq ℕ</code> instance, which is defined by recursion</p>



<a name="215954939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215954939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215954939">(Nov 07 2020 at 13:27)</a>:</h4>
<p>Aahh, it's a matter of  <code>decidable_eq</code>!</p>



<a name="215955178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955178">(Nov 07 2020 at 13:32)</a>:</h4>
<p>Looks like it:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">inductive</span> <span class="n">foo</span>
<span class="bp">|</span> <span class="n">X</span> <span class="o">:</span> <span class="n">foo</span>
<span class="bp">|</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">foo</span>

<span class="kn">open</span> <span class="n">foo</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">({</span><span class="n">X</span><span class="o">,</span> <span class="n">Y</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">foo</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- doesn't even compile</span>

<span class="kd">@[derive decidable_eq]</span> <span class="kd">inductive</span> <span class="n">bar</span>
<span class="bp">|</span> <span class="n">A</span> <span class="o">:</span> <span class="n">bar</span>
<span class="bp">|</span> <span class="n">B</span> <span class="o">:</span> <span class="n">bar</span>

<span class="kn">open</span> <span class="n">bar</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">({</span><span class="n">A</span><span class="o">,</span> <span class="n">B</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">bar</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- works fine</span>
</code></pre></div>



<a name="215955208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955208">(Nov 07 2020 at 13:33)</a>:</h4>
<p>So of course we would also like to be able to prove <code>({1,2,3,4,5,6} : finset ℝ).card = 6</code> and we need a new strategy for this one.</p>



<a name="215955222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955222">(Nov 07 2020 at 13:33)</a>:</h4>
<p>Because <code>finset</code> is constructive finite sets, you can't even make {X,Y} because Lean doesn't know an algorithm for figuring out if X=Y so it can't insert X into {Y} whilst keeping track of everything. Of course you can make an algorithm -- that's what <code>@[derive decidable_eq]</code> does.</p>



<a name="215955301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955301">(Nov 07 2020 at 13:35)</a>:</h4>
<p>The mathematician's approach:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">inductive</span> <span class="n">foo</span>
<span class="bp">|</span> <span class="n">X</span> <span class="o">:</span> <span class="n">foo</span>
<span class="bp">|</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">foo</span>

<span class="kn">open</span> <span class="n">foo</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">({</span><span class="n">X</span><span class="o">,</span> <span class="n">Y</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">foo</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- statement compiles but proof fails</span>
</code></pre></div>
<p>I say "of course there's an algorithm for deciding equality, because there's an algorithm for deciding any true-false statement" and then I can formalise the statement but the proof fails because there isn't actually an algorithm for figuring out if X=Y.</p>



<a name="215955393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955393">(Nov 07 2020 at 13:37)</a>:</h4>
<p>The problem with making a general algorithm for counting the size of finite sets is that no "dumb" algorithm will be able to compute the size of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mo>∑</mo><mrow><mi>n</mi><mo>≥</mo><mn>1</mn></mrow></msub><msup><mi>n</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>π</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>6</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\sum_{n\geq1}n^{-2},\pi^2/6\}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.208997em;vertical-align:-0.39488900000000005em;"></span><span class="mopen">{</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139799999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">≥</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.39488900000000005em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">6</span><span class="mclose">}</span></span></span></span>; one has to prove a theorem first to compute the size of this set.</p>



<a name="215955452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955452">(Nov 07 2020 at 13:38)</a>:</h4>
<p>But for things within <code>norm_num</code>s capability, one can do something. Not at all sure how easy it would be to automate though!</p>



<a name="215955471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955471">(Nov 07 2020 at 13:39)</a>:</h4>
<p>In the case {1,2,3,4,5,6}, since <em>we</em> already know all the numbers are different, we can manually write something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.finset</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">({</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">6</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℝ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">6</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">finset.card_insert_of_not_mem</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">finset.card_singleton</span><span class="o">,</span>
  <span class="n">all_goals</span>
  <span class="o">{</span> <span class="n">try</span> <span class="o">{</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">finset.mem_insert</span> <span class="o">}</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="n">finset.mem_singleton</span><span class="o">,</span>
    <span class="n">norm_num</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="215955475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955475">(Nov 07 2020 at 13:39)</a>:</h4>
<p>because we know that <code>finset.card_insert_of_not_mem</code> is the right lemma to apply every time</p>



<a name="215955555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955555">(Nov 07 2020 at 13:41)</a>:</h4>
<p>but if the input was something like {1,2,3,4,5,1}, then we would need to start with <code>finset.card_insert_of_mem</code> instead</p>



<a name="215955637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955637">(Nov 07 2020 at 13:43)</a>:</h4>
<p>and this is where the pieces we have at the moment don't quite fit together right--<code>simp</code> doesn't know which lemma to apply because only <code>norm_num</code> knows how to verify the side conditions of the lemmas, but in the original formula, <code>norm_num</code> can't make any progress either</p>



<a name="215955692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955692">(Nov 07 2020 at 13:44)</a>:</h4>
<p>But you could probably fix this by instead using a lemma like <code>(s.insert x).card = (if x \in s then 0 else 1) + s.card</code></p>



<a name="215955708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215955708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215955708">(Nov 07 2020 at 13:44)</a>:</h4>
<p>Your code is better than mine, but that's essentially what I did, prove by hand that any element is a new element.</p>



<a name="215956659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215956659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215956659">(Nov 07 2020 at 14:10)</a>:</h4>
<p>Now the code is quite shorter... and it enters in Zulip :)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">number_theory.arithmetic_function</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.cyclotomic</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">lemma</span> <span class="n">compute_cyclotomic</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hpos</span><span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span>
  <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">P</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">nat.proper_divisors</span> <span class="n">n</span><span class="o">,</span> <span class="n">polynomial.cyclotomic</span> <span class="n">i</span> <span class="n">R</span><span class="o">)</span> <span class="bp">=</span> <span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">cyclotomic</span> <span class="n">n</span> <span class="n">R</span> <span class="bp">=</span> <span class="n">P</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">hP</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">prod_monic</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">nat.proper_divisors</span> <span class="n">n</span><span class="o">,</span> <span class="n">cyclotomic</span> <span class="n">i</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">monic</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">monic_prod_of_monic</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">i</span> <span class="n">hi</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">cyclotomic.monic</span> <span class="n">i</span> <span class="n">R</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">@</span><span class="n">cyclotomic_eq_X_pow_sub_one_div</span> <span class="n">R</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hpos</span><span class="o">,</span> <span class="o">(</span><span class="n">div_mod_by_monic_unique</span> <span class="n">P</span> <span class="mi">0</span> <span class="n">prod_monic</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">zero_add</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">hP</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">degree_zero</span><span class="o">,</span> <span class="n">bot_lt_iff_ne_bot</span><span class="o">],</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">monic.ne_zero</span> <span class="n">prod_monic</span> <span class="o">(</span><span class="n">degree_eq_bot.1</span> <span class="n">h</span><span class="o">)</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">card_nat_divisors</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">n.divisors</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_card</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">nat.proper_divisors</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="o">(</span><span class="n">nat.divisors</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">nat.succ.inj</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hcard</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat.divisors</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="n">nat.succ</span> <span class="o">(</span><span class="n">nat.proper_divisors</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.divisors_eq_proper_divisors_insert_self_of_pos</span> <span class="n">hpos</span><span class="o">],</span>
    <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">true_and</span><span class="o">,</span> <span class="n">not_lt</span><span class="o">,</span> <span class="n">nat.mem_proper_divisors</span><span class="o">,</span> <span class="n">dvd_refl</span><span class="o">,</span>
    <span class="n">finset.card_insert_of_not_mem</span><span class="o">]</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">hcard</span><span class="o">,</span> <span class="bp">←</span><span class="n">nat.pred_eq_sub_one</span><span class="o">,</span> <span class="n">nat.succ_pred_eq_of_pos</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">finset.card_pos.2</span><span class="o">,</span>
  <span class="n">use</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">ne_of_gt</span> <span class="n">hpos</span><span class="o">,</span> <span class="n">ne.def</span><span class="o">,</span> <span class="n">not_false_iff</span><span class="o">,</span> <span class="n">and_self</span><span class="o">,</span> <span class="n">nat.mem_divisors</span><span class="o">,</span> <span class="n">is_unit.dvd</span><span class="o">,</span>
  <span class="n">nat.is_unit_iff</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">lt_of_prod_lt_one</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">&lt;</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="bp">←@</span><span class="n">one_mul</span> <span class="n">ℕ</span> <span class="n">_</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">mul_lt_mul</span> <span class="n">ha</span> <span class="o">(</span><span class="n">le_of_eq</span> <span class="o">(</span><span class="n">refl</span> <span class="n">b</span><span class="o">))</span> <span class="n">hb</span> <span class="o">(</span><span class="n">nat.zero_le</span> <span class="n">a</span><span class="o">)</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">not_mem_singleton</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∉</span> <span class="o">({</span><span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="o">(</span><span class="n">finset.mem_singleton</span> <span class="bp">.</span><span class="mi">1</span> <span class="n">h</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">hdiff</span> <span class="n">h</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">not_mem_two</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hdiffab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffac</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∉</span> <span class="o">({</span><span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.mem_insert</span><span class="o">,</span> <span class="n">finset.mem_singleton</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">hdiffab</span> <span class="n">h</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">hdiffac</span> <span class="n">h</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">card_of_ne</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="o">({</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">card_eq</span> <span class="o">:=</span> <span class="n">finset.card_insert_of_not_mem</span> <span class="o">(</span><span class="n">not_mem_singleton</span> <span class="n">hdiff</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">finset.card_singleton</span><span class="o">,</span> <span class="n">one_add_one_eq_two</span> <span class="o">]</span> <span class="n">at</span> <span class="n">card_eq</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">card_eq</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">card_of_ne_of_ne</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hdiffab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffac</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffbc</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">≠</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">({</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">card_eq</span> <span class="o">:=</span> <span class="n">finset.card_insert_of_not_mem</span> <span class="o">(</span><span class="n">not_mem_two</span> <span class="n">hdiffab</span> <span class="n">hdiffac</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">card_of_ne</span> <span class="n">hdiffbc</span><span class="o">]</span> <span class="n">at</span> <span class="n">card_eq</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">card_eq</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">divisors_prime_card</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat.divisors</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">nat.divisors_eq_proper_divisors_insert_self_of_pos</span> <span class="o">(</span><span class="n">nat.prime.pos</span> <span class="n">hp</span><span class="o">),</span>
  <span class="n">nat.prime.proper_divisors</span> <span class="n">hp</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">card_of_ne</span> <span class="o">(</span><span class="n">nat.prime.ne_one</span> <span class="n">hp</span><span class="o">),</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">divisors_semiprime_card</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat.divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">))</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">4</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">fact</span> <span class="o">:</span> <span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="n">p</span><span class="o">)</span> <span class="bp">*</span>
  <span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="n">q</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.arithmetic_function.is_multiplicative.map_mul_of_coprime</span>
  <span class="n">nat.arithmetic_function.is_multiplicative_sigma</span> <span class="o">((</span><span class="n">nat.coprime_primes</span> <span class="n">hp</span> <span class="n">hq</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">hdiff</span><span class="o">)]</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">card_nat_divisors</span><span class="o">,</span> <span class="n">fact</span><span class="o">,</span> <span class="bp">←</span><span class="n">card_nat_divisors</span><span class="o">,</span> <span class="bp">←</span><span class="n">card_nat_divisors</span><span class="o">,</span> <span class="n">divisors_prime_card</span> <span class="n">hp</span><span class="o">,</span>
  <span class="n">divisors_prime_card</span> <span class="n">hq</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_semiprime_card</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">))</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">proper_divisors_card</span> <span class="n">_</span> <span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">divisors_semiprime_card</span> <span class="n">hp</span> <span class="n">hq</span> <span class="n">hdiff</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">hp.pos</span><span class="o">,</span> <span class="n">hq.pos</span><span class="o">,</span> <span class="n">zero_lt_mul_right</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_semiprime_supset</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">}</span> <span class="bp">⊆</span> <span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">finset.subset_iff</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.mem_insert</span><span class="o">,</span> <span class="n">finset.mem_singleton</span><span class="o">]</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hx</span> <span class="k">with</span> <span class="n">hx1</span> <span class="bp">|</span> <span class="n">hxp</span> <span class="bp">|</span> <span class="n">hxq</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hx1</span><span class="o">,</span> <span class="n">nat.mem_proper_divisors</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">one_mul</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">one_lt_mul</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="o">(</span><span class="n">nat.prime.one_lt</span> <span class="n">hp</span><span class="o">))</span> <span class="o">(</span><span class="n">nat.prime.one_lt</span> <span class="n">hq</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hxp</span><span class="o">,</span> <span class="n">nat.mem_proper_divisors</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">q</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">lt_of_prod_lt_one</span> <span class="o">(</span><span class="n">nat.prime.one_lt</span> <span class="n">hq</span><span class="o">)</span> <span class="n">hp.pos</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hxq</span><span class="o">,</span> <span class="n">nat.mem_proper_divisors</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">p</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mul_comm</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">lt_of_prod_lt_one</span> <span class="o">(</span><span class="n">nat.prime.one_lt</span> <span class="n">hp</span><span class="o">)</span> <span class="n">hq.pos</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_semiprime</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiff</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">symmetry</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.eq_of_subset_of_card_le</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">proper_divisors_semiprime_supset</span> <span class="n">hp</span> <span class="n">hq</span> <span class="n">hdiff</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">proper_divisors_semiprime_card</span> <span class="n">hp</span> <span class="n">hq</span> <span class="n">hdiff</span><span class="o">,</span> <span class="n">card_of_ne_of_ne</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hdiff</span><span class="o">],</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">nat.prime.ne_one</span> <span class="n">hp</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">nat.prime.ne_one</span> <span class="n">hq</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">coprime_of_prod_primes</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="n">w</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">hw</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">w</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiffpq</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffpw</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffqw</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat.coprime</span> <span class="n">p</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">or.resolve_right</span> <span class="o">(</span><span class="n">nat.coprime_or_dvd_of_prime</span> <span class="n">hp</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">)),</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="o">(</span><span class="n">nat.prime.dvd_mul</span> <span class="n">hp</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">hdiffpq</span> <span class="o">((</span><span class="n">nat.prime_dvd_prime_iff_eq</span> <span class="n">hp</span> <span class="n">hq</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">hdiffpw</span> <span class="o">((</span><span class="n">nat.prime_dvd_prime_iff_eq</span> <span class="n">hp</span> <span class="n">hw</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">divisors_three_primes_card</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="n">w</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hw</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffpq</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffpw</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffqw</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">nat.divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">)))</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">8</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">fact</span> <span class="o">:</span> <span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">))</span> <span class="bp">=</span> <span class="o">(</span><span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="n">p</span><span class="o">)</span> <span class="bp">*</span>
  <span class="n">nat.arithmetic_function.sigma</span> <span class="mi">0</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.arithmetic_function.is_multiplicative.map_mul_of_coprime</span>
    <span class="n">nat.arithmetic_function.is_multiplicative_sigma</span>
    <span class="o">(</span><span class="n">coprime_of_prod_primes</span> <span class="n">hp</span> <span class="n">hq</span> <span class="n">hw</span> <span class="n">hdiffpq</span> <span class="n">hdiffpw</span> <span class="n">hdiffqw</span><span class="o">)]</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">card_nat_divisors</span><span class="o">,</span> <span class="n">fact</span><span class="o">,</span> <span class="bp">←</span><span class="n">card_nat_divisors</span><span class="o">,</span> <span class="bp">←</span><span class="n">card_nat_divisors</span><span class="o">,</span>
  <span class="n">divisors_semiprime_card</span> <span class="n">hq</span> <span class="n">hw</span> <span class="n">hdiffqw</span><span class="o">,</span> <span class="n">divisors_prime_card</span> <span class="n">hp</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_three_primes_card</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="n">w</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">q</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hw</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffpq</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffpw</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">hdiffqw</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">≠</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="o">(</span><span class="n">q</span> <span class="bp">*</span> <span class="n">w</span><span class="o">)))</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">proper_divisors_card</span> <span class="n">_</span> <span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">divisors_three_primes_card</span> <span class="n">hp</span> <span class="n">hq</span> <span class="n">hw</span> <span class="n">hdiffpq</span> <span class="n">hdiffpw</span> <span class="n">hdiffqw</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">hp.pos</span><span class="o">,</span> <span class="n">hq.pos</span><span class="o">,</span> <span class="n">hw.pos</span><span class="o">,</span> <span class="n">zero_lt_mul_right</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">prime_3</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">prime_5</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="mi">5</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">prime_7</span> <span class="o">:</span> <span class="n">nat.prime</span> <span class="mi">7</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_3</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">3</span> <span class="n">ℤ</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">3</span> <span class="o">(</span><span class="n">nat.prime.pos</span> <span class="n">prime_3</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">nat.prime.proper_divisors</span> <span class="n">prime_3</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_5</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">5</span> <span class="n">ℤ</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">4</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">5</span> <span class="o">(</span><span class="n">nat.prime.pos</span> <span class="n">prime_5</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">nat.prime.proper_divisors</span> <span class="n">prime_5</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_7</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">7</span> <span class="n">ℤ</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">6</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">7</span> <span class="o">(</span><span class="n">nat.prime.pos</span> <span class="n">prime_7</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">nat.prime.proper_divisors</span> <span class="n">prime_7</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_15</span> <span class="o">:</span> <span class="mi">15</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="mi">5</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">mul_21</span> <span class="o">:</span> <span class="mi">21</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="mi">7</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">mul_35</span> <span class="o">:</span> <span class="mi">35</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">*</span> <span class="mi">7</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_15</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">15</span> <span class="n">ℤ</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">7</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">15</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="n">mul_15</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">proper_divisors_semiprime</span> <span class="n">prime_3</span> <span class="n">prime_5</span> <span class="n">_</span><span class="o">,</span> <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_two</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
    <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_singleton</span> <span class="n">_</span><span class="o">),</span> <span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">,</span> <span class="n">cyclotomic_3</span><span class="o">,</span>
    <span class="n">cyclotomic_5</span><span class="o">],</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">norm_num</span> <span class="o">},</span>
    <span class="n">ring</span> <span class="o">},</span>
  <span class="n">norm_num</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_21</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">21</span> <span class="n">ℤ</span> <span class="bp">=</span>
  <span class="mi">1</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">6</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">9</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">11</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">12</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">21</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="n">mul_21</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">proper_divisors_semiprime</span> <span class="n">prime_3</span> <span class="n">prime_7</span> <span class="n">_</span><span class="o">,</span> <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_two</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
    <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_singleton</span> <span class="n">_</span><span class="o">),</span> <span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">,</span> <span class="n">cyclotomic_3</span><span class="o">,</span>
    <span class="n">cyclotomic_7</span><span class="o">],</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">norm_num</span> <span class="o">},</span>
    <span class="n">ring</span> <span class="o">},</span>
  <span class="n">norm_num</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_35</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">35</span> <span class="n">ℤ</span> <span class="bp">=</span>
  <span class="mi">1</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">6</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">7</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">10</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">11</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">12</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">13</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">14</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">16</span> <span class="bp">+</span>
  <span class="n">X</span> <span class="bp">^</span> <span class="mi">17</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">18</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">19</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">23</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">24</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">35</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="n">mul_35</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">proper_divisors_semiprime</span> <span class="n">prime_5</span> <span class="n">prime_7</span> <span class="n">_</span><span class="o">,</span> <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_two</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
    <span class="n">finset.prod_insert</span> <span class="o">(</span><span class="n">not_mem_singleton</span> <span class="n">_</span><span class="o">),</span> <span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">,</span> <span class="n">cyclotomic_5</span><span class="o">,</span>
    <span class="n">cyclotomic_7</span><span class="o">],</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">norm_num</span> <span class="o">},</span>
    <span class="n">ring</span> <span class="o">},</span>
  <span class="n">norm_num</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">fact_105</span> <span class="o">:</span> <span class="mi">105</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">5</span> <span class="bp">*</span> <span class="mi">7</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">card_explicit</span> <span class="o">:</span> <span class="o">({</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">35</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">proper_divisors_105</span> <span class="o">:</span> <span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="mi">105</span><span class="o">)</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">35</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">symmetry</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">fact_105</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.eq_of_subset_of_card_le</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">finset.subset_iff</span><span class="o">,</span>
    <span class="n">norm_num</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">proper_divisors_three_primes_card</span> <span class="n">prime_3</span> <span class="n">prime_5</span> <span class="n">prime_7</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">card_explicit</span><span class="o">],</span>
  <span class="n">repeat</span> <span class="o">{</span> <span class="n">norm_num</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">cyclotomic_105</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">105</span> <span class="n">ℤ</span> <span class="bp">=</span>
  <span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">6</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">7</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">9</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">12</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">13</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">14</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">15</span>
  <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">16</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">17</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">20</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">22</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">24</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">26</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">28</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">31</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">32</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">33</span> <span class="bp">+</span>
  <span class="n">X</span> <span class="bp">^</span> <span class="mi">34</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">35</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">36</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">39</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">40</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">41</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">42</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">43</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">46</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">47</span> <span class="bp">+</span>
  <span class="n">X</span> <span class="bp">^</span> <span class="mi">48</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">105</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">proper_divisors_105</span><span class="o">,</span>
    <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">finset.prod_insert</span> <span class="n">_</span><span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">finset.prod_singleton</span><span class="o">,</span> <span class="n">cyclotomic_one</span><span class="o">,</span> <span class="n">cyclotomic_3</span><span class="o">,</span> <span class="n">cyclotomic_5</span><span class="o">,</span> <span class="n">cyclotomic_7</span><span class="o">,</span>
    <span class="n">cyclotomic_15</span><span class="o">,</span> <span class="n">cyclotomic_21</span><span class="o">,</span> <span class="n">cyclotomic_35</span><span class="o">],</span>
    <span class="n">ring</span><span class="o">,</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.mem_insert</span><span class="o">,</span> <span class="n">finset.mem_singleton</span><span class="o">],</span> <span class="n">norm_num</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">norm_num</span>
<span class="kd">end</span>
</code></pre></div>



<a name="215964052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215964052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215964052">(Nov 07 2020 at 17:08)</a>:</h4>
<p>Here's a way to compute all the numerical stuff by refl:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">cyclotomic_15</span> <span class="o">:</span> <span class="n">cyclotomic</span> <span class="mi">15</span> <span class="n">ℤ</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">5</span> <span class="bp">-</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">7</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">^</span> <span class="mi">8</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">compute_cyclotomic</span> <span class="n">ℤ</span> <span class="n">_</span> <span class="n">_</span> <span class="mi">15</span> <span class="n">pos_of_15</span><span class="o">,</span>
  <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="n">mul_15</span><span class="o">,</span>
  <span class="n">change</span> <span class="o">(</span><span class="mi">3</span> <span class="bp">*</span> <span class="mi">5</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">proper_divisors</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">quot.mk</span> <span class="n">_</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">],</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">cyclotomic_one</span><span class="o">,</span> <span class="n">cyclotomic_3</span><span class="o">,</span> <span class="n">cyclotomic_5</span><span class="o">],</span>
  <span class="n">ring</span>
<span class="kd">end</span>
</code></pre></div>



<a name="215964248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215964248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215964248">(Nov 07 2020 at 17:13)</a>:</h4>
<p>In general, it is much harder to prove that <code>{0,1,2,3,4,5}.card = 6</code> than <code>(finset.range 6).card 6</code>. The reason is that the former involves 5 calls to <code>finset.insert</code>, which has to deduplicate the set, while <code>finset.range 6</code> boils down to <code>&lt;[0,1,2,3,4,5],stuff&gt;.card = 6</code> which reduces to <code>[0,1,2,3,4,5].length = 6</code> which is easy</p>



<a name="215964254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215964254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215964254">(Nov 07 2020 at 17:13)</a>:</h4>
<p>in particular, you never have to prove the numbers are distinct</p>



<a name="215964300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215964300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215964300">(Nov 07 2020 at 17:14)</a>:</h4>
<p>because it's encoded in the construction mechanism</p>



<a name="215966138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215966138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215966138">(Nov 07 2020 at 17:58)</a>:</h4>
<p>I have to learn about <code>change</code>!</p>



<a name="215967601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215967601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215967601">(Nov 07 2020 at 18:36)</a>:</h4>
<p>The good and/or bad thing about change is that you have to know how things are defined <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="215977530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215977530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215977530">(Nov 07 2020 at 22:56)</a>:</h4>
<p>Also, for the record, we have actually had enough Gauss's lemma for cyclotomic polynomials for months...</p>



<a name="215977532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/215977532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#215977532">(Nov 07 2020 at 22:56)</a>:</h4>
<p><code>polynomial.irreducible_of_irreducible_map</code> only needs the polynomial to be monic</p>



<a name="216004770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/216004770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#216004770">(Nov 08 2020 at 12:17)</a>:</h4>
<p>That's a great news! I will soon start working on irreducibility, and then I plan to prove that for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> there infinitely many primes <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">p \equiv 1 \bmod{p}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span></span> (and maybe also  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≡</mo><mo>−</mo><mn>1</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">p \equiv -1 \bmod{p}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span></span>, if I remember correctly the proof is essentially the same).</p>



<a name="216005561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/216005561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#216005561">(Nov 08 2020 at 12:39)</a>:</h4>
<p>I didn't know -1 mod N was possible with elementary methods!</p>



<a name="216006153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/216006153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#216006153">(Nov 08 2020 at 12:54)</a>:</h4>
<p>Ah yes, I had in mind an exercise I did during my master , but indeed it says to prove that there are infinitely many primes <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">p \equiv 1 \bmod{n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span>, and infinitely many with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≢</mo><mn>1</mn><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">p  \not\equiv 1 \bmod{n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span>, no <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>. <span aria-label="innocent" class="emoji emoji-1f607" role="img" title="innocent">:innocent:</span></p>



<a name="216006996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/216006996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#216006996">(Nov 08 2020 at 13:19)</a>:</h4>
<p>There's a very easy proof that there are infinitely many primes not in a given proper subgroup of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mi>n</mi><mi mathvariant="double-struck">Z</mi><msup><mo stretchy="false">)</mo><mo>×</mo></msup></mrow><annotation encoding="application/x-tex">(\mathbb{Z}/n\mathbb{Z})^\times</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.021331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">×</span></span></span></span></span></span></span></span></span></span></span> (given finitely many primes not in it, mutiply them all together, raise to the power <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> and then add a small number to get out of the subgroup; this can be made to work).</p>



<a name="216063712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/216063712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Masdeu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#216063712">(Nov 09 2020 at 10:08)</a>:</h4>
<p>Ram Murty proved the very nice result that a "Euclidean proof" of the existence of infinitely many primes <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≡</mo><mi>a</mi><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">p \equiv a \mod n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span></span></span></span> exists if and only if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">a^2\equiv 1 \mod n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span></span></span></span>. Both directions are really cool and somewhat surprising...</p>



<a name="217380419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217380419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217380419">(Nov 20 2020 at 09:55)</a>:</h4>
<p>I have almost finished proving the irreducibility of <code>cyclotomic n ℤ</code>. I have a proof that the minimal polynomial of <code>μ</code> is the same as the minimal polynomial of <code>μ ^ p</code>, where <code>μ</code> is a primitive <code>n</code>th root of unity and <code>p</code> is a prime that does not divide <code>n</code>. This is 90% of the proof of <code>irreducible (cyclotomic n ℤ)</code>, but in the proof there is no need to mention <code>cyclotomic n ℤ</code>. It is around 250 lines and. I need an advice: should I put it in <code>ring_theory/roots_of_unity</code> (or in <code>analysis/comples/roots_of_unity</code> since it concerns complex roots of unity, even if technically I don't need the results proved there) or in <code>ring_theory/polynomials/cyclotomic</code>? In the latter case it is maybe reasonable to create a folder <code>ring_theory/polynomials/cyclotomic</code> with two files <code>basic</code> (the current <code>cyclotomic.lean</code>) and <code>irreducible</code>. Thank you !</p>



<a name="217380565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217380565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217380565">(Nov 20 2020 at 09:57)</a>:</h4>
<p>I would do whatever minimizes imports</p>



<a name="217380627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217380627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217380627">(Nov 20 2020 at 09:57)</a>:</h4>
<p>I think it makes sense to avoid an <code>import *.complex.*</code> in <code>ring_theory/roots_of_unity</code></p>



<a name="217380728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217380728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217380728">(Nov 20 2020 at 09:58)</a>:</h4>
<p>Mathematically this looks to me like a result about roots of unity. Does the proof work over an arbitrary field (for which the primitive n'th root exists)? Presumably.</p>



<a name="217381120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217381120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217381120">(Nov 20 2020 at 10:02)</a>:</h4>
<p>I don't need any results of  <code>analysis/comples/roots_of_unity</code>, I just start taking <code>μ</code> a complex primitive roots, so I suppose existence.  Indeed, as Kevin says,  I can replace <code>ℂ</code> by any characteristic <code>0</code> domain <code>R</code>, assuming the existence of a primitive root of unity in <code>R</code>.</p>



<a name="217381195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217381195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217381195">(Nov 20 2020 at 10:02)</a>:</h4>
<p>Here are the imports</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.gauss_lemma</span>
<span class="kn">import</span> <span class="n">field_theory.separable</span>
<span class="kn">import</span> <span class="n">field_theory.finite.basic</span>
</code></pre></div>



<a name="217381287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217381287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217381287">(Nov 20 2020 at 10:03)</a>:</h4>
<p>If you work over arbitrary <code>R</code>, why do you need the last import?</p>



<a name="217381366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217381366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217381366">(Nov 20 2020 at 10:04)</a>:</h4>
<p>Anyway, with these imports, I guess it makes most sense to add this stuff to <code>ring_theory/roots_of_unity</code></p>



<a name="217381483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217381483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217381483">(Nov 20 2020 at 10:05)</a>:</h4>
<p>The minimal polynomial is still over <code>ℤ</code>. The proof works by reduction modulo <code>p</code> (where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">P(x^p) = P(x)^p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span></span></span> for a polynomial <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>).</p>



<a name="217382112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/217382112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#217382112">(Nov 20 2020 at 10:11)</a>:</h4>
<p>Ok, sure</p>



<a name="218171474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/218171474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#218171474">(Nov 28 2020 at 16:47)</a>:</h4>
<p>Can someone suggest names for the following lemmas?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- If `(a : ℕ)` is a root of `cyclotomic n (zmod p)`, where `p` is a prime, then `a` and `p` are</span>
<span class="sd">coprime. -/</span>
<span class="kd">lemma</span> <span class="n">test1</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">[</span><span class="n">hprime</span> <span class="o">:</span> <span class="n">fact</span> <span class="n">p.prime</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hroot</span> <span class="o">:</span> <span class="n">is_root</span> <span class="o">(</span><span class="n">cyclotomic</span> <span class="n">n</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">p</span><span class="o">))</span> <span class="o">(</span><span class="n">nat.cast_ring_hom</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="n">a</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">a.coprime</span> <span class="n">p</span>

<span class="sd">/-- If `(a : ℕ)` is a root of `cyclotomic n (zmod p)`, where `p` is a prime that does not divide</span>
<span class="sd">`n`, then the multiplicative order of `a` modulo `p` is exactly `n`. -/</span>
<span class="kd">lemma</span> <span class="n">test2</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">[</span><span class="n">hprime</span> <span class="o">:</span> <span class="n">fact</span> <span class="n">p.prime</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">p</span> <span class="bp">∣</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hroot</span> <span class="o">:</span> <span class="n">is_root</span> <span class="o">(</span><span class="n">cyclotomic</span> <span class="n">n</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">p</span><span class="o">))</span> <span class="o">(</span><span class="n">nat.cast_ring_hom</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="n">a</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">order_of</span> <span class="o">(</span><span class="n">zmod.unit_of_coprime</span> <span class="n">a</span> <span class="o">(</span><span class="n">test1</span> <span class="n">hpos</span> <span class="n">hroot</span><span class="o">))</span> <span class="bp">=</span> <span class="n">n</span>
</code></pre></div>
<p>I am thinking about something like <code>coprime_of_root_cyclotomic</code> for the first one, and I really don't know for the second (the first one is in the <code>polynomial</code> namespace). </p>
<p>Also, <code>test2</code> is the main arithmetic step in the proof that there infinitely many  primes congruent to <code>1</code> modulo <code>n</code>. I am wondering if it will be reasonable to put it  in a separate file, with the proof of the theorem.</p>



<a name="239244042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239244042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239244042">(May 18 2021 at 12:29)</a>:</h4>
<p>Is it reasonable to put the counterexample above (a cyclotomic polynomial with a coefficients different from <code>0</code>, <code>1</code> and <code>-1</code>) in the <code>counterexamples</code> folder?</p>



<a name="239245965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239245965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239245965">(May 18 2021 at 12:43)</a>:</h4>
<p>I am in favour of this!</p>



<a name="239246415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239246415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239246415">(May 18 2021 at 12:46)</a>:</h4>
<p>OMG</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">proper_divisors_105</span> <span class="o">:</span> <span class="n">nat.proper_divisors</span> <span class="o">(</span><span class="mi">105</span><span class="o">)</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">35</span><span class="o">}</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>works!! I spent hours to prove it...</p>



<a name="239248882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239248882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239248882">(May 18 2021 at 13:01)</a>:</h4>
<p>I suspect there is some Mario magic going on behind the scenes here...</p>



<a name="239250556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239250556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239250556">(May 18 2021 at 13:11)</a>:</h4>
<p>I think the key is that it's a finset (and you got the order right so that there is no need to use quotient.sound)</p>



<a name="239250609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239250609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239250609">(May 18 2021 at 13:11)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/nat.proper_divisors/src">src#nat.proper_divisors</a> is very simple</p>



<a name="239253606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20polynomials/near/239253606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20polynomials.html#239253606">(May 18 2021 at 13:30)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/7648">#7648</a> At the end it is quite easy</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>