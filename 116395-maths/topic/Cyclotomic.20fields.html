---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Cyclotomic.20fields.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html">Cyclotomic fields</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="258814070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814070">(Oct 23 2021 at 09:41)</a>:</h4>
<p><span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> If you want refactor the definition of cyclotomic polynomials pleas go ahead. <br>
But the current API should suffice to prove that the splitting field of <code>cyclotomic n Z</code> is the same as the splitting field of <code>X^n-1</code>. We know that the roots if <code>cyclotomic n Z</code> (in <code>C</code>) are the primitive roots of unity.</p>



<a name="258814211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814211">(Oct 23 2021 at 09:44)</a>:</h4>
<p>Are you planning to do some Galois theory after that?</p>



<a name="258814268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814268">(Oct 23 2021 at 09:46)</a>:</h4>
<p>Yes, that's the plan. I was hoping to get some more general results (I think they're equal if X^n-1 is separable in R) but I'm not averse to the specialised results if that's what's easiest, too</p>



<a name="258814332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814332">(Oct 23 2021 at 09:48)</a>:</h4>
<p>Oh yes, I mean in characteristic <code>0</code>.</p>



<a name="258814429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814429">(Oct 23 2021 at 09:51)</a>:</h4>
<p>In any case we know that <code>cyclotomic n Z</code> is irreducible and we know its roots, so mathematically there is not a lot to do, but of course in Lean the story is different. But I think that if there is something missing is rather about splitting fields in general than about cyclotomic polynomials. (Of course there a lot of missing results about cyclotomic polynomial, but for Galois theory what we have should suffice).</p>



<a name="258814613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258814613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258814613">(Oct 23 2021 at 09:55)</a>:</h4>
<p>I am asking because I think that a very very interesting middle sized project is Fermat Last Theorem for regular primes. I don't know if someone else is working on it, but if this is not the case I would like to think about it.</p>



<a name="258829237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829237">(Oct 23 2021 at 15:34)</a>:</h4>
<p>Could one define the cyclotomic polynomials as the unique sequence $(\Phi_n)$ of monic polynomials with integer coefficients characterized by  the formula $T^n-1=\prod_{d\mid n} \Phi_d$ holds?</p>



<a name="258829253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829253">(Oct 23 2021 at 15:35)</a>:</h4>
<p>you'd have to simultaneously make the definition and the proof that polynomials exist which satisfy the property, but this can be done</p>



<a name="258829309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829309">(Oct 23 2021 at 15:36)</a>:</h4>
<p>Alternatively you could define them to be "Phi(n) is T^n-1/prod_{d|n, d&lt;n}Phi(d) if this is a polynomial, and 37 otherwise" and then prove later on that none of them are 37</p>



<a name="258829333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829333">(Oct 23 2021 at 15:37)</a>:</h4>
<p>This is essentially what Johan was proposing. But let me stress that we already have a definition, and a pretty good API (up to irreducibility).  I maybe chose the wrong definition at the beginning, going through the complex numbers, but before thinking about alternative definitions we should ask ourselves if it is worth the effort of reproving all the results.</p>



<a name="258829335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829335">(Oct 23 2021 at 15:37)</a>:</h4>
<p>actually I think Phi(0) might be 37</p>



<a name="258829394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829394">(Oct 23 2021 at 15:38)</a>:</h4>
<p>We already add this discussion one year ago :).  Currently <code>cyclotomic 0 R = 1</code>.</p>



<a name="258829401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829401">(Oct 23 2021 at 15:38)</a>:</h4>
<p>but it doesn't have degree phi(0)=2 ;-)</p>



<a name="258829464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829464">(Oct 23 2021 at 15:40)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.degree_cyclotomic">docs#polynomial.degree_cyclotomic</a> says it's true for all <code>n</code>, so I think <code>0.totient = 0</code>.</p>



<a name="258829480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829480">(Oct 23 2021 at 15:41)</a>:</h4>
<p>That makes sense from my point of view, as no element strictly smaller than <code>0</code> is coprime with <code>0</code>.</p>



<a name="258829483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829483">(Oct 23 2021 at 15:41)</a>:</h4>
<p>BTW, what I was proposing to get rid of the use of complex numbers in much simpler than redoing everything: it suffices to have a char 0 field with all the primitive roots of unity (like Q bar). I should check, but maybe we can even use a different field for every <code>n</code>, and then the splitting field of <code>X^n-1</code> would be enough.</p>



<a name="258829610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258829610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258829610">(Oct 23 2021 at 15:44)</a>:</h4>
<p>Of course this not for any mathematical reasons, it is just to avoid having <code>import analysis.complex.roots_of_unity</code> at the beginning of a morally "algebraic" file.</p>



<a name="258832034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/258832034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#258832034">(Oct 23 2021 at 16:42)</a>:</h4>
<p>So we're saying there are three approaches. There's a totally "hands-on" approach where you define Phi_n recursively in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\Z[X]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span>, there's an approach via Galois theory where you work in the splitting field of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X^n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> (so it imports a whole bunch of algebra files) and there's an approach via using the complex numbers (where you import some analysis files). The "hands-on" approach will need very few imports but you might have to work hard and I guess it's not clear whether there's any point in doing so just to shorten the import tree -- you would be making mathlib more incomprehensible. The approach via splitting fields -- you won't have to import the complex numbers and a proof that they're algebraically closed (actually no, you only need a basic theory of roots of unity which is much easier), but you will have to import quite a bit of field theory.</p>



<a name="259068371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259068371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259068371">(Oct 26 2021 at 08:54)</a>:</h4>
<p>For those that are not following the <code>flt-regular</code> stream: we are discussing about the definition of cyclotomic extensions/fields. We want a super general definition, even if of course we are going to work in a much more specific case. Does anyone have in mind something called "cyclotomic extension" that is not captured by the following?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.splitting_field</span>
<span class="kn">import</span> <span class="n">data.pnat.basic</span>

<span class="kd">class</span> <span class="n">is_cyclotomic_extension</span> <span class="o">(</span><span class="n">K</span> <span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">pnat</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">splits</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">pnat</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">:</span> <span class="n">polynomial.splits</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">(</span><span class="n">polynomial.X</span><span class="bp">^</span><span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span>
<span class="o">(</span><span class="n">adjoint_roots</span> <span class="o">:</span> <span class="n">algebra.adjoin</span> <span class="n">K</span> <span class="o">{</span> <span class="n">b</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="n">pnat</span><span class="o">,</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">∧</span> <span class="n">b</span><span class="bp">^</span><span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">}</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span> <span class="c1">-- or some other equivalent condition</span>
</code></pre></div>



<a name="259069380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259069380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259069380">(Oct 26 2021 at 09:05)</a>:</h4>
<p>Do you really want to restrict to <code>field K</code> and <code>field L</code>? It might be useful to say that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msub><mi>ζ</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\zeta_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07378em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> is a cyclotomic extension.</p>



<a name="259071977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259071977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259071977">(Oct 26 2021 at 09:34)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.splits">docs#polynomial.splits</a> is for fields. But don't worry, we have <a href="https://leanprover-community.github.io/mathlib_docs/find/integral_closure.is_integral_closure">docs#integral_closure.is_integral_closure</a> for that.</p>



<a name="259072056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072056">(Oct 26 2021 at 09:35)</a>:</h4>
<p>So the idea is to have cyclotomic extensions of fields and their ring of integers (of course with the lemma that says it's enough add a primitive root of unity).</p>



<a name="259072222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072222">(Oct 26 2021 at 09:37)</a>:</h4>
<p>Yes, I know the <code>integral_closure</code> business; but I am wondering if it is reasonable to impose that a "cyclotomic algebra tower" be only defined for fields.</p>



<a name="259072389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072389">(Oct 26 2021 at 09:39)</a>:</h4>
<p>(deleted)</p>



<a name="259072521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072521">(Oct 26 2021 at 09:40)</a>:</h4>
<p>Well, to be honest I am not even sure what that notation means. In real math, when we write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mi>α</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\alpha]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">]</span></span></span></span> we often mean the ring of integers of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{Q}(\alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>.</p>



<a name="259072577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072577">(Oct 26 2021 at 09:40)</a>:</h4>
<p>We rarely speak about the subalgebra generated by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>, unless it is already integrally closed</p>



<a name="259072612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072612">(Oct 26 2021 at 09:41)</a>:</h4>
<p>No, I am not so sure; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msqrt><mn>5</mn></msqrt><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\sqrt{5}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1572200000000001em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span> is a very honest order in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi><mo stretchy="false">(</mo><msqrt><mn>5</mn></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{Q}(\sqrt{5})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1572200000000001em;vertical-align:-0.25em;"></span><span class="mord mathbb">Q</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>



<a name="259072733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072733">(Oct 26 2021 at 09:42)</a>:</h4>
<p>OK, probably <em>I</em> rarely use that <span aria-label="innocent" class="emoji emoji-1f607" role="img" title="innocent">:innocent:</span></p>



<a name="259072789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072789">(Oct 26 2021 at 09:42)</a>:</h4>
<p>But what definition do you propose? We cannot say that a polynomial is split over a ring</p>



<a name="259072810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072810">(Oct 26 2021 at 09:43)</a>:</h4>
<p>I think it would be a problem to only have full rings of integers; for instance, if one day we develop global CFT, it would be important to develop general orders.</p>



<a name="259072850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072850">(Oct 26 2021 at 09:43)</a>:</h4>
<p>Wait, maybe the condition <code>splits</code> is useless</p>



<a name="259072865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072865">(Oct 26 2021 at 09:44)</a>:</h4>
<p>We can say it splits over a domain, where there are at most as many roots as the degree?</p>



<a name="259072926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072926">(Oct 26 2021 at 09:44)</a>:</h4>
<p>I mean that I don't want to do the refactor</p>



<a name="259072942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259072942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259072942">(Oct 26 2021 at 09:44)</a>:</h4>
<p>I understand, and it makes sense.</p>



<a name="259073038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259073038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259073038">(Oct 26 2021 at 09:45)</a>:</h4>
<p>But indeed, do you need the splitting condition? For instance, we define ring of integers for every field (including positive char!, or the reals) as the integral closure of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>. It might be disgusting, but you do not need any finiteness condition on it.</p>



<a name="259073327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259073327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259073327">(Oct 26 2021 at 09:48)</a>:</h4>
<p>Can't you define a <code>Prop</code> called <code>contains_nth_root_of_one</code> by saying that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> has at least one root, and then define that an algebra tower <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi mathvariant="normal">/</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">A/B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> is cyclotomic if the <code>Prop</code> is satisfied?</p>



<a name="259074087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259074087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259074087">(Oct 26 2021 at 09:56)</a>:</h4>
<p>Is it OK in characteristic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>?</p>



<a name="259074121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259074121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259074121">(Oct 26 2021 at 09:57)</a>:</h4>
<p>Yes, it seems it is</p>



<a name="259074490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259074490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259074490">(Oct 26 2021 at 10:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">is_cyclotomic_extension</span> <span class="o">(</span><span class="n">K</span> <span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">pnat</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">ex_root</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">pnat</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">r</span> <span class="o">:</span> <span class="n">L</span><span class="o">,</span> <span class="n">polynomial.aeval</span> <span class="n">r</span> <span class="o">(</span><span class="n">polynomial.cyclotomic</span> <span class="n">a</span> <span class="n">K</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">adjoint_roots</span> <span class="o">:</span> <span class="n">algebra.adjoin</span> <span class="n">K</span> <span class="o">{</span> <span class="n">b</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="n">pnat</span><span class="o">,</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">∧</span> <span class="n">b</span><span class="bp">^</span><span class="o">(</span><span class="bp">↑</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">}</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span>
</code></pre></div>



<a name="259074630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259074630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259074630">(Oct 26 2021 at 10:02)</a>:</h4>
<p>Do we say that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>-th cyclotomic extension of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>?</p>



<a name="259075252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259075252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259075252">(Oct 26 2021 at 10:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259074630">said</a>:</p>
<blockquote>
<p>Do we say that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>-th cyclotomic extension of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>?</p>
</blockquote>
<p>Yes, I think this is what was suggested earlier</p>



<a name="259075276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259075276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259075276">(Oct 26 2021 at 10:09)</a>:</h4>
<p>Why not? I think it is better to add a lemma saying that "nothing happens"  rather than adding a constraint.</p>



<a name="259075448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259075448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259075448">(Oct 26 2021 at 10:11)</a>:</h4>
<p>Ah, I am stupid, this is <em>always</em> the extension generated by the primitive <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>-th roots of unity (there are no primitive <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>-th roots of unity in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, so that's OK)</p>



<a name="259093332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259093332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259093332">(Oct 26 2021 at 13:10)</a>:</h4>
<p>Well, I wanted to add a <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>  but certainly don't want to agree on your "I am stupid"... <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="259093589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259093589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259093589">(Oct 26 2021 at 13:12)</a>:</h4>
<p>What I like of the above definition is that it also allows for infinite cyclotomic extensions, because you do not require that <code>S</code> is a <code>finset</code>. Indeed, when we will do Iwasawa theory, it will be important to have the cyclotomic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.974998em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>-extension at our disposal.</p>



<a name="259214530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259214530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259214530">(Oct 27 2021 at 09:48)</a>:</h4>
<p>By the way,  I have been thinking about the <code>(S : set pnat)</code> business. I am wondering if it would not be more appropriate to let <code>S</code> be a sub-lattice of <code>pnat</code> (or of <code>nat</code>) when the (positive) naturals are ordered by division. This would allow to use Galois connections to state the theorem that the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>-th cyclotomic field is contained in the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>-th whenever <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∣</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\mid m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>. Otherwise, the result becomes a bit painful to state (divisibility is always defined in <code>nat</code> but "often" means nothing) and more painful to prove: whereas Galois connections are really natural and cute (<span class="user-mention" data-user-id="110031">@Patrick Massot</span>  and <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> , dont' you agree ? <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span>  )</p>



<a name="259216076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259216076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259216076">(Oct 27 2021 at 10:03)</a>:</h4>
<p>They really are cute! But how do you state that <code>S</code> is a sublattice?</p>



<a name="259216388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259216388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259216388">(Oct 27 2021 at 10:06)</a>:</h4>
<p>Unless I misunderstood, does that mean we should define a type synonym for any type where division makes sense?</p>



<a name="259216518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259216518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259216518">(Oct 27 2021 at 10:07)</a>:</h4>
<p>Then <code>S : set (div_order nat)</code> or <code>S : set (div_order pnat)</code> would be more appropriate.</p>



<a name="259218033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259218033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259218033">(Oct 27 2021 at 10:23)</a>:</h4>
<p>However we'll need to quotient by the units to even get a partial order...</p>



<a name="259218231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259218231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259218231">(Oct 27 2021 at 10:25)</a>:</h4>
<p>You are right. What I had in mind is that it is useful to be sure that <code>S</code> is itself a (div)-lattice. So, for instance, rather than considering the singleton <code>a : set nat</code> one should consider the lattice of all divisors of <code>a</code>. They give rise to the same cyclotomic extension, but with the Galois connection bonus.</p>



<a name="259218273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259218273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259218273">(Oct 27 2021 at 10:25)</a>:</h4>
<p>And as long as <code>nat</code> is concerned, there are not so many units...</p>



<a name="259218577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259218577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259218577">(Oct 27 2021 at 10:28)</a>:</h4>
<p>At any rate, it is vital to wait for <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> 's opinion on all this, since he is the one defining cyclotomic extensions.</p>



<a name="259218931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259218931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259218931">(Oct 27 2021 at 10:32)</a>:</h4>
<p>I don't immediately see how to use Galois connections because we don't have a type of all cyclotomic fields</p>



<a name="259219150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259219150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259219150">(Oct 27 2021 at 10:34)</a>:</h4>
<p>Not yet, but this was Riccardo's project, to define them. And my point was whether it is better to attach a cyclotomic field to a subset of <code>nat</code> or to some sort of division-lattice in it, so that we can later <em>state</em> the existence of a Galois connection.</p>



<a name="259220482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259220482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259220482">(Oct 27 2021 at 10:47)</a>:</h4>
<p>If we defined a choice of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="double-struck">Q</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{\mathbb{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.05556em;vertical-align:-0.16667em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8888900000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbb">Q</span></span></span><span style="top:-3.80889em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.16667em;"><span></span></span></span></span></span></span></span></span> (e.g. the subfield of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">C</mi></mrow><annotation encoding="application/x-tex">\mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">C</span></span></span></span>) then we could define cyclotomic fields as subfields of this, and also define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>a</mi><mi>l</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="double-struck">Q</mi><mo stretchy="true">‾</mo></mover><mi mathvariant="normal">/</mi><mi mathvariant="double-struck">Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Gal(\overline{\mathbb{Q}}/\mathbb{Q})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.13889em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8888900000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbb">Q</span></span></span><span style="top:-3.80889em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.16667em;"><span></span></span></span></span></span><span class="mord">/</span><span class="mord mathbb">Q</span><span class="mclose">)</span></span></span></span>.</p>



<a name="259220569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259220569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259220569">(Oct 27 2021 at 10:48)</a>:</h4>
<p>After all, we defined <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">C</mi></mrow><annotation encoding="application/x-tex">\mathbb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">C</span></span></span></span> and that has automorphisms</p>



<a name="259220619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259220619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259220619">(Oct 27 2021 at 10:49)</a>:</h4>
<p>My experience with Dededind domains would rather suggest to keep everything moving, so defining a predicate <code>is_cyclotomic_extension L K</code> to say that <code>L</code> is obtained by adjoining the root of a cyclotomic polynomial to <code>K</code> whatever <code>K</code> is.</p>



<a name="259221109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259221109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259221109">(Oct 27 2021 at 10:54)</a>:</h4>
<p>I agree that it's not clear that Galois connections can be used here. Basically, we would need to define</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">lattice_of_cyclotomic_fields</span> <span class="o">:=</span> <span class="n">_</span>
</code></pre></div>
<p>But I don't think it will be very nice to work with terms of that type.</p>



<a name="259221511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259221511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259221511">(Oct 27 2021 at 10:59)</a>:</h4>
<p>Hmm...I see what you mean, but coming from the Iwasawa-theoretic perspective, this would seem quite reasonable to me. The way Iwasawa theory attaches gadgets (class groups, ell. curves or cohomology thereof) to "layers" in cyclotomic extensions seems to be described pretty well as a Galois connection</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">lattice_of_cyclotomic_fields</span> <span class="bp">-&gt;</span> <span class="n">bleah</span>
</code></pre></div>
<p>I might not see some hidden problem, though.</p>



<a name="259221708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259221708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259221708">(Oct 27 2021 at 11:00)</a>:</h4>
<p>In Iwasawa theory, is this an honest lattice, or is it a category (with Galois groups as automorphism groups for the object = cyclotomic fields).</p>



<a name="259221735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259221735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259221735">(Oct 27 2021 at 11:01)</a>:</h4>
<p>Because maybe we should use (adjoint) functors instead of Galois connections.</p>



<a name="259222072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259222072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259222072">(Oct 27 2021 at 11:05)</a>:</h4>
<p>I would really think that it is a honest lattice; but may be I should better understand when is it better to speak in terms of lattices and when in terms of categories. In <a href="https://leanprover-community.github.io/mathlib_docs">#docs</a>.galois_connection I read "A Galois connection is a pair of functions <code>l</code> and <code>u</code> satisfying <code>l a ≤ b ↔ a ≤ u b</code>. They are special cases of adjoint functors in category theory, but do not depend on the category theory library in mathlib." and I have the feeling that the whole machinery of category theory would not be very useful in practice for Iwasawa theory.</p>



<a name="259222322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259222322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259222322">(Oct 27 2021 at 11:08)</a>:</h4>
<p>So all fields are embedded in a fixed algebraic closure? And you don't consider different embeddings?</p>



<a name="259222423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259222423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259222423">(Oct 27 2021 at 11:08)</a>:</h4>
<p>Indeed, it never happened to me to consider different embeddings while doing Iwasawa theory...</p>



<a name="259222750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259222750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259222750">(Oct 27 2021 at 11:12)</a>:</h4>
<p>Cyclotomic extensions are abelian extensions, so the subtle problem of whether a number field should be regarded as coming with a fixed embedding into the complexes is reduced to the simpler problem of understanding their Galois groups</p>



<a name="259222819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259222819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259222819">(Oct 27 2021 at 11:13)</a>:</h4>
<p>Filippo might never have changed his embedding into the complexes but will have considered the Galois group of a cyclotomic field over Q</p>



<a name="259231200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259231200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259231200">(Oct 27 2021 at 12:33)</a>:</h4>
<p>Sure I did! At any rate, I would be happy in general to get a clearer picture on when are Galois connections/insertions the best choice as opposed to categorical adjunctions.</p>



<a name="259233602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259233602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259233602">(Oct 27 2021 at 12:54)</a>:</h4>
<p>In the other stream I originally had in mind to use <code>truncation_set</code>s for <code>S</code> (which might additionally be closed under lcm). What do you think about that idea?</p>



<a name="259233672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259233672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259233672">(Oct 27 2021 at 12:55)</a>:</h4>
<p>Another issue in positive characteristic is that you can add as many powers of p as you like without changing the property</p>



<a name="259233888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259233888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259233888">(Oct 27 2021 at 12:57)</a>:</h4>
<p>Do you mean truncated sets?</p>



<a name="259233938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259233938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259233938">(Oct 27 2021 at 12:57)</a>:</h4>
<p>Concerning positive char, I agree that nothing happens, but what is the problem in the definition?</p>



<a name="259234040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259234040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259234040">(Oct 27 2021 at 12:58)</a>:</h4>
<p>Oh I mean truncation sets in the sense of, e.g., <a href="http://math.uchicago.edu/~drinfeld/Seminar-2019/Witt_vectors/Hesselholt%20on%20Witt%20vectors.pdf">http://math.uchicago.edu/~drinfeld/Seminar-2019/Witt_vectors/Hesselholt%20on%20Witt%20vectors.pdf</a></p>



<a name="259234231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259234231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259234231">(Oct 27 2021 at 13:00)</a>:</h4>
<p>Oh, great. I was not aware of this notion. Sure, it makes sense and really goes in the direction I had in mind.</p>



<a name="259234546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259234546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259234546">(Oct 27 2021 at 13:02)</a>:</h4>
<p>I confess I still somewhat feel that setting up Galois would make Iwasawa-theory life easy: for instance, you could say that the assignment <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>↦</mo><msub><mi mathvariant="script">C</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">n \mapsto  \mathcal{C}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.522em;vertical-align:-0.011em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a Galois connection where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">C</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{C}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a group (e.g. the class group) attached to the field of degree <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">p^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> in a cyclotomic tower.</p>



<a name="259234607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259234607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259234607">(Oct 27 2021 at 13:02)</a>:</h4>
<p>A part from this, I think it would be important to allow for <em>infinite</em> truncation sets.</p>



<a name="259234681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259234681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259234681">(Oct 27 2021 at 13:03)</a>:</h4>
<p>For sure. I don't want any finiteness restriction on S</p>



<a name="259235171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235171">(Oct 27 2021 at 13:07)</a>:</h4>
<p>There should be something like a Galois connection btw. Maybe just an adjunction between the lattice of truncation sets and the category of cyclotomic extensions (which is not a lattice since there are automorphisms).</p>



<a name="259235383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235383">(Oct 27 2021 at 13:09)</a>:</h4>
<p>Ah, I see the business with lattices and categories, now: thanks!</p>



<a name="259235470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235470">(Oct 27 2021 at 13:09)</a>:</h4>
<p>You probably can use the category of all algebras over the base field. The functor in one direction takes a set S and gives the cyclotomic extension associated to it, and in the other direction you take an algebra and send it to the set S of all n such that X^n-1 splits in the algebra.</p>



<a name="259235562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235562">(Oct 27 2021 at 13:10)</a>:</h4>
<p>Truncation sets might indeed be the right context!</p>



<a name="259235608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235608">(Oct 27 2021 at 13:10)</a>:</h4>
<p>Yes, it seems to make sense.</p>



<a name="259235686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235686">(Oct 27 2021 at 13:11)</a>:</h4>
<p>The only problem is that "the cyclotomic extensions associated to it" does not quite exist, right? One needs to pick up an alg closed field - or something like that.</p>



<a name="259235852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235852">(Oct 27 2021 at 13:12)</a>:</h4>
<p>I would rather consider the category of all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>-subalgebras in a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>-algebra <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span>, and let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span> vary.</p>



<a name="259235990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259235990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259235990">(Oct 27 2021 at 13:13)</a>:</h4>
<p>I am not ignoring your messages, and your help is really appreciated. I will read everything after having fixed a problem with the current def</p>



<a name="259236381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259236381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259236381">(Oct 27 2021 at 13:16)</a>:</h4>
<p><span class="user-mention" data-user-id="300245">@Filippo A. E. Nuccio</span> you are right, to define the functor from S to algebras, it might be easier to choose an algebraic closure and work inside there.</p>



<a name="259239727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259239727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259239727">(Oct 27 2021 at 13:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300245">Filippo A. E. Nuccio</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259235383">said</a>:</p>
<blockquote>
<p>Ah, I see the business with lattices and categories, now: thanks!</p>
</blockquote>
<p>Categories in Lean have two universes associated with them -- the universe where the objects live and the universe where the morphisms live. If you imagine a category where morphisms live in <code>Prop</code> then you get exactly a preorder :-)</p>



<a name="259245414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259245414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259245414">(Oct 27 2021 at 14:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259239727">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="300245">Filippo A. E. Nuccio</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259235383">said</a>:</p>
<blockquote>
<p>Ah, I see the business with lattices and categories, now: thanks!</p>
</blockquote>
<p>Categories in Lean have two universes associated with them -- the universe where the objects live and the universe where the morphisms live. If you imagine a category where morphisms live in <code>Prop</code> then you get exactly a preorder :-)</p>
</blockquote>
<p>Oh, this is very nice a description indeed! Thanks.</p>



<a name="259246022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259246022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259246022">(Oct 27 2021 at 14:19)</a>:</h4>
<p>and then all the adjoint functor stuff just precisely translates into Galois connections in this special case.</p>



<a name="259246139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259246139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259246139">(Oct 27 2021 at 14:20)</a>:</h4>
<p>Unfortunately my memory was that Scott once tried to let categories have Props as morphisms but things didn't work out for some reason, so he changed them all back to types.</p>



<a name="259246273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259246273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259246273">(Oct 27 2021 at 14:21)</a>:</h4>
<p>Ah, I see. But as long as preorders exist, we can call these special categories that way...</p>



<a name="259246472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259246472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259246472">(Oct 27 2021 at 14:22)</a>:</h4>
<p>For some reason, <code>quiver</code> is allowed to have Hom sets in Prop, but not <code>category_struct</code> (see the "v+1" in that definition)</p>



<a name="259246639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259246639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259246639">(Oct 27 2021 at 14:23)</a>:</h4>
<p>However it's still a cool mental model to have :-)</p>



<a name="259249829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259249829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259249829">(Oct 27 2021 at 14:42)</a>:</h4>
<p>Late to the party, but currently we have a characteristic predicate</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>

<span class="kd">class</span> <span class="n">is_cyclotomic_extension</span> <span class="o">:=</span>
<span class="o">(</span> <span class="n">ex_root</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">r</span> <span class="o">:</span> <span class="n">B</span><span class="o">,</span> <span class="n">aeval</span> <span class="n">r</span> <span class="o">(</span><span class="n">cyclotomic</span> <span class="n">a</span> <span class="n">A</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">adjoint_roots</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span> <span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">,</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">∧</span> <span class="n">b</span> <span class="bp">^</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">}</span> <span class="o">)</span>
</code></pre></div>



<a name="259249998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259249998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259249998">(Oct 27 2021 at 14:43)</a>:</h4>
<p>And a "model"</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[derive [field, algebra K]</span><span class="o">]</span>
<span class="kd">def</span> <span class="n">cyclotomic_field</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span> <span class="o">:=</span> <span class="o">(</span><span class="n">cyclotomic</span> <span class="n">n</span> <span class="n">K</span><span class="o">)</span><span class="bp">.</span><span class="n">splitting_field</span>

<span class="kd">lemma</span> <span class="n">is_cyclotomic_extension</span> <span class="o">:</span> <span class="n">is_cyclotomic_extension</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="n">K</span> <span class="o">(</span><span class="n">cyclotomic_field</span> <span class="n">n</span> <span class="n">K</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>defined over a field <code>K</code> for <code>S</code> a singleton.</p>



<a name="259252384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259252384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259252384">(Oct 27 2021 at 14:58)</a>:</h4>
<p>Just playing around with this idea <span class="user-mention" data-user-id="300245">@Filippo A. E. Nuccio</span>:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.is_alg_closed.algebraic_closure</span>
<span class="kn">import</span> <span class="n">field_theory.adjoin</span>
<span class="kn">import</span> <span class="n">algebra.category.Algebra.basic</span>
<span class="kn">import</span> <span class="n">category_theory.category.preorder</span>
<span class="kn">import</span> <span class="n">field_theory.splitting_field</span>

<span class="kd">universe</span> <span class="n">u</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">category_theory</span>

<span class="kd">noncomputable theory</span>

<span class="kd">structure</span> <span class="n">FieldExtension</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="o">[</span><span class="n">str</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span><span class="o">]</span>
<span class="o">[</span><span class="n">alg</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">F</span> <span class="n">K</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">FieldExtension</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">FieldExtension</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">instance</span> <span class="n">has_coe_to_sort</span> <span class="o">:</span> <span class="n">has_coe_to_sort</span> <span class="o">(</span><span class="n">FieldExtension</span> <span class="n">F</span><span class="o">)</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">K</span><span class="o">,</span> <span class="n">K.K</span><span class="o">⟩</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">K.str</span>
<span class="kd">instance</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">F</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">K.alg</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">FieldExtension</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">K</span> <span class="n">L</span><span class="o">,</span> <span class="n">K</span> <span class="bp">→ₐ</span><span class="o">[</span><span class="n">F</span><span class="o">]</span> <span class="n">L</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">K</span><span class="o">,</span> <span class="n">alg_hom.id</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">g.comp</span> <span class="n">f</span> <span class="o">}</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">F</span><span class="o">}</span>

<span class="kd">def</span> <span class="n">of</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">F</span> <span class="n">E</span><span class="o">]</span> <span class="o">:</span> <span class="n">FieldExtension</span> <span class="n">F</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">E</span><span class="o">⟩</span>

<span class="kd">def</span> <span class="n">ι</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">FieldExtension</span> <span class="n">F</span><span class="o">)</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">→+*</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">algebra_map</span> <span class="n">_</span> <span class="n">_</span>

<span class="kd">end</span> <span class="n">FieldExtension</span>
<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">def</span> <span class="n">to_set</span> <span class="o">:</span> <span class="n">FieldExtension</span> <span class="n">F</span> <span class="bp">⥤</span> <span class="o">(</span><span class="n">set</span> <span class="n">pnat</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="o">{</span> <span class="n">n</span> <span class="bp">|</span> <span class="n">splits</span> <span class="n">A.ι</span> <span class="o">(</span><span class="n">X</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">},</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">B</span> <span class="n">f</span><span class="o">,</span> <span class="n">hom_of_le</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">B.ι</span> <span class="bp">=</span> <span class="n">ring_hom.comp</span> <span class="n">f.to_ring_hom</span> <span class="n">A.ι</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">ext</span> <span class="n">t</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">(</span><span class="n">f.commutes</span> <span class="n">t</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">splits_comp_of_splits</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hx</span><span class="o">,</span>
  <span class="kd">end</span> <span class="o">}</span>

<span class="kd">def</span> <span class="n">to_algebra</span> <span class="o">:</span> <span class="o">(</span><span class="n">set</span> <span class="n">pnat</span><span class="o">)</span> <span class="bp">⥤</span> <span class="n">FieldExtension</span> <span class="n">F</span> <span class="o">:=</span>
<span class="k">let</span> <span class="n">Fbar</span> <span class="o">:=</span> <span class="n">algebraic_closure</span> <span class="n">F</span> <span class="k">in</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">S</span><span class="o">,</span> <span class="n">FieldExtension.of</span> <span class="bp">$</span>
    <span class="n">intermediate_field.adjoin</span> <span class="n">F</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">Fbar</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">),</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">},</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">S</span> <span class="n">T</span> <span class="n">f</span><span class="o">,</span> <span class="n">subalgebra.inclusion</span> <span class="bp">$</span> <span class="n">intermediate_field.adjoin.mono</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="bp">$</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">x</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span><span class="n">hn</span><span class="o">,</span><span class="n">hx</span><span class="o">⟩,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">le_of_hom</span> <span class="n">f</span> <span class="n">hn</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">map_id'</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">S</span><span class="o">,</span>
    <span class="n">ext</span> <span class="n">t</span><span class="o">,</span>
    <span class="n">simpa</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">map_comp'</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">ext</span> <span class="n">t</span><span class="o">,</span>
    <span class="n">simpa</span><span class="o">,</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>
</div></div>
<p>I wanted to prove the adjunction as well, but I have to go teach <span aria-label="expressionless" class="emoji emoji-1f611" role="img" title="expressionless">:expressionless:</span></p>



<a name="259252512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259252512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259252512">(Oct 27 2021 at 14:59)</a>:</h4>
<p>Very nice!</p>



<a name="259255400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259255400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259255400">(Oct 27 2021 at 15:15)</a>:</h4>
<p>I guess we can have some interplay with a more down to Earth interpretation, right? Like <code>group</code> and <code>Group</code> and so on.</p>



<a name="259255680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259255680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259255680">(Oct 27 2021 at 15:17)</a>:</h4>
<p>I agree that such an abstract approach can be useful sometimes, but what will happen when we have to prove that <code>(1-z)^p =...</code> or a similar very very concrete result? Of course it will be provable, at end the objects are the same, but I am afraid it will be annoying.</p>



<a name="259356609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259356609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259356609">(Oct 28 2021 at 08:39)</a>:</h4>
<p>It seems that it's enough to prove something like <code>is_cyclotomic_extension S K (to_algebra S)</code> to make the link between the categorical def and the "concrete" one.</p>



<a name="259362507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259362507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259362507">(Oct 28 2021 at 09:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259072521">said</a>:</p>
<blockquote>
<p>Well, to be honest I am not even sure what that notation means. In real math, when we write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mi>α</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\alpha]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">]</span></span></span></span> we often mean the ring of integers of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{Q}(\alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>.</p>
</blockquote>
<p>To be honest, I've never seen any use of this convention, and I would not recommend it.</p>



<a name="259363129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259363129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259363129">(Oct 28 2021 at 09:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259072789">said</a>:</p>
<blockquote>
<p>But what definition do you propose? We cannot say that a polynomial is split over a ring</p>
</blockquote>
<p>If the polynomial is monic, it may sense to say that it factors as a product of monic terms of degree 1 .</p>
<p>Moreover, the book <em>Modern Computer Algebra</em> by von zur Gathen and Gerhard, ISBN: 0-521-82646-2, defines the splitting algebra $S$ of a monic degree $n$ polynomial $P\in R[T]$ as the algebra generated by $n$ indeterminates $a_1,\dots,a_n$ quotiented by the relations that say that $P=(T-a_1)\dots (T-a_n)$. This algebra is free of rank $n!$  over $R$, it has an action of the symmetric group $\mathfrak S_n$. If $R$ is a field,  then this algebra is artinian, the symmetric group acts transitively on the set of maximal ideals, the residue fields are splitting extensions of $P$., and the fixator of any maximal ideal in $\mathfrak S_n$ is “the” Galois group of $P$.</p>



<a name="259364234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259364234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259364234">(Oct 28 2021 at 09:53)</a>:</h4>
<p>It surely makes sense mathematically. I meant it's not in mathlib, and I prefer not spending two months in writing 100 stupid lemmas about a new notion if it's possible</p>



<a name="259364395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259364395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259364395">(Oct 28 2021 at 09:54)</a>:</h4>
<p>Well, isn't that the point of those big projects? <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="259366963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259366963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259366963">(Oct 28 2021 at 10:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259364234">said</a>:</p>
<blockquote>
<p>It surely makes sense mathematically. I meant it's not in mathlib, and I prefer not spending two months in writing 100 stupid lemmas about a new notion if it's possible</p>
</blockquote>
<p>I don't know whether it is useful to include it in mathlib, and I don't claim somebody should.<br>
I just claim this is a meaningful mathematical notion, and having it in mind may be useful to think about the topic.</p>



<a name="259368661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259368661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259368661">(Oct 28 2021 at 10:37)</a>:</h4>
<p>Sure, I completely agree!</p>



<a name="259467477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259467477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259467477">(Oct 28 2021 at 23:52)</a>:</h4>
<p>Am I correct in reading the above as a proposed more general definition of <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.splitting_field">docs#polynomial.splitting_field</a>? Or is it a separate concept?</p>



<a name="259473738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259473738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259473738">(Oct 29 2021 at 01:38)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> Antoine's suggestion won't quite generalize the splitting field, but it's related. If you apply that construction in the case where the base is a field, and mod out by some maximal ideal, you would indeed get "the" splitting field (rather, "a" splitting field).</p>



<a name="259474400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259474400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259474400">(Oct 29 2021 at 01:50)</a>:</h4>
<p>One point where I think this construction could be very useful is in generalizing <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.splits">docs#polynomial.splits</a></p>



<a name="259474489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259474489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259474489">(Oct 29 2021 at 01:52)</a>:</h4>
<p>I.e. we could say that a polynomial <code>f : R[X]</code> splits w.r.t <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ι</mi><mo>:</mo><mi>R</mi><mo>→</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">\iota : R \to S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ι</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ι</mi></mrow><annotation encoding="application/x-tex">\iota</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ι</span></span></span></span> factors through the algebra in question.</p>



<a name="259501826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/259501826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#259501826">(Oct 29 2021 at 09:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/259467477">said</a>:</p>
<blockquote>
<p>Am I correct in reading the above as a proposed more general definition of <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.splitting_field">docs#polynomial.splitting_field</a>? Or is it a separate concept?</p>
</blockquote>
<p>It is a separate, but related, concept. If you apply the “splitting algebra” to a separable polynomial over a field, you get a separable algebra which is a product of fields, all isomorphic to the splitting field extension. If the polynomial is not separable, the algebra you get may not be a field, it may have nilpotent elements. (Already for $P=T^2$, what you get is $k[a,b]/(a+b,ab)=k[a]/(a^2)$.)</p>



<a name="265957185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265957185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265957185">(Dec 23 2021 at 22:03)</a>:</h4>
<p>After some weeks working on the flt-regular project, we realized that the definition of <code>is_cyclotomic_extension</code> we are using is maybe <em>too</em> general. The definition is basically "generated by the roots of the <code>n</code>-th cyclotomic polynomial". You can have a look at <a href="https://github.com/leanprover-community/mathlib/pull/10849">#10849</a> or at the <a href="https://github.com/leanprover-community/flt-regular">full project</a> if you are curious.</p>
<p>The problem is that, for example, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> cyclotomic extension of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is trivial, and in practice it is not true that we have <code>n</code>-th primitive roots of unity in a <code>n</code>-th cyclotomic extension. The math is clear (I even have a Lean proof the following): if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi mathvariant="normal">/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">L/K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>-th cyclotomic extension and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n \neq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> then everything is OK, but if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is of characteristic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>p</mi><mi>s</mi></msup><mi>m</mi></mrow><annotation encoding="application/x-tex">n = p^s m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> coprime, then we only have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>-th primitive roots of unity in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>.</p>
<p>My question is what can we do in Lean? Having <code>hn : (↑n : _) ≠ 0</code> is getting annoying, and in practice, for flt-regular, we are only interested in the <code>char_zero</code> case. Of course <code>char_p</code> cyclotomic extensions are interesting, but maybe not the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>-th cyclotomic extension of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>. I am thinking about adding to the definition of <code>is_cyclotomic_extension</code> the condition that <code>(↑n : _) ≠ 0</code>. What do you think?</p>



<a name="265957447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265957447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265957447">(Dec 23 2021 at 22:06)</a>:</h4>
<p>I don't see a way of using efficiently TC resolution here, but it's maybe my fault.</p>



<a name="265958117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265958117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265958117">(Dec 23 2021 at 22:13)</a>:</h4>
<p>(related discussion <a href="#narrow/stream/304774-FLT-regular/topic/hn.20.3A.20.28.E2.86.91n.20.3A.20_.29.20.E2.89.A0.200">here</a>)</p>



<a name="265959276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959276">(Dec 23 2021 at 22:29)</a>:</h4>
<p>To give a more explicit example, consider the following: let <code>B</code> be an <code>A</code>-algbra with <code>[is_cyclotomic_extension n A B]</code> for a given <code>n</code>. Let <code>foo</code> be the theorem that says that, if <code>[is_domain B]</code> and <code>(↑n : B) ≠ 0</code> then there is a primitive <code>n</code>-th root of unity in <code>B</code>. We want also a <code>bar</code> theorem that, if <code>[is_domain B] [char_zero B]</code> gives the same result as <code>foo</code>, without having to prove <code>(↑n : B) ≠ 0</code> manually.</p>



<a name="265959355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959355">(Dec 23 2021 at 22:30)</a>:</h4>
<p>Of course we can just prove both <code>foo</code> and <code>bar</code>, but we would like to avoid to duplicate all the theorems with <code>(↑n : B) ≠ 0</code>.</p>



<a name="265959363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959363">(Dec 23 2021 at 22:30)</a>:</h4>
<p>Maybe the definition of "primitive root of unity" should be changed?</p>



<a name="265959397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959397">(Dec 23 2021 at 22:31)</a>:</h4>
<p>What definition is currently being used?</p>



<a name="265959407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959407">(Dec 23 2021 at 22:31)</a>:</h4>
<p>The definition looks perfectly fine to me, it's just that there are no <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>-th primitive roots of unity if a field of  chracteristic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>.</p>



<a name="265959455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959455">(Dec 23 2021 at 22:32)</a>:</h4>
<p>The multiplicative order of a primitive <code>n</code>-th root of unity is <code>n</code>.</p>



<a name="265959467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959467">(Dec 23 2021 at 22:32)</a>:</h4>
<p>I mean, this is essentially the definition.</p>



<a name="265959468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959468">(Dec 23 2021 at 22:32)</a>:</h4>
<p>Well, I would argue that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> is a primitive 5th root of unity in a field of characteristic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> :)</p>



<a name="265959516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959516">(Dec 23 2021 at 22:33)</a>:</h4>
<p>But that doesn't satisfy <a href="https://leanprover-community.github.io/mathlib_docs/find/is_primitive_root">docs#is_primitive_root</a>.</p>



<a name="265959589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959589">(Dec 23 2021 at 22:34)</a>:</h4>
<p><code>1 ^ 1 = 1</code> but <code>5 ∣ 1</code> is false.</p>



<a name="265959612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959612">(Dec 23 2021 at 22:35)</a>:</h4>
<p>yeah, of course, so one could change the second condition in that def</p>



<a name="265959632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959632">(Dec 23 2021 at 22:35)</a>:</h4>
<p>are you then saying a primitive root should by definition be a root of the <code>n</code>th cyclotomic poly?</p>



<a name="265959645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959645">(Dec 23 2021 at 22:35)</a>:</h4>
<p>I guess so, yeah.</p>



<a name="265959706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959706">(Dec 23 2021 at 22:36)</a>:</h4>
<p>But cyclotomic polynomials are defined using primitive roots...</p>



<a name="265959719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959719">(Dec 23 2021 at 22:36)</a>:</h4>
<p>I know they can be defined directly, but I don't think we want to do such a refactor</p>



<a name="265959955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959955">(Dec 23 2021 at 22:41)</a>:</h4>
<p><span class="user-mention" data-user-id="284160">@Eric Rodriguez</span>  what do you think about having results with<code>(↑n : _) ≠ 0</code> as an explicit assumption (so no <code>fact</code>) and duplicate them in the <code>char_zero</code> case? Maybe at the end of the day the duplicated code is not that much...</p>



<a name="265959980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265959980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265959980">(Dec 23 2021 at 22:41)</a>:</h4>
<p>For flt-regular we will very quickly specialize to <code>Q</code>, so it doesn't really matter</p>



<a name="265960205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960205">(Dec 23 2021 at 22:45)</a>:</h4>
<p>I still think it may be helpful to have the ne-zero classes that I outlined in the linked thread; TC can then deal with everything (hopefully) - there should only be this new class, and <code>no_smul_zero_divisors</code> involved. That also seems like a decent solution, though; who deals with charp and char zero at the same time without getting headaches ;b</p>



<a name="265960288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960288">(Dec 23 2021 at 22:47)</a>:</h4>
<p>Sounds easy enough that abbreviating the appropriate <code>fact</code> and maybe writing some quick API (to avoid always going down to <code>fact.out</code>) should do the job.</p>



<a name="265960369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960369">(Dec 23 2021 at 22:48)</a>:</h4>
<p>we can't have (global) <code>fact</code> instances, Yael</p>



<a name="265960413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960413">(Dec 23 2021 at 22:50)</a>:</h4>
<p>at least, we shouldn't because it slows down TC; but a couple of cases seem to have done it regardless</p>



<a name="265960476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960476">(Dec 23 2021 at 22:50)</a>:</h4>
<p>Then don't make it an abbreviation but instead a proper class.</p>



<a name="265960623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960623">(Dec 23 2021 at 22:54)</a>:</h4>
<p>Do you mean something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">test</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">out</span> <span class="o">:</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">))</span>
</code></pre></div>
<p>?</p>



<a name="265960885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960885">(Dec 23 2021 at 22:59)</a>:</h4>
<p>I had N+ in mind, but I think this is better because we can just provide an easy-to-use instance for N+</p>



<a name="265960921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265960921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265960921">(Dec 23 2021 at 22:59)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">test</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">out</span> <span class="o">:</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">))</span>

<span class="kd">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">char_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">test</span> <span class="n">R</span> <span class="n">n</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">nat.cast_ne_zero.2</span> <span class="n">n.pos.ne'</span><span class="o">⟩</span>
</code></pre></div>
<p>seems to work</p>



<a name="265961087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961087">(Dec 23 2021 at 23:01)</a>:</h4>
<p>If there are no TC resolution problems I propose this way</p>



<a name="265961317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961317">(Dec 23 2021 at 23:04)</a>:</h4>
<p>any idea where in mathlib this could be placed?</p>



<a name="265961347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961347">(Dec 23 2021 at 23:05)</a>:</h4>
<p>Close to <a href="https://leanprover-community.github.io/mathlib_docs/find/char_zero">docs#char_zero</a>?</p>



<a name="265961383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961383">(Dec 23 2021 at 23:05)</a>:</h4>
<p>Actually, this is a very sense-making typeclass that can probably be used in many places where we had previously used <code>char_zero</code>.</p>



<a name="265961434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961434">(Dec 23 2021 at 23:06)</a>:</h4>
<p>Typically for <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.asc_factorial">docs#nat.asc_factorial</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/pochhammer">docs#pochhammer</a>...</p>



<a name="265961439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961439">(Dec 23 2021 at 23:06)</a>:</h4>
<p><code>char_not_dvd_class</code>?</p>



<a name="265961691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265961691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265961691">(Dec 23 2021 at 23:11)</a>:</h4>
<p>I have never heard of the phrase "cyclotomic extension" being used to describe anything other than extensions of number fields and p-adic fields BTW</p>



<a name="265962012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265962012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265962012">(Dec 23 2021 at 23:17)</a>:</h4>
<p>To be honest, I have been looking for that typeclass quite a few times already and wondered why we weren't needing it. I guess we actually do!</p>



<a name="265962450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265962450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265962450">(Dec 23 2021 at 23:25)</a>:</h4>
<p>This "n!=0 in the ground field" thing comes up a lot in representation theory of finite groups too (you often average some construction in the field over the elements of the group)</p>



<a name="265963278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265963278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265963278">(Dec 23 2021 at 23:41)</a>:</h4>
<p>Time to sleep for me, but it seems we all agree about this new typeclass :)<br>
<span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I agree about "cyclotomic extension" being used only in characteristic zero, but the mathlib mafia forced us to write the most general definition...</p>



<a name="265963855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265963855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265963855">(Dec 23 2021 at 23:51)</a>:</h4>
<p>I'm slightly conflicted about this all now, on the one hand its always nice to get results for free, and it would occasionally be helpful perhaps to reduce cyclotomic rings modulo primes and still have some results.<br>
Buut I really feel like all these weird facts floating around causes unnecessary difficultly / complication for flt-regular at this point.<br>
That said it certainly seems a characteristic not <code>n</code> typeclass is useful, certainly the <code>char_not 2</code> version will be!</p>



<a name="265964103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265964103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265964103">(Dec 23 2021 at 23:57)</a>:</h4>
<p>I think the correct class should be defined around <code>is_unit n</code>. That's a condition that pops up a lot in practice.. much more than the condition that n is nonzero</p>



<a name="265965052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265965052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265965052">(Dec 24 2021 at 00:13)</a>:</h4>
<p>Isn't that just <code>invertible</code>? This wouldn't work for our use case, as we lifted a couple results through the fraction field, and so we require n ≠ 0 for things in an arbitrary integral domain</p>



<a name="265965371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265965371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265965371">(Dec 24 2021 at 00:21)</a>:</h4>
<p>For rep theory of finite groups <code>invertible</code> is exactly what you need -- it's not just that the order is nonzero but that you can divide by it.</p>



<a name="265976783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265976783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265976783">(Dec 24 2021 at 04:45)</a>:</h4>
<p>I began work on the <code>foo</code> typeclass in <a href="https://github.com/leanprover-community/mathlib/tree/foo_typeclass">branch#foo_typeclass</a>... name suggestions, lemma suggestions, and commits not only welcome, but much encouraged ;D</p>



<a name="265976831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265976831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265976831">(Dec 24 2021 at 04:46)</a>:</h4>
<p>the file is currently <code>src/algebra/foo.lean</code></p>



<a name="265987558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265987558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265987558">(Dec 24 2021 at 08:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/265976783">said</a>:</p>
<blockquote>
<p>I began work on the <code>foo</code> typeclass in <a href="https://github.com/leanprover-community/mathlib/tree/foo_typeclass">branch#foo_typeclass</a>... name suggestions, lemma suggestions, and commits not only welcome, but much encouraged ;D</p>
</blockquote>
<p>Can you open a WIP PR so we can comment there?</p>



<a name="265988942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265988942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265988942">(Dec 24 2021 at 09:16)</a>:</h4>
<p>Concerning <code>n ≠ 0 </code> or invertible, if someone really need <code>invertible</code>they can create another class <code>bar</code>, and we can provide an insance of <code>bar</code> having <code>foo</code> and <code>field</code>. I can be wrong, but I have the impression that, when <code>invertible</code> is needed people are working over a field, so this would be enough.</p>



<a name="265989352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265989352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265989352">(Dec 24 2021 at 09:22)</a>:</h4>
<p>I agree that most of the times, the ground ring is a field.  However, I have sometimes used rings such as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\frac{1}{2}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span> to explicitly assume that 2 was invertible, but still work over a Dedekind domain.</p>



<a name="265989396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265989396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265989396">(Dec 24 2021 at 09:23)</a>:</h4>
<p>The solution of using two typeclasses, one where it is enough to assume that <code>n</code> is non-zero and one where you explicitly invert it, seems good to me, though.</p>



<a name="265989783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265989783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265989783">(Dec 24 2021 at 09:29)</a>:</h4>
<p>In the specific context of modular curves of given level <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, it is quite common to work over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\frac{1}{N}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span>.  I find that this is a situation where the two points of view mentioned above (cyclotomic-like stuff and modular/non-modular representation theory) come together.</p>



<a name="265989784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265989784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265989784">(Dec 24 2021 at 09:29)</a>:</h4>
<p>Having said that, it is probably reasonable to not develop the whole theory in this generality right now!</p>



<a name="265990374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265990374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265990374">(Dec 24 2021 at 09:40)</a>:</h4>
<p>Indeed we morally already have the class with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> invertible: it is the same as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[1/N]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord">1/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">]</span></span></span></span>-algebras.</p>



<a name="265990379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265990379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265990379">(Dec 24 2021 at 09:40)</a>:</h4>
<p>But I don't know if this can help</p>



<a name="265991783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265991783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265991783">(Dec 24 2021 at 10:07)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> It wasn't clear to me from your message above whether you know this, but <a href="https://leanprover-community.github.io/mathlib_docs/find/invertible">docs#invertible</a> already exists. So we don't need "another class <code>bar</code>".</p>



<a name="265991831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265991831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265991831">(Dec 24 2021 at 10:08)</a>:</h4>
<p>But maybe you meant something else with that <code>bar</code>?</p>



<a name="265991877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265991877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265991877">(Dec 24 2021 at 10:09)</a>:</h4>
<p>We need <code>(n : R) ≠ 0)</code>, that is not the same since we also want to work integrally, but this probably gives a good API to generalize, thanks!!</p>



<a name="265992512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265992512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265992512">(Dec 24 2021 at 10:21)</a>:</h4>
<p>Right, but that's already your <code>foo</code> class, right? So I didn't understand what you wanted from the <code>bar</code> class.</p>



<a name="265992576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265992576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265992576">(Dec 24 2021 at 10:22)</a>:</h4>
<p>Yes yes, I was talking about <code>bar</code> without knowing <a href="https://leanprover-community.github.io/mathlib_docs/find/invertible">docs#invertible</a> exists</p>



<a name="265992697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/265992697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#265992697">(Dec 24 2021 at 10:24)</a>:</h4>
<p>Ok, gotcha.</p>



<a name="266002950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266002950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266002950">(Dec 24 2021 at 13:44)</a>:</h4>
<p>Having</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">ne.fact_coe</span> <span class="o">(</span><span class="n">K</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">R</span><span class="o">]</span>
  <span class="o">[</span><span class="n">hK</span> <span class="o">:</span> <span class="n">fact</span> <span class="o">(((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">K</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)]</span> <span class="o">:</span> <span class="n">fact</span> <span class="o">(((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="kd">by</span> <span class="n">simpa</span> <span class="n">using</span> <span class="o">(</span><span class="n">function.injective.ne</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">K</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">injective</span> <span class="n">hK.out</span><span class="o">)⟩</span>

<span class="kd">instance</span> <span class="n">ne.fact_char_zero</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">char_zero</span> <span class="n">K</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">fact</span> <span class="o">(((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">K</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">nat.cast_ne_zero.mpr</span> <span class="n">n.pos.ne'</span><span class="o">⟩</span>
</code></pre></div>
<p><a href="https://github.com/leanprover-community/flt-regular/blob/master/src/number_theory/cyclotomic/cyclotomic_units.lean">here</a> makes the linter unhappy</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> The `fails_quickly` linter reports: -/</span>
<span class="c">/-</span><span class="cm"> TYPE CLASS SEARCHES TIMED OUT.</span>
<span class="cm">The following instances are part of a loop, or an excessively long search.</span>
<span class="cm">It is common that the loop occurs in a different class than the one flagged below,</span>
<span class="cm">but usually an instance that is part of the loop is also flagged.</span>
</code></pre></div>
<p>I tried to debug the error but I don't see where I am creating a loop. Any idea?</p>



<a name="266003002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003002">(Dec 24 2021 at 13:44)</a>:</h4>
<p>Might be <code>fails_quickly</code> having too low of a time-out</p>



<a name="266003101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003101">(Dec 24 2021 at 13:46)</a>:</h4>
<p>The linter suggest what to do, <a href="https://github.com/leanprover-community/flt-regular/runs/4627134460?check_suite_focus=true">here</a>, but for all the flagged instance I just get a timeout, no errors.</p>



<a name="266003399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003399">(Dec 24 2021 at 13:52)</a>:</h4>
<p>I just realized I have no idea how to run the linter locally...is it a scropt somewhere?</p>



<a name="266003414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003414">(Dec 24 2021 at 13:52)</a>:</h4>
<p>I know about <code>#lint</code> at the ed of a file, I am talking about the global linter</p>



<a name="266003488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003488">(Dec 24 2021 at 13:54)</a>:</h4>
<p>Ah, it's probably <code>lean --run scripts/lint_project.lean</code> or something similar</p>



<a name="266003549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003549">(Dec 24 2021 at 13:56)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/11033">#11033</a> is the PR; my first run failed pretty badly, I'm going to try take more of a look today</p>



<a name="266003603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266003603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266003603">(Dec 24 2021 at 13:56)</a>:</h4>
<p>Also, what does it mean by "R is a metavariable"? I thought I was being clever with my char-zero typeclass</p>



<a name="266004034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266004034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266004034">(Dec 24 2021 at 14:02)</a>:</h4>
<p>It means it can't be inferred from context usually. Try using <code>out_param</code> and summoning <span class="user-mention" data-user-id="238446">@Anne Baanen</span></p>



<a name="266004237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266004237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266004237">(Dec 24 2021 at 14:06)</a>:</h4>
<p>Looking at <a href="https://leanprover-community.github.io/mathlib_docs/find/invertible">docs#invertible</a>, it seems that they decided to not have any global instance. Everything is a <code>def</code>, and instances can be activated when needed.</p>



<a name="266004376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266004376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266004376">(Dec 24 2021 at 14:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/266004034">said</a>:</p>
<blockquote>
<p>It means it can't be inferred from context usually. Try using <code>out_param</code> and summoning <span class="user-mention silent" data-user-id="238446">Anne Baanen</span></p>
</blockquote>
<p>Indeed. The rule is that any parameter to the instance must be an <code>[instance parameter]</code> itself, be inferrable from the goal (i.e. appear after the <code>:</code>), or an <code>out_param</code>.</p>



<a name="266004567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266004567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266004567">(Dec 24 2021 at 14:12)</a>:</h4>
<p>However, in this case you can't make <code>S</code> an <code>out_param</code> to <code>foo</code> because it is not uniquely determined by the other parameters to <code>foo</code>.</p>



<a name="266004800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266004800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266004800">(Dec 24 2021 at 14:16)</a>:</h4>
<blockquote>
<p>Does the argument order matter? I would prefer <code>foo n R</code>, but not sure what TC prefers.</p>
</blockquote>
<p>Since <code>n</code> depends on <code>R</code>, the parameters have to stay in that order according to type theory. Although I guess you could use <code>notation `foo` n R := foo_class R n</code>.</p>
<p>My suggestion would be to define <code>class foo {R : Type*} [has_zero R] (n : R) := (out : n ≠ 0)</code> instead, because then you can write <code>foo (n : R)</code>.</p>



<a name="266006690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266006690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266006690">(Dec 24 2021 at 14:47)</a>:</h4>
<p>I tested in flt-regular the strategy of having lemmas instead of instances, and using <code>local attribute [instance] </code> when needed. It seems to work well.</p>



<a name="266006757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266006757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266006757">(Dec 24 2021 at 14:48)</a>:</h4>
<p>If that's what <code>invertible</code> does, as well, then that seems very reasonable.</p>



<a name="266013661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266013661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266013661">(Dec 24 2021 at 17:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/265957185">said</a>:</p>
<blockquote>
<p>After some weeks working on the flt-regular project, we realized that the definition of <code>is_cyclotomic_extension</code> we are using is maybe <em>too</em> general. The definition is basically "generated by the roots of the <code>n</code>-th cyclotomic polynomial". You can have a look at <a href="https://github.com/leanprover-community/mathlib/pull/10849">#10849</a> or at the <a href="https://github.com/leanprover-community/flt-regular">full project</a> if you are curious.</p>
</blockquote>
<p>Sorry to come after the battle, but why such a definition?</p>
<p>Compare with the definition of a solvable-by-radicals extension: you ask  that it is generated (inductively) by elements $a$ some positive power of which belong to the base field.  Here, I'd say a cyclotomic extension is generated by elements some (strictly positive) power of which is 1. Cyclotomic of cyclotomic is cyclotomic (so I did not define the stuff inductively). </p>
<p>It's easy to refine the definition to ask that the exponents belong to a given subset  of $\mathbf N$.</p>
<p>If the base is a field and the extension is finitely generated, you can prove that it is generated by a single root of unity (which is primitive of some order).</p>
<p>If the base is an integrally closed domain, you can prove that its integral closure in a cyclotomic extension of the fraction field is a cyclotomic extension. This amounts to the property that the ring of integers of $\mathbf Q(\zeta_n)$ is $\mathbf Z[\zeta_n]$ (and some limit arguments in the general case).</p>



<a name="266019428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266019428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266019428">(Dec 24 2021 at 19:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130609">Antoine Chambert-Loir</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/266013661">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/116395-maths/topic/Cyclotomic.20fields/near/265957185">said</a>:</p>
<blockquote>
<p>After some weeks working on the flt-regular project, we realized that the definition of <code>is_cyclotomic_extension</code> we are using is maybe <em>too</em> general. The definition is basically "generated by the roots of the <code>n</code>-th cyclotomic polynomial". You can have a look at <a href="https://github.com/leanprover-community/mathlib/pull/10849">#10849</a> or at the <a href="https://github.com/leanprover-community/flt-regular">full project</a> if you are curious.</p>
</blockquote>
<p>Sorry to come after the battle, but why such a definition?</p>
<p>Compare with the definition of a solvable-by-radicals extension: you ask  that it is generated (inductively) by elements <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> some positive power of which belong to the base field.  Here, I'd say a cyclotomic extension is generated by elements some (strictly positive) power of which is 1. Cyclotomic of cyclotomic is cyclotomic (so I did not define the stuff inductively). </p>
<p>It's easy to refine the definition to ask that the exponents belong to a given subset  of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">N</mi></mrow><annotation encoding="application/x-tex">\mathbf N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">N</span></span></span></span>.</p>
<p>If the base is a field and the extension is finitely generated, you can prove that it is generated by a single root of unity (which is primitive of some order).</p>
<p>If the base is an integrally closed domain, you can prove that its integral closure in a cyclotomic extension of the fraction field is a cyclotomic extension. This amounts to the property that the ring of integers of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo stretchy="false">(</mo><msub><mi>ζ</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf Q(\zeta_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo stretchy="false">[</mo><msub><mi>ζ</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf Z[\zeta_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">Z</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> (and some limit arguments in the general case).</p>
</blockquote>
<p>sorry just copying this to make it easier to read. Zulip needs double $s for LaTeX, for some reason</p>



<a name="266019842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266019842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266019842">(Dec 24 2021 at 19:23)</a>:</h4>
<p>I'm confused how you'd want to state this that's fundamentally different to our definition; our definition is a) we have all nth roots for n in <code>S : set pnat</code>, and b) <code>algebra.adjoin K {these nth roots} = \top</code>.</p>



<a name="266022543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266022543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266022543">(Dec 24 2021 at 20:27)</a>:</h4>
<p>I think Antoine wants to avoid mentioning <code>n</code> in the type. <span class="user-mention" data-user-id="130609">@Antoine Chambert-Loir</span> do I understand that correctly?<br>
You want something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">is_cyclotomic</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∃</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">B</span><span class="o">,</span>
  <span class="o">(</span><span class="n">subalgebra.span</span> <span class="n">A</span> <span class="n">s</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span> <span class="bp">∧</span>
  <span class="o">(</span><span class="bp">∀</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">n</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
</code></pre></div>



<a name="266025278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266025278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Will Sawin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266025278">(Dec 24 2021 at 21:35)</a>:</h4>
<p>This definition would be different in that it would allow for cyclotomic extensions of infinite degree.</p>



<a name="266025565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266025565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266025565">(Dec 24 2021 at 21:43)</a>:</h4>
<p>The definition proposed in <a href="https://github.com/leanprover-community/mathlib/pull/10849">#10849</a> allows for infinite extensions as well.</p>



<a name="266026036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026036">(Dec 24 2021 at 21:55)</a>:</h4>
<p>But to build on Johan's def above, you can just say that the algebra is generated by the set of roots of unity contained in the algebra. No set needed.</p>



<a name="266026312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026312">(Dec 24 2021 at 22:00)</a>:</h4>
<p>Exactly. And probably something like <code>is_elementarily_cyclotomic</code> where the set <code>s</code> is replaced by a single element <code>b: B</code>.</p>



<a name="266026475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026475">(Dec 24 2021 at 22:04)</a>:</h4>
<p>One argument to have a set as a parameter is to obtain some sort of adjunction between the lattice of subsets of Nat and the lattice of cyclotomic extensions. But it seems this just complicates things for the FLT project.</p>



<a name="266026542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026542">(Dec 24 2021 at 22:06)</a>:</h4>
<p>You have to be careful here because cyclotomic extensions are only unique up to non-unique isomorphism, so it's not clear to me that they even form a partial order -- there is some automorphism group complicating the picture in my head, at least</p>



<a name="266026557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026557">(Dec 24 2021 at 22:06)</a>:</h4>
<p>My second lattice should have been <code>category</code>, sorry <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="266026577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026577">(Dec 24 2021 at 22:07)</a>:</h4>
<p>There's no real complication for the FLT - if we wanted just to prove FLT, we could specialise every result to Q and all of our issues vanish. But we are trying to prove every result at a reasonable level of generality</p>



<a name="266026628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026628">(Dec 24 2021 at 22:08)</a>:</h4>
<p>If we're going for <code>is_cyclotomic_extension</code>, meaning <code>\exists S : set nat, is_S_cyclotomic</code> as a predicate on K-fields or whatever then yeah this looks to me like a category</p>



<a name="266026745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266026745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266026745">(Dec 24 2021 at 22:11)</a>:</h4>
<p>You don't even need to restrict the category of algebras. Given a set <code>S</code>, associate the distinguished cyclotomic extension associated to S, constructed in some way. Given an algebra B, construct the set of all n such that the nth cyclotomic poly splits on B. These should be adjoint functors, I think.</p>



<a name="266027684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266027684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266027684">(Dec 24 2021 at 22:35)</a>:</h4>
<p>Is it so clear that there is such a “distinguished” cyclotomic extension associated to a set <code>S</code> ? I am not sure. Even if <code>S = {n}</code>, the only canonical stuff would be $R[T]/(T^n-1)$, but you could also consider $R[T]/(\Phi_n)$,  or $R[T]/(P)$, for some factor of $T^n-1$, even not necessarily irreducible. If you fix a universal algebra in which everything is supposed to live (an algebraic closure), then OK.</p>



<a name="266028157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028157">(Dec 24 2021 at 22:47)</a>:</h4>
<p>You're right, "distinguished" was not the right word. One just has to come up with some construction (e.g. work inside a chosen algebraically closed extension)</p>



<a name="266028202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028202">(Dec 24 2021 at 22:48)</a>:</h4>
<p>This is all exactly the same as localisation. There's no distinguished <code>localization R S</code> but there is <code>is_localization R S A</code> if <code>A</code> is an <code>R</code>-algebra.</p>



<a name="266028230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028230">(Dec 24 2021 at 22:48)</a>:</h4>
<p>similarly for <code>algebraic_closure</code> and <code>is_algebraic_closure</code></p>



<a name="266028249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028249">(Dec 24 2021 at 22:49)</a>:</h4>
<p>(the latter apparently doesn't exist)</p>



<a name="266028285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028285">(Dec 24 2021 at 22:49)</a>:</h4>
<p>I think it does? <a href="https://leanprover-community.github.io/mathlib_docs/find/is_algebraic_closure">docs#is_algebraic_closure</a></p>



<a name="266028343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028343">(Dec 24 2021 at 22:50)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/is_alg_closure">docs#is_alg_closure</a></p>



<a name="266028356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028356">(Dec 24 2021 at 22:50)</a>:</h4>
<p>If you fixed an algebraic closure and let all your fields be subfields of that, it would be analogous to the trick they use in the odd order Coq proof where all their groups are subgroups of a big group, i.e. all terms not types</p>



<a name="266028459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266028459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266028459">(Dec 24 2021 at 22:53)</a>:</h4>
<p>So there is a relative theory one can define (<code>cyclotomic S : subalgebra K L</code>) and an absolute theory defined with models (<code>cyclotomic' S K : Type</code>) and also an absolute theory defined by the universal property (<code>is_cyclotomic S K E</code> with <code>[algebra K E]</code>)</p>



<a name="266032145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266032145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266032145">(Dec 25 2021 at 00:09)</a>:</h4>
<p>Thanks for all the comments.<br>
To be honest I don't think it is worth to fundamentally change the current definition unless it's clear that things will really improve. Our current definition seems to work pretty well, for example we have a sorry free computation of the discriminant in of <em>a</em> <code>p</code>-th cyclotomic extension of the rationals. The only problem so far is that we have this annoying assumption <code>((n : ℕ) : _) ≠ 0</code> lying around. It is just an annoyance, the proofs work. I proposed to change the definition just to include this condition, but the new idea using a class seems very promising.</p>



<a name="266032296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266032296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266032296">(Dec 25 2021 at 00:13)</a>:</h4>
<p>Just a couple of comments: </p>
<ul>
<li><code>is_cyclotomic_extension</code> is definitely needed, <code>cyclotomic_extension</code> is not enough (we have both, and all the theorems use <code>is_cyclotomic_extension</code>).</li>
<li>I have the impression that forgetting the <code>n</code> (or <code>S</code>)  complicates things a little, if we want to say that the discriminant of what we currently call <code>is_cyclotomic_extension p Q L</code> is <code>p^...</code> we have to say something about, for example, the degree of a cyclotomic extension of <code>Q</code> and it seems unnatural.</li>
</ul>



<a name="266032682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266032682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266032682">(Dec 25 2021 at 00:23)</a>:</h4>
<p>At the end of the day what we want is that our definition (assuming it is the obvious one for <code>Q</code> and for finite fields in the separable case) is flexible enough to allow us to do some serious math, and the only way to find out is to test it.  The computation of the discriminant is currently very similar to the pen and paper proof (except for some combinatoric nightmares unrelated to cyclotomic extensions) and I take this as a very good sign.</p>



<a name="266032691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266032691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266032691">(Dec 25 2021 at 00:23)</a>:</h4>
<p>Having said this, merry Christmas to everybody !</p>



<a name="266043206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Cyclotomic%20fields/near/266043206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Cyclotomic.20fields.html#266043206">(Dec 25 2021 at 05:35)</a>:</h4>
<p>I think that one of the benefits of the <code>∃ s, ...</code> predicate is that the type becomes simpler. So Lean cannot get confused about different <code>n</code> or <code>s</code> working for the same field extension, because all this data is now hidden in a Prop.<br>
But like Riccardo says, this comes at a cost: you now have to work harder to get access to that data.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>