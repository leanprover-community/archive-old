---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html">Implementation of multiplicative characters</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="286396064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286396064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286396064">(Jun 16 2022 at 18:43)</a>:</h4>
<p>This is motivated by the discussion <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/286088587">here</a>:</p>
<p>We consider multiplicative characters from one commutative ring <code>R</code> into another commutative ring <code>R'</code>.</p>
<p><strong>Question:</strong> Should such an object just be a <code>monoid_with_zero_hom</code> (alternative (1)), or is it preferable to implement this as a <code>monoid_hom</code> with the additional property that it maps non-units to zero (alternative (2))?</p>



<a name="286396160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286396160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286396160">(Jun 16 2022 at 18:43)</a>:</h4>
<p>The main advantage of alternative (2) is that one can then define a <code>comm_group</code> structure on <code>mul_char R R'</code>.</p>



<a name="286396395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286396395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286396395">(Jun 16 2022 at 18:45)</a>:</h4>
<p>A possible disadvantage is that the restriction regarding non-units may be too strong in some contexts. For example, a Dirichlet character would not qualify as a multiplicative character. (But it could be obtained by composing <code>ℤ → zmod n</code> with a multiplicative character on <code>zmod n</code>.)</p>



<a name="286396545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286396545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286396545">(Jun 16 2022 at 18:46)</a>:</h4>
<p>I have implemented both versions. Alternative (1) is in <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a> amd alternative (2) is in <a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a>.</p>



<a name="286396618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286396618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286396618">(Jun 16 2022 at 18:47)</a>:</h4>
<p>I'd appreciate comments (at this stage, on the choice between the alternatives; fine-tuning can be done later).</p>



<a name="286409425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286409425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286409425">(Jun 16 2022 at 20:31)</a>:</h4>
<p>Side-by-side comparison: <a href="https://github.com/leanprover-community/mathlib/compare/legendre_symbol_mul_char...variant">https://github.com/leanprover-community/mathlib/compare/legendre_symbol_mul_char...variant</a></p>



<a name="286468695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286468695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286468695">(Jun 17 2022 at 09:55)</a>:</h4>
<p>I'm inclined to support <code>mul_char</code> because it allows us to define a <code>comm_group</code> structure. (The objection is that <code>monoid_with_zero_hom</code>s don't have inverses, right?)</p>



<a name="286474278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286474278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286474278">(Jun 17 2022 at 11:01)</a>:</h4>
<p>Yes; there is a difference when the domain is not a field (i.e., when there are non-zero non-units). The unit <code>monoid_with_zero_hom</code>, it is is defined (I don't know if <code>M \to*0 M'</code> is a <code>monoid</code> instance), would map everything except zero to one, so when a <code>monoid_with_zero_hom</code> maps a nonzero non-unit to zero (or a non-unit), it does not have an inverse.</p>



<a name="286501348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286501348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286501348">(Jun 17 2022 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> Do you have input on this?</p>



<a name="286502089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286502089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286502089">(Jun 17 2022 at 15:06)</a>:</h4>
<p><code>monoid_with_zero_hom</code> is a monoid, right? The unit sends <code>0</code> to <code>0</code> and everything else to <code>1</code> if I am not confused.</p>



<a name="286504204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286504204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286504204">(Jun 17 2022 at 15:22)</a>:</h4>
<p>Hmm...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">M</span> <span class="n">M'</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">M'</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*₀</span> <span class="n">M'</span><span class="o">)</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*₀</span> <span class="n">M'</span> <span class="o">:=</span> <span class="n">f</span> <span class="bp">^</span> <span class="mi">0</span>
</code></pre></div>
<p>gives</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">,</span>
<span class="n">M'</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">monoid_with_zero</span> <span class="n">M</span><span class="o">,</span>
<span class="n">_inst_2</span> <span class="o">:</span> <span class="n">monoid_with_zero</span> <span class="n">M'</span><span class="o">,</span>
<span class="n">f</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*₀</span> <span class="n">M'</span>
<span class="bp">⊢</span> <span class="n">has_pow</span> <span class="o">(</span><span class="n">M</span> <span class="bp">→*₀</span> <span class="n">M'</span><span class="o">)</span> <span class="n">ℕ</span>
</code></pre></div>
<p>but a monoid should have <code>has_pow</code>, right?</p>



<a name="286504251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286504251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286504251">(Jun 17 2022 at 15:22)</a>:</h4>
<p>(Same with <code>f * f</code> and <code>has_mul</code>or <code>1</code> and <code>has_one</code>.)</p>



<a name="286504318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286504318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286504318">(Jun 17 2022 at 15:23)</a>:</h4>
<p>So it looks like the <code>monoid</code> instance on <code>monoid_with_zero_hom M M'</code> is missing.</p>



<a name="286505815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286505815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286505815">(Jun 17 2022 at 15:33)</a>:</h4>
<p>It's missing, but it's true?</p>



<a name="286505829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286505829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286505829">(Jun 17 2022 at 15:33)</a>:</h4>
<p>It seems so</p>



<a name="286509524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286509524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286509524">(Jun 17 2022 at 16:01)</a>:</h4>
<p>Do you not need the monoids to be commutative?</p>



<a name="286513745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286513745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286513745">(Jun 17 2022 at 16:36)</a>:</h4>
<p>Yes yes, in applications the monoids will be commutative</p>



<a name="286518536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286518536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286518536">(Jun 17 2022 at 17:18)</a>:</h4>
<p>Wait isn't the issue that you need source and target to be equal?</p>



<a name="286519720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286519720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286519720">(Jun 17 2022 at 17:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters/near/286518536">said</a>:</p>
<blockquote>
<p>Wait isn't the issue that you need source and target to be equal?</p>
</blockquote>
<p>No, you just multiply the values: <code>mul f g = λ x, f x * g x</code>.</p>



<a name="286520140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286520140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286520140">(Jun 17 2022 at 17:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters/near/286509524">said</a>:</p>
<blockquote>
<p>Do you not need the monoids to be commutative?</p>
</blockquote>
<p>You need the target to be commutative for the product to be a homomorphism again:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>f</mi><mo>⋅</mo><mi>g</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>⋅</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>⋅</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>⋅</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">!</mo></mover></mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo>⋅</mo><mi>g</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>f</mi><mo>⋅</mo><mi>g</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> (f \cdot g)(x \cdot y) = f(x \cdot y) \cdot g(x \cdot y) = f(x) \cdot f(y) \cdot g(x) \cdot g(y) \stackrel{!}{=} f(x) \cdot g(x) \cdot f(y) \cdot g(y) = (f \cdot g)(x) \cdot (f \cdot g)(y) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.403em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">!</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></p>
<p>But even with <code>[comm_monoid_with_zero M']</code>, the <code>has_one</code> instance is not found.</p>



<a name="286520284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286520284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286520284">(Jun 17 2022 at 17:33)</a>:</h4>
<p>But it does find <code>has_mul</code>...</p>



<a name="286521628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286521628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286521628">(Jun 17 2022 at 17:45)</a>:</h4>
<p>Isn't the trivial monoid a monoid with zero where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>? If so, then this doesn't hold for silly reasons because the set of monoid-with-zero-homs from this trivial monoid_with_zero to the monoid_with_zero <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> is empty</p>



<a name="286521705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286521705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286521705">(Jun 17 2022 at 17:46)</a>:</h4>
<p>OTOH if you have a group_with_zero as the source, then it should be okay because I think those have an assumption that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo mathvariant="normal">≠</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \neq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.</p>



<a name="286521762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286521762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286521762">(Jun 17 2022 at 17:46)</a>:</h4>
<p>Or maybe assuming <code>[nontrivial]</code> is enough</p>



<a name="286523086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286523086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286523086">(Jun 17 2022 at 17:57)</a>:</h4>
<p>In any case, this seems to point in the direction that defining <code>mul_char</code> such that mult. characters form a group is the right way to go.</p>



<a name="286549143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286549143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286549143">(Jun 17 2022 at 22:15)</a>:</h4>
<p>does <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_with_zero_hom.monoid">docs#monoid_with_zero_hom.monoid</a> not exist?</p>



<a name="286549300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286549300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286549300">(Jun 17 2022 at 22:17)</a>:</h4>
<p>It would be <code>monoid_with_zero_hom.comm_monoid</code> at any rate.</p>



<a name="286552322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286552322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286552322">(Jun 17 2022 at 22:59)</a>:</h4>
<p>I'm wondering if we have the monoid of endomorphisms</p>



<a name="286552457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286552457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286552457">(Jun 17 2022 at 23:00)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/monoid.End">docs#monoid.End</a></p>



<a name="286552481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286552481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286552481">(Jun 17 2022 at 23:01)</a>:</h4>
<p>oh maybe you mean of something else</p>



<a name="286552554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286552554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286552554">(Jun 17 2022 at 23:01)</a>:</h4>
<p>no <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_with_zero.End">docs#monoid_with_zero.End</a> ...</p>



<a name="286552645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/286552645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#286552645">(Jun 17 2022 at 23:02)</a>:</h4>
<p>here you go <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.End">docs#category_theory.End</a></p>



<a name="287272292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287272292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287272292">(Jun 23 2022 at 23:42)</a>:</h4>
<p>It looks like the consensus is to go with <code>mul_char</code> as <code>monoid_hom</code> sending nonunits to zero.<br>
I have therefore closed <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a>. There is a new version of <a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a>, where the assumptions are weakened: the domain is a <code>comm_monoid</code> and the target is a <code>comm_monoid_with_zero</code> (we need zero in the target, since we map nonunits to zero). In this setting, it is still true that <code>mul_char R R'</code> has a structure as a <code>comm_group</code>.<br>
<span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="238446">@Anne Baanen</span> <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I have removed the "WIP" label and would like to start the review process on <a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a>.</p>



<a name="287613519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287613519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287613519">(Jun 27 2022 at 17:50)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="238446">@Anne Baanen</span> <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> I see two <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> on the previous message, but no comments so far on <a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a>. I'm not sure how to interpret this.</p>
<p>One thing I'd like to know is whether the way I have set up <code>mul_char</code>. <code>mul_char_class</code> and the commutative group structure is OK for mathlib. (I haven't done something similar before. For <code>mul_char_class</code>, I basically copied existing code and modified it.)</p>



<a name="287614843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287614843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287614843">(Jun 27 2022 at 18:00)</a>:</h4>
<p>Do you know about <code>fun_like</code>? I don't really understand it properly; <a href="https://github.com/leanprover-community/mathlib/blob/master/src/data/fun_like/basic.lean#L11-L116">here</a> is the documentation.</p>



<a name="287614970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287614970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287614970">(Jun 27 2022 at 18:01)</a>:</h4>
<p>I ask because you've defined <code>ext</code> and <code>ext'</code> and neither of them look like the thing in the documentation, but as I say I don't understand this properly yet.</p>



<a name="287618187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287618187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287618187">(Jun 27 2022 at 18:27)</a>:</h4>
<p>I think what I do is more similar to <a href="https://github.com/leanprover-community/mathlib/blob/master/src/data/fun_like/basic.lean#L52-L116">this later part of the file</a>, building on <code>monoid_hom</code>.<br>
The rationale behind <code>ext'</code> and <code>ext</code> is that you want to only check equality on units (since nonunits are mapped to zero anyway) -- this is what <code>ext</code> does, but its proof needs a version of <code>ext'</code>. In particular, I want <code>ext</code> to be the <code>[@ext]</code> lemma, so that I can write <code>ext a ha</code> in my proofs to get the goal <code>something a = something_other a</code> under the assumption <code>ha : is_unit a</code>.</p>



<a name="287624075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287624075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287624075">(Jun 27 2022 at 19:11)</a>:</h4>
<p>I reviewed -- mostly superficial comments. Thanks a lot!</p>



<a name="287625209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287625209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287625209">(Jun 27 2022 at 19:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters/near/287624075">said</a>:</p>
<blockquote>
<p>I reviewed -- mostly superficial comments. Thanks a lot!</p>
</blockquote>
<p>Thanks!</p>



<a name="287629806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287629806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287629806">(Jun 27 2022 at 20:02)</a>:</h4>
<p>How do I get the current mathlib version into my branch? I tried <code>leanproject up</code>, but this does not seem to havethe desired effect. (Concretely, I would like to have <a href="https://github.com/leanprover-community/mathlib/pull/14873">#14873</a> available, so that I can remove some decidability stuff.)</p>



<a name="287630155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287630155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287630155">(Jun 27 2022 at 20:05)</a>:</h4>
<p>leanproject up won't do that if you are not on the master branch. You should rebase your PR branch on top of master and then get the cache.</p>



<a name="287630498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287630498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287630498">(Jun 27 2022 at 20:07)</a>:</h4>
<p>I could try to look this up, but it will be faster if you just tell me the relevant <code>git</code> commands <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="287630816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287630816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287630816">(Jun 27 2022 at 20:10)</a>:</h4>
<p>If you don't know git then you should probably make a copy of your mathlib folder just in case. Then <code>git rebase master</code> and then <code>leanproject get-cache --fallback download-first</code>. Of course you won't get cache for your branch, only the latest master cache</p>



<a name="287631317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631317">(Jun 27 2022 at 20:15)</a>:</h4>
<p><code>Error: No such option: --fallback</code><br>
Without the <code>--fallback ...</code>, it says</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Trying</span> <span class="n">to</span> <span class="n">download</span> <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">oleanstorage.azureedge.net</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.xz</span> <span class="n">to</span> <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">mstoll</span><span class="bp">/.</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.xz</span>
<span class="n">Trying</span> <span class="n">to</span> <span class="n">download</span> <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">oleanstorage.azureedge.net</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.gz</span> <span class="n">to</span> <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">mstoll</span><span class="bp">/.</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.gz</span>
<span class="n">Trying</span> <span class="n">to</span> <span class="n">download</span> <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">oleanstorage.azureedge.net</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.bz2</span> <span class="n">to</span> <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">mstoll</span><span class="bp">/.</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">cad5c63bb1a52569d2fe913534c18f983819201b.tar.bz2</span>
<span class="n">Looking</span> <span class="n">for</span> <span class="n">GitHub</span> <span class="n">mathlib</span> <span class="n">oleans</span>
<span class="n">Info</span><span class="o">:</span> <span class="n">No</span> <span class="n">github</span> <span class="kn">section</span> <span class="n">found</span> <span class="k">in</span> <span class="bp">'</span><span class="n">git</span> <span class="n">config'</span><span class="o">,</span> <span class="n">we</span> <span class="n">will</span> <span class="n">use</span> <span class="n">GitHub</span> <span class="k">with</span> <span class="n">no</span> <span class="n">authentication</span>
<span class="n">Failed</span> <span class="n">to</span> <span class="n">fetch</span> <span class="n">mathlib</span> <span class="n">oleans</span>
</code></pre></div>



<a name="287631579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631579">(Jun 27 2022 at 20:17)</a>:</h4>
<p>Can you tell me the result of <code>leanproject --version</code>?</p>



<a name="287631698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631698">(Jun 27 2022 at 20:18)</a>:</h4>
<p><code>leanproject, version 0.0.8</code></p>



<a name="287631709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631709">(Jun 27 2022 at 20:19)</a>:</h4>
<p>That's ancient!</p>



<a name="287631752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631752">(Jun 27 2022 at 20:19)</a>:</h4>
<p>You should update mathlibtools</p>



<a name="287631776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287631776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287631776">(Jun 27 2022 at 20:19)</a>:</h4>
<p>Something like <code>pip install -U mathlibtools</code></p>



<a name="287632164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287632164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287632164">(Jun 27 2022 at 20:23)</a>:</h4>
<p><code>leanproject, version 1.1.1</code></p>



<a name="287632241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287632241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287632241">(Jun 27 2022 at 20:24)</a>:</h4>
<p>I seem to have installed the old version when I played around with the Natural Numbers Game a couple years back...</p>



<a name="287632738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287632738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287632738">(Jun 27 2022 at 20:29)</a>:</h4>
<p>OK, now I don't get an error message any more, but the PR I was looking for is still not there.</p>



<a name="287633313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287633313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287633313">(Jun 27 2022 at 20:34)</a>:</h4>
<p>I don't understand what "the PR I was looking for is still not there" means</p>



<a name="287633503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287633503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287633503">(Jun 27 2022 at 20:36)</a>:</h4>
<p>What I mean is, the addition to <code>algebra.group.units</code> that was merged with <a href="https://github.com/leanprover-community/mathlib/pull/14873">#14873</a>  this morning is not visible in the mathlib version I have after <code>leanproject get-cache --fallback download-first</code>-</p>



<a name="287635272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287635272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bart Michels <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287635272">(Jun 27 2022 at 20:52)</a>:</h4>
<p>I think <code>leanproject get-cache</code> only gets the oleans (not .lean files) up to the commit where your (local) leanproject is. So you need to <code>rebase</code> first, and <code>get-cache</code> after that.</p>



<a name="287635560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287635560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287635560">(Jun 27 2022 at 20:55)</a>:</h4>
<p>Indeed, did you follow my instruction to git rebase? Maybe I should have been more explicit and tell you to first update your master branch. Something like <code>git checkout master &amp;&amp; git pull &amp;&amp; git checkout your_branch_name &amp;&amp; git rebase master</code></p>



<a name="287635611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287635611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287635611">(Jun 27 2022 at 20:55)</a>:</h4>
<p>(you can probably do that in one command, but I never remember those more complicated commands)</p>



<a name="287636262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287636262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287636262">(Jun 27 2022 at 21:01)</a>:</h4>
<p>OK, after all this (including <code>leanproject get-cache ...</code>), it seems to be there. Thanks for your help!</p>



<a name="287637251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287637251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287637251">(Jun 27 2022 at 21:09)</a>:</h4>
<p>I am very busy this week, sorry for the delay!</p>



<a name="287637276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287637276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287637276">(Jun 27 2022 at 21:09)</a>:</h4>
<p>I will have a look this weekend</p>



<a name="287637591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287637591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287637591">(Jun 27 2022 at 21:12)</a>:</h4>
<p>Now I get an error message when I try to push my latest commits... (something along the lines of "the head of my branch is behind its external counterpart" [I get the message in German, so this is only a rough approximation to the English version]).</p>



<a name="287637744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287637744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287637744">(Jun 27 2022 at 21:13)</a>:</h4>
<p>Try pulling again?</p>



<a name="287637841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287637841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287637841">(Jun 27 2022 at 21:14)</a>:</h4>
<p>This gives me (roughly): "fatal: fast forward impossible, abort."</p>



<a name="287638010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638010">(Jun 27 2022 at 21:15)</a>:</h4>
<p>Of course git complains that things diverged but this isn't a big issue. Is this a PR that is already opened?</p>



<a name="287638072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638072">(Jun 27 2022 at 21:16)</a>:</h4>
<p>Yes. (<a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a>)</p>



<a name="287638431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638431">(Jun 27 2022 at 21:19)</a>:</h4>
<p>Ok, I think you can force push. This will mess up with Kevin's review but he won't mind.</p>



<a name="287638458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638458">(Jun 27 2022 at 21:19)</a>:</h4>
<p>so <code>git push -f</code></p>



<a name="287638466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638466">(Jun 27 2022 at 21:19)</a>:</h4>
<p>from your PR branch</p>



<a name="287638503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638503">(Jun 27 2022 at 21:19)</a>:</h4>
<p>OK; this gives at least no error messages...</p>



<a name="287638577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638577">(Jun 27 2022 at 21:20)</a>:</h4>
<p>That's the magic of <code>--force</code> in general...</p>



<a name="287638630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638630">(Jun 27 2022 at 21:20)</a>:</h4>
<p>Can you check that <a href="https://github.com/leanprover-community/mathlib/pull/14768/files">https://github.com/leanprover-community/mathlib/pull/14768/files</a> looks like what you would hope for?</p>



<a name="287638735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638735">(Jun 27 2022 at 21:22)</a>:</h4>
<p>It looks like it. (It is a new file, so all of its is green, but it does have the latest change.)</p>



<a name="287638777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638777">(Jun 27 2022 at 21:22)</a>:</h4>
<p>By the way, since the whole PR is simply adding one file, you should have no trouble using the olean cache from master</p>



<a name="287638845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638845">(Jun 27 2022 at 21:22)</a>:</h4>
<p>Is this what <code>leanproject get-cache</code> does?</p>



<a name="287638891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287638891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287638891">(Jun 27 2022 at 21:23)</a>:</h4>
<p>Should I issue some more <code>git</code>commands to avoid problems like the one I just had with future commit/push actions?</p>



<a name="287639113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287639113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287639113">(Jun 27 2022 at 21:25)</a>:</h4>
<p>Yes, get-cache got you the latest olean leanproject could find, and that would be the ones from master in your situation.</p>



<a name="287639204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287639204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287639204">(Jun 27 2022 at 21:26)</a>:</h4>
<p>You won't have further git issues since GitHub and your local repository now agree (unless you rebase again, but I don't see why you would do that).</p>



<a name="287639240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287639240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287639240">(Jun 27 2022 at 21:26)</a>:</h4>
<p>OK. Thanks again!<br>
Now I should get some sleep...</p>



<a name="287641645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287641645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287641645">(Jun 27 2022 at 21:49)</a>:</h4>
<blockquote>
<p>first update your master branch. Something like git checkout master &amp;&amp; git pull &amp;&amp; git checkout your_branch_name &amp;&amp; git rebase master</p>
</blockquote>
<p>I usually do something like <code>git fetch &amp;&amp; git merge origin/master</code>; this way you don't need to switch out of your branch and back again. If I understand it correctly, <code>git fetch</code> will update the information of all remote branches to their respectively latest commit, then <code>git merge origin/master</code> will merge all new commits in the remote branch <code>origin/master</code>into the currently checked out local branch. I prefer <code>merge</code> over <code>rebase</code> because<code>merge</code> preserves the history of the current branch, so you don't need to force-push after a merge.</p>



<a name="287642093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287642093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bart Michels <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287642093">(Jun 27 2022 at 21:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="224323">Junyan Xu</span> <a href="#narrow/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters/near/287641645">said</a>:</p>
<blockquote>
<blockquote>
<p>first update your master branch. Something like git checkout master &amp;&amp; git pull &amp;&amp; git checkout your_branch_name &amp;&amp; git rebase master</p>
</blockquote>
<p>I usually do something like <code>git fetch &amp;&amp; git merge origin/master</code>; this way you don't need to switch out of your branch and back again. If I understand it correctly, <code>git fetch</code> will update the information of all remote branches to their respectively latest commit, then <code>git merge origin/master</code> will merge all new commits in the remote branch <code>origin/master</code>into the currently checked out local branch. I prefer <code>merge</code> over <code>rebase</code> because<code>merge</code> preserves the history of the current branch, so you don't need to force-push after a merge.</p>
</blockquote>
<p>If you do that, don't the commit stats of your branch get messed up? Something like 1000 commits behind, 1001 commits ahead?</p>



<a name="287642104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287642104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bart Michels <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287642104">(Jun 27 2022 at 21:53)</a>:</h4>
<p>Also (sorry for the basic questions), do those merge commits show up in pull requests or does GitHub ignore them?</p>



<a name="287642372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287642372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287642372">(Jun 27 2022 at 21:56)</a>:</h4>
<blockquote>
<p>If you do that, don't the commit stats of your branch get messed up? Something like 1000 commits behind, 1001 commits ahead?</p>
</blockquote>
<p>I never see that happen. After you merge and push, it should say 0 commits behind, assuming no commits are added to master in the meantime.</p>



<a name="287642670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287642670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287642670">(Jun 27 2022 at 21:59)</a>:</h4>
<p>Merge commits do show up in the PR page, e.g. you can see two of them in <a href="https://github.com/leanprover-community/mathlib/pull/14967">#14967</a>, and currently <a href="https://github.com/leanprover-community/mathlib/tree/graded_algebra_timeout'">branch#graded_algebra_timeout'</a> is 8 commits ahead / 8 behind master.</p>



<a name="287643226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287643226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bart Michels <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287643226">(Jun 27 2022 at 22:04)</a>:</h4>
<p>Thanks. I read that <code>fetch</code>+<code>merge</code> creates new commits rather than rewrite history, so wasn't sure how git deals with the fact that they're not technically the same commits.</p>



<a name="287645804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/287645804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#287645804">(Jun 27 2022 at 22:28)</a>:</h4>
<p><code>merge</code> creates a new commit (<a href="https://github.com/leanprover-community/mathlib/commit/477d8ce9e2766d520fab12a79f6e944e98e0dbf0">for example this</a>) that has two parent commits, namely the latest commit in you local branch and the latest in the remote master branch. <code>rebase</code> produces a linear history by stacking you local commits on top of the latest commit of the remote master; if you create a branch from master at its 10th commit and add 8 commits to it, then rebase to master when it's at the 20th commit, then your 8 commits will now be connected to the 20th commit and no longer the 10th commit, so the history is changed and your 8 commits will get different hashes. The linear history produced by <code>rebase</code> may be prettier than the directed acyclic graph produced by <code>merge</code> and preferred in some repositories, but it doesn't matter for mathlib since all PRs will be squashed merged into master.</p>



<a name="289635166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289635166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289635166">(Jul 14 2022 at 19:05)</a>:</h4>
<p>Now that multiplicative characters are there, I think it makes sense to review quadratic characters and redefine them as <code>mul_char</code>s. Roughly, define <code>quadratic_char'</code> like <code>quadratic_char</code> is now defined (as a map from a <code>monoid_with_zero</code> to the integers), prove the relevant properties (most importantly multiplicativity when the domain is a finite field), and then define <code>quadratic_char</code> to be of type <code>mul_char F ℤ</code>. Then the API for multiplicative characters can be used to prove further properties; this should simplify the code in <code>number_theory/legendre_symbol/quadratic_char.lean</code>.</p>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span>  <span class="user-mention" data-user-id="238446">@Anne Baanen</span>  <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>  <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>  <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <br>
Does this sound reasonable to you?</p>



<a name="289642290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289642290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289642290">(Jul 14 2022 at 20:03)</a>:</h4>
<p>In the same way, <code>zmod.χ₄</code> and friends should be defined as <code>mul_char (zmod 4) ℤ</code> etc.</p>



<a name="289643313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289643313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289643313">(Jul 14 2022 at 20:12)</a>:</h4>
<p>In the end, there is not that much simplification in <code>quadratic_char.lean</code>, but at least the proof of <code>quadratic_char_sum_zero</code> is now a one-liner.</p>



<a name="289823341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289823341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289823341">(Jul 16 2022 at 11:23)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/15418">#15418</a></p>



<a name="289837901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289837901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289837901">(Jul 16 2022 at 17:19)</a>:</h4>
<p>Next week I hope to do a lot of PR reviewing. For now, I will just "request review" myself.</p>



<a name="289841560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289841560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289841560">(Jul 16 2022 at 18:40)</a>:</h4>
<p>OK, thanks! I'll look at additive characters next...</p>



<a name="289847165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289847165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289847165">(Jul 16 2022 at 20:52)</a>:</h4>
<p>Of course, <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="238446">@Anne Baanen</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> you are also welcome to have a look at <a href="https://github.com/leanprover-community/mathlib/pull/15418">#15418</a>!</p>



<a name="289847740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289847740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289847740">(Jul 16 2022 at 21:07)</a>:</h4>
<p>I've left a review.</p>



<a name="289953954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289953954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289953954">(Jul 18 2022 at 11:45)</a>:</h4>
<p>Hmm. bors if failing with an error message</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Error</span><span class="o">:</span> <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">actions</span><span class="bp">-</span><span class="n">runner</span><span class="bp">/</span><span class="n">_work</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">algebra</span><span class="bp">/</span><span class="n">module</span><span class="bp">/</span><span class="n">localized_module.lean</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span>
<span class="n">unknown</span> <span class="n">identifier</span> <span class="bp">'</span><span class="n">has_scalar'</span>
</code></pre></div>
<p>that refers to a completely unrelated file.</p>



<a name="289954065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954065">(Jul 18 2022 at 11:46)</a>:</h4>
<p><code>has_scalar</code> was renamed to <code>has_smul</code> recently. Try merging master.</p>



<a name="289954146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954146">(Jul 18 2022 at 11:47)</a>:</h4>
<p>Did that happen between CI being satisfied earlier today and bors trying to merge?</p>



<a name="289954163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954163">(Jul 18 2022 at 11:47)</a>:</h4>
<p>Satisfied where?</p>



<a name="289954236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954236">(Jul 18 2022 at 11:48)</a>:</h4>
<p>I mean, the PR was green before I told bors to merge it...</p>



<a name="289954296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954296">(Jul 18 2022 at 11:49)</a>:</h4>
<p>It's not your fault, just ignore the message</p>



<a name="289954324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954324">(Jul 18 2022 at 11:49)</a>:</h4>
<p>You know how bors works, right? It puts PRs in batches and when a batch fails it splits it up. The batch your PR was in failed, but that doesn't mean it comes from your PR (<a href="https://github.com/leanprover-community/mathlib/pull/15418#issuecomment-1187093137">here</a> bors says it is "retrying...").</p>



<a name="289954332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954332">(Jul 18 2022 at 11:49)</a>:</h4>
<p>Your PR was included in a batch that failed, because of another PR (<a href="https://github.com/leanprover-community/mathlib/pull/14470">#14470</a> I think)</p>



<a name="289954584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/289954584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#289954584">(Jul 18 2022 at 11:52)</a>:</h4>
<p>That sounds plausible, that PR is on module localization...<br>
OK; I'll wait and see (have to teach soon anyway...)</p>



<a name="290005807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/290005807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#290005807">(Jul 18 2022 at 18:34)</a>:</h4>
<p>I'm now doing additive characters. I'll open a separate topic for that.</p>



<a name="290006088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Implementation%20of%20multiplicative%20characters/near/290006088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters.html#290006088">(Jul 18 2022 at 18:36)</a>:</h4>
<p>See <a href="#narrow/stream/116395-maths/topic/Additive.20characters/near/290005886">here</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>