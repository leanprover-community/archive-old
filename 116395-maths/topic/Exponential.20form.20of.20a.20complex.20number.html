---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html">Exponential form of a complex number</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="214766399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214766399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214766399">(Oct 27 2020 at 21:27)</a>:</h4>
<p>Is there a canonical way to express a complex number in exponential form. This is what I've done, but it seems long-winded.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.exponential</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">noncomputable theory</span>

<span class="kn">open</span> <span class="n">complex</span>

<span class="c1">-- Aim to show `u = u₂`</span>
<span class="kd">def</span> <span class="n">θ</span> <span class="o">:=</span> <span class="bp">-</span><span class="n">real.pi</span><span class="bp">/</span><span class="mi">4</span>
<span class="kd">def</span> <span class="n">u</span> <span class="o">:=</span> <span class="mi">10</span><span class="bp">*</span><span class="o">(</span><span class="n">cos</span> <span class="n">θ</span> <span class="bp">+</span> <span class="o">(</span><span class="n">sin</span> <span class="n">θ</span><span class="o">)</span><span class="bp">*</span><span class="n">I</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u₂</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">5</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="mi">2</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">*</span><span class="n">I</span><span class="o">)</span>

<span class="c1">-- We need a few lemmas that aren't in mathlib</span>
<span class="kn">namespace</span> <span class="n">complex</span>

<span class="kd">lemma</span> <span class="n">cos_pi_div_four</span> <span class="o">:</span> <span class="n">complex.cos</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">2</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span><span class="o">(</span><span class="n">re_add_im</span> <span class="o">(</span><span class="n">complex.cos</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">))),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">complex.cos_of_real_re</span><span class="o">,</span> <span class="n">complex.cos_of_real_im</span><span class="o">,</span> <span class="n">real.cos_pi_div_four</span><span class="o">],</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sin_pi_div_four</span> <span class="o">:</span> <span class="n">complex.sin</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span>  <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">2</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span><span class="o">(</span><span class="n">re_add_im</span> <span class="o">(</span><span class="n">complex.sin</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">))),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">complex.sin_of_real_re</span><span class="o">,</span> <span class="n">complex.sin_of_real_im</span><span class="o">,</span> <span class="n">real.sin_pi_div_four</span><span class="o">],</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">complex</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">u₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">unfold</span> <span class="n">u</span> <span class="n">u₂</span> <span class="n">θ</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">complex.of_real_div</span><span class="o">,</span><span class="n">complex.of_real_neg</span><span class="o">,</span><span class="n">neg_div</span><span class="o">,</span><span class="n">cos_neg</span><span class="o">,</span><span class="n">sin_neg</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">complex.of_real_div</span><span class="o">,</span> <span class="n">complex.cos_pi_div_four</span><span class="o">,</span> <span class="n">complex.sin_pi_div_four</span><span class="o">],</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="214766885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214766885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214766885">(Oct 27 2020 at 21:31)</a>:</h4>
<p>well an obvious improvement would be to use <code>exp (I * theta)</code></p>



<a name="214767015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214767015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214767015">(Oct 27 2020 at 21:32)</a>:</h4>
<p>isn't that just one lemma away™?</p>



<a name="214767537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214767537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214767537">(Oct 27 2020 at 21:38)</a>:</h4>
<p>Once I've rewritten with <code>exp</code>,  how can I show <code>u = u₂</code>?</p>
<p>Edit: above, I need to use a result <code>complex.cos_pi_div_four</code>. Is there an equivalent result <code>exp_I_pi_div_four</code>? Or some other clever way to work with <code>exp</code>?</p>



<a name="214769373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214769373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214769373">(Oct 27 2020 at 21:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">exp_I_pi_div_four</span> <span class="o">:</span> <span class="n">exp</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">I</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">2</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">exp_mul_I</span><span class="o">,</span> <span class="bp">←</span> <span class="n">of_real_cos</span><span class="o">,</span> <span class="bp">←</span> <span class="n">of_real_sin</span><span class="o">,</span> <span class="n">real.cos_pi_div_four</span><span class="o">,</span> <span class="n">real.sin_pi_div_four</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="214769671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214769671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214769671">(Oct 27 2020 at 21:57)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- Aim to show `u = u₂`</span>
<span class="kd">def</span> <span class="n">θ</span> <span class="o">:=</span> <span class="bp">-</span><span class="n">real.pi</span><span class="bp">/</span><span class="mi">4</span>
<span class="kd">def</span> <span class="n">u</span> <span class="o">:=</span> <span class="mi">10</span> <span class="bp">*</span> <span class="n">exp</span> <span class="o">(</span><span class="n">θ</span> <span class="bp">*</span> <span class="n">I</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u₂</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">5</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="mi">2</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">*</span><span class="n">I</span><span class="o">)</span>

<span class="c1">-- We need a few lemmas that aren't in mathlib</span>
<span class="kn">namespace</span> <span class="n">complex</span>

<span class="kd">lemma</span> <span class="n">exp_I_pi_div_four</span> <span class="o">:</span> <span class="n">exp</span> <span class="o">((</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">I</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">2</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">exp_mul_I</span><span class="o">,</span> <span class="bp">←</span> <span class="n">of_real_cos</span><span class="o">,</span> <span class="bp">←</span> <span class="n">of_real_sin</span><span class="o">,</span> <span class="n">real.cos_pi_div_four</span><span class="o">,</span> <span class="n">real.sin_pi_div_four</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">],</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">complex</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">u₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">conj_inj</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">u</span> <span class="n">u₂</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">exp_conj</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">neg_mul_eq_neg_mul</span><span class="o">,</span> <span class="bp">←</span> <span class="n">of_real_neg</span><span class="o">,</span> <span class="n">θ</span><span class="o">,</span> <span class="n">neg_div</span><span class="o">,</span> <span class="n">neg_neg</span><span class="o">,</span> <span class="n">complex.exp_I_pi_div_four</span><span class="o">],</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="214769819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214769819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214769819">(Oct 27 2020 at 21:59)</a>:</h4>
<p>Thanks very much! Much nicer.</p>



<a name="214770391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770391">(Oct 27 2020 at 22:04)</a>:</h4>
<p>Here's an issue I encountered while experimenting with this.  I'd have thought <code>simp</code> would deal with the following (because of the simp-lemma <a href="https://leanprover-community.github.io/mathlib_docs/find/complex.of_real_im">docs#complex.of_real_im</a>), but it doesn't:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(((</span><span class="n">real.sqrt</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span><span class="bp">.</span><span class="n">im</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">exact</span> <span class="n">complex.of_real_im</span> <span class="n">_</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="214770416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770416">(Oct 27 2020 at 22:04)</a>:</h4>
<p>Error: </p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>invalid type ascription, term has type
  ↑?m_1.im = 0
but is expected to have type
  (↑(real.sqrt 2) / 2).im = 0
</code></pre></div>



<a name="214770469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770469">(Oct 27 2020 at 22:05)</a>:</h4>
<p><code>exact_mod_cast</code> maybe?</p>



<a name="214770475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770475">(Oct 27 2020 at 22:05)</a>:</h4>
<p>yeah, we have some non-confluent simp lemmas here</p>



<a name="214770550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770550">(Oct 27 2020 at 22:06)</a>:</h4>
<p>oh, you aren't using simp</p>



<a name="214770597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770597">(Oct 27 2020 at 22:06)</a>:</h4>
<p>(simp fails too, but I was trying to reverse-engineer what I wanted simp to do)</p>



<a name="214770620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770620">(Oct 27 2020 at 22:07)</a>:</h4>
<p>this is just because lean elaborates from outside in, the arrows go on the innermost term</p>



<a name="214770661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770661">(Oct 27 2020 at 22:07)</a>:</h4>
<p>you have to write <code>(\u ((real.sqrt 2) / 2) : ℂ).im = 0</code> if you want the arrow in the right place</p>



<a name="214770797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770797">(Oct 27 2020 at 22:08)</a>:</h4>
<p>Funnily, my suggestion works but only after replacing the underscore by <code>(real.sqrt 2/2)</code>.</p>



<a name="214770820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770820">(Oct 27 2020 at 22:09)</a>:</h4>
<p>The problem was that I didn't write <code>((real.sqrt 2) / 2)</code> myself; it turned up in the proof, created by previous lemmas.  I'll try to find which one; maybe that one needs to be stated with a different cast setup.</p>



<a name="214770855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770855">(Oct 27 2020 at 22:09)</a>:</h4>
<p>The funny part is that <code>exact_mod_cast</code> succeeds but creates a new goal asking for the real number to be used.</p>



<a name="214770953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770953">(Oct 27 2020 at 22:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214770855">said</a>:</p>
<blockquote>
<p>The funny part is that <code>exact_mod_cast</code> succeeds but creates a new goal asking for the real number to be used.</p>
</blockquote>
<p>This looks like a bug in <code>exact_mod_cast</code>, feel free to open an issue.</p>



<a name="214770985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214770985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214770985">(Oct 27 2020 at 22:10)</a>:</h4>
<p>This is exactly the use case for that tactic so it should work.</p>



<a name="214771034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771034">(Oct 27 2020 at 22:11)</a>:</h4>
<p>As should <code>apply_mod_cast</code></p>



<a name="214771164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771164">(Oct 27 2020 at 22:12)</a>:</h4>
<p>Side note: Heather, you don't need parentheses around <code>real.sqrt 2</code>. Function application has really high precedence.</p>



<a name="214771419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771419">(Oct 27 2020 at 22:15)</a>:</h4>
<p>In fact, <code>norm_cast</code> proves this on its own. The bad behavior is probably a result of the <code>(\u r).im = 0</code> lemmas that don't fit the algorithm particularly well.</p>



<a name="214771473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771473">(Oct 27 2020 at 22:15)</a>:</h4>
<p>Too late, I opened  <a href="https://github.com/leanprover-community/mathlib/issues/4805">#4805</a></p>



<a name="214771506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771506">(Oct 27 2020 at 22:16)</a>:</h4>
<p>OK, so here's a proof of <span class="user-mention" data-user-id="233737">@Gihan Marasingha</span> 's fact that is nearly without trig-specific knowledge:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.exponential</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">noncomputable theory</span>
<span class="kn">open</span> <span class="n">real</span>

<span class="c1">-- Aim to show `u = u₂`</span>
<span class="kd">def</span> <span class="n">θ</span> <span class="o">:=</span> <span class="bp">-</span> <span class="o">(</span><span class="n">real.pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">10</span><span class="o">:</span><span class="n">ℂ</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">cos</span> <span class="n">θ</span> <span class="bp">+</span> <span class="o">(</span><span class="n">sin</span> <span class="n">θ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">complex.I</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u₂</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">5</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">*</span><span class="n">complex.I</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">u₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">u</span><span class="o">,</span> <span class="n">u₂</span><span class="o">,</span> <span class="n">θ</span><span class="o">,</span> <span class="n">cos_pi_div_four</span><span class="o">,</span> <span class="n">sin_pi_div_four</span><span class="o">],</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span><span class="o">,</span>
    <span class="n">exact_mod_cast</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">ring</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span><span class="o">,</span>
    <span class="n">exact_mod_cast</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">ring</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>

<p>If we make  <code>cos_pi_div_four</code> and <code>sin_pi_div_four</code> simp-lemmas, it can be entirely so.  (It seems like it's just an omission that they're not simp-lemmas; <code>cos_pi_div_two</code> and <code>tan_pi_div_four</code> are.)</p>



<a name="214771570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771570">(Oct 27 2020 at 22:16)</a>:</h4>
<p>(note that this is not mathlib-style, though, because it has nonterminal simps)</p>



<a name="214771768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771768">(Oct 27 2020 at 22:18)</a>:</h4>
<p>What are those <code>exact_mod_cast _</code>? Do you mean <code>norm_cast</code>?</p>



<a name="214771794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771794">(Oct 27 2020 at 22:18)</a>:</h4>
<p>you could write that latter part <code>ext; { simp, exact_mod_cast _, ring },</code></p>



<a name="214771845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771845">(Oct 27 2020 at 22:19)</a>:</h4>
<p>Those non-terminal simps are ok because they are followed only by end-game tactics.</p>



<a name="214771866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771866">(Oct 27 2020 at 22:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214771794">said</a>:</p>
<blockquote>
<p>you could write that latter part <code>ext; { simp, exact_mod_cast _, ring },</code></p>
</blockquote>
<p>I know, but <span class="user-mention" data-user-id="233737">@Gihan Marasingha</span>'s students may not!</p>



<a name="214771896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771896">(Oct 27 2020 at 22:19)</a>:</h4>
<p>(my proof also has nonterminal simps btw, but the <code>simp only</code> line is a little distracting)</p>



<a name="214771920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771920">(Oct 27 2020 at 22:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214771845">said</a>:</p>
<blockquote>
<p>Those non-terminal simps are ok because they are followed only by end-game tactics.</p>
</blockquote>
<p>This I didn't know!</p>



<a name="214771963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214771963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214771963">(Oct 27 2020 at 22:20)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">u₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span><span class="bp">;</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">u</span><span class="o">,</span> <span class="n">u₂</span><span class="o">,</span> <span class="n">θ</span><span class="o">,</span> <span class="n">cos_pi_div_four</span><span class="o">,</span> <span class="n">sin_pi_div_four</span><span class="o">],</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">ring</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>

<p>is almost legit. Following <code>simp</code> with <code>norm_cast</code> is borderline.</p>



<a name="214772015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772015">(Oct 27 2020 at 22:20)</a>:</h4>
<p>Oh, I didn't see the first simp. Rob's version is better indeed.</p>



<a name="214772049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772049">(Oct 27 2020 at 22:21)</a>:</h4>
<p><code>norm_cast</code> sort of cares about the details of the goal. It's plausible that simp lemmas could change the positions of casts in a way that would break <code>norm_cast</code>, but reasonably unlikely.</p>



<a name="214772070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772070">(Oct 27 2020 at 22:21)</a>:</h4>
<p>Fair enough.</p>



<a name="214772113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772113">(Oct 27 2020 at 22:21)</a>:</h4>
<p>particularly in this case because of the non-confluence - it might eliminate them entirely and then <code>norm_cast</code> would fail</p>



<a name="214772194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772194">(Oct 27 2020 at 22:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214771506">said</a>:</p>
<blockquote>
<p>If we make  <code>cos_pi_div_four</code> and <code>sin_pi_div_four</code> simp-lemmas, it can be entirely so.  (It seems like it's just an omission that they're not simp-lemmas; <code>cos_pi_div_two</code> and <code>tan_pi_div_four</code> are.)</p>
</blockquote>
<p>Shall I add <code>cos_pi_div_four</code> etc to the simp-set?</p>



<a name="214772296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772296">(Oct 27 2020 at 22:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214772049">said</a>:</p>
<blockquote>
<p><code>norm_cast</code> sort of cares about the details of the goal. It's plausible that simp lemmas could change the positions of casts in a way that would break <code>norm_cast</code>, but reasonably unlikely.</p>
</blockquote>
<p>Is there a more idiomatic way to do this kind of thing, perhaps a simp variant that omits casting lemmas from the simp-set?</p>



<a name="214772652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214772652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214772652">(Oct 27 2020 at 22:27)</a>:</h4>
<p>Mm, not really. If the <code>simp only</code> is too big I wouldn't worry too much about this particular nonterminal <code>simp</code>.</p>



<a name="214773270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214773270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214773270">(Oct 27 2020 at 22:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number/near/214771506">said</a>:</p>
<blockquote>
<p>If we make  <code>cos_pi_div_four</code> and <code>sin_pi_div_four</code> simp-lemmas, it can be entirely so.  (It seems like it's just an omission that they're not simp-lemmas; <code>cos_pi_div_two</code> and <code>tan_pi_div_four</code> are.)</p>
</blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4806">#4806</a></p>



<a name="214909165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214909165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214909165">(Oct 28 2020 at 23:13)</a>:</h4>
<p><span class="user-mention" data-user-id="233737">@Gihan Marasingha</span> <a href="https://github.com/leanprover-community/mathlib/issues/4806">#4806</a> is now merged and your lemma can be entirely automated:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.special_functions.trigonometric</span>

<span class="kd">noncomputable theory</span>
<span class="kn">open</span> <span class="n">real</span>

<span class="c1">-- Aim to show `u = u₂`</span>
<span class="kd">def</span> <span class="n">θ</span> <span class="o">:=</span> <span class="bp">-</span> <span class="o">(</span><span class="n">pi</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">10</span><span class="o">:</span><span class="n">ℂ</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">cos</span> <span class="n">θ</span> <span class="bp">+</span> <span class="o">(</span><span class="n">sin</span> <span class="n">θ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">complex.I</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">u₂</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">5</span> <span class="bp">*</span> <span class="o">(</span><span class="n">sqrt</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">complex.I</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">u₂</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">ext</span><span class="bp">;</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">u</span><span class="o">,</span> <span class="n">u₂</span><span class="o">,</span> <span class="n">θ</span><span class="o">],</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">ring</span> <span class="o">}</span>
</code></pre></div>



<a name="214909433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Exponential%20form%20of%20a%20complex%20number/near/214909433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Exponential.20form.20of.20a.20complex.20number.html#214909433">(Oct 28 2020 at 23:17)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> amazing! Thanks so much.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>