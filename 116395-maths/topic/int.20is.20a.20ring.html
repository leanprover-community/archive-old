---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/int.20is.20a.20ring.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html">int is a ring</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202241845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/int%20is%20a%20ring/near/202241845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html#202241845">(Jun 28 2020 at 15:45)</a>:</h4>
<p>I'm so nearly there. Those sorries should be done by automation. Kenny told me an earlier simp fix which made simp not get stuck in a hole in the proof of <code>add_assoc</code>, but it's stuck in another one with the distrib lemmas. </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="c1">-- Kenny tells me there&#39;s a missing simp lemma. Without this I get an</span>
<span class="c1">-- error on line 132; omega can&#39;t do add_assoc</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">theorem</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on_beta₂</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">setoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">)</span>
  <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="err">⟦</span><span class="n">x</span><span class="err">⟧</span><span class="bp">.</span><span class="n">lift_on₂</span> <span class="err">⟦</span><span class="n">y</span><span class="err">⟧</span> <span class="n">f</span> <span class="n">h</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">namespace</span> <span class="n">int3</span>

<span class="kn">notation</span> <span class="bp">`ℕ</span><span class="err">²</span><span class="bp">`</span> <span class="o">:=</span> <span class="bp">ℕ</span> <span class="bp">×</span> <span class="bp">ℕ</span>

<span class="kn">namespace</span> <span class="n">natsquared</span>

<span class="kn">notation</span> <span class="bp">`</span><span class="n">first</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">prod</span><span class="bp">.</span><span class="n">fst</span>

<span class="kn">notation</span> <span class="bp">`</span><span class="n">second</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">prod</span><span class="bp">.</span><span class="n">snd</span>

<span class="bp">@</span><span class="o">[</span><span class="n">ext</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">ext</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">}</span> <span class="o">:</span> <span class="n">first</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">first</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">second</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">tidy</span>

<span class="kn">lemma</span> <span class="n">ext_iff</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">first</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">first</span> <span class="n">b</span> <span class="bp">∧</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">second</span> <span class="n">b</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">h</span><span class="o">,</span> <span class="k">by</span> <span class="n">cases</span> <span class="n">h</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span> <span class="bp">λ</span> <span class="bp">⟨</span><span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">ext</span> <span class="n">p</span> <span class="n">q</span><span class="bp">⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="bp">ℕ</span><span class="err">²</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span><span class="bp">⟩</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">first_zero</span> <span class="o">:</span> <span class="n">first</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">second_zero</span> <span class="o">:</span> <span class="n">second</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>


<span class="n">def</span> <span class="n">has_one</span> <span class="o">:</span> <span class="n">has_one</span> <span class="bp">ℕ</span><span class="err">²</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span><span class="bp">⟩</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">has_one</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">first_one</span> <span class="o">:</span> <span class="n">first</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">second_one</span> <span class="o">:</span> <span class="n">second</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>


<span class="n">def</span> <span class="n">r</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:=</span> <span class="n">first</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">first</span> <span class="n">b</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_equiv</span> <span class="bp">ℕ</span><span class="err">²</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">r</span><span class="bp">⟩</span>

<span class="kn">namespace</span> <span class="n">r</span>
<span class="kn">theorem</span> <span class="n">refl</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≈</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="c1">-- unfold it in your head</span>
  <span class="n">change</span> <span class="n">first</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">first</span> <span class="n">a</span><span class="o">,</span>
  <span class="c1">-- if you delete the line above, the line below still works</span>
  <span class="n">apply</span> <span class="n">add_comm</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">symm</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≈</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≈</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">has_equiv</span><span class="bp">.</span><span class="n">equiv</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">r</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">omega</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">trans</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≈</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≈</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≈</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intro</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">hbc</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">has_equiv</span><span class="bp">.</span><span class="n">equiv</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">r</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">omega</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">equiv</span> <span class="o">:</span> <span class="n">equivalence</span> <span class="n">r</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">refl</span><span class="o">,</span> <span class="n">symm</span><span class="o">,</span> <span class="n">trans</span><span class="bp">⟩</span>

<span class="kn">end</span> <span class="n">r</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">setoid</span> <span class="bp">ℕ</span><span class="err">²</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">r</span> <span class="o">:=</span> <span class="n">r</span><span class="o">,</span>
  <span class="n">iseqv</span> <span class="o">:=</span> <span class="n">r</span><span class="bp">.</span><span class="n">equiv</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">natsquared</span>

<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">natsquared</span><span class="bp">.</span><span class="n">has_one</span> <span class="c1">-- the canonical 1 is another one!</span>

<span class="c1">-- definition of int as quotient type</span>
<span class="kn">notation</span> <span class="bp">`ℤ</span><span class="mi">3</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">quotient</span> <span class="n">natsquared</span><span class="bp">.</span><span class="n">setoid</span>

<span class="c1">-- theorem! It&#39;s a ring!</span>

<span class="n">def</span> <span class="n">zero</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="err">⟦</span><span class="mi">0</span><span class="err">⟧</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">zero</span><span class="bp">⟩</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">zero</span><span class="bp">.</span><span class="n">thing0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="bp">=</span> <span class="err">⟦</span><span class="mi">0</span><span class="err">⟧</span> <span class="o">:=</span> <span class="n">rfl</span>



<span class="n">def</span> <span class="n">one</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="err">⟦</span><span class="mi">1</span><span class="err">⟧</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_one</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">one</span><span class="bp">⟩</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">one</span><span class="bp">.</span><span class="n">thing0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="bp">=</span> <span class="err">⟦</span><span class="mi">1</span><span class="err">⟧</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">one</span><span class="bp">.</span><span class="n">first</span> <span class="o">:</span> <span class="n">first</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">one</span><span class="bp">.</span><span class="n">second</span> <span class="o">:</span> <span class="n">second</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">refl</span>

<span class="kn">open</span> <span class="n">natsquared</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">thing</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="err">²</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≈</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">first</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">second</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">first</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">iff</span><span class="bp">.</span><span class="n">rfl</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">def</span> <span class="n">add</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on₂</span> <span class="n">a</span> <span class="n">b</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span> <span class="n">w</span><span class="o">,</span>
  <span class="err">⟦</span><span class="o">(</span><span class="n">first</span> <span class="n">z</span> <span class="bp">+</span> <span class="n">first</span> <span class="n">w</span><span class="o">,</span> <span class="n">second</span> <span class="n">z</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">w</span><span class="o">)</span><span class="err">⟧</span><span class="o">)</span> <span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">omega</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_add</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">add</span><span class="bp">⟩</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">thing2</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">add</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">def</span> <span class="n">neg</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on</span> <span class="n">a</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="err">⟦</span><span class="o">(</span><span class="n">second</span> <span class="n">b</span><span class="o">,</span> <span class="n">first</span> <span class="n">b</span><span class="o">)</span><span class="err">⟧</span><span class="o">)</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">omega</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">neg</span><span class="bp">⟩</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">neg</span><span class="bp">.</span><span class="n">thing0</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="bp">-</span><span class="n">a</span> <span class="bp">=</span> <span class="n">neg</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">add</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">+</span><span class="o">),</span>
  <span class="n">add_assoc</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">omega</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">omega</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">add_zero</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">omega</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="n">has_neg</span><span class="bp">.</span><span class="n">neg</span><span class="o">,</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">omega</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">omega</span>
  <span class="kn">end</span>
<span class="o">}</span>

<span class="kn">theorem</span> <span class="n">useful</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="n">t</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">q</span> <span class="bp">+</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">w</span> <span class="bp">=</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">p</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="o">(</span><span class="n">t</span> <span class="bp">*</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="o">(</span><span class="n">t</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">w</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">+</span> <span class="n">u</span><span class="o">)</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">=</span> <span class="o">(</span><span class="n">q</span> <span class="bp">+</span> <span class="n">t</span><span class="o">)</span> <span class="bp">*</span> <span class="n">r</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">add_mul</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">nat</span><span class="bp">.</span><span class="n">add_left_cancel</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">r</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="k">show</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="o">(</span><span class="n">t</span> <span class="bp">*</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">))</span> <span class="bp">=</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="k">show</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">=</span> <span class="n">t</span> <span class="bp">*</span> <span class="o">(</span><span class="n">r</span> <span class="bp">+</span> <span class="n">w</span><span class="o">)</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="k">show</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">+</span> <span class="o">(</span><span class="n">t</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">w</span><span class="o">))</span> <span class="bp">=</span> <span class="n">u</span> <span class="bp">*</span> <span class="o">(</span><span class="n">r</span> <span class="bp">+</span> <span class="n">w</span><span class="o">)</span> <span class="bp">+</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">h2</span><span class="o">,</span> <span class="n">mul_add</span><span class="o">,</span> <span class="n">mul_add</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="k">show</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">=</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">r</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">],</span>
  <span class="c1">--uv cancels tv cancels qr cancels</span>
  <span class="n">suffices</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">q</span> <span class="bp">*</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">p</span> <span class="bp">+</span> <span class="n">u</span><span class="o">)</span> <span class="bp">*</span> <span class="n">s</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">this</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>


<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">def</span> <span class="n">mul</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on₂</span> <span class="n">a</span> <span class="n">b</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span> <span class="n">w</span><span class="o">,</span>
  <span class="err">⟦</span><span class="o">(</span><span class="n">first</span> <span class="n">z</span> <span class="bp">*</span> <span class="n">first</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">z</span> <span class="bp">*</span> <span class="n">second</span> <span class="n">w</span><span class="o">,</span> <span class="n">first</span> <span class="n">z</span> <span class="bp">*</span> <span class="n">second</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">second</span> <span class="n">z</span> <span class="bp">*</span> <span class="n">first</span> <span class="n">w</span><span class="o">)</span><span class="err">⟧</span><span class="o">)</span>
  <span class="c1">-- why is this well-defined?</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">useful</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_1</span> <span class="n">a_2</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">mul</span><span class="bp">⟩</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">thing3</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">rfl</span>


<span class="kn">instance</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="bp">ℤ</span><span class="mi">3</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">*</span><span class="o">),</span>
  <span class="n">one</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">one_mul</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">mul_one</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
    <span class="n">sorry</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">right_distrib</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
    <span class="n">sorry</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">mul_comm</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="bp">..</span><span class="n">int3</span><span class="bp">.</span><span class="n">add_comm_group</span>
<span class="o">}</span>

<span class="kn">end</span> <span class="n">int3</span>
</code></pre></div>



<a name="202241902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/int%20is%20a%20ring/near/202241902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html#202241902">(Jun 28 2020 at 15:47)</a>:</h4>
<p>State after <code>simp</code> (when I want <code>omega</code> or <code>ring</code> to kick in) in <code>left_distrib</code> and <code>right_distrib</code>  is </p>
<div class="codehilite"><pre><span></span><code>abc : ℤ3
a_1b_1c_1 : ℕ²
⊢ ⟦a_1⟧.lift_on₂ (add_comm_group.add ⟦b_1⟧ ⟦c_1⟧) (λ (z w : ℕ²), ⟦(z.fst * w.fst + z.snd * w.snd, z.fst * w.snd + z.snd * w.fst)⟧) mul._proof_1 = add_comm_group.add ⟦(a_1.fst * b_1.fst + a_1.snd * b_1.snd, a_1.fst * b_1.snd + a_1.snd * b_1.fst)⟧ ⟦(a_1.fst * c_1.fst + a_1.snd * c_1.snd, a_1.fst * c_1.snd + a_1.snd * c_1.fst)⟧
</code></pre></div>



<a name="202241953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/int%20is%20a%20ring/near/202241953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html#202241953">(Jun 28 2020 at 15:48)</a>:</h4>
<div class="codehilite"><pre><span></span><code>  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">intros</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
</code></pre></div>



<a name="202241954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/int%20is%20a%20ring/near/202241954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html#202241954">(Jun 28 2020 at 15:48)</a>:</h4>
<p>This works</p>



<a name="202241966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/int%20is%20a%20ring/near/202241966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/int.20is.20a.20ring.html#202241966">(Jun 28 2020 at 15:48)</a>:</h4>
<p>I've found the trick for any of these is to use <code>quotient.sound</code> after the induction step</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>