---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/free.20groups.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html">free groups</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272372390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272372390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272372390">(Feb 18 2022 at 08:16)</a>:</h4>
<p>When formalizing free groups, one has the choice of taking all words and then form a quotient (this is done in mathlib), or define the type of normalized words and build the group on top of that (likely with a normalizion function, and multiplication being concatenation followed by normalization).</p>
<p>In a previous life I once formalized them in Isabelle and later in Agda, and made these notes</p>
<blockquote>
<p>At first I wanted to follow the same path again and tried to define the free group on the set of fully reduced words. This is the natural way in Isabelle, where the existing setup for groups expects you to define the carrier as a subset of an existing type (the type here being lists of generators and their inverses). But I did not get far, and also I had to start using stuff like DecidableEquivalence, an indication that this might not go well with the intuitionalistic logic. So I changed my approach and defined the free group on all words as elements of the group, with a suitable equivalence relation. This allowed me define the free group construction and show its group properties without any smell of classical logic.</p>
</blockquote>
<p>But mathlib isn't shy of classical logic, isn't it? So out of curiosity I wonder why mathlib's definition for free groups is using quotients. Because the support for quotient types is so good, it's worth using it? Or because it is simply simpler?</p>
<p>(One reason I'm asking is because we don't have the free product of groups yet, do we, and they'd probably be constructed similarly.)</p>



<a name="272373507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272373507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272373507">(Feb 18 2022 at 08:31)</a>:</h4>
<p>The impression I'd gotten with <code>free_group</code> is that it's set up to be able to prove some formal properties about word reduction (for example, <a href="https://leanprover-community.github.io/mathlib_docs/find/free_group.red.church_rosser">docs#free_group.red.church_rosser</a>). If it had been defined using an explicit reduction procedure, then that would entail making arbitrary choices about the order of reduction.  Later on, such a procedure ends up being defined (<a href="https://leanprover-community.github.io/mathlib_docs/find/free_group.reduce">docs#free_group.reduce</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/free_group.to_word">docs#free_group.to_word</a>), and there are proofs that it gives <em>the</em> reduction using the previous setup.</p>



<a name="272374411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272374411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272374411">(Feb 18 2022 at 08:41)</a>:</h4>
<p>It's possible that part of it is that <code>free_group</code> is from 2018, and mathlib has gotten more classical over time.  (I found <a href="#narrow/stream/113488-general/topic/free.20group/near/124469539">the thread</a> where it was developed. It's rather long.)  Though, mathlib still tends to try to keep definitions computable where practical.</p>



<a name="272374760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272374760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272374760">(Feb 18 2022 at 08:44)</a>:</h4>
<p>The definition via normalization would still be computable (at least if the elements have decidable equality), wouldn't it?</p>



<a name="272374819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272374819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272374819">(Feb 18 2022 at 08:45)</a>:</h4>
<p>Yeah, <a href="https://leanprover-community.github.io/mathlib_docs/find/free_group.reduce">docs#free_group.reduce</a> is computable given decidable equality</p>



<a name="272379199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272379199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272379199">(Feb 18 2022 at 09:33)</a>:</h4>
<p>We do have free products of groups, <a href="https://leanprover-community.github.io/mathlib_docs/find/free_product">docs#free_product</a>. There's also a discussion about the definition in the doc-string.</p>



<a name="272384866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272384866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272384866">(Feb 18 2022 at 10:32)</a>:</h4>
<p>Oh, why did I think we didn’t. Must have been confused.<br>
What about the ping-pong-lemma? Seems all necessary prerequisites are there then?</p>



<a name="272385155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272385155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272385155">(Feb 18 2022 at 10:35)</a>:</h4>
<p>And would it be a useful lemma to show that free product of free groups is a free group?</p>



<a name="272388896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272388896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272388896">(Feb 18 2022 at 11:13)</a>:</h4>
<p>I don't know about the ping-pong lemma, but "free product of free groups is a free group" is immediate from universal properties right? In general there's also a lot of API missing about free products, e.g. we don't have binary products yet</p>



<a name="272398101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272398101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272398101">(Feb 18 2022 at 12:58)</a>:</h4>
<p>Yes, it should follow quickly from universal properties.<br>
Is adding such not-super-hard lemmas useful, even they are not actually needed for something more serious, and not part of a systematic API development?</p>



<a name="272409175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272409175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272409175">(Feb 18 2022 at 14:39)</a>:</h4>
<p>Definitely, I would say! Someone may well need them later on for something.</p>



<a name="272413525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272413525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272413525">(Feb 18 2022 at 15:14)</a>:</h4>
<p>(hmm, wait)</p>



<a name="272414021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272414021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272414021">(Feb 18 2022 at 15:18)</a>:</h4>
<p>Huh, turning something from a <code>lemma</code> to a <code>def</code> can make its proof fail. That’s unexpected.</p>



<a name="272414478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272414478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272414478">(Feb 18 2022 at 15:21)</a>:</h4>
<p>So, this works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The free product of free groups is itself a free group -/</span>
<span class="kd">lemma</span> <span class="n">is_free_group_free_product_of_is_free_group</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="n">hG</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">is_free_group</span> <span class="o">(</span><span class="n">free_product</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">generators</span> <span class="o">:=</span> <span class="bp">Σ</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group.generators</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">),</span>
  <span class="n">of</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩,</span> <span class="n">free_product.of</span> <span class="o">(</span><span class="n">is_free_group.of</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">unique_lift'</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introsI</span> <span class="n">X</span> <span class="n">_</span> <span class="n">f</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">free_product.lift</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group.lift</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩)),</span> <span class="n">_</span> <span class="o">⟩,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">g</span> <span class="n">hfg</span><span class="o">,</span> <span class="n">ext</span> <span class="n">i</span> <span class="n">x</span><span class="o">,</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hfg</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩,</span> <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>
<p>But surely this needs to be a <code>def</code>. But then the <code>simp</code> doesn't work, and I need to do something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The free product of free groups is itself a free group -/</span>
<span class="kd">@[simps]</span>
<span class="kd">def</span> <span class="n">is_free_group_free_product_of_is_free_group</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
  <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">)]</span> <span class="o">[</span><span class="n">hG</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">is_free_group</span> <span class="o">(</span><span class="n">free_product</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">generators</span> <span class="o">:=</span> <span class="bp">Σ</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group.generators</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">),</span>
  <span class="n">of</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩,</span> <span class="n">free_product.of</span> <span class="o">(</span><span class="n">is_free_group.of</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">unique_lift'</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introsI</span> <span class="n">X</span> <span class="n">_</span> <span class="n">f</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">free_product.lift</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_free_group.lift</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩)),</span> <span class="n">_</span> <span class="o">⟩,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rintros</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩,</span>
      <span class="n">unfold</span> <span class="n">is_free_group_free_product_of_is_free_group._match_1</span><span class="o">,</span>
      <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">g</span> <span class="n">hfg</span><span class="o">,</span> <span class="n">ext</span> <span class="n">i</span> <span class="n">x</span><span class="o">,</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hfg</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">x</span><span class="o">⟩,</span> <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>
<p>to make it unfold my definition of <code>generators</code>. Am I doing something wrong?</p>



<a name="272415076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272415076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272415076">(Feb 18 2022 at 15:26)</a>:</h4>
<p>a lemma's type gets inferred at the <code>:=</code>, whilst a <code>def</code>'s type can change depending on what's written afterwards. I suspect this is what's happening, with different instances</p>



<a name="272417632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272417632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272417632">(Feb 18 2022 at 15:47)</a>:</h4>
<p>You can try putting <code>by exact</code> before the body of the definition but it's a bit black magic</p>



<a name="272417900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272417900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272417900">(Feb 18 2022 at 15:49)</a>:</h4>
<blockquote>
<p><code>of := λ ⟨i, x⟩, free_product.of (is_free_group.of x)</code></p>
</blockquote>
<p>Unfortunately, this is usually not a good idea</p>



<a name="272417959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272417959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272417959">(Feb 18 2022 at 15:49)</a>:</h4>
<p><code>of := λ p, free_product.of (is_free_group.of p.2)</code></p>



<a name="272418299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272418299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272418299">(Feb 18 2022 at 15:52)</a>:</h4>
<p>Specifically it's not a good idea when constructing data--it's okay in proofs</p>



<a name="272418622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272418622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272418622">(Feb 18 2022 at 15:55)</a>:</h4>
<p>Ah, that was is, thanks. Too bad – destructing pattern matches are so useful :-)</p>



<a name="272418908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/272418908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#272418908">(Feb 18 2022 at 15:57)</a>:</h4>
<p>I think this <em>might</em> not be an issue in Lean 4.</p>



<a name="275621634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/275621634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Zhengying <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#275621634">(Mar 17 2022 at 08:50)</a>:</h4>
<p>Did anybody try this  GPT-f repo?<br>
<a href="https://github.com/jesse-michael-han/lean-gptf">https://github.com/jesse-michael-han/lean-gptf</a><br>
I'm wondering if the OpenAI API key required can be the same one when one uses GPT-3 etc?</p>



<a name="275621728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/free%20groups/near/275621728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/free.20groups.html#275621728">(Mar 17 2022 at 08:51)</a>:</h4>
<p>I believe GPT-f is down, see <a href="#narrow/stream/274007-lean-gptf/topic/Lean.20GPT-f.20beta/near/273140603">https://leanprover.zulipchat.com/#narrow/stream/274007-lean-gptf/topic/Lean.20GPT-f.20beta/near/273140603</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>