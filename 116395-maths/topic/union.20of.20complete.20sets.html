---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/union.20of.20complete.20sets.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html">union of complete sets</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="271048055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271048055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271048055">(Feb 07 2022 at 21:55)</a>:</h4>
<p>For our uniform space experts (yes, <span class="user-mention" data-user-id="110031">@Patrick Massot</span> , I'm thinking of you :-). I can't find in the library the fact that the union of two complete sets is complete. I'm not even sure this is correct in full generality (i.e., without any separation assumption), but I don't have an easy counterexample either, so I'd be interested in comments in one direction or the other.</p>



<a name="271048716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271048716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271048716">(Feb 07 2022 at 22:00)</a>:</h4>
<p>It's a great question!</p>



<a name="271051667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271051667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271051667">(Feb 07 2022 at 22:22)</a>:</h4>
<p>For metric spaces it is easy, isn't it? If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><msub><mo stretchy="false">)</mo><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">(x_n)_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a Cauchy sequence contained in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∪</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">S \cup T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>, then there is a subsequence contained in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> (or in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>), that is convergent, and then the original sequence is convergent. Am I missing something obvious or is a more general notion of completeness?</p>



<a name="271051755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271051755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271051755">(Feb 07 2022 at 22:23)</a>:</h4>
<p>It's a more general notion</p>



<a name="271051800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271051800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271051800">(Feb 07 2022 at 22:23)</a>:</h4>
<p>I'm not sure whether the general statement is true.</p>



<a name="271052048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052048">(Feb 07 2022 at 22:25)</a>:</h4>
<p>It's <a href="https://leanprover-community.github.io/mathlib_docs/find/is_complete">docs#is_complete</a></p>



<a name="271052079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052079">(Feb 07 2022 at 22:25)</a>:</h4>
<p>(root namespace -- wow!)</p>



<a name="271052175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052175">(Feb 07 2022 at 22:26)</a>:</h4>
<p>It's a bit too late to think about exotic uniform spaces.</p>



<a name="271052187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052187">(Feb 07 2022 at 22:26)</a>:</h4>
<p>I am reading it, but I still have problems with uniform spaces...</p>



<a name="271052377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052377">(Feb 07 2022 at 22:27)</a>:</h4>
<p>If s and t are complete, and f is a Cauchy filter with s union t in f, then we can't conclude s is in f or t is in f as far as I know (Cauchy doesn't imply this, does it?), so somehow this is where Riccardo's proof breaks down.</p>



<a name="271052473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271052473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271052473">(Feb 07 2022 at 22:28)</a>:</h4>
<p>If you could state completeness with ultrafilters, then you could make such a conclusion.</p>



<a name="271053230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271053230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271053230">(Feb 07 2022 at 22:33)</a>:</h4>
<p>Here is my current state.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">is_complete.union</span> <span class="o">{</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">t</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="o">(</span><span class="n">s</span> <span class="bp">∪</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">assume</span> <span class="n">f</span> <span class="n">f_cauchy</span> <span class="n">hf</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">fs</span> <span class="o">:=</span> <span class="n">f</span> <span class="bp">⊓</span> <span class="bp">𝓟</span> <span class="n">s</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">ft</span> <span class="o">:=</span> <span class="n">f</span> <span class="bp">⊓</span> <span class="bp">𝓟</span> <span class="n">t</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">fst</span> <span class="o">:</span> <span class="n">fs</span> <span class="bp">⊔</span> <span class="n">ft</span> <span class="bp">=</span> <span class="n">f</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">fs</span><span class="o">,</span> <span class="n">ft</span><span class="o">,</span> <span class="bp">←</span> <span class="n">inf_sup_left</span><span class="o">,</span> <span class="n">sup_principal</span><span class="o">]</span> <span class="n">using</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">eq_or_ne</span> <span class="n">fs</span> <span class="bp">⊥</span> <span class="k">with</span> <span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">,</span> <span class="n">bot_sup_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">fst</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">f_cauchy</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">xt</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">ft</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">ht</span> <span class="n">ft</span> <span class="n">f_cauchy</span> <span class="n">inf_le_right</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mem_union_right</span> <span class="n">_</span> <span class="n">xt</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="n">rcases</span> <span class="n">eq_or_ne</span> <span class="n">ft</span> <span class="bp">⊥</span> <span class="k">with</span> <span class="n">h'</span><span class="bp">|</span><span class="n">h'</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h'</span><span class="o">,</span> <span class="n">sup_bot_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">fst</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">f_cauchy</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">xs</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">fs</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">hs</span> <span class="n">fs</span> <span class="n">f_cauchy</span> <span class="n">inf_le_right</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mem_union_left</span> <span class="n">_</span> <span class="n">xs</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">xs</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">fs</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span>
    <span class="n">hs</span> <span class="n">fs</span> <span class="o">(</span><span class="n">f_cauchy.mono'</span> <span class="o">⟨</span><span class="n">h</span><span class="o">⟩</span> <span class="n">inf_le_left</span><span class="o">)</span> <span class="n">inf_le_right</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">yt</span><span class="o">,</span> <span class="n">hy</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">ft</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">y</span> <span class="o">:=</span>
    <span class="n">ht</span> <span class="n">ft</span> <span class="o">(</span><span class="n">f_cauchy.mono'</span> <span class="o">⟨</span><span class="n">h'</span><span class="o">⟩</span> <span class="n">inf_le_left</span><span class="o">)</span> <span class="n">inf_le_right</span><span class="o">,</span>
  <span class="k">suffices</span> <span class="n">H</span> <span class="o">:</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">𝓝</span> <span class="n">y</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">H</span> <span class="n">at</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mem_union_left</span> <span class="n">_</span> <span class="n">xs</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">fst</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">sup_le</span> <span class="n">hx</span> <span class="n">hy</span> <span class="o">},</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>(Since I don't know anything about this stuff, having Lean double-check everything helps a lot). I start from a Cauchy filter on <code>s ∪ t</code>, and then I restrict it to <code>s</code> and to <code>t</code>. If one of the restrictions is trivial, then the original filter lives on the other set, and I'm done. Otherwise, each restricted filter is Cauchy, so it has a limit (called <code>x</code> and <code>y</code> above). If I can prove that the neighborhoods of <code>x</code> and of <code>y</code> are the same, then I can conclude the proof. (Of course, <code>x</code> and <code>y</code> don't need to be the same, as limits are typically not unique). And hopefully this should be true, as these two points are approximated by a Cauchy filter, so they should be infinitely close...</p>



<a name="271055249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271055249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271055249">(Feb 07 2022 at 22:52)</a>:</h4>
<p>Probably you can reformulate the definition using ultrafilters. Then the proof is trivial</p>



<a name="271056164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271056164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271056164">(Feb 07 2022 at 23:01)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">is_complete.union</span> <span class="o">{</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">t</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="o">(</span><span class="n">s</span> <span class="bp">∪</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">assume</span> <span class="n">f</span> <span class="n">f_cauchy</span> <span class="n">hf</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">fs</span> <span class="o">:=</span> <span class="n">f</span> <span class="bp">⊓</span> <span class="bp">𝓟</span> <span class="n">s</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">ft</span> <span class="o">:=</span> <span class="n">f</span> <span class="bp">⊓</span> <span class="bp">𝓟</span> <span class="n">t</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">fst</span> <span class="o">:</span> <span class="n">fs</span> <span class="bp">⊔</span> <span class="n">ft</span> <span class="bp">=</span> <span class="n">f</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">fs</span><span class="o">,</span> <span class="n">ft</span><span class="o">,</span> <span class="bp">←</span> <span class="n">inf_sup_left</span><span class="o">,</span> <span class="n">sup_principal</span><span class="o">]</span> <span class="n">using</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">eq_or_ne</span> <span class="n">fs</span> <span class="bp">⊥</span> <span class="k">with</span> <span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">,</span> <span class="n">bot_sup_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">fst</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">f_cauchy</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">xt</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">ft</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">ht</span> <span class="n">ft</span> <span class="n">f_cauchy</span> <span class="n">inf_le_right</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mem_union_right</span> <span class="n">_</span> <span class="n">xt</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="n">fst</span> <span class="n">at</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">xs</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">fs</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span>
    <span class="n">hs</span> <span class="n">fs</span> <span class="o">(</span><span class="n">f_cauchy.mono'</span> <span class="o">⟨</span><span class="n">h</span><span class="o">⟩</span> <span class="n">inf_le_left</span><span class="o">)</span> <span class="n">inf_le_right</span><span class="o">,</span>
  <span class="n">use</span> <span class="o">[</span><span class="n">x</span><span class="o">,</span> <span class="n">or.inl</span> <span class="n">xs</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">le_nhds_of_cauchy_adhp</span> <span class="n">f_cauchy</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">fst</span><span class="o">,</span> <span class="n">cluster_pt</span><span class="o">,</span> <span class="n">inf_sup_left</span><span class="o">,</span> <span class="n">sup_ne_bot</span><span class="o">],</span>
  <span class="n">left</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">inf_of_le_right</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">h</span><span class="o">⟩</span>
<span class="kd">end</span>
</code></pre></div>
<p>I can go to bed knowing my reputation is safe.</p>



<a name="271056927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271056927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271056927">(Feb 07 2022 at 23:08)</a>:</h4>
<p>Il try to write a proof with ultrafilters tonight</p>



<a name="271058193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271058193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271058193">(Feb 07 2022 at 23:21)</a>:</h4>
<p>Probably I'm wrong.</p>



<a name="271059210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271059210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271059210">(Feb 07 2022 at 23:32)</a>:</h4>
<p>No, I'm not.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">cauchy.to_ultrafilter</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">cauchy</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">cauchy</span> <span class="o">(</span><span class="bp">@</span><span class="n">ultrafilter.of</span> <span class="n">_</span> <span class="n">l</span> <span class="n">h.1</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">haveI</span> <span class="o">:=</span> <span class="n">h.1</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">ultrafilter.of_le</span> <span class="n">l</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">ultrafilter.ne_bot</span> <span class="n">_</span><span class="o">,</span> <span class="o">(</span><span class="n">filter.prod_mono</span> <span class="n">this</span> <span class="n">this</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">h.2</span><span class="o">⟩</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">is_complete_iff_cluster_pt</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">l</span><span class="o">,</span> <span class="n">cauchy</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">≤</span> <span class="bp">𝓟</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">cluster_pt</span> <span class="n">x</span> <span class="n">l</span> <span class="o">:=</span>
<span class="n">forall₃_congr</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">l</span> <span class="n">hl</span> <span class="n">hls</span><span class="o">,</span> <span class="n">exists₂_congr</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="n">le_nhds_iff_adhp_of_cauchy</span> <span class="n">hl</span>

<span class="kd">lemma</span> <span class="n">is_complete_iff_ultrafilter</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">l</span> <span class="o">:</span> <span class="n">ultrafilter</span> <span class="n">α</span><span class="o">,</span> <span class="n">cauchy</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="bp">↑</span><span class="n">l</span> <span class="bp">≤</span> <span class="bp">𝓟</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="bp">↑</span><span class="n">l</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span> <span class="n">l</span><span class="o">,</span> <span class="n">h</span> <span class="n">l</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">H</span><span class="o">,</span> <span class="n">is_complete_iff_cluster_pt.2</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">l</span> <span class="n">hl</span> <span class="n">hls</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">haveI</span> <span class="o">:=</span> <span class="n">hl.1</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">H</span> <span class="o">(</span><span class="n">ultrafilter.of</span> <span class="n">l</span><span class="o">)</span> <span class="n">hl.to_ultrafilter</span> <span class="o">((</span><span class="n">ultrafilter.of_le</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">hls</span><span class="o">)</span>
    <span class="k">with</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hxs</span><span class="o">,</span> <span class="n">hxl</span><span class="o">⟩,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hxs</span><span class="o">,</span> <span class="o">(</span><span class="n">cluster_pt.of_le_nhds</span> <span class="n">hxl</span><span class="o">)</span><span class="bp">.</span><span class="n">mono</span> <span class="o">(</span><span class="n">ultrafilter.of_le</span> <span class="n">l</span><span class="o">)⟩</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">is_complete_iff_ultrafilter'</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">l</span> <span class="o">:</span> <span class="n">ultrafilter</span> <span class="n">α</span><span class="o">,</span> <span class="n">cauchy</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="bp">↑</span><span class="n">l</span> <span class="bp">≤</span> <span class="bp">𝓝</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">is_complete_iff_ultrafilter.trans</span> <span class="bp">$</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">le_principal_iff</span><span class="o">,</span> <span class="n">ultrafilter.mem_coe</span><span class="o">]</span>

<span class="kn">protected</span> <span class="kd">lemma</span> <span class="n">is_complete.union</span> <span class="o">{</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">is_complete</span> <span class="n">t</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_complete</span> <span class="o">(</span><span class="n">s</span> <span class="bp">∪</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">is_complete_iff_ultrafilter'</span><span class="o">,</span> <span class="n">ultrafilter.union_mem_iff</span><span class="o">,</span> <span class="n">or_imp_distrib</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">λ</span> <span class="n">l</span> <span class="n">hl</span><span class="o">,</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">hsl</span><span class="o">,</span> <span class="o">(</span><span class="n">hs</span> <span class="n">l</span> <span class="n">hl</span> <span class="n">hsl</span><span class="o">)</span><span class="bp">.</span><span class="n">imp</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="o">⟨</span><span class="n">or.inl</span> <span class="n">hx.fst</span><span class="o">,</span> <span class="n">hx.snd</span><span class="o">⟩,</span>
    <span class="bp">λ</span> <span class="n">htl</span><span class="o">,</span> <span class="o">(</span><span class="n">ht</span> <span class="n">l</span> <span class="n">hl</span> <span class="n">htl</span><span class="o">)</span><span class="bp">.</span><span class="n">imp</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="o">⟨</span><span class="n">or.inr</span> <span class="n">hx.fst</span><span class="o">,</span> <span class="n">hx.snd</span><span class="o">⟩⟩</span>
<span class="kd">end</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>
</code></pre></div>



<a name="271073342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271073342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271073342">(Feb 08 2022 at 02:35)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/11912">#11912</a></p>



<a name="271073373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271073373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271073373">(Feb 08 2022 at 02:35)</a>:</h4>
<p>I used my proof because IMHO we should have <code>is_complete_iff_ultrafilter</code>, and with this lemma my proof is much shorter.</p>



<a name="271089490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/union%20of%20complete%20sets/near/271089490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/union.20of.20complete.20sets.html#271089490">(Feb 08 2022 at 07:20)</a>:</h4>
<p>Thanks to both of you!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>