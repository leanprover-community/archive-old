---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html">finite choice / surjectivity of Pi-terms</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="299696174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299696174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299696174">(Sep 20 2022 at 07:22)</a>:</h4>
<p>I have two questions related to choice.<br>
1) I am working on permutations on finite sets, and at some point, I needed to pick one point per orbit. <br>
I am truly appalled at the prospect of using <code>classical.choice</code> for that, but I couldn't find instances of finite choice (a finite product of nonempty sets is nonempty).<br>
2) In fact, I need to prove that a pi-term has a section, something like this</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">ι</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">set</span> <span class="o">(</span><span class="n">α</span> <span class="n">i</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">α</span> <span class="n">i</span><span class="o">),</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">a</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="n">i</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>but I was rapidly blocked by the syntax of Lean… How to use <code>use</code> in that context, for example ?</p>



<a name="299696296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299696296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299696296">(Sep 20 2022 at 07:23)</a>:</h4>
<p>Do you have <code>fintype</code> instances floating around? Or only <code>finite</code>?</p>



<a name="299696384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299696384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299696384">(Sep 20 2022 at 07:24)</a>:</h4>
<p>Because under the hood a <code>fintype</code> carries around a list of elements, and you could probably grab an element out of that.</p>



<a name="299698900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299698900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299698900">(Sep 20 2022 at 07:44)</a>:</h4>
<p>This probably also needs <code>ι</code> to have decidable equality</p>



<a name="299698973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299698973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299698973">(Sep 20 2022 at 07:45)</a>:</h4>
<p><code>existsi</code> can be used instead of <code>use</code>, it's a more primitive version of <code>use</code> (for example <code>existsi _</code> reliably works, but gives goals with metavariables...)</p>



<a name="299699220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299699220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299699220">(Sep 20 2022 at 07:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">ι</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">set</span> <span class="o">(</span><span class="n">α</span> <span class="n">i</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">α</span> <span class="n">i</span><span class="o">),</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">a</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="n">i</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">use</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">hs</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">some</span><span class="o">),</span>
  <span class="n">exact</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">hs</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">some_spec</span><span class="o">),</span>
<span class="kd">end</span>
</code></pre></div>



<a name="299699313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299699313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299699313">(Sep 20 2022 at 07:47)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">ι</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">set</span> <span class="o">(</span><span class="n">α</span> <span class="n">i</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="n">α</span> <span class="n">i</span><span class="o">),</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">a</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="n">i</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">hs</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">some</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">hs</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">some_spec</span><span class="o">⟩</span>
</code></pre></div>



<a name="299699382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299699382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299699382">(Sep 20 2022 at 07:48)</a>:</h4>
<p>(or is the point that you _really_ don't want to use AC for some reason?)</p>



<a name="299706840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299706840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299706840">(Sep 20 2022 at 08:44)</a>:</h4>
<p>Indeed, I _really_ do not want to use AC for those questions, when it's totally irrelevant: you don't use choice  to choose an element in a finite product. On the other hand, it would be nice if Lean could detect by itself that this <code>choice</code> does not depend on AC.</p>



<a name="299708205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299708205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299708205">(Sep 20 2022 at 08:54)</a>:</h4>
<p>In mathlib, choice is used to prove excluded middle. The philosophy is really to use choice completely liberally, since it makes our life easier.</p>



<a name="299709190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299709190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299709190">(Sep 20 2022 at 09:01)</a>:</h4>
<p>In some ways, in lean you need choice finitely unless you can construct a deterministic algorithm to choose some member of the finset</p>



<a name="299709285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299709285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299709285">(Sep 20 2022 at 09:01)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/fintype.choose">docs#fintype.choose</a> exists, which might be relevant here</p>



<a name="299709395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299709395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299709395">(Sep 20 2022 at 09:02)</a>:</h4>
<p>So if there's some linear order, you can choose the minimum, you can use fintype.choose if there exists only one as Eric W pointed out</p>



<a name="299709424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299709424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299709424">(Sep 20 2022 at 09:02)</a>:</h4>
<p>But if there's many identical-looking possible elements, how does a deterministic program choose one?</p>



<a name="299710377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299710377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299710377">(Sep 20 2022 at 09:10)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/quotient.fin_choice">docs#quotient.fin_choice</a> is likely also relevant</p>



<a name="299711153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299711153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299711153">(Sep 20 2022 at 09:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="#narrow/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms/near/299708205">said</a>:</p>
<blockquote>
<p>In mathlib, choice is used to prove excluded middle. The philosophy is really to use choice completely liberally, since it makes our life easier.</p>
</blockquote>
<p>(This reminds me of Bourbaki using choice to define quantifiers…)<br>
About this philosophy, why not ? Except that we're working with a compiler that sometimes requires  us to insert <code>decidable</code> predicates.</p>



<a name="299711254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299711254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299711254">(Sep 20 2022 at 09:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms/near/299710377">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/quotient.fin_choice">docs#quotient.fin_choice</a> is likely also relevant</p>
</blockquote>
<p>I precisely had in mind a variant of this function.</p>



<a name="299711968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299711968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299711968">(Sep 20 2022 at 09:23)</a>:</h4>
<p><code>decidable</code> is only relevant when you are writing an algorithm that you would use to compute things. And in this case, avoiding choice is absolutely necessary. Otherwise, just use <code>classical.decidable</code> to make your life easier!</p>



<a name="299712919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299712919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299712919">(Sep 20 2022 at 09:30)</a>:</h4>
<p>(it also matters because all decidable instances are not subsingletons, so if you use something designed for decidable instances not noticing, it can lead to errors of the form "rw can't find X in the expression f X" (because the first X is @X classical.dec_eq and the second is @X some_other_instance)</p>



<a name="299713192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/finite%20choice%20/%20surjectivity%20of%20Pi-terms/near/299713192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/finite.20choice.20.2F.20surjectivity.20of.20Pi-terms.html#299713192">(Sep 20 2022 at 09:31)</a>:</h4>
<p>If you need a decidable assumption in a lemma, we all agree that you should have a corresponding typeclass assumption in the lemma, to avoid the issue you are mentioning. I was talking about things you do inside a proof.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>