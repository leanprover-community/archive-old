---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html">project doesn't accept mathlib oleans</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="305771457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305771457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305771457">(Oct 24 2022 at 08:39)</a>:</h4>
<p>Does any know any troubleshooting suggestions for the case that the downloaded mathlib <code>.olean</code>s are just ignored and everytime <code>leanpkg</code> starts to rebuild mathlib instead?</p>



<a name="305771555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305771555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305771555">(Oct 24 2022 at 08:40)</a>:</h4>
<p>Is that in mathlib itself or a project depending on mathlib?</p>



<a name="305771706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305771706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305771706">(Oct 24 2022 at 08:41)</a>:</h4>
<p>A project depending on it. Freshly cloned and equipped with oleans by <code>leanproject get-mathlib-cache</code></p>



<a name="305772228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305772228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305772228">(Oct 24 2022 at 08:45)</a>:</h4>
<p>Then the simplest thing is probably to get rid of <code>_target</code> and start over without investigating</p>



<a name="305772514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305772514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305772514">(Oct 24 2022 at 08:47)</a>:</h4>
<p>Did that already <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>



<a name="305772786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305772786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305772786">(Oct 24 2022 at 08:49)</a>:</h4>
<p>I'll try changing the mathlib rev</p>



<a name="305773258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305773258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305773258">(Oct 24 2022 at 08:52)</a>:</h4>
<p>That doesn't help either. It seems to believe that the current mathlib is older, for some reason:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">mathlib</span><span class="o">:</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">update</span> <span class="n">_target</span><span class="bp">/</span><span class="n">deps</span><span class="bp">/</span><span class="n">mathlib</span> <span class="n">to</span> <span class="n">revision</span> <span class="n">a923261c6eb9e0b179ccaff22effe33e491a7cbc</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="c1">--detach a923261c6eb9e0b179ccaff22effe33e491a7cbc    # in directory _target/deps/mathlib</span>
<span class="n">Previous</span> <span class="n">HEAD</span> <span class="n">position</span> <span class="n">was</span> <span class="mi">3</span><span class="n">c0061266f</span> <span class="n">feat</span><span class="o">(</span><span class="n">data</span><span class="bp">/</span><span class="o">{</span><span class="n">seq</span><span class="o">,</span><span class="n">stream</span><span class="o">}):</span> <span class="n">cons_injective2</span> <span class="o">(</span><span class="bp">#</span><span class="mi">15832</span><span class="o">)</span>
<span class="n">HEAD</span> <span class="n">is</span> <span class="n">now</span> <span class="n">at</span> <span class="n">a923261c6e</span> <span class="n">feat</span><span class="o">(</span><span class="n">data</span><span class="bp">/</span><span class="n">complex</span><span class="bp">/</span><span class="n">module</span><span class="o">):</span> <span class="n">add</span> <span class="kd">instance</span> <span class="bp">`</span><span class="n">complex.distrib_smul</span><span class="bp">`</span> <span class="o">(</span><span class="bp">#</span><span class="mi">17115</span><span class="o">)</span>
<span class="bp">&gt;</span> <span class="n">lean</span> <span class="c1">--make src</span>
</code></pre></div>



<a name="305773387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305773387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305773387">(Oct 24 2022 at 08:53)</a>:</h4>
<p>What do you mean by current?</p>



<a name="305773518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305773518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305773518">(Oct 24 2022 at 08:54)</a>:</h4>
<p>That looks like the update was successful to me</p>



<a name="305774705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305774705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305774705">(Oct 24 2022 at 09:01)</a>:</h4>
<p>After those lines it proceeds to build mathlib from scratch instead of using the oleans</p>



<a name="305774871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305774871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305774871">(Oct 24 2022 at 09:02)</a>:</h4>
<p>If you run lean from the command line, which file does it build first?</p>



<a name="305775016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305775016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305775016">(Oct 24 2022 at 09:03)</a>:</h4>
<p>You mean <code>leanpkg build</code>?</p>



<a name="305775119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305775119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305775119">(Oct 24 2022 at 09:04)</a>:</h4>
<p>Or <code>lean --make one_of_your_files</code></p>



<a name="305775186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305775186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305775186">(Oct 24 2022 at 09:04)</a>:</h4>
<p><code>mathlib/src/tactic/core.lean</code> is the first that gets built</p>



<a name="305775256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305775256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305775256">(Oct 24 2022 at 09:05)</a>:</h4>
<p>For some reason it look like it's skipping the "get mathlib olean cache" step. You should get some output</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Looking</span> <span class="n">for</span> <span class="n">mathlib</span> <span class="n">oleans</span> <span class="n">for</span> <span class="n">a923261c6e</span>
  <span class="n">locally...</span>
  <span class="n">remotely...</span>
  <span class="n">Found</span> <span class="n">remote</span> <span class="n">mathlib</span> <span class="n">oleans</span>
</code></pre></div>
<p>Try running <code>pip install -U mathlibtools</code>?</p>



<a name="305775476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305775476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305775476">(Oct 24 2022 at 09:06)</a>:</h4>
<p>In the worst case, you can do <code>cd _target/deps/mathlib/</code>, make sure you're on the correct commit, <code>leanproject get-cache</code> and <code>cd ../../..</code>. I've done that on old versions of <code>leanproject</code> to work around an issue it had.</p>



<a name="305776458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305776458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305776458">(Oct 24 2022 at 09:12)</a>:</h4>
<p>What command is the output above from?</p>



<a name="305776740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305776740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305776740">(Oct 24 2022 at 09:14)</a>:</h4>
<p>In my case it was</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">vandoorn</span><span class="bp">@</span><span class="n">pc93</span><span class="bp">-</span><span class="mi">178</span><span class="o">:</span><span class="bp">~/</span><span class="n">projects</span><span class="bp">/</span><span class="n">sphere</span><span class="bp">-</span><span class="n">eversion</span><span class="o">(</span><span class="n">manifold_proper</span><span class="o">)</span><span class="bp">$</span> <span class="n">leanproject</span> <span class="n">up</span>
<span class="n">mathlib</span><span class="o">:</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">update</span> <span class="n">_target</span><span class="bp">/</span><span class="n">deps</span><span class="bp">/</span><span class="n">mathlib</span> <span class="n">to</span> <span class="n">revision</span> <span class="mi">3</span><span class="n">b6552e051629f68c08f02b32339a8f53076a016</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="c1">--detach 3b6552e051629f68c08f02b32339a8f53076a016    # in directory _target/deps/mathlib</span>
<span class="n">Previous</span> <span class="n">HEAD</span> <span class="n">position</span> <span class="n">was</span> <span class="mi">34</span><span class="n">c70db665</span> <span class="n">feat</span><span class="o">(</span><span class="n">geometry</span><span class="bp">/</span><span class="n">euclidean</span><span class="bp">/</span><span class="n">oriented_angle</span><span class="o">):</span> <span class="n">oriented</span> <span class="n">angles</span> <span class="n">and</span> <span class="n">betweenness</span> <span class="o">(</span><span class="bp">#</span><span class="mi">16824</span><span class="o">)</span>
<span class="n">HEAD</span> <span class="n">is</span> <span class="n">now</span> <span class="n">at</span> <span class="mi">3</span><span class="n">b6552e051</span> <span class="n">chore</span><span class="o">(</span><span class="n">linear_algebra</span><span class="bp">/</span><span class="n">alternating</span><span class="o">):</span> <span class="n">more</span> <span class="n">lemmas</span> <span class="n">about</span> <span class="bp">`</span><span class="n">curry_left</span><span class="bp">`</span> <span class="o">(</span><span class="bp">#</span><span class="mi">14844</span><span class="o">)</span>
<span class="n">remote</span><span class="o">:</span> <span class="n">Enumerating</span> <span class="n">objects</span><span class="o">:</span> <span class="mi">9954</span><span class="o">,</span> <span class="n">done.</span>
<span class="n">remote</span><span class="o">:</span> <span class="n">Counting</span> <span class="n">objects</span><span class="o">:</span> <span class="mi">100</span><span class="bp">%</span> <span class="o">(</span><span class="mi">7075</span><span class="bp">/</span><span class="mi">7075</span><span class="o">),</span> <span class="n">done.</span>
<span class="n">remote</span><span class="o">:</span> <span class="n">Compressing</span> <span class="n">objects</span><span class="o">:</span> <span class="mi">100</span><span class="bp">%</span> <span class="o">(</span><span class="mi">709</span><span class="bp">/</span><span class="mi">709</span><span class="o">),</span> <span class="n">done.</span>
<span class="n">remote</span><span class="o">:</span> <span class="n">Total</span> <span class="mi">9954</span> <span class="o">(</span><span class="n">delta</span> <span class="mi">6591</span><span class="o">),</span> <span class="n">reused</span> <span class="mi">6701</span> <span class="o">(</span><span class="n">delta</span> <span class="mi">6363</span><span class="o">),</span> <span class="n">pack</span><span class="bp">-</span><span class="n">reused</span> <span class="mi">2879</span>
<span class="n">Receiving</span> <span class="n">objects</span><span class="o">:</span> <span class="mi">100</span><span class="bp">%</span> <span class="o">(</span><span class="mi">9954</span><span class="bp">/</span><span class="mi">9954</span><span class="o">),</span> <span class="mi">6</span><span class="bp">.</span><span class="mi">02</span> <span class="n">MiB</span> <span class="bp">|</span> <span class="mi">11</span><span class="bp">.</span><span class="mi">90</span> <span class="n">MiB</span><span class="bp">/</span><span class="n">s</span><span class="o">,</span> <span class="n">done.</span>
<span class="n">Resolving</span> <span class="n">deltas</span><span class="o">:</span> <span class="mi">100</span><span class="bp">%</span> <span class="o">(</span><span class="mi">7861</span><span class="bp">/</span><span class="mi">7861</span><span class="o">),</span> <span class="n">completed</span> <span class="k">with</span> <span class="mi">1754</span> <span class="kn">local</span> <span class="n">objects.</span>
<span class="n">From</span> <span class="n">github.com</span><span class="o">:</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathlib</span>
   <span class="mi">40730</span><span class="n">f6ba8..97568f98eb</span>  <span class="n">AD_barrels</span>              <span class="bp">-&gt;</span> <span class="n">origin</span><span class="bp">/</span><span class="n">AD_barrels</span>
<span class="o">[</span><span class="n">many</span> <span class="n">lines</span> <span class="n">of</span> <span class="n">output</span> <span class="n">omitted</span><span class="o">]</span>
 <span class="bp">*</span> <span class="o">[</span><span class="n">new</span> <span class="n">branch</span><span class="o">]</span>            <span class="n">zorn_Ici</span>                <span class="bp">-&gt;</span> <span class="n">origin</span><span class="bp">/</span><span class="n">zorn_Ici</span>
<span class="n">configuring</span> <span class="n">sphere_eversion</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span>
<span class="n">mathlib</span><span class="o">:</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">update</span> <span class="n">_target</span><span class="bp">/</span><span class="n">deps</span><span class="bp">/</span><span class="n">mathlib</span> <span class="n">to</span> <span class="n">revision</span> <span class="n">a923261c6eb9e0b179ccaff22effe33e491a7cbc</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="c1">--detach a923261c6eb9e0b179ccaff22effe33e491a7cbc    # in directory _target/deps/mathlib</span>
<span class="n">Previous</span> <span class="n">HEAD</span> <span class="n">position</span> <span class="n">was</span> <span class="mi">3</span><span class="n">b6552e051</span> <span class="n">chore</span><span class="o">(</span><span class="n">linear_algebra</span><span class="bp">/</span><span class="n">alternating</span><span class="o">):</span> <span class="n">more</span> <span class="n">lemmas</span> <span class="n">about</span> <span class="bp">`</span><span class="n">curry_left</span><span class="bp">`</span> <span class="o">(</span><span class="bp">#</span><span class="mi">14844</span><span class="o">)</span>
<span class="n">HEAD</span> <span class="n">is</span> <span class="n">now</span> <span class="n">at</span> <span class="n">a923261c6e</span> <span class="n">feat</span><span class="o">(</span><span class="n">data</span><span class="bp">/</span><span class="n">complex</span><span class="bp">/</span><span class="n">module</span><span class="o">):</span> <span class="n">add</span> <span class="kd">instance</span> <span class="bp">`</span><span class="n">complex.distrib_smul</span><span class="bp">`</span> <span class="o">(</span><span class="bp">#</span><span class="mi">17115</span><span class="o">)</span>
<span class="n">Looking</span> <span class="n">for</span> <span class="n">mathlib</span> <span class="n">oleans</span> <span class="n">for</span> <span class="n">a923261c6e</span>
  <span class="n">locally...</span>
  <span class="n">remotely...</span>
  <span class="n">Found</span> <span class="n">remote</span> <span class="n">mathlib</span> <span class="n">oleans</span>
<span class="n">Located</span> <span class="n">matching</span> <span class="n">cache</span>
  <span class="n">a923261c6e</span><span class="o">:</span> <span class="mi">100</span><span class="bp">%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████|</span> <span class="mi">80</span><span class="bp">.</span><span class="mi">6</span><span class="n">M</span><span class="bp">/</span><span class="mi">80</span><span class="bp">.</span><span class="mi">6</span><span class="n">M</span> <span class="o">[</span><span class="mi">00</span><span class="o">:</span><span class="mi">18</span><span class="bp">&lt;</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">,</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">67</span><span class="n">MB</span><span class="bp">/</span><span class="n">s</span><span class="o">]</span>
<span class="n">Applying</span> <span class="n">cache</span>
  <span class="n">files</span> <span class="n">extracted</span><span class="o">:</span> <span class="mi">2783</span> <span class="o">[</span><span class="mi">00</span><span class="o">:</span><span class="mi">05</span><span class="o">,</span> <span class="mi">519</span><span class="bp">.</span><span class="mi">62</span><span class="bp">/</span><span class="n">s</span><span class="o">]</span>
</code></pre></div>



<a name="305781236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305781236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305781236">(Oct 24 2022 at 09:43)</a>:</h4>
<p>Thanks for the help, I'll try that after lunch <span aria-label="food" class="emoji emoji-1f372" role="img" title="food">:food:</span></p>



<a name="305781815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305781815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305781815">(Oct 24 2022 at 09:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="111080">Floris van Doorn</span> <a href="#narrow/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans/near/305775476">said</a>:</p>
<blockquote>
<p>In the worst case, you can do <code>cd _target/deps/mathlib/</code>, make sure you're on the correct commit, <code>leanproject get-cache</code> and <code>cd ../../..</code>. I've done that on old versions of <code>leanproject</code> to work around an issue it had.</p>
</blockquote>
<p>That doesn't help either, it does the <code>get-cache</code> without issues and then in the base directory still wants to build <code>mathlib</code> whenever I open a file or do <code>leanproject build</code></p>



<a name="305787558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305787558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305787558">(Oct 24 2022 at 10:26)</a>:</h4>
<p>Are you on the most recent elan and leanproject? Do you see the "looking for mathlib oleans locally...remotely..." message? If they're being fetched locally then there's a chance they're corrupted; you can just remove the tar.xz file in ~/.mathlib and try again to get them remotely. If this still doesn't solve the problem there's a chance you accidentally edited core Lean; you can delete the version of Lean you're using in ~/.elan (this involves deleting two things) and then use elan to redownload lean and then leanproject to get mathlib ones.</p>



<a name="305789698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305789698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305789698">(Oct 24 2022 at 10:40)</a>:</h4>
<p>I see the "looking for ..." when doing <code>leanproject get-mathlib-cache</code> or <code>leanproject get-cache</code> but not on <code>leanproject build</code></p>



<a name="305790011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305790011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305790011">(Oct 24 2022 at 10:42)</a>:</h4>
<p><code>elan update</code> doesn't help either</p>



<a name="305790667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305790667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305790667">(Oct 24 2022 at 10:46)</a>:</h4>
<p>You wouldn't expect it on <code>leanproject build</code>, that's just doing <code>lean --make src</code>.</p>



<a name="305790768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305790768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305790768">(Oct 24 2022 at 10:47)</a>:</h4>
<p><code>elan self update</code> updates elan, and some python command which I never remember updates leanproject.</p>



<a name="305791065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305791065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305791065">(Oct 24 2022 at 10:49)</a>:</h4>
<p>If you think the problem is with your Lean version then you have to nuke things both in <code>~/.elan/toolchains</code> and <code>~/.elan/update-hashes</code></p>



<a name="305791246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305791246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305791246">(Oct 24 2022 at 10:50)</a>:</h4>
<p>If you accidentally add a space into a core Lean file then the main symptoms are what you are seeing by the way, and the fix is to delete the relevant files in those elan directories and then just open a file in VS Code in the project and it will redownload an uncorrupted Lean.</p>



<a name="305793020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305793020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305793020">(Oct 24 2022 at 11:01)</a>:</h4>
<p><code>lean --make src</code> doesn't show the "looking for..." either <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span>  I already tried deleting <code>_target</code> entirely, so it's not changed core files.</p>



<a name="305795381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305795381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305795381">(Oct 24 2022 at 11:16)</a>:</h4>
<p>I don't understand why you would expect <code>lean --make src</code>, a command which builds lean files directly and has nothing to do with python, to print out a message which a python program prints out when attempting to access the internet to find olean files.</p>



<a name="305795481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305795481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305795481">(Oct 24 2022 at 11:17)</a>:</h4>
<p>I am conjecturing that you have borked your lean installation</p>



<a name="305795625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/project%20doesn%27t%20accept%20mathlib%20oleans/near/305795625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/project.20doesn't.20accept.20mathlib.20oleans.html#305795625">(Oct 24 2022 at 11:18)</a>:</h4>
<p>The "looking for" stuff is what the python front end is doing</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>