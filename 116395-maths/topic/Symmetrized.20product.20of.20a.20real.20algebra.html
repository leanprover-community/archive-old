---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html">Symmetrized product of a real algebra</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="265618226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265618226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265618226">(Dec 20 2021 at 21:32)</a>:</h4>
<p>Hello,</p>
<p>I've defined a non-unital, non-associative ring as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[protect_proj, ancestor add_comm_group non_unital_non_assoc_semiring ]</span>
<span class="kd">class</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span>
  <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">non_unital_non_assoc_semiring</span> <span class="n">α</span>
</code></pre></div>
<p>Given an algebra <code>α</code> over <code>ℝ</code>, I'm trying to show that <code>α</code> is am instance of <code>non_unital_non_assoc_ring</code> (forgetting about the unit) under symmetrized product:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">a</span><span class="bp">∘</span><span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="bp">+</span><span class="n">b</span><span class="bp">*</span><span class="n">a</span><span class="o">)</span><span class="bp">.</span>
</code></pre></div>
<p>Inspired by how mathlib implements the opposite multiplication (<code>algebra.opposites</code>) I've defined:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">sym_alg</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="n">α</span>

<span class="kd">postfix</span> <span class="bp">`ˢʸᵐ`</span><span class="o">:</span><span class="n">std.prec.max_plus</span> <span class="o">:=</span> <span class="n">sym_alg</span>
</code></pre></div>
<p>It's then possible to show</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">sym_alg</span>  <span class="n">α</span><span class="o">)</span>
</code></pre></div>
<p>except that two fields that are tripping me up are <code>neg</code> and <code>add_left_neg</code> as α is a semiring not a ring (alternatively, if I make <code>α</code> a ring, then I can't prove <code>left_distrib</code> and <code>right_distrib</code>).</p>
<p>It's easy to show that if <code>α</code> is a <code>add_comm_group</code> then so is <code>αˢʸᵐ</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_assoc</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_zero</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span> <span class="bp">-</span><span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">)),</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_left_neg</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
<span class="o">}</span>
</code></pre></div>
<p>I know that <code>module.add_comm_monoid_to_add_comm_group</code> exists, but I've been warned off doing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span>  <span class="n">ring_module_has_add_comm_group</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">module.add_comm_monoid_to_add_comm_group</span> <span class="n">R</span>
</code></pre></div>
<p>as it <a href="#narrow/stream/116395-maths/topic/C*-algebras/near/264824324">leads to diamonds</a>.</p>
<p>I can write:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="o">(</span><span class="n">module.add_comm_monoid_to_add_comm_group</span> <span class="n">ℝ</span><span class="o">)</span><span class="bp">.</span><span class="n">neg</span> <span class="c1">-- add_comm_group.neg : ?M_1 → ?M_1</span>
</code></pre></div>
<p>But not:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">α</span><span class="o">)</span>

<span class="k">#check</span> <span class="o">(</span><span class="n">module.add_comm_monoid_to_add_comm_group</span> <span class="n">ℝ</span><span class="o">)</span><span class="bp">.</span><span class="n">neg</span> <span class="n">a</span> <span class="c1">-- invalid field notation, function 'add_comm_group.neg' does not have explicit argument with type (add_comm_group ...)</span>
</code></pre></div>
<p>I've run out of ideas about how to proceed at this point. Any suggestions?</p>
<p>Thanks,</p>
<p>Christopher</p>



<a name="265623160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265623160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265623160">(Dec 20 2021 at 22:25)</a>:</h4>
<p>Can you post a MWE of your original question with everything other than the neg and add_left_neg thrown in? My guess is that you can just define <code>neg x</code> to be <code>(-1) \bub x</code>. I'm just a bit confused about what the question is though, because if alpha is an add_comm_group then you already have neg. This is why I'm asking for something where I can see exactly what is being assumed.</p>



<a name="265623707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265623707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265623707">(Dec 20 2021 at 22:32)</a>:</h4>
<p>Trying to do that... but now <code>left_distrib</code> has stopped working. I'm sure  it was working earlier. I must have changed something, but I can't figure out what.</p>



<a name="265623859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265623859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265623859">(Dec 20 2021 at 22:34)</a>:</h4>
<p>Maybe post what you have with sorried problems? But just one piece of code rather than all the fragments above.</p>



<a name="265623959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265623959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265623959">(Dec 20 2021 at 22:35)</a>:</h4>
<p>I did try defining <code>neg</code> as you suggest, but got in a hopeless tangle trying to prove <code>add_left_neg</code>.</p>



<a name="265624185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265624185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265624185">(Dec 20 2021 at 22:38)</a>:</h4>
<p>This is the best I can do at the moment:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.ring.basic</span>
<span class="kn">import</span> <span class="n">algebra.lie.of_associative</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kd">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>

<span class="sd">/-- A not-necessarily-unital, not-necessarily-associative ring. -/</span>
<span class="kd">@[protect_proj, ancestor add_comm_group non_unital_non_assoc_semiring ]</span>
<span class="kd">class</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kd">extends</span>
  <span class="n">add_comm_group</span> <span class="n">α</span><span class="o">,</span> <span class="n">non_unital_non_assoc_semiring</span> <span class="n">α</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">def</span> <span class="n">sym_alg</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="n">α</span>

<span class="kd">postfix</span> <span class="bp">`ˢʸᵐ`</span><span class="o">:</span><span class="n">std.prec.max_plus</span> <span class="o">:=</span> <span class="n">sym_alg</span>

<span class="kn">namespace</span> <span class="n">sym_alg</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="sd">/-- The element of `sym_alg α` that represents `a : α`. -/</span>
<span class="kd">@[pp_nodot]</span>
<span class="kd">def</span> <span class="n">sym</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="n">id</span>

<span class="sd">/-- The element of `α` represented by `x : αᵐᵒᵖ`. -/</span>
<span class="kd">@[pp_nodot]</span>
<span class="kd">def</span> <span class="n">unsym</span> <span class="o">:</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">id</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">unsym_sym</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">unsym</span> <span class="o">(</span><span class="n">sym</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">sym_unsym</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">sym</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">rfl</span>


<span class="kd">instance</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_add</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">unsym</span> <span class="n">b</span><span class="o">)</span> <span class="o">}</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">sym_add</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">sym</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">sym</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">sym</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">unsym_add</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:</span> <span class="n">unsym</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">unsym</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">unsym</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">rfl</span>


<span class="kd">instance</span> <span class="o">[</span><span class="n">has_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span> <span class="bp">-</span><span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">))</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_scalar</span> <span class="n">R</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">R</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="n">r</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">))</span>
<span class="o">}</span>


<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">sym_smul</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_scalar</span> <span class="n">R</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">sym</span> <span class="o">(</span><span class="n">c</span> <span class="bp">•</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">•</span> <span class="n">sym</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">add_smul</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">):</span> <span class="o">(</span><span class="n">r</span><span class="bp">+</span><span class="n">s</span><span class="o">)</span><span class="bp">•</span><span class="n">a</span> <span class="bp">=</span> <span class="o">(</span><span class="n">r</span><span class="bp">•</span><span class="n">a</span> <span class="bp">+</span><span class="n">s</span><span class="bp">•</span><span class="n">a</span><span class="o">)</span>   <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">unfold</span> <span class="n">algebra.smul_def'</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">add_mul</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">map_add</span><span class="o">,</span> <span class="n">ring_hom.to_fun_eq_coe</span><span class="o">],</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">smul_add'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">):</span> <span class="n">r</span><span class="bp">•</span><span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span><span class="bp">•</span><span class="n">a</span> <span class="bp">+</span> <span class="n">r</span><span class="bp">•</span><span class="n">b</span>   <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">unfold</span> <span class="n">algebra.smul_def'</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">mul_add</span><span class="o">,</span>
<span class="kd">end</span>


<span class="kd">instance</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_assoc</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_zero</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span> <span class="bp">-</span><span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">)),</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_left_neg</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
<span class="o">}</span>


<span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_assoc</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_zero</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="n">sym</span> <span class="o">((</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)))),</span>
  <span class="n">zero_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">mul_zero</span> <span class="o">:=</span>  <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">right_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
<span class="o">}</span>



<span class="kd">end</span> <span class="n">sym_alg</span>
</code></pre></div>



<a name="265625581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265625581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265625581">(Dec 20 2021 at 22:54)</a>:</h4>
<p>This is awful, but it seems to work (assuming <code>ring</code> rather than <code>semiring</code>).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_assoc</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_zero</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="bp">-</span><span class="n">a</span><span class="o">,</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_left_neg</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="n">sym</span> <span class="o">((</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)))),</span>
  <span class="n">zero_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">mul_zero</span> <span class="o">:=</span>  <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">change</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">))</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span> <span class="bp">=</span>
      <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">],</span>
    <span class="n">abel</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">right_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">change</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">((</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">))</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)))</span> <span class="bp">=</span>
      <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">],</span>
    <span class="n">abel</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
<span class="o">}</span>
</code></pre></div>



<a name="265625670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265625670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265625670">(Dec 20 2021 at 22:55)</a>:</h4>
<p>My guess is that a semiring which is an \R-algebra is a ring</p>



<a name="265625808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265625808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265625808">(Dec 20 2021 at 22:57)</a>:</h4>
<p>Yes, that's true. We have <code>module.add_comm_monoid_to_add_comm_group</code>, but how to use it?</p>



<a name="265626350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265626350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265626350">(Dec 20 2021 at 23:02)</a>:</h4>
<p>Here's one way:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_assoc</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">zero_add</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">add_zero</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">),</span>
  <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">),</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span>
  <span class="k">calc</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">one_smul</span>
    <span class="bp">...</span> <span class="bp">=</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span><span class="bp">•</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">_root_.add_smul</span>
    <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">neg_add_self</span>
    <span class="bp">...</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">zero_smul</span><span class="o">,</span>
  <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="n">sym</span> <span class="o">((</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)))),</span>
  <span class="n">zero_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">mul_zero</span> <span class="o">:=</span>  <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">change</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">))</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span> <span class="bp">=</span>
      <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">],</span>
    <span class="n">abel</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">right_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">change</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">((</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">))</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)))</span> <span class="bp">=</span>
      <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">b</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_add</span><span class="o">],</span>
    <span class="n">abel</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
<span class="o">}</span>
</code></pre></div>



<a name="265626728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265626728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265626728">(Dec 20 2021 at 23:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="373192">Christopher Hoskin</span> <a href="#narrow/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra/near/265625808">said</a>:</p>
<blockquote>
<p>Yes, that's true. We have <code>module.add_comm_monoid_to_add_comm_group</code>, but how to use it?</p>
</blockquote>
<p>I can't help feeling this is an <a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a> problem - why do you want this vs the</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">non_unital_non_assoc_ring</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span>
</code></pre></div>
<p>instance that was suggested above?</p>



<a name="265627086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265627086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265627086">(Dec 20 2021 at 23:11)</a>:</h4>
<p>One advantage to assuming <code>[ring α] [algebra ℝ α]</code> (which isn't weaker, since it is implied by <code>[semiring α] [algebra ℝ α]</code>) is that negation on <code>αˢʸᵐ</code> is defeq to negation on <code>α</code>.</p>



<a name="265627202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265627202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265627202">(Dec 20 2021 at 23:12)</a>:</h4>
<p><code>[ring α]</code> is fine with me - it's a more natural way of thinking about it. I just couldn't get it to work before, but <span class="user-mention" data-user-id="253861">@Thomas Browning</span>  has shown that it can be done. Thanks!</p>



<a name="265627506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/265627506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#265627506">(Dec 20 2021 at 23:16)</a>:</h4>
<p>I'd also recommend starting with:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">zero</span> <span class="o">:=</span> <span class="n">sym</span> <span class="mi">0</span> <span class="o">}</span>
<span class="kd">instance</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_add</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">unsym</span> <span class="n">b</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">instance</span> <span class="o">[</span><span class="n">has_sub</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_sub</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">sub</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span> <span class="bp">-</span> <span class="n">unsym</span> <span class="n">b</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">instance</span> <span class="o">[</span><span class="n">has_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="bp">-</span><span class="n">unsym</span> <span class="n">a</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">instance</span> <span class="o">[</span><span class="n">has_scalar</span> <span class="n">R</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">R</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">a</span><span class="o">,</span> <span class="n">sym</span> <span class="o">(</span><span class="n">r</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span> <span class="n">a</span><span class="o">))</span> <span class="o">}</span>

<span class="c1">-- add all the `sym_add` etc lemmas you already have here</span>

<span class="kd">lemma</span> <span class="n">unsym_injective</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="bp">@</span><span class="n">unsym</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">id</span>

<span class="c1">-- build up all the proof structures:</span>
<span class="kd">instance</span> <span class="o">[</span><span class="n">add_comm_semigroup</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_semigroup</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">unsym_injective.add_comm_semigroup</span> <span class="n">_</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_monoid</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">unsym_injective.add_monoid_smul</span> <span class="n">_</span> <span class="n">rfl</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">add_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_group</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">unsym_injective.add_group_smul</span> <span class="n">_</span> <span class="n">rfl</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..</span><span class="n">sym_alg.add_comm_semigroup</span><span class="o">,</span> <span class="bp">..</span><span class="n">sym_alg.add_monoid</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..</span><span class="n">sym_alg.add_comm_monoid</span><span class="o">,</span> <span class="bp">..</span><span class="n">sym_alg.add_group</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span> <span class="o">:=</span>
<span class="n">function.injective.module</span> <span class="n">R</span> <span class="o">⟨</span><span class="n">unsym</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)</span>
</code></pre></div>
<p>This will avoid ugly instance diamonds later, and also means you don't need your own <code>add_smul</code> and <code>smul_add'</code> lemmas.</p>



<a name="266101454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266101454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266101454">(Dec 26 2021 at 09:44)</a>:</h4>
<p>Thanks. I'm now stuck trying to show that the squares of both multiplications coincide (up to identification):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">powers</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:</span> <span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">unsym</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">unsym</span> <span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">change</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">•</span><span class="o">(</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">+</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">))</span> <span class="bp">=</span> <span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="bp">*</span><span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="o">),</span>
      <span class="n">abel</span><span class="o">,</span>
      <span class="c1">--rw smul_smul,</span>
      <span class="n">unfold</span> <span class="n">algebra.smul_def'</span><span class="o">,</span>
      <span class="n">rw</span> <span class="bp">←</span> <span class="n">mul_assoc</span><span class="o">,</span>
      <span class="c1">--rw ← map_mul,</span>
      <span class="c1">--rw ← algebra.to_ring_hom.map_mul' (1/2:ℝ) (2:ℤ),</span>
      <span class="c1">--rw ← (algebra_map ℝ α).map_mul' (1/2:ℝ) (2:ℤ),</span>
      <span class="c1">--rw ← mul_hom.map_mul' algebra.to_ring_hom,</span>
      <span class="c1">--rw ← map_mul algebra.to_ring_hom.to_fun (1/2:ℝ) (2:ℤ),</span>
      <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>I get to</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">⊢</span> <span class="n">algebra.to_ring_hom.to_fun</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">*</span> <span class="n">algebra.to_ring_hom.to_fun</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">unsym</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">unsym</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">unsym</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">unsym</span> <span class="n">a</span>
</code></pre></div>
<p>But then can't find the correct incantation to bring the <code>2</code> and <code>1/2</code> together so that they cancel out.</p>
<p>Christopher</p>



<a name="266101869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266101869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266101869">(Dec 26 2021 at 09:55)</a>:</h4>
<p>At the point you introduced <code>to_fun</code> into the goal you made a wrong turn</p>



<a name="266106740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266106740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266106740">(Dec 26 2021 at 12:03)</a>:</h4>
<p>Yes, the problem is I don't know how to convert the (2:ℤ) that <code>abel</code> gives me into <code>(2:ℝ)</code> so that I can invoke <code>smul_smul</code>.</p>
<p>Okay:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test2</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span><span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">r</span><span class="bp">•</span><span class="o">(</span><span class="n">s</span><span class="bp">•</span><span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">r</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span><span class="bp">•</span><span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">smul_smul</span> <span class="n">r</span> <span class="n">s</span> <span class="n">a</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Fails:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test2</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">r</span><span class="bp">•</span><span class="o">(</span><span class="n">s</span><span class="bp">•</span><span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">r</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span><span class="bp">•</span><span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">smul_smul</span> <span class="n">r</span> <span class="n">s</span> <span class="n">a</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266106791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266106791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266106791">(Dec 26 2021 at 12:05)</a>:</h4>
<p><code>norm_cast</code>, <code>norm_num</code> or <a href="https://leanprover-community.github.io/mathlib_docs/find/int.cast_two">docs#int.cast_two</a> should all do the job.</p>



<a name="266107634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266107634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266107634">(Dec 26 2021 at 12:30)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/smul_assoc">docs#smul_assoc</a> should apply there</p>



<a name="266119888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266119888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266119888">(Dec 26 2021 at 18:00)</a>:</h4>
<p>Finally got there with:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">two_rmul</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span>  <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">•</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
   <span class="n">rw</span> <span class="o">[</span><span class="n">bit0</span><span class="o">,</span> <span class="n">add_smul</span><span class="o">,</span> <span class="n">one_smul</span><span class="o">],</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">powers</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span> <span class="n">α</span><span class="bp">ˢʸᵐ</span><span class="o">)</span> <span class="o">:</span> <span class="n">unsym</span><span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">unsym</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">unsym</span> <span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">mul_def</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">unsym_sym</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">two_rmul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">smul_assoc</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266130426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266130426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266130426">(Dec 26 2021 at 22:17)</a>:</h4>
<p>Isn't that first lemma just <a href="https://leanprover-community.github.io/mathlib_docs/find/two_smul">docs#two_smul</a>?</p>



<a name="266251312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266251312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266251312">(Dec 28 2021 at 11:16)</a>:</h4>
<p>Catching up on this thread (and the corresponding PR <a href="https://github.com/leanprover-community/mathlib/pull/11073">#11073</a>) I have a question: is there a Jordan equivalent of Poisson algebras? More precisely, is it ever necessary to be able to regard a type _simultaneously_ as a Jordan ring and an associative ring?</p>



<a name="266251469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Symmetrized%20product%20of%20a%20real%20algebra/near/266251469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Symmetrized.20product.20of.20a.20real.20algebra.html#266251469">(Dec 28 2021 at 11:19)</a>:</h4>
<p>I couldn't quite figure out what right compatibility between the two structures would be but if these structures do arise then the proposed setup might be awkward because both operations are trying to own <code>has_mul</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>