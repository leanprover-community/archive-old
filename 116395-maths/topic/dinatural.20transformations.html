---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/dinatural.20transformations.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html">dinatural transformations</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="255814186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255814186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255814186">(Oct 01 2021 at 22:07)</a>:</h4>
<p><span class="user-mention" data-user-id="432631">@fosco</span>, you may want to start here:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span>

<span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">app</span> <span class="o">:=</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
<span class="c">/-</span><span class="cm"> ... axioms ... -/</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255816830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255816830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255816830">(Oct 01 2021 at 22:31)</a>:</h4>
<p>ok, a very basic question.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">app</span> <span class="o">:=</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
  <span class="o">(</span><span class="n">dinaturality</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">⦃</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">⦄</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span><span class="o">),</span>
    <span class="n">F.map</span> <span class="o">(</span><span class="n">op</span> <span class="n">f</span><span class="o">,</span> <span class="mi">𝟙</span> <span class="n">X</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">X</span> <span class="bp">≫</span> <span class="n">G.map</span> <span class="o">(</span><span class="n">op</span> <span class="mi">𝟙</span> <span class="n">X</span><span class="o">,</span> <span class="n">f</span><span class="o">)</span> <span class="bp">=</span> <span class="n">F.map</span> <span class="o">(</span><span class="n">op</span> <span class="mi">𝟙</span> <span class="n">Y</span><span class="o">,</span><span class="n">f</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">Y</span> <span class="bp">≫</span> <span class="n">G</span> <span class="o">(</span><span class="n">op</span> <span class="n">f</span><span class="o">,</span> <span class="mi">𝟙</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>
</code></pre></div>
<p>this gives me an error,</p>
<div class="codehilite" data-code-language="type"><pre><span></span><code>  prod.mk (op f)
term
  op f
has type
  (X ⟶ Y)ᵒᵖ
but is expected to have type
  ?m_1.fst ⟶ ?m_2.fst
</code></pre></div>
<p>and this is telling me that I'm not building the morphism in C^op x C correctly. What is the correct syntax to refer to the morphism <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>f</mi><mo separator="true">,</mo><msub><mn>1</mn><mi>Y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(f, 1_Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">C^{op}\times C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>?</p>



<a name="255816912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255816912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255816912">(Oct 01 2021 at 22:32)</a>:</h4>
<p>(PS: it's night time for me in my timezone ;-) I'll get back at it tomorrow)</p>



<a name="255817011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817011">(Oct 01 2021 at 22:33)</a>:</h4>
<p>For a morphism, it should be <code>f.op</code>, I think.</p>



<a name="255817094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817094">(Oct 01 2021 at 22:34)</a>:</h4>
<p>Same error if I change to <code>f.op</code></p>



<a name="255817125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817125">(Oct 01 2021 at 22:34)</a>:</h4>
<p>Exactly the same?</p>



<a name="255817163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817163">(Oct 01 2021 at 22:35)</a>:</h4>
<p>Well, there is a second <code>op f</code></p>



<a name="255817182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817182">(Oct 01 2021 at 22:35)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">prod.mk</span> <span class="n">f.op</span>
<span class="n">term</span>
  <span class="n">f.op</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">op</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">op</span> <span class="n">X</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m_1.fst</span> <span class="bp">⟶</span> <span class="bp">?</span><span class="n">m_2.fst</span>
</code></pre></div>
<p>where is <code>?m_1</code> implicitly defined?</p>



<a name="255817244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817244">(Oct 01 2021 at 22:36)</a>:</h4>
<p>Aha I didn't read the whole error message. It is closer now, though!</p>



<a name="255817286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817286">(Oct 01 2021 at 22:36)</a>:</h4>
<p>Same error message, but <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> less mistake <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="255817329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817329">(Oct 01 2021 at 22:37)</a>:</h4>
<p>For these metavariables like <code>?m_1</code> (as far as I know) you just have to guess, so here probably it is the implicit source object argument of <code>F.map</code></p>



<a name="255817448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817448">(Oct 01 2021 at 22:38)</a>:</h4>
<p>is at least <code>(f,g)</code> the right way to define a morphism in a product category? Initially I thought I had to use angle brackets..</p>



<a name="255817461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817461">(Oct 01 2021 at 22:38)</a>:</h4>
<p>That is, I'm not sure if Lean is smart enough here to guess what objects <code>(f.op, 𝟙 X)</code> is meant to be a map between... you can tell it explicitly, but it's a bit inconvenient</p>



<a name="255817642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817642">(Oct 01 2021 at 22:40)</a>:</h4>
<p>how do you tell it explicitly?</p>



<a name="255817716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817716">(Oct 01 2021 at 22:41)</a>:</h4>
<p>Something like <code>(f.op, 𝟙 X) : (op Y, X) ⟶ (op X, X)</code> (if I got it right)</p>



<a name="255817736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817736">(Oct 01 2021 at 22:41)</a>:</h4>
<p>I'm not sure it will help, but it might</p>



<a name="255817851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817851">(Oct 01 2021 at 22:43)</a>:</h4>
<p>And where should  I specify this typing?</p>



<a name="255817890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255817890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255817890">(Oct 01 2021 at 22:43)</a>:</h4>
<p>I thought given the type of <code>f</code> there's a unique way to infer the type of <code>(f.op, 1 X)</code>...</p>



<a name="255818030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818030">(Oct 01 2021 at 22:45)</a>:</h4>
<p>It has a unique type in the sense that its type is known to be <code>prod blah blah</code> but in principle there could be various pairs of objects of <code>Cᵒᵖ × C</code> between which the type of maps is that specific type... which is a bit annoying.</p>



<a name="255818056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818056">(Oct 01 2021 at 22:45)</a>:</h4>
<p><code>F.map ((f.op, 𝟙 X) : (op Y, X) ⟶ (op X, X))</code></p>



<a name="255818134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818134">(Oct 01 2021 at 22:46)</a>:</h4>
<p>Based on <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.bifunctor.diagonal/src">src#category_theory.bifunctor.diagonal</a> it seems like this is what you're meant to write</p>



<a name="255818164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818164">(Oct 01 2021 at 22:46)</a>:</h4>
<p>Probably there should be something like <code>F.map_prod f g</code> to make this easier.</p>



<a name="255818279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818279">(Oct 01 2021 at 22:48)</a>:</h4>
<p>I see the file I linked above is from 2017 so maybe it already exists... but I looked there because it seemed like the logical place for it</p>



<a name="255818382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818382">(Oct 01 2021 at 22:49)</a>:</h4>
<div class="codehilite" data-code-language="import"><pre><span></span><code>open opposite

namespace category_theory

variables {C D : Type*} [category C] [category D]

structure dinat_trans (F G : Cᵒᵖ × C ⥤ D) :=
  (app : Π X, F.obj (op X, X) ⟶ G.obj (op X, X))
  (dinaturality : ∀ ⦃X Y : C⦄ (f : X ⟶ Y),
    F.map ((f.op, 𝟙 X) : (op Y, X) ⟶ (op X, X)) ≫ app X ≫ G.map (((𝟙 X).op, f) : (op X,X) ⟶ (op X,Y)) = F.map (((𝟙 Y).op, f) : (op Y,X) ⟶ (op Y,Y)) ≫ app Y ≫ G.map (f.op, 𝟙 Y) . obviously)

end category_theory
</code></pre></div>
<p>no errors!</p>



<a name="255818476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818476">(Oct 01 2021 at 22:50)</a>:</h4>
<p><span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> tomorrow, co/wedges!</p>



<a name="255818663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818663">(Oct 01 2021 at 22:52)</a>:</h4>
<p>Make sure in a <code> ``` </code> block that you start with a new line. Otherwise zulip swallows the first line and tries to interpret it as a language instruction for the code block.</p>



<a name="255818853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818853">(Oct 01 2021 at 22:55)</a>:</h4>
<p>This is slightly terser:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="c1">-- TODO move to category_theory.products.bifunctor, and make use of there</span>
<span class="sd">/-- A synonym for `F.map (f, g)`, helpful because Lean struggles to typecheck `(f, g)`. -/</span>
<span class="kd">def</span> <span class="n">functor.map_prod</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">×</span> <span class="n">D</span> <span class="bp">⥤</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span><span class="n">W</span> <span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">{</span><span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">⟶</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">F.obj</span> <span class="o">(</span><span class="n">W</span><span class="o">,</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">X</span><span class="o">,</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">F.map</span> <span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="n">g</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">app</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
<span class="o">(</span><span class="n">dinaturality</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">⦃</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">⦄</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span><span class="o">),</span>
  <span class="n">F.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">X</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span>
  <span class="n">F.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">Y</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>
<p>using Reid's <code>map_prod</code> suggestion.</p>



<a name="255818890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255818890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255818890">(Oct 01 2021 at 22:55)</a>:</h4>
<p>Note also that by writing <code>(𝟙 _)</code> I can avoid having to write <code>(𝟙 X).op</code>.</p>



<a name="255819021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255819021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255819021">(Oct 01 2021 at 22:57)</a>:</h4>
<p>(Note also Lean's style guide says no indenting for structure fields, and no long lines. :-)</p>



<a name="255853258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853258">(Oct 02 2021 at 08:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">constant_functor</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Y</span><span class="o">,</span> <span class="n">X</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Y</span> <span class="n">Y'</span> <span class="n">f</span><span class="o">,</span> <span class="mi">𝟙</span> <span class="n">X</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">def</span> <span class="n">promote_covariant</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Z</span><span class="o">,</span> <span class="n">F.obj</span> <span class="n">Z.snd</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Z</span> <span class="n">W</span> <span class="n">f</span><span class="o">,</span> <span class="n">F.map</span> <span class="n">f.snd</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">def</span> <span class="n">promote_contravariant</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Z</span><span class="o">,</span> <span class="n">F.obj</span> <span class="n">Z.fst</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">Z</span> <span class="n">W</span> <span class="n">f</span><span class="o">,</span> <span class="n">F.map</span> <span class="n">f.fst</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">def</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">promote_covariant</span> <span class="o">(</span><span class="n">constant_functor</span> <span class="n">X</span><span class="o">))</span> <span class="n">F</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">def</span> <span class="n">cowedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="n">F</span>  <span class="o">(</span><span class="n">promote_covariant</span> <span class="o">(</span><span class="n">constant_functor</span> <span class="n">X</span><span class="o">))</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>a few other definitions; I'm not sure <code>wedge</code> and <code>cowedge</code> are definitions though: they are _functions_ eating a functor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi><mo>→</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">F : C^{op}\times C \to D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> and an object of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>, and giving back the category of dinatural transformations between the two. So, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>t</mi><mo stretchy="false">(</mo><mi>F</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Dinat(F,G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">ina</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span> is a type! I'm not sure this is the best design choice.</p>



<a name="255853531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853531">(Oct 02 2021 at 08:33)</a>:</h4>
<p>I hope that <code>functor.const</code> exists already.</p>



<a name="255853628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853628">(Oct 02 2021 at 08:35)</a>:</h4>
<p>And <code>promote_covariant</code> should be something like <code>functor.snd ⋙ F</code></p>



<a name="255853651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853651">(Oct 02 2021 at 08:35)</a>:</h4>
<p>Sure. I am just trying to reinvent the wheel to get a grip on the basic defs <br>
(I should also have a look at <code>cone</code> and <code>cocone</code>...)</p>



<a name="255853819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853819">(Oct 02 2021 at 08:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255853628">said</a>:</p>
<blockquote>
<p>And <code>promote_covariant</code> should be something like <code>functor.snd ⋙ F</code></p>
</blockquote>
<p><code>unknown identifier 'category_theory.functor.snd'</code></p>



<a name="255853847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853847">(Oct 02 2021 at 08:39)</a>:</h4>
<p><del>Ooh, it's probably just <code>category_theory.snd</code>, sorry.</del> It is <code>category_theory.prod.snd</code></p>



<a name="255853855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853855">(Oct 02 2021 at 08:39)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.prod.snd">docs#category_theory.prod.snd</a></p>



<a name="255853867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255853867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255853867">(Oct 02 2021 at 08:39)</a>:</h4>
<p>Voila <span aria-label="this" class="emoji emoji-1f446" role="img" title="this">:this:</span></p>



<a name="255854003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854003">(Oct 02 2021 at 08:41)</a>:</h4>
<p>Now I see a complaint for <code>\ggg</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">functor.comp</span> <span class="n">prod.snd</span>
<span class="n">term</span>
  <span class="n">prod.snd</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">Π</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">)</span> <span class="o">[</span><span class="n">_inst_1</span> <span class="o">:</span> <span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">)</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">category</span> <span class="n">D</span><span class="o">],</span> <span class="n">C</span> <span class="bp">×</span> <span class="n">D</span> <span class="bp">⥤</span> <span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span>
        <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">(</span><span class="n">max</span> <span class="bp">?</span> <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">))</span>
        <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">(</span><span class="n">max</span> <span class="bp">?</span> <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">))</span>
        <span class="o">(</span><span class="n">max</span> <span class="bp">?</span> <span class="bp">?</span><span class="o">)</span>
        <span class="bp">?</span>
        <span class="bp">?</span>
        <span class="bp">?</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_4</span> <span class="bp">?</span> <span class="n">u_1</span> <span class="bp">?</span><span class="o">)</span>
</code></pre></div>



<a name="255854278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854278">(Oct 02 2021 at 08:46)</a>:</h4>
<p>Aah, <code>prod.snd</code> takes to arguments (namely the factors)</p>



<a name="255854284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854284">(Oct 02 2021 at 08:46)</a>:</h4>
<p>So <code>prod.snd _ _ ⋙ F</code> should work</p>



<a name="255854291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854291">(Oct 02 2021 at 08:46)</a>:</h4>
<p>perfect</p>



<a name="255854293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854293">(Oct 02 2021 at 08:46)</a>:</h4>
<p>Sorry, I should have tested my code before commenting</p>



<a name="255854327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854327">(Oct 02 2021 at 08:47)</a>:</h4>
<p>Nah, it's me, I should start from the beginning, be more systematic. Instead I am learning the syntax along the way.</p>



<a name="255854397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255854397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255854397">(Oct 02 2021 at 08:48)</a>:</h4>
<p>It's a lot more fun that way. I also jumped straight in (-;</p>



<a name="255859253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255859253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255859253">(Oct 02 2021 at 10:11)</a>:</h4>
<p>@fosco, I think your definition of <code>wedge</code> is on the wrong track. You don't want <code>D</code> as a parameter, but rather as a field of the <code>wedge</code>.</p>



<a name="255859363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255859363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255859363">(Oct 02 2021 at 10:13)</a>:</h4>
<p>You could write </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span>  <span class="o">:=</span> <span class="bp">\</span><span class="n">Sigma</span> <span class="n">X</span> <span class="o">:</span> <span class="n">D</span><span class="o">,</span> <span class="n">dinat_trans</span> <span class="bp">...</span> <span class="n">F</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>but better would be</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="bp">\</span><span class="n">a</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="bp">...</span> <span class="n">F</span><span class="o">)</span>
</code></pre></div>
<p>and then <code>instance (F) : category (wedge F) := ...</code></p>



<a name="255859617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255859617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255859617">(Oct 02 2021 at 10:16)</a>:</h4>
<p>(Probably before the <code>instance</code> you want to enter the <code>wedge</code> namespace and define <code>hom</code>, presumably as another structure.)</p>



<a name="255860931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255860931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255860931">(Oct 02 2021 at 10:37)</a>:</h4>
<p>I agree; also, <code>promote</code>s are redundant, lean figures out alone that the domain of the constant functor must be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">C^{op}\times C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>.</p>



<a name="255861204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861204">(Oct 02 2021 at 10:41)</a>:</h4>
<p>What is <code>hom</code>?</p>
<p>In fact, I would like to define the twisted arrow category of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>hom</mi><mo>⁡</mo></mrow><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">\hom_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mop"><span class="mop">hom</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</p>
<ul>
<li>objects : the morphisms of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li>
<li>morphisms <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>→</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">f \to g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> : the pairs <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>:</mo><mi>s</mi><mi>r</mi><mi>c</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>→</mo><mi>s</mi><mi>r</mi><mi>c</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>v</mi><mo>:</mo><mi>t</mi><mi>r</mi><mi>g</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>→</mo><mi>t</mi><mi>r</mi><mi>g</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u : src(g) \to src(f), v : trg(f) \to trg(g)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">src</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">src</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span> such that the obvious square commutes</li>
</ul>
<p>is this a <code>structure</code> that then I have to prove is a category? </p>
<p>Again, I am discovering the syntax along the way <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> be patient...</p>



<a name="255861284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861284">(Oct 02 2021 at 10:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>this seems to work (it only complains for the <code>sorry</code>)</p>



<a name="255861573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861573">(Oct 02 2021 at 10:47)</a>:</h4>
<p>Now I would love to have something similar to agda's <code>ctrl-R</code> to auto-generate the fields I have to fill (hom, id, comp)... wishful thinking?</p>



<a name="255861630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861630">(Oct 02 2021 at 10:48)</a>:</h4>
<p>Replace the sorry by an underscore, and if you're in vs code, a lightbulb should show up</p>



<a name="255861848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861848">(Oct 02 2021 at 10:52)</a>:</h4>
<p><code>Ctrl</code>-<code>.</code> will open the lightbulb menu. Then hit <code>&lt;Up&gt;</code>-<code>&lt;Up&gt;</code>-<code>&lt;Enter&gt;</code> and you will have your skeleton <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="255861918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255861918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255861918">(Oct 02 2021 at 10:53)</a>:</h4>
<p>I know very little as you can see! <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="255862210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255862210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255862210">(Oct 02 2021 at 10:58)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">constant_functor</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="n">F</span> <span class="o">(</span><span class="n">constant_functor</span> <span class="n">tip</span><span class="o">))</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>



<a name="255862503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255862503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255862503">(Oct 02 2021 at 11:03)</a>:</h4>
<p>Now for the twisted arrow category...</p>



<a name="255863354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863354">(Oct 02 2021 at 11:16)</a>:</h4>
<p>Hmmm, I am having a hard time again, figuring out how to define it</p>



<a name="255863547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863547">(Oct 02 2021 at 11:20)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">twisted</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">C.hom</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">id_comp'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">comp_id'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">assoc'</span> <span class="o">:=</span> <span class="n">_</span> <span class="o">}</span>
</code></pre></div>
<p>I would like to say: if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is a category, there is a category having objects the class of morphisms of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>, and morphisms the pairs <code>(u,v)</code> as above; I have two problems: first, I can't figure out where to put the information that the class of objects of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>w</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Tw(C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">Tw</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>hom</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hom(C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">hom</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>; second, I want just <em>some</em> pairs of morphisms (u,v): how does one consider just some pairs (u,v), subject to a certain condition?</p>



<a name="255863832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863832">(Oct 02 2021 at 11:25)</a>:</h4>
<p>Before you go too far: please use the existing <code>functor.const</code>, rather than rolling your own.</p>



<a name="255863908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863908">(Oct 02 2021 at 11:26)</a>:</h4>
<p>In <code>wedge</code>, I'd suggest for now calling <code>tip</code> instead <code>X</code>. It's not great, but it will be consistent with the terminology for <code>cone</code> and <code>cocone</code>. If you feel strongly about it, we can make a PR to update <code>cone</code> and <code>cocone</code> later. :-)</p>



<a name="255863954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863954">(Oct 02 2021 at 11:27)</a>:</h4>
<p>I'm confused. Your category instances for <code>wedge</code> and <code>cowedge</code> are wrong. The morphisms aren't just morphisms between the tips, but morphisms satisfying some condition.</p>



<a name="255863962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863962">(Oct 02 2021 at 11:27)</a>:</h4>
<p>This is why you need to create a <code>structure wedge.hom := ...</code></p>



<a name="255863971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255863971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255863971">(Oct 02 2021 at 11:27)</a>:</h4>
<p>Which will carry the morphism and this condition. See how this is implemented for <code>comma</code> or <code>cone</code>.</p>



<a name="255864064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864064">(Oct 02 2021 at 11:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255863832">said</a>:</p>
<blockquote>
<p>Before you go too far: please use the existing <code>functor.const</code>, rather than rolling your own.</p>
</blockquote>
<p>Replacing <code>constant_functor</code> with <code>functor.const</code> doesn't work...</p>



<a name="255864077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864077">(Oct 02 2021 at 11:29)</a>:</h4>
<p>Let's see: <a href="https://leanprover-community.github.io/mathlib_docs/find/functor.const/src">src#functor.const</a>.</p>



<a name="255864122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864122">(Oct 02 2021 at 11:30)</a>:</h4>
<p>Nope, that's wrong.</p>



<a name="255864124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864124">(Oct 02 2021 at 11:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255863954">said</a>:</p>
<blockquote>
<p>I'm confused. Your category instances for <code>wedge</code> and <code>cowedge</code> are wrong. The morphisms aren't just morphisms between the tips, but morphisms satisfying some condition.</p>
</blockquote>
<p>Indeed: because I don't know how to specify a condition that the morphisms have to satisfy. I'll look into <code>cone</code></p>



<a name="255864126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864126">(Oct 02 2021 at 11:30)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.functor.const/src">src#category_theory.functor.const</a></p>



<a name="255864149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864149">(Oct 02 2021 at 11:30)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">functor.const</span> <span class="n">tip</span>
<span class="n">term</span>
  <span class="n">tip</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="bp">?</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">)</span>
</code></pre></div>



<a name="255864162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864162">(Oct 02 2021 at 11:31)</a>:</h4>
<p>There's <code>functor.const</code> for you. You'll have to <code>import category_theory.const</code> to get it. Note that it is set up to be functorial, so you'll need to see how it is used.</p>



<a name="255864177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864177">(Oct 02 2021 at 11:31)</a>:</h4>
<p>Read the module doc-string in the link I just gave you to see how to use <code>functor.const</code>.</p>



<a name="255864228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864228">(Oct 02 2021 at 11:32)</a>:</h4>
<p>(Later you will be happy that <code>functor.const</code> is functorial in the constant. :-)</p>



<a name="255864248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864248">(Oct 02 2021 at 11:32)</a>:</h4>
<p>(The doc-string for <code>functor.const</code> could be more helpful, I see. At least the module doc-string explains it.)</p>



<a name="255864285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864285">(Oct 02 2021 at 11:33)</a>:</h4>
<p>it seems to me that this should work</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">functor.const</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>
</code></pre></div>
<p>but it doesn't</p>



<a name="255864391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864391">(Oct 02 2021 at 11:35)</a>:</h4>
<p>As I've been saying in the message above, <code>functor.const</code> takes more arguments than you are giving it.</p>



<a name="255864408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864408">(Oct 02 2021 at 11:35)</a>:</h4>
<p>(Because it is set up to be functorial.)</p>



<a name="255864425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864425">(Oct 02 2021 at 11:35)</a>:</h4>
<p>To see how to set up <code>wedge.hom</code> you should look at <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.limits.cone_morphism/src">src#category_theory.limits.cone_morphism</a>.</p>



<a name="255864504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864504">(Oct 02 2021 at 11:37)</a>:</h4>
<p>You probably just need <code>(functor.const _).obj tip</code></p>



<a name="255864535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864535">(Oct 02 2021 at 11:37)</a>:</h4>
<p>(And if you write <code>open functor</code> higher up in your file you can just write <code>const</code>, rather than <code>functor.const</code>.</p>



<a name="255864641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864641">(Oct 02 2021 at 11:39)</a>:</h4>
<p>Error messages of the form</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">functor.const</span> <span class="n">tip</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="bp">?</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="bp">?+</span><span class="mi">1</span><span class="o">)</span>
</code></pre></div>
<p>are super useful, and worth learning how to interpret. It's saying that that first argument of <code>functor.const</code> is not an object of a category, but actually a type.</p>



<a name="255864660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864660">(Oct 02 2021 at 11:39)</a>:</h4>
<p>It is expecting to be given the name of the "source category" for the constant functor that you want.</p>



<a name="255864749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864749">(Oct 02 2021 at 11:40)</a>:</h4>
<p>Notice in your earlier <code>constant_functor</code> the source category was an "implicit" argument (i.e. given via curly braces { }). This means you can leave them out, but Lean has to be able to guess the correct value from context. That's not always a good idea, so the mathlib version <code>functor.const</code> has to be told the source category "explicitly".</p>



<a name="255864777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864777">(Oct 02 2021 at 11:41)</a>:</h4>
<p>so, <code>const (domain) (object)</code> ?</p>



<a name="255864782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864782">(Oct 02 2021 at 11:41)</a>:</h4>
<p>The next difference is that <code>functor.const C</code> doesn't just take an object of <code>D</code> and spit out a functor <code>C \func D</code>. It is actually giving you a functor from <code>C</code> to <code>C \func D</code>.</p>



<a name="255864793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864793">(Oct 02 2021 at 11:41)</a>:</h4>
<p>Hence we have to write <code>(const domain).obj object</code> to apply it to an object.</p>



<a name="255864844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864844">(Oct 02 2021 at 11:42)</a>:</h4>
<p>(You could write <code>(const domain).map morphism</code> to apply it to a morphism (obtaining, of course, the identity morphism on your chosen constant.)</p>



<a name="255864897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255864897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255864897">(Oct 02 2021 at 11:43)</a>:</h4>
<p>Eventually you need all these functoriality statements (even if automation takes care of plugging them in at the right places), so we tend to package them all up at the beginning, rather than thinking of them as separate constructions.</p>



<a name="255865140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865140">(Oct 02 2021 at 11:47)</a>:</h4>
<p>I'm starting to understand, but I am still confused</p>
<ol>
<li>How can I possibly know how many arguments, and in what order, are needed by <code>const</code>, looking at its type here?</li>
</ol>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">const</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="o">(</span><span class="n">J</span> <span class="bp">⥤</span> <span class="n">C</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">X</span><span class="o">,</span>
    <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">j</span> <span class="n">j'</span> <span class="n">f</span><span class="o">,</span> <span class="mi">𝟙</span> <span class="n">X</span> <span class="o">},</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">f</span><span class="o">,</span> <span class="o">{</span> <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="o">}</span> <span class="o">}</span>
</code></pre></div>
<ol start="2">
<li>I understand that this <code>const</code> gives a functor from <code>C</code> to  <code>C \func D</code>, which is different from what I defined. Yet, <code>const (Cᵒᵖ × C) tip</code> gives the same type mismatch.</li>
</ol>



<a name="255865157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865157">(Oct 02 2021 at 11:47)</a>:</h4>
<p>Note that functors are not functions!</p>



<a name="255865211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865211">(Oct 02 2021 at 11:48)</a>:</h4>
<p>If <code>F : C ⥤ D</code>, and <code>X : C</code>, you can't just write <code>F X</code>.</p>



<a name="255865217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865217">(Oct 02 2021 at 11:48)</a>:</h4>
<p>You need to write <code>F.obj X</code>.</p>



<a name="255865231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865231">(Oct 02 2021 at 11:48)</a>:</h4>
<p>So you need to write <code>(const (Cᵒᵖ × C)).obj tip</code></p>



<a name="255865250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865250">(Oct 02 2021 at 11:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255865231">said</a>:</p>
<blockquote>
<p>So you need to write <code>(const (Cᵒᵖ × C)).obj tip</code></p>
</blockquote>
<p>Doesn't work! I tried.</p>



<a name="255865258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865258">(Oct 02 2021 at 11:49)</a>:</h4>
<p>Show me the error message?</p>



<a name="255865263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865263">(Oct 02 2021 at 11:49)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="n">field</span> <span class="kd">notation</span><span class="o">,</span> <span class="n">type</span> <span class="n">is</span> <span class="n">not</span> <span class="n">of</span> <span class="n">the</span> <span class="n">form</span> <span class="o">(</span><span class="n">C</span> <span class="bp">...</span><span class="o">)</span> <span class="n">where</span> <span class="n">C</span> <span class="n">is</span> <span class="n">a</span> <span class="kd">constant</span>
  <span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">)</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="bp">?</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u_1</span>
</code></pre></div>



<a name="255865266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865266">(Oct 02 2021 at 11:49)</a>:</h4>
<p>Might need to post the <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>.</p>



<a name="255865279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865279">(Oct 02 2021 at 11:49)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">((</span><span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>
</code></pre></div>



<a name="255865289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865289">(Oct 02 2021 at 11:49)</a>:</h4>
<p>Are you sure this <code>const</code> is <code>category_theory.functor.const</code>?</p>



<a name="255865339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865339">(Oct 02 2021 at 11:50)</a>:</h4>
<p>(i.e. if you right-click on it and go-to-definition you land in the right place)</p>



<a name="255865366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865366">(Oct 02 2021 at 11:50)</a>:</h4>
<p>It's possible you're seeing some other <code>const</code>, because I don't think it should have type <code>Type ? → Type u_1</code>.</p>



<a name="255865375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865375">(Oct 02 2021 at 11:51)</a>:</h4>
<p>Maybe you can post your whole file?</p>



<a name="255865526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865526">(Oct 02 2021 at 11:53)</a>:</h4>
<p>Sorry to derail you by suggesting using <code>functor.const</code> instead of your own. In the long run it will pay off but I appreciate it is annoying now. :-)</p>



<a name="255865586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865586">(Oct 02 2021 at 11:54)</a>:</h4>
<p>Now it works, if I write <code>functor.const</code>; for some reason <code>open</code>ing <code>functor</code> at the beginning doesn't work</p>



<a name="255865602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865602">(Oct 02 2021 at 11:54)</a>:</h4>
<p>Here's the whole file anyway</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>

<span class="kn">open</span> <span class="n">opposite</span>
<span class="kn">open</span> <span class="n">functor</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">functor.map_prod</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">×</span> <span class="n">D</span> <span class="bp">⥤</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span><span class="n">W</span> <span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">{</span><span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">⟶</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">F.obj</span> <span class="o">(</span><span class="n">W</span><span class="o">,</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">X</span><span class="o">,</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">F.map</span> <span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="n">g</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">app</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
<span class="o">(</span><span class="n">dinaturality</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">⦃</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">⦄</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span><span class="o">),</span>
  <span class="n">F.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">X</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span>
  <span class="n">F.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">Y</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">wedge</span>

<span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">((</span><span class="n">functor.const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="n">F</span> <span class="o">((</span><span class="n">functor.const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">))</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>

<span class="c1">-- instance twisted : category (hom C) :=</span>
<span class="c1">--   { hom := _,</span>
<span class="c1">--   id := _,</span>
<span class="c1">--   comp := _,</span>
<span class="c1">--   id_comp' := _,</span>
<span class="c1">--   comp_id' := _,</span>
<span class="c1">--   assoc' := _ }</span>

<span class="kd">end</span> <span class="n">wedge</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255865627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865627">(Oct 02 2021 at 11:55)</a>:</h4>
<p>Ah --- did you <code>open functor</code> inside or outside the <code>namespace category_theory</code>?</p>



<a name="255865642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865642">(Oct 02 2021 at 11:55)</a>:</h4>
<p>outside</p>



<a name="255865667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865667">(Oct 02 2021 at 11:55)</a>:</h4>
<p>The problem is that the Haskell programmers put <code>functor</code> in the root namespace, to mean a type level functor like programmers like.</p>



<a name="255865712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865712">(Oct 02 2021 at 11:56)</a>:</h4>
<p>And the real <code>functor</code> is only in the <code>category_theory</code> namespace.</p>



<a name="255865720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865720">(Oct 02 2021 at 11:56)</a>:</h4>
<p>So you accidentally picked up the other one.</p>



<a name="255865741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865741">(Oct 02 2021 at 11:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255865667">said</a>:</p>
<blockquote>
<p>The problem is that the Haskell programmers put <code>functor</code> in the root namespace, to mean a type level functor like programmers like.</p>
</blockquote>
<p>It's always haskellers' fault <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="255865745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865745">(Oct 02 2021 at 11:56)</a>:</h4>
<p>I've been wanting to trying move the programmers' <code>functor</code> into a namespace, as <code>control.functor</code>.</p>



<a name="255865750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865750">(Oct 02 2021 at 11:56)</a>:</h4>
<p>But never did it.</p>



<a name="255865764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865764">(Oct 02 2021 at 11:57)</a>:</h4>
<p>Maybe I'll go investigate that again.</p>



<a name="255865776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865776">(Oct 02 2021 at 11:57)</a>:</h4>
<p>yet the same thing happens if I move the <code>open functor</code> inside the <code>category_theory</code> namespace</p>



<a name="255865792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865792">(Oct 02 2021 at 11:57)</a>:</h4>
<p>In any case, if you move the <code>open</code> inside, or write <code>open category_theory.functor</code>, you should be good.</p>



<a name="255865855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865855">(Oct 02 2021 at 11:58)</a>:</h4>
<p>yes, <code>open category_theory.functor</code> works.</p>



<a name="255865859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255865859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255865859">(Oct 02 2021 at 11:58)</a>:</h4>
<p>Whew!</p>



<a name="255866100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866100">(Oct 02 2021 at 12:01)</a>:</h4>
<p>Next up:<br>
 get rid of your <code>instance : category (wedge ...)</code>, and instead first define <code>structure wedge.hom (...) := ...</code></p>



<a name="255866421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866421">(Oct 02 2021 at 12:06)</a>:</h4>
<p>By the way one answer to "how do I figure out what inputs are implicit and what are explicit" is "just hover over the function definition and its type will pop up" and another is <code>#check @const</code></p>



<a name="255866457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866457">(Oct 02 2021 at 12:07)</a>:</h4>
<p>The complication here was that it wasn't either explicit or implicit: it was functorial.</p>



<a name="255866529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866529">(Oct 02 2021 at 12:08)</a>:</h4>
<p>Okay, well I'm off for now @fosco. Good luck. Reading some examples like arrow categories, comma categories, and categories of cones will be helpful for what you are doing next.</p>



<a name="255866601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866601">(Oct 02 2021 at 12:09)</a>:</h4>
<p>Thanks for your help!</p>



<a name="255866789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866789">(Oct 02 2021 at 12:12)</a>:</h4>
<p>This should be nearer to what you were suggesting:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">wedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">hom</span> <span class="bp">≫</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">hom</span> <span class="bp">=</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>



<a name="255866810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866810">(Oct 02 2021 at 12:13)</a>:</h4>
<p>(I added <code> [T : Cᵒᵖ × C ⥤ D]</code> among the variables)</p>



<a name="255866824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866824">(Oct 02 2021 at 12:13)</a>:</h4>
<p>Another thing you might want to try @fosco (if you didn't already) is doing Scott's problem sheet in LFTCM2020: clone <a href="https://github.com/leanprover-community/lftcm2020">https://github.com/leanprover-community/lftcm2020</a> with <code>leanproject get lftcm2020</code>, open the lftcm2020 folder with VS Code, make your way to <code>src/exercises_sources/thursday/category_theory/</code> and try filling in the <code>sorry</code>s. Beforehand you might want to watch <a href="https://www.youtube.com/watch?v=1NUc-ZNC_2s&amp;list=PLlF-CfQhukNlxexiNJErGJd2dte_J1t1N&amp;index=15">the accompanying video</a>.</p>
<div class="youtube-video message_inline_image"><a data-id="1NUc-ZNC_2s" href="https://www.youtube.com/watch?v=1NUc-ZNC_2s&amp;list=PLlF-CfQhukNlxexiNJErGJd2dte_J1t1N&amp;index=15"><img src="https://uploads.zulipusercontent.net/207274411a9f0cd4eff1782ce28ff06b0c90b91d/68747470733a2f2f692e7974696d672e636f6d2f76692f314e55632d5a4e435f32732f64656661756c742e6a7067"></a></div>



<a name="255866960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866960">(Oct 02 2021 at 12:15)</a>:</h4>
<p>I watched part of Scott's video <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> it motivated me to enter here.</p>



<a name="255866974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255866974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255866974">(Oct 02 2021 at 12:15)</a>:</h4>
<p>oh nice!</p>



<a name="255867021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867021">(Oct 02 2021 at 12:16)</a>:</h4>
<p>Excellent!</p>



<a name="255867031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867031">(Oct 02 2021 at 12:16)</a>:</h4>
<p>I'm glad that people can find their way to that stuff independently of being pointed there from here</p>



<a name="255867053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867053">(Oct 02 2021 at 12:17)</a>:</h4>
<p>Don't forgot to:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">restate_axiom</span> <span class="n">wedge_morphism.w'</span>     <span class="c1">-- this will make a copy called `w`, and clean up some mess `. obviously` leaves</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">wedge_morphism.w</span>
</code></pre></div>



<a name="255867087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867087">(Oct 02 2021 at 12:17)</a>:</h4>
<p>It's important as you build new structures that you simultaneously define <code>simp</code> lemmas which make use of the bundled axioms. If you do this right, you can avoid lots of boring proofs!</p>



<a name="255867150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867150">(Oct 02 2021 at 12:18)</a>:</h4>
<p>I feel I need a more systematic approach to understand this kind of subtlety.</p>



<a name="255867182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867182">(Oct 02 2021 at 12:19)</a>:</h4>
<p>Hmm... before we go there. I don't think</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="n">eq_to_hom</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">g</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>
<p>can possibly be working.</p>



<a name="255867213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867213">(Oct 02 2021 at 12:19)</a>:</h4>
<p>Because <code>id</code> and <code>comp</code> should be constructing new <code>wedge_morphism</code>s.</p>



<a name="255867279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867279">(Oct 02 2021 at 12:20)</a>:</h4>
<p>After all, you need to check the condition holds for the composition of two wedge morphisms, using the conditions for the two wedge morphisms!</p>



<a name="255867293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867293">(Oct 02 2021 at 12:20)</a>:</h4>
<p>(Or rather, we hope that we don't need to check this, but that Lean will check it for us.)</p>



<a name="255867301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867301">(Oct 02 2021 at 12:20)</a>:</h4>
<p>uh, probably they were auto-filled <code>sorry</code>s; the problem though is earlier</p>



<a name="255867305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867305">(Oct 02 2021 at 12:20)</a>:</h4>
<p>in the definition of hom</p>



<a name="255867335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867335">(Oct 02 2021 at 12:21)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">synthesized</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">is</span> <span class="n">not</span> <span class="n">definitionally</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">expression</span> <span class="n">inferred</span> <span class="kd">by</span> <span class="n">typing</span> <span class="n">rules</span><span class="o">,</span> <span class="n">synthesized</span>
  <span class="bp">⁇</span>
<span class="n">inferred</span>
  <span class="n">F</span>
</code></pre></div>



<a name="255867349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867349">(Oct 02 2021 at 12:21)</a>:</h4>
<p>I just copied from the definition of <code>cone_category</code></p>



<a name="255867427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867427">(Oct 02 2021 at 12:22)</a>:</h4>
<p>Hrmm... we need to sort that out first.</p>



<a name="255867458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867458">(Oct 02 2021 at 12:23)</a>:</h4>
<p>Now, you said above that you introduced <code>T</code> as a variable, but you put it in square brackets. That was wrong -- square brackets are only for typeclasses.</p>



<a name="255867525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867525">(Oct 02 2021 at 12:24)</a>:</h4>
<p>(A good rule of thumb, by the way, is to always fix the first error in the file first, and to not proceed past errors! <code>sorry</code> is okay, but an error higher up can really obscure what's going on.)</p>



<a name="255867600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867600">(Oct 02 2021 at 12:25)</a>:</h4>
<p>Changing the square brackets to <code>{ }</code> on <code>T</code> will give you the correct error message now.</p>



<a name="255867694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867694">(Oct 02 2021 at 12:26)</a>:</h4>
<p>So you want something more like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">wedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">hom</span> <span class="bp">≫</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩,</span> <span class="o">}</span>
</code></pre></div>
<p>This still has an error, but notice that in the <code>id</code> field we didn't need to provide the proof of <code>w'</code>! Hooray, Lean did it for us.</p>



<a name="255867705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867705">(Oct 02 2021 at 12:27)</a>:</h4>
<p>However in the <code>comp</code> field Lean complains that it can't prove <code>w'</code>.</p>



<a name="255867732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867732">(Oct 02 2021 at 12:27)</a>:</h4>
<p>But if you add</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">restate_axiom</span> <span class="n">wedge_morphism.w'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">wedge_morphism.w</span>
</code></pre></div>
<p>then that error goes away too! Hooray!</p>



<a name="255867805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867805">(Oct 02 2021 at 12:28)</a>:</h4>
<p>But there are still more errors: the <code>id</code> and <code>comp</code> fields both typecheck, but there's an error on the <code>{</code> of the <code>instance</code>. If you read the messages, you'll see that it's failing to prove the <code>comp_id'</code> <code>id_comp'</code> and <code>assoc'</code> fields of <code>category</code>.</p>



<a name="255867828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867828">(Oct 02 2021 at 12:29)</a>:</h4>
<p>The reason here is that we haven't explained to Lean how one checks that two <code>wedge_morphism</code>s are equal: you check that their <code>hom</code>s are equal!</p>



<a name="255867905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867905">(Oct 02 2021 at 12:30)</a>:</h4>
<p>So we add</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">wedge_morphis.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>



<a name="255867936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867936">(Oct 02 2021 at 12:31)</a>:</h4>
<p>The <code>@[ext]</code> annotation here says: "if automation is trying to prove things are equal by the strategy of proving they are equal "componentwise" in some sense, try using this lemma!"</p>



<a name="255867946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867946">(Oct 02 2021 at 12:31)</a>:</h4>
<p>After this,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩,</span> <span class="o">}</span>
</code></pre></div>
<p>compiles with no errors.</p>



<a name="255867959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255867959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255867959">(Oct 02 2021 at 12:31)</a>:</h4>
<p>Okay, but now I am really leaving for the night. :-) Have fun.</p>



<a name="255868014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255868014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255868014">(Oct 02 2021 at 12:32)</a>:</h4>
<p>:-) sure, I will.</p>
<p>Thanks again</p>



<a name="255870964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255870964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255870964">(Oct 02 2021 at 13:21)</a>:</h4>
<p>the same solution, for cowedges, does not work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">wedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">cowedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>



<a name="255871077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255871077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255871077">(Oct 02 2021 at 13:23)</a>:</h4>
<p>There is an unsolved goal showing that the composition of the hom parts of is a cowedge; something I would easily prove with a couple of <code>cong</code>s in agda, but here I have no idea how to move</p>



<a name="255871087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255871087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255871087">(Oct 02 2021 at 13:23)</a>:</h4>
<p>...I guess I should move to simpler exercises.</p>



<a name="255871330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255871330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255871330">(Oct 02 2021 at 13:27)</a>:</h4>
<p>Can you paste everything you have so far as a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>? I'm only half-watching this thread and so I'm missing all the imports/opens etc, but I can try to help.</p>



<a name="255872029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872029">(Oct 02 2021 at 13:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kn">open</span> <span class="n">category_theory.functor</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">functor.map_prod</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">×</span> <span class="n">D</span> <span class="bp">⥤</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span><span class="n">W</span> <span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">{</span><span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">⟶</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">F.obj</span> <span class="o">(</span><span class="n">W</span><span class="o">,</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">X</span><span class="o">,</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">F.map</span> <span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="n">g</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">app</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
<span class="o">(</span><span class="n">dinaturality</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">⦃</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">⦄</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span><span class="o">),</span>
  <span class="n">F.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">X</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span>
  <span class="n">F.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">Y</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">((</span><span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="n">F</span> <span class="o">((</span><span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">))</span>


<span class="kd">variables</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">wedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">hom</span> <span class="bp">≫</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">hom</span> <span class="bp">=</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="n">restate_axiom</span> <span class="n">wedge_morphism.w'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">wedge_morphism.w</span>

<span class="n">restate_axiom</span> <span class="n">cowedge_morphism.w'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">cowedge_morphism.w</span>

<span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">wedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">cowedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩</span> <span class="o">}</span>

<span class="c1">-- instance twisted : category (hom C) :=</span>
<span class="c1">--   { hom := _,</span>
<span class="c1">--   id := _,</span>
<span class="c1">--   comp := _,</span>
<span class="c1">--   id_comp' := _,</span>
<span class="c1">--   comp_id' := _,</span>
<span class="c1">--   assoc' := _ }</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255872066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872066">(Oct 02 2021 at 13:39)</a>:</h4>
<p>So if I click just before the red underline then I see that the goal is </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">⊢</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">),</span> <span class="n">X.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span> <span class="bp">=</span> <span class="n">Z.α.app</span> <span class="n">j</span>
</code></pre></div>



<a name="255872184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872184">(Oct 02 2021 at 13:41)</a>:</h4>
<p>so in the definition of composition of morphisms in this cowedge category, so far you have said "let X, Y, Z be objects of <code>cowedge F</code> and say <code>f : X -&gt; Y</code> and <code>g : Y -&gt; Z</code> are morphisms." We now want to define a morphism from X to Z and right now to do that Lean's understanding is that you need to prove (some statement about a diagram commuting)</p>



<a name="255872276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872276">(Oct 02 2021 at 13:43)</a>:</h4>
<p>which looks odd to me</p>



<a name="255872365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872365">(Oct 02 2021 at 13:44)</a>:</h4>
<p>oh this looks like w'</p>



<a name="255872423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872423">(Oct 02 2021 at 13:45)</a>:</h4>
<p>oh, so Lean is complaining that it can't prove w'</p>



<a name="255872486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872486">(Oct 02 2021 at 13:46)</a>:</h4>
<p>automation is failing to do your diagram chase</p>



<a name="255872496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872496">(Oct 02 2021 at 13:46)</a>:</h4>
<p>Is it true?</p>



<a name="255872535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872535">(Oct 02 2021 at 13:47)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">j</span><span class="o">,</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>
<p>gives you the goal</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span>
<span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">F</span>
<span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span>
<span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span>
<span class="n">j</span> <span class="o">:</span> <span class="n">C</span>
<span class="bp">⊢</span> <span class="n">X.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span> <span class="bp">=</span> <span class="n">Z.α.app</span> <span class="n">j</span>
</code></pre></div>
<p>Is that goal true?</p>



<a name="255872844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872844">(Oct 02 2021 at 13:52)</a>:</h4>
<p>yeah I can prove it</p>



<a name="255872961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255872961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255872961">(Oct 02 2021 at 13:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">f</span> <span class="k">with</span> <span class="n">f_hom</span> <span class="n">f_w</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">g</span> <span class="k">with</span> <span class="n">g_hom</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">f_w</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">g_w</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">g_w</span><span class="o">,</span> <span class="bp">←</span> <span class="n">f_w</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>



<a name="255873025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873025">(Oct 02 2021 at 13:55)</a>:</h4>
<p>Scott's <code>obviously</code> tactic seems to find the analogous proof for <code>wedge F</code> but not for this one. I have no idea how the automation works but there's a hand-constructed proof. It might be the case that with some more magic you can get Lean to find this proof itself</p>



<a name="255873118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873118">(Oct 02 2021 at 13:57)</a>:</h4>
<p>and here's what the proof looked like before I golfed it (so you can see my thought process):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">f</span> <span class="k">with</span> <span class="n">f_hom</span> <span class="n">f_w</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">g</span> <span class="k">with</span> <span class="n">g_hom</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">f_w</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">g_w</span> <span class="n">j</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">f_w</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">category.assoc</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>



<a name="255873196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873196">(Oct 02 2021 at 13:58)</a>:</h4>
<p>and after:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">cases</span> <span class="n">f</span> <span class="k">with</span> <span class="n">_</span> <span class="n">f_w</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">g</span> <span class="k">with</span> <span class="n">_</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">f_w</span> <span class="n">j</span><span class="o">,</span> <span class="bp">←</span> <span class="n">g_w</span> <span class="n">j</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>



<a name="255873352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873352">(Oct 02 2021 at 14:00)</a>:</h4>
<p>Amazing!</p>



<a name="255873392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873392">(Oct 02 2021 at 14:01)</a>:</h4>
<p>So, when I define a structure like wedge_morphism, <code>cases</code> allows me to access its fields (<code>hom</code> and <code>w'</code> in this case)</p>



<a name="255873845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255873845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255873845">(Oct 02 2021 at 14:08)</a>:</h4>
<p>Yes, and unfortunately (because we are trying to be clever with automation) you can see that the type of <code>f_w</code> is <code>auto_param (∀ (j : C), X.α.app j ≫ f_hom = Y.α.app j) (name.mk_string "obviously" name.anonymous)</code>, but I have seen that sufficiently often to know that what it actually says is just <code>∀ (a : C), X.α.app a ≫ f_hom = Y.α.app a</code> so I could just feed <code>j</code> into that function and get <code>X.α.app j ≫ f_hom = Y.α.app j</code></p>



<a name="255874277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255874277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255874277">(Oct 02 2021 at 14:15)</a>:</h4>
<p>I am bewildered why <code>simp at f_w</code> doesn't get rid of the <code>auto_param</code>. <code>rw auto_param_eq at f_w,</code> gives</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rewrite</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">did</span> <span class="n">not</span> <span class="n">find</span> <span class="kd">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="k">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">expression</span>
  <span class="n">auto_param</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span>
<span class="n">state</span><span class="o">:</span>
<span class="bp">...</span>
<span class="n">f_w</span> <span class="o">:</span> <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">),</span> <span class="n">X.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">f_hom</span> <span class="bp">=</span> <span class="n">Y.α.app</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">name.mk_string</span> <span class="s2">"obviously"</span> <span class="n">name.anonymous</span><span class="o">),</span>
<span class="bp">...</span>
</code></pre></div>



<a name="255874362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255874362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255874362">(Oct 02 2021 at 14:16)</a>:</h4>
<p>Oh I am a fool, it <em>does</em> work, it just leaves the old one behind because it's in the goal (the error above is because there's a second <code>f_w</code> later on in the context)</p>



<a name="255874510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255874510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255874510">(Oct 02 2021 at 14:19)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">cases</span> <span class="n">f</span> <span class="k">with</span> <span class="n">_</span> <span class="n">f_w</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">g</span> <span class="k">with</span> <span class="n">_</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">f_w</span> <span class="n">g_w</span><span class="o">,</span>
    <span class="c1">-- local context now looks nice</span>
    <span class="c1">-- `obviously` still fails though</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">f_w</span> <span class="n">j</span><span class="o">,</span> <span class="bp">←</span> <span class="n">g_w</span> <span class="n">j</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">⟩</span> <span class="o">}</span>
</code></pre></div>



<a name="255875456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875456">(Oct 02 2021 at 14:35)</a>:</h4>
<p>This works fine for me...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kn">open</span> <span class="n">category_theory.functor</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">functor.map_prod</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">×</span> <span class="n">D</span> <span class="bp">⥤</span> <span class="n">E</span><span class="o">)</span> <span class="o">{</span><span class="n">W</span> <span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">{</span><span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">⟶</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">F.obj</span> <span class="o">(</span><span class="n">W</span><span class="o">,</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">X</span><span class="o">,</span> <span class="n">Z</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">F.map</span> <span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="n">g</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">dinat_trans</span> <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">app</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">X</span><span class="o">,</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">G.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">X</span><span class="o">,</span> <span class="n">X</span><span class="o">))</span>
<span class="o">(</span><span class="n">dinaturality'</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">⦃</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">⦄</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span><span class="o">),</span>
  <span class="n">F.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">X</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span>
  <span class="n">F.map_prod</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≫</span> <span class="n">app</span> <span class="n">Y</span> <span class="bp">≫</span> <span class="n">G.map_prod</span> <span class="n">f.op</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">_</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="n">restate_axiom</span> <span class="n">dinat_trans.dinaturality'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">,</span> <span class="n">reassoc</span><span class="o">]</span> <span class="n">dinat_trans.dinaturality</span>

<span class="kd">structure</span> <span class="n">wedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="o">((</span><span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">)</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tip</span> <span class="o">:</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">dinat_trans</span> <span class="n">F</span> <span class="o">((</span><span class="n">const</span> <span class="o">(</span><span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span><span class="o">))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">tip</span><span class="o">))</span>


<span class="kd">variables</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">wedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">hom</span> <span class="bp">≫</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">cowedge_morphism</span> <span class="o">(</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hom</span> <span class="o">:</span> <span class="n">U.tip</span> <span class="bp">⟶</span> <span class="n">V.tip</span><span class="o">)</span>
<span class="o">(</span><span class="n">w'</span>  <span class="o">:</span> <span class="bp">∀</span> <span class="n">j</span> <span class="o">:</span> <span class="n">C</span><span class="o">,</span> <span class="n">U.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">hom</span> <span class="bp">=</span> <span class="n">V.α.app</span> <span class="n">j</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>

<span class="n">restate_axiom</span> <span class="n">wedge_morphism.w'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">,</span> <span class="n">reassoc</span><span class="o">]</span> <span class="n">wedge_morphism.w</span>

<span class="n">restate_axiom</span> <span class="n">cowedge_morphism.w'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">,</span> <span class="n">reassoc</span><span class="o">]</span> <span class="n">cowedge_morphism.w</span>

<span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">wedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">@[ext]</span>
<span class="kd">lemma</span> <span class="n">cowedge_morphism.ext</span> <span class="o">{</span><span class="n">U</span> <span class="n">V</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">T</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">f.hom</span> <span class="bp">=</span> <span class="n">g.hom</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">f</span><span class="o">,</span> <span class="n">cases</span> <span class="n">g</span><span class="o">,</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span>  <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">wedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span>   <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩,</span> <span class="o">}</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">:</span> <span class="n">category</span> <span class="o">(</span><span class="n">cowedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">cowedge_morphism</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span>
  <span class="n">id</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span><span class="o">,</span> <span class="o">⟨</span> <span class="mi">𝟙</span> <span class="n">_</span> <span class="o">⟩,</span>
  <span class="n">comp</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span><span class="o">⟩</span> <span class="o">}</span>

<span class="c1">-- instance twisted : category (hom C) :=</span>
<span class="c1">--   { hom := _,</span>
<span class="c1">--   id := _,</span>
<span class="c1">--   comp := _,</span>
<span class="c1">--   id_comp' := _,</span>
<span class="c1">--   comp_id' := _,</span>
<span class="c1">--   assoc' := _ }</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255875563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875563">(Oct 02 2021 at 14:37)</a>:</h4>
<p>The missing part was this</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">restate_axiom</span> <span class="n">dinat_trans.dinaturality'</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">,</span> <span class="n">reassoc</span><span class="o">]</span> <span class="n">dinat_trans.dinaturality</span>
</code></pre></div>



<a name="255875624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875624">(Oct 02 2021 at 14:38)</a>:</h4>
<p>I also added the reassoc attribute to the other simp lemmas</p>



<a name="255875643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875643">(Oct 02 2021 at 14:38)</a>:</h4>
<p>But I don't know exactly what made it work :)</p>



<a name="255875673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875673">(Oct 02 2021 at 14:39)</a>:</h4>
<p>lean magic</p>



<a name="255875690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875690">(Oct 02 2021 at 14:39)</a>:</h4>
<p>Now: the next step is defining a category having object the hom-class of another given category</p>



<a name="255875753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875753">(Oct 02 2021 at 14:40)</a>:</h4>
<p>(probably there is a ton of other things to do, but the <a href="https://ncatlab.org/nlab/show/twisted+arrow+category">twisted arrow category</a> seems to be the next logical step)</p>



<a name="255875766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875766">(Oct 02 2021 at 14:40)</a>:</h4>
<p>We do have <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.arrow">docs#category_theory.arrow</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.comma">docs#category_theory.comma</a></p>



<a name="255875922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255875922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255875922">(Oct 02 2021 at 14:43)</a>:</h4>
<p>perfect: Tw(C) is the comma category of the terminal functor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">* \to Set</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span> and of the hom functor of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></p>



<a name="255876158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876158">(Oct 02 2021 at 14:47)</a>:</h4>
<p>Now, is this an instance or a definition?</p>



<a name="255876232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876232">(Oct 02 2021 at 14:48)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.comma">docs#category_theory.comma</a> is itself a structure, which is endowed with a category instance</p>



<a name="255876371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876371">(Oct 02 2021 at 14:51)</a>:</h4>
<p>I would like to write "given a category C, there is a category Tw(C) done so and so"</p>



<a name="255876384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876384">(Oct 02 2021 at 14:51)</a>:</h4>
<p>is this an instance of category, or the definition of a new category?</p>



<a name="255876468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876468">(Oct 02 2021 at 14:53)</a>:</h4>
<p>It's a definition, and you put a category instance on top of it</p>



<a name="255876489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876489">(Oct 02 2021 at 14:53)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[derive category]</span>
<span class="kd">def</span> <span class="n">twisted</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">:=</span> <span class="n">comma</span> <span class="n">_</span> <span class="n">_</span> <span class="c1">-- fill in the functors</span>
</code></pre></div>



<a name="255876711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876711">(Oct 02 2021 at 14:57)</a>:</h4>
<p>It doesn't work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">don't</span> <span class="n">know</span> <span class="n">how</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">placeholder</span>
<span class="n">context</span><span class="o">:</span>
<span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">_inst_4</span> <span class="o">:</span> <span class="n">category</span> <span class="n">C</span>
<span class="bp">⊢</span> <span class="kt">Sort</span> <span class="bp">?</span>
</code></pre></div>



<a name="255876724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876724">(Oct 02 2021 at 14:57)</a>:</h4>
<p>(also, unknown identifier <code>comma</code>, but that's going to be solved with the right <code>open</code> I guess)</p>



<a name="255876771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876771">(Oct 02 2021 at 14:58)</a>:</h4>
<p>You're probably missing an import</p>



<a name="255876791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876791">(Oct 02 2021 at 14:58)</a>:</h4>
<p>What are the two functors precisely? The initial one from *, but what do you mean by the hom functor?</p>



<a name="255876821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876821">(Oct 02 2021 at 14:59)</a>:</h4>
<p>The one from Cop x C to Set?</p>



<a name="255876829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876829">(Oct 02 2021 at 14:59)</a>:</h4>
<p>the functor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>hom</mi><mo>⁡</mo><mo>:</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\hom : C^{op} \times C \to Set</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop">hom</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span> sending <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>hom</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hom(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">hom</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> and $(u,v)$ to the function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>↦</mo><mi>v</mi><mi>f</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">f\mapsto vfu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">u</span></span></span></span></p>



<a name="255876964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876964">(Oct 02 2021 at 15:01)</a>:</h4>
<p>but I would like to re-define these basic objects, and refactor later using more high-level stuff... I feel I'm losing the grip of the problem.</p>



<a name="255876977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876977">(Oct 02 2021 at 15:01)</a>:</h4>
<p>I need baby steps. How do I define a category with a single object and a single morphism?</p>



<a name="255876986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255876986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255876986">(Oct 02 2021 at 15:01)</a>:</h4>
<p>how do I define a functor from said category to Set, picking the singleton set?</p>



<a name="255877033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877033">(Oct 02 2021 at 15:02)</a>:</h4>
<p>when I have these blocks, and the hom functor above, I can try to define <code>twisted</code></p>



<a name="255877147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877147">(Oct 02 2021 at 15:04)</a>:</h4>
<p>Gotcha. So we have the constant functor as you already know, and for the hom functor we can use <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.yoneda">docs#category_theory.yoneda</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.uncurry">docs#category_theory.uncurry</a> (and <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.prod.swap">docs#category_theory.prod.swap</a> if needed)</p>



<a name="255877248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877248">(Oct 02 2021 at 15:06)</a>:</h4>
<p>yoneda + uncurry gives hom, I understand, but what about the terminal category?</p>



<a name="255877267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877267">(Oct 02 2021 at 15:06)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.discrete">docs#category_theory.discrete</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/punit">docs#punit</a></p>



<a name="255877301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877301">(Oct 02 2021 at 15:07)</a>:</h4>
<p>so <code>category_theory.discrete punit</code> is the terminal category</p>



<a name="255877422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877422">(Oct 02 2021 at 15:09)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">hom_functor</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span>
<span class="n">uncurry</span> <span class="n">yoneda</span>

<span class="kd">def</span> <span class="n">terminal_category</span> <span class="o">:</span> <span class="n">category</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">category_theory.discrete</span> <span class="n">punit</span>
</code></pre></div>
<p>I have no idea what I'm doing <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="255877509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877509">(Oct 02 2021 at 15:10)</a>:</h4>
<p>(mostly because I have no idea how to write the generic "this is of type that")</p>



<a name="255877604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877604">(Oct 02 2021 at 15:12)</a>:</h4>
<p><span class="user-mention" data-user-id="432631">@fosco</span> what do you mean?</p>



<a name="255877623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877623">(Oct 02 2021 at 15:13)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">terminal_category</span> <span class="o">:</span> <span class="n">category</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">category_theory.discrete_category</span> <span class="n">punit</span>
</code></pre></div>
<p><span aria-label="this" class="emoji emoji-1f446" role="img" title="this">:this:</span>  should be <code>instance</code>. You are instructing lean how to put a category structure on the type <code>unit</code>.</p>



<a name="255877711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877711">(Oct 02 2021 at 15:14)</a>:</h4>
<p>But you can also just use <code>category_theory.discrete punit</code>, as Adam suggested.<br>
<code>category_theory.discrete</code> is a function that eats a type, and spits out that same type (the identity, ha!)<br>
But the upshot is that if a type is wrapped in this identity function, then Lean endows it with the category structure that has no homs except for the identity homs.</p>



<a name="255877816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877816">(Oct 02 2021 at 15:16)</a>:</h4>
<p>No: <code>category_theory.discrete punit</code> throws a mismatch</p>



<a name="255877821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877821">(Oct 02 2021 at 15:16)</a>:</h4>
<p><code>category_theory.discrete_category punit</code> does not</p>



<a name="255877840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877840">(Oct 02 2021 at 15:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255877604">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="432631">fosco</span> what do you mean?</p>
</blockquote>
<p>I mean that I have no idea how to turn into Lean the definition I have in mind</p>



<a name="255877908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877908">(Oct 02 2021 at 15:18)</a>:</h4>
<p>I see there's a lot of stuff already written, but I feel like I'm the passenger in a bus; when the trip is finished I don't remember the road I took. I learn by driving.</p>



<a name="255877928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877928">(Oct 02 2021 at 15:19)</a>:</h4>
<p>My problem is small, and I want an elementary solution; I don't care there is a library that does it already, I <em>need</em> to see how to write down the definition I want</p>



<a name="255877939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877939">(Oct 02 2021 at 15:19)</a>:</h4>
<p>You are helping a lot, but it is exhausting to say the least.</p>



<a name="255877957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255877957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255877957">(Oct 02 2021 at 15:19)</a>:</h4>
<p>I want to define a category with a single object and a single morphism. I want to define a functor from it to Set, that picks the singleton</p>



<a name="255878055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255878055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255878055">(Oct 02 2021 at 15:21)</a>:</h4>
<p>So you write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">category</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">_</span>
</code></pre></div>
<p>And use the <span aria-label="bulb" class="emoji emoji-1f4a1" role="img" title="bulb">:bulb:</span> to get a skeleton.</p>



<a name="255878064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255878064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255878064">(Oct 02 2021 at 15:21)</a>:</h4>
<p>After that, you write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">terminal_functor</span> <span class="o">:</span> <span class="n">unit</span> <span class="bp">⥤</span> <span class="kt">Type</span> <span class="o">:=</span>
<span class="n">_</span>
</code></pre></div>
<p>etc...</p>



<a name="255878713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255878713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255878713">(Oct 02 2021 at 15:33)</a>:</h4>
<p>ok, I'll give it a try. But now I need a break</p>
<p>Thanks!</p>



<a name="255882951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255882951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255882951">(Oct 02 2021 at 16:46)</a>:</h4>
<p>I made you a video explaining how to construct these things:<br>
<a href="/user_uploads/3121/DgCaDMjoy4grsCoPdioC2tHu/2021-10-02_10-31-46.mkv">2021-10-02_10-31-46.mkv</a></p>



<a name="255884505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255884505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255884505">(Oct 02 2021 at 17:12)</a>:</h4>
<p>wow, many thanks!</p>



<a name="255884863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255884863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255884863">(Oct 02 2021 at 17:18)</a>:</h4>
<p>No problem. There are a few subtleties with universe parameters, as you can see...</p>



<a name="255885816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255885816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255885816">(Oct 02 2021 at 17:34)</a>:</h4>
<p>heh, yeah <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> I would have lost a few hours after those...</p>



<a name="255908431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908431">(Oct 03 2021 at 00:09)</a>:</h4>
<p>Just coming back to explain why the <code>reassoc</code> attribute Adam suggested is useful!</p>



<a name="255908488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908488">(Oct 03 2021 at 00:10)</a>:</h4>
<p>The goal automation was stuck on was</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span>
<span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">cowedge</span> <span class="n">F</span>
<span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">⟶</span> <span class="n">Y</span>
<span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">⟶</span> <span class="n">Z</span>
<span class="n">j</span> <span class="o">:</span> <span class="n">C</span>
<span class="bp">⊢</span> <span class="n">X.α.app</span> <span class="n">j</span> <span class="bp">≫</span> <span class="n">f.hom</span> <span class="bp">≫</span> <span class="n">g.hom</span> <span class="bp">=</span> <span class="n">Z.α.app</span> <span class="n">j</span>
</code></pre></div>



<a name="255908535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908535">(Oct 03 2021 at 00:11)</a>:</h4>
<p>You might wonder: surely <code>f.w : X.α.app j ≫ f.hom = Y.α.app j</code>, which is a <code>@[simp]</code> lemma, should fire here when automation calls <code>simp</code>, reducing the goal to <code>Y.α.app j ≫ g.hom = Z.α.app j</code>, which is in turn solvable by <code>simp</code> using <code>g.w</code>.</p>



<a name="255908601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908601">(Oct 03 2021 at 00:12)</a>:</h4>
<p>The problem is associativity: the goal is actually <code>X.α.app j ≫ (f.hom ≫ g.hom)</code> = <a href="http://Z.α.app">Z.α.app</a> j<code> and so </code>f.w` doesn't immediately apply.</p>



<a name="255908616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908616">(Oct 03 2021 at 00:12)</a>:</h4>
<p>We could deal with this problem by hand, by rewriting using <code>category.assoc</code> to rebracket and then using <code>f.w</code> and <code>g.w</code>.</p>



<a name="255908721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908721">(Oct 03 2021 at 00:14)</a>:</h4>
<p>However we could also realise that it would be helpful if there was a lemma <code>f.w_assoc : ∀ h, X.α.app j ≫ (f.hom ≫ h) = Y.α.app j ≫ h</code>, where we are quantifying over some arbitrary other morphism <code>h</code>.</p>



<a name="255908742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908742">(Oct 03 2021 at 00:15)</a>:</h4>
<p>If this were a <code>@[simp]</code> lemma, then <code>simp</code> could discharge the original goal by using <code>f.w_assoc g.hom</code>, and then using <code>g.w</code>.</p>



<a name="255908812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908812">(Oct 03 2021 at 00:16)</a>:</h4>
<p>Writing <code>attribute [reassoc] wedge_morphism.w</code> achieves exactly this! The reassoc attribute causes Lean to go away and inspect the lemma, realise it is an equation in a category involving a composition on the LHS, and automatically generate the additional lemma <code>wedge_morphism.w_assoc</code>.</p>



<a name="255908825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908825">(Oct 03 2021 at 00:16)</a>:</h4>
<p>In fact, you should try writing <code>#print wedge_morphism.w_assoc</code> to verify that this lemma was automatically created, and behaves as I indicated.</p>



<a name="255908936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255908936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255908936">(Oct 03 2021 at 00:18)</a>:</h4>
<p>This trick largely ameliorates dealing with associativity in 1-categories. We can work with all our expressions in "simp normal form", here meaning "all associated to the right", but lemmas about compositions have automatically generated helper lemmas that allow them to apply in the middle of a composition.</p>



<a name="255909038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255909038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255909038">(Oct 03 2021 at 00:20)</a>:</h4>
<p>(Sadly we have not implemented the planar-graph-pattern-matching that would be required to do this in 2-categories / monoidal categories. :-) One day!)</p>



<a name="255935908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255935908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255935908">(Oct 03 2021 at 08:47)</a>:</h4>
<p>Thanks a lot! So, next step is define the twisted arrow category of C</p>



<a name="255935978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255935978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255935978">(Oct 03 2021 at 08:48)</a>:</h4>
<p>I need</p>
<ol>
<li>the hom functor: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>hom</mi><mo>⁡</mo></mrow><mi>C</mi></msub><mo>:</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\hom_C : C^{op}\times C \to Set</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mop"><span class="mop">hom</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span></li>
<li>the terminal functor, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">* \to Set</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span> choosing the singleton</li>
<li>a comma construction.</li>
</ol>
<p>I have 2. 1 can be obtained uncurrying yoneda. 3 is already there</p>



<a name="255935996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255935996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255935996">(Oct 03 2021 at 08:49)</a>:</h4>
<p>This is not what I initially wanted to use to define Tw(C), but nevermind, maybe there will be a theorem later.</p>



<a name="255936082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936082">(Oct 03 2021 at 08:50)</a>:</h4>
<p>Remember that <code>Set</code> is called <code>Type</code> now. :-)</p>



<a name="255936118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936118">(Oct 03 2021 at 08:51)</a>:</h4>
<p>See <code>category_theory.hom_functor</code>: <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.functor.hom/src">src#category_theory.functor.hom</a></p>



<a name="255936354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936354">(Oct 03 2021 at 08:55)</a>:</h4>
<p>We also have <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.category_of_elements/src">src#category_theory.category_of_elements</a>.</p>



<a name="255936404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936404">(Oct 03 2021 at 08:56)</a>:</h4>
<p>which might give you a one-liner definition of the twisted arrow category!</p>



<a name="255936460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936460">(Oct 03 2021 at 08:57)</a>:</h4>
<p>The problem is always the same, I don't know the syntax with which I can invoke the right definition</p>



<a name="255936509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936509">(Oct 03 2021 at 08:58)</a>:</h4>
<p>Plus, copy-pasting the <a href="https://github.com/leanprover-community/mathlib/blob/7d83ff15903589811040894b90b28a46fe5e68c3/src/category_theory/hom_functor.lean#L23">definition of hom</a> results in errors</p>



<a name="255936568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936568">(Oct 03 2021 at 09:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">category</span> <span class="n">C</span><span class="o">,</span>
<span class="n">p</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span>
<span class="bp">⊢</span> <span class="n">quiver</span> <span class="n">C</span>
</code></pre></div>



<a name="255936651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936651">(Oct 03 2021 at 09:00)</a>:</h4>
<p>That's weird!</p>



<a name="255936664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936664">(Oct 03 2021 at 09:00)</a>:</h4>
<p>Can you post a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?</p>



<a name="255936674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936674">(Oct 03 2021 at 09:00)</a>:</h4>
<p>Or try <code>set_option pp.universes true</code> and see what the error message becomes?</p>



<a name="255936707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936707">(Oct 03 2021 at 09:01)</a>:</h4>
<p>Where should I put it?</p>



<a name="255936731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936731">(Oct 03 2021 at 09:01)</a>:</h4>
<p>Before the error</p>



<a name="255936781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936781">(Oct 03 2021 at 09:02)</a>:</h4>
<p>Outside any structure def or theorem</p>



<a name="255936816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936816">(Oct 03 2021 at 09:02)</a>:</h4>
<p>But you should please get into the habit of posting <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> s. Errors by themselves are not easy to interpret</p>



<a name="255936844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936844">(Oct 03 2021 at 09:03)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>
<span class="kn">import</span> <span class="n">category_theory.comma</span>
<span class="kn">import</span> <span class="n">category_theory.discrete_category</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kn">open</span> <span class="n">category_theory.functor</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">definition</span> <span class="n">hom</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">unop</span> <span class="n">p.1</span> <span class="bp">⟶</span> <span class="n">p.2</span><span class="o">,</span>
  <span class="n">map</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">f</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">f.1.unop</span> <span class="bp">≫</span> <span class="n">h</span> <span class="bp">≫</span> <span class="n">f.2</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255936860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936860">(Oct 03 2021 at 09:03)</a>:</h4>
<p><a href="/user_uploads/3121/4Yzwyp3rTRfAHaYq5nbLLvep/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/4Yzwyp3rTRfAHaYq5nbLLvep/image.png" title="image.png"><img src="/user_uploads/3121/4Yzwyp3rTRfAHaYq5nbLLvep/image.png"></a></div>



<a name="255936915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936915">(Oct 03 2021 at 09:04)</a>:</h4>
<p>Ah, but you didn't copy and paste.</p>



<a name="255936918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936918">(Oct 03 2021 at 09:04)</a>:</h4>
<p>You wrote <code>Type</code> as the target.</p>



<a name="255936931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936931">(Oct 03 2021 at 09:04)</a>:</h4>
<p>The problem is that <code>[category C]</code> introduces a universe variable for the morphism level.</p>



<a name="255936940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936940">(Oct 03 2021 at 09:05)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>
<span class="kn">import</span> <span class="n">category_theory.comma</span>
<span class="kn">import</span> <span class="n">category_theory.discrete_category</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kn">open</span> <span class="n">category_theory.functor</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">definition</span> <span class="n">hom</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">unop</span> <span class="n">p.1</span> <span class="bp">⟶</span> <span class="n">p.2</span><span class="o">,</span>
  <span class="n">map</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">f</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">f.1.unop</span> <span class="bp">≫</span> <span class="n">h</span> <span class="bp">≫</span> <span class="n">f.2</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>
<p>works fine.</p>



<a name="255936974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936974">(Oct 03 2021 at 09:05)</a>:</h4>
<p>Alternatively if we write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.products.basic</span>
<span class="kn">import</span> <span class="n">category_theory.const</span>
<span class="kn">import</span> <span class="n">category_theory.comma</span>
<span class="kn">import</span> <span class="n">category_theory.discrete_category</span>

<span class="kn">open</span> <span class="n">opposite</span>

<span class="kn">namespace</span> <span class="n">category_theory</span>

<span class="kn">open</span> <span class="n">category_theory.functor</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">D</span><span class="o">]</span> <span class="o">[</span><span class="n">category</span> <span class="n">E</span><span class="o">]</span>

<span class="kd">set_option</span> <span class="n">pp.universes</span> <span class="n">true</span>

<span class="kd">definition</span> <span class="n">hom</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">obj</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">unop</span> <span class="n">p.1</span> <span class="bp">⟶</span> <span class="n">p.2</span><span class="o">,</span>
  <span class="n">map</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">f</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">f.1.unop</span> <span class="bp">≫</span> <span class="n">h</span> <span class="bp">≫</span> <span class="n">f.2</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">category_theory</span>
</code></pre></div>



<a name="255936978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255936978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255936978">(Oct 03 2021 at 09:05)</a>:</h4>
<p>we get a useful error message:</p>



<a name="255937023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937023">(Oct 03 2021 at 09:06)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">category.</span><span class="o">{</span><span class="n">u_4</span> <span class="n">u_1</span><span class="o">}</span> <span class="n">C</span><span class="o">,</span>
<span class="n">p</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span>
<span class="bp">⊢</span> <span class="n">quiver.</span><span class="o">{</span><span class="mi">1</span> <span class="n">u_1</span><span class="o">}</span> <span class="n">C</span>
</code></pre></div>



<a name="255937048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937048">(Oct 03 2021 at 09:06)</a>:</h4>
<p>From which you can see that there is a universe level problem! There is a category instance with universe levels <code>.{u_4 u_1}</code>, but the quiver instance you need is <code>.{1 u_1}</code>.</p>



<a name="255937066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937066">(Oct 03 2021 at 09:07)</a>:</h4>
<p>and the reason for this is exactly that you changed the codomain of <code>hom</code> to <code>Type</code>.</p>



<a name="255937138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937138">(Oct 03 2021 at 09:08)</a>:</h4>
<p>You have to ask yourself whether you want to work with a category C whose objects form a set in some Grothendieck universe u1 and whose hom sets all live in another Grothendieck universe u2, and then whether D has objects in u3 etc etc. That's what you're doing right now</p>



<a name="255937149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937149">(Oct 03 2021 at 09:08)</a>:</h4>
<p>The one-liner for <code>twisted_arrow</code> is just:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.elements</span>

<span class="kn">open</span> <span class="n">category_theory</span>

<span class="kd">@[derive category]</span>
<span class="kd">def</span> <span class="n">twisted_arrow</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">:=</span> <span class="o">(</span><span class="n">functor.hom</span> <span class="n">C</span><span class="o">)</span><span class="bp">.</span><span class="n">elements</span>
</code></pre></div>
</div></div>



<a name="255937169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937169">(Oct 03 2021 at 09:09)</a>:</h4>
<p>I see! Thanks.</p>



<a name="255937201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937201">(Oct 03 2021 at 09:09)</a>:</h4>
<p>Type is the smallest Grothendieck universe so you can't land in there in general unless you restrict to categories whose hom sets are there. Basically you have to decide what you mean by a category, is it small, large, or do you want to try to write code which works for both or even more general situations</p>



<a name="255937263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937263">(Oct 03 2021 at 09:10)</a>:</h4>
<p>Right now we choose a universe level for objects and a different one for morphisms</p>



<a name="255937279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937279">(Oct 03 2021 at 09:11)</a>:</h4>
<p>(Hopefully reading the note about universe levels in <code>category_theory.category.basic</code> will be helpful. It explains why we need to use two independent universe levels, in order to formalise small and large categories uniformly.)</p>



<a name="255937424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937424">(Oct 03 2021 at 09:13)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/notes.html#category_theory%20universes">https://leanprover-community.github.io/mathlib_docs/notes.html#category_theory%20universes</a></p>



<a name="255937490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937490">(Oct 03 2021 at 09:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255937263">said</a>:</p>
<blockquote>
<p>In lean we choose a universe level for objects and a different one for morphisms</p>
</blockquote>
<p>Yes; whereas usually objects are in a universe more than the one where hom's live</p>



<a name="255937493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937493">(Oct 03 2021 at 09:15)</a>:</h4>
<p>anyway</p>



<a name="255937633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937633">(Oct 03 2021 at 09:18)</a>:</h4>
<p>now I have various choices for how to formalise next:  </p>
<ol>
<li>the end of F is the terminal object of its category of wedges</li>
<li>precomposing with the functor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>w</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">)</mo><mo>→</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">Tw(F) \to C^{op}\times C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">Tw</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> sends <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>×</mo><mi>C</mi><mo>→</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">F : C^{op}\times C \to D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo>ˉ</mo></mover><mo>:</mo><mi>T</mi><mi>w</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo>→</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">\bar F : Tw(C) \to D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">Tw</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>, and </li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∫</mo><mi>c</mi></msub><mi>F</mi><mo>≅</mo><mi>lim</mi><mo>⁡</mo><mover accent="true"><mi>F</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\int_c F\cong \lim \bar F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1608200000000002em;vertical-align:-0.35582em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.05442800000000003em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mop">lim</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span></li>
</ol>



<a name="255937785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937785">(Oct 03 2021 at 09:20)</a>:</h4>
<ol>
<li>
<p>I looked for "terminal object of a category", but I didn't find anything, only the statement that a category has a terminal object. I was thinking to something on the lines of "{Wd(F) has a terminal object, a choice of that object}"</p>
</li>
<li>
<p>does the category of elements construction allows to extract the functor immediately?</p>
</li>
</ol>



<a name="255937833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937833">(Oct 03 2021 at 09:21)</a>:</h4>
<blockquote>
<ol start="2">
<li>does the category of elements construction allows to extract the functor immediately?</li>
</ol>
</blockquote>
<p>Which functor?</p>



<a name="255937904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937904">(Oct 03 2021 at 09:22)</a>:</h4>
<p>there are various ways to call it; the "category of elements" construction turns a presheaf <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><msup><mi>C</mi><mrow><mi>o</mi><mi>p</mi></mrow></msup><mo>→</mo><mi>S</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">F : C^{op} \to Set</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span> into a fibration over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>; the functor I want is precisely that fibration</p>



<a name="255937908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937908">(Oct 03 2021 at 09:22)</a>:</h4>
<blockquote>
<p>1.</p>
</blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.limits.is_terminal/src">src#category_theory.limits.is_terminal</a></p>



<a name="255937923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937923">(Oct 03 2021 at 09:23)</a>:</h4>
<p>it just forgets the "element" a in (X, a \in FX)</p>



<a name="255937956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937956">(Oct 03 2021 at 09:23)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.category_of_elements.π/src">src#category_theory.category_of_elements.π</a></p>



<a name="255937964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255937964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255937964">(Oct 03 2021 at 09:23)</a>:</h4>
<p>(or just read through <code>category_theory.elements</code> until you find it :-)</p>



<a name="255938138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938138">(Oct 03 2021 at 09:26)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">twisted_fibration</span> <span class="o">:</span> <span class="n">twisted</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="o">:=</span>
<span class="n">category_of_elements.π</span> <span class="o">(</span><span class="n">twisted</span> <span class="n">C</span><span class="o">)</span>
</code></pre></div>
<p>I get a universe error.. let's see if I'm able to fix it alone</p>



<a name="255938147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938147">(Oct 03 2021 at 09:27)</a>:</h4>
<p>no, it's a type misatch</p>



<a name="255938158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938158">(Oct 03 2021 at 09:27)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">twisted</span> <span class="n">C</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_1</span> <span class="n">u_4</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="o">(</span><span class="n">u_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">u_4</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span> <span class="n">u_4</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_4</span> <span class="n">u_1</span> <span class="o">(</span><span class="n">u_4</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span>
</code></pre></div>



<a name="255938230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938230">(Oct 03 2021 at 09:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">twisted_fibration</span> <span class="o">:</span> <span class="n">twisted</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="o">:=</span>
<span class="n">category_of_elements.π</span> <span class="o">(</span><span class="n">functor.hom</span> <span class="n">C</span><span class="o">)</span>
</code></pre></div>
<p>hooray!</p>



<a name="255938379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938379">(Oct 03 2021 at 09:30)</a>:</h4>
<p>Now:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> TODO:</span>
<span class="cm">F : Cᵒᵖ × C ⥤ D (I'd be happy to do it just for D=Type* atm...)</span>
<span class="cm">end1 : the terminal object in Wd(F) (it exists, because Type is complete)</span>
<span class="cm">end2 : limit of (F ⋙ twisted_fibration C)</span>
<span class="cm">thm end1 ≅ end2 canonically</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="255938408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938408">(Oct 03 2021 at 09:31)</a>:</h4>
<p>( whoops, it's <code>(twisted_fibration C ⋙ F)</code> )</p>



<a name="255938865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938865">(Oct 03 2021 at 09:39)</a>:</h4>
<p>Oh dear, you've said the dread word "canonically"! What do you mean? :-)</p>



<a name="255938937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938937">(Oct 03 2021 at 09:41)</a>:</h4>
<p>Presumably it is some naturality statement with respect to <code>C</code>.</p>



<a name="255938949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938949">(Oct 03 2021 at 09:41)</a>:</h4>
<p>yes (it can be done later, or it can be avoided <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> I'm suffering enough)</p>



<a name="255938960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938960">(Oct 03 2021 at 09:41)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">end1</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">end2</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="255938965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938965">(Oct 03 2021 at 09:42)</a>:</h4>
<p>these are the typings.</p>



<a name="255938988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255938988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255938988">(Oct 03 2021 at 09:42)</a>:</h4>
<p>So yes, first challenge is to write down the statement of the isomorphism, with a sorry for the construction.</p>



<a name="255939048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939048">(Oct 03 2021 at 09:43)</a>:</h4>
<p>Whoops, no</p>



<a name="255939137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939137">(Oct 03 2021 at 09:44)</a>:</h4>
<p>We'd like to just be able to write <code>⊤ : wedge F</code> to specify the terminal object. Probably we're going to have to do some amount of explaining so that Lean understands why the completeness of <code>Type</code> implies the existence of a terminal object in <code>wedge F</code>.</p>



<a name="255939150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939150">(Oct 03 2021 at 09:44)</a>:</h4>
<p>oh, so \top is a shorthand to refer to a terminal object?</p>



<a name="255939185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939185">(Oct 03 2021 at 09:45)</a>:</h4>
<p>Yes. It's used all over mathlib for the top element of a lattice, but we also use the same notation for terminal objects.</p>



<a name="255939235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939235">(Oct 03 2021 at 09:46)</a>:</h4>
<p>How comes I can't find it if I Ctrl-F the entire src/ folder?</p>



<a name="255939251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939251">(Oct 03 2021 at 09:46)</a>:</h4>
<p>Are you writing \top in the search box? You need to copy and paste the unicode symbol into the search box.</p>



<a name="255939257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939257">(Oct 03 2021 at 09:46)</a>:</h4>
<p>Yes, I did</p>



<a name="255939294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939294">(Oct 03 2021 at 09:47)</a>:</h4>
<p>Does searching for anything work?</p>



<a name="255939451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939451">(Oct 03 2021 at 09:50)</a>:</h4>
<p>Nevermind; in theory this should work </p>
<p><code>limits.terminal (wedge F)</code></p>
<p>but it complains because it wants a proof that Type* has enough limits (probably?)</p>



<a name="255939475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939475">(Oct 03 2021 at 09:50)</a>:</h4>
<p>No, it's not clever enough to want that. :-)</p>



<a name="255939481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939481">(Oct 03 2021 at 09:50)</a>:</h4>
<p>How is Lean going to know <em>anything</em> about any limits in <code>wedge F</code>?</p>



<a name="255939488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939488">(Oct 03 2021 at 09:51)</a>:</h4>
<p>As far as it is concerned it is some brand new category.</p>



<a name="255939497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939497">(Oct 03 2021 at 09:51)</a>:</h4>
<p>We need to tell it something. So --- why does <code>wedge F</code> have a terminal object?</p>



<a name="255939512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939512">(Oct 03 2021 at 09:51)</a>:</h4>
<p>it doesn't; but __if__ it does, that's the end.</p>



<a name="255939565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939565">(Oct 03 2021 at 09:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/116395-maths/topic/dinatural.20transformations/near/255939481">said</a>:</p>
<blockquote>
<p>How is Lean going to know <em>anything</em> about any limits in <code>wedge F</code>?</p>
</blockquote>
<p>Of course <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="255939581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939581">(Oct 03 2021 at 09:52)</a>:</h4>
<p>that's why I was thinking about something like {a proof that wedge(F) has a terminal object, a choice of that object}</p>



<a name="255939584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939584">(Oct 03 2021 at 09:52)</a>:</h4>
<p>but this is a.. structure?</p>



<a name="255939593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939593">(Oct 03 2021 at 09:53)</a>:</h4>
<p>So you need <code>is_terminal</code></p>



<a name="255939629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939629">(Oct 03 2021 at 09:54)</a>:</h4>
<p><code>is_terminal</code> eats an object of the codomain</p>



<a name="255939677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939677">(Oct 03 2021 at 09:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">my_iso</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">≅</span> <span class="n">Q</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="255939693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939693">(Oct 03 2021 at 09:54)</a>:</h4>
<p>That says: "suppose I have a terminal wedge, called X, then I can construct an isomorphism between P and Q"</p>



<a name="255939699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939699">(Oct 03 2021 at 09:54)</a>:</h4>
<p>(obviously you will need to fill in P and Q here)</p>



<a name="255939722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939722">(Oct 03 2021 at 09:55)</a>:</h4>
<p>I don't understand...</p>



<a name="255939804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939804">(Oct 03 2021 at 09:57)</a>:</h4>
<p>Isn't this what you want to say? You want to say "Suppose there is a terminal object in wedge F. Then &lt;some construction based on that object&gt; is a limit for <code>twisted_fibration C ⋙ F</code>."</p>



<a name="255939878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939878">(Oct 03 2021 at 09:58)</a>:</h4>
<p>oh! I see; no, I'm stuck at a former step, <em>defining</em> the end of F. I took another approach, but it looks kinda stupid</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">end1</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">limits.is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span> <span class="o">:=</span> <span class="n">X</span>
</code></pre></div>



<a name="255939883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939883">(Oct 03 2021 at 09:58)</a>:</h4>
<p>at least it doesnt complain...</p>



<a name="255939888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939888">(Oct 03 2021 at 09:58)</a>:</h4>
<p>So maybe instead you want to write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">limit_cone_of_terminal_wedge</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">cone</span> <span class="o">(</span><span class="n">twisted_fibration</span> <span class="n">C</span> <span class="bp">⋙</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">...</span>
<span class="kd">lemma</span> <span class="n">is_limit_of_terminal_wedge</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_limit</span> <span class="o">(</span><span class="n">limit_cone_of_terminal_wedge</span> <span class="n">X</span> <span class="n">h</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">...</span>
</code></pre></div>



<a name="255939910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255939910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255939910">(Oct 03 2021 at 09:59)</a>:</h4>
<p>Yeah, that <code>end1</code> definition is not doing anything for you. :-)</p>



<a name="255940075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255940075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255940075">(Oct 03 2021 at 10:01)</a>:</h4>
<p>And probably you want to factor that into more pieces:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">end_of_terminal_wedge</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">D</span> <span class="o">:=</span>
<span class="gr">sorry</span>

<span class="kd">@[simps]</span>
<span class="kd">def</span> <span class="n">limit_cone_of_terminal_wedge</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">cone</span> <span class="o">(</span><span class="n">twisted_fibration</span> <span class="n">C</span> <span class="bp">⋙</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">X</span> <span class="o">:=</span> <span class="n">end_of_terminal_wedge</span> <span class="n">X</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">π</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">is_limit_of_terminal_wedge</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">×</span> <span class="n">C</span> <span class="bp">⥤</span> <span class="n">D</span><span class="o">}</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">wedge</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_terminal</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_limit</span> <span class="o">(</span><span class="n">limit_cone_of_terminal_wedge</span> <span class="n">X</span> <span class="n">h</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">...</span>
</code></pre></div>



<a name="255940158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255940158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255940158">(Oct 03 2021 at 10:02)</a>:</h4>
<p>well, technically the end of F is the whole wedge, an object of <code>wedge F</code></p>



<a name="255940162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255940162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255940162">(Oct 03 2021 at 10:02)</a>:</h4>
<p>usually you call "the end" just the tip</p>



<a name="255940180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255940180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> fosco <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255940180">(Oct 03 2021 at 10:03)</a>:</h4>
<p>I need a break <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> thanks for your help so far!</p>



<a name="255942928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255942928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255942928">(Oct 03 2021 at 10:52)</a>:</h4>
<p>@fosco, rather than this manual translation between terminal objects and limit cones, you should just directly prove the equivalence of categories between <code>wedge F</code> and <code>cone (twisted_fibration C ⋙ F)</code>.</p>



<a name="255944482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255944482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255944482">(Oct 03 2021 at 11:20)</a>:</h4>
<blockquote>
<p>Yes; whereas usually objects are in a universe more than the one where hom's live</p>
</blockquote>
<p>You're claiming that, but you're also talking about limits and for limits in large categories it's essential that the source category (the diagram) does <em>not</em> satisfy the condition you claim is usual. And limits are also "usual" right? Formalisation has to take these things into account and it's when you start formalising that you start noticing them.</p>



<a name="255944552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255944552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255944552">(Oct 03 2021 at 11:22)</a>:</h4>
<p>The way Scott has set it up saves us from having to develop two parallel theories of small and large categories.</p>



<a name="255944947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/dinatural%20transformations/near/255944947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/dinatural.20transformations.html#255944947">(Oct 03 2021 at 11:29)</a>:</h4>
<p>It is not true in lean that "every small category is large", for the same reason that it's not true in lean that every natural number is a real number. There's a "canonical" construction which eats one thing and spits out the other but it's a genuine function and needs to be applied (and then one has to check that it commutes with everything)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>