---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Additive.20characters.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html">Additive characters</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="290005886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290005886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290005886">(Jul 18 2022 at 18:35)</a>:</h4>
<p>I'm preparing a PR introducing additive characters.</p>



<a name="290006041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290006041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290006041">(Jul 18 2022 at 18:36)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/15499">#15499</a></p>



<a name="290006160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290006160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290006160">(Jul 18 2022 at 18:37)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> Maybe you'd like to have a look at <a href="https://github.com/leanprover-community/mathlib/pull/15499">#15499</a>.</p>



<a name="290293779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290293779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290293779">(Jul 20 2022 at 20:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I left some questions related to your comments at <a href="https://github.com/leanprover-community/mathlib/pull/15499">#15499</a>.</p>



<a name="290429680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290429680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290429680">(Jul 21 2022 at 20:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="https://github.com/leanprover-community/mathlib/pull/15499#pullrequestreview-1046919329">said in a comment on #15499</a>:</p>
<blockquote>
<p>For me this PR raises an interesting question. My impression is that the community are not keen on adding the structure of maps f:A -&gt; G such that f(a+b)=f(a)*f(b), because then we have to make an API for it, and how it composes with additive maps on one side and multiplicative maps on the other side, and then there are maps G -&gt; A and etc etc. Another proposal is to define add_char so that it contains an application of of_add : R -&gt; multiplicative R and then just write add_char.map_add : \psi (a + b) = \psi a * \psi b and a bit more API for it.</p>
<p>My position on this has come from a huge struggle I had in the past using with_top because it would often leak to option, and if you were working with with_top and with_bot then you didn't know whether none was bot or top. Being principled with types in statements of results goes a long way towards stopping this kind of leakage.</p>
</blockquote>
<p>To add to Kevin 's comment above, I find it quite painful to have to use <code>multiplicative R →* R'</code> instead of something like, say, <code>R +→* R'</code> and having to convert between <code>R</code> and <code>multiplicative R</code> via <code>of_add</code> and <code>to_add</code>. (And as one can see from Kevin's comments on the PR, I didn't manage to do it completely right...). If homomorphisms between additive and multiplicative structures also occur in some other places, it may be worth the effort of having dedicated type classes and API for them. Maybe there is a way of auto-generate them, something like a "left" or "right" version of to_additive?</p>



<a name="290459001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290459001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290459001">(Jul 22 2022 at 03:00)</a>:</h4>
<p>We've done a lot of work recently to plug the holes of the with_top and with_bot implementation to prevent the leaking of some and none, without having to resort to irreducible.</p>



<a name="290459033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290459033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290459033">(Jul 22 2022 at 03:01)</a>:</h4>
<p>Part of the leakage often occurs with "cute" proofs that (ab)use the fact that the underlying type is the same. What we need better are useful recursors</p>



<a name="290459042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290459042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290459042">(Jul 22 2022 at 03:01)</a>:</h4>
<p>Like we know have with <a href="https://leanprover-community.github.io/mathlib_docs/find/with_top.rec_top_coe">docs#with_top.rec_top_coe</a> for example</p>



<a name="290483564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290483564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Ang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290483564">(Jul 22 2022 at 09:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/116395-maths/topic/Additive.20characters/near/290429680">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="https://github.com/leanprover-community/mathlib/pull/15499#pullrequestreview-1046919329">said in a comment on #15499</a>:</p>
<blockquote>
<p>For me this PR raises an interesting question. My impression is that the community are not keen on adding the structure of maps f:A -&gt; G such that f(a+b)=f(a)*f(b), because then we have to make an API for it, and how it composes with additive maps on one side and multiplicative maps on the other side, and then there are maps G -&gt; A and etc etc. Another proposal is to define add_char so that it contains an application of of_add : R -&gt; multiplicative R and then just write add_char.map_add : \psi (a + b) = \psi a * \psi b and a bit more API for it.</p>
<p>My position on this has come from a huge struggle I had in the past using with_top because it would often leak to option, and if you were working with with_top and with_bot then you didn't know whether none was bot or top. Being principled with types in statements of results goes a long way towards stopping this kind of leakage.</p>
</blockquote>
<p>To add to Kevin 's comment above, I find it quite painful to have to use <code>multiplicative R →* R'</code> instead of something like, say, <code>R +→* R'</code> and having to convert between <code>R</code> and <code>multiplicative R</code> via <code>of_add</code> and <code>to_add</code>. (And as one can see from Kevin's comments on the PR, I didn't manage to do it completely right...). If homomorphisms between additive and multiplicative structures also occur in some other places, it may be worth the effort of having dedicated type classes and API for them. Maybe there is a way of auto-generate them, something like a "left" or "right" version of to_additive?</p>
</blockquote>
<p>I am all for having some kind of <code>+→*</code>. From my experience this occurs in quite a few places I care about: additive valuations, Kummer theory, complete 2-descent, Galois cohomology, etc. It was incredibly annoying for me as well, especially when trying to do a <code>quotient_group.map</code> of homomorphisms from + to * to define things like Selmer groups.</p>



<a name="290483730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290483730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Ang <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290483730">(Jul 22 2022 at 09:29)</a>:</h4>
<p>There is a discussion of this in the "map from mult gp to add gp" topic in the general stream.</p>



<a name="290497376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290497376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290497376">(Jul 22 2022 at 12:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="464700">David Ang</span> <a href="#narrow/stream/116395-maths/topic/Additive.20characters/near/290483730">said</a>:</p>
<blockquote>
<p>There is a discussion of this in the "map from mult gp to add gp" topic in the general stream.</p>
</blockquote>
<p>Here is a <a href="#narrow/stream/113488-general/topic/map.20from.20mult.20gp.20to.20add.20gp/near/271703529">link</a> to the other topic.</p>



<a name="290523681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290523681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290523681">(Jul 22 2022 at 15:14)</a>:</h4>
<p><span class="user-mention" data-user-id="239459">@riccardo lasagno</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> The discussion in the other topic notwithstanding, I would like to get the additive characters stuff (<a href="https://github.com/leanprover-community/mathlib/pull/15499">#15499</a>) into mathlib. <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> has looked through it and I think he is OK with it (after the changes I made that he had suggested). When homomorphisms from additive monoids to (multiplicative) monoids are availble, I'll happily adapt the code; it should then be less cumbersome and easier to read and understand. But short-term, I'd like to be able to define Gauss sums (albeit in an ugly way) and prove stuff about them (this would likely be my next PR).</p>



<a name="290529044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290529044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290529044">(Jul 22 2022 at 15:51)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> I'm interested in knowing whether you would still prefer to have <code>+-&gt;*</code>.</p>



<a name="290529053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290529053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290529053">(Jul 22 2022 at 15:51)</a>:</h4>
<p>Because your <code>add_char</code> is exactly that.</p>



<a name="290529094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290529094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290529094">(Jul 22 2022 at 15:51)</a>:</h4>
<p>If you define it for <code>add_monoid</code> and <code>monoid</code> instead of for two rings, then you have your definition.</p>



<a name="290529245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290529245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290529245">(Jul 22 2022 at 15:52)</a>:</h4>
<p>Yes, of course. But what I then do in the file is mostly geared towards the intended use with Gauss sums.</p>



<a name="290529569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290529569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290529569">(Jul 22 2022 at 15:54)</a>:</h4>
<p>I.e., I wouldn't want to (have to) provide the complete API for general homomorphisms from additive monoids to monoids. But when this eventually exists somewhere, I would very much like to use it. However, my impression is that this may take some time, so I'd prefer to proceed for now with what is there (i.e., <code>multiplicative R</code> and friends).</p>



<a name="290531091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290531091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290531091">(Jul 22 2022 at 16:04)</a>:</h4>
<p>Ok. I still think that it is good to make the definition with the weakest assumptions possible, even if you then restrict to <code>comm_ring</code>s directly afterwards.</p>



<a name="290548867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290548867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290548867">(Jul 22 2022 at 18:19)</a>:</h4>
<p>I've changed the definition so that the domain only needs to be an <code>add_monoid</code> and the target, a <code>monoid</code>. I've also removed the definition of <code>trivial</code> and replaced the occurrences by <code>(1 : add_char R R')</code>. And I changed the lemma names as suggested.</p>



<a name="290603774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Additive%20characters/near/290603774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Additive.20characters.html#290603774">(Jul 23 2022 at 09:20)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> If you have time, could you push it to the merge queue? (Unless there is something else that should be changed.)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>