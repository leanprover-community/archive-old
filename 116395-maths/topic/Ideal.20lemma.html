---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Ideal.20lemma.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html">Ideal lemma</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="192114027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114027">(Mar 28 2020 at 09:16)</a>:</h4>
<p>Hello, <br>
I have a little problem ! </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">Test_2</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span><span class="o">:</span><span class="kt">Type</span><span class="o">)[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">][</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">][</span><span class="n">comm_ring</span> <span class="n">C</span><span class="o">]</span>
<span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">)(</span><span class="n">f</span><span class="o">:</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">B</span> <span class="bp">→</span>  <span class="n">C</span><span class="o">)[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">][</span><span class="n">is_ring_hom</span> <span class="n">g</span><span class="o">]:</span>
   <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">g</span> <span class="err">∘</span> <span class="n">f</span><span class="o">)</span> <span class="n">I</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">g</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
   <span class="n">sorry</span><span class="o">,</span>
 <span class="kn">end</span>
</pre></div>



<a name="192114040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114040">(Mar 28 2020 at 09:17)</a>:</h4>
<p>There is map_comp for module but not for ideal ! I don't understand how to deal !!!</p>



<a name="192114210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114210">(Mar 28 2020 at 09:21)</a>:</h4>
<p>I think <code>ideal.map</code> is just sugar over <code>module.map</code>, so you may be able to prove this by just applying <code>module.map_comp</code></p>



<a name="192114564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114564">(Mar 28 2020 at 09:31)</a>:</h4>
<p>Ok, but the little problem  is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> is not <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> module morphism </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">map_comp</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">M₂</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">M₂</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">M₃</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
 <span class="bp">```</span>
</pre></div>



<a name="192114674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114674">(Mar 28 2020 at 09:34)</a>:</h4>
<p>welp, I guess you will have to prove it ;)</p>



<a name="192114745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114745">(Mar 28 2020 at 09:37)</a>:</h4>
<p><code>is_ring_hom</code> is deprecated right? <span class="user-mention" data-user-id="270476">@orlando</span> you should stop using it and use <code>ring_hom</code></p>



<a name="192114748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114748">(Mar 28 2020 at 09:37)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>

<span class="kn">lemma</span> <span class="n">Test_2</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">C</span><span class="o">]</span>
  <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">→</span> <span class="n">C</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">g</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">g</span> <span class="err">∘</span> <span class="n">f</span><span class="o">)</span> <span class="n">I</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">g</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">le_antisymm</span>
  <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hxI</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="err">$</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="n">hxI</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hxI</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="n">hxI</span><span class="o">)</span>
</pre></div>



<a name="192114750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114750">(Mar 28 2020 at 09:37)</a>:</h4>
<p>Kenny can you do this with ring_hom?</p>



<a name="192114758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114758">(Mar 28 2020 at 09:37)</a>:</h4>
<p>Just to show Orlando the bundled approach?</p>



<a name="192114759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114759">(Mar 28 2020 at 09:37)</a>:</h4>
<p>what was that galois connection emoji again</p>



<a name="192114811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114811">(Mar 28 2020 at 09:38)</a>:</h4>
<p><code>ideal.map</code> takes <code>is_ring_hom</code></p>



<a name="192114833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114833">(Mar 28 2020 at 09:39)</a>:</h4>
<p>:-/</p>



<a name="192114842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114842">(Mar 28 2020 at 09:39)</a>:</h4>
<p>refactor time</p>



<a name="192114918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114918">(Mar 28 2020 at 09:41)</a>:</h4>
<p>It's submodule.map we should be talking about not module.map</p>



<a name="192114960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114960">(Mar 28 2020 at 09:42)</a>:</h4>
<p>Ideals are submodules not modules</p>



<a name="192114961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114961">(Mar 28 2020 at 09:42)</a>:</h4>
<p>zulip needs autocompletion</p>



<a name="192114967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192114967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192114967">(Mar 28 2020 at 09:42)</a>:</h4>
<p>And easy ability to input Unicode on phones</p>



<a name="192115168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115168">(Mar 28 2020 at 09:48)</a>:</h4>
<p>I don't understand anything Mario ! But it's work <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="192115267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115267">(Mar 28 2020 at 09:51)</a>:</h4>
<p>What is the  $ ???</p>



<a name="192115272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115272">(Mar 28 2020 at 09:51)</a>:</h4>
<p><code>a $ b c d</code> is just <code>a (b c d)</code></p>



<a name="192115313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115313">(Mar 28 2020 at 09:52)</a>:</h4>
<p><code>$</code> is notation (anything which is not letters and <code>_</code> is usually notation) and you can see what it does with <code>#print notation $</code></p>



<a name="192115325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115325">(Mar 28 2020 at 09:52)</a>:</h4>
<p>we should put that in the faq</p>



<a name="192115342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115342">(Mar 28 2020 at 09:53)</a>:</h4>
<p>The output is <code>_ `$`:1 _:0 := #1 #0</code> which means <code>a $ b := a b</code> and make it right associative and have "power" 1 (which is low). <a href="https://xenaproject.wordpress.com/2019/01/20/a-word-on-bidmas/" title="https://xenaproject.wordpress.com/2019/01/20/a-word-on-bidmas/">Here's more information written for mathematicians</a></p>



<a name="192115411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115411">(Mar 28 2020 at 09:55)</a>:</h4>
<p>It's too bad that looking up info on one piece of unfamimiar notation shows a whole bunch of unfamiliar notation</p>



<a name="192115414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115414">(Mar 28 2020 at 09:55)</a>:</h4>
<p><code>$</code> is particularly bad in this regard</p>



<a name="192115417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115417">(Mar 28 2020 at 09:56)</a>:</h4>
<p>because the binding powers are 1 and 0, and the missing variables are <code>#1</code> and <code>#0</code></p>



<a name="192115468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115468">(Mar 28 2020 at 09:56)</a>:</h4>
<p>and they are numbered in reverse order because de bruijn thought it would be a good idea</p>



<a name="192115485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115485">(Mar 28 2020 at 09:57)</a>:</h4>
<p>Yes, I'm still wondering why he didn't use negative integers, so that they would be ordered the right way <span aria-label="rolling on the floor laughing" class="emoji emoji-1f923" role="img" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>



<a name="192115545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192115545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192115545">(Mar 28 2020 at 09:59)</a>:</h4>
<p>You might naively think he'd want to use non-positive ones, but the negative integers are the inbuilt constructor</p>



<a name="192135913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192135913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192135913">(Mar 28 2020 at 18:35)</a>:</h4>
<p>I make Ideals into a functor <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span> </p>
<p>For the moment and don't understand really the difference between  ring_hom and  <code>(ψ : A ⟶ B)</code></p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">CommRing</span>
<span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">types</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideals</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>
<span class="n">universes</span>  <span class="n">u</span>

<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Ring</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">CommRing</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Set</span><span class="bp">`</span> <span class="o">:=</span>  <span class="kt">Type</span> <span class="n">u</span>

<span class="kn">namespace</span> <span class="n">ideal</span>
<span class="kn">lemma</span> <span class="n">ideal_id</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span><span class="n">I</span> <span class="bp">=</span> <span class="n">I</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">g</span> <span class="o">:</span> <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">I</span> <span class="bp">=</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_id</span> <span class="err">↑</span><span class="n">I</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_eq</span> <span class="n">I</span><span class="o">,</span>
<span class="kn">end</span>
<span class="kn">lemma</span> <span class="n">ideal_comp</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span>  <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">B</span> <span class="err">⟶</span>  <span class="n">C</span><span class="o">)</span>  <span class="o">:</span>
  <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">f</span> <span class="err">≫</span> <span class="n">g</span><span class="o">)</span> <span class="n">I</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">g</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">le_antisymm</span>
  <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hxI</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="err">$</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="n">hxI</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hxI</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">mem_map_of_mem</span> <span class="n">hxI</span><span class="o">)</span>
<span class="kn">end</span> <span class="n">ideal</span>

<span class="kn">namespace</span> <span class="n">Omega</span>
<span class="n">def</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">):=</span> <span class="n">ideal</span> <span class="n">A</span>
<span class="n">def</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">map</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span><span class="n">Ring</span><span class="o">)(</span><span class="n">ψ</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="n">A</span> <span class="bp">→</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="n">B</span><span class="o">:=</span> <span class="bp">λ</span> <span class="n">I</span><span class="o">,</span><span class="k">begin</span>
  <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="n">I</span><span class="o">,</span>
<span class="kn">end</span>
<span class="n">def</span> <span class="err">Ω</span> <span class="o">:</span> <span class="n">Ring</span> <span class="err">⥤</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">obj</span> <span class="o">:=</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">map</span><span class="o">,</span>
  <span class="n">map_id&#39;</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="k">begin</span>
    <span class="n">funext</span> <span class="n">I</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">types_id</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_id</span> <span class="n">A</span> <span class="n">I</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_comp&#39;</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">rintros</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">types_comp</span><span class="o">,</span>
    <span class="n">funext</span> <span class="n">I</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_comp</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">I</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
<span class="kn">end</span><span class="o">,</span>
<span class="o">}</span>
<span class="kn">end</span> <span class="n">Omega</span>
</pre></div>



<a name="192136341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136341">(Mar 28 2020 at 18:46)</a>:</h4>
<p>The difference between <code>ring_hom</code> and <code>is_ring_hom</code> is the same as the difference between <code>CommRing</code> and <code>comm_ring</code>. With <code>ring_hom</code>, the function is "bundled" as part of the structure. With <code>is_ring_hom</code> it is an input. Similarly <code>comm_ring</code> takes an input <code>R</code> but <code>CommRing</code> does not.</p>



<a name="192136358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136358">(Mar 28 2020 at 18:47)</a>:</h4>
<p>There isn't really a difference between those two types of homs. The difference is in what kind of objects you can stick at the end of the arrow (-;<br>
If you use <code>ring_hom</code> you give it two types <code>R</code> and <code>S</code>, and make sure that there are instances of <code>ring R</code> or <code>comm_semiring S</code> etc floating around.<br>
If you use the category theory arrow, then you have to provide objects of the category <code>Ring</code> or <code>CommRing</code>, and those objects are types + a suitable instance, packaged together.</p>



<a name="192136421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136421">(Mar 28 2020 at 18:48)</a>:</h4>
<p><span class="user-mention" data-user-id="270476">@orlando</span> you can replace</p>
<div class="codehilite"><pre><span></span><span class="bp">λ</span> <span class="n">I</span><span class="o">,</span><span class="k">begin</span>
  <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="n">I</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>


<p>with <code>exact ideal.map ψ</code>. You don't even need to enter tactic mode.</p>



<a name="192136427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136427">(Mar 28 2020 at 18:48)</a>:</h4>
<p>Oh! You're talking about the <code>\hom</code> arrow? Right, the only difference is that for one the inputs are unbundled and for the other the inputs are bundled.</p>



<a name="192136442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136442">(Mar 28 2020 at 18:49)</a>:</h4>
<p>Did you see the definition of functor in mathlib?</p>



<a name="192136453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136453">(Mar 28 2020 at 18:49)</a>:</h4>
<p>An exemple : </p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">V_obj</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">R</span><span class="o">)(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">ζ</span> <span class="o">:</span> <span class="n">ring_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="bp">|</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">S</span><span class="o">,</span> <span class="n">ζ</span> <span class="o">(</span><span class="n">x</span><span class="o">)</span>  <span class="bp">=</span> <span class="mi">0</span><span class="o">}</span>
<span class="c1">--- if i use ζ : R ⟶ A i can&#39;t use ζ x = 0 ! Is it normal ?</span>
</pre></div>



<a name="192136511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136511">(Mar 28 2020 at 18:50)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">functor</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u₁</span><span class="o">)</span> <span class="o">[</span><span class="n">category</span><span class="bp">.</span><span class="o">{</span><span class="n">v₁</span><span class="o">}</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">D</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u₂</span><span class="o">)</span> <span class="o">[</span><span class="n">category</span><span class="bp">.</span><span class="o">{</span><span class="n">v₂</span><span class="o">}</span> <span class="n">D</span><span class="o">]</span> <span class="o">:</span>
  <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">v₁</span> <span class="n">v₂</span> <span class="n">u₁</span> <span class="n">u₂</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">obj</span>       <span class="o">:</span> <span class="n">C</span> <span class="bp">→</span> <span class="n">D</span><span class="o">)</span>
<span class="o">(</span><span class="n">map</span>       <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">C</span><span class="o">},</span> <span class="o">(</span><span class="n">X</span> <span class="err">⟶</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">→</span> <span class="o">((</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span> <span class="err">⟶</span> <span class="o">(</span><span class="n">obj</span> <span class="n">Y</span><span class="o">)))</span>
<span class="o">(</span><span class="n">map_id&#39;</span>   <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">),</span> <span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">𝟙</span> <span class="o">(</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>
<span class="o">(</span><span class="n">map_comp&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="err">⟶</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Y</span> <span class="err">⟶</span> <span class="n">Z</span><span class="o">),</span> <span class="n">map</span> <span class="o">(</span><span class="n">f</span> <span class="err">≫</span> <span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span> <span class="err">≫</span> <span class="o">(</span><span class="n">map</span> <span class="n">g</span><span class="o">)</span> <span class="bp">.</span> <span class="n">obviously</span><span class="o">)</span>
</pre></div>


<p>The last two structure fields -- <code>map_id'</code> and <code>map_comp'</code> have <code>. obviously</code> at the end, which means "if the user does not prove them, try proving them yourself with the <code>obviously</code> tactic".</p>



<a name="192136519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136519">(Mar 28 2020 at 18:51)</a>:</h4>
<p>I think it is possible to somehow train <code>obviously</code> to be able to solve these things.</p>



<a name="192136528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136528">(Mar 28 2020 at 18:51)</a>:</h4>
<p>Hum the definition of functor yes but i don't understand  <code> obiously </code> In my case of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span></span></span></span>, without map_id' this doesn't works !</p>



<a name="192136580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136580">(Mar 28 2020 at 18:52)</a>:</h4>
<p>I don't understand it either. <span class="user-mention" data-user-id="110087">@Scott Morrison</span> where do we learn about how to train <code>obviously</code> to solve these cases of <code>map_id'</code> and <code>map_comp'</code>? Does it work like that?</p>



<a name="192136610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136610">(Mar 28 2020 at 18:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192136519" title="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192136519">said</a>:</p>
<blockquote>
<p>I think it is possible to somehow train <code>obviously</code> to be able to solve these things.</p>
</blockquote>
<p>The training is mostly done by proving the right simp-lemmas before you define the functor.</p>



<a name="192136656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136656">(Mar 28 2020 at 18:54)</a>:</h4>
<p>Currently <code>obviously</code> cannot do <code>rw</code></p>



<a name="192136659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136659">(Mar 28 2020 at 18:54)</a>:</h4>
<p>So if your proof really needs to do a <code>rw</code>, then you have to do it your self.</p>



<a name="192136670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136670">(Mar 28 2020 at 18:54)</a>:</h4>
<p>But if the proof is something like <code>intros, ext, simp, assumption</code>, then <code>obviously</code> will fill in the proof for you.</p>



<a name="192136675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136675">(Mar 28 2020 at 18:55)</a>:</h4>
<p>So we need to make it a confluent rewrite situation</p>



<a name="192136815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136815">(Mar 28 2020 at 18:58)</a>:</h4>
<p>I mean, you already did the work manually by proving <code>ideal_id</code> and <code>ideal_comp</code>, it just wasn't quite the right work</p>



<a name="192136831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136831">(Mar 28 2020 at 18:58)</a>:</h4>
<p>So we should be tagging these with <code>simp</code> and also proving something about \Omega_map \b1 or something.</p>



<a name="192136899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136899">(Mar 28 2020 at 19:00)</a>:</h4>
<p>The rewrites in <code>Ω</code> are definitional equalities anyways. You could omit them and write the whole proof in term mode and it would be very short.</p>



<a name="192136901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136901">(Mar 28 2020 at 19:00)</a>:</h4>
<p><span class="user-mention" data-user-id="270476">@orlando</span> you should try and make the following proofs work:</p>
<div class="codehilite"><pre><span></span>  <span class="n">map_id&#39;</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="k">begin</span>
    <span class="n">funext</span> <span class="n">I</span><span class="o">,</span>
   <span class="n">simp</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_comp&#39;</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">rintros</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">funext</span> <span class="n">I</span><span class="o">,</span>
    <span class="n">simp</span>
<span class="kn">end</span><span class="o">,</span>
</pre></div>



<a name="192136912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136912">(Mar 28 2020 at 19:00)</a>:</h4>
<p>Like, shorter than those proofs.</p>



<a name="192136920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136920">(Mar 28 2020 at 19:01)</a>:</h4>
<p>(Although I guess the point is that you won't have to write those proofs because of <code>obviously</code>)</p>



<a name="192136921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136921">(Mar 28 2020 at 19:01)</a>:</h4>
<p>See how far they get, and then if they don't finish the job, look at where they are stuck and add some simp lemmas to unstick them. Or is Reid saying that there's another way?</p>



<a name="192136930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136930">(Mar 28 2020 at 19:01)</a>:</h4>
<p>Isn't <code>map_id' := \lam A, funext (\lam I, ideal.ideal_id A I)</code></p>



<a name="192136935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136935">(Mar 28 2020 at 19:01)</a>:</h4>
<p><code>attribute [simp] ideal.ideal_id</code> I already got</p>



<a name="192136980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136980">(Mar 28 2020 at 19:02)</a>:</h4>
<p>but now I have</p>
<div class="codehilite"><pre><span></span>a : x_1 ∈ Ω_map X X (𝟙 X) x
⊢ x_1 ∈ x
</pre></div>



<a name="192136995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192136995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192136995">(Mar 28 2020 at 19:02)</a>:</h4>
<p>It's better to "inline" <code>Ω_obj</code> <code>Ω_map</code> anyways</p>



<a name="192137017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137017">(Mar 28 2020 at 19:03)</a>:</h4>
<p>i.e.</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="err">Ω</span> <span class="o">:</span> <span class="n">Ring</span> <span class="err">⥤</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">obj</span> <span class="o">:=</span> <span class="n">ideal</span><span class="o">,</span>
   <span class="bp">...</span>
</pre></div>



<a name="192137030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137030">(Mar 28 2020 at 19:03)</a>:</h4>
<div class="codehilite"><pre><span></span>  <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">B</span> <span class="n">ψ</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span><span class="o">,</span>
</pre></div>


<p>I can't get rid of A or psi</p>



<a name="192137074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137074">(Mar 28 2020 at 19:04)</a>:</h4>
<p>Yeah, Lean is sometimes dumb <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="192137093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137093">(Mar 28 2020 at 19:04)</a>:</h4>
<p>The rw  <code>   rw category_theory.types_id, </code> in <code> map_id ' </code> is not necesarry</p>



<a name="192137261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137261">(Mar 28 2020 at 19:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_id</span>

<span class="kn">namespace</span> <span class="n">Omega</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_id</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)</span> <span class="o">(</span><span class="n">J</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">J</span> <span class="bp">=</span> <span class="n">J</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="err">Ω</span> <span class="o">:</span> <span class="n">Ring</span> <span class="err">⥤</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">B</span> <span class="n">ψ</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span><span class="o">,</span>
  <span class="n">map_comp&#39;</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">rintros</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">types_comp</span><span class="o">,</span>
    <span class="n">funext</span> <span class="n">I</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_comp</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span> <span class="n">I</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
<span class="kn">end</span><span class="o">,</span>
<span class="o">}</span>
<span class="kn">end</span> <span class="n">Omega</span>
</pre></div>


<p>I now just get a (deterministic) timeout :-/</p>



<a name="192137263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137263">(Mar 28 2020 at 19:09)</a>:</h4>
<p>(having removed <code>map_id'</code>)</p>



<a name="192137349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137349">(Mar 28 2020 at 19:11)</a>:</h4>
<p>wait what? <code>map_id' := begin intros, ext, simp end</code> works fine, but <code>obviously</code> just gets stuck in a loop :-(</p>



<a name="192137399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137399">(Mar 28 2020 at 19:12)</a>:</h4>
<p>No, I tell a lie!</p>



<a name="192137438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137438">(Mar 28 2020 at 19:13)</a>:</h4>
<p>I had assumed that this was going to end badly, but in fact it compiles fine!</p>
<div class="codehilite"><pre><span></span>elaboration of Ω took 75.4s
</pre></div>



<a name="192137482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137482">(Mar 28 2020 at 19:14)</a>:</h4>
<p>Scott -- is this a new record?</p>



<a name="192137490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137490">(Mar 28 2020 at 19:14)</a>:</h4>
<p>can you have <code>tidy</code> print a trace, then?</p>



<a name="192137495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137495">(Mar 28 2020 at 19:14)</a>:</h4>
<div class="codehilite"><pre><span></span>elaboration: tactic execution took 69.8s
num. allocated objects:  1711
num. allocated closures: 1503
num. allocated big nums: 4
69848ms   100.0%   tactic.replacer
69848ms   100.0%   interaction_monad_orelse
69848ms   100.0%   tactic.istep
69848ms   100.0%   tactic.chain_core
69848ms   100.0%   tactic.chain_many
69848ms   100.0%   tactic.tidy.core
69848ms   100.0%   tactic.step
69848ms   100.0%   tactic.chain_many._main._lambda_1
69848ms   100.0%   _interaction._lambda_2
69848ms   100.0%   tactic.istep._lambda_1
69848ms   100.0%   tactic.tidy
69848ms   100.0%   tactic.first
69848ms   100.0%   tactic.chain_single
69848ms   100.0%   tactic.chain
69848ms   100.0%   _interaction
69848ms   100.0%   tactic.replacer_core
69848ms   100.0%   scope_trace
69848ms   100.0%   tactic.replacer_core._main._lambda_4
69800ms    99.9%   tactic.tidy.default_tactics._lambda_3
68698ms    98.4%   tactic.to_expr
68698ms    98.4%   tactic.tidy.default_tactics._lambda_4
68698ms    98.4%   tactic.interactive.exact
 1014ms     1.5%   tactic.tidy.default_tactics._lambda_8
 1013ms     1.5%   tactic.interactive.dsimp
...
</pre></div>



<a name="192137521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137521">(Mar 28 2020 at 19:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192137490" title="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192137490">said</a>:</p>
<blockquote>
<p>can you have <code>tidy</code> print a trace, then?</p>
</blockquote>
<p>just a minute</p>



<a name="192137585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137585">(Mar 28 2020 at 19:16)</a>:</h4>
<p>Oh I just changed <code>obviously</code> to <code>tidy</code> assuming that this was what you meant, and it's no different. How do I get tidy to print a trace?</p>



<a name="192137592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137592">(Mar 28 2020 at 19:17)</a>:</h4>
<p><code>tidy?</code> I think?</p>



<a name="192137600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137600">(Mar 28 2020 at 19:17)</a>:</h4>
<p>just a minute</p>



<a name="192137682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137682">(Mar 28 2020 at 19:18)</a>:</h4>
<p>or slightly longer in this case</p>



<a name="192137689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137689">(Mar 28 2020 at 19:18)</a>:</h4>
<div class="codehilite"><pre><span></span>Try this: intros X, dsimp at *, ext1, dsimp at *, simp at *
</pre></div>



<a name="192137714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137714">(Mar 28 2020 at 19:19)</a>:</h4>
<p>sometimes it is better to write the 1-line term mode proof and move on</p>



<a name="192137718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137718">(Mar 28 2020 at 19:19)</a>:</h4>
<p>Oh but that compiles in a reasonable time -- elaboration takes 1 second</p>



<a name="192137765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137765">(Mar 28 2020 at 19:20)</a>:</h4>
<p>I guess it could be trying other things that fail</p>



<a name="192137778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137778">(Mar 28 2020 at 19:20)</a>:</h4>
<p>So every time there's an <code>obviously</code> used in the library, we might be losing up to a minute of compile time when we could just go through them all and replace them with the one-liners which obviously finds, thus speeding up compile time but making the code look uglier.</p>



<a name="192137794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137794">(Mar 28 2020 at 19:21)</a>:</h4>
<p>(<a href="https://github.com/leanprover-community/mathlib/pull/1204" title="https://github.com/leanprover-community/mathlib/pull/1204">https://github.com/leanprover-community/mathlib/pull/1204</a>)</p>



<a name="192137851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137851">(Mar 28 2020 at 19:22)</a>:</h4>
<p>It might be fun to count how many times there is a transparent call to <code>obviously</code> in the library. Probably a lot.</p>



<a name="192137853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137853">(Mar 28 2020 at 19:22)</a>:</h4>
<p><code>obviously</code> should learn to tidy up after itself: it found <code>intros X, dsimp at *, ext1, dsimp at *, simp at *</code> but <code>intros X, ext1, simp</code> also works and is in some sense a strict subset of the proof originally found.</p>



<a name="192137938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192137938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192137938">(Mar 28 2020 at 19:24)</a>:</h4>
<p>Yes I remember some discussion about this sort of thing when we were doing the T5000 challenge or whatever it was called. But I didn't understand things so well then -- I was more concerned with learning how to do mathematics in Lean at that time rather than learning how it all actually worked.</p>



<a name="192138010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192138010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192138010">(Mar 28 2020 at 19:27)</a>:</h4>
<p>Hey many thanks for that link Rob -- there's a link to the T50000 thread and for me it's well worth a re-read. In particular Floris' comment to me near the top used to say (to me) "blah blah blah, it's like proving 1000+1000=2000 by rfl" which showed me what the problem basically was, but now I can understand what the problem actually was. At the time \ggg terrified me.</p>



<a name="192138822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192138822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192138822">(Mar 28 2020 at 19:51)</a>:</h4>
<p>I read slowly, </p>
<p>So Kevin this work ! </p>
<div class="codehilite"><pre><span></span><span class="n">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_id</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">ideal_comp</span>
<span class="kn">namespace</span> <span class="n">Omega</span>
<span class="n">def</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">):=</span> <span class="n">ideal</span> <span class="n">A</span>
<span class="n">def</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">map</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span><span class="n">Ring</span><span class="o">)(</span><span class="n">ψ</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="n">A</span> <span class="bp">→</span> <span class="err">Ω</span><span class="bp">_</span><span class="n">obj</span> <span class="n">B</span><span class="o">:=</span> <span class="bp">λ</span> <span class="n">I</span><span class="o">,</span><span class="k">begin</span>
  <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="n">I</span><span class="o">,</span>
<span class="kn">end</span>
<span class="n">def</span> <span class="err">Ω</span> <span class="o">:</span> <span class="n">Ring</span> <span class="err">⥤</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">obj</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="n">ideal</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">map</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">B</span> <span class="n">ψ</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span><span class="o">,</span>

<span class="o">}</span>
<span class="kn">end</span> <span class="n">Omega</span>
</pre></div>



<a name="192138823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192138823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192138823">(Mar 28 2020 at 19:51)</a>:</h4>
<p>it's your code !</p>



<a name="192138892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192138892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192138892">(Mar 28 2020 at 19:53)</a>:</h4>
<p>You can delete <code>\Omega_obj</code> and <code>Omega_map</code> -- Reid says it's better to just define them directly in the structure (like you are doing now)</p>



<a name="192138931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192138931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192138931">(Mar 28 2020 at 19:54)</a>:</h4>
<p>yes !</p>



<a name="192139875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192139875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192139875">(Mar 28 2020 at 20:19)</a>:</h4>
<p>Does your code now take 10 minutes to compile though? :-/</p>



<a name="192140401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140401">(Mar 28 2020 at 20:32)</a>:</h4>
<p>20 seconde with simp and   1 seconde with the first code !</p>



<a name="192140475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140475">(Mar 28 2020 at 20:34)</a>:</h4>
<p>I will make a natural transformation <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>→</mo><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex"> \Omega \to \Omega</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span></span></span></span> given by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>↦</mo><msup><mi>I</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">I  \mapsto I^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69433em;vertical-align:-0.011em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> , that's fun  <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="192140834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140834">(Mar 28 2020 at 20:45)</a>:</h4>
<p>Well you can either prove the missing lemmas with <code>tidy</code> and then click on "try this" (and then it will be quick again) or you can finish this file now, compile it into an olean file, and then import it :-)</p>



<a name="192140888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140888">(Mar 28 2020 at 20:46)</a>:</h4>
<p>hum what is olean ?</p>



<a name="192140892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140892">(Mar 28 2020 at 20:46)</a>:</h4>
<p>perhaps i don't understand "compile"</p>



<a name="192140902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140902">(Mar 28 2020 at 20:47)</a>:</h4>
<p>Are you making these files in a lean project? I hope so. You can just stop editing this file now and start a new file and import this file</p>



<a name="192140957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140957">(Mar 28 2020 at 20:48)</a>:</h4>
<p>Because this file takes 20 seconds to compile now (the orange bars) but if you import it then it will just compile once and then never compile again until you restart VS code or lean</p>



<a name="192140964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140964">(Mar 28 2020 at 20:48)</a>:</h4>
<p>Yes yes in a lean project, ok</p>



<a name="192140967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140967">(Mar 28 2020 at 20:48)</a>:</h4>
<p>i understand</p>



<a name="192140990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192140990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192140990">(Mar 28 2020 at 20:49)</a>:</h4>
<p>Or alternatively you can write <code>lean --make path/to/file.lean</code> and then you will have a compiled olean file on your computer</p>



<a name="192141041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141041">(Mar 28 2020 at 20:50)</a>:</h4>
<p>And then even after you restart lean and Vs code it will still be quick because the olean file stores the 20 seconds</p>



<a name="192141051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141051">(Mar 28 2020 at 20:50)</a>:</h4>
<p>The reason you don't get orange bars for one hour when you start to use mathlib is because all the oleans are on your computer thanks to leanproject</p>



<a name="192141064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141064">(Mar 28 2020 at 20:51)</a>:</h4>
<p>ohhh ok !!!</p>



<a name="192141072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141072">(Mar 28 2020 at 20:51)</a>:</h4>
<p>But in your project there are probably no olean files</p>



<a name="192141116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141116">(Mar 28 2020 at 20:52)</a>:</h4>
<p>So every time you open the project it has to compile all the files you made which you use or import</p>



<a name="192141130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141130">(Mar 28 2020 at 20:53)</a>:</h4>
<p>And if one of them takes 20 seconds then this is a pain</p>



<a name="192141248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141248">(Mar 28 2020 at 20:57)</a>:</h4>
<p>hum i do lean --make but i don't see olean file !</p>



<a name="192141546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141546">(Mar 28 2020 at 21:05)</a>:</h4>
<p>Do lean --make src/file.lean and it will make file.olean in src</p>



<a name="192141615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192141615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192141615">(Mar 28 2020 at 21:07)</a>:</h4>
<p>is <code>leanpkg build</code> no longer a cool thing to do?</p>



<a name="192144348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192144348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192144348">(Mar 28 2020 at 22:23)</a>:</h4>
<p>Leanproject build ftw</p>



<a name="192223860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192223860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192223860">(Mar 30 2020 at 08:15)</a>:</h4>
<p>Hello,  just a question <br>
0/  Omega is the previous files. <br>
1/ In square_ideal_naturality : is it possible to simplify the construction without using the line <code> have H : (Ω.map ψ ∘ square_ideal_app A) I = ideal.map ψ (I * I) </code> and do the <code>rw H </code> directly ?  </p>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">Omega</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span><span class="n">Ring</span><span class="o">)</span>
<span class="n">def</span> <span class="n">square_ideal_app</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">A</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">I</span><span class="o">,</span> <span class="k">begin</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">I</span> <span class="bp">*</span> <span class="n">I</span><span class="o">),</span>
<span class="kn">end</span>
<span class="n">def</span> <span class="n">square_ideal_naturality</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span><span class="n">Ring</span><span class="o">)</span> <span class="o">(</span><span class="n">ψ</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span>  <span class="o">:</span>
    <span class="err">Ω</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="err">≫</span> <span class="n">square_ideal_app</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">square_ideal_app</span> <span class="n">A</span> <span class="err">≫</span> <span class="err">Ω</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">category_theory</span><span class="bp">.</span><span class="n">types_comp</span><span class="o">,</span><span class="n">category_theory</span><span class="bp">.</span><span class="n">types_comp</span><span class="o">],</span>
    <span class="n">funext</span>  <span class="n">I</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">H</span> <span class="o">:</span> <span class="o">(</span><span class="err">Ω</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="err">∘</span> <span class="n">square_ideal_app</span> <span class="n">A</span><span class="o">)</span> <span class="n">I</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">ψ</span> <span class="o">(</span><span class="n">I</span> <span class="bp">*</span> <span class="n">I</span><span class="o">),</span>
      <span class="n">exact</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">H</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_mul</span> <span class="n">ψ</span> <span class="n">I</span> <span class="n">I</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="kn">end</span>
<span class="n">def</span> <span class="n">square_ideal</span> <span class="o">:</span>  <span class="err">Ω</span>  <span class="err">⟶</span> <span class="err">Ω</span> <span class="o">:=</span>
<span class="o">{</span>
    <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">,</span> <span class="n">square_ideal_app</span> <span class="n">A</span><span class="o">,</span>
    <span class="n">naturality&#39;</span> <span class="o">:=</span> <span class="n">square_ideal_naturality</span><span class="o">,</span>
<span class="o">}</span>
<span class="kn">end</span> <span class="n">Omega_2</span>
</pre></div>



<a name="192224693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192224693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192224693">(Mar 30 2020 at 08:25)</a>:</h4>
<p><code>rw [show _ = _, from rfl]</code></p>



<a name="192225486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/192225486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#192225486">(Mar 30 2020 at 08:33)</a>:</h4>
<p>Ok, thx Kenny,</p>



<a name="193238019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193238019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193238019">(Apr 07 2020 at 19:43)</a>:</h4>
<p>Hello,</p>
<p>Another problem with Ideal <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span>   </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">CommRing</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideals</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>
<span class="n">universes</span> <span class="n">u</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Ring</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">CommRing</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Set</span><span class="bp">`</span> <span class="o">:=</span>  <span class="kt">Type</span> <span class="n">u</span>

<span class="kn">lemma</span> <span class="n">set_image_S_subset_set_image_span_S</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
<span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span> <span class="err">⊆</span>  <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_subset</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">,</span>
<span class="kn">end</span>


<span class="kn">lemma</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_span_eq_span_image</span><span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">):</span>
    <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">)</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">unfold</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_mono</span> <span class="o">(</span><span class="n">set_image_S_subset_set_image_span_S</span> <span class="n">A</span> <span class="n">B</span> <span class="n">f</span> <span class="n">S</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">ccl</span> <span class="o">:</span> <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="err">⊆</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">),</span>
        <span class="n">sorry</span><span class="o">,</span> <span class="c1">---- HERE !!!!</span>
    <span class="n">apply</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_le</span><span class="bp">.</span><span class="mi">2</span> <span class="n">ccl</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>



<a name="193238577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193238577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193238577">(Apr 07 2020 at 19:48)</a>:</h4>
<p>Here is the proof for <code>submonoid</code>s:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">closure_preimage_le</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*</span> <span class="n">N</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">N</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">closure</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">s</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">closure</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="o">:=</span>
<span class="n">closure_le</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="n">mem_coe</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">mem_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">subset_closure</span> <span class="n">hx</span>

<span class="kn">lemma</span> <span class="n">map_mclosure</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*</span> <span class="n">N</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">closure</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">closure</span> <span class="o">(</span><span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">s</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">le_antisymm</span>
  <span class="o">(</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">le_trans</span> <span class="o">(</span><span class="n">closure_mono</span> <span class="err">$</span> <span class="n">set</span><span class="bp">.</span><span class="n">subset_preimage_image</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span>
    <span class="o">(</span><span class="n">closure_preimage_le</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">))</span>
  <span class="o">(</span><span class="n">closure_le</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_subset</span> <span class="bp">_</span> <span class="n">subset_closure</span><span class="o">)</span>
</pre></div>



<a name="193238671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193238671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193238671">(Apr 07 2020 at 19:49)</a>:</h4>
<p>I think that something similar can be done for ideals as well.</p>



<a name="193239543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193239543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193239543">(Apr 07 2020 at 19:56)</a>:</h4>
<p>ok  i thinck <code> (closure_le.2 $ set.image_subset _ subset_closure) </code>  is the same than my  <code> exact ideal.span_mono (set_image_S_subset_set_image_span_S A B f S), </code> </p>
<p>So if i understand, i have to deal with <code> comap </code>  ...  ahah Kenny play also with comap at the beginning of the topic  <a href="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192114748" title="#narrow/stream/116395-maths/topic/Ideal.20lemma/near/192114748">here</a></p>



<a name="193239634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193239634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193239634">(Apr 07 2020 at 19:57)</a>:</h4>
<p><code>comap</code> is the preimage</p>



<a name="193241873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193241873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193241873">(Apr 07 2020 at 20:16)</a>:</h4>
<p><code>map</code> = image = pushforward, <code>comap</code> = pullback = preimage</p>



<a name="193242963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193242963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193242963">(Apr 07 2020 at 20:27)</a>:</h4>
<p>Ok perhaps it's not the shortest proof <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">CommRing</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideals</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>
<span class="n">universes</span> <span class="n">u</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Ring</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">CommRing</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Set</span><span class="bp">`</span> <span class="o">:=</span>  <span class="kt">Type</span> <span class="n">u</span>
<span class="kn">lemma</span> <span class="n">set_image_S_subset_set_image_span_S</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
<span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span> <span class="err">⊆</span>  <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_subset</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_span_eq_span_image</span><span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">):</span>
    <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">)</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="c1">-- unfold ideal.map,</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_mono</span> <span class="o">(</span><span class="n">set_image_S_subset_set_image_span_S</span> <span class="n">A</span> <span class="n">B</span> <span class="n">f</span> <span class="n">S</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">ccl3</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">≤</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">)),</span>
        <span class="n">unfold</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">comap</span><span class="o">,</span>
        <span class="k">have</span> <span class="n">T</span> <span class="o">:</span> <span class="n">S</span> <span class="err">⊆</span> <span class="err">⇑</span><span class="n">f</span> <span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="err">↑</span><span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="err">⇑</span><span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">S</span><span class="o">)),</span>
            <span class="k">have</span> <span class="n">T&#39;</span> <span class="o">:</span> <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span> <span class="err">⊆</span> <span class="err">↑</span><span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="err">⇑</span><span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">S</span><span class="o">)),</span>
                <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">,</span>
            <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_subset_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="n">T&#39;</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">T</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">ccl2</span> <span class="o">:</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span> <span class="bp">≤</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">)),</span>
           <span class="n">apply</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_le</span><span class="bp">.</span><span class="mi">2</span> <span class="n">ccl3</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">ccl</span> <span class="o">:</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="bp">≤</span>  <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">),</span>
        <span class="n">apply</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="n">ccl2</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ccl</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>



<a name="193244039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193244039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193244039">(Apr 07 2020 at 20:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">set_image_S_subset_set_image_span_S</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
<span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span> <span class="err">⊆</span>  <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_subset</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_span_eq_span_image</span><span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">):</span>
    <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">S</span><span class="o">)</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_mono</span> <span class="o">(</span><span class="n">set_image_S_subset_set_image_span_S</span> <span class="n">A</span> <span class="n">B</span> <span class="n">f</span> <span class="n">S</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">2</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span_le</span><span class="bp">.</span><span class="mi">2</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">image_subset_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">))),</span>
<span class="kn">end</span>
</pre></div>



<a name="193244114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193244114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193244114">(Apr 07 2020 at 20:36)</a>:</h4>
<p>shorter <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="193244938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193244938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193244938">(Apr 07 2020 at 20:44)</a>:</h4>
<p>I wonder what is the general statement here. Probably it should involve four <code>galois_insertion</code>s (two closure/coe, image/preimage, and map/comap).</p>



<a name="193246609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193246609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193246609">(Apr 07 2020 at 20:54)</a>:</h4>
<p>Hey @orlando it's great that your proofs got shorter -- now can you write them in term mode? That way they will compile quicker</p>



<a name="193246689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193246689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193246689">(Apr 07 2020 at 20:55)</a>:</h4>
<p>I'm not sure this is true.</p>



<a name="193246705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193246705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193246705">(Apr 07 2020 at 20:55)</a>:</h4>
<p>Opening up tactic mode has a cost, no?</p>



<a name="193247166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193247166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193247166">(Apr 07 2020 at 20:59)</a>:</h4>
<p>For short proofs this should be true but for longer proofs elaborating parts one after another may help Lean. At least I remember some proofs that were failing in term mode because Lean wanted to elaborate arguments left to right. Rewriting using <code>refine; exact</code> made them work. I suspect that it's possible to make an example where "fails" will be replaced by "slow".</p>



<a name="193247185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193247185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193247185">(Apr 07 2020 at 20:59)</a>:</h4>
<p>without Begin end ??? Kevin ?</p>



<a name="193247930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193247930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193247930">(Apr 07 2020 at 21:05)</a>:</h4>
<p>BTW, you can use <code>#print</code> to see the term mode proof generated by your tactic mode proof.</p>



<a name="193248009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193248009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193248009">(Apr 07 2020 at 21:05)</a>:</h4>
<p>It can be much longer than the tactic proof.</p>



<a name="193467032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193467032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193467032">(Apr 09 2020 at 15:34)</a>:</h4>
<p>hum another problem i don't know how to do this without the description in term of linear combinaison <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span> </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">CommRing</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideals</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">Ring</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">CommRing</span><span class="bp">.</span>
<span class="kn">lemma</span> <span class="n">inverse_image_ideal</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">Ring</span><span class="o">)(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="err">⟶</span> <span class="n">B</span><span class="o">)(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">preimage</span> <span class="n">f</span> <span class="n">S</span><span class="o">)</span> <span class="bp">=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
    <span class="k">begin</span>
        <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>  <span class="c1">-- double inclusion</span>
        <span class="n">rw</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">span_le</span><span class="o">,</span>   <span class="c1">-- span S \leq I ↔  S ≤ I</span>
        <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">preimage_mono</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">subset_span</span><span class="o">,</span>
        <span class="n">sorry</span><span class="o">,</span>
    <span class="kn">end</span>
</pre></div>



<a name="193468172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193468172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193468172">(Apr 09 2020 at 15:43)</a>:</h4>
<p>Is this true?</p>



<a name="193468273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193468273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193468273">(Apr 09 2020 at 15:44)</a>:</h4>
<p>What about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">A=\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi mathvariant="double-struck">C</mi></mrow><annotation encoding="application/x-tex">B=\mathbb{C}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">C</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">{</mo><mi>π</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S=\{\pi\}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mclose">}</span></span></span></span>?</p>



<a name="193468627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193468627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193468627">(Apr 09 2020 at 15:46)</a>:</h4>
<p>You have access to "proof using linear combination" with things like <code>submodule.span_induction</code></p>



<a name="193471124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Ideal%20lemma/near/193471124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> orlando <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Ideal.20lemma.html#193471124">(Apr 09 2020 at 16:03)</a>:</h4>
<p><span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span> <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>