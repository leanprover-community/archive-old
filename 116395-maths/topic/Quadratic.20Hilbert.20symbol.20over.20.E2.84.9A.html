---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html">Quadratic Hilbert symbol over ℚ</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="278066950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278066950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278066950">(Apr 06 2022 at 18:31)</a>:</h4>
<p>As already mentioned in a different thread, I have written code that defines the (quadratic) Hilbert symbol for rational numbers and proves (among other properties) the product formula.<br>
There appears to be interest to include this into mathlib, so I'll try to break this up (it is several thousand lines of code) into a number of reasonably-sized PRs, which I'm going to discuss here first.</p>



<a name="278067337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278067337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278067337">(Apr 06 2022 at 18:34)</a>:</h4>
<p>The overall plan is roughly as follows.</p>
<ul>
<li>Define a type for places of ℚ</li>
<li>
<p>Define the symbol on integers and separately for</p>
<ul>
<li>the place at infinity</li>
<li>the place 2</li>
<li>the odd places<br>
by an explicit formula</li>
</ul>
</li>
<li>
<p>Prove properties (symmetry, multiplicativity, ...) in each case separately</p>
</li>
<li>Then conclude that these properties are valid in general (over the integers)</li>
<li>Prove the product formula (over the integers) by multiplicativity using quadratic reciprocity</li>
<li>Define the symbol over ℚ via the integral version and prove the relevant things over ℚ</li>
</ul>



<a name="278067935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278067935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278067935">(Apr 06 2022 at 18:39)</a>:</h4>
<p>Do you think it's worth defining a type of places for a general number field and then proving that the places of \Q are what we know they are? Other than that, this looks like a fine plan</p>



<a name="278068435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278068435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278068435">(Apr 06 2022 at 18:44)</a>:</h4>
<p>In particular, I am relying on Quadratic Reciprocity (and the auxiliary laws), so I need to use properties of the Legendre symbol. The relevant file, <a href="https://leanprover-community.github.io/mathlib_docs/number_theory/quadratic_reciprocity.html#zmod.legendre_sym">number_theory.quadratic_reciprocity</a>, unfortunately does not have a lot of API lemmas, and some of those that are there are only for natural numbers <code>a</code> (in the symbol <code>(a/p)</code>), whereas the symbol is defined for integers <code>a</code>. This is a bit painful, since there is no obvious reduction to natural numbers.<br>
So I propose to change the lemmas that are there to deal with integers <code>a</code> (using search in VScode, I checked that they arenot used outside the file) and add some new ones that I find useful. Does that sound like a good first step?</p>



<a name="278068941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278068941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278068941">(Apr 06 2022 at 18:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278067935">said</a>:</p>
<blockquote>
<p>Do you think it's worth defining a type of places for a general number field and then proving that the places of \Q are what we know they are? Other than that, this looks like a fine plan</p>
</blockquote>
<p>I want to define <code>def hilbert_sym (v : plcℚ) (a b : ℚ) : ℤ := ...</code>, where <code>plcℚ</code> is the type for places of ℚ, and then be able to do case distinctions according to the nature of the place (so that I can invoke the explicit definitions). For this purpose, my simple-minded definition</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[derive decidable_eq]</span>
<span class="kd">inductive</span> <span class="n">plcℚ</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">infty</span> <span class="o">:</span> <span class="n">plcℚ</span> <span class="c1">-- the place at infinity</span>
<span class="bp">|</span> <span class="n">finpl</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">fact</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">:</span> <span class="n">plcℚ</span> <span class="c1">-- finite places correspond to prime numbers</span>
</code></pre></div>
<p>works fine. (One question here is whether <code>hp</code> should better be a type class instance argument.)</p>



<a name="278068980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278068980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278068980">(Apr 06 2022 at 18:48)</a>:</h4>
<p>For my purposes right now, places of general number fields seem to be overkill.</p>



<a name="278069004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278069004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278069004">(Apr 06 2022 at 18:48)</a>:</h4>
<p>But it would make sense to eventually have suitable glue.</p>



<a name="278070914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278070914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278070914">(Apr 06 2022 at 19:03)</a>:</h4>
<p>I seem to recall Ostrowski's theorem being formalized somewhere...</p>



<a name="278071176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278071176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278071176">(Apr 06 2022 at 19:05)</a>:</h4>
<p><a href="https://github.com/RaitoBezarius/berkovich-spaces">https://github.com/RaitoBezarius/berkovich-spaces</a> is the relevant repo, but it seems that this never made it into mathlib</p>



<a name="278071198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278071198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278071198">(Apr 06 2022 at 19:05)</a>:</h4>
<p>(deleted)</p>



<a name="278080116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278080116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278080116">(Apr 06 2022 at 20:15)</a>:</h4>
<p>At one point I tried to generalize the Legendre symbol file to integers completely</p>



<a name="278080212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278080212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278080212">(Apr 06 2022 at 20:16)</a>:</h4>
<p>So what happened to that attempt?</p>



<a name="278080297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278080297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278080297">(Apr 06 2022 at 20:17)</a>:</h4>
<p>But I remember it being a bit subtle / annoying to convert some of the proofs there. A lot of it should be doable though, but it's not clear to me if it's easiest to generalize the proofs or to just add the integer versions using the natural ones and dealing with negation appropriately</p>



<a name="278080370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278080370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278080370">(Apr 06 2022 at 20:17)</a>:</h4>
<p>I will try to find it tomorrow. It may be on GitHub or on my computer or deleted unfortunately</p>



<a name="278080634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278080634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278080634">(Apr 06 2022 at 20:19)</a>:</h4>
<p>OK; I hadn't yet looked at the proofs in that file in detail. I was assuming that it should in fact be more natural to work with integers. I'll wait to see if you find something.</p>



<a name="278113824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278113824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278113824">(Apr 07 2022 at 03:38)</a>:</h4>
<p>Shouldn't we generalize to the Jacobi symbol, or something like that?</p>



<a name="278114608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278114608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278114608">(Apr 07 2022 at 03:56)</a>:</h4>
<p>Another direction of generalization would be Hilbert symbol -&gt; <a href="https://en.wikipedia.org/wiki/Steinberg_symbol">Steinberg symbol</a> :) A lot of basic algebraic K-theory seems low-hanging ...</p>



<a name="278114885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278114885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278114885">(Apr 07 2022 at 04:00)</a>:</h4>
<p>Yeah it would take about 5 minutes to define Milnor K theory. I actually have some (other) applications for this in mind. Maybe we should just do it! Proving that the tame symbol and norm maps are well defined should be a fun project.</p>



<a name="278126504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278126504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278126504">(Apr 07 2022 at 07:30)</a>:</h4>
<p>You should just do it. We have things like definition of flat and projective modules with very little API because we're not quite ready for the API (need more homological algebra) but it was clear what the definition should be</p>



<a name="278423323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278423323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278423323">(Apr 09 2022 at 18:17)</a>:</h4>
<p>I'm not sure whether I should open a new topic on this, but it is related to my attempt at refactoring the Legendre symbol code.</p>
<p>The present file <a href="https://leanprover-community.github.io/mathlib_docs/number_theory/quadratic_reciprocity.html">number_theory/quadratic_reciprocity</a> uses <code>[fact (p % 2 = 1)]</code> in a number of places. Doing <code>grep</code> with <code>fact (.* % 2 = 1)</code> over all of mathlib shows that it is used exactly twice elsewhere: <a href="https://leanprover-community.github.io/mathlib_docs/find/zmod.le_div_two_iff_lt_neg">docs#zmod.le_div_two_iff_lt_neg</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/zmod.ne_neg_self">docs#zmod.ne_neg_self</a>. Of these two, the first apears to be used nowhere, and the second is used only in quadratic_reciprocity.</p>
<p>My question is, is it at all useful to have statements depending on <code>[fact (n % 2 = 1)]</code>? Or would it be better to just add explicit hypotheses? In the Legendre symbol code, I would prefer to have an explicit hypothesis <code>p ≠ 2</code> instead. Opinions?</p>



<a name="278423425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278423425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278423425">(Apr 09 2022 at 18:19)</a>:</h4>
<p>(<code>#find fact (_ % 2) = 1</code> times out, BTW...)</p>



<a name="278423922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278423922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278423922">(Apr 09 2022 at 18:30)</a>:</h4>
<p>If you need it everywhere then another possibility is just to add it as a hypothesis and then <code>include</code> it. The <code>fact</code> solution for adding a fact everywhere is not a great one.</p>



<a name="278424383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278424383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278424383">(Apr 09 2022 at 18:41)</a>:</h4>
<p>I have no problem with adding explicit hypotheses where I need them.</p>



<a name="278424434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278424434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278424434">(Apr 09 2022 at 18:42)</a>:</h4>
<p>Of course, most statements about the Legendre symbol need that <code>p</code> is an odd prime, but for some, it is not necessary (the way it is defined).</p>



<a name="278424463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278424463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278424463">(Apr 09 2022 at 18:43)</a>:</h4>
<p>Another question: is there a naming convention for statements that say that something is a multiplicative function? Concretely, I have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">legendre_sym_mult</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">legendre_sym</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">legendre_sym</span> <span class="n">a</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">legendre_sym</span> <span class="n">b</span> <span class="n">p</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>
<p>(add <code>(p : nat) [fact p.prime])</code> but I am not sure about the name...</p>



<a name="278425485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425485">(Apr 09 2022 at 19:06)</a>:</h4>
<p>Mathlib's definition of the Legendre symbol is wrong for <code>p = 2</code>, isn't it?</p>



<a name="278425496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425496">(Apr 09 2022 at 19:07)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> The name would be <code>legendre_sym_mul</code>, or possibly <code>mul_left</code> if you think it's ambiguous.</p>



<a name="278425552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425552">(Apr 09 2022 at 19:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278425485">said</a>:</p>
<blockquote>
<p>Mathlib's definition of the Legendre symbol is wrong for <code>p = 2</code>, isn't it?</p>
</blockquote>
<p>The Legendre symbol is only defined when the second argument is an odd prime, so there is no "wrong" definition...</p>



<a name="278425565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425565">(Apr 09 2022 at 19:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278425496">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> The name would be <code>legendre_sym_mul</code>, or possibly <code>mul_left</code> if you think it's ambiguous.</p>
</blockquote>
<p>I'll change the name to <code>legendre_sym_mul</code> then, since there is no <code>mul_right</code>. (That would be different for the Jacobi symbol.)</p>



<a name="278425681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425681">(Apr 09 2022 at 19:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278425552">said</a>:</p>
<blockquote>
<p>The Legendre symbol is only defined when the second argument is an odd prime, so there is no "wrong" definition...</p>
</blockquote>
<p>Aah, ok. But the Legendre symbol for <code>p = 2</code> is also not computing what's needed for quadratic reciprocity with <code>p = 2</code>. I think that's what I remembered, at least.</p>



<a name="278425734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425734">(Apr 09 2022 at 19:12)</a>:</h4>
<p>Unless somebody objects, I will also replace the <code>[fact (p % 2 = 1)]</code> arguments with <code>p  ≠ 2</code>s.</p>



<a name="278425758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425758">(Apr 09 2022 at 19:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278425681">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278425552">said</a>:</p>
<blockquote>
<p>The Legendre symbol is only defined when the second argument is an odd prime, so there is no "wrong" definition...</p>
</blockquote>
<p>Aah, ok. But the Legendre symbol for <code>p = 2</code> is also not computing what's needed for quadratic reciprocity with <code>p = 2</code>. I think that's what I remembered, at least.</p>
</blockquote>
<p>One could try to define <code>(a / 2)</code> so that QR works. But then the problem is that 2 is neither 1 nor 3 mod 4, so it is not clear what the "correct" version of QR would be.</p>



<a name="278425827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425827">(Apr 09 2022 at 19:14)</a>:</h4>
<p>I agree that using <code>p ≠ 2</code> assumptions makes more sense than <code>[fact (p % 2 = 1)]</code>. I think the QR file is pretty old. We didn't haven an even/odd API back then either.</p>



<a name="278425848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425848">(Apr 09 2022 at 19:15)</a>:</h4>
<p>The copyright notice says 2018. I have no idea what "pretty old" means for mathlib <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="278425858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425858">(Apr 09 2022 at 19:15)</a>:</h4>
<p>If you define <code>legendre a p = if (a : zmod p) = 0 then 0 else if is_square (a : zmod p) then 1 else -1</code>, then you get something different from what we have now, for <code>p = 2</code>, right?</p>



<a name="278425928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425928">(Apr 09 2022 at 19:17)</a>:</h4>
<p>No: when <code>p = 2</code>, we have <code>a ^ (p /2) = a = 1</code> (in <code>zmod 2</code>) when <code>a</code> is not zero mod 2.</p>



<a name="278425947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278425947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278425947">(Apr 09 2022 at 19:17)</a>:</h4>
<p>Aahrg, I'm being terribly confused.</p>



<a name="278426114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426114">(Apr 09 2022 at 19:21)</a>:</h4>
<p>I would be inclined to make the definition at <code>2</code> work out to be true for as many theorems as possible, so that the assumption <code>p ≠ 2</code> only bugs you as little as possible.</p>



<a name="278426115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426115">(Apr 09 2022 at 19:21)</a>:</h4>
<p>Maybe I shouldn't try to recall some issue I had when I was working with this file more than a year ago...</p>



<a name="278426119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426119">(Apr 09 2022 at 19:21)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">zmod</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">legendre_sym</span> <span class="n">a</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">legendre_sym</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">zmod</span> <span class="mi">2</span><span class="o">,</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">dec_trivial</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hh</span> <span class="o">:=</span> <span class="n">h</span> <span class="bp">↑</span><span class="n">a</span><span class="o">,</span>
  <span class="n">tauto</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>(The proof can certainly be simplified.)</p>



<a name="278426177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426177">(Apr 09 2022 at 19:22)</a>:</h4>
<p>"Everyone" knows that two is odd and that Legendre symbols shouldn't make sense at 2.  That's a little like dividing by zero, in my understanding.</p>



<a name="278426198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426198">(Apr 09 2022 at 19:22)</a>:</h4>
<p>I think it is the usual approach to prefer total functions with "garbage" values at arguments where they should not be defined.</p>



<a name="278426277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426277">(Apr 09 2022 at 19:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278424463">said</a>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">legendre_sym_mult</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">legendre_sym</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">legendre_sym</span> <span class="n">a</span> <span class="n">p</span> <span class="bp">*</span> <span class="n">legendre_sym</span> <span class="n">b</span> <span class="n">p</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>
<p>It's <code>map_mul</code> if you make <code>λ x, legendre_sym x p</code> a <code>monoid_hom</code>.</p>



<a name="278426303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426303">(Apr 09 2022 at 19:25)</a>:</h4>
<p>But to do that you have to swap the order of the arguments...</p>



<a name="278426354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426354">(Apr 09 2022 at 19:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278426303">said</a>:</p>
<blockquote>
<p>But to do that you have to swap the order of the arguments...</p>
</blockquote>
<p>I was debating with my self whether I should suggest swapping the arguments anyway.</p>



<a name="278426383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426383">(Apr 09 2022 at 19:27)</a>:</h4>
<p>Should I set up a poll on this? How would I do that?</p>



<a name="278426459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426459">(Apr 09 2022 at 19:29)</a>:</h4>
<p>Would it make sense to make the Legendre symbol take value in <code>sign_type</code>?</p>



<a name="278426470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426470">(Apr 09 2022 at 19:29)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">/</span><span class="n">poll</span> <span class="n">some</span> <span class="n">title</span>
<span class="bp">-</span> <span class="n">some</span> <span class="n">option</span>
<span class="bp">-</span> <span class="n">another</span> <span class="n">option</span>
</code></pre></div>
<p>Make sure you don't have other text in the same post.</p>



<a name="278426472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426472">(Apr 09 2022 at 19:29)</a>:</h4>
<p>Is <code>sign_type</code> a multiplicative monoid?</p>



<a name="278426502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426502">(Apr 09 2022 at 19:30)</a>:</h4>
<p>Yes, it is, but I'm not sure it is already in mathlib: let me check</p>



<a name="278426527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426527">(Apr 09 2022 at 19:30)</a>:</h4>
<p><del>docs#sign_type</del></p>



<a name="278426544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426544">(Apr 09 2022 at 19:31)</a>:</h4>
<p>/poll Order of arguments in <code>legendre_sym</code>: should (a / p) be</p>
<ul>
<li><code>legendre_sym a p</code> (this is what it is currently)</li>
<li><code>legendre_sym p a</code> (would make <code>legendre_sym p</code> a multiplicative function)</li>
</ul>



<a name="278426561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426561">(Apr 09 2022 at 19:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278426527">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/sign_type">docs#sign_type</a></p>
</blockquote>
<p>The link gives me a 404 error.</p>



<a name="278426566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278426566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278426566">(Apr 09 2022 at 19:31)</a>:</h4>
<p>Not yet: <a href="https://github.com/leanprover-community/mathlib/pull/12835">#12835</a></p>



<a name="278427285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427285">(Apr 09 2022 at 19:48)</a>:</h4>
<p>How do I get from <code>h : (a : zmod p) ≠ 0</code> and <code>hp : p = 2</code> to <code>(a : zmod 2) ≠ 0</code>?</p>



<a name="278427310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427310">(Apr 09 2022 at 19:49)</a>:</h4>
<p><code>simp_rw [hp] at h</code> does not seem to work...</p>



<a name="278427387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427387">(Apr 09 2022 at 19:51)</a>:</h4>
<p>Does <code>subst hp</code> work?</p>



<a name="278427454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427454">(Apr 09 2022 at 19:52)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">revert</span> <span class="bp">'</span><span class="n">_inst_1'</span><span class="o">,</span> <span class="n">it</span> <span class="n">is</span> <span class="n">a</span> <span class="n">frozen</span> <span class="kn">local</span> <span class="kd">instance</span> <span class="o">(</span><span class="n">possible</span> <span class="n">solution</span><span class="o">:</span> <span class="n">use</span> <span class="n">tactic</span> <span class="bp">`</span><span class="n">unfreezing</span><span class="bp">`</span> <span class="n">to</span> <span class="n">temporarily</span> <span class="n">reset</span> <span class="n">the</span> <span class="n">set</span> <span class="n">of</span> <span class="kn">local</span> <span class="n">instances</span><span class="o">)</span>
</code></pre></div>
<p>(there is <code>[fact p.prime]</code> somewhere...)</p>



<a name="278427461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427461">(Apr 09 2022 at 19:52)</a>:</h4>
<p><code>unfreezing { subst hp }</code></p>



<a name="278427493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427493">(Apr 09 2022 at 19:53)</a>:</h4>
<p><code>unfreezing</code> is unknown, but <code>unfreezingI</code> exists and seems to work.</p>



<a name="278427495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427495">(Apr 09 2022 at 19:53)</a>:</h4>
<p>Is it unfreezing or unfreezingI?  Is there a difference?</p>



<a name="278427501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427501">(Apr 09 2022 at 19:53)</a>:</h4>
<p>Ooh, so that error message contains a typo.</p>



<a name="278427552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278427552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278427552">(Apr 09 2022 at 19:54)</a>:</h4>
<p>This sentence contais three erors.</p>



<a name="278431232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278431232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278431232">(Apr 09 2022 at 21:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="224323">Junyan Xu</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278426277">said</a>:</p>
<blockquote>
<p>It's <code>map_mul</code> if you make <code>λ x, legendre_sym x p</code> a <code>monoid_hom</code>.</p>
</blockquote>
<p>This now looks like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">legendre_sym_mul'</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→*</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">legendre_sym</span> <span class="n">p</span><span class="o">,</span> <span class="n">map_one'</span> <span class="o">:=</span> <span class="n">legendre_sym_one</span> <span class="n">p</span><span class="o">,</span> <span class="n">map_mul'</span> <span class="o">:=</span> <span class="n">legendre_sym_mul</span> <span class="n">p</span> <span class="o">}</span>
</code></pre></div>
<p>(after swapping the arguments of <code>legendre_sym</code>).</p>



<a name="278480002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278480002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278480002">(Apr 10 2022 at 17:31)</a>:</h4>
<p>While working on Legendre symbols, I find myself changing the file number_theory/quadratic_reciprocity quite thoroughly; it is also growing longer. What would be the recommended way of proceeding so that the PRs are manageable?</p>



<a name="278481633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278481633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278481633">(Apr 10 2022 at 18:05)</a>:</h4>
<p>If you make a new def or change a def then don't do much else, try to PR the def and some basic stuff because people might complain about the definition and then everything breaks when you change it. If you're refactoring theorems you can probably get away with bigger PRs.</p>



<a name="278482971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278482971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278482971">(Apr 10 2022 at 18:34)</a>:</h4>
<p>Hmmm... I guess this means that I start fresh with a new branch and move my changes over incrementally?</p>



<a name="278483638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278483638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278483638">(Apr 10 2022 at 18:50)</a>:</h4>
<p>I have now started by swapping the arguments to <code>legendre_sym</code>based on the result of the poll above: <a href="https://github.com/leanprover-community/mathlib/pull/13311">#13311</a></p>



<a name="278486424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278486424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278486424">(Apr 10 2022 at 19:49)</a>:</h4>
<p>Thanks a lot for taking this on. As you know I'm a number theorist but I seem to spend much of my lean research time doing other stuff (eg this Scholze project). My post-doc Maria has defined Adeles and ideles and we hope to start our journey towards things related to class field theory later</p>



<a name="278585681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278585681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278585681">(Apr 11 2022 at 17:08)</a>:</h4>
<p>I have looked at the RPs labeled "ready-to-merge" and see that "my" PR <a href="https://github.com/leanprover-community/mathlib/pull/13311">#13311</a> is blocked because of a "merge conflict" (the same seems to be true for most of the other ones currently in the queue). Is this normal? Is there something I should do? In any case, when I click on "Details" next to "bors — Merge conflict", I only see "Permission denied", so it seems I have no way of figuring our what the problem might be.</p>



<a name="278587749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278587749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278587749">(Apr 11 2022 at 17:24)</a>:</h4>
<p>I think you don't have to do anything. The merge conflict happened with another PR. Bors should give more precise error messages <span aria-label="expressionless" class="emoji emoji-1f611" role="img" title="expressionless">:expressionless:</span></p>



<a name="278587930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278587930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278587930">(Apr 11 2022 at 17:25)</a>:</h4>
<p>How long will it take until this is resolved? (I'd like to get on with my list of changes...)</p>



<a name="278591813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278591813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278591813">(Apr 11 2022 at 17:51)</a>:</h4>
<p>Can you see <a href="https://app.bors.tech/repositories/24316">https://app.bors.tech/repositories/24316</a>? Or do you get a "Permission denied" error?</p>



<a name="278591845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278591845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278591845">(Apr 11 2022 at 17:51)</a>:</h4>
<p>As you can see, there are a lot of PRs trying to get into master right now.</p>



<a name="278591877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278591877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278591877">(Apr 11 2022 at 17:51)</a>:</h4>
<p>Bors is trying to make sure that they all play well together, and get merged in batches.</p>



<a name="278591891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278591891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278591891">(Apr 11 2022 at 17:51)</a>:</h4>
<p>But this might take a couple of hours to sort out <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="278591998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278591998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278591998">(Apr 11 2022 at 17:52)</a>:</h4>
<p>In principle, you can just create other PRs that depend on your current PR. <code>git</code> provides good support for that.</p>



<a name="278592133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278592133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278592133">(Apr 11 2022 at 17:53)</a>:</h4>
<p>I can see the page under the link, thanks.</p>



<a name="278592167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278592167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278592167">(Apr 11 2022 at 17:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/278591891">said</a>:</p>
<blockquote>
<p>But this might take a couple of hours to sort out <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>
</blockquote>
<p>What an understatement <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> The queue has been going haywire for two days straight. <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.groupoid_of_elements">docs#category_theory.groupoid_of_elements</a> timing out is still causing most batch failures.</p>



<a name="278592306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278592306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278592306">(Apr 11 2022 at 17:54)</a>:</h4>
<p>I'll have to learn <code>git</code> while doing this... Is there a nice and easy introduction available somewhere?</p>



<a name="278702828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278702828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278702828">(Apr 12 2022 at 14:44)</a>:</h4>
<p>There is now the second PR: <a href="https://github.com/leanprover-community/mathlib/pull/13393">#13393</a>.<br>
This is just changing the type of <code>a</code> from <code>ℕ</code> to the more natural <code>ℤ</code> in a number of places, so that one can use the API lemmas for all allowed arguments of <code>legendre_symbol</code>.</p>



<a name="278933956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278933956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278933956">(Apr 14 2022 at 07:58)</a>:</h4>
<p>Since I am going to add a substantial amount of code eventually, I would like to distribute the material over several files.<br>
I assume the most reasonable way of doing this is to set up a new subdirectory <code>legendre_symbol</code> (say) in the <code>number_theory</code> directory and put the various files in there.<br>
The first step (and next PR) would then be to create that subdirectory and move <code>quadratic_reciprocity</code> in there.<br>
Are there any objections to that or suggestions to proceed differently?</p>



<a name="278936855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278936855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278936855">(Apr 14 2022 at 08:30)</a>:</h4>
<p>Sounds good to me</p>



<a name="278938564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278938564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278938564">(Apr 14 2022 at 08:48)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13441">#13441</a></p>



<a name="278938948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278938948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278938948">(Apr 14 2022 at 08:52)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> It looks like you forgot to <code>git add</code> the new file</p>



<a name="278939039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278939039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278939039">(Apr 14 2022 at 08:53)</a>:</h4>
<p>I had moved it outside VScode. It should be added now...</p>



<a name="278939147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278939147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278939147">(Apr 14 2022 at 08:54)</a>:</h4>
<p>Thanks. I kicked it on the queue</p>



<a name="278974715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278974715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278974715">(Apr 14 2022 at 14:41)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13449">#13449</a> splits off part of the code into a new file <code>gauss_eisenstein_lemmas.lean</code>. This is the part of the code I'm going to leave alone.</p>



<a name="278975143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278975143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278975143">(Apr 14 2022 at 14:44)</a>:</h4>
<p>The linter is complaining that you should now write a module docstring for this file...</p>



<a name="278975178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/278975178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#278975178">(Apr 14 2022 at 14:44)</a>:</h4>
<p>OK, will do.</p>



<a name="279088054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279088054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279088054">(Apr 15 2022 at 15:01)</a>:</h4>
<p>Could somebody push this along? Johan seems to be taking a break...</p>



<a name="279103847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279103847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279103847">(Apr 15 2022 at 17:39)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> How do I get a <code>decidable</code> instance for <code>is_square a</code> when <code>a : F</code> and <code>F</code> is a finite field?</p>



<a name="279104223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279104223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279104223">(Apr 15 2022 at 17:43)</a>:</h4>
<p><code>decidable_of_iff (∃ b, b * b = a) your_proof_here</code></p>



<a name="279104367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279104367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279104367">(Apr 15 2022 at 17:45)</a>:</h4>
<p>And what do I write for <code>your_proof_here</code>?<br>
Intuitively, every statement should be decidable in a finite field...</p>



<a name="279104931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279104931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279104931">(Apr 15 2022 at 17:50)</a>:</h4>
<p>Something like <a href="https://leanprover-community.github.io/mathlib_docs/find/is_square_iff_exists_sq">docs#is_square_iff_exists_sq</a></p>



<a name="279104993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279104993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279104993">(Apr 15 2022 at 17:51)</a>:</h4>
<p>I found the following:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">haveI</span> <span class="n">hdec</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">is_square</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="o">{</span> <span class="n">change</span> <span class="n">decidable</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="bp">*</span><span class="n">b</span><span class="o">),</span> <span class="n">exact</span> <span class="n">set.decidable_set_of</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">F</span><span class="o">),</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">_</span><span class="o">)</span> <span class="n">Exists</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>
<p>which seems to work.</p>



<a name="279105009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279105009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279105009">(Apr 15 2022 at 17:51)</a>:</h4>
<p>Don't!</p>



<a name="279105112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279105112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279105112">(Apr 15 2022 at 17:52)</a>:</h4>
<p>Oh wait, it's definitionally equal, then it's fine.</p>



<a name="279105126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279105126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279105126">(Apr 15 2022 at 17:52)</a>:</h4>
<p>This is fine, but you can also just write <code>decidable_of_iff (∃ b, a = b * b) iff.rfl</code> or something</p>



<a name="279105956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279105956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279105956">(Apr 15 2022 at 17:59)</a>:</h4>
<p>This?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">haveI</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">decidable_of_iff</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="n">iff.rfl</span><span class="o">,</span>
  <span class="n">unfreezingI</span> <span class="o">{</span> <span class="n">change</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">is_square</span> <span class="n">a</span><span class="o">)</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>



<a name="279106232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279106232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279106232">(Apr 15 2022 at 18:01)</a>:</h4>
<p>More simply, just declare <code>h</code> with the intended type from the start</p>



<a name="279106529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279106529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279106529">(Apr 15 2022 at 18:04)</a>:</h4>
<p>OK, thanks; I tend to forget about this possibility...</p>



<a name="279106794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279106794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279106794">(Apr 15 2022 at 18:07)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.finite.basic</span>

<span class="kd">instance</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">K</span><span class="o">]</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="o">(</span><span class="n">is_square</span> <span class="o">:</span> <span class="n">K</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">decidable_of_iff'</span> <span class="n">_</span> <span class="o">(</span><span class="n">is_square_iff_exists_sq</span> <span class="n">a</span><span class="o">)</span>
</code></pre></div>
<p>is one answer to the question</p>



<a name="279107139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279107139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279107139">(Apr 15 2022 at 18:10)</a>:</h4>
<p>This looks like it should go either into <code>field_theory.finite.basic</code> or into <code>algebra.parity</code>.</p>



<a name="279107180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279107180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279107180">(Apr 15 2022 at 18:10)</a>:</h4>
<p>In any case, this looks like the best way of achieving what I want.</p>



<a name="279109519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279109519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279109519">(Apr 15 2022 at 18:33)</a>:</h4>
<p>Notice that this has nothing to do with fields.</p>



<a name="279118165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279118165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279118165">(Apr 15 2022 at 20:05)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13474">#13474</a> removes arguments of the form <code>[fact (p % 2 = 1)]</code> and replaces them by <code>(p ≠ 2)</code> in <code>quadratic_reciprocity.lean</code>.</p>



<a name="279118325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279118325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279118325">(Apr 15 2022 at 20:07)</a>:</h4>
<p>The next step will be to define the quadratic character on a finite field (and, by specialization, on <code>zmod p</code>) and prove the relevant properties in this setting. Then I will change the definition of <code>legendre_sym</code> to use this and simplify the proofs by making use of the API for the quadratic character.</p>



<a name="279172701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279172701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279172701">(Apr 16 2022 at 15:14)</a>:</h4>
<p>Is the following name reasonable for mathlib?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">quadratic_char_dichotomy</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">F</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>  <span class="n">quadratic_char</span> <span class="n">F</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">quadratic_char</span> <span class="n">F</span> <span class="n">a</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>
<p>or is the more unwieldy, but also more precise <code>quadratic_char_eq_one_or_neg_one</code> preferred?</p>



<a name="279173894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279173894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279173894">(Apr 16 2022 at 15:48)</a>:</h4>
<p>I probably would have gone with the snd option. But I understand your <code>dichotomy</code> name perfectly fine.</p>



<a name="279174003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279174003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279174003">(Apr 16 2022 at 15:51)</a>:</h4>
<p>Can you have a look at <a href="https://github.com/leanprover-community/mathlib/pull/13474">#13474</a> and, if it's OK, put it in the merge queue?</p>



<a name="279174133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279174133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279174133">(Apr 16 2022 at 15:54)</a>:</h4>
<p>For the next PR, which will be a new file with new code, would it be OK to have ~300 lines of code in one go? Or should I split it up? Since it usually takes a day or so for one PR to be merged, the second option looks to me to be the less efficient one, but it may be more efficient in terms of the review.</p>



<a name="279174486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279174486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279174486">(Apr 16 2022 at 16:01)</a>:</h4>
<p>300 lines of continuous diff is probably fine. A 300 line diff split over 5 files is probably a lot harder to review.</p>



<a name="279174564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279174564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279174564">(Apr 16 2022 at 16:02)</a>:</h4>
<p>OK, thanks. I'll then go ahead with this once <a href="https://github.com/leanprover-community/mathlib/pull/13474">#13474</a> is done.</p>



<a name="279180967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279180967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279180967">(Apr 16 2022 at 18:46)</a>:</h4>
<p>A general question: How do I rewrite terms under a sum? E.g.,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.finite.basic</span>
<span class="kn">import</span> <span class="n">algebra.big_operators.ring</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">F</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">-∑</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">F</span><span class="o">),</span> <span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">],</span> <span class="c1">-- does not work</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>(<code>simp_rw</code> does not work, either.) Do I have to use stuff like <a href="https://leanprover-community.github.io/mathlib_docs/find/fintype.sum_bijective">docs#fintype.sum_bijective</a> or is there a simpler way?</p>



<a name="279181046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181046">(Apr 16 2022 at 18:48)</a>:</h4>
<p>I think I'd try neg_sum and then sum_congr (untested)</p>



<a name="279181332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181332">(Apr 16 2022 at 18:55)</a>:</h4>
<p>I was trying to give a simple example. My use case is more involved. My question is, how can I manipulate the term under the sum? (A simple <code>simp</code> solves the goal in the example, so maybe it was not a good choice here.)</p>



<a name="279181404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181404">(Apr 16 2022 at 18:57)</a>:</h4>
<p>You should use <code>simp_rw</code></p>



<a name="279181405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181405">(Apr 16 2022 at 18:57)</a>:</h4>
<p>The term under the sum in my case is a product of four factors <code>a * b * (c * d)</code>, which I want to rewrite to <code>(a * c) * (b * d)</code>.</p>



<a name="279181414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181414">(Apr 16 2022 at 18:57)</a>:</h4>
<p>As mentioned above, <code>simp_rw</code> did not work.</p>



<a name="279181415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181415">(Apr 16 2022 at 18:57)</a>:</h4>
<p>You can <code>simp_rw mul_mul_mul_comm _ b</code></p>



<a name="279181496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181496">(Apr 16 2022 at 18:59)</a>:</h4>
<p>The reason it did not work is that <code>simp_rw</code> rewrites as long as it finds an occurrence of the LHS of the lemma you're rewriting by, so in your case it was turning <code>a * b * (c * d)</code> into <code>a * c * (b * d)</code>into <code>a * b * (c * d)</code> into <code>a * c * (b * d)</code>... Givingexplicit arguments prevents it from looping.</p>



<a name="279181509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181509">(Apr 16 2022 at 18:59)</a>:</h4>
<p>The problem is that <code>b</code> is really some term involving the summation variable, so if I use that, I get an <code>unknown identifier</code> error.</p>



<a name="279181702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181702">(Apr 16 2022 at 19:02)</a>:</h4>
<p>When <code>simp_rw</code> does not work, <code>conv</code> can be helpful.  It takes some time to learn how to navigate thee expressions, but eventually you should be able to reach what you want.</p>



<a name="279181721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181721">(Apr 16 2022 at 19:03)</a>:</h4>
<p>In particular, <code>conv in (Type) { tactics }</code> is usually helpful.  Note that in <code>Type</code> you should use underscores for bound variables (or at least I think so).</p>



<a name="279181767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181767">(Apr 16 2022 at 19:04)</a>:</h4>
<p>Roughly something like <code>∑ (x :  α × β), (f x.fst) * (g x.fst) * ((f' x.snd) * (g' x.snd))</code>.</p>



<a name="279181779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181779">(Apr 16 2022 at 19:04)</a>:</h4>
<p>Besides <code>rw</code>, you move around with <code>congr, funext, skip</code>.</p>



<a name="279181854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181854">(Apr 16 2022 at 19:06)</a>:</h4>
<p>Does <code>conv in (_ * _ * _) { rw mul_mul_mul_comm }</code> work?</p>



<a name="279181933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181933">(Apr 16 2022 at 19:08)</a>:</h4>
<p>Yes, that looks reasonably good. Let's see how far I get with this.</p>



<a name="279181942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279181942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279181942">(Apr 16 2022 at 19:08)</a>:</h4>
<p>You can chain more <code>rw</code> in the same <code>conv</code>.</p>



<a name="279182066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182066">(Apr 16 2022 at 19:12)</a>:</h4>
<p>How would I navigate within <code>conv begin ... end</code> to the term under the sum?</p>



<a name="279182094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182094">(Apr 16 2022 at 19:14)</a>:</h4>
<p>Maybe <code>funext</code>?</p>



<a name="279182139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182139">(Apr 16 2022 at 19:14)</a>:</h4>
<p>It always takes me quite a bit of guess-work.</p>



<a name="279182170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182170">(Apr 16 2022 at 19:15)</a>:</h4>
<p>I cycle using <code>funext, congr, skip</code> and some list formed of those commands works.  When that fails, I use <code>conv in (_)</code>.</p>
<p>Others can tell you more about using <code>conv</code>, I hope!</p>



<a name="279182244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182244">(Apr 16 2022 at 19:17)</a>:</h4>
<p>My mental picture is that <code>congr</code> will take apart stuff that looks like relations, <code>funext</code> gets you inside function applications and <code>skip</code> moves over to the next part`.</p>



<a name="279182256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182256">(Apr 16 2022 at 19:17)</a>:</h4>
<p>This mental picture is not always coherent/accurate, but is what I go by.</p>



<a name="279182307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182307">(Apr 16 2022 at 19:18)</a>:</h4>
<p>If you have a LHS and a RHS, I think that <code>conv_lhs {...}</code> gets you to the obvious starting point.</p>



<a name="279182316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182316">(Apr 16 2022 at 19:19)</a>:</h4>
<p>Honestly, <code>conv</code> and <code>calc</code> were some of the hardest tools to learn for me.</p>



<a name="279182375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182375">(Apr 16 2022 at 19:21)</a>:</h4>
<p>I'm still not too comfortable with <code>conv</code> and I try to put myself in a situation of not needing it.   Ultimately, trying to <code>rw</code> bound variables is a major source of difficulty.</p>



<a name="279182428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279182428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279182428">(Apr 16 2022 at 19:22)</a>:</h4>
<p>My impression is that for <code>rw</code> to work, they need to be in a not-so-bound state, hence the <code>funext</code> might allow for progress.</p>



<a name="279187077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279187077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279187077">(Apr 16 2022 at 21:30)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Just checking you know about <a href="https://leanprover-community.github.io/extras/conv.html">https://leanprover-community.github.io/extras/conv.html</a></p>



<a name="279187921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279187921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279187921">(Apr 16 2022 at 21:51)</a>:</h4>
<p>works in this case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.fintype.card</span>
<span class="n">open_locale</span> <span class="n">big_operators</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="n">f'</span> <span class="n">g'</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∑</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">α</span><span class="o">,</span> <span class="n">f</span> <span class="n">x.1</span> <span class="bp">*</span> <span class="n">g</span> <span class="n">x.1</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f'</span> <span class="n">x.2</span> <span class="bp">*</span> <span class="n">g'</span> <span class="n">x.2</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">true</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">fintype.sum_congr</span><span class="o">,</span>
  <span class="n">swap</span> <span class="mi">2</span><span class="o">,</span> <span class="n">intro</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mul_mul_mul_comm</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">],</span>
  <span class="c">/-</span><span class="cm">∑ (a : α × α), f a.fst * (f' a.snd * (g a.fst * g' a.snd)) = 0 → true-/</span>
  <span class="n">intro</span><span class="o">,</span> <span class="n">trivial</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="279237828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279237828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279237828">(Apr 17 2022 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/279187077">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> Just checking you know about <a href="https://leanprover-community.github.io/extras/conv.html">https://leanprover-community.github.io/extras/conv.html</a></p>
</blockquote>
<p>I've had a look at it, yes.<br>
But I think I'm going to organize my proof a bit differently...</p>



<a name="279313697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279313697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279313697">(Apr 18 2022 at 17:53)</a>:</h4>
<p>New question:<br>
When I add <code>#lint</code> at the end of the file that is supposed to be added in the next PR, I get some messages like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> The `unused_arguments` linter reports: -/</span>
<span class="c">/-</span><span class="cm"> UNUSED ARGUMENTS. -/</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">char.finite_field.odd_card_of_char_not_two</span> <span class="c">/-</span><span class="cm"> argument 4: [_inst_3 : decidable_eq F] -/</span>
</code></pre></div>
<p>and</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> The `decidable_classical` linter reports: -/</span>
<span class="c">/-</span><span class="cm"> USES OF `decidable` SHOULD BE REPLACED WITH `classical` IN THE PROOF. -/</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">char.finite_field.odd_card_of_char_not_two</span> <span class="c">/-</span><span class="cm"> The following `decidable` hypotheses should be replaced with</span>
<span class="cm">                      `classical` in the proof. argument 4: [_inst_3 : decidable_eq F] -/</span>
</code></pre></div>
<p>I have a line</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">F</span><span class="o">]</span>
</code></pre></div>
<p>near the beginning.</p>
<p>Should I do anything about these?<br>
(I need <code>[decidable_eq F]</code> for a definition using <code>ite</code>, and anyway, any finite field will satisfy decidability, so the use/advantage of removing this assumption seems questionable to me.)</p>



<a name="279314157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279314157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279314157">(Apr 18 2022 at 17:57)</a>:</h4>
<p>Put the <code>decidable_eq</code> on the definition, and skip it elsewhere. Mathematically, sure, but it makes things easier with typeclasses if you just skip proofs' decidability requirements and just use <code>classical</code> instead.</p>



<a name="279314240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279314240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279314240">(Apr 18 2022 at 17:58)</a>:</h4>
<p>Yes, you should follow what the linter says. This might be a bit annoying to add and remove <code>decidable_eq F</code> by sections, so instead you can call it <code>[dec : decidable_eq F]</code> and <code>include dec</code>/<code>omit dec</code> at will.</p>



<a name="279314301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279314301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279314301">(Apr 18 2022 at 17:58)</a>:</h4>
<p>OK, thanks!</p>



<a name="279325676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279325676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279325676">(Apr 18 2022 at 19:43)</a>:</h4>
<p>This is now <a href="https://github.com/leanprover-community/mathlib/pull/13503">#13503</a>.<br>
It adds a new file <code>quadratic_char.lean</code> in <code>number_theory/legendre_symbol/</code>, which defines the quadratic character on a finite field and proves a number of properties.<br>
The next step will then be to change the definition of <code>legendre_sym</code> to use <code>quadratic_char</code> and to add API/simplify proofs based on <code>quadratic_char.lean</code>.</p>



<a name="279714288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279714288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279714288">(Apr 21 2022 at 17:40)</a>:</h4>
<p>As suggested by <span class="user-mention" data-user-id="112680">@Johan Commelin</span>, I'm trying to weaken the assumptions on the definition of <code>quadratic_char</code>. However, I'm running into problems with decidability instances:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.finite.basic</span>

<span class="kd">instance</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="o">(</span><span class="n">is_square</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">decidable_of_iff'</span> <span class="n">_</span> <span class="o">(</span><span class="n">is_square_iff_exists_sq</span> <span class="n">a</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">quadratic_char</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="n">is_square</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="k">if</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="k">if</span> <span class="n">is_square</span> <span class="n">a</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">-</span><span class="mi">1</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">qcF</span> <span class="o">:=</span> <span class="n">quadratic_char</span> <span class="n">F</span> <span class="c1">-- complains "failed to synthesize type class instance for decidable_pred is_square"</span>

<span class="c1">-- but the following works fine</span>
<span class="kd">def</span> <span class="n">quadratic_char'</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="k">if</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="k">if</span> <span class="n">is_square</span> <span class="n">a</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">-</span><span class="mi">1</span>
</code></pre></div>
<p>So why is Lean unable to infer the instance <code>[decidable_pred (is_square : F  → Prop)]</code> when I try to specialize the more general definition to the case of a (finite) field <code>F</code>, whereas this does not seem to be a problem when I use the same definition in this more restricted setting? (And how can I work around it?)</p>



<a name="279715439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279715439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279715439">(Apr 21 2022 at 17:50)</a>:</h4>
<p>this seems to be the relevant TC log:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="n">a</span> <span class="o">:</span> <span class="n">decidable</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">is_square</span> <span class="n">F</span>
     <span class="o">(</span><span class="bp">@</span><span class="n">distrib.to_has_mul</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_distrib</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">division_ring.to_ring</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">field.to_division_ring</span> <span class="n">F</span> <span class="n">_inst_2</span><span class="o">))))</span>
     <span class="n">a</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">asda</span> <span class="o">(</span><span class="bp">?</span><span class="n">x_3</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="bp">?</span><span class="n">x_4</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="bp">?</span><span class="n">x_5</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="bp">?</span><span class="n">x_6</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="bp">?</span><span class="n">x_7</span> <span class="n">a</span><span class="o">)</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
</code></pre></div>
<p>I renamed the above instance to <code>asda</code> for ctrl+f purposes, and I made a goal to look-up the instance of <code>decidable_pred (is_square : M \to Prop)</code></p>



<a name="279715508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279715508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279715508">(Apr 21 2022 at 17:50)</a>:</h4>
<p>I don't know what <code>a</code> is here</p>



<a name="279715904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279715904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279715904">(Apr 21 2022 at 17:54)</a>:</h4>
<p>In the original context, <code>a</code> is a term of type <code>F</code>.</p>



<a name="279716025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279716025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279716025">(Apr 21 2022 at 17:55)</a>:</h4>
<p>In any case, the <code>?x_n a</code> arguments look weird, but I don't have any experience so far in trouble-shooting these things...</p>



<a name="279716052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279716052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279716052">(Apr 21 2022 at 17:55)</a>:</h4>
<p>this is the trace for the line <code>def test : decidable_pred (is_square : F → Prop) := by apply_instance</code>, so there's no <code>a</code></p>



<a name="279716190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279716190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279716190">(Apr 21 2022 at 17:56)</a>:</h4>
<p><code>a</code> is a bound variable in the definition of the instance.</p>



<a name="279716419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279716419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279716419">(Apr 21 2022 at 17:57)</a>:</h4>
<p>How do I get the trace?</p>



<a name="279716508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279716508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279716508">(Apr 21 2022 at 17:58)</a>:</h4>
<p><code>set_option trace.class_instances true</code></p>



<a name="279717961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279717961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279717961">(Apr 21 2022 at 18:07)</a>:</h4>
<p>For the second definition, the trace looks like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">decidable</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">is_square</span> <span class="n">F</span>
     <span class="o">(</span><span class="bp">@</span><span class="n">distrib.to_has_mul</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_distrib</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">division_ring.to_ring</span> <span class="n">F</span> <span class="o">(</span><span class="bp">@</span><span class="n">field.to_division_ring</span> <span class="n">F</span> <span class="n">_inst_2</span><span class="o">))))</span>
     <span class="n">a</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">is_square_decidable</span> <span class="bp">?</span><span class="n">x_3</span> <span class="bp">?</span><span class="n">x_4</span> <span class="bp">?</span><span class="n">x_5</span> <span class="bp">?</span><span class="n">x_6</span> <span class="bp">?</span><span class="n">x_7</span>
</code></pre></div>
<p>(I used the name <code>is_square_decidable</code> instead of <code>asda</code>.)</p>



<a name="279718052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718052">(Apr 21 2022 at 18:08)</a>:</h4>
<p>I'm guessing it has to do with the fact that <code>is_square</code> only needs a <code>has_mul</code> instance but your decidability instance asks for <code>monoid</code>, and Lean chose some goofy path from <code>field</code> to <code>has_mul</code> that doesn't pass through <code>monoid</code></p>



<a name="279718203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718203">(Apr 21 2022 at 18:09)</a>:</h4>
<p><code>monoid</code> is needed for <code>is_square_iff_exists_sq</code>.</p>



<a name="279718315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718315">(Apr 21 2022 at 18:10)</a>:</h4>
<p>True, but you can easily avoid doing that</p>



<a name="279718316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718316">(Apr 21 2022 at 18:10)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.finite.basic</span>

<span class="kd">instance</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">has_mul</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="o">(</span><span class="n">is_square</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">fintype.decidable_exists_fintype</span>

<span class="kd">def</span> <span class="n">quadratic_char</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="n">is_square</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="k">if</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="k">if</span> <span class="n">is_square</span> <span class="n">a</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">-</span><span class="mi">1</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">qcF</span> <span class="o">:=</span> <span class="n">quadratic_char</span> <span class="n">F</span>
</code></pre></div>



<a name="279718343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718343">(Apr 21 2022 at 18:10)</a>:</h4>
<p>but not for just unfolding <code>is_square</code>:)</p>



<a name="279718469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279718469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279718469">(Apr 21 2022 at 18:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/279718052">said</a>:</p>
<blockquote>
<p>I'm guessing it has to do with the fact that <code>is_square</code> only needs a <code>has_mul</code> instance but your decidability instance asks for <code>monoid</code>, and Lean chose some goofy path from <code>field</code> to <code>has_mul</code> that doesn't pass through <code>monoid</code></p>
</blockquote>
<p>It goes via <code>field</code> --&gt; <code>division_ring</code> --&gt; <code>ring</code> --&gt; <code>distrib</code> --&gt; <code>has_mul</code>.</p>



<a name="279719814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279719814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279719814">(Apr 21 2022 at 18:22)</a>:</h4>
<p>Ahh, good old <code>distrib</code>s strike back (-;</p>



<a name="279719911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279719911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279719911">(Apr 21 2022 at 18:23)</a>:</h4>
<p>Now what would be interesting is what to do about this if you really did need <code>monoid</code> to write the instance</p>



<a name="279720037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279720037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279720037">(Apr 21 2022 at 18:24)</a>:</h4>
<p>I doubt this can be the problem. Such things happen all the time.</p>



<a name="279720105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279720105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279720105">(Apr 21 2022 at 18:24)</a>:</h4>
<p>I am confused about this too, including why it apparently did work in the last part of the example.</p>



<a name="279720217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279720217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279720217">(Apr 21 2022 at 18:25)</a>:</h4>
<p>Does it have something to do with the higher-order-ness of <code>decidable_pred</code>?</p>



<a name="279721063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279721063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279721063">(Apr 21 2022 at 18:31)</a>:</h4>
<p>I guess normally what would happen is that the first argument <code>?x_3</code> of the instance gets filled in with <code>F</code>, then the others get synthesized by instance search and Lean notices that the two different paths are defeq</p>



<a name="279721209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279721209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279721209">(Apr 21 2022 at 18:33)</a>:</h4>
<p>I take it <code>qcF</code> does actually work after generalizing the <code>decidable_pred</code> instance?</p>



<a name="279721822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279721822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279721822">(Apr 21 2022 at 18:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/279721209">said</a>:</p>
<blockquote>
<p>I take it <code>qcF</code> does actually work after generalizing the <code>decidable_pred</code> instance?</p>
</blockquote>
<p>Yes, it does.</p>



<a name="279722110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279722110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279722110">(Apr 21 2022 at 18:40)</a>:</h4>
<p>The second definition apparently went via ... --&gt; <code>ring</code> --&gt; <code>monoid</code> (which is what I would have expected as a mathematician).</p>



<a name="279722221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279722221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279722221">(Apr 21 2022 at 18:41)</a>:</h4>
<p>Anyway, I have now made most of the changes <span class="user-mention" data-user-id="112680">@Johan Commelin</span> suggested to <a href="https://github.com/leanprover-community/mathlib/pull/13503">#13503</a>.</p>



<a name="279819881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279819881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279819881">(Apr 22 2022 at 12:58)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>, can you look at <a href="https://github.com/leanprover-community/mathlib/pull/13503">#13503</a> again?</p>



<a name="279821705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279821705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279821705">(Apr 22 2022 at 13:13)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Thanks for the ping. I left some comments.</p>



<a name="279823951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279823951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279823951">(Apr 22 2022 at 13:30)</a>:</h4>
<p>I made the changes you suggested. Thanks!</p>



<a name="279824190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279824190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279824190">(Apr 22 2022 at 13:32)</a>:</h4>
<p>Thanks! Please kick it on the queue after CI gives a <span aria-label="check" class="emoji emoji-2705" role="img" title="check">:check:</span></p>



<a name="279824246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279824246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279824246">(Apr 22 2022 at 13:32)</a>:</h4>
<p>OK.</p>



<a name="279835399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279835399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279835399">(Apr 22 2022 at 15:01)</a>:</h4>
<p>eliminary result in some mod_forms repo/project, for example</p>



<a name="279847750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279847750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279847750">(Apr 22 2022 at 16:32)</a>:</h4>
<p>Sorry for the noise. I blame the German railway network and mobile internet infrastructure.</p>



<a name="279850998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279850998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279850998">(Apr 22 2022 at 16:57)</a>:</h4>
<p>I see you have started to assimilate. Complaining about the Deutsche Bahn is a national past time here.</p>



<a name="279973699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973699">(Apr 24 2022 at 10:06)</a>:</h4>
<p>Is there a simpler way of proving the following?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">algebra.parity</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="bp">;</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩,</span>
    <span class="n">use</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h.symm</span><span class="o">,</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="279973741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973741">(Apr 24 2022 at 10:07)</a>:</h4>
<p><code>by simp_rw eq_comm</code> or <code>exists_congr $ λ _, eq_comm</code></p>



<a name="279973814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973814">(Apr 24 2022 at 10:09)</a>:</h4>
<p>A useful general rule to remember is that <code>foo.symm : foo x y → foo y x</code> and <code>foo_comm : foo x y ↔ foo y x</code></p>



<a name="279973818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973818">(Apr 24 2022 at 10:09)</a>:</h4>
<p>Which of the two would be preferred for mathlib?</p>



<a name="279973890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973890">(Apr 24 2022 at 10:10)</a>:</h4>
<p>Either is fine. The second one is particularly useful if you're building a proof term.</p>



<a name="279973918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279973918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279973918">(Apr 24 2022 at 10:11)</a>:</h4>
<p>I'm not so much into building proof terms (yet?)... <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="279974422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279974422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279974422">(Apr 24 2022 at 10:24)</a>:</h4>
<p>The next PR is <a href="https://github.com/leanprover-community/mathlib/pull/13667">#13667</a>.<br>
It mainly changes the definition of <code>legendre_sym</code> to use <code>quadratic_char</code>for <code>zmod p</code>. Then we can use properties of the quadratic character to prove corresponding properties of the Legendre symbol. I'm also adding a few more API lemmas.</p>



<a name="279974507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279974507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279974507">(Apr 24 2022 at 10:26)</a>:</h4>
<p>The next steps will be to add statements on the quadratic character of <code>-1</code> (first in <code>quadratic_char.lean</code>) and then on the quadratic character of <code>2</code>. The ultimate goal here is to formalise the proof of QR using Gauss sums (and use this to replace the current proof using Gauss' and Eisenstein's lemmas).</p>



<a name="279975854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279975854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279975854">(Apr 24 2022 at 10:59)</a>:</h4>
<p>Probably in the tactic proof you can do <code>exact \&lt;x, h.symm\&gt;</code> instead of <code>use</code> + <code>exact</code> (untested but I'm optimistic); <code>exist</code> goals are no different to any other structure so you can use the pointy bracket constructor to just build the term you want.</p>



<a name="279975978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279975978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279975978">(Apr 24 2022 at 11:01)</a>:</h4>
<p>To give a term of type <code>exists a, P a</code> is to give a pair consisting of a term <code>x</code> and a proof of <code>P x</code>.</p>



<a name="279994778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279994778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279994778">(Apr 24 2022 at 19:06)</a>:</h4>
<p>I would like to write down the set <code>{x : F | x ^ 2 = a}</code> as a <code>finset</code> (where <code>F</code> is a finite field and <code>a : F</code>). How do I do that?</p>



<a name="279994865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279994865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279994865">(Apr 24 2022 at 19:09)</a>:</h4>
<p><code>finset.univ.filter (λ x, x ^ 2 = a)</code>. You will need <code>decidable_eq F</code>.</p>



<a name="279995027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279995027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279995027">(Apr 24 2022 at 19:13)</a>:</h4>
<p>Thanks. It doesn't read very naturally, though...</p>



<a name="279995094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279995094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279995094">(Apr 24 2022 at 19:15)</a>:</h4>
<p>In Lean 3, the <code>{ x : X | P x}</code> notation is built into core Lean IIRC, which means it's very inflexible. In Lean 4 syntax will be super-flexible and it would not surprise me if one could use this notation or something very close to it to make finsets from fintypes.</p>



<a name="279995264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279995264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279995264">(Apr 24 2022 at 19:19)</a>:</h4>
<p>Yeah, <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.filter">docs#finset.filter</a> is really the same as <a href="https://leanprover-community.github.io/mathlib_docs/find/set.sep">docs#set.sep</a>, and it's a bit of a shame that the notation doesn't follow through.</p>



<a name="279995386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279995386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279995386">(Apr 24 2022 at 19:22)</a>:</h4>
<p>I guess one issue is that people might still want to make subsets from fintypes, so one might have to use separate notation for the two constructions.</p>



<a name="279995407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279995407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279995407">(Apr 24 2022 at 19:23)</a>:</h4>
<p>Context can be enough to infer the type.</p>



<a name="279996822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279996822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279996822">(Apr 24 2022 at 19:58)</a>:</h4>
<p>Is something like this in mathlib?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">F</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">∨</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">-</span><span class="n">b</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>(The assumptions can be weakened, of course.)</p>



<a name="279996988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279996988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279996988">(Apr 24 2022 at 20:00)</a>:</h4>
<p>We have <a href="https://leanprover-community.github.io/mathlib_docs/find/sq_eq_sq_iff_abs_eq_abs">docs#sq_eq_sq_iff_abs_eq_abs</a> which is pretty close</p>



<a name="279997083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279997083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279997083">(Apr 24 2022 at 20:02)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/eq_or_eq_neg_of_sq_eq_sq">docs#eq_or_eq_neg_of_sq_eq_sq</a> <br>
The other one requires a linearly ordered structure.</p>



<a name="279997096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279997096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279997096">(Apr 24 2022 at 20:02)</a>:</h4>
<p>Ah that's the one I was looking for!</p>



<a name="279997119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/279997119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#279997119">(Apr 24 2022 at 20:03)</a>:</h4>
<p>Why is it not stated as an iff?</p>



<a name="280000002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000002">(Apr 24 2022 at 21:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/279994865">said</a>:</p>
<blockquote>
<p><code>finset.univ.filter (λ x, x ^ 2 = a)</code>. You will need <code>decidable_eq F</code>.</p>
</blockquote>
<p>I would expect something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">set_to_finset_of_fintype</span> <span class="o">{</span><span class="n">T</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">T</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">T</span>
</code></pre></div>
<p>in mathlib, with the obvious property that <code>↑(set_to_finset_of_fintype s) = s</code>.</p>



<a name="280000010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000010">(Apr 24 2022 at 21:09)</a>:</h4>
<p>... so that I could write <code>set_ot_finset_of_fintype {x : F | x ^ 2 = a}</code>.</p>



<a name="280000011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000011">(Apr 24 2022 at 21:09)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/set.to_finset">docs#set.to_finset</a></p>



<a name="280000061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000061">(Apr 24 2022 at 21:10)</a>:</h4>
<p>We don't include <code>of_fintype</code> in the name because it doesn't work otherwise so you can infer it</p>



<a name="280000135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000135">(Apr 24 2022 at 21:12)</a>:</h4>
<p>Is there also <code>coe : set T → finset T</code>? When I tried <code>{x : F | x^2 = a} : finset F</code>, it didn't work.</p>



<a name="280000140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000140">(Apr 24 2022 at 21:12)</a>:</h4>
<p>And <a href="https://leanprover-community.github.io/mathlib_docs/find/set.coe_to_finset">docs#set.coe_to_finset</a> . Note that you can use dot notation. Does <code>{x : P x}.to_finset</code> work though?</p>



<a name="280000170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000170">(Apr 24 2022 at 21:13)</a>:</h4>
<p>I think there won't be a coercion because I think the type class inference system handles it and there's a coercion the other way so this would give a loop</p>



<a name="280000186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000186">(Apr 24 2022 at 21:13)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/set.coe_to_finset">docs#set.coe_to_finset</a> is just the specification.</p>



<a name="280000188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000188">(Apr 24 2022 at 21:13)</a>:</h4>
<p>But I'm not an expert in these matters, I could be wrong</p>



<a name="280000235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000235">(Apr 24 2022 at 21:14)</a>:</h4>
<p>Right -- the specification is the "obvious property" you wanted above, right?</p>



<a name="280000259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280000259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280000259">(Apr 24 2022 at 21:14)</a>:</h4>
<p><code>{x : F | x^2 = a}.to_finset</code> does typecheck.</p>



<a name="280089772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280089772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280089772">(Apr 25 2022 at 15:56)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13667">#13667</a> has now a merge conflict. Apparently some other PR changed <code>number_theory/legendre_symbol/quadratic_reciprocity.lean</code> before my PR was merged. How do I resolve this?</p>



<a name="280091634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280091634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280091634">(Apr 25 2022 at 16:08)</a>:</h4>
<p>You can either click the "resolve conflicts" button in-browser, which will give you a clumsy editor and markers along the lines of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">your_branch</span>
<span class="kd">lemma</span> <span class="n">your_version</span>
<span class="bp">=======</span>
<span class="kd">lemma</span> <span class="n">their_version</span>
<span class="bp">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="n">master</span>
</code></pre></div>
<p>or you can run <code>git fetch; git merge origin/master</code> locally, and solve the same markers in vscode</p>



<a name="280091707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280091707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280091707">(Apr 25 2022 at 16:09)</a>:</h4>
<p>(your goal is to merge the things within the <code>&lt;&lt;&lt;&lt;&lt;&lt; ... ====== ... &gt;&gt;&gt;&gt;&gt;</code>)</p>



<a name="280119793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280119793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280119793">(Apr 25 2022 at 19:49)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> can you (or somebody else) have a look at <a href="https://github.com/leanprover-community/mathlib/pull/13667">#13667</a> at some point?</p>



<a name="280196859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280196859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280196859">(Apr 26 2022 at 11:43)</a>:</h4>
<p>On the latest commit of <a href="https://github.com/leanprover-community/mathlib/pull/13667">#13667</a>, I get the message that "Lint mathlib failed", but when I click on "Details", the orange circle in front of "lint" is still spinning. So how do I figure out what the complaint is? (Adding <code>#lint</code> to the bottom of the files I changed does not turn up any problems, BTW.)</p>



<a name="280201729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280201729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280201729">(Apr 26 2022 at 12:25)</a>:</h4>
<p>I'd guess the linter failed to __run__ (for unknown reasons) rather than to succeed.</p>



<a name="280201840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280201840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280201840">(Apr 26 2022 at 12:26)</a>:</h4>
<p>I've just clicked the "rerun" button: if this succeeds then my above hypothesis is very likely correct.</p>



<a name="280205553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280205553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280205553">(Apr 26 2022 at 12:58)</a>:</h4>
<p>OK, thanks! Let's see what happens.</p>



<a name="280211231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280211231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280211231">(Apr 26 2022 at 13:41)</a>:</h4>
<p>Looks good...</p>



<a name="280241388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280241388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280241388">(Apr 26 2022 at 17:16)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I made the suggested change to <a href="https://github.com/leanprover-community/mathlib/pull/13667">#13667</a>. It should be ready now.</p>



<a name="280241645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280241645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280241645">(Apr 26 2022 at 17:18)</a>:</h4>
<p>Thanks for the ping: <img alt=":merge:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/3121/emoji/images/18527.png" title="merge"></p>



<a name="280241682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280241682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280241682">(Apr 26 2022 at 17:19)</a>:</h4>
<p>Thanks!</p>



<a name="280687296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280687296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280687296">(Apr 29 2022 at 20:57)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Why is <a href="https://leanprover-community.github.io/mathlib_docs/find/even.neg_one_pow">docs#even.neg_one_pow</a> not a <code>simp</code> lemma? (<a href="https://leanprover-community.github.io/mathlib_docs/find/odd.neg_one_pow">docs#odd.neg_one_pow</a> is.)</p>



<a name="280688360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280688360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280688360">(Apr 29 2022 at 21:05)</a>:</h4>
<p>I was the one (re)writing it two weeks ago. Neither <code>even.neg_one_pow</code> nor <code>odd.neg_pow</code> is a simp lemma because <code>even n</code> or <code>odd n</code> is not a precondition that's usually filled by <code>simp</code> (or rather we have specific lemmas when it is).</p>



<a name="280688482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280688482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280688482">(Apr 29 2022 at 21:06)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/even.neg_one_zpow">docs#even.neg_one_zpow</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/odd.neg_one_zpow">docs#odd.neg_one_zpow</a> are not simp either. I don't know where you've seen this.</p>



<a name="280688669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280688669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280688669">(Apr 29 2022 at 21:08)</a>:</h4>
<p>The relevant PR is <a href="https://github.com/leanprover-community/mathlib/pull/13268">#13268</a>.</p>



<a name="280717321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280717321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280717321">(Apr 30 2022 at 05:08)</a>:</h4>
<p>Yaël already gave a justification.  I am not too sure of what constitutes a good <code>simp</code> lemma and what does not.  Until recently, I would have probably thought "<code>even/odd</code>" is a condition that <code>simp</code> will not produce, so this lemma should always be passed onto <code>simp</code> to trigger it, defeating the purpose of the <code>simp</code> tag.</p>
<p>However, Johan pointed out to me that if <code>even 2</code> were a <code>simp</code> lemma (maybe it is, I'm on mobile), then the lemma might trigger when <code>n = 2</code>.  So, my heuristic is not correct and I am back at not knowing what a good <code>simp</code> lemma is!</p>



<a name="280717977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280717977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280717977">(Apr 30 2022 at 05:29)</a>:</h4>
<p>But <code>2 = bit0 1</code>, and we have lemmas about <code>(-a)^bit0 b</code>.</p>



<a name="280718146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280718146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280718146">(Apr 30 2022 at 05:34)</a>:</h4>
<p>So, I think that I am even further back at the step where I am not really sure what is a good <code>simp</code> lemma!</p>



<a name="280727474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280727474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280727474">(Apr 30 2022 at 09:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/280688482">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/even.neg_one_zpow">docs#even.neg_one_zpow</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/odd.neg_one_zpow">docs#odd.neg_one_zpow</a> are not simp either. I don't know where you've seen this.</p>
</blockquote>
<p>You are right; I guess my eye slipped to the next line (where <a href="https://leanprover-community.github.io/mathlib_docs/find/even_neg_two">docs#even_neg_two</a> <em>is</em> a <code>simp</code> lemma). Sorry about that; I was getting tired...</p>



<a name="280727478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280727478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280727478">(Apr 30 2022 at 09:48)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> the concept of a good <code>simp</code> lemma is a bit subtle. Scott once mentioned to me that I could do a better job of teaching <code>simp</code> in NNG; the explanation was that I didn't understand <code>simp</code> at the time myself. One thing which suddenly made it all look easy was when I learnt about the Knuth-Bendix theorem, which gives a concrete Noetherian confluent rewrite system for groups ie proves that you can make a <code>group</code> tactic like <code>ring</code> but for groups just with the command <code>simp only [mul_assoc, one_inv, ...]</code> (you need about ten random statements in group theory of the form X=Y with Y in some kind of simpler form than X). However that doesn't mean that all the things on the list are good <code>simp</code> lemmas in practice! For example <code>mul_assoc</code> is not a <code>simp</code> lemma.</p>



<a name="280727567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280727567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280727567">(Apr 30 2022 at 09:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/280717321">said</a>:</p>
<blockquote>
<p>However, Johan pointed out to me that if <code>even 2</code> were a <code>simp</code> lemma (maybe it is, I'm on mobile), then the lemma might trigger when <code>n = 2</code>.  So, my heuristic is not correct and I am back at not knowing what a good <code>simp</code> lemma is!</p>
</blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/even_two">docs#even_two</a> <em>is</em> a <code>simp</code> lemma in fact (as is <a href="https://leanprover-community.github.io/mathlib_docs/find/even_neg_two">docs#even_neg_two</a>).<br>
I would think that if I have a hypothesis <code>h : even n</code> in my context and <a href="https://leanprover-community.github.io/mathlib_docs/find/even.neg_one_pow">docs#even.neg_one_pow</a> were a <code>simp</code> lemma,<br>
then <code>simp [h]</code> would simpify <code>(-1)^n</code> to <code>1</code>, which could be useful.</p>



<a name="280728499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280728499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280728499">(Apr 30 2022 at 10:15)</a>:</h4>
<p>That's true. But arguably it shouldn't be in the default <code>simp</code>-set. Maybe <code>simp [h, even.neg_one_pow]</code> is also a reasonable way.<br>
In this case, there is also another option: add it to the <code>parity_simps</code> simp-set. Then <code>simp [h] with parity_simps</code> will make that simplification.</p>



<a name="280728507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280728507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280728507">(Apr 30 2022 at 10:15)</a>:</h4>
<p>In the end, this is a question about balancing UX (user experience) vs performance.</p>



<a name="280728554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280728554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280728554">(Apr 30 2022 at 10:16)</a>:</h4>
<p>Putting everything in the default simp-set makes it easy to have short proofs, and it can help people discover simp-lemmas that they didn't know about. But it comes at the cost/risk of making the default simp-set very slow.</p>



<a name="280728702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280728702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280728702">(Apr 30 2022 at 10:20)</a>:</h4>
<p>Of course, I can use <code>simp [even.neg_one_pow h]</code> in any case.</p>



<a name="280729567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280729567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280729567">(Apr 30 2022 at 10:39)</a>:</h4>
<p>You mean <code>h.neg_one_pow</code>!</p>



<a name="280733360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280733360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280733360">(Apr 30 2022 at 12:10)</a>:</h4>
<p>Kevin, thanks for putting this concept in words!  I have observed something similar while working with <code>laurent_polynomial</code>, where I feel that I am declaring lemmas to be <code>simp</code>, just because it makes sense in this context.  In this situation, I am helped by the fact that they are in the <code>laurent_polynomial</code> namespace, so they won't trigger when they shouldn't.  The situation is different with <code>mul_assoc</code>, of course.</p>



<a name="280734338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280734338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280734338">(Apr 30 2022 at 12:35)</a>:</h4>
<p>You know <code>simp</code> doesn't care about namespaces? They are all there as soon as the file is imported.</p>



<a name="280736078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280736078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280736078">(Apr 30 2022 at 13:17)</a>:</h4>
<p>Scott, I do, what I meant is that they will not apply unless you really have a <code>laurent_polynomial</code>, in which case they are useful!</p>



<a name="280736122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280736122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280736122">(Apr 30 2022 at 13:18)</a>:</h4>
<p>It is just that the lemmas "look like" they would apply to polynomials as well, but they do not!</p>



<a name="280738403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280738403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280738403">(Apr 30 2022 at 14:12)</a>:</h4>
<p>I think it's more the type of the lemma, rather than the namespace, which is making that happen.</p>



<a name="280738509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280738509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280738509">(Apr 30 2022 at 14:15)</a>:</h4>
<p>Yes, maybe I should have said that the types of the lemmas all contain <code>laurent_polynomial</code> somewhere, rather than confusing this with the fact that the lemmas are all in the <code>laurent_polynomial</code> namespace.</p>



<a name="280738518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280738518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280738518">(Apr 30 2022 at 14:15)</a>:</h4>
<p>Another <code>simp</code> story while I'm waiting for a local LTE to compile: when I made the complex number game (a super-unpopular game because I never made a web interface, despite the fact that the levels are really clean), I found that to prove that the complex numbers were a ring it was great to have <code>z = w \iff z.re = w.re \and z.im = w.im</code> in the simp set, because I was proving all the ring axioms, which are equalities, and I always wanted to do it by checking on real and imaginary parts. But then Scott pointed out to me that you don't want that to be the default behaviour in the wild, because people don't want <code>simp</code> randomly breaking up their equality of some random integrals into real and imaginary parts. Better to use the proper tool, which is <code>ext</code>.</p>



<a name="280738663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280738663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280738663">(Apr 30 2022 at 14:18)</a>:</h4>
<p>Actually, this makes me think that I sometimes wonder why the lemma that says that a product is zero iff one of its factors is zero (with appropriate typeclass assumptions) is in the <code>simp</code> set: I almost never want to get to an <code>or</code> in my proofs!  And I constantly go through the loop:<br>
<code>simp → squeeze_simp → Try this</code> add a <code>-</code> in front of the name of the lemma, remove <code>only</code> and <code>squeeze</code> again!</p>



<a name="280738758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280738758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280738758">(Apr 30 2022 at 14:20)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/mul_eq_zero">docs#mul_eq_zero</a>: I was convinced that the name of the lemma was more complicated...</p>



<a name="280739373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280739373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280739373">(Apr 30 2022 at 14:35)</a>:</h4>
<p>New PR: <a href="https://github.com/leanprover-community/mathlib/pull/13831">#13831</a> adds two properties of quadratic characters/Legendre symbols (value is -1 precisely on non-squares and number of square roots of a given element is 1 plus the value of the character).</p>



<a name="280739889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280739889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280739889">(Apr 30 2022 at 14:47)</a>:</h4>
<p>We have <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.odd_of_mod_four_eq_one">docs#nat.odd_of_mod_four_eq_one</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.odd_of_mod_four_eq_three">docs#nat.odd_of_mod_four_eq_three</a>. For the API for the quadratic character of <code>-1</code>, I will need the converse, i.e.,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nat.odd_mod_four</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">nat</span><span class="o">}</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">\</span><span class="n">or</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span>
</code></pre></div>
<p>Would it make sense to put it next to the other two? And is the name OK? (I don't like <code>nat.eq_one_or_three_mod_four_of_odd</code>, since I will also need a similar one for mod 8, and the name would get really unwieldy...)</p>



<a name="280739946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280739946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280739946">(Apr 30 2022 at 14:48)</a>:</h4>
<p>Should there also be counterparts for <code>int</code>?</p>



<a name="280781926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280781926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280781926">(May 01 2022 at 08:27)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Can you have a look at <a href="https://github.com/leanprover-community/mathlib/pull/13831">#13831</a> (see above) at some point?</p>



<a name="280781938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280781938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280781938">(May 01 2022 at 08:28)</a>:</h4>
<p>I'd also like to get feedback on <code>nat.odd_mod_four</code>...</p>



<a name="280834775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280834775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280834775">(May 02 2022 at 05:29)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> I left some comments</p>



<a name="280864897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/280864897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#280864897">(May 02 2022 at 12:05)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I have replied to your comments on <a href="https://github.com/leanprover-community/mathlib/pull/13831">#13831</a>.</p>



<a name="281360479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/281360479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#281360479">(May 05 2022 at 21:17)</a>:</h4>
<p>There is a new PR: <a href="https://github.com/leanprover-community/mathlib/pull/13978">#13978</a>.<br>
It adds results on the quadratic character of <code>-1</code>; the main new lemmas are</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">char.quadratic_char_neg_one</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">F</span><span class="o">]</span> <span class="o">(</span><span class="n">hF</span> <span class="o">:</span> <span class="n">ring_char</span> <span class="n">F</span> <span class="bp">≠</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">quadratic_char</span> <span class="n">F</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">χ₄</span> <span class="o">(</span><span class="n">fintype.card</span> <span class="n">F</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">char.is_square_neg_one_iff</span> <span class="o">:</span> <span class="n">is_square</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">fintype.card</span> <span class="n">F</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">≠</span> <span class="mi">3</span>
</code></pre></div>
<p>The first has a counterpart for the Legendre symbol; the second was already present in a similar form (but now has a simpler proof based on <code>char.is_square_neg_one_iff</code>). I have taken the liberty of rewriting the statement in terms of <code>is_square</code> (rather than spelling it out explicitly); similarly for <code>zmod.euler_criterion</code>.</p>
<p>I needed some additional auxiliary lemmas (<code>odd_mod_four</code> as mentioned earlier and <code>finite_field.even_card_of_char_two</code>), which I have added near the top of <code>number_theory/legendre_symbol/quadratic_char.lean</code>; the plan is to collect these auxiliary lemmas there and move them collectively to appropriate places at some later point.<br>
There is also some API for the quadratic character mod 4, <code>zmod.χ₄</code>.<br>
Perhaps <span class="user-mention" data-user-id="112680">@Johan Commelin</span>  can have a look, but of course, everybody is welcome to review it.</p>



<a name="281477931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/281477931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#281477931">(May 06 2022 at 18:35)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Can you have another look? The points you raised should now be dealt with.</p>



<a name="281478564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/281478564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#281478564">(May 06 2022 at 18:40)</a>:</h4>
<p>LGTM <img alt=":merge:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/3121/emoji/images/18527.png" title="merge"></p>



<a name="281591966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/281591966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#281591966">(May 08 2022 at 10:25)</a>:</h4>
<p>New PR <a href="https://github.com/leanprover-community/mathlib/pull/14027">#14027</a>. This just moves the auxiliary lemmas into a separate file, to facilitate future changes. <span class="user-mention" data-user-id="112680">@Johan Commelin</span></p>



<a name="282516309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/282516309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#282516309">(May 16 2022 at 15:58)</a>:</h4>
<p>Another PR that is meant to improve the file structure: <a href="https://github.com/leanprover-community/mathlib/pull/14178">#14178</a>. It moves the material on the quadratic characters on <code>zmod 4</code> and <code>zmod 8</code> to a separate file <code>zmod_char.lean</code> (within <code>number_theory/legendre_symbol/</code>) and also adds some API lemmas for the characters on <code>zmod 8</code> (and shortens a proof). <span class="user-mention" data-user-id="112680">@Johan Commelin</span></p>



<a name="282516705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/282516705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#282516705">(May 16 2022 at 16:00)</a>:</h4>
<p>I have code for the "Gauss sum proof" of the value of the quadratic character at 2, but before I add this, I want to see if it can be obtained from more general Gauss sum machinery (which I will need for the Gauss sum proof of Quadratic Reciprocity).</p>



<a name="282521321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/282521321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#282521321">(May 16 2022 at 16:31)</a>:</h4>
<p>LGTM!</p>



<a name="282521422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/282521422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#282521422">(May 16 2022 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Do you think it's worth it to deduplicate the two characters for <code>n = 8</code>, by passing a parameter to the character?</p>



<a name="282530941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/282530941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#282530941">(May 16 2022 at 17:24)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I don't think it would save a lot of code (I don't really expect more API lemmas here). We can perhaps lookt at it again at some later point.</p>



<a name="285053214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285053214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285053214">(Jun 05 2022 at 20:11)</a>:</h4>
<p>I have now finished writing the code that leads to the proof of Quadratic Reciprocity via Gauss sums.</p>
<p>This is a total of ~1400 lines of code. Would the following be a reasonable sequence of PRs?</p>
<ol>
<li>Add the necessary auxiliary statements to <code>number_theory/legendre_symbol/auxiliary.lean</code> (~200 lines)</li>
<li>Add results on multiplicative characters (new file <code>.../mul_character.lean</code>, ~200 lines)</li>
<li>Add results on additive characters (new file <code>.../add_character.lean</code>, ~300 lines)</li>
<li>Add results on Gauss sums (new file <code>.../gauss_sum.lean</code>, ~400 lines)</li>
<li>Add results on the value of the quadratic character at <code>2</code> and at odd primes to <code>.../quadratic_char.lean</code> (~150 lines)</li>
<li>Add corresponding statements to <code>.../quadratic_reciprocity.lean</code> (replacing the current combinatorial proofs) and move the Gauss and Eisenstein lemmas to <code>.../gauss_eisenstein_lemmas.lean</code></li>
</ol>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span></p>



<a name="285054099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285054099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285054099">(Jun 05 2022 at 20:34)</a>:</h4>
<p>This sounds great to me, keeping stuff &lt;= 200 lines is really helpful to the maintainers</p>



<a name="285054158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285054158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285054158">(Jun 05 2022 at 20:36)</a>:</h4>
<p>I take it that 400 may still be OK?</p>



<a name="285054174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285054174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285054174">(Jun 05 2022 at 20:37)</a>:</h4>
<p>Of course, if desired, I can split the longer files into two parts and PR them separately.</p>



<a name="285054178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285054178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285054178">(Jun 05 2022 at 20:37)</a>:</h4>
<p>Once you've got good at PRs people are a lot more tolerant of 400 line efforts :-)</p>



<a name="285060444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285060444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285060444">(Jun 05 2022 at 23:03)</a>:</h4>
<p><del>you can sometimes convince them of much larger things if you're good enough or nagging enough</del></p>



<a name="285076529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285076529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285076529">(Jun 06 2022 at 05:07)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Sounds like a good plan to me.</p>



<a name="285076583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285076583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285076583">(Jun 06 2022 at 05:08)</a>:</h4>
<p>Also "400 lines in one file" is typically easier to review than "300 lines scattered across 5 files".</p>



<a name="285093597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285093597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285093597">(Jun 06 2022 at 10:05)</a>:</h4>
<p>The first PR is there: <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a></p>



<a name="285096394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285096394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285096394">(Jun 06 2022 at 10:47)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Concerning the Github discussion about moving preliminary lemmas. Do you already have a good overview of 10-20 prelim lemmas that you'll be adding in the next few PRs? Because then you could already gather all of those together now, and make a prep PR first.</p>



<a name="285099150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285099150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285099150">(Jun 06 2022 at 11:27)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> That's what I'm doing with <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a>. It should contain all the lemmas I need for the sequence of PRs I outlined.<br>
When the sequence of PRs is complete, we can move everything that is in <code>auxiliary.lean</code> to appropriate places (that would be number 7 in the list above).</p>



<a name="285105438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285105438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285105438">(Jun 06 2022 at 12:35)</a>:</h4>
<p>I've edited the message above to add item number 7.</p>



<a name="285112934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285112934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285112934">(Jun 06 2022 at 13:36)</a>:</h4>
<p>I still don't really understand why not make step 1 and 7 at the same time then? That seems way less confusing for review. If 1 is merged with lemmas in the right place you will soon get the olean files for it and not have to recompile anything later</p>



<a name="285121314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285121314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285121314">(Jun 06 2022 at 14:42)</a>:</h4>
<p>Yes, step 1 and step 7 should be one and only. We basically never purposefully put lemmas in the wrong place (I've only done it once, and it was to ease a refactor touching 138 files).</p>



<a name="285121698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285121698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285121698">(Jun 06 2022 at 14:44)</a>:</h4>
<p>OK; if you tell me where to put each lemma, then I'll move them now. I just would like to avoid having to make changes later on (beacuse a lemma was moved to the "wrong" file or was too specific or ...).</p>



<a name="285122323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285122323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285122323">(Jun 06 2022 at 14:49)</a>:</h4>
<p>That's why reviewing is for <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="285122462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285122462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285122462">(Jun 06 2022 at 14:50)</a>:</h4>
<p>The best way to decide where a lemma should go is by</p>
<ol>
<li>Looking for similar lemmas</li>
<li>Looking for the lemmas used in the proof</li>
</ol>



<a name="285143150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143150">(Jun 06 2022 at 17:21)</a>:</h4>
<p>Is there a way of avoiding triggering CI every time I push a commit? Building/linting mathlib is likely to take a long time each time I modify a file like <code>algebra/group/basic.lean</code>...</p>



<a name="285143440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143440">(Jun 06 2022 at 17:23)</a>:</h4>
<p>If you push, the previous runs will automatically be cancelled.</p>



<a name="285143520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143520">(Jun 06 2022 at 17:24)</a>:</h4>
<p>If you still want to save CI cycles, I guess the solution is to commit, but postpone pushing till you have a batch of commits that you want to test with CI.</p>



<a name="285143782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143782">(Jun 06 2022 at 17:26)</a>:</h4>
<p>Or you can manually cancel if you still want to have the commits distributed. If the GitHub actions extension for vscode or the command like gh tool supports cancelling actions this could be quite quick</p>



<a name="285143808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143808">(Jun 06 2022 at 17:26)</a>:</h4>
<p>I was thinking of having the review process work its way without triggering CI. This will reqire that I push the commits so that reviewers can see them and comment on them.</p>



<a name="285143997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285143997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285143997">(Jun 06 2022 at 17:28)</a>:</h4>
<p>Perhaps one way to go is for me to add comments to the lemmas with suggestions where they should go?<br>
If there are no objections, I can then move them and hope for the best...</p>



<a name="285158360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285158360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285158360">(Jun 06 2022 at 19:21)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> I have now added suggestions regarding suitable places for the lemmas to <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a>. Please comment!</p>



<a name="285294275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285294275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285294275">(Jun 07 2022 at 18:27)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> How can I help to push this along reasonably quickly?<br>
I'd like to get on to the "real" stuff...</p>



<a name="285294527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285294527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285294527">(Jun 07 2022 at 18:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/285122462">said</a>:</p>
<blockquote>
<p>The best way to decide where a lemma should go is by</p>
<ol>
<li>Looking for similar lemmas</li>
<li>Looking for the lemmas used in the proof</li>
</ol>
</blockquote>
<p>Have you tried doing this? <span aria-label="point of information" class="emoji emoji-261d" role="img" title="point of information">:point_of_information:</span></p>



<a name="285294666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285294666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285294666">(Jun 07 2022 at 18:30)</a>:</h4>
<p>Also, what are we supposed to do with your suggestions? We're the ones suggesting and you're the one changing <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="285294784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285294784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285294784">(Jun 07 2022 at 18:31)</a>:</h4>
<p>I basically did what you said and added suggestions (in comments) where the lemmas should go.</p>



<a name="285294860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285294860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285294860">(Jun 07 2022 at 18:31)</a>:</h4>
<p>I'm basically waiting to see if you think they make sense, as I would like to avoid moving things around several times.</p>



<a name="285295001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295001">(Jun 07 2022 at 18:32)</a>:</h4>
<p>Also, in some cases, the obvious files are missing some imports, and I'm not sure what the established way is in such cases.</p>



<a name="285295319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295319">(Jun 07 2022 at 18:35)</a>:</h4>
<p>See point number 1.</p>



<a name="285295436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295436">(Jun 07 2022 at 18:35)</a>:</h4>
<p>Can you define "similar"?</p>



<a name="285295440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295440">(Jun 07 2022 at 18:35)</a>:</h4>
<p>When this happens, it usually means that there's a file lower down the hierarchy which has the same theme but heavier imports.</p>



<a name="285295551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295551">(Jun 07 2022 at 18:36)</a>:</h4>
<p>By "similar", I mean similar conclusions and similar assumptions (including instance ones!).</p>



<a name="285295655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295655">(Jun 07 2022 at 18:37)</a>:</h4>
<p>See <a href="https://tqft.net/mathlib/data/set/pointwise">file#data/set/pointwise</a>, <a href="https://tqft.net/mathlib/analysis/normed/group/pointwise">file#analysis/normed/group/pointwise</a>, <a href="https://tqft.net/mathlib/analysis/normed_space/pointwise">file#analysis/normed_space/pointwise</a> for an example of such file gradation.</p>



<a name="285295698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295698">(Jun 07 2022 at 18:38)</a>:</h4>
<p>For example, there does not seem to be a file that imports both <code>algebra.group.units</code>and <code>algebra.char_p.basic</code>.<br>
(BTW, is there a way to check that rigorously without clicking through everything?)</p>



<a name="285295847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285295847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285295847">(Jun 07 2022 at 18:38)</a>:</h4>
<p>This is probably false, given that <code>algebra.group.units</code> is very low down the hierarchy. You can try <span class="user-mention" data-user-id="310045">@Eric Wieser</span>'s import tree tool, but I haven't yet managed to use it myself.</p>



<a name="285296124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296124">(Jun 07 2022 at 18:41)</a>:</h4>
<p>If it is false, how do I find a file that imports both?</p>



<a name="285296196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296196">(Jun 07 2022 at 18:41)</a>:</h4>
<p>You can also write <code>#check some_declaration_in_algebra_group_units</code> in <code>algebra.char_p.basic</code> and see whether Lean knows the declaration.</p>



<a name="285296268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296268">(Jun 07 2022 at 18:42)</a>:</h4>
<p>If the tool you're talking about is my visualization, it's not useful for this</p>



<a name="285296317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296317">(Jun 07 2022 at 18:42)</a>:</h4>
<p>I think there's another thread with some python or JavaScript code that _might_ be useful</p>



<a name="285296344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296344">(Jun 07 2022 at 18:42)</a>:</h4>
<p>Yes, I'm talking about the python code.</p>



<a name="285296551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296551">(Jun 07 2022 at 18:44)</a>:</h4>
<p>... and indeed</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.char_p.basic</span>

<span class="k">#check</span> <span class="n">units</span>
<span class="c1">-- units : Π (α : Type u_1) [_inst_1 : monoid α], Type u_1</span>
</code></pre></div>



<a name="285296663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296663">(Jun 07 2022 at 18:45)</a>:</h4>
<p>OK; it tlooks like the chain from <code>algebra.char_p.basic</code> to <code>algebra.group.units</code> is fairly long, though.</p>



<a name="285296860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296860">(Jun 07 2022 at 18:46)</a>:</h4>
<p>Anyway, I still don't quite know what to do. If you say you are the ones suggesting and I'm supposed to make the changes, then I'm missing the suggestions.</p>



<a name="285296915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285296915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285296915">(Jun 07 2022 at 18:47)</a>:</h4>
<p>I am currently writing some <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="285580891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285580891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285580891">(Jun 09 2022 at 19:01)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> Are there any further suggested changes to <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a>?</p>



<a name="285607977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285607977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285607977">(Jun 09 2022 at 23:27)</a>:</h4>
<p>It would be easier if you simply performed the moves instead of waiting for our pre-emptive approval, which you won't get because it's much easier to review things when they are in the correct place.</p>



<a name="285729476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285729476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285729476">(Jun 10 2022 at 20:37)</a>:</h4>
<p>I'm trying to do that now.<br>
My experience is that when I change things in files like <code>algebra.char_p.basic</code>, then work becomes nearly impossible -- orange bars won't go away, building takes ages...<br>
So I would like to endure this only once if possible.</p>



<a name="285729508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285729508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285729508">(Jun 10 2022 at 20:37)</a>:</h4>
<p>Actually, <code>data.nat.modeq</code> is even worse...</p>



<a name="285729893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285729893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285729893">(Jun 10 2022 at 20:40)</a>:</h4>
<p>you can check the file itself without too much trouble, and if you are working on a different file which is far away you can either <code>lean --make</code> that particular file which shouldn't take too long, or you can push to the PR and wait for CI to finish to download the oleans</p>



<a name="285729990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285729990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285729990">(Jun 10 2022 at 20:41)</a>:</h4>
<p>Don't try to use the server itself to compile that far away file. It's a complete waste of resources because it doesn't produce oleans on disk and is more likely to cause lean to run out of memory</p>



<a name="285736143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285736143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285736143">(Jun 10 2022 at 21:43)</a>:</h4>
<p>The trick is to touch the far away files top to bottom. That is, if A imports B and you want to modify them both, start by modifying B. And close the file you're moving the lemmas from, to avoid triggering its recompilation.</p>



<a name="285794743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285794743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285794743">(Jun 11 2022 at 19:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/285729893">said</a>:</p>
<blockquote>
<p>you can check the file itself without too much trouble, and if you are working on a different file which is far away you can either <code>lean --make</code> that particular file which shouldn't take too long, or you can push to the PR and wait for CI to finish to download the oleans</p>
</blockquote>
<p><code>lean --make </code> the relevant files also takes something like two hours...</p>



<a name="285794751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285794751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285794751">(Jun 11 2022 at 19:45)</a>:</h4>
<p>Anyway, I have now moved everything (and deleted <code>auxiliary.lean</code>).</p>



<a name="285795203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285795203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285795203">(Jun 11 2022 at 19:56)</a>:</h4>
<p>Let's see how long CI will take...</p>



<a name="285830995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285830995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285830995">(Jun 12 2022 at 09:15)</a>:</h4>
<p>Building mathlib failed after two hours, but clicking on the "details" link showed the orange circle still spinning at "leanpkg build", so I restarted the faeild job(s). Now it progressed to linting...</p>



<a name="285834123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285834123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285834123">(Jun 12 2022 at 10:28)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a> is now green. It would be nice if it could be merged soon.</p>



<a name="285834973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285834973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285834973">(Jun 12 2022 at 10:47)</a>:</h4>
<p>Can you please hit the <code>Resolve conversation</code> button if you've taken into account a comment?</p>



<a name="285835030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285835030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285835030">(Jun 12 2022 at 10:48)</a>:</h4>
<p>(This has no effect on the code, but it makes easier to read the discussion.)</p>



<a name="285836198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285836198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285836198">(Jun 12 2022 at 11:10)</a>:</h4>
<p>I think it's almost ready to go.</p>



<a name="285839859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285839859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285839859">(Jun 12 2022 at 12:32)</a>:</h4>
<p>Just doing the two hours recompilation of everything between <code>algebra.group_power.basic</code> and <code>field_theory.finite.basic</code> again on my machine, so that I can then check the comment on <code>field_theory.finite.trace</code>...</p>



<a name="285839965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285839965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285839965">(Jun 12 2022 at 12:34)</a>:</h4>
<p>You know how to get cache using <code>leanproject</code>, right?</p>



<a name="285840142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285840142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285840142">(Jun 12 2022 at 12:38)</a>:</h4>
<p>I changed <code>algebra.group_power.basic</code> by adding the suggested <code>simp</code> lemmas, so I don't see how I can avoid the recompilation (other than pushing and then later getting the new oleans from the branch, which I assume would not really be faster).</p>



<a name="285840307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285840307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285840307">(Jun 12 2022 at 12:41)</a>:</h4>
<p>You can temporarily cancel the changes you made to get back to a situation you have the oleans for, do the other changes, then put back the changes which invalidated the oleans and tada!</p>



<a name="285840653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285840653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285840653">(Jun 12 2022 at 12:49)</a>:</h4>
<p>It just finished. I guess the real problem was <code>data.nat.modeq</code> when I did this before (and it took two hours or so).</p>



<a name="285841682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285841682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285841682">(Jun 12 2022 at 13:09)</a>:</h4>
<p>Michael, have you seen <a href="https://leanprover-community.github.io/tips_and_tricks.html#old-mode">https://leanprover-community.github.io/tips_and_tricks.html#old-mode</a>, if you are sure that you just changed a proof or docstring or lemma only used by you and want to quickly get working on other stuff based on it, you can use this flag to tell lean to ignore intermediate files. I.e. pretend that they still compile fine</p>



<a name="285841841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285841841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285841841">(Jun 12 2022 at 13:12)</a>:</h4>
<p>Yes, but I have tried to avoid that so far.</p>



<a name="285842194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285842194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285842194">(Jun 12 2022 at 13:19)</a>:</h4>
<p>I have now pushed the changes that were suggested.</p>



<a name="285857408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285857408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285857408">(Jun 12 2022 at 19:19)</a>:</h4>
<p>bors tells me that <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a> was merged, but when I download mathlib, the changes are not there. Do I just have to wait a bit longer, or is there a problem somewhere?</p>



<a name="285858279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285858279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285858279">(Jun 12 2022 at 19:36)</a>:</h4>
<p>What <em>precisely</em> are you doing when you say you "download mathlib"?</p>



<a name="285858341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285858341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285858341">(Jun 12 2022 at 19:37)</a>:</h4>
<p>(For example, <code>git pull</code> for me correctly points <code>origin/master</code> to commit d6eb634b58906ef0cc4bba155e099da9d7d99615, which is the most recent commit according to GitHub and which is the commit resulting from the merge of <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a>.)</p>



<a name="285858449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285858449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285858449">(Jun 12 2022 at 19:39)</a>:</h4>
<p>I did <code>leanproject up</code> in another project.</p>



<a name="285858580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285858580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285858580">(Jun 12 2022 at 19:42)</a>:</h4>
<p>Also, <a href="https://leanprover-community.github.io/mathlib_docs/">https://leanprover-community.github.io/mathlib_docs/</a> still mentions 97c9ef8cd3e7a896a61ee35aa39c7827e03980ce, which is the commit before <a href="https://github.com/leanprover-community/mathlib/pull/14572">#14572</a>.</p>



<a name="285858592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285858592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285858592">(Jun 12 2022 at 19:43)</a>:</h4>
<p>OK, now I get the latest commit. So I guess it takes a while until it becomes visible?</p>



<a name="285859298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285859298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285859298">(Jun 12 2022 at 20:01)</a>:</h4>
<p>The documentation is rendered automatically from <a href="https://github.com/leanprover-community/mathlib_docs">https://github.com/leanprover-community/mathlib_docs</a> which happens some time after the commit enters <code>master</code>, yes. I don't <em>know</em> about <code>leanproject up</code>, although looking at its definition (<a href="https://github.com/leanprover-community/mathlib-tools/blob/bdae7e9ae3e014fd845e7023e68a084e1165c9a2/mathlibtools/lib.py#L755">https://github.com/leanprover-community/mathlib-tools/blob/bdae7e9ae3e014fd845e7023e68a084e1165c9a2/mathlibtools/lib.py#L755</a>) it really should be instant unless you were on the wrong git branch; were you on <code>master</code> when you ran <code>leanproject up</code>?</p>



<a name="285916339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285916339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285916339">(Jun 13 2022 at 12:03)</a>:</h4>
<p>I realized that I forgot to update the module docstring for the new file <code>field_theory.finite.trace</code> after I removed the definition of <code>trace_to_zmod</code>. I'm fixing this with <a href="https://github.com/leanprover-community/mathlib/pull/14711">#14711</a>.</p>



<a name="285975331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285975331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285975331">(Jun 13 2022 at 19:09)</a>:</h4>
<p>I have now made the next PR (adding results on multiplicative characters): <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a>.</p>



<a name="285984455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285984455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285984455">(Jun 13 2022 at 20:21)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span></p>



<a name="285990606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285990606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285990606">(Jun 13 2022 at 21:15)</a>:</h4>
<p>I've left a couple of comments, but I think you should define what a <code>mul_character</code> is. If we do it carefully we can take advantage of the existing API for <code>monoid_with_zero_hom</code> and friends.</p>



<a name="285990716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285990716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285990716">(Jun 13 2022 at 21:16)</a>:</h4>
<p>Unless for you a multiplicative character it's just a <code>monoid_with_zero_hom</code> (I don't know if we want nonunits to be mapped to <code>0</code> or not).</p>



<a name="285993830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285993830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285993830">(Jun 13 2022 at 21:44)</a>:</h4>
<p>In applications, the domain will usually be a field (then 0 is the only non-unit). I didn't want to restrict what a multiplicative character is (beyond a <code>monoid_with_zero_hom</code>), since I'm not sure whether there might be cases where it's reasonable to use a map that takes nonzero values on some non-units.<br>
In the intended application (to Gauss sums), I do have an assumption that non-units are mapped to zero in some places, though.</p>



<a name="285994588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285994588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285994588">(Jun 13 2022 at 21:52)</a>:</h4>
<p>Well, I think this is a delicate question. It's really important to set up good definitions.  If we map nonunits to <code>0</code> then multiplicative characters form a group, right? So this allows all the usual notation <code>χ ^ 0</code> would be the trivial character, and that's nice.</p>



<a name="285994675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/285994675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#285994675">(Jun 13 2022 at 21:53)</a>:</h4>
<p>Because otherwise you have to prove by hand all the stuff like <code>χ ^ (n + m) = ...</code>, and that can be <em>a lot</em> of work</p>



<a name="286088587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286088587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286088587">(Jun 14 2022 at 15:20)</a>:</h4>
<p>OK. I see the following advantages.</p>
<ul>
<li>commutative group structure on <code>mul_char R R'</code> (as you mentioned)</li>
<li>no need for extra hypotheses that non-units are mapped to zero</li>
<li>can define, e.g., Dirichlet characters modulo <code>n</code> as composition of <code>ℤ → zmod n</code> with a <code>mul_char (zmod n) ℂ</code></li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Dirichlet characters are  not <code>mul_char</code>s (there are very few <code>mul_char</code>s on the integers with the restricted def.)</li>
<li>the <code>comm_group</code> structure has a lot of fields that need to be filled</li>
<li>whenever one constructs a <code>mul_char</code>, one has a proof obligations that non-units are mapped to zero</li>
</ul>



<a name="286088653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286088653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286088653">(Jun 14 2022 at 15:20)</a>:</h4>
<p>But I would think that the advantages are worth it.</p>



<a name="286088912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286088912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286088912">(Jun 14 2022 at 15:22)</a>:</h4>
<p>Would it be better to define <code>mul_char</code> as an extension of <code>monoid_with_zero_hom</code> or as an extension of <code>monoid_hom</code>?<br>
In both cases by a field <code>map_non_unit</code> (or so) that contains a proof that non-units are mapped to zero, I would think.</p>



<a name="286089098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286089098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286089098">(Jun 14 2022 at 15:23)</a>:</h4>
<p>And I may need some help in setting this up in the right way, since I haven't yet done something similar so far.</p>



<a name="286131053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286131053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286131053">(Jun 14 2022 at 20:53)</a>:</h4>
<p>I have now managed to get a <code>comm_group</code> instance on <code>mul_char R R'</code>. I will continue with rewriting the file to see how well I can work with it and then push a new version (perhaps tomorrow).</p>



<a name="286177753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286177753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286177753">(Jun 15 2022 at 08:05)</a>:</h4>
<p>Hmm, I don't know, excluding Dirichlet character seems quite bad.</p>



<a name="286193463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286193463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286193463">(Jun 15 2022 at 10:32)</a>:</h4>
<p>Sending non-units to zero is the wrong behavior for the inverse in a <a href="https://leanprover-community.github.io/mathlib_docs/find/division_monoid">docs#division_monoid</a>, at least.</p>



<a name="286195082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286195082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286195082">(Jun 15 2022 at 10:51)</a>:</h4>
<p>Sacrificing the inverse is not a big deal.  But I am afraid we are missing a good <code>pnat</code>-powers  API on semigroups...</p>



<a name="286195290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286195290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286195290">(Jun 15 2022 at 10:53)</a>:</h4>
<p>The point is that the theory is a mess. Peoples tend to modify these little details to their needs, but we really want a uniform definition, otherwise we will have to do a lot of code duplication.</p>



<a name="286253834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286253834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286253834">(Jun 15 2022 at 18:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/286193463">said</a>:</p>
<blockquote>
<p>Sending non-units to zero is the wrong behavior for the inverse in a <a href="https://leanprover-community.github.io/mathlib_docs/find/division_monoid">docs#division_monoid</a>, at least.</p>
</blockquote>
<p>The nice thing with this definition is that one does get a commutative group structure (it is isomorphic to the group structure on group homomorphisms from the units of the domain ring into the units of the target ring), which should make it easier to work with the characters. I'll now continue working on the file, using the group structure.</p>



<a name="286259382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286259382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286259382">(Jun 15 2022 at 19:10)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> Is the following reasonable?<br>
I add the variant with non_units mapped to zero as another file <code>mul_char_alt.lean</code> for comparison in <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a> (and mark the PR as WIP for the time being), so that the two can be compared.</p>



<a name="286263737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286263737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286263737">(Jun 15 2022 at 19:47)</a>:</h4>
<p>Thanks, it's good that we can see both versions. I suggest you open a new thread with your question (the title of this one refers to something else).</p>



<a name="286264850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286264850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286264850">(Jun 15 2022 at 19:57)</a>:</h4>
<p>The title of this one refers to the end goal <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span>, but it looks like there are quite some detours on the way...</p>



<a name="286270280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286270280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286270280">(Jun 15 2022 at 20:39)</a>:</h4>
<p>I'll push the alternative file tomorrow (and open a new thread at the same time). It is getting late, and I'm tired...</p>



<a name="286301336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286301336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286301336">(Jun 16 2022 at 03:10)</a>:</h4>
<blockquote>
<p>I add the variant with non_units mapped to zero as another file mul_char_alt.lean for comparison in <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a> (and mark the PR as WIP for the time being), so that the two can be compared.</p>
</blockquote>
<p>Isn't it better create another branch but leave it in the same file, so we can compare the new branch with the current branch side by side? If you implement the change in one commit (in the new branch), then we can just look at the diff of that one commit.</p>



<a name="286336578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286336578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286336578">(Jun 16 2022 at 11:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/286088587">said</a>:</p>
<blockquote>
<p>OK. I see the following advantages.</p>
<ul>
<li>commutative group structure on <code>mul_char R R'</code> (as you mentioned)</li>
<li>no need for extra hypotheses that non-units are mapped to zero</li>
<li>can define, e.g., Dirichlet characters modulo <code>n</code> as composition of <code>ℤ → zmod n</code> with a <code>mul_char (zmod n) ℂ</code></li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Dirichlet characters are  not <code>mul_char</code>s (there are very few <code>mul_char</code>s on the integers with the restricted def.)</li>
<li>the <code>comm_group</code> structure has a lot of fields that need to be filled</li>
<li>whenever one constructs a <code>mul_char</code>, one has a proof obligations that non-units are mapped to zero</li>
</ul>
</blockquote>
<p>Hi, I have done some stuff on Dirichlet characters, in case you are interested</p>



<a name="286336661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286336661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286336661">(Jun 16 2022 at 11:11)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character.lean">https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character.lean</a></p>



<a name="286336673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286336673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286336673">(Jun 16 2022 at 11:11)</a>:</h4>
<p>And <a href="https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character_properties.lean">https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character_properties.lean</a></p>



<a name="286347395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286347395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286347395">(Jun 16 2022 at 12:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="224323">Junyan Xu</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/286301336">said</a>:</p>
<blockquote>
<p>Isn't it better create another branch but leave it in the same file, so we can compare the new branch with the current branch side by side? If you implement the change in one commit (in the new branch), then we can just look at the diff of that one commit.</p>
</blockquote>
<p>How would I do that? (Still a beginner with <code>git</code>...)</p>



<a name="286353415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286353415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286353415">(Jun 16 2022 at 13:37)</a>:</h4>
<p>For each PR you create a branch, so you know how to create a new branch right? Instead of creating it out of <code>master</code>, you could also create it out of another existing branch, like the branch <code>legendre_symbol_mul_char</code> in <a href="https://github.com/leanprover-community/mathlib/pull/14716">#14716</a>. Github allows you to <a href="https://github.com/leanprover-community/mathlib/compare/master...legendre_symbol_mul_char">compare any two branches</a> even without opening PR (but comment is not possible without PR), and each commit also has its own <a href="https://github.com/leanprover-community/mathlib/commit/2977b88c3eec6d392b3ff6757161d3db02d18a1a">diff view</a>.</p>



<a name="286363928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286363928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286363928">(Jun 16 2022 at 14:51)</a>:</h4>
<p>The variant implementation is at <a href="https://github.com/leanprover-community/mathlib/pull/14768">#14768</a> now.<br>
<span class="user-mention" data-user-id="127136">@Alex J. Best</span> <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span></p>



<a name="286364192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286364192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286364192">(Jun 16 2022 at 14:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="250372">Ashvni Narayanan</span> <a href="#narrow/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A/near/286336661">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character.lean">https://github.com/leanprover-community/mathlib/blob/p-adic/src/number_theory/dirichlet_character.lean</a></p>
</blockquote>
<p>Thanks for the pointers. My goal at this point is to define Gauss sums and prove some properties, so I need (additive and multiplicative) characters on finite commutative rings. But it would certainly make sense to have some interface with Dirichlet characters eventually.</p>



<a name="286396733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286396733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286396733">(Jun 16 2022 at 18:48)</a>:</h4>
<p>I have now started a <a href="#narrow/stream/116395-maths/topic/Implementation.20of.20multiplicative.20characters">separate topic to discuss the relative merits of the two approaches to multiplicative characters</a>.</p>



<a name="286407010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286407010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286407010">(Jun 16 2022 at 20:11)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Why not change all the <code>R'</code>s to <code>C</code>s, for the following reason. I find it really helpful when reading mathlib code to follow good variable naming conventions. This is something which apparently doesn't exist in computer science (they just say <code>{\alpha \beta \gamma \delta : Type*}</code> whether they're groups or fields or whatever. Your <code>R'</code> , the target ring, is the ring of coefficients, so <code>C</code>. </p>
<p>Imagine trying to explain your code to a smart 17 year old. You tell them that is says <code>R</code> is a ring, but if you like you can just pretend it's <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span>, the reals (I often do this with 1st year undergraduates when we're looking at modules over rings in Lean, I just say imagine <code>R=</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span> and tell them that module is French for vector space). And similarly <code>C</code> is a ring, but you can just imagine it's the complexes if you don't know what a ring is, because in practice it often is.</p>



<a name="286407423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Quadratic%20Hilbert%20symbol%20over%20%E2%84%9A/near/286407423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/Quadratic.20Hilbert.20symbol.20over.20.E2.84.9A.html#286407423">(Jun 16 2022 at 20:14)</a>:</h4>
<p>I'll keep this in mind for later. But since I don't want to do twice the work, I'd like to wait until it is clear which of the two variants will make it.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>