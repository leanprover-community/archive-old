---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/polynomial.20refactor.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html">polynomial refactor</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="203965083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203965083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203965083">(Jul 15 2020 at 14:50)</a>:</h4>
<p>I split data/polynomial.lean into several files on the branch <code>mathlib:polynomial_refactor</code>. I'm currently working on </p>
<ul>
<li>fix some proofs that broke during the shuffle</li>
<li>add module docstrings</li>
<li>find homes for the last 200 lines of code in data/polynomial/misc.lean</li>
</ul>



<a name="203965384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203965384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203965384">(Jul 15 2020 at 14:52)</a>:</h4>
<p>currently several means, uh, 15. one optimization i'm not yet attempting is to reduce the height of the import DAG. i think some of the content will end up in <code>ring_theory</code> and/or <code>field_theory</code>, though I think most of it should go to <code>algebra/polynomial</code></p>



<a name="203965752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203965752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203965752">(Jul 15 2020 at 14:55)</a>:</h4>
<p>great. small files are good</p>



<a name="203966795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203966795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203966795">(Jul 15 2020 at 15:02)</a>:</h4>
<p>i am very confused about this broken proof:<br>
<a href="https://github.com/leanprover-community/mathlib/compare/polynomial_refactor#diff-ad4dee56670fd030e11668e3244f9379R123-R126">https://github.com/leanprover-community/mathlib/compare/polynomial_refactor#diff-ad4dee56670fd030e11668e3244f9379R123-R126</a></p>



<a name="203966851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203966851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203966851">(Jul 15 2020 at 15:03)</a>:</h4>
<p>is that the current branch?</p>



<a name="203966909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203966909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203966909">(Jul 15 2020 at 15:03)</a>:</h4>
<p>oh i guess that link doesn't do what I thought it did</p>



<a name="203967053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203967053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203967053">(Jul 15 2020 at 15:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">eval₂_comp</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">S</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→+*</span> <span class="n">S</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">S</span><span class="o">}</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">p</span><span class="bp">.</span><span class="n">comp</span> <span class="n">q</span><span class="o">)</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">p</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">f</span> <span class="o">(</span><span class="n">q</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
<span class="c1">--   show (p.sum (λ e a, C a * q ^ e)).eval₂ f x = p.eval₂ f (eval₂ f x q),</span>
<span class="c1">-- by simp only [eval₂_mul, eval₂_C, eval₂_pow, eval₂_sum]; refl</span>
</code></pre></div>



<a name="203967111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203967111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203967111">(Jul 15 2020 at 15:05)</a>:</h4>
<p>the old proof is commented out. all of the lemmas used in the <code>simp only</code> have been proven and their statements haven't changed, but now it doesn't close the goal</p>



<a name="203967351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203967351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203967351">(Jul 15 2020 at 15:07)</a>:</h4>
<p>oh I maybe have the wrong set of comm_semiring hypotheses (nope, I have them for both <code>R</code> and <code>S</code>)</p>



<a name="203968051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203968051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203968051">(Jul 15 2020 at 15:12)</a>:</h4>
<p>gah, I have a local branch also called polynomial_refactor, which I'll have to move before I can check out yours</p>



<a name="203968193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203968193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203968193">(Jul 15 2020 at 15:13)</a>:</h4>
<p>oops</p>



<a name="203970052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203970052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203970052">(Jul 15 2020 at 15:26)</a>:</h4>
<p>i'm going to open it as a WIP PR; that will make it easier to discuss specific pieces of code</p>



<a name="203977254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203977254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203977254">(Jul 15 2020 at 16:16)</a>:</h4>
<p>aha! there are some places where I proved something about <code>{p q : polynomial R}</code> when they used to be proven for <code>{q : polynomial R} {q : polynomial S}</code></p>



<a name="203984372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203984372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203984372">(Jul 15 2020 at 17:13)</a>:</h4>
<p>fixed all the sorries. thinking about docstrings, while waiting for CI to tell me which things I broke outside of data/poynomial with my changes</p>



<a name="203984456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203984456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203984456">(Jul 15 2020 at 17:14)</a>:</h4>
<p>Thank you so much for doing this</p>



<a name="203984595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203984595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203984595">(Jul 15 2020 at 17:15)</a>:</h4>
<p>I'm glad I have this community to teach me how to contribute to a large software project</p>



<a name="203988061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988061">(Jul 15 2020 at 17:41)</a>:</h4>
<p>is <code>rec_on_horner</code>a programming thing? <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.rec_on_horner">docs#polynomial.rec_on_horner</a></p>



<a name="203988131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988131">(Jul 15 2020 at 17:42)</a>:</h4>
<p>Not really... just a "programming name" (-;</p>



<a name="203988191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988191">(Jul 15 2020 at 17:42)</a>:</h4>
<p>i think i've heard "horner normal form" before, maybe if i stare at this anothe rminute i'll see why it's a normal form</p>



<a name="203988307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988307">(Jul 15 2020 at 17:43)</a>:</h4>
<p>(it is a def without a docstring. i'm not sure why it's not a lemma instead)</p>



<a name="203988405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988405">(Jul 15 2020 at 17:44)</a>:</h4>
<p>oh okay</p>



<a name="203988420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988420">(Jul 15 2020 at 17:44)</a>:</h4>
<p>it is a <code>Sort</code>-valued induction</p>



<a name="203988456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988456">(Jul 15 2020 at 17:44)</a>:</h4>
<p>i don't know why you need that other than for programming, but I will now try to write a dosctring</p>



<a name="203988569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988569">(Jul 15 2020 at 17:45)</a>:</h4>
<p>It could be that for a particular proof this is the kind of induction strategy that works well</p>



<a name="203988743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988743">(Jul 15 2020 at 17:47)</a>:</h4>
<p>but if you're just proving something then you wouldn't mind being <code>Prop</code>-valued?</p>



<a name="203988796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988796">(Jul 15 2020 at 17:47)</a>:</h4>
<p>Sure... but it also works for definitions. Although I can't think of a use-case...</p>



<a name="203988955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203988955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203988955">(Jul 15 2020 at 17:48)</a>:</h4>
<p>(to be clear, I'm not definitely not arguing to change the definition; i'm just trying to understand what its docstring should be)</p>



<a name="203990744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203990744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203990744">(Jul 15 2020 at 18:03)</a>:</h4>
<p>I didn't know it was called that, but I remember learning about the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><mi>X</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><mi>X</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mi>X</mi><mo stretchy="false">(</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_0+X(a_1+X(a_2+X(\dots)))</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> form for polynomials in high school algebra.  As far as I know, it's mostly useful for computation, since it saves you from calculating all those powers.  Though, I guess <code>rec_on_horner</code> is essentially induction on the coefficient list with two operations: insert 0 at the beginning, or replace a 0 at the beginning with a non-zero constant, which seems relatively easy to work with.</p>



<a name="203991505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203991505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203991505">(Jul 15 2020 at 18:08)</a>:</h4>
<p>oof, I broke a proof in polynomial_algebra.lean, which suggests that I've changed the behavior of the polynomial simp set :(</p>



<a name="203991736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203991736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203991736">(Jul 15 2020 at 18:10)</a>:</h4>
<p>Ooo.oo... I'm sorry for you</p>



<a name="203991779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203991779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203991779">(Jul 15 2020 at 18:10)</a>:</h4>
<p>After tomorrow I would be able to help</p>



<a name="203991846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203991846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203991846">(Jul 15 2020 at 18:11)</a>:</h4>
<p>I'm feeling good about pushing forward and trying to get to the bottom of things myself; hopefully by the time you have time to think about it the remaining questions will be big-picture design stuff :)</p>



<a name="203993253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203993253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203993253">(Jul 15 2020 at 18:22)</a>:</h4>
<p>i think my problems are with <code>apply_eq_coeff</code> in particular. I've had to write <code>p.to_fun</code> a lot</p>



<a name="203994607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203994607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203994607">(Jul 15 2020 at 18:32)</a>:</h4>
<p>Oooh, that shouldn't happen</p>



<a name="203994663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203994663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203994663">(Jul 15 2020 at 18:32)</a>:</h4>
<p>Please use <code>coeff n p</code> instead of <code>p.to_fun n</code></p>



<a name="203995899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203995899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203995899">(Jul 15 2020 at 18:42)</a>:</h4>
<p>in at least one case, the <code>to_fun</code> is coming from <code>finsupp.mem_support_iff</code></p>



<a name="203996185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/203996185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#203996185">(Jul 15 2020 at 18:45)</a>:</h4>
<p>Ouch</p>



<a name="204012144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204012144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204012144">(Jul 15 2020 at 20:59)</a>:</h4>
<p>it builds</p>



<a name="204012356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204012356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204012356">(Jul 15 2020 at 21:01)</a>:</h4>
<p>there are a lot of module docstrings which want to be elaborated</p>



<a name="204039843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204039843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204039843">(Jul 16 2020 at 03:04)</a>:</h4>
<p>Thank you so so much!</p>



<a name="204039851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204039851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204039851">(Jul 16 2020 at 03:04)</a>:</h4>
<p>I think you shouldn't feel burdened by more documentation. That can be done later.</p>



<a name="204040259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204040259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204040259">(Jul 16 2020 at 03:13)</a>:</h4>
<p>what do we need to check before merging?</p>



<a name="204040457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204040457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204040457">(Jul 16 2020 at 03:17)</a>:</h4>
<p>Did you fix the conflict already? Otherwise we have to wait a bit for someone to do that.</p>



<a name="204040531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204040531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204040531">(Jul 16 2020 at 03:18)</a>:</h4>
<p>I don't think I can review this today, maybe tomorrow. And this weekend I'll take a healthy break away from my screen.</p>



<a name="204040534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204040534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204040534">(Jul 16 2020 at 03:18)</a>:</h4>
<p>Monday it would be top of my list.</p>



<a name="204041104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041104">(Jul 16 2020 at 03:30)</a>:</h4>
<p>i think i need to figure out what changed in data/polynomial.lean in master and then distribute those changes into the current file structure</p>



<a name="204041128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041128">(Jul 16 2020 at 03:31)</a>:</h4>
<p>Maybe <code>git diff HEAD~5 HEAD -- src/data/polynomial.lean</code> can help (and tweak the <code>5</code> a bit)</p>



<a name="204041586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041586">(Jul 16 2020 at 03:41)</a>:</h4>
<p>running that command gives me no output, including with 5 \to 1 and 5 \to 10</p>



<a name="204041657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041657">(Jul 16 2020 at 03:43)</a>:</h4>
<p>i'll try using the github ui to look at commits</p>



<a name="204041790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041790">(Jul 16 2020 at 03:46)</a>:</h4>
<p><span class="user-mention" data-user-id="252300">@Jalex Stark</span> Did you <code>git pull</code> on the <code>master</code> branch?</p>



<a name="204041795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041795">(Jul 16 2020 at 03:46)</a>:</h4>
<p>Maybe you didn't have the conflicting changes yet, since they are probably quite new</p>



<a name="204041827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041827">(Jul 16 2020 at 03:47)</a>:</h4>
<p>I did <code>git fetch</code> and <code>git merge origin master</code> and have not made a merge commit</p>



<a name="204041834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041834">(Jul 16 2020 at 03:47)</a>:</h4>
<p>i guess if i make a merge commit that keeps the file, your method will work</p>



<a name="204041922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041922">(Jul 16 2020 at 03:49)</a>:</h4>
<p>agh i just get the trivial diff of adding the whole file</p>



<a name="204041929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204041929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204041929">(Jul 16 2020 at 03:49)</a>:</h4>
<p>but now I guess both files live on my machine and I could diff them manually</p>



<a name="204042098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042098">(Jul 16 2020 at 03:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="252300">Jalex Stark</span> <a href="#narrow/stream/116395-maths/topic/polynomial.20refactor/near/204041922">said</a>:</p>
<blockquote>
<p>agh i just get the trivial diff of adding the whole file</p>
</blockquote>
<p>Sounds like you are not on the master branch</p>



<a name="204042166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042166">(Jul 16 2020 at 03:54)</a>:</h4>
<p>ah, i just figured it out</p>



<a name="204042172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042172">(Jul 16 2020 at 03:54)</a>:</h4>
<p>i was using too small numbers</p>



<a name="204042179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042179">(Jul 16 2020 at 03:54)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/commit/58dde5b8fe3778d11b8e4d936a7b98fb790ea085">https://github.com/leanprover-community/mathlib/commit/58dde5b8fe3778d11b8e4d936a7b98fb790ea085</a></p>



<a name="204042180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042180">(Jul 16 2020 at 03:54)</a>:</h4>
<p>if i go back 50 commits, then that's before I deleted the file</p>



<a name="204042185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042185">(Jul 16 2020 at 03:54)</a>:</h4>
<p>Right, but <code>master</code> doesn't know about those 50 commits</p>



<a name="204042195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042195">(Jul 16 2020 at 03:54)</a>:</h4>
<p>Hence, on the master branch, I guess you could use small numbers</p>



<a name="204042197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042197">(Jul 16 2020 at 03:55)</a>:</h4>
<p>oh i see</p>



<a name="204042201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042201">(Jul 16 2020 at 03:55)</a>:</h4>
<p>Is it Kenny's commit I linked above?</p>



<a name="204042211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042211">(Jul 16 2020 at 03:55)</a>:</h4>
<p>I won't be able to look at this until at least tomorrow, but I did see this thing above about having to use <code>p.to_fun</code> in places.</p>



<a name="204042217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042217">(Jul 16 2020 at 03:55)</a>:</h4>
<p>We definitely don't want that.</p>



<a name="204042225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042225">(Jul 16 2020 at 03:55)</a>:</h4>
<p>In fact, a thorough refactor of <code>polynomial</code> is probably going to want to make <code>polynomial</code> <code>@[irreducible]</code> as early as possible, so it's not even possible to convert it to a function.</p>



<a name="204042262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042262">(Jul 16 2020 at 03:56)</a>:</h4>
<p>(i.e. <code>coeff</code> will be the only option)</p>



<a name="204042273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042273">(Jul 16 2020 at 03:56)</a>:</h4>
<p>yes, the problem was that we accidentally went the other direction, making a global instance of coe_to_fn</p>



<a name="204042300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042300">(Jul 16 2020 at 03:57)</a>:</h4>
<p>once we got rid of the bad instance we stopped having the problem</p>



<a name="204042390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042390">(Jul 16 2020 at 03:58)</a>:</h4>
<p>i'll work on merging kenny's tensor product commit</p>



<a name="204042701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204042701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204042701">(Jul 16 2020 at 04:05)</a>:</h4>
<p>ah, great, the only change to polynomial.lean was a deletion of one instance</p>



<a name="204047429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/polynomial%20refactor/near/204047429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/polynomial.20refactor.html#204047429">(Jul 16 2020 at 05:43)</a>:</h4>
<p><code>git log -p filename</code> will give you the complete history of a file, expressed as a series of patches - sounds like it might have been helpful</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>