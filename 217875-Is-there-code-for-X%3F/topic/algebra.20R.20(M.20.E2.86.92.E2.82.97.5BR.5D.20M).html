---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html">algebra R (M →ₗ[R] M)</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="217034977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217034977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217034977">(Nov 17 2020 at 17:28)</a>:</h4>
<p>Does this instance exist anywhere? If not, which file would it belong in?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.algebra.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">linear_map</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">R</span> <span class="o">(</span><span class="n">M</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">•</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">smul_def'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">algebra.smul_mul_assoc</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">],</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="n">one_smul</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="n">zero_smul</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">add_smul</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">mul_smul</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">commutes'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">m</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mul_one</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">,</span> <span class="n">algebra.mul_smul_comm</span><span class="o">,</span> <span class="n">algebra.smul_mul_assoc</span><span class="o">],</span>
  <span class="bp">..</span><span class="n">linear_map.semimodule</span> <span class="o">}</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span> <span class="n">algebra_map</span> <span class="n">R</span> <span class="o">(</span><span class="n">M</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">M</span><span class="o">)</span> <span class="n">r</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">•</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">end</span> <span class="n">linear_map</span>
</code></pre></div>



<a name="217035205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217035205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217035205">(Nov 17 2020 at 17:30)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/module.endomorphism_algebra">docs#module.endomorphism_algebra</a></p>



<a name="217036552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217036552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217036552">(Nov 17 2020 at 17:40)</a>:</h4>
<p>Although in my defense, the naming is inconsistent wrt <a href="https://leanprover-community.github.io/mathlib_docs/find/linear_map.endomorphism_semiring">docs#linear_map.endomorphism_semiring</a></p>



<a name="217037182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217037182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217037182">(Nov 17 2020 at 17:45)</a>:</h4>
<p><span class="user-mention" data-user-id="240862">@Oliver Nash</span>, you added the <code>algebra</code> this way back in <a href="https://github.com/leanprover-community/mathlib/issues/1618">#1618</a>, while the <code>ring</code> predates it from <a href="https://github.com/leanprover-community/mathlib/issues/456">#456</a> (<span class="user-mention" data-user-id="110049">@Mario Carneiro</span>) - do you have a preference between the names? It would be good to make them consistent.</p>



<a name="217057787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217057787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217057787">(Nov 17 2020 at 20:27)</a>:</h4>
<p>Well obviously I prefer the naming I introduced <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="217057875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217057875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217057875">(Nov 17 2020 at 20:28)</a>:</h4>
<p>More seriously, either system seems fine and I agree we should be consistent.</p>



<a name="217058981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217058981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217058981">(Nov 17 2020 at 20:37)</a>:</h4>
<p>I would say that "endomorphism algebra" is more common in the maths literature</p>



<a name="217059325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217059325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217059325">(Nov 17 2020 at 20:40)</a>:</h4>
<p>Certainly much more than "endomorphism semiring"</p>



<a name="217060167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217060167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217060167">(Nov 17 2020 at 20:46)</a>:</h4>
<p>Normally we don't care that much about instance names anyways</p>



<a name="217066199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217066199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217066199">(Nov 17 2020 at 21:33)</a>:</h4>
<p>That's a good point, instance names don't usually matter. In my case, it was a case of "I know this exists somewhere, but I don't know where to find it".</p>



<a name="217066563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217066563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217066563">(Nov 17 2020 at 21:37)</a>:</h4>
<p>but I'm actually not sure what inconsistency you mean, is it the namespace?</p>



<a name="217066618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217066618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217066618">(Nov 17 2020 at 21:37)</a>:</h4>
<p>It seems to me that <code>endomorphism_algebra</code> is an instance of <code>algebra</code> and <code>endomorphism_semiring</code> is an instance of <code>semiring</code></p>



<a name="217071569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217071569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217071569">(Nov 17 2020 at 22:20)</a>:</h4>
<p>Yes, the namespaces don't match, that was my point.</p>



<a name="217082619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217082619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217082619">(Nov 18 2020 at 00:35)</a>:</h4>
<p>I think it makes sense for these to be in the <code>linear_map</code> namespace</p>



<a name="217107314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217107314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217107314">(Nov 18 2020 at 08:31)</a>:</h4>
<p>I guess the other name to consider consistency with here is <a href="https://leanprover-community.github.io/mathlib_docs/find/module.End">docs#module.End</a></p>



<a name="217107344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217107344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217107344">(Nov 18 2020 at 08:31)</a>:</h4>
<p>So perhaps <code>module.End.semiring</code> and <code>module.End.algebra</code>?</p>



<a name="217123203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217123203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217123203">(Nov 18 2020 at 11:34)</a>:</h4>
<p>that would suggest these are instances for <code>End</code>, which they are not</p>



<a name="217123270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217123270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217123270">(Nov 18 2020 at 11:34)</a>:</h4>
<p>I don't understand why we care about the namespaces of instances... surely it's just whatever namespace was in effect when the instance was declared</p>



<a name="217123765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217123765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217123765">(Nov 18 2020 at 11:41)</a>:</h4>
<p>Put differently: what's the original problem here? Is it that it can be hard to find out what instances exist for something because they could be defined anywhere (I agree)? If so then let's focus on that</p>



<a name="217125790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217125790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217125790">(Nov 18 2020 at 12:05)</a>:</h4>
<p>You can still go to <a href="https://leanprover-community.github.io/mathlib_docs/find/algebra">docs#algebra</a>, click on <em>instances</em> and search there. It's a long list in this case, but not that long, and you can search for endomorphism.</p>



<a name="217127269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127269">(Nov 18 2020 at 12:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M)/near/217123203">said</a>:</p>
<blockquote>
<p>that would suggest these are instances for <code>End</code>, which they are not</p>
</blockquote>
<p>Given <code>End</code> is an <code>abbreviation</code>, doesn't that mean these _are_ instances for <code>End</code>?</p>



<a name="217127406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127406">(Nov 18 2020 at 12:22)</a>:</h4>
<p>Oh I see, the documentation doesn't show <code>abbreviation</code>s.</p>



<a name="217127559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127559">(Nov 18 2020 at 12:24)</a>:</h4>
<p>In this particular case, the confusion came from the docstring for <code>End</code> indicating the presence of an instance that I couldn't find</p>



<a name="217127646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127646">(Nov 18 2020 at 12:25)</a>:</h4>
<p>But in general it's hard - if I'm looking for whether a type supports multiplication, I need to scan for <code>semiring</code>, <code>distrib</code>, <code>monoid</code>, ... instances - expanding <code>has_mul</code> is not going to help me much.</p>



<a name="217127763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127763">(Nov 18 2020 at 12:26)</a>:</h4>
<p>I recall there was some tactic that was written (by me?) to collect all the typeclasses on a type</p>



<a name="217127939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217127939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217127939">(Nov 18 2020 at 12:28)</a>:</h4>
<p>It would be great if that tactic could be executed by doc-gen</p>



<a name="217128353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217128353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217128353">(Nov 18 2020 at 12:33)</a>:</h4>
<p>I found this in my mile long <code>test.lean</code> file, so it is probably on zulip somewhere</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span>
<span class="kn">namespace</span> <span class="n">tactic</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">env_fold</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">declaration</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">tactic</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">get_env</span> <span class="bp">&gt;&gt;=</span> <span class="bp">λ</span> <span class="n">e</span> <span class="n">s</span><span class="o">,</span> <span class="n">e.fold</span> <span class="o">((</span><span class="n">return</span> <span class="n">a</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">_</span><span class="o">)</span> <span class="n">s</span><span class="o">)</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">d</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">interaction_monad.result.cases_on</span> <span class="n">t</span> <span class="o">(</span><span class="n">f</span> <span class="n">d</span><span class="o">)</span> <span class="n">result.exception</span>

<span class="k">#print</span> <span class="n">interaction_monad.monad</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">get_all_classes</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">list</span> <span class="n">name</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">list.reverse</span> <span class="bp">&lt;$&gt;</span> <span class="n">env_fold</span> <span class="o">[]</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">d</span> <span class="n">l</span><span class="o">,</span>
  <span class="n">mcond</span> <span class="o">(</span><span class="n">is_class</span> <span class="o">(</span><span class="n">expr.const</span> <span class="n">d.to_name</span> <span class="o">(</span><span class="n">level.param</span> <span class="bp">&lt;$&gt;</span> <span class="n">d.univ_params</span><span class="o">)))</span>
    <span class="o">(</span><span class="n">return</span> <span class="o">(</span><span class="n">d.to_name</span> <span class="o">::</span> <span class="n">l</span><span class="o">))</span> <span class="o">(</span><span class="n">return</span> <span class="n">l</span><span class="o">))</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">list_instances</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">expr</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">list</span> <span class="n">expr</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">get_all_classes</span> <span class="bp">&gt;&gt;=</span> <span class="n">list.mfoldr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">l</span><span class="o">,</span>
  <span class="o">(</span><span class="k">do</span> <span class="n">e'</span> <span class="bp">←</span> <span class="n">mk_app</span> <span class="n">n</span> <span class="o">[</span><span class="n">e</span><span class="o">],</span>
    <span class="n">mk_instance</span> <span class="n">e'</span> <span class="bp">&gt;&gt;</span> <span class="n">return</span> <span class="o">(</span><span class="n">e'</span> <span class="o">::</span> <span class="n">l</span><span class="o">))</span> <span class="bp">&lt;|&gt;</span>
  <span class="n">return</span> <span class="n">l</span><span class="o">)</span> <span class="o">[]</span> <span class="bp">.</span>

<span class="kn">open</span> <span class="n">interactive</span> <span class="n">interactive.types</span>
<span class="kd">meta</span> <span class="kd">def</span> <span class="n">interactive.list_instances</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">parse</span> <span class="n">texpr</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">to_expr</span> <span class="n">e</span> <span class="bp">&gt;&gt;=</span> <span class="n">list_instances</span> <span class="bp">&gt;&gt;=</span> <span class="n">list.mmap'</span> <span class="n">trace</span>

<span class="kd">run_cmd</span> <span class="n">list_instances</span> <span class="bp">`</span><span class="o">(</span><span class="n">with_bot</span> <span class="n">ℕ</span><span class="o">)</span> <span class="bp">&gt;&gt;=</span> <span class="n">trace</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">list_instances</span> <span class="o">(</span><span class="n">with_bot</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">trivial</span><span class="o">}</span>
<span class="c1">-- add_semigroup (with_bot ℕ)</span>
<span class="c1">-- inhabited (with_bot ℕ)</span>
<span class="c1">-- semilattice_sup_bot (with_bot ℕ)</span>
<span class="c1">-- add_monoid (with_bot ℕ)</span>
<span class="c1">-- has_well_founded (with_bot ℕ)</span>
<span class="c1">-- has_lt (with_bot ℕ)</span>
<span class="c1">-- has_to_tactic_format (with_bot ℕ)</span>
<span class="c1">-- lattice (with_bot ℕ)</span>
<span class="c1">-- has_sup (with_bot ℕ)</span>
<span class="c1">-- ordered_add_comm_monoid (with_bot ℕ)</span>
<span class="c1">-- has_to_format (with_bot ℕ)</span>
<span class="c1">-- has_one (with_bot ℕ)</span>
<span class="c1">-- distrib_lattice (with_bot ℕ)</span>
<span class="c1">-- preorder (with_bot ℕ)</span>
<span class="c1">-- add_comm_monoid (with_bot ℕ)</span>
<span class="c1">-- add_comm_semigroup (with_bot ℕ)</span>
<span class="c1">-- has_zero (with_bot ℕ)</span>
<span class="c1">-- has_bot (with_bot ℕ)</span>
<span class="c1">-- has_sizeof (with_bot ℕ)</span>
<span class="c1">-- semilattice_inf (with_bot ℕ)</span>
<span class="c1">-- reflected (with_bot ℕ)</span>
<span class="c1">-- has_le (with_bot ℕ)</span>
<span class="c1">-- nonempty (with_bot ℕ)</span>
<span class="c1">-- linear_order (with_bot ℕ)</span>
<span class="c1">-- decidable_linear_order (with_bot ℕ)</span>
<span class="c1">-- semilattice_inf_bot (with_bot ℕ)</span>
<span class="c1">-- has_add (with_bot ℕ)</span>
<span class="c1">-- semilattice_sup (with_bot ℕ)</span>
<span class="c1">-- has_inf (with_bot ℕ)</span>
<span class="c1">-- order_bot (with_bot ℕ)</span>
<span class="c1">-- partial_order (with_bot ℕ)</span>
<span class="kd">end</span> <span class="n">tactic</span>
</code></pre></div>



<a name="217128458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/algebra%20R%20%28M%20%E2%86%92%E2%82%97%5BR%5D%20M%29/near/217128458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/algebra.20R.20(M.20.E2.86.92.E2.82.97.5BR.5D.20M).html#217128458">(Nov 18 2020 at 12:34)</a>:</h4>
<p><a href="#narrow/stream/116395-maths/topic/with_bot/near/196835021">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/with_bot/near/196835021</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>