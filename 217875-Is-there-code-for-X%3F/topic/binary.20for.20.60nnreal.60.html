---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html">binary for `nnreal`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="280913266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280913266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280913266">(May 02 2022 at 18:24)</a>:</h4>
<p>Here's a rather beautiful thing distilled from Peter's <code>Analytic.pdf</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.nnreal</span> <span class="c1">-- non-negative reals</span>
<span class="kn">import</span> <span class="n">topology.algebra.infinite_sum</span> <span class="c1">-- infinite sums</span>

<span class="n">open_locale</span> <span class="n">nnreal</span> <span class="c1">-- notation for non-negative reals</span>

<span class="n">open_locale</span> <span class="n">big_operators</span> <span class="c1">-- notation for infinite sums</span>

<span class="kd">def</span> <span class="n">binary</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">binary_le_one</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">binary</span> <span class="n">r</span> <span class="n">z</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">binary_sum</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∑'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">binary</span> <span class="n">r</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">2</span><span class="bp">⁻¹</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">r</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>Do we have it already?</p>



<a name="280913953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280913953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280913953">(May 02 2022 at 18:29)</a>:</h4>
<p>PS Thank you so much to all the analysts who have written a fabulous API for sums over non-negative reals and extended non-negative reals. This together with with the <code>norm_cast</code> family of tactics has really made my work a lot easier and again emphasizes the importance of developing everything together in one place.</p>



<a name="280915257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280915257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280915257">(May 02 2022 at 18:40)</a>:</h4>
<p>It would be neat to have something similar for <code>nnrat</code> too, assuming <code>tsum</code> ever converges there</p>



<a name="280949847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280949847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280949847">(May 02 2022 at 23:51)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13894">#13894</a> adds the first two statements</p>



<a name="280951274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280951274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280951274">(May 03 2022 at 00:12)</a>:</h4>
<p>I would think a definition like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mi>r</mi><msup><mi>b</mi><mi>n</mi></msup><mo stretchy="false">⌋</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>b</mi></mrow><annotation encoding="application/x-tex">\lfloor r b^n \rfloor \bmod{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span></span></span> would be more useful</p>



<a name="280951503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/binary%20for%20%60nnreal%60/near/280951503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/binary.20for.20.60nnreal.60.html#280951503">(May 03 2022 at 00:16)</a>:</h4>
<p>Maybe that's the one <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> has. I think the <code>zlog</code> from that PR to indicate the last non-zero digit is still useful, but your definition for the series is definitely better than my recursive approach</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>