---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html">Simple nat.sqrt lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="218327583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218327583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrián Doña Mateo <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218327583">(Nov 30 2020 at 18:43)</a>:</h4>
<p>I couldn't find any of these in the library so I wrote them myself.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sqrt_pred_lt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">lt_of_le_of_lt</span> <span class="o">(</span><span class="n">sqrt_le</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="n">pred_lt</span> <span class="n">h</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">le_succ_sqrt_pred</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">n</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="n">le_of_pred_lt</span> <span class="o">(</span><span class="n">lt_succ_sqrt</span> <span class="n">_</span><span class="o">)</span>

<span class="sd">/-- There are no perfect squares strictly between a² and (a+1)² -/</span>
<span class="kd">lemma</span> <span class="n">no_middle_square</span> <span class="o">{</span><span class="n">n</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hl</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)):</span>
    <span class="bp">¬</span> <span class="bp">∃</span> <span class="n">t</span><span class="o">,</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
    <span class="n">rintro</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span> <span class="n">nat.mul_self_lt_mul_self_iff.mpr</span> <span class="n">hl</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="n">nat.mul_self_lt_mul_self_iff.mpr</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>I was wondering if it would be good to add any them to <code>data.nat.sqrt</code>.<br>
The last one is very useful for proving that a natural number is not a square.</p>



<a name="218328277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218328277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218328277">(Nov 30 2020 at 18:48)</a>:</h4>
<p>Make a PR!</p>



<a name="218329245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218329245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218329245">(Nov 30 2020 at 18:55)</a>:</h4>
<p>Some golfing to remove unnecessary <code>n \ne 0</code> hypotheses. Do you really need to state it on the <code>pred</code> versions?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.sqrt</span>
<span class="kn">import</span> <span class="n">tactic.linarith</span>

<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">lemma</span> <span class="n">sqrt_lt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">sqrt</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">sqrt</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">lt_succ_iff.mpr</span> <span class="o">(</span><span class="n">sqrt_le</span> <span class="n">_</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">le_succ_sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">le_of_pred_lt</span> <span class="o">(</span><span class="n">lt_succ_sqrt</span> <span class="n">_</span><span class="o">)</span>

<span class="sd">/-- There are no perfect squares strictly between a² and (a+1)² -/</span>
<span class="kd">lemma</span> <span class="n">no_middle_square</span> <span class="o">{</span><span class="n">n</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hl</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)):</span>
    <span class="bp">¬</span> <span class="bp">∃</span> <span class="n">t</span><span class="o">,</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
    <span class="n">rintro</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span> <span class="n">nat.mul_self_lt_mul_self_iff.mpr</span> <span class="n">hl</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="n">nat.mul_self_lt_mul_self_iff.mpr</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="218332652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218332652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218332652">(Nov 30 2020 at 19:21)</a>:</h4>
<p>Further golfing, no <code>linarith</code> dep, and no necessary hyps for the <code>no_middle_square</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.sqrt</span>

<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">lemma</span> <span class="n">sqrt_lt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">sqrt</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">sqrt</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">lt_succ_iff.mpr</span> <span class="o">(</span><span class="n">sqrt_le</span> <span class="n">_</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">le_succ_sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">le_of_pred_lt</span> <span class="o">(</span><span class="n">lt_succ_sqrt</span> <span class="n">_</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">not_exists_between_succ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">k</span> <span class="bp">∧</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">not_exists.mpr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">k</span><span class="o">,</span> <span class="n">not_and.mpr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span> <span class="n">H</span><span class="o">,</span> <span class="n">absurd</span> <span class="n">H</span> <span class="o">(</span><span class="n">not_lt_of_le</span> <span class="o">(</span><span class="n">lt_of_succ_le</span> <span class="n">h</span><span class="o">))))</span>

<span class="sd">/-- There are no perfect squares strictly between n² and (n+1)² -/</span>
<span class="kd">lemma</span> <span class="n">no_middle_square</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">¬</span> <span class="bp">∃</span> <span class="n">t</span><span class="o">,</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span> <span class="bp">∧</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rintro</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">ht'</span><span class="o">⟩,</span>
  <span class="n">rw</span> <span class="bp">←</span><span class="n">nat.mul_self_lt_mul_self_iff</span> <span class="n">at</span> <span class="n">ht</span> <span class="n">ht'</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">eq_or_lt_of_le</span> <span class="o">(</span><span class="n">le_of_lt_succ</span> <span class="n">ht'</span><span class="o">)</span> <span class="k">with</span> <span class="n">rfl</span><span class="bp">|</span><span class="n">H</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">absurd</span> <span class="n">ht</span> <span class="o">(</span><span class="n">lt_irrefl</span> <span class="n">t</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">not_exists_between_succ</span> <span class="n">t</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">H</span><span class="o">,</span> <span class="n">lt_succ_of_lt</span> <span class="n">ht</span><span class="o">⟩</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="218336324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218336324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218336324">(Nov 30 2020 at 19:50)</a>:</h4>
<p>Constructively, it seems like it would be more useful to have that last lemma as a for all / or</p>



<a name="218336399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218336399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218336399">(Nov 30 2020 at 19:50)</a>:</h4>
<p>The previous lemma, with hypotheses, looks easier to work with</p>



<a name="218340539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Simple%20nat.sqrt%20lemmas/near/218340539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Simple.20nat.2Esqrt.20lemmas.html#218340539">(Nov 30 2020 at 20:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">no_middle_square'</span> <span class="o">{</span><span class="n">n</span> <span class="n">t</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">t</span> <span class="bp">*</span> <span class="n">t</span> <span class="o">:=</span>
<span class="n">nat.mul_self_le_mul_self</span> <span class="o">(</span><span class="n">succ_le_of_lt</span> <span class="o">(</span><span class="n">nat.mul_self_lt_mul_self_iff.mpr</span> <span class="n">h</span><span class="o">))</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>