---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html">Making `finset.sum` into an explicit sum</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="285175604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285175604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vasily Ilin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285175604">(Jun 06 2022 at 21:38)</a>:</h4>
<p>How do I go between <code>finset.sum</code> to an explicit sum? I'd imagine it's just <code>simp</code>, using <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_cons">docs#finset.sum_cons</a> three times. But <code>simp</code> doesn't do it. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">linear_algebra.basis</span>
<span class="kn">import</span> <span class="n">data.matrix.notation</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span> <span class="bp">→</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">v0</span> <span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">•</span> <span class="bp">!</span><span class="o">[</span><span class="n">v0</span><span class="o">,</span> <span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">]</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v0</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v3</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="285176561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285176561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vasily Ilin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285176561">(Jun 06 2022 at 21:47)</a>:</h4>
<p>Also, what tactic would do this? </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span> <span class="bp">→</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">v0</span> <span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span>
<span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v0</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v3</span> <span class="bp">=</span>
<span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v0</span> <span class="bp">-</span> <span class="n">v1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v1</span> <span class="bp">-</span> <span class="n">v2</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v2</span> <span class="bp">-</span> <span class="n">v3</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v3</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="285183516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285183516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285183516">(Jun 06 2022 at 22:55)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span> <span class="bp">→</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">v0</span> <span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span>
<span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v0</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v3</span> <span class="bp">=</span>
<span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v0</span> <span class="bp">-</span> <span class="n">v1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v1</span> <span class="bp">-</span> <span class="n">v2</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v2</span> <span class="bp">-</span> <span class="n">v3</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">smul_sub</span><span class="o">,</span> <span class="n">sub_smul</span><span class="o">],</span>
  <span class="n">abel</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>The <code>hint</code> tactic suggests that you can't do this with one tactic.</p>



<a name="285183955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285183955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285183955">(Jun 06 2022 at 23:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">linear_algebra.basis</span>
<span class="kn">import</span> <span class="n">data.matrix.notation</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span> <span class="bp">→</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">v0</span> <span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">•</span> <span class="bp">!</span><span class="o">[</span><span class="n">v0</span><span class="o">,</span> <span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">]</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v0</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">finset.sum_fin_eq_sum_range</span><span class="o">,</span> <span class="n">finset.sum_range_succ</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>
<p>works. I knew about <code>finset.sum_range_succ</code> so could see that if I could translate into this I'd probably be done, and so I tried <code>rw finset.sum_range</code> and auto-complete found <code>finset.sum_fin_eq_sum_range</code> for me.</p>



<a name="285184549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285184549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285184549">(Jun 06 2022 at 23:05)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/fin.sum_univ_succ">docs#fin.sum_univ_succ</a></p>



<a name="285184594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285184594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285184594">(Jun 06 2022 at 23:06)</a>:</h4>
<p>We seem to get a question asking for that lemma every week or so!</p>



<a name="285209232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285209232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vasily Ilin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285209232">(Jun 07 2022 at 06:42)</a>:</h4>
<p>With the help above I was able to finish the proof. But it looks quite ugly and takes a few seconds to compile. I'm sure such as simple proposition can be proven easier. Can anyone give me advice on how to make this proof better?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span> <span class="c1">-- imports all the Lean tactics</span>
<span class="kn">import</span> <span class="n">linear_algebra.basis</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">data.complex.module</span>
<span class="kn">import</span> <span class="n">data.matrix.notation</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="n">v4</span><span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">lin_indep</span> <span class="o">:</span> <span class="n">linear_independent</span> <span class="n">k</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v4</span><span class="o">])</span> <span class="o">:</span> <span class="n">linear_independent</span> <span class="n">k</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="bp">-</span><span class="n">v2</span><span class="o">,</span> <span class="n">v2</span><span class="bp">-</span><span class="n">v3</span><span class="o">,</span> <span class="n">v3</span><span class="bp">-</span><span class="n">v4</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">fintype.linear_independent_iff</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">g</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">f</span> <span class="o">:=</span> <span class="bp">!</span><span class="o">[</span><span class="n">g</span> <span class="mi">0</span><span class="o">,</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span><span class="o">,</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span><span class="o">,</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span><span class="o">],</span>
  <span class="n">specialize</span> <span class="n">lin_indep</span> <span class="n">f</span><span class="o">,</span>
  <span class="k">suffices</span>  <span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">g0</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="k">calc</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">rfl</span>
        <span class="bp">...</span>  <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">hf</span> <span class="mi">0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">g1</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="k">calc</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">refl</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hf</span> <span class="mi">1</span><span class="o">,</span> <span class="n">g0</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">],</span>
  <span class="k">have</span> <span class="n">g2</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="k">calc</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">1</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">1</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">refl</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hf</span> <span class="mi">2</span><span class="o">,</span> <span class="n">g1</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">],</span>
  <span class="k">have</span> <span class="n">g3</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="k">calc</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">=</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">3</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">refl</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hf</span> <span class="mi">3</span><span class="o">,</span> <span class="n">g2</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">],</span>

  <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">fin_cases</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">g0</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">g1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">g2</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">g3</span><span class="o">,</span>

  <span class="n">apply</span> <span class="n">lin_indep</span><span class="o">,</span>
  <span class="k">calc</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">•</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="n">i</span><span class="o">)</span>
            <span class="bp">=</span> <span class="n">f</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v3</span> <span class="bp">+</span> <span class="n">f</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v4</span> <span class="o">:</span> <span class="kd">by</span>
            <span class="kd">begin</span>
              <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fin.sum_univ_succ</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">,</span> <span class="n">matrix.cons_val_zero</span><span class="o">,</span> <span class="n">matrix.cons_val_succ</span><span class="o">,</span> <span class="n">fin.succ_zero_eq_one</span><span class="o">,</span> <span class="n">fin.succ_one_eq_two</span><span class="o">,</span> <span class="n">fintype.univ_of_subsingleton</span><span class="o">,</span> <span class="n">fin.mk_eq_subtype_mk</span><span class="o">,</span> <span class="n">fin.mk_zero</span><span class="o">,</span> <span class="n">finset.sum_singleton</span><span class="o">,</span> <span class="n">add_right_inj</span><span class="o">],</span>
              <span class="n">refl</span><span class="o">,</span>
            <span class="kd">end</span>
     <span class="bp">...</span>    <span class="bp">=</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v3</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v4</span> <span class="o">:</span> <span class="n">rfl</span>
     <span class="bp">...</span>    <span class="bp">=</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v1</span> <span class="bp">-</span> <span class="n">v2</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v2</span> <span class="bp">-</span> <span class="n">v3</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="o">(</span><span class="n">v3</span> <span class="bp">-</span> <span class="n">v4</span><span class="o">)</span> <span class="bp">+</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v4</span> <span class="o">:</span> <span class="kd">by</span>
            <span class="kd">begin</span>
              <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">smul_sub</span><span class="o">,</span> <span class="n">sub_smul</span><span class="o">],</span>
              <span class="n">abel</span><span class="o">,</span>
            <span class="kd">end</span>
     <span class="bp">...</span>    <span class="bp">=</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span> <span class="n">g</span> <span class="n">i</span> <span class="bp">•</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span> <span class="bp">-</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v2</span> <span class="bp">-</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v3</span> <span class="bp">-</span> <span class="n">v4</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span>
            <span class="kd">begin</span>
              <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fin.sum_univ_succ</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">,</span> <span class="n">matrix.cons_val_zero</span><span class="o">,</span> <span class="n">matrix.cons_val_succ</span><span class="o">,</span> <span class="n">fin.succ_zero_eq_one</span><span class="o">,</span> <span class="n">fin.succ_one_eq_two</span><span class="o">,</span> <span class="n">fintype.univ_of_subsingleton</span><span class="o">,</span> <span class="n">fin.mk_eq_subtype_mk</span><span class="o">,</span> <span class="n">fin.mk_zero</span><span class="o">,</span> <span class="n">finset.sum_singleton</span><span class="o">,</span> <span class="n">add_right_inj</span><span class="o">],</span>
              <span class="n">refl</span><span class="o">,</span>
            <span class="kd">end</span>
     <span class="bp">...</span>    <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="285252355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285252355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285252355">(Jun 07 2022 at 13:44)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.basis</span>
<span class="kn">import</span> <span class="n">data.matrix.notation</span>

<span class="kn">open</span> <span class="n">matrix</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">V</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">better_form</span> <span class="o">(</span><span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="n">v4</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span>
<span class="bp">!</span><span class="o">[</span><span class="n">v1</span> <span class="bp">-</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v2</span> <span class="bp">-</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v3</span> <span class="bp">-</span> <span class="n">v4</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="bp">=</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="bp">-</span> <span class="n">fin.snoc</span> <span class="o">(</span><span class="n">fin.tail</span> <span class="o">(</span><span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v4</span><span class="o">]))</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">vec_head</span><span class="o">,</span> <span class="n">vec_tail</span><span class="o">,</span> <span class="n">fin.snoc</span><span class="o">,</span> <span class="n">fin.tail</span><span class="o">]</span><span class="bp">;</span> <span class="n">refl</span>

<span class="kd">lemma</span> <span class="n">snoc_tail_lin_indep</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span> <span class="bp">→</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">lin_indep</span> <span class="o">:</span> <span class="n">linear_independent</span> <span class="n">R</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span>
<span class="n">linear_independent</span> <span class="n">R</span> <span class="o">(</span><span class="n">v</span> <span class="bp">-</span> <span class="n">fin.snoc</span> <span class="o">(</span><span class="n">fin.tail</span> <span class="n">v</span><span class="o">)</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp_rw</span> <span class="n">fintype.linear_independent_iff</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">lin_indep</span><span class="o">,</span> <span class="n">intros</span> <span class="n">g</span> <span class="n">hg</span> <span class="n">i</span><span class="o">,</span>
  <span class="k">suffices</span> <span class="n">hli</span> <span class="o">:</span>  <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">),</span>
                  <span class="o">(</span><span class="n">g</span> <span class="bp">-</span> <span class="n">fin.cons</span> <span class="mi">0</span> <span class="o">(</span><span class="n">fin.init</span> <span class="n">g</span><span class="o">))</span> <span class="n">i</span> <span class="bp">•</span> <span class="n">v</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">specialize</span> <span class="n">lin_indep</span> <span class="n">_</span> <span class="n">hli</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">g0</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">-</span>   <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">lin_indep</span> <span class="mi">0</span><span class="o">,</span>               <span class="n">rw</span> <span class="n">sub_zero</span> <span class="n">at</span> <span class="n">g0</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">g1</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">lin_indep</span> <span class="mi">1</span><span class="o">,</span> <span class="n">rw</span> <span class="n">g0</span> <span class="n">at</span> <span class="n">g1</span><span class="o">,</span>  <span class="n">rw</span> <span class="n">sub_zero</span> <span class="n">at</span> <span class="n">g1</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">g2</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">lin_indep</span> <span class="mi">2</span><span class="o">,</span> <span class="n">rw</span> <span class="n">g1</span> <span class="n">at</span> <span class="n">g2</span><span class="o">,</span>  <span class="n">rw</span> <span class="n">sub_zero</span> <span class="n">at</span> <span class="n">g2</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">g3</span> <span class="o">:</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">lin_indep</span> <span class="mi">3</span><span class="o">,</span> <span class="n">rw</span> <span class="n">g2</span> <span class="n">at</span> <span class="n">g3</span><span class="o">,</span>  <span class="n">rw</span> <span class="n">sub_zero</span> <span class="n">at</span> <span class="n">g3</span><span class="o">,</span>
    <span class="n">fin_cases</span> <span class="n">i</span><span class="bp">;</span> <span class="o">[</span><span class="n">exact</span> <span class="n">g0</span><span class="o">,</span> <span class="n">exact</span> <span class="n">g1</span><span class="o">,</span> <span class="n">exact</span> <span class="n">g2</span><span class="o">,</span> <span class="n">exact</span> <span class="n">g3</span><span class="o">]</span> <span class="o">},</span>

  <span class="n">simp</span> <span class="o">[</span><span class="n">fin.sum_univ_succ</span><span class="o">,</span> <span class="n">smul_sub</span><span class="o">,</span> <span class="n">sub_smul</span><span class="o">]</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">hg</span><span class="o">,</span>
  <span class="n">change</span>  <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">0</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">1</span> <span class="bp">+</span>
          <span class="o">(</span><span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">3</span><span class="o">)))</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">change</span>  <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">0</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">0</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">1</span> <span class="bp">-</span>
          <span class="n">g</span> <span class="mi">1</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">2</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">3</span> <span class="bp">+</span> <span class="o">(</span><span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="n">v</span> <span class="mi">3</span> <span class="bp">-</span> <span class="n">g</span> <span class="mi">3</span> <span class="bp">•</span> <span class="mi">0</span><span class="o">)))</span> <span class="bp">=</span> <span class="mi">0</span> <span class="n">at</span> <span class="n">hg</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">smul_zero</span><span class="o">,</span> <span class="n">sub_zero</span><span class="o">]</span> <span class="n">at</span> <span class="n">hg</span><span class="o">,</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="n">sub_eq_add_neg</span><span class="o">]</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">hg</span><span class="o">,</span>
  <span class="n">nth_rewrite</span> <span class="mi">2</span> <span class="n">add_comm</span><span class="o">,</span> <span class="n">nth_rewrite</span> <span class="mi">4</span> <span class="n">add_comm</span><span class="o">,</span> <span class="n">nth_rewrite</span> <span class="mi">5</span> <span class="n">add_comm</span><span class="o">,</span> <span class="n">simp_rw</span> <span class="n">add_assoc</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">hg</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hg</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">v1</span> <span class="n">v2</span> <span class="n">v3</span> <span class="n">v4</span> <span class="o">:</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">lin_indep</span> <span class="o">:</span> <span class="n">linear_independent</span> <span class="n">R</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">v4</span><span class="o">])</span> <span class="o">:</span>
<span class="n">linear_independent</span> <span class="n">R</span> <span class="bp">!</span><span class="o">[</span><span class="n">v1</span><span class="bp">-</span><span class="n">v2</span><span class="o">,</span> <span class="n">v2</span><span class="bp">-</span><span class="n">v3</span><span class="o">,</span> <span class="n">v3</span> <span class="bp">-</span> <span class="n">v4</span><span class="o">,</span> <span class="n">v4</span><span class="o">]</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">rw</span> <span class="n">better_form</span> <span class="bp">;</span> <span class="n">exact</span> <span class="n">snoc_tail_lin_indep</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">lin_indep</span>
</code></pre></div>



<a name="285252377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285252377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285252377">(Jun 07 2022 at 13:44)</a>:</h4>
<p>This is a bit better :)</p>



<a name="285252433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285252433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285252433">(Jun 07 2022 at 13:44)</a>:</h4>
<p>The problem is ultimately in how you state the lemma - how you express <code>![v1-v2, v2-v3, v3 - v4, v4] </code>, basically.</p>



<a name="285252667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285252667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285252667">(Jun 07 2022 at 13:46)</a>:</h4>
<p>On some level this is a computational algebra task, which Lean has no natural facility in. That's the comm and assoc stuff at the end. Everything else is really just... making sure you're using sensible defintions.</p>



<a name="285252983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285252983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285252983">(Jun 07 2022 at 13:48)</a>:</h4>
<p>If you could express <code>![v1, v2, v3, v4]</code> as the image under a suitable linear map of <code>![v1-v2, v2-v3, v3 - v4, v4]</code> - bearing in mind that to use, say, <code>linear_independent.map'</code> you would have to define a map on<code>V</code> itself - this would be easier. But different expressions of <code>![v1-v2, v2-v3, v3 - v4, v4]</code>produce different difficulties.</p>



<a name="285253223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285253223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285253223">(Jun 07 2022 at 13:50)</a>:</h4>
<p>In general, given an arbitrary linear combination of <code>![v1, v2, v3, v4]</code> and proving linear independence from the linear independence of the v_i is going to be very close to showing that some matrix is non-singular...</p>



<a name="285253825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285253825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285253825">(Jun 07 2022 at 13:54)</a>:</h4>
<p>I note, by the way, that we don't seem to have something like <code>vec_update</code> or <code>vec_rotate</code> which makes this trickier to construct, as you can see.</p>



<a name="285261871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285261871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285261871">(Jun 07 2022 at 14:48)</a>:</h4>
<p><code>vec_update</code> is <a href="https://leanprover-community.github.io/mathlib_docs/find/function.update">docs#function.update</a></p>



<a name="285261937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285261937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285261937">(Jun 07 2022 at 14:48)</a>:</h4>
<p><code>vec_rotate</code> is composition with <a href="https://leanprover-community.github.io/mathlib_docs/find/fin_rotate">docs#fin_rotate</a></p>



<a name="285305164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285305164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285305164">(Jun 07 2022 at 19:52)</a>:</h4>
<p>Aye. But we seem to have <code>vec_cons</code> despite having <code>fin.cons</code> also, unless I'm wrong?</p>



<a name="285310537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285310537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285310537">(Jun 07 2022 at 20:39)</a>:</h4>
<p>I think the motivation is that the latter elaborates badly on non-dependent types. That may well be a concern for <code>update</code> too.</p>



<a name="285310831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285310831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285310831">(Jun 07 2022 at 20:41)</a>:</h4>
<p>Huh, makes sense.</p>



<a name="285511151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Making%20%60finset.sum%60%20into%20an%20explicit%20sum/near/285511151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum.html#285511151">(Jun 09 2022 at 09:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Making.20.60finset.2Esum.60.20into.20an.20explicit.20sum/near/285310537">said</a>:</p>
<blockquote>
<p>I think the motivation is that the latter elaborates badly on non-dependent types. That may well be a concern for <code>update</code> too.</p>
</blockquote>
<p>The issue was specifically that the <code>![1, 2, 3]</code> notation elaborated badly and didn't get pretty-printed correctly (even with type ascriptions etc.)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>