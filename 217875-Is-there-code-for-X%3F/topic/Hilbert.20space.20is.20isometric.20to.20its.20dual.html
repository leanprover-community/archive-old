---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html">Hilbert space is isometric to its dual</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="214583744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214583744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214583744">(Oct 26 2020 at 14:54)</a>:</h4>
<p>Is somewhere in <code>mathlib</code> proven that the map <code>v ‚Üí ‚ü™v, ‚¨ù ‚ü´</code> is isometry between a Hilbert space and its dual?</p>



<a name="214584359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214584359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214584359">(Oct 26 2020 at 14:58)</a>:</h4>
<p>There is a PR about this.</p>



<a name="214584383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214584383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214584383">(Oct 26 2020 at 14:58)</a>:</h4>
<p><span class="user-mention" data-user-id="311453">@Fr√©d√©ric Dupuis</span> <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>



<a name="214592861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214592861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214592861">(Oct 26 2020 at 15:55)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4379">#4379</a>, more precisely. It's currently waiting on how we're going to handle conjugate-linear maps. <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> , are you planning to go ahead with the <code>linear_map (f : R ‚Üí+* S) E F</code> idea that was discussed a few days ago?</p>



<a name="214593889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214593889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214593889">(Oct 26 2020 at 16:01)</a>:</h4>
<p>I have a few refactors in line, and every time I switch branches I choose one of them and advance it a little:</p>
<ul>
<li>bundle <code>direction</code> into <code>affine_subspace</code>;</li>
<li>review affine combinations by introducing the free affine space <code>{f : Œ± ‚Üí‚ÇÄ R | f.sum (Œª a b, b) = 1}</code>;</li>
<li>redefine convexity for affine spaces;</li>
<li>use bundled homs for <code>polynomial.eval</code> etc;</li>
<li>glue <code>mv_power_series</code> to analytic maps;</li>
<li>redefine some free constructions using <a href="https://leanprover-community.github.io/mathlib_docs/find/con">docs#con</a> to get the universal property almost for free;</li>
<li>add <code>smul_comm_class</code> and migrate some parts of the library to it.</li>
</ul>



<a name="214594175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214594175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214594175">(Oct 26 2020 at 16:03)</a>:</h4>
<p>I guess, I'm not going to work on refactoring <code>linear_map</code>s for at least a week, so probably it's better to merge your PR without waiting for this refactor.</p>



<a name="214601769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214601769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214601769">(Oct 26 2020 at 16:55)</a>:</h4>
<p>I wonder whether it's worth refactoring <a href="https://github.com/leanprover-community/mathlib/issues/4379">#4379</a> (again!  Sorry, Fr√©d√©ric), so that it mostly does the real case, and does it in a way that will be directly generalizable to the conjugate-linear setting now that we have a theory for what that setting will look like.</p>



<a name="214601894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214601894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214601894">(Oct 26 2020 at 16:56)</a>:</h4>
<p>If this seems like a good idea, I can try this, since I don't want Fr√©d√©ric to have to spend any more time on this.</p>



<a name="214602054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214602054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214602054">(Oct 26 2020 at 16:57)</a>:</h4>
<p>Maybe also get rid of the development of conjugate vector spaces, if we think that ultimately these will be treated in mathlib using <code>smul_comm_class</code>?</p>



<a name="214605134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214605134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214605134">(Oct 26 2020 at 17:17)</a>:</h4>
<p>Yeah, if we get conjugate-linear maps soon(ish) we definitely want this code to be based on that. I think the best thing to do would be to remove the conjugate semimodule code and merge it.</p>



<a name="214637196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214637196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214637196">(Oct 26 2020 at 21:44)</a>:</h4>
<p><span class="user-mention" data-user-id="311453">@Fr√©d√©ric Dupuis</span> I would like to change your definition of the dual of a Hilbert space, so that the inner product is given by the polarization identity: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_inner</span> <span class="bp">ùïú</span> <span class="o">(</span><span class="n">normed_space.dual</span> <span class="bp">ùïú</span> <span class="n">E</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">inner</span> <span class="o">:=</span> <span class="bp">Œª</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="mi">4</span><span class="bp">‚Åª¬π</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span>
            <span class="bp">+</span> <span class="n">is_R_or_C.I</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">@</span><span class="n">is_R_or_C.I</span> <span class="bp">ùïú</span> <span class="n">_</span><span class="o">)</span> <span class="bp">‚Ä¢</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">@</span><span class="n">is_R_or_C.I</span> <span class="bp">ùïú</span> <span class="n">_</span><span class="o">)</span> <span class="bp">‚Ä¢</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span>
            <span class="bp">-</span> <span class="n">is_R_or_C.I</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">-</span> <span class="o">(</span><span class="bp">@</span><span class="n">is_R_or_C.I</span> <span class="bp">ùïú</span> <span class="n">_</span><span class="o">)</span> <span class="bp">‚Ä¢</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">ùìö</span> <span class="bp">‚à•</span><span class="n">x</span> <span class="bp">-</span> <span class="o">(</span><span class="bp">@</span><span class="n">is_R_or_C.I</span> <span class="bp">ùïú</span> <span class="n">_</span><span class="o">)</span> <span class="bp">‚Ä¢</span> <span class="n">y</span><span class="bp">‚à•</span><span class="o">))</span> <span class="o">}</span>
</code></pre></div>

<p>rather than copied over from the primal inner product by means of the equivalence:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_inner</span> <span class="bp">ùïú</span> <span class="o">(</span><span class="n">normed_space.dual</span> <span class="bp">ùïú</span> <span class="n">E</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">inner</span> <span class="o">:=</span> <span class="bp">Œª</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="bp">‚ü™</span><span class="n">to_primal</span> <span class="n">y</span><span class="o">,</span> <span class="n">to_primal</span> <span class="n">x</span><span class="bp">‚ü´</span> <span class="o">}</span>
</code></pre></div>

<p>as you had written.  The advantage is that the new definition works for inner product spaces without a completeness hypothesis.  What do you think?</p>



<a name="214637383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214637383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214637383">(Oct 26 2020 at 21:46)</a>:</h4>
<p>This also would mean that the statement that "the mapping from <code>E</code> to its dual is an isometry" has content, rather than following by definition.</p>



<a name="214637453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214637453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214637453">(Oct 26 2020 at 21:47)</a>:</h4>
<p>That makes sense -- I hadn't thought about the completeness issue.  I guess you'll have to prove the <code>is_R_or_C</code> polarization identity first though, only the real case is there now and I've been too lazy so far to generalize it :-)</p>



<a name="214637572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214637572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214637572">(Oct 26 2020 at 21:48)</a>:</h4>
<p>Yep, I am halfway there after a solid hour's work, it is not pleasant! :)</p>



<a name="214637977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214637977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214637977">(Oct 26 2020 at 21:52)</a>:</h4>
<p>I have no doubt -- that's why I haven't done it...!</p>



<a name="214638521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214638521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214638521">(Oct 26 2020 at 21:58)</a>:</h4>
<p>I was half-hoping that there were some mysteries of <code>is_R_or_C</code> which you would explain to me and which would improve things ....</p>



<a name="214638817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214638817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214638817">(Oct 26 2020 at 22:01)</a>:</h4>
<p>Not really -- it mostly just works like <code>‚ÑÇ</code>. So at least it shouldn't be any more annoying than proving the complex polarization identity directly.</p>



<a name="214639063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214639063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214639063">(Oct 26 2020 at 22:03)</a>:</h4>
<p>The one thing that is more annoying than <code>‚ÑÇ</code> is that coercions from reals have to be done manually, so <code>norm_cast</code> doesn't work.</p>



<a name="214639338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214639338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214639338">(Oct 26 2020 at 22:06)</a>:</h4>
<p>Yep, just figured that out half an hour ago :)</p>



<a name="214639376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214639376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214639376">(Oct 26 2020 at 22:07)</a>:</h4>
<p>(I wonder if it would be possible to get <code>norm_cast</code> working for <code>is_R_or_C</code>?  Need to ask someone who knows about tactics.)</p>



<a name="214639777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214639777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214639777">(Oct 26 2020 at 22:11)</a>:</h4>
<p>I looked into it at the time, and I strongly suspect that the answer is no. We can't have proper coercions, because that causes a circular issue with the <code>ùïú=‚Ñù</code> case, and <code>norm_cast</code> really needs coercions from what I could gather from the code. Maybe it's possible to create a specialized version of <code>norm_cast</code> where we replace the coercions by the manual one in <code>is_R_or_C</code>, but I'm afraid that's above my pay grade at the moment :-)</p>



<a name="214639807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214639807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214639807">(Oct 26 2020 at 22:11)</a>:</h4>
<p>I see, very interesting!</p>



<a name="214644302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214644302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214644302">(Oct 26 2020 at 23:11)</a>:</h4>
<p>Does <a href="https://leanprover-community.github.io/mathlib_docs/find/has_lift_t">docs#has_lift_t</a> work?</p>



<a name="214644383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214644383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214644383">(Oct 26 2020 at 23:12)</a>:</h4>
<p>This is a coercion that requires an explicit up arrow.</p>



<a name="214646853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214646853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214646853">(Oct 26 2020 at 23:50)</a>:</h4>
<p>Hmm... maybe? It's worth looking into -- for some reason I've never run into these before.</p>



<a name="214649131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214649131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214649131">(Oct 27 2020 at 00:24)</a>:</h4>
<p>It is (mis)used for coercion of a <code>finset</code> to a <code>set</code>.</p>



<a name="214652835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214652835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214652835">(Oct 27 2020 at 01:30)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="o">(</span><span class="k">show</span> <span class="n">has_lift_t</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span><span class="o">,</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span>
</code></pre></div>

<p>fails. Doesn't look good...</p>



<a name="214654415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214654415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214654415">(Oct 27 2020 at 02:06)</a>:</h4>
<p>I think that you can define it and it'll work.</p>



<a name="214656758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214656758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214656758">(Oct 27 2020 at 03:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_lift</span> <span class="n">‚Ñù</span> <span class="n">K</span> <span class="o">:=</span> <span class="o">‚ü®</span><span class="n">of_real</span><span class="o">‚ü©</span>
<span class="k">#check</span> <span class="o">(</span><span class="k">show</span> <span class="n">has_lift_t</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span><span class="o">,</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span>
</code></pre></div>

<p>This still fails -- I have no idea why...</p>



<a name="214657553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214657553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214657553">(Oct 27 2020 at 03:18)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?</p>



<a name="214659238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659238">(Oct 27 2020 at 03:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">is_R_or_C</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>  <span class="o">:=</span>
<span class="o">(</span><span class="n">of_real</span> <span class="o">:</span> <span class="n">‚Ñù</span> <span class="bp">‚Üí</span> <span class="n">K</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">is_R_or_C</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_lift</span> <span class="n">‚Ñù</span> <span class="n">K</span> <span class="o">:=</span> <span class="o">‚ü®</span><span class="n">of_real</span><span class="o">‚ü©</span>
<span class="k">#check</span> <span class="o">(</span><span class="k">show</span> <span class="n">has_lift_t</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span><span class="o">,</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">is_R_or_C</span>
</code></pre></div>



<a name="214659313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659313">(Oct 27 2020 at 03:56)</a>:</h4>
<p>the has_lift instance is not ok</p>



<a name="214659316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659316">(Oct 27 2020 at 03:56)</a>:</h4>
<p>because it causes <code>has_lift_t</code> to loop</p>



<a name="214659325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659325">(Oct 27 2020 at 03:56)</a>:</h4>
<p>OK, so basically the same reason we couldn't have the coercion either.</p>



<a name="214659329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659329">(Oct 27 2020 at 03:56)</a>:</h4>
<p>That's a shame.</p>



<a name="214659339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659339">(Oct 27 2020 at 03:57)</a>:</h4>
<p>you could make it a <code>has_{coe|lift}_t</code> instance</p>



<a name="214659439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659439">(Oct 27 2020 at 03:59)</a>:</h4>
<p>Really? I'm pretty sure I tried making this a <code>has_coe_t</code> instance directly a while back and it failed.</p>



<a name="214659594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659594">(Oct 27 2020 at 04:02)</a>:</h4>
<p>And if I recall correctly, it was you who convinced me I should give up and do coercions manually :-)</p>



<a name="214659632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659632">(Oct 27 2020 at 04:03)</a>:</h4>
<p>Indeed it was: <a href="#narrow/stream/113489-new-members/topic/has_coe.20.E2.84.9D.20.E2.84.9D/near/207775998">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/has_coe.20.E2.84.9D.20.E2.84.9D/near/207775998</a></p>



<a name="214659707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659707">(Oct 27 2020 at 04:05)</a>:</h4>
<p>right... we don't have reflexive coe_t instances</p>



<a name="214659785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659785">(Oct 27 2020 at 04:07)</a>:</h4>
<p>I think it should be possible to modify <code>norm_cast</code> to work with things other than <code>coe</code></p>



<a name="214659786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659786">(Oct 27 2020 at 04:07)</a>:</h4>
<p>Are reflexive <code>has_coe_t</code> instances bad, or only <code>has_coe</code>?</p>



<a name="214659792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659792">(Oct 27 2020 at 04:07)</a>:</h4>
<p>A version of <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> that works</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">is_R_or_C</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>  <span class="o">:=</span>
<span class="o">(</span><span class="n">of_real</span> <span class="o">:</span> <span class="n">‚Ñù</span> <span class="bp">‚Üí</span> <span class="n">K</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">is_R_or_C</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_lift</span> <span class="n">‚Ñù</span> <span class="n">K</span> <span class="o">:=</span> <span class="o">‚ü®</span><span class="n">of_real</span><span class="o">‚ü©</span>
<span class="k">#check</span> <span class="o">(</span><span class="k">show</span> <span class="n">has_lift_t</span> <span class="n">‚Ñù</span> <span class="n">‚Ñù</span><span class="o">,</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">is_R_or_C</span>
</code></pre></div>



<a name="214659844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214659844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214659844">(Oct 27 2020 at 04:08)</a>:</h4>
<p>it looks identical to <span class="user-mention" data-user-id="311453">@Fr√©d√©ric Dupuis</span> 's</p>



<a name="214662253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214662253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214662253">(Oct 27 2020 at 05:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual/near/214637572">said</a>:</p>
<blockquote>
<p>Yep, I am halfway there after a solid hour's work, it is not pleasant! :)</p>
</blockquote>
<p>I posted a WIP PR, <a href="https://github.com/leanprover-community/mathlib/issues/4798">#4798</a>, anyone in the mood for some algebra problems is welcome to take over some of the sorries!</p>



<a name="214670889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214670889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214670889">(Oct 27 2020 at 08:20)</a>:</h4>
<p>This should really, really be <code>has_coe_t</code> or <code>has_lift_t</code>.  Otherwise you get loops, as Mario's pointed out.  This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="kd">class</span> <span class="n">is_R_or_C</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>  <span class="o">:=</span>
<span class="o">(</span><span class="n">of_real</span> <span class="o">:</span> <span class="n">‚Ñù</span> <span class="bp">‚Üí</span> <span class="n">K</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">is_R_or_C</span> <span class="n">‚Ñù</span> <span class="o">:=</span> <span class="o">‚ü®</span><span class="n">id</span><span class="o">‚ü©</span>

<span class="kn">namespace</span> <span class="n">is_R_or_C</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_coe_t</span> <span class="n">‚Ñù</span> <span class="n">K</span> <span class="o">:=</span> <span class="o">‚ü®</span><span class="n">of_real</span><span class="o">‚ü©</span>

<span class="kd">variable</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñù</span><span class="o">)</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">‚Üë</span><span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñù</span><span class="o">)</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">coe</span> <span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñù</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">is_R_or_C</span>
</code></pre></div>



<a name="214671047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671047">(Oct 27 2020 at 08:22)</a>:</h4>
<p>I pushed a fix for the easiest sorry</p>



<a name="214671275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671275">(Oct 27 2020 at 08:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span>  Should we add a general reflexive instance for <code>has_lift_t</code> and/or <code>has_coe_t</code>?</p>



<a name="214671396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671396">(Oct 27 2020 at 08:27)</a>:</h4>
<p>Like <a href="https://leanprover-community.github.io/mathlib_docs/find/coe_base">docs#coe_base</a>?</p>



<a name="214671442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671442">(Oct 27 2020 at 08:28)</a>:</h4>
<p>That's just the singleton case</p>



<a name="214671499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671499">(Oct 27 2020 at 08:28)</a>:</h4>
<p>it implies that has_coe_t is the transitive closure of has_coe, but I am thinking about the reflexive transitive closure</p>



<a name="214671528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671528">(Oct 27 2020 at 08:28)</a>:</h4>
<p>Ah, I see.</p>



<a name="214671571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671571">(Oct 27 2020 at 08:29)</a>:</h4>
<p>Type class-wise, I don't think there would be any issues. <em>Except for non-commuting diamonds.</em></p>



<a name="214671667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671667">(Oct 27 2020 at 08:30)</a>:</h4>
<p>But I don't think coercions should be used in this way.  If you explicitly write <code>(x : Œ±)</code>, then you never need the reflexive instance.</p>



<a name="214671723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671723" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671723">(Oct 27 2020 at 08:31)</a>:</h4>
<p>I agree, but the alternatives don't look great for Frederic's use case</p>



<a name="214671796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671796">(Oct 27 2020 at 08:32)</a>:</h4>
<p>I don't think we will get non-commuting diamonds since <code>f o id = f</code> is definitional</p>



<a name="214671819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214671819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214671819">(Oct 27 2020 at 08:32)</a>:</h4>
<p>but it might be tricky to prove that all the time</p>



<a name="214672048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672048">(Oct 27 2020 at 08:35)</a>:</h4>
<p>We already have other reflexive instances (like <code>nat.cast_coe</code>).  These would not be definitionally equal to the general one.</p>



<a name="214672132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672132">(Oct 27 2020 at 08:36)</a>:</h4>
<p>For Fr√©deric's use case we need a coercion for <code>is_R_or_C</code> anyhow, I'm not sure how a general reflexive instance helps here.</p>



<a name="214672162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672162">(Oct 27 2020 at 08:37)</a>:</h4>
<p>well it would be weird if we had a reflexive instance only for real</p>



<a name="214672173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672173">(Oct 27 2020 at 08:37)</a>:</h4>
<p>Another (very realistic) option is to convince <code>norm_cast</code> that <code>is_R_or_C.of_real</code> is a coercion (it already knows about <code>has_coe_to_fun</code>, <code>has_coe_to_sort</code>; this is just one more function).</p>



<a name="214672180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672180">(Oct 27 2020 at 08:37)</a>:</h4>
<p>That's my thought</p>



<a name="214672187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672187">(Oct 27 2020 at 08:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual/near/214672162">said</a>:</p>
<blockquote>
<p>well it would be weird if we had a reflexive instance only for real</p>
</blockquote>
<p>We also have it for nat, int, etc.</p>



<a name="214672312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672312">(Oct 27 2020 at 08:39)</a>:</h4>
<p>Personally, I think I'd prefer coercions over <code>is_R_or_C.of_real</code>.</p>



<a name="214672333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672333">(Oct 27 2020 at 08:40)</a>:</h4>
<p>you've convinced me that <code>[is_R_or_C K] : has_coe_t real K</code> would be no better or worse than <code>nat.has_coe</code></p>



<a name="214672395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214672395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214672395">(Oct 27 2020 at 08:40)</a>:</h4>
<p>it's a bit better, since the induced reflexive instance is definitional</p>



<a name="214700160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214700160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214700160">(Oct 27 2020 at 13:41)</a>:</h4>
<p>Well that's great news! I see there's a great docstring in <code>data/nat/cast</code> that gives the recipe...</p>



<a name="214715435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214715435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214715435">(Oct 27 2020 at 15:24)</a>:</h4>
<p>Did a few more - done for now, though</p>



<a name="214715532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214715532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214715532">(Oct 27 2020 at 15:25)</a>:</h4>
<p>Great!</p>



<a name="214715896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214715896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214715896">(Oct 27 2020 at 15:27)</a>:</h4>
<p>Regarding the casting:  If I understand correctly, there are two proposals:  to have a "conditional" coercion <code>[is_R_or_C K] : has_coe_t real K</code>, or to hard-code coercion-like behaviour into <code>norm_cast</code>.  Would the second proposal mean that one only had improved behaviour when using <code>norm_cast</code>, whereas the first proposal would apply to any situation where one wants to use casts (in <code>norm_cast</code> or out)?  If so, the first seems better.</p>



<a name="214716058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214716058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214716058">(Oct 27 2020 at 15:28)</a>:</h4>
<p>yes, that's right. In particular, the first option would let you use <code>\u</code> while the second requires some other notation</p>



<a name="214717705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214717705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214717705">(Oct 27 2020 at 15:38)</a>:</h4>
<p>And the first option would also let one cast like <code>(3:K)</code>, right?  (Which you can't currently do.)</p>



<a name="214722631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214722631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214722631">(Oct 27 2020 at 16:08)</a>:</h4>
<p>Or rather, I think you can do this (because 3 is a numeral), but you can't currently take an <code>x</code> of type <code>‚Ñù</code> and cast by saying <code>(x:K)</code>.  The change would permit that.</p>



<a name="214724162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/214724162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#214724162">(Oct 27 2020 at 16:19)</a>:</h4>
<p>Yes, I would much prefer the coercion as well.</p>



<a name="215046736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/215046736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#215046736">(Oct 30 2020 at 00:58)</a>:</h4>
<p>The coercion seems to work! See <a href="https://github.com/leanprover-community/mathlib/issues/4824">#4824</a></p>



<a name="215046822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/215046822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Fr√©d√©ric Dupuis <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#215046822">(Oct 30 2020 at 00:59)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> This PR might make the remaining sorries in <a href="https://github.com/leanprover-community/mathlib/issues/4798">#4798</a> a bit less painful :-)</p>



<a name="215047950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Hilbert%20space%20is%20isometric%20to%20its%20dual/near/215047950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Hilbert.20space.20is.20isometric.20to.20its.20dual.html#215047950">(Oct 30 2020 at 01:25)</a>:</h4>
<p><span class="user-mention" data-user-id="311453">@Fr√©d√©ric Dupuis</span>  Very cool!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>