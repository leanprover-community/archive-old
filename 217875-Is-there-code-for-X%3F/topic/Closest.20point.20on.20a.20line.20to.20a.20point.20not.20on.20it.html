---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html">Closest point on a line to a point not on it</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="290034595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290034595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290034595">(Jul 18 2022 at 23:05)</a>:</h4>
<p>Do we have a theorem that says that the closest point on a line $L$ to a point $P$ not on it is obtained by dropping a perpendicular from the point $P$ to $L$?</p>



<a name="290039985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290039985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290039985">(Jul 19 2022 at 00:22)</a>:</h4>
<p>Isn't that Hilbert's projection theorem?</p>



<a name="290040276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290040276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290040276">(Jul 19 2022 at 00:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290039985">said</a>:</p>
<blockquote>
<p>Isn't that Hilbert's projection theorem?</p>
</blockquote>
<p>is this in mathlib?</p>



<a name="290040502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290040502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290040502">(Jul 19 2022 at 00:31)</a>:</h4>
<p>Not yet</p>



<a name="290040707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290040707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290040707">(Jul 19 2022 at 00:35)</a>:</h4>
<p>Thanks!</p>



<a name="290040884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290040884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290040884">(Jul 19 2022 at 00:38)</a>:</h4>
<p>I'm reading the wiki page for Hilbert's projection theorem ... I think this result provides a characterization of the closest point is not a direct corollary of it.</p>



<a name="290040992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290040992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290040992">(Jul 19 2022 at 00:41)</a>:</h4>
<p>I accidentally ended up proving this while doing some linear programming stuff only to realize later that it might've already been in mathlib. Here's my code so far: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.convex.cone</span>
<span class="kd">noncomputable theory</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">H</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inner_product_space</span> <span class="n">ℝ</span> <span class="n">H</span><span class="o">]</span>

<span class="kn">section</span> <span class="n">closed_convex_cone</span>

<span class="c1">-- Reference: https://ti.inf.ethz.ch/ew/lehre/ApproxSDP09/notes/conelp.pdf</span>

<span class="sd">/-- Given a closed convex cone K and a point b not in K, if z is the point in K closest to b then</span>
<span class="sd">z - b is perpendicular to z. -/</span>
<span class="kd">theorem</span> <span class="n">closest_point_perp</span>
  <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="n">convex_cone</span> <span class="n">ℝ</span> <span class="n">H</span><span class="o">}</span> <span class="o">(</span><span class="n">hK</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">))</span>
  <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">H</span><span class="o">}</span> <span class="o">(</span><span class="n">disj</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">∉</span> <span class="n">K</span><span class="o">)</span>
  <span class="o">{</span><span class="n">z</span> <span class="o">:</span> <span class="n">H</span><span class="o">}</span> <span class="o">(</span><span class="n">hzK</span> <span class="o">:</span> <span class="n">z</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h_inf</span> <span class="o">:</span> <span class="n">metric.inf_dist</span> <span class="n">b</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">)</span> <span class="bp">=</span> <span class="n">dist</span> <span class="n">b</span> <span class="n">z</span><span class="o">)</span> <span class="o">:</span> <span class="bp">⟪</span><span class="n">z</span> <span class="bp">-</span> <span class="n">b</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">z</span> <span class="bp">-</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">hz</span> <span class="o">:</span> <span class="n">z</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- If z is zero, we're done.</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">hz</span><span class="o">,</span> <span class="n">inner_zero_right</span><span class="o">]</span> <span class="o">},</span>
  <span class="kd">begin</span>
    <span class="c1">-- In the case z ≠ 0, we provide a proof by contradiction. The proof strategy is to show that</span>
    <span class="c1">-- for a sufficiently small constant α, point z' = (1 - α) • z lies in K and is closer to b than</span>
    <span class="c1">-- z, thereby contradicting h_inf.</span>
    <span class="n">by_contra'</span> <span class="n">hyz</span><span class="o">,</span>

    <span class="c1">-- We will pick a different scaling factor depending on the sign of ⟪y, z⟫_ℝ.</span>
    <span class="n">obtain</span> <span class="o">(</span><span class="n">hyz_neg</span> <span class="bp">|</span> <span class="n">hyz_pos</span><span class="o">)</span> <span class="o">:=</span> <span class="n">ne.lt_or_lt</span> <span class="n">hyz</span><span class="o">,</span> <span class="n">clear</span> <span class="n">hyz</span><span class="o">,</span>

    <span class="c1">-- Case 1: ⟪y, z⟫_ℝ &lt; 0.</span>
    <span class="k">let</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hα</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">&lt;</span> <span class="mi">0</span> <span class="o">:=</span>
      <span class="n">linarith.mul_neg</span> <span class="n">hyz_neg</span> <span class="o">(</span><span class="n">inv_pos.2</span> <span class="o">(</span><span class="n">sq_pos_of_ne_zero</span> <span class="n">_</span> <span class="o">(</span><span class="n">norm_ne_zero_iff.2</span> <span class="n">hz</span><span class="o">))),</span>
    <span class="c1">-- Scale z by (1 - α) to obtain z'.</span>
    <span class="k">let</span> <span class="n">z'</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">α</span><span class="o">)</span> <span class="bp">•</span> <span class="n">z</span><span class="o">,</span>
    <span class="c1">-- Show that z' is in K.</span>
    <span class="k">have</span> <span class="n">hz'</span> <span class="o">:</span> <span class="n">z'</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">)</span> <span class="o">:=</span> <span class="n">K.smul_mem</span> <span class="o">(</span><span class="n">sub_pos.2</span> <span class="o">(</span><span class="n">lt_trans</span> <span class="n">hα</span> <span class="n">zero_lt_one</span><span class="o">))</span> <span class="n">hzK</span><span class="o">,</span>
    <span class="c1">-- Auxiliary lemma for computation of dist b z'.</span>
    <span class="k">have</span> <span class="n">h_aux</span> <span class="o">:</span> <span class="bp">-</span><span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">-</span> <span class="bp">∥</span><span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">∥^</span><span class="mi">2</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">0</span><span class="o">,</span> <span class="kd">by</span>
    <span class="kd">begin</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">real_inner_smul_right</span><span class="o">,</span> <span class="n">norm_smul</span><span class="o">,</span> <span class="n">real.norm_eq_abs</span><span class="o">,</span> <span class="n">abs_of_neg</span> <span class="n">hα</span><span class="o">,</span> <span class="n">neg_mul</span><span class="o">,</span> <span class="n">neg_sq</span><span class="o">],</span>
      <span class="n">ring_nf</span><span class="o">,</span>
      <span class="n">refine</span> <span class="n">mul_neg_of_pos_of_neg</span> <span class="n">_</span> <span class="n">hα</span><span class="o">,</span>
      <span class="k">calc</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="bp">-</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="o">[</span><span class="n">lt_neg</span><span class="o">,</span> <span class="n">neg_zero</span><span class="o">]</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">norm_num</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">α</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">sub_mul</span><span class="o">,</span> <span class="bp">←</span> <span class="n">mul_assoc</span><span class="o">,</span>
              <span class="n">mul_inv_cancel</span> <span class="o">(</span><span class="n">ne_of_gt</span> <span class="o">(</span><span class="n">sq_pos_of_ne_zero</span> <span class="n">_</span> <span class="o">(</span><span class="n">norm_ne_zero_iff.2</span> <span class="n">hz</span><span class="o">)))]</span>
    <span class="kd">end</span><span class="o">,</span>

    <span class="c1">-- Case 2: ⟪y, z⟫_ℝ &gt; 0.</span>
    <span class="n">swap</span> <span class="mi">2</span><span class="o">,</span>
    <span class="k">let</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">min</span> <span class="o">((</span><span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span><span class="o">)</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">5</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hα</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">α</span> <span class="o">:=</span>
      <span class="n">lt_min_iff.2</span> <span class="o">⟨</span> <span class="n">mul_pos</span> <span class="o">(</span><span class="n">inv_pos.2</span> <span class="o">(</span><span class="n">sq_pos_of_ne_zero</span> <span class="n">_</span> <span class="o">(</span><span class="n">norm_ne_zero_iff.2</span> <span class="n">hz</span><span class="o">)))</span> <span class="n">hyz_pos</span><span class="o">,</span>
        <span class="n">one_half_pos</span> <span class="o">⟩,</span>
    <span class="c1">-- Scale z by (1 - α) to obtain z'.</span>
    <span class="k">let</span> <span class="n">z'</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">α</span><span class="o">)</span> <span class="bp">•</span> <span class="n">z</span><span class="o">,</span>
    <span class="c1">-- Show that z' is in K.</span>
    <span class="k">have</span> <span class="n">hz'</span> <span class="o">:</span> <span class="n">z'</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">)</span>
             <span class="o">:=</span> <span class="n">K.smul_mem</span> <span class="o">(</span><span class="n">sub_pos.2</span> <span class="o">(</span><span class="n">min_lt_of_right_lt</span> <span class="n">one_half_lt_one</span><span class="o">))</span> <span class="n">hzK</span><span class="o">,</span>
    <span class="c1">-- Auxiliary lemma for computation of dist b z'.</span>
    <span class="k">have</span> <span class="n">h_aux</span> <span class="o">:</span> <span class="bp">-</span><span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">-</span> <span class="bp">∥</span><span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">∥^</span><span class="mi">2</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">0</span><span class="o">,</span> <span class="kd">by</span>
    <span class="kd">begin</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">real_inner_smul_right</span><span class="o">,</span> <span class="n">norm_smul</span><span class="o">,</span> <span class="n">real.norm_eq_abs</span><span class="o">,</span> <span class="n">abs_of_pos</span> <span class="n">hα</span><span class="o">],</span>
      <span class="n">ring_nf</span><span class="o">,</span>
      <span class="n">refine</span> <span class="n">mul_neg_of_neg_of_pos</span> <span class="n">_</span> <span class="n">hα</span><span class="o">,</span>
      <span class="k">calc</span> <span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">α</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span>
          <span class="bp">≤</span> <span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="o">{</span>
          <span class="n">rw</span> <span class="o">[</span><span class="n">sub_le_sub_iff_right</span><span class="o">,</span> <span class="n">mul_le_mul_left</span> <span class="o">(</span><span class="n">sq_pos_of_ne_zero</span> <span class="n">_</span> <span class="o">(</span><span class="n">norm_ne_zero_iff.2</span> <span class="n">hz</span><span class="o">))],</span>
          <span class="n">exact</span> <span class="n">min_le_left</span> <span class="n">_</span> <span class="n">_</span> <span class="o">}</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">∥</span><span class="n">z</span><span class="bp">∥</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span><span class="bp">⁻¹</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">mul_assoc</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span>
          <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">mul_inv_cancel</span> <span class="o">(</span><span class="n">ne_of_gt</span> <span class="o">(</span><span class="n">sq_pos_of_ne_zero</span> <span class="n">_</span> <span class="o">(</span><span class="n">norm_ne_zero_iff.2</span> <span class="n">hz</span><span class="o">)))</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">-</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="o">:</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">sub_mul</span><span class="o">,</span> <span class="n">norm_num</span> <span class="o">}</span>
      <span class="bp">...</span> <span class="bp">&lt;</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">neg_lt_zero.2</span> <span class="n">hyz_pos</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>

    <span class="c1">-- In both cases, distance between b and z' is less than the distance between b and z.</span>
    <span class="n">repeat</span> <span class="kd">begin</span>
      <span class="k">have</span> <span class="n">hbzz'</span> <span class="o">:</span> <span class="n">dist</span> <span class="n">b</span> <span class="n">z'</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">&lt;</span> <span class="n">dist</span> <span class="n">b</span> <span class="n">z</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="k">calc</span> <span class="o">(</span><span class="n">dist</span> <span class="n">b</span> <span class="n">z'</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span>
          <span class="bp">=</span> <span class="bp">∥</span><span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">α</span><span class="o">)</span> <span class="bp">•</span> <span class="n">z</span> <span class="bp">-</span> <span class="n">b</span><span class="bp">∥^</span><span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">dist_eq_norm'</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">z</span> <span class="bp">-</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span> <span class="bp">-</span> <span class="n">b</span><span class="bp">∥^</span><span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">sub_smul</span><span class="o">,</span> <span class="n">one_smul</span><span class="o">]</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">∥</span><span class="o">(</span><span class="n">z</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="bp">-</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">∥^</span><span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">abel</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">y</span><span class="bp">∥^</span><span class="mi">2</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">+</span> <span class="bp">∥</span><span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">∥^</span><span class="mi">2</span>
          <span class="o">:</span> <span class="kd">by</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="n">norm_sq_eq_inner</span><span class="o">,</span> <span class="n">real_inner_sub_sub_self</span><span class="o">,</span> <span class="n">is_R_or_C.re_to_real</span><span class="o">]</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="bp">∥</span><span class="n">y</span><span class="bp">∥^</span><span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="bp">⟪</span><span class="n">y</span><span class="o">,</span> <span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">⟫</span><span class="n">_ℝ</span> <span class="bp">-</span> <span class="bp">∥</span><span class="n">α</span> <span class="bp">•</span> <span class="n">z</span><span class="bp">∥^</span><span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">sub_add</span>
      <span class="bp">...</span> <span class="bp">&lt;</span> <span class="bp">∥</span><span class="n">y</span><span class="bp">∥^</span><span class="mi">2</span> <span class="o">:</span> <span class="n">add_lt_iff_neg_left.mpr</span> <span class="n">h_aux</span>
      <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="n">dist</span> <span class="n">b</span> <span class="n">z</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">dist_eq_norm'</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">hbz'</span> <span class="o">:</span> <span class="n">metric.inf_dist</span> <span class="n">b</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="n">set</span> <span class="n">H</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">dist</span> <span class="n">b</span> <span class="n">z'</span>
                <span class="o">:=</span> <span class="bp">@</span><span class="n">metric.inf_dist_le_dist_of_mem</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">b</span> <span class="n">_</span> <span class="n">hz'</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">h_inf</span><span class="o">,</span> <span class="bp">←</span> <span class="bp">@</span><span class="n">abs_dist</span> <span class="n">_</span> <span class="n">_</span> <span class="n">b</span> <span class="n">z</span><span class="o">,</span> <span class="bp">←</span> <span class="bp">@</span><span class="n">abs_dist</span> <span class="n">_</span> <span class="n">_</span> <span class="n">b</span> <span class="n">z'</span><span class="o">,</span> <span class="bp">←</span> <span class="n">sq_le_sq</span><span class="o">]</span> <span class="n">at</span> <span class="n">hbz'</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">not_lt_of_le</span> <span class="n">hbz'</span> <span class="n">hbzz'</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
  <span class="kd">end</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">closed_convex_cone</span>
</code></pre></div>



<a name="290041647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290041647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290041647">(Jul 19 2022 at 00:52)</a>:</h4>
<p>This is generalizable away from cones.</p>



<a name="290042248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290042248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290042248">(Jul 19 2022 at 01:03)</a>:</h4>
<p>I don't think this is true. The wikipedia proof in fact assumes that the convex set is a subspace which is weaker than a convex cone.</p>



<a name="290042256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290042256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290042256">(Jul 19 2022 at 01:03)</a>:</h4>
<p>"Proof of characterization of minimum point when {\displaystyle C}C is a closed vector subspace."</p>



<a name="290042313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290042313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290042313">(Jul 19 2022 at 01:04)</a>:</h4>
<p>Do you have a reference in mind?</p>



<a name="290043267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290043267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290043267">(Jul 19 2022 at 01:24)</a>:</h4>
<p>Ah for the orthogonality sure.</p>



<a name="290044936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290044936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290044936">(Jul 19 2022 at 01:57)</a>:</h4>
<p><span class="user-mention" data-user-id="245078">@Apurva Nakade</span> It can be much shorter.  You should use <a href="https://leanprover-community.github.io/mathlib_docs/find/orthogonal_projection">docs#orthogonal_projection</a>.</p>



<a name="290044994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290044994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290044994">(Jul 19 2022 at 01:59)</a>:</h4>
<p>Depending on your needs (if the line doesn't pass through the origin), possibly <a href="https://leanprover-community.github.io/mathlib_docs/find/euclidean_geometry.orthogonal_projection">docs#euclidean_geometry.orthogonal_projection</a></p>



<a name="290049478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290049478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290049478">(Jul 19 2022 at 03:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290044936">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="245078">Apurva Nakade</span> It can be much shorter.  You should use <a href="https://leanprover-community.github.io/mathlib_docs/find/orthogonal_projection">docs#orthogonal_projection</a>.</p>
</blockquote>
<p>Thank you! I'll try to rewrite it using orthogonal projection. I think this version ought to be sufficient. The line does pass through the origin with a  minor twist that we want only positive scalars. But I think it should be manageable.</p>



<a name="290049958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290049958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290049958">(Jul 19 2022 at 03:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290039985">said</a>:</p>
<blockquote>
<p>Isn't that Hilbert's projection theorem?</p>
</blockquote>
<p>Is this Hilbert's projection theorem: <a href="https://leanprover-community.github.io/mathlib_docs/find/exists_norm_eq_infi_of_complete_convex">docs#exists_norm_eq_infi_of_complete_convex</a> ?</p>



<a name="290050024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290050024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290050024">(Jul 19 2022 at 03:30)</a>:</h4>
<p>I feel like the doc string should be more descriptive for such an important theorem lol</p>



<a name="290050058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Closest%20point%20on%20a%20line%20to%20a%20point%20not%20on%20it/near/290050058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Apurva Nakade <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it.html#290050058">(Jul 19 2022 at 03:31)</a>:</h4>
<p>The next theorem is exactly what i've been looking for <a href="https://leanprover-community.github.io/mathlib_docs/find/norm_eq_infi_iff_real_inner_eq_zero">docs#norm_eq_infi_iff_real_inner_eq_zero</a> :O</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>