---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html">more inductions for int</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="276121282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276121282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276121282">(Mar 21 2022 at 22:18)</a>:</h4>
<p>I (think I) currently need the int-equivalents of <code>nat.le_induction</code> and <code>nat.decreasing_induction</code>. I’d add them unless someone tells me that my abilities to search for existing lemmas have proven insufficient.</p>



<a name="276122729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276122729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276122729">(Mar 21 2022 at 22:36)</a>:</h4>
<p>I guess they are just specializations of <a href="https://leanprover-community.github.io/mathlib_docs/data/int/basic.html#int.induction_on%27">https://leanprover-community.github.io/mathlib_docs/data/int/basic.html#int.induction_on%27</a></p>



<a name="276124263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276124263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276124263">(Mar 21 2022 at 22:57)</a>:</h4>
<p>Ouch, that has nasty equation lemmas</p>



<a name="276129671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276129671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276129671">(Mar 22 2022 at 00:07)</a>:</h4>
<p>Both lemmas follow directly from <code>int.induction_on'</code></p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">lemma</span> <span class="n">int.le_induction</span> <span class="o">{</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="kt">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">P</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">P</span><span class="o">,</span> <span class="n">apply</span> <span class="n">int.induction_on'</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">h</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">h</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">h₁</span> <span class="n">ih</span> <span class="n">P</span> <span class="n">h₂</span> <span class="n">h₃</span> <span class="n">_</span><span class="o">,</span> <span class="n">h₃</span> <span class="n">_</span> <span class="n">h₁</span> <span class="o">(</span><span class="n">ih</span> <span class="n">h₂</span> <span class="n">h₃</span> <span class="n">h₁</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">k</span> <span class="n">h₁</span> <span class="n">ih</span> <span class="n">P</span> <span class="n">h₂</span> <span class="n">h₃</span> <span class="n">h₄</span><span class="o">,</span> <span class="k">have</span> <span class="n">h₅</span> <span class="o">:=</span> <span class="n">h₁.trans</span> <span class="n">h₄</span><span class="o">,</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">contrapose</span><span class="bp">!</span> <span class="n">h₅</span><span class="o">,</span> <span class="n">apply</span> <span class="n">sub_one_lt</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">int.decreasing_induction</span> <span class="o">{</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="kt">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">P</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">h₃</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">P</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">apply</span> <span class="n">int.induction_on'</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">id</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">k</span> <span class="n">h₁</span> <span class="n">ih</span> <span class="n">P</span> <span class="n">h₂</span> <span class="n">h₃</span> <span class="n">h₄</span><span class="o">,</span> <span class="k">have</span> <span class="n">h₅</span> <span class="o">:=</span> <span class="n">h₂.trans</span> <span class="n">h₁</span><span class="o">,</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">contrapose</span><span class="bp">!</span> <span class="n">h₅</span><span class="o">,</span> <span class="n">apply</span> <span class="n">lt_add_one</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">k</span> <span class="n">h₁</span> <span class="n">ih</span> <span class="n">P</span> <span class="n">h₂</span> <span class="n">h₃</span> <span class="n">h₄</span><span class="o">,</span> <span class="n">apply</span> <span class="n">h₃</span><span class="o">,</span> <span class="n">rw</span> <span class="n">sub_add_cancel</span><span class="o">,</span> <span class="n">apply</span> <span class="n">ih</span> <span class="n">h₁</span> <span class="n">h₃</span> <span class="n">h₄</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
</div></div>
<p>I think the bias is against adding new induction principles if they follow from existing ones (see <a href="#narrow/stream/116395-maths/topic/induction.20on.20degree.20of.20polynomial/near/275915403">this</a> for example).</p>



<a name="276148304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276148304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276148304">(Mar 22 2022 at 06:34)</a>:</h4>
<p>In LTE I recently added</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- src/for_mathlib/triangle_shift.lean L426L433</span>
<span class="kd">@[elab_as_eliminator]</span> <span class="kn">protected</span> <span class="kd">lemma</span> <span class="n">_root_.int.induction_on_iff</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span>
  <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hz</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">↔</span> <span class="n">p</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">:</span> <span class="n">p</span> <span class="n">i</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">i</span> <span class="n">using</span> <span class="n">int.induction_on</span> <span class="k">with</span> <span class="n">i</span> <span class="n">IH</span> <span class="n">i</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">hz</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rwa</span> <span class="bp">←</span> <span class="n">h</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">h</span><span class="o">,</span> <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">sub_add_cancel</span><span class="o">],</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="276154014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276154014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276154014">(Mar 22 2022 at 08:07)</a>:</h4>
<p>Another thing that's missing is something which is definitionally <code>nat.rec</code> but uses +1 instead of <code>succ</code>. I would like to see this one in mathlib but it definitely follows from something which is already there :-)</p>



<a name="276160413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276160413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276160413">(Mar 22 2022 at 09:19)</a>:</h4>
<p><code>match n with | 0 := _ | (n + 1) := _ end</code> is one way to spell that recursor, but I guess that's annoying</p>



<a name="276162376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162376">(Mar 22 2022 at 09:39)</a>:</h4>
<p>I have written a "multiplicative induction" principle, since I needed it for my work on the Hilbert symbol:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm">!</span>
<span class="cm">### Establish an induction principle for multiplicatively closed properties</span>

<span class="cm">If `P : ℕ → Prop` satisfies `P 0`, `P 1`, `P p` for every prime number `p`</span>
<span class="cm">and `∀ (m n : ℕ), P m → P n → P (m*n)`, then `P n` holds for all `n : ℕ`.</span>

<span class="cm">Similarly for `P : ℤ → Prop`, with `P (-1)` added for good measure.</span>
<span class="cm">-/</span>

<span class="kn">section</span> <span class="n">multiplicative_induction</span>

<span class="sd">/-- The principle of multiplicative induction for natural numbers -/</span>
<span class="kd">theorem</span> <span class="n">nat_multiplicative_induction</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmult</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">P</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_cases</span> <span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- easy case `n = 0`</span>
    <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h0</span><span class="o">,</span> <span class="o">},</span>
  <span class="c1">-- now `n &gt; 0`; take its factors</span>
  <span class="k">let</span> <span class="n">nf</span> <span class="o">:</span> <span class="n">multiset</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="n">n.factors</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">nfp</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">p</span> <span class="bp">∈</span> <span class="n">nf</span><span class="o">,</span> <span class="n">nat.prime</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="o">{</span> <span class="n">intro</span> <span class="n">p</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nf</span><span class="o">],</span> <span class="n">exact</span> <span class="n">nat.prime_of_mem_factors</span><span class="o">,</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hp'</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">p</span> <span class="bp">∈</span> <span class="n">nf</span><span class="o">,</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">intros</span> <span class="n">p</span> <span class="n">hyp</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hp</span> <span class="n">p</span> <span class="o">(</span><span class="n">nfp</span> <span class="n">p</span> <span class="n">hyp</span><span class="o">),</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hn</span> <span class="o">:</span> <span class="n">nf.prod</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nf</span><span class="o">],</span> <span class="n">exact</span> <span class="n">nat.prod_factors</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">hn</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">multiset.prod_induction</span> <span class="n">P</span> <span class="n">nf</span> <span class="n">hmult</span> <span class="n">h1</span> <span class="n">hp'</span><span class="o">,</span>
<span class="kd">end</span>

<span class="sd">/-- The principle of multiplicative induction for natural numbers -/</span>
<span class="kd">theorem</span> <span class="n">int_multiplicative_induction</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hn1</span> <span class="o">:</span> <span class="n">P</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmult</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">P</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- reduce to the case of natural numbers</span>
  <span class="k">let</span> <span class="n">P'</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span> <span class="n">P</span> <span class="bp">↑</span><span class="n">n</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">hmult'</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">P'</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P'</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P'</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">P'</span><span class="o">],</span> <span class="n">intros</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hmult</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span> <span class="o">},</span>
  <span class="c1">-- this gives us the statement for `|n|`</span>
  <span class="k">have</span> <span class="n">hP'</span> <span class="o">:=</span> <span class="n">nat_multiplicative_induction</span> <span class="n">P'</span> <span class="o">(</span><span class="kd">by</span> <span class="n">assumption_mod_cast</span><span class="o">)</span> <span class="o">(</span><span class="kd">by</span> <span class="n">assumption_mod_cast</span><span class="o">)</span>
                <span class="o">(</span><span class="kd">by</span> <span class="n">assumption_mod_cast</span><span class="o">)</span> <span class="n">hmult'</span> <span class="n">n.nat_abs</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">P'</span><span class="o">]</span> <span class="n">at</span> <span class="n">hP'</span><span class="o">,</span> <span class="c1">-- gives `P ↑n.nat_abs`</span>
  <span class="c1">-- split according to sign</span>
  <span class="n">cases</span> <span class="n">int.nat_abs_eq</span> <span class="n">n</span> <span class="k">with</span> <span class="n">hn</span> <span class="n">hn</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- `n = ↑n.nat_abs`</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">hn</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">hP'</span> <span class="o">},</span>
  <span class="o">{</span> <span class="c1">-- `n = -↑n.nat_abs`</span>
    <span class="n">rw</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="kd">by</span> <span class="n">ring</span> <span class="o">:</span> <span class="bp">-</span><span class="o">(</span><span class="n">n.nat_abs</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">*↑</span><span class="n">n.nat_abs</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">hmult</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">↑</span><span class="n">n.nat_abs</span> <span class="n">hn1</span> <span class="n">hP'</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">multiplicative_induction</span>
</code></pre></div>
<p>Would it make sense to include that?</p>



<a name="276162659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162659">(Mar 22 2022 at 09:42)</a>:</h4>
<p>Yes, those look useful to me. Note that the second docstring should say <code>integers</code> instead of <code>natural numbers</code></p>



<a name="276162681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162681">(Mar 22 2022 at 09:43)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">induction_on_primes</span> <span class="o">{</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">(</span><span class="n">h₀</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="n">a</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
</code></pre></div>



<a name="276162714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162714">(Mar 22 2022 at 09:43)</a>:</h4>
<p>Ooh, does that already exist?</p>



<a name="276162844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162844">(Mar 22 2022 at 09:44)</a>:</h4>
<p>Yup: <a href="https://leanprover-community.github.io/mathlib_docs/find/induction_on_primes">docs#induction_on_primes</a> which is based on <a href="https://leanprover-community.github.io/mathlib_docs/find/unique_factorization_monoid.induction_on_prime">docs#unique_factorization_monoid.induction_on_prime</a></p>



<a name="276162870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276162870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276162870">(Mar 22 2022 at 09:45)</a>:</h4>
<p>Not sure why one is "prime" and the other "primes"</p>



<a name="276163109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276163109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276163109">(Mar 22 2022 at 09:47)</a>:</h4>
<p>But note that my main assumption is different (multiplicative closure instead of closure under multiplication by a prime).</p>



<a name="276163575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276163575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276163575">(Mar 22 2022 at 09:52)</a>:</h4>
<p>And I really needed the version for integers.</p>



<a name="276165382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276165382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276165382">(Mar 22 2022 at 10:08)</a>:</h4>
<p>The nat one is pretty similar:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">nat_multiplicative_induction</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmult</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">P</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">induction_on_primes</span> <span class="n">h0</span> <span class="n">h1</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="n">a</span> <span class="n">pp</span> <span class="n">ha</span><span class="o">,</span> <span class="n">hmult</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">hp</span> <span class="n">_</span> <span class="n">pp</span><span class="o">)</span> <span class="n">ha</span><span class="o">)</span> <span class="n">n</span>
</code></pre></div>



<a name="276165729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276165729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276165729">(Mar 22 2022 at 10:12)</a>:</h4>
<p>OK, that simplifies things a bit...</p>



<a name="276166354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166354">(Mar 22 2022 at 10:17)</a>:</h4>
<p>Michael, one thing that I have learned using mathlib, is that if I can prove a result in <code>n</code> lines, someone in this chat can prove it in 1.</p>



<a name="276166420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166420">(Mar 22 2022 at 10:18)</a>:</h4>
<p>... by induction <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="276166460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166460">(Mar 22 2022 at 10:18)</a>:</h4>
<p>The library already contains <em>a lot</em> of results and someone will certainly know the exact one that is closest to the one you want and will be able to tell you.</p>



<a name="276166696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166696">(Mar 22 2022 at 10:21)</a>:</h4>
<p>Yeah, but it would really help to have a way of finding these oneself <em>quickly</em>!</p>



<a name="276166749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166749">(Mar 22 2022 at 10:21)</a>:</h4>
<p>(deleted)</p>



<a name="276166750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166750">(Mar 22 2022 at 10:21)</a>:</h4>
<p>This is what this chat is for!</p>



<a name="276166762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166762">(Mar 22 2022 at 10:21)</a>:</h4>
<p>And the naming convention!</p>



<a name="276166767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166767">(Mar 22 2022 at 10:21)</a>:</h4>
<p>With time, you will be able to prove your results in <code>n/2</code> lines...</p>



<a name="276166869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166869">(Mar 22 2022 at 10:22)</a>:</h4>
<p>I find that what is holding me up the most is<br>
(1) getting Lean to prove the obvious<br>
(2) figuring out where to find what I need in mathlib</p>



<a name="276166911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276166911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276166911">(Mar 22 2022 at 10:23)</a>:</h4>
<p>Is there work under way addressing these issues?</p>



<a name="276167025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167025">(Mar 22 2022 at 10:24)</a>:</h4>
<p>Regarding (1), I would imagine some amount of (most likely AI-supported) heuristic proof search that goes more than one level deep.</p>



<a name="276167144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167144">(Mar 22 2022 at 10:25)</a>:</h4>
<p>When I was even more of a beginner than now, I found <code>tidy</code> very useful.</p>



<a name="276167167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167167">(Mar 22 2022 at 10:25)</a>:</h4>
<p>int is perhaps worth adding, though:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">int_multiplicative_induction</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hn1</span> <span class="o">:</span> <span class="n">P</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmult</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">P</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">hp'</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">prime</span> <span class="n">p</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">p</span> <span class="n">pp</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">P</span> <span class="n">p.nat_abs</span> <span class="o">:=</span> <span class="n">hp</span> <span class="n">_</span> <span class="o">(</span><span class="n">int.prime_iff_nat_abs_prime.mp</span> <span class="n">pp</span><span class="o">),</span>
    <span class="n">obtain</span> <span class="n">hp'</span><span class="bp">|</span><span class="n">hp'</span> <span class="o">:=</span> <span class="n">int.nat_abs_eq</span> <span class="n">p</span><span class="bp">;</span> <span class="n">rw</span> <span class="n">hp'</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">this</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span><span class="n">neg_one_mul</span><span class="o">,</span>
      <span class="n">apply</span> <span class="n">hmult</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hn1</span> <span class="n">this</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">exact</span> <span class="n">unique_factorization_monoid.induction_on_prime</span> <span class="n">n</span> <span class="n">h0</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="o">(</span><span class="n">int.is_unit_eq_one_or</span> <span class="n">hx</span><span class="o">)</span><span class="bp">.</span><span class="n">elim</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">h.symm</span> <span class="bp">▸</span> <span class="n">h1</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">h.symm</span> <span class="bp">▸</span> <span class="n">hn1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">p</span> <span class="n">haz</span> <span class="n">pp</span> <span class="n">hpa</span><span class="o">,</span> <span class="n">hmult</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">hp'</span> <span class="n">_</span> <span class="n">pp</span><span class="o">)</span> <span class="n">hpa</span><span class="o">),</span>
<span class="c">/-</span><span class="cm"> Or more painful:</span>
<span class="cm">  induction h : n.nat_abs using nat_multiplicative_induction with k ih generalizing n,</span>
<span class="cm">  { rwa int.eq_zero_of_nat_abs_eq_zero h, },</span>
<span class="cm">  { simp only [int.nat_abs_eq_iff, int.coe_nat_zero, int.coe_nat_succ, zero_add] at h,</span>
<span class="cm">    obtain rfl|rfl := h; assumption },</span>
<span class="cm">  { exact hp' n (int.prime_iff_nat_abs_prime.mpr (h.symm ▸ ih)), },</span>
<span class="cm">  { rw ←int.sign_mul_nat_abs n_1,</span>
<span class="cm">    apply hmult,</span>
<span class="cm">    { obtain hs|rfl|hs := lt_trichotomy 0 n_1,</span>
<span class="cm">      { rwa int.sign_eq_one_of_pos hs, },</span>
<span class="cm">      { rwa int.sign_zero },</span>
<span class="cm">      { rwa int.sign_eq_neg_one_of_neg hs } },</span>
<span class="cm">    { rw [h, int.coe_nat_mul],</span>
<span class="cm">      apply hmult,</span>
<span class="cm">      apply ᾰ,</span>
<span class="cm">      apply int.nat_abs_of_nat,</span>
<span class="cm">      apply ᾰ_1,</span>
<span class="cm">      apply int.nat_abs_of_nat } },</span>
<span class="cm">-/</span>
<span class="kd">end</span>
</code></pre></div>



<a name="276167239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167239">(Mar 22 2022 at 10:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/more.20inductions.20for.20int/near/276166869">said</a>:</p>
<blockquote>
<p>(2) figuring out where to find what I need in mathlib</p>
</blockquote>
<p>Maybe it's Stockholm system, but all of us, even the "experts", have got very used to this human-based library search.  It's so fast (and sociable) that it becomes less urgent to find automated alternatives.</p>



<a name="276167282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167282">(Mar 22 2022 at 10:26)</a>:</h4>
<p>I frequently try <code>suggest</code>, but I find it rarely to be helpful. Sometimes it comes up with <code>exact ...</code>and then I'm happy, but mostly I get a long list of useless stuff. E.g., when the goal is an equality, you get a list of results that can in principle prove an equality, but which are completely unrelated to the shape of the terms involved. (This could be related to the fact(?) that <code>suggest</code> sorts the results by length of lemma name, which tends to put unspecific ones first. Perhaps this could be changed so that the most specific ones appear on top?)</p>



<a name="276167406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167406">(Mar 22 2022 at 10:27)</a>:</h4>
<p>There is <code>suggest ... using ...</code> which filters out the results to the ones that use the hypotheses you give in the second <code>...</code></p>



<a name="276167415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167415">(Mar 22 2022 at 10:27)</a>:</h4>
<p>Often I find that using Zulip is faster than waiting for <code>library_search</code> on my machine</p>



<a name="276167422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167422">(Mar 22 2022 at 10:27)</a>:</h4>
<p><span class="user-mention" data-user-id="307953">@Ruben Van de Velde</span> My proof was not that much longer (minus the comment lines) <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="276167498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167498">(Mar 22 2022 at 10:28)</a>:</h4>
<p>Nobody can know the full library, but you sure can know your own little folder by heart.</p>



<a name="276167559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167559">(Mar 22 2022 at 10:29)</a>:</h4>
<p>I find myself not remembering the names of lemmas that I used yesterday. Maybe this is just old age approaching...</p>



<a name="276167561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167561">(Mar 22 2022 at 10:29)</a>:</h4>
<p>I can recite you everything that's under <code>order.</code>, <code>combinatorics.</code>, <code>analysis.convex.</code>. I have no idea what's under <code>measure_theory.</code> however.</p>



<a name="276167831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167831">(Mar 22 2022 at 10:31)</a>:</h4>
<p>The idea is that you can then know about any bit of the library by asking the right person.</p>



<a name="276167838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167838">(Mar 22 2022 at 10:31)</a>:</h4>
<p>There's <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.rec_on_prime_pow">docs#nat.rec_on_prime_pow</a> too, created as I was unaware (until today!) of the induction that Ruben mentioned</p>



<a name="276167976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167976">(Mar 22 2022 at 10:32)</a>:</h4>
<p>(there's some other spellings below that, too, which are helpful)</p>



<a name="276167978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276167978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276167978">(Mar 22 2022 at 10:33)</a>:</h4>
<p>I started a list of all <code>ℕ</code> recursors in the module docstring of <a href="https://tqft.net/mathlib/data/nat/basic">file#data/nat/basic</a> to avoid this precise situation. Please add yours!</p>



<a name="276168414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276168414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276168414">(Mar 22 2022 at 10:36)</a>:</h4>
<p>Surely we should only put the ones in that file there? I'm happy to plop them there regardless <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span>🏻‍♀️</p>



<a name="276168428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276168428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276168428">(Mar 22 2022 at 10:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/more.20inductions.20for.20int/near/276167422">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> My proof was not that much longer (minus the comment lines) <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
</blockquote>
<p>Yeah, it wasn't as easy to derive from the general result as I'd hoped; it didn't really like the <code>∀ (p : ℕ), nat.prime p → P ↑p</code> formulation. If that formulation is more useful for you, it's probably different enough to add to mathlib</p>



<a name="276168736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276168736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276168736">(Mar 22 2022 at 10:39)</a>:</h4>
<p>At the time I could only those in the file, but if there more just create a section gathering them all</p>



<a name="276169051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169051">(Mar 22 2022 at 10:42)</a>:</h4>
<p>Michael, in case it is helpful, I have used your proof of <code>nat_multiplicative_induction</code> and simply rewrote it in a more Lean-friendly way.  I always find looking at the diffs in these proofs useful.  Note, in particular, that I hold my breath and do not tell Lean on what to apply the lemmas, but wait for Lean to let me know what it wants.  All the <code>have</code> and <code>let</code> have disappeared (and of course their content reappears when Lean wants it).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">nat_multiplicative_induction</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">P</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">p.prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmult</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">P</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">P</span> <span class="o">(</span><span class="n">m</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- easy case `n = 0`</span>
    <span class="n">assumption</span> <span class="o">},</span>
  <span class="c1">-- now `n &gt; 0`; take its factors</span>
  <span class="n">convert</span> <span class="n">multiset.prod_induction</span> <span class="n">P</span> <span class="n">n.succ.factors</span> <span class="n">hmult</span> <span class="n">h1</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">multiset.coe_prod</span><span class="o">]</span> <span class="n">using</span> <span class="o">(</span><span class="n">nat.prod_factors</span> <span class="o">(</span><span class="n">n.succ_ne_zero</span><span class="o">))</span><span class="bp">.</span><span class="n">symm</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">hyp</span><span class="o">,</span> <span class="n">hp</span> <span class="n">p</span> <span class="o">(</span><span class="n">nat.prime_of_mem_factors</span> <span class="n">hyp</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="276169126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169126">(Mar 22 2022 at 10:42)</a>:</h4>
<p>BTW, I just found <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.rec_on_mul">docs#nat.rec_on_mul</a> .</p>



<a name="276169342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169342">(Mar 22 2022 at 10:44)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> I guess it's a question whether one should try to write in a "Lean-friendly" or a "human-friendly" way. While developing a proof, I guess the latter makes more sense. For the former, you need experience to know what Lean prefers. Is there any documentation on this?</p>



<a name="276169524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169524">(Mar 22 2022 at 10:46)</a>:</h4>
<p>My approach is that if the statement has a proof that is "obvious", then I go for the quickest available proof that I can find.  If the statement has some content, then I prefer a more discursive proof (better even if with comments, like you did).</p>



<a name="276169582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169582">(Mar 22 2022 at 10:46)</a>:</h4>
<p>I would categorize these induction statements as "obvious": once you know what to prove, you simply do it.</p>



<a name="276169606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276169606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276169606">(Mar 22 2022 at 10:47)</a>:</h4>
<p>A search for "int.rec_on" doesn't seem to produce anything, though.</p>



<a name="276235786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/more%20inductions%20for%20int/near/276235786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/more.20inductions.20for.20int.html#276235786">(Mar 22 2022 at 18:36)</a>:</h4>
<p>There's <code>int.induction_on</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>