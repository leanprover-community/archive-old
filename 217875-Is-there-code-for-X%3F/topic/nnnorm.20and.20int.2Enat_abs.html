---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html">nnnorm and int.nat_abs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272361708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272361708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272361708">(Feb 18 2022 at 05:21)</a>:</h4>
<p>Dear All,</p>
<p>is the lemma below already in mathlib?</p>
<p>Two challenges.</p>
<ul>
<li>Can you find a simpler proof?</li>
<li>Can you find a clunkier proof? <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span> </li>
</ul>
<p>Thanks!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.nnreal</span>
<span class="kn">import</span> <span class="n">analysis.normed_space.basic</span>

<span class="n">open_locale</span> <span class="n">nnreal</span> <span class="n">classical</span>

<span class="kd">lemma</span> <span class="n">int.nnnorm_eq_nat_abs</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">n</span><span class="bp">∥₊</span> <span class="bp">=</span> <span class="n">n.nat_abs</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">norm_to_nnreal</span><span class="o">],</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">real.coe_to_nnreal'</span><span class="o">,</span> <span class="n">max_eq_left</span><span class="o">,</span> <span class="n">norm_nonneg</span><span class="o">,</span> <span class="n">nnreal.coe_nat_cast</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">int.norm_eq_abs</span><span class="o">],</span>
  <span class="n">rw_mod_cast</span> <span class="bp">←</span> <span class="n">n.abs_eq_nat_abs</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272361885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272361885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272361885">(Feb 18 2022 at 05:25)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">int.nnnorm_eq_nat_abs</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">n</span><span class="bp">∥₊</span> <span class="bp">=</span> <span class="n">n.nat_abs</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">nnreal.coe_nat_abs</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
</code></pre></div>



<a name="272361970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272361970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272361970">(Feb 18 2022 at 05:27)</a>:</h4>
<p>Thank you very much!  I had not imagined that the lemma could go the opposite way!</p>



<a name="272362044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272362044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272362044">(Feb 18 2022 at 05:28)</a>:</h4>
<p>My high-tech method was that I grepped mathlib for <code>nat_abs</code> and then searched for <code>∥</code> in the output (in emacs, when you run a shell command the output goes into an editable and searchable buffer)</p>



<a name="272362073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272362073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272362073">(Feb 18 2022 at 05:29)</a>:</h4>
<p>Thank you also for teaching me another way to search the library!</p>



<a name="272362562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272362562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272362562">(Feb 18 2022 at 05:40)</a>:</h4>
<p>Working with this, I am always hoping for <code>(nnreal.coe_nat_abs n).symm</code> to be a <code>simp</code> lemma.  Am I wrong in thinking that this lemma should be stated in the opposite direction and be simp?</p>



<a name="272362732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272362732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272362732">(Feb 18 2022 at 05:44)</a>:</h4>
<p>Here's a simplified proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">int.nnnorm_eq_nat_abs</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∥</span><span class="n">n</span><span class="bp">∥₊</span> <span class="bp">=</span> <span class="n">n.nat_abs</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">nnreal.eq</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">coe_nnnorm</span><span class="o">,</span> <span class="n">int.norm_eq_abs</span><span class="o">,</span> <span class="bp">←</span><span class="n">int.cast_abs</span><span class="o">,</span> <span class="n">int.abs_eq_nat_abs</span><span class="o">,</span> <span class="n">int.cast_coe_nat</span><span class="o">,</span> <span class="n">nnreal.coe_nat_cast</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>
<p>I did this because the proof of <code>nnreal.coe_nat_abs</code> took advantage of some definitional equalities, and I wanted to be sure there actually were lemmas linking the two sides.</p>



<a name="272363076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272363076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272363076">(Feb 18 2022 at 05:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/nnnorm.20and.20int.2Enat_abs/near/272362562">said</a>:</p>
<blockquote>
<p>Working with this, I am always hoping for <code>(nnreal.coe_nat_abs n).symm</code> to be a <code>simp</code> lemma.  Am I wrong in thinking that this lemma should be stated in the opposite direction and be simp?</p>
</blockquote>
<p>I'm not sure... Maybe the idea is that when you have a real-valued expression, you'd rather put things into the <code>∥n∥₊</code> form since it's more likely that you have expressions involving nnnorm rather than nat_abs?</p>



<a name="272365426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272365426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272365426">(Feb 18 2022 at 06:38)</a>:</h4>
<p>Makes sense, thanks!  This is not the direction I'm going, but I can see that your point of view is more sensible in general!</p>



<a name="272374693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272374693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272374693">(Feb 18 2022 at 08:44)</a>:</h4>
<p>The fact that we have both norm_cast and push_cast indicates that mathematicians don't have any hard and fast rules about which way they want to argue. I've also seen examples where when you're making the API you want something to simp in one direction but then in an application you'd rather it went in the other direction</p>



<a name="272375080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/nnnorm%20and%20int.nat_abs/near/272375080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/nnnorm.20and.20int.2Enat_abs.html#272375080">(Feb 18 2022 at 08:48)</a>:</h4>
<p>I did not know that <code>push_cast</code> was a thing!  Whenever two expressions look the same, I will add <code>push_cast</code> to the loop of tactics to try to get lean to agree that they are really the same!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>