---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html">Taylor series</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="297635334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297635334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vincent Beffara <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297635334">(Sep 07 2022 at 17:22)</a>:</h4>
<p>Is there somewhere in mathlib the statement that an analytic function is locally the sum of its Taylor series?</p>



<a name="297658299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297658299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297658299">(Sep 07 2022 at 19:22)</a>:</h4>
<p>I don't think so. We have that an analytic function is the sum of some series, but no identification between the coefficients and the n-th derivative divided by <code>n!</code>. One reason for this is that it's not true in general (it's wrong in nonzero characteristic...), but having it over reals or complexes would definitely be desirable.</p>



<a name="297730681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297730681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vincent Beffara <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297730681">(Sep 08 2022 at 08:33)</a>:</h4>
<p>Now I can prove this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">formal_multilinear_series</span> <span class="n">â„‚</span> <span class="n">â„‚</span> <span class="n">â„‚</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">â„‚</span> <span class="bp">â†’</span> <span class="n">â„‚</span><span class="o">}</span> <span class="o">{</span><span class="n">w</span> <span class="o">:</span> <span class="n">â„‚</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">â„•</span><span class="o">}</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">has_fpower_series_at</span> <span class="n">f</span> <span class="n">p</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="n">deriv</span><span class="bp">^</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="n">f</span> <span class="n">w</span> <span class="bp">=</span> <span class="n">n.factorial</span> <span class="bp">*</span> <span class="n">p.coeff</span> <span class="n">n</span>
</code></pre></div>
<p>But the proof is ugly and slow and would benefit from some refactoring and generalization.</p>



<a name="297731021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297731021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vincent Beffara <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297731021">(Sep 08 2022 at 08:35)</a>:</h4>
<p>And btw, it was the las missing step in the proof of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">analytic_continuation</span> <span class="o">(</span><span class="n">hU1</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hU2</span> <span class="o">:</span> <span class="n">is_preconnected</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hw</span> <span class="o">:</span> <span class="n">w</span> <span class="bp">âˆˆ</span> <span class="n">U</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf1</span> <span class="o">:</span> <span class="n">analytic_on</span> <span class="n">â„‚</span> <span class="n">f</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hf2</span> <span class="o">:</span> <span class="bp">âˆƒá¶ </span> <span class="n">z</span> <span class="k">in</span> <span class="bp">ğ“</span><span class="o">[</span><span class="bp">â‰ </span><span class="o">]</span> <span class="n">w</span><span class="o">,</span> <span class="n">f</span> <span class="n">z</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">eq_on</span> <span class="n">f</span> <span class="mi">0</span> <span class="n">U</span>
</code></pre></div>



<a name="297731666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297731666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297731666">(Sep 08 2022 at 08:40)</a>:</h4>
<p>Yes, it's definitely not the right statement (but sill useful to have :-). The right statement works in any dimension, and shows very nicely where the factorial comes from. It reads as follows: if you have an analytic function <code>f</code> around <code>x</code>, with power series coefficients <code>p n</code> (so, <code>p n</code> is an <code>n</code> multilinear map, but not symmetric in general since this is not always possible in nonzero characteristic), then the <code>n</code>-th FrÃ©chet derivative of <code>f</code> is an <code>n</code>-multilinear function given by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>D</mi><mi>n</mi></msup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>Ïƒ</mi><mo>âˆˆ</mo><msub><mi>S</mi><mi>n</mi></msub></mrow></msub><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>Ïƒ</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>v</mi><mrow><mi>Ïƒ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D^n f (x; v_1, \dotsc, v_n) = \sum_{\sigma \in S_n} p_n (v_{\sigma(1)}, \dotsc, v_{\sigma(n)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1498em;vertical-align:-0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. </p>
<p>When you are in dimension <code>1</code>, you can identify multilinear maps with scalars, and the statement becomes <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><msup><mi>f</mi><mi>n</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>Ïƒ</mi><mo>âˆˆ</mo><msub><mi>S</mi><mi>n</mi></msub></mrow></msub><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mo stretchy="false">!</mo><mo>â‹…</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">Df^n(x) = \sum_{\sigma \in S_n} p_n = n! \cdot p_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1498em;vertical-align:-0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>



<a name="297731741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/297731741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#297731741">(Sep 08 2022 at 08:41)</a>:</h4>
<p>I am not saying that you shouldn't PR your version, by the way: the general case will probably be very ugly to prove, and it shouldn't hold you back!</p>



<a name="298384808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Taylor%20series/near/298384808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vincent Beffara <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Taylor.20series.html#298384808">(Sep 12 2022 at 13:49)</a>:</h4>
<p>Indeed the statement is the wrong one. But in the end I found a nicer proof that does not use the series expansion at all so I am in less of a hurry:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">is_open_set_of_eventually_nhds_within</span> <span class="o">[</span><span class="n">Î±</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Î±</span><span class="o">]</span> <span class="o">[</span><span class="n">t1_space</span> <span class="n">Î±</span><span class="o">]</span>
  <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">Î±</span> <span class="bp">â†’</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">:</span> <span class="n">is_open</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="bp">âˆ€á¶ </span> <span class="n">y</span> <span class="k">in</span> <span class="bp">ğ“</span><span class="o">[</span><span class="bp">â‰ </span><span class="o">]</span> <span class="n">x</span><span class="o">,</span> <span class="n">p</span> <span class="n">y</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">is_open_iff_mem_nhds</span><span class="o">,</span> <span class="n">eventually_nhds_within_iff</span><span class="o">,</span> <span class="n">_root_.eventually_nhds_iff</span><span class="o">],</span>
  <span class="n">rintro</span> <span class="n">z</span> <span class="o">âŸ¨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht1</span><span class="o">,</span> <span class="n">ht2</span><span class="o">,</span> <span class="n">ht3</span><span class="o">âŸ©,</span>
  <span class="n">refine</span> <span class="n">filter.mem_of_superset</span> <span class="o">(</span><span class="n">ht2</span> <span class="n">z</span> <span class="n">ht3</span><span class="o">)</span> <span class="o">(</span><span class="bp">Î»</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">by_cases</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">z</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">subst</span> <span class="n">h</span><span class="bp">;</span> <span class="n">exact</span> <span class="o">âŸ¨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht1</span><span class="o">,</span> <span class="n">ht2</span><span class="o">,</span> <span class="n">ht3</span><span class="o">âŸ©</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">âŸ¨</span><span class="n">t</span> <span class="bp">âˆ©</span> <span class="o">{</span><span class="n">z</span><span class="o">}</span><span class="bp">á¶œ</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">âŸ©,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="bp">Î»</span> <span class="n">x</span> <span class="o">âŸ¨</span><span class="n">hx1</span><span class="o">,</span> <span class="n">hx2</span><span class="o">âŸ©</span> <span class="n">hx3</span><span class="o">,</span> <span class="n">ht1</span> <span class="n">x</span> <span class="n">hx1</span> <span class="n">hx2</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="bp">Î»</span> <span class="n">x</span> <span class="o">âŸ¨</span><span class="n">hx1</span><span class="o">,</span> <span class="n">hx2</span><span class="o">âŸ©,</span> <span class="n">filter.inter_mem</span> <span class="o">(</span><span class="n">ht2</span> <span class="n">x</span> <span class="n">hx1</span><span class="o">)</span> <span class="o">(</span><span class="n">is_open_compl_singleton.mem_nhds</span> <span class="n">hx2</span><span class="o">)</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">âŸ¨</span><span class="n">ha</span><span class="o">,</span> <span class="n">h</span><span class="o">âŸ©</span> <span class="o">}</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">uniqueness'</span> <span class="o">(</span><span class="n">hU1</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hU2</span> <span class="o">:</span> <span class="n">is_preconnected</span> <span class="n">U</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf1</span> <span class="o">:</span> <span class="n">analytic_on</span> <span class="bp">ğ•œ</span> <span class="n">f</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hw</span> <span class="o">:</span> <span class="n">w</span> <span class="bp">âˆˆ</span> <span class="n">U</span><span class="o">)</span> <span class="o">(</span><span class="n">hf2</span> <span class="o">:</span> <span class="bp">âˆƒá¶ </span> <span class="n">z</span> <span class="k">in</span> <span class="bp">ğ“</span><span class="o">[</span><span class="bp">â‰ </span><span class="o">]</span> <span class="n">w</span><span class="o">,</span> <span class="n">f</span> <span class="n">z</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">eq_on</span> <span class="n">f</span> <span class="mi">0</span> <span class="n">U</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">replace</span> <span class="n">hf2</span> <span class="o">:=</span> <span class="o">(</span><span class="n">hf1</span> <span class="n">w</span> <span class="n">hw</span><span class="o">)</span><span class="bp">.</span><span class="n">frequently_zero_iff_eventually_zero.mp</span> <span class="n">hf2</span><span class="o">,</span>
  <span class="n">by_contra</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">eq_on</span><span class="o">,</span> <span class="n">not_forall</span><span class="o">,</span> <span class="n">exists_prop</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">âŸ¨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx1</span><span class="o">,</span> <span class="n">hx2</span><span class="o">âŸ©</span> <span class="o">:=</span> <span class="n">h</span><span class="o">,</span>

  <span class="k">let</span> <span class="n">u</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">z</span> <span class="bp">|</span> <span class="n">f</span> <span class="bp">=á¶ </span><span class="o">[</span><span class="bp">ğ“</span> <span class="n">z</span><span class="o">]</span> <span class="mi">0</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hu</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">u</span> <span class="o">:=</span> <span class="n">is_open_set_of_eventually_nhds</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hu'</span> <span class="o">:</span> <span class="o">(</span><span class="n">U</span> <span class="bp">âˆ©</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span> <span class="o">:=</span> <span class="o">âŸ¨</span><span class="n">w</span><span class="o">,</span> <span class="n">hw</span><span class="o">,</span> <span class="n">hf2</span><span class="o">âŸ©,</span>

  <span class="k">let</span> <span class="n">v</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">z</span> <span class="bp">|</span> <span class="bp">âˆ€á¶ </span> <span class="n">w</span> <span class="k">in</span> <span class="bp">ğ“</span><span class="o">[</span><span class="bp">â‰ </span><span class="o">]</span> <span class="n">z</span><span class="o">,</span> <span class="n">f</span> <span class="n">w</span> <span class="bp">â‰ </span> <span class="mi">0</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hv</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">v</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply</span> <span class="n">is_open_set_of_eventually_nhds_within</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hv'</span> <span class="o">:</span> <span class="o">(</span><span class="n">U</span> <span class="bp">âˆ©</span> <span class="n">v</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span><span class="o">,</span>
    <span class="k">from</span> <span class="o">âŸ¨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx1</span><span class="o">,</span> <span class="o">((</span><span class="n">hf1</span> <span class="n">x</span> <span class="n">hx1</span><span class="o">)</span><span class="bp">.</span><span class="n">continuous_at.eventually_ne</span> <span class="n">hx2</span><span class="o">)</span><span class="bp">.</span><span class="n">filter_mono</span> <span class="n">nhds_within_le_nhds</span><span class="o">âŸ©,</span>

  <span class="k">have</span> <span class="n">huv</span> <span class="o">:</span> <span class="n">U</span> <span class="bp">âŠ†</span> <span class="n">u</span> <span class="bp">âˆª</span> <span class="n">v</span> <span class="o">:=</span> <span class="bp">Î»</span> <span class="n">z</span> <span class="n">hz</span><span class="o">,</span> <span class="o">(</span><span class="n">hf1</span> <span class="n">z</span> <span class="n">hz</span><span class="o">)</span><span class="bp">.</span><span class="n">eventually_eq_zero_or_eventually_ne_zero</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">huv'</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">âˆ©</span> <span class="n">v</span> <span class="bp">=</span> <span class="bp">âˆ…</span><span class="o">,</span>
    <span class="kd">by</span> <span class="o">{</span> <span class="n">ext</span> <span class="n">z</span><span class="o">,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">mem_empty_eq</span><span class="o">,</span> <span class="n">iff_false</span><span class="o">,</span> <span class="n">not_and</span><span class="o">],</span>
      <span class="n">exact</span> <span class="bp">Î»</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">h.filter_mono</span> <span class="n">nhds_within_le_nhds</span><span class="o">)</span><span class="bp">.</span><span class="n">frequently</span> <span class="o">},</span>

  <span class="n">simpa</span> <span class="o">[</span><span class="n">huv'</span><span class="o">]</span> <span class="n">using</span> <span class="n">hU2</span> <span class="n">u</span> <span class="n">v</span> <span class="n">hu</span> <span class="n">hv</span> <span class="n">huv</span> <span class="n">hu'</span> <span class="n">hv'</span>
<span class="kd">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>