---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html">Is this a valid way of defining a typeclass?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="269318233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269318233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269318233">(Jan 25 2022 at 20:22)</a>:</h4>
<p>I want to define a parametrized typeclass. However, the axioms that define it rely on some variables that can only be defined dependent on the parameters. If I write this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variable</span> <span class="kd">parameter</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variable</span> <span class="n">another</span> <span class="o">:</span> <span class="o">(</span><span class="n">some_transformation</span> <span class="kd">parameter</span><span class="o">)</span>
<span class="kd">class</span> <span class="n">parametrized</span> <span class="kd">parameter</span> <span class="o">:=</span>
  <span class="o">(</span><span class="kd">axiom</span> <span class="o">:</span> <span class="n">some_predicate</span> <span class="n">another</span><span class="o">)</span>
</code></pre></div>
<p>would it be valid Lean code? If not, how do I render this concept?</p>



<a name="269318450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269318450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269318450">(Jan 25 2022 at 20:23)</a>:</h4>
<p>Yes it's definitely possible <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span>. However, you will have to make <code>another</code> visible from the outside of the class, as Lean can't guess it from <code>parameter</code> alone (however it can guess <code>parameter</code> from <code>another</code>).</p>



<a name="269318600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269318600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269318600">(Jan 25 2022 at 20:24)</a>:</h4>
<p>It would be easier to answer if you provide a complete minimal example</p>



<a name="269318730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269318730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269318730">(Jan 25 2022 at 20:25)</a>:</h4>
<p>Your lean code is incorrect and there is more than one way to interpret it</p>



<a name="269318972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269318972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269318972">(Jan 25 2022 at 20:27)</a>:</h4>
<p>One important detail is <code>parameter</code> is a reserved keyword, so that probably isn't the right "variable name". You can tell from the syntax highlighting here.</p>



<a name="269319307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269319307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269319307">(Jan 25 2022 at 20:29)</a>:</h4>
<p>Likewise <code>axiom</code></p>



<a name="269319608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269319608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269319608">(Jan 25 2022 at 20:31)</a>:</h4>
<p>Reid, you might like: <a href="#narrow/stream/144837-PR-reviews/topic/.235698.20strongly.20regular.20graphs/near/266519557">https://leanprover.zulipchat.com/#narrow/stream/144837-PR-reviews/topic/.235698.20strongly.20regular.20graphs/near/266519557</a></p>



<a name="269320232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320232">(Jan 25 2022 at 20:36)</a>:</h4>
<p>So in my case, assume an inductive type called <code>strict_product_type (E : Type u) (prod : E -&gt; E -&gt; E)</code> and a function called <code>down_convert</code> of type <code>strict_product_type E tprod -&gt; Type u</code> are defined earlier in the code. I want to write something like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variable</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variable</span> <span class="n">prod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variables</span> <span class="n">α</span><span class="o">,</span> <span class="n">β</span><span class="o">,</span> <span class="n">γ</span> <span class="o">:</span> <span class="n">strict_product_type</span> <span class="n">E</span> <span class="n">prod</span>
<span class="kd">def</span> <span class="n">α'</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">α</span>
<span class="kd">def</span> <span class="n">β'</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">β</span>
<span class="kd">def</span> <span class="n">γ'</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">γ</span>
<span class="kd">variable</span> <span class="n">prod_t</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">-&gt;</span> <span class="n">β'</span> <span class="bp">-&gt;</span> <span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span>
<span class="kd">class</span> <span class="n">tensor_product_family</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">prod_t</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">product_spaces_is_associative</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">prod</span> <span class="o">(</span><span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span><span class="o">)</span> <span class="n">γ'</span><span class="o">))</span> <span class="o">:</span> <span class="o">(</span><span class="n">prod</span> <span class="n">α'</span> <span class="o">(</span><span class="n">prod</span> <span class="n">β'</span> <span class="n">γ'</span><span class="o">)))</span>
  <span class="o">(</span><span class="n">product_elements_is_associative</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α'</span><span class="o">,</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β'</span><span class="o">,</span> <span class="n">g</span> <span class="o">:</span> <span class="n">γ'</span><span class="o">)</span> <span class="o">((</span><span class="n">prod_t</span> <span class="o">(</span><span class="n">prod_t</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">prod_t</span> <span class="n">a</span> <span class="o">(</span><span class="n">prod</span> <span class="n">b</span> <span class="n">g</span><span class="o">)))</span>
</code></pre></div>



<a name="269320624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320624">(Jan 25 2022 at 20:40)</a>:</h4>
<p>I think you probably just need to write </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">tensor_product_family</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">prod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">prod_t</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">-&gt;</span> <span class="n">β'</span> <span class="bp">-&gt;</span> <span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>



<a name="269320709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320709">(Jan 25 2022 at 20:41)</a>:</h4>
<p>Oh, nevermind, I see now that <code>prod_t</code> depends on <code>prod</code>.</p>



<a name="269320752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320752">(Jan 25 2022 at 20:41)</a>:</h4>
<p>Can you provide a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> that will work if we paste it in a lean file?</p>



<a name="269320888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320888">(Jan 25 2022 at 20:42)</a>:</h4>
<p>I wouldn't be asking here if I could, unfortunately</p>



<a name="269320908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320908">(Jan 25 2022 at 20:42)</a>:</h4>
<p>If I managed to disentangle the element product from the space product I don't see how I could get "the kronecker product over R^n" to be accepted as an instance for example</p>



<a name="269320973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269320973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269320973">(Jan 25 2022 at 20:43)</a>:</h4>
<p>I mean just something that includes <code>strict_product_type</code>and <code>down_convert</code> (or some approximation of those)</p>



<a name="269321025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321025">(Jan 25 2022 at 20:43)</a>:</h4>
<p>They are currently defined thus:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">universe</span> <span class="n">u</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>

<span class="kd">inductive</span> <span class="n">strict_product_type</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">tprod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">unit</span> <span class="o">:</span> <span class="n">strict_product_type</span>
<span class="bp">|</span> <span class="n">left_prod</span> <span class="o">:</span> <span class="n">strict_product_type</span> <span class="bp">-&gt;</span> <span class="n">strict_product_type</span>

<span class="kd">def</span> <span class="n">down_convert</span> <span class="o">{</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">tprod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="n">strict_product_type</span> <span class="n">E</span> <span class="n">tprod</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">unit</span> <span class="o">:=</span> <span class="n">E</span>
<span class="bp">|</span> <span class="n">left_prod</span> <span class="n">χ</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tprod</span> <span class="n">E</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">χ</span><span class="o">))</span>
</code></pre></div>



<a name="269321126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321126">(Jan 25 2022 at 20:44)</a>:</h4>
<p>and <code>left_prod</code>?</p>



<a name="269321334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321334">(Jan 25 2022 at 20:46)</a>:</h4>
<p>I'm just looking for code that works without the problematic class declaration.</p>



<a name="269321450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321450">(Jan 25 2022 at 20:47)</a>:</h4>
<p><code>left_prod</code> is a constructor of one argument, isn't it? (Basically <code>strict_product_type</code> is supposed to be a Peano naturals that I can unroll with <code>down_convert</code> to generate some type tensor'd with itself n times.) Did I define it incorrectly?</p>



<a name="269321513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321513">(Jan 25 2022 at 20:47)</a>:</h4>
<p>Something is off. The code you just gave does not work. Could you take a quick look at the link <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> ?</p>



<a name="269321616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321616">(Jan 25 2022 at 20:48)</a>:</h4>
<p>Oh right the imports</p>



<a name="269321620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321620">(Jan 25 2022 at 20:48)</a>:</h4>
<p>import algebra.module.basic<br>
import analysis.inner_product_space.basic<br>
import linear_algebra.bilinear_form<br>
import linear_algebra.tensor_product</p>



<a name="269321625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321625">(Jan 25 2022 at 20:48)</a>:</h4>
<p>Even if I add <code>open strict_product_type</code> it still doesn't work.</p>



<a name="269321719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321719">(Jan 25 2022 at 20:49)</a>:</h4>
<p>It's not just the imports, your definition of <code>down_convert</code> doesn't work for me.</p>



<a name="269321773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269321773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269321773">(Jan 25 2022 at 20:49)</a>:</h4>
<p>That's odd, can you paste the error you're receiving?</p>



<a name="269322040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269322040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269322040">(Jan 25 2022 at 20:51)</a>:</h4>
<p>I get a <code>ill-formed match/equation expression</code>.</p>



<a name="269322342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269322342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269322342">(Jan 25 2022 at 20:54)</a>:</h4>
<p>Maybe if we wrap the left_prod case with parentheses?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">|</span> <span class="o">(</span><span class="n">left_prod</span> <span class="n">χ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tprod</span> <span class="n">E</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">χ</span><span class="o">))</span>
</code></pre></div>



<a name="269322931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269322931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269322931">(Jan 25 2022 at 20:58)</a>:</h4>
<p>With the parens I still get an error, that the equation compiler fails because lean can't automatically prove the recursive function terminates. This would be a lot more efficient if you could give us some code that works, not including the <code>class</code> declaration that you want to ask about. If that's not the only issue, then we can start with the first problem first, but it's hard to diagnose anything if we don't have a place to start.</p>



<a name="269323286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269323286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269323286">(Jan 25 2022 at 21:00)</a>:</h4>
<p>Perhaps checking your lean version would help here</p>



<a name="269323470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269323470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269323470">(Jan 25 2022 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> <br>
leanprover-community/lean:3.38.0</p>



<a name="269323597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269323597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269323597">(Jan 25 2022 at 21:02)</a>:</h4>
<p>I'm also on <code>3.38.0</code> with the freshest of mathlibs.</p>



<a name="269323970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269323970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269323970">(Jan 25 2022 at 21:04)</a>:</h4>
<p>Am I right that <code>strict_product_type</code> does not actually depend on <code>E</code> and <code>tprod</code> and can be replaced by a natural number?</p>



<a name="269324209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324209">(Jan 25 2022 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269323970">said</a>:</p>
<blockquote>
<p>Am I right that <code>strict_product_type</code> does not actually depend on <code>E</code> and <code>tprod</code> and can be replaced by a natural number?</p>
</blockquote>
<p>Yeah, the work is done by the down_convert function. It's only an explicit Peano because it seemed less non-obvious-error-prone, with the plan being to replace it with the naturals from the standard library once I got it working</p>



<a name="269324268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324268">(Jan 25 2022 at 21:06)</a>:</h4>
<p>The strict_product_type type <em>does</em> contain E and tprod information, but that can indeed be packed into down_convert</p>



<a name="269324309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324309">(Jan 25 2022 at 21:06)</a>:</h4>
<p>Then</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">down_convert</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">tprod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">E</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tprod</span> <span class="n">E</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">n</span><span class="o">))</span>
</code></pre></div>



<a name="269324503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324503">(Jan 25 2022 at 21:08)</a>:</h4>
<p>which is equivalent (but not defeq because of they use recursion on different sides) to <code>down_convert E tprod n = (tprod E)^[n] E</code></p>



<a name="269324948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324948">(Jan 25 2022 at 21:11)</a>:</h4>
<p>Alright, looks like I found the root error that's causing all the rest</p>



<a name="269324957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269324957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269324957">(Jan 25 2022 at 21:11)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">quarrie</span><span class="bp">/</span><span class="n">Git</span><span class="bp">/</span><span class="n">mathlib_testing</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">tensor_product.lean</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">type</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">α'</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="bp">?</span> <span class="bp">→</span> <span class="o">(</span><span class="kt">Type</span> <span class="bp">?</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="bp">?</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">)</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="bp">?</span>
</code></pre></div>



<a name="269325105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325105">(Jan 25 2022 at 21:12)</a>:</h4>
<p>...how do I interpret this? that's a concerning amount of unknown universe.</p>



<a name="269325139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325139">(Jan 25 2022 at 21:13)</a>:</h4>
<p>I'm not sure why it depends on a natural number.</p>



<a name="269325153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325153">(Jan 25 2022 at 21:13)</a>:</h4>
<p>There's an <code>expected</code> line just below</p>



<a name="269325199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325199">(Jan 25 2022 at 21:13)</a>:</h4>
<p>What are the first 38 lines of the file?</p>



<a name="269325239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325239">(Jan 25 2022 at 21:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269325153">said</a>:</p>
<blockquote>
<p>There's an <code>expected</code> line just below</p>
</blockquote>
<p>No, oddly. Just below is an identical error regarding β'.</p>



<a name="269325269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325269">(Jan 25 2022 at 21:13)</a>:</h4>
<p>Can you just copy+paste them in <a href="https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks">#backticks</a>?</p>



<a name="269325436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325436">(Jan 25 2022 at 21:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269325199">said</a>:</p>
<blockquote>
<p>What are the first 38 lines of the file?</p>
</blockquote>
<p>With the comments removed for conciseness:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> This was lines 1-5 -/</span>

<span class="kn">import</span> <span class="n">algebra.module.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.bilinear_form</span>
<span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>

<span class="c">/-</span><span class="cm">! This was lines 12-22 -/</span>

<span class="kn">namespace</span> <span class="n">inner_product_space</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kd">def</span> <span class="n">down_convert</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">tprod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">E</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tprod</span> <span class="n">E</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">n</span><span class="o">))</span>

<span class="kd">variable</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variable</span> <span class="n">prod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">α'</span> <span class="o">:=</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span><span class="o">)</span> <span class="n">α</span>
<span class="kd">def</span> <span class="n">β'</span> <span class="o">:=</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span><span class="o">)</span> <span class="n">β</span>
<span class="kd">def</span> <span class="n">γ'</span> <span class="o">:=</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span><span class="o">)</span> <span class="n">γ</span>
<span class="kd">variable</span> <span class="n">prod_t</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">-&gt;</span> <span class="n">β'</span> <span class="bp">-&gt;</span> <span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span>
</code></pre></div>



<a name="269325536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325536">(Jan 25 2022 at 21:15)</a>:</h4>
<p><code>def α'</code> defines a type that depends on <code>E</code>, <code>prod</code>, and <code>α</code>.</p>



<a name="269325574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325574">(Jan 25 2022 at 21:16)</a>:</h4>
<p>Actually, <code>α'</code> is defeq to <code>β'</code></p>



<a name="269325669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325669">(Jan 25 2022 at 21:16)</a>:</h4>
<p>And both are defeq to <code>down_convert</code>.</p>



<a name="269325733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325733">(Jan 25 2022 at 21:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269325536">said</a>:</p>
<blockquote>
<p><code>def α'</code> defines a type that depends on <code>E</code>, <code>prod</code>, and <code>α</code>.</p>
</blockquote>
<p>That's the intended use, since α' is meant to be an arbitrary power of E so that I can reason about its tensor product.</p>



<a name="269325820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325820">(Jan 25 2022 at 21:17)</a>:</h4>
<p>So the problem is that Lean doesn't know what the argument to <code>α'</code> is</p>



<a name="269325822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325822">(Jan 25 2022 at 21:17)</a>:</h4>
<p><code>variables α</code> is just a way to say "if I use <code>α</code> in a definition/lemma and don't list it as an argument, then add it as an argument to the definition".</p>



<a name="269325980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269325980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269325980">(Jan 25 2022 at 21:18)</a>:</h4>
<p>Probably you want to use (untested)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">α'</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">α</span>
</code></pre></div>



<a name="269326249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326249">(Jan 25 2022 at 21:20)</a>:</h4>
<p>Good idea, let me see how that works</p>



<a name="269326315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326315">(Jan 25 2022 at 21:21)</a>:</h4>
<p>The problem with your <code>def</code> is that Lean immediately looses connection between the definition <code>α'</code> and the variable <code>α</code>.</p>



<a name="269326443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326443">(Jan 25 2022 at 21:21)</a>:</h4>
<p>That makes sense!</p>



<a name="269326556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326556">(Jan 25 2022 at 21:22)</a>:</h4>
<p>Alright, that's solved and now there's a new error</p>



<a name="269326564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326564">(Jan 25 2022 at 21:22)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">quarrie</span><span class="bp">/</span><span class="n">Git</span><span class="bp">/</span><span class="n">mathlib_testing</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">tensor_product.lean</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">infer</span> <span class="n">type</span> <span class="n">failed</span><span class="o">,</span> <span class="n">sort</span> <span class="n">expected</span>
  <span class="bp">?</span><span class="n">m_1</span><span class="o">[</span><span class="n">E</span><span class="o">]</span>
</code></pre></div>



<a name="269326572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326572">(Jan 25 2022 at 21:22)</a>:</h4>
<p>(line 39 is the typeclass declaration)</p>



<a name="269326613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326613">(Jan 25 2022 at 21:23)</a>:</h4>
<p>We need to see the source code, not just the error message.</p>



<a name="269326704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326704">(Jan 25 2022 at 21:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"> Former 1-5 -/</span>

<span class="kn">import</span> <span class="n">algebra.module.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.bilinear_form</span>
<span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>

<span class="c">/-</span><span class="cm">! Formerly 12-22 -/</span>

<span class="kn">namespace</span> <span class="n">inner_product_space</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kd">def</span> <span class="n">down_convert</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">tprod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">E</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tprod</span> <span class="n">E</span> <span class="o">(</span><span class="n">down_convert</span> <span class="n">n</span><span class="o">))</span>

<span class="kd">variable</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variable</span> <span class="n">prod</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">-&gt;</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span>
<span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">α'</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">α</span>
<span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">β'</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">β</span>
<span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">γ'</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">down_convert</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">γ</span>
<span class="kd">variable</span> <span class="n">prod_t</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">-&gt;</span> <span class="n">β'</span> <span class="bp">-&gt;</span> <span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span>
<span class="kd">class</span> <span class="n">tensor_product_family</span> <span class="n">E</span> <span class="n">prod</span> <span class="n">prod_t</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">product_spaces_is_associative</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">prod</span> <span class="o">(</span><span class="n">prod</span> <span class="n">α'</span> <span class="n">β'</span><span class="o">)</span> <span class="n">γ'</span><span class="o">))</span> <span class="o">:</span> <span class="o">(</span><span class="n">prod</span> <span class="n">α'</span> <span class="o">(</span><span class="n">prod</span> <span class="n">β'</span> <span class="n">γ'</span><span class="o">)))</span>
  <span class="o">(</span><span class="n">product_elements_is_associative</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α'</span><span class="o">,</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β'</span><span class="o">,</span> <span class="n">g</span> <span class="o">:</span> <span class="n">γ'</span><span class="o">)</span> <span class="o">((</span><span class="n">prod_t</span> <span class="o">(</span><span class="n">prod_t</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">prod_t</span> <span class="n">a</span> <span class="o">(</span><span class="n">prod</span> <span class="n">b</span> <span class="n">g</span><span class="o">)))</span>

<span class="kd">end</span> <span class="n">inner_product_space</span>
</code></pre></div>



<a name="269326880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269326880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269326880">(Jan 25 2022 at 21:24)</a>:</h4>
<p>You only need one of the notations if you make it <code>local notation α </code>'<code> := down_convert E prod α</code></p>



<a name="269327712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269327712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269327712">(Jan 25 2022 at 21:30)</a>:</h4>
<p>Let's not optimize before we catch the bug.</p>



<a name="269327761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269327761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269327761">(Jan 25 2022 at 21:30)</a>:</h4>
<p>Also, with your notation Lean will try to use <code>down_convert</code> for <code>a'</code>.</p>



<a name="269327842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269327842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269327842">(Jan 25 2022 at 21:31)</a>:</h4>
<p><code>product_spaces_is_associative</code> has no <code>∀</code>/<code>∃</code> on <code>x</code>.</p>



<a name="269328186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269328186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269328186">(Jan 25 2022 at 21:34)</a>:</h4>
<p>Can you post the mathematical definition you're trying to formalize (e.g., what are <code>prod</code>, <code>prod_t</code> in some important specific case)?</p>



<a name="269330389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269330389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269330389">(Jan 25 2022 at 21:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269328186">said</a>:</p>
<blockquote>
<p>Can you post the mathematical definition you're trying to formalize (e.g., what are <code>prod</code>, <code>prod_t</code> in some important specific case)?</p>
</blockquote>
<p>In one extremely important specific case, <code>prod</code> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">C</mi><mi>n</mi></msup><mo>→</mo><msup><mi mathvariant="double-struck">C</mi><mi>m</mi></msup><mo>→</mo><msup><mi mathvariant="double-struck">C</mi><mrow><mi>n</mi><mo>∗</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{C}^n \rightarrow \mathbb{C}^m \rightarrow \mathbb{C}^{n*m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span> and <code>prod_t</code> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>e</mi><mi>i</mi></msub><mo>→</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></msubsup><msub><mi>b</mi><mi>j</mi></msub><msub><mi>e</mi><mi>j</mi></msub><mo>→</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>j</mi></msub><msub><mi>e</mi><mrow><mi>i</mi><mi>m</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_{i = 0}^{n} a_ie_i \rightarrow \sum_{j = 0}^{m} b_je_j \rightarrow \sum_{i = 0}^{n} \sum_{j = 0}^{m} a_ib_je_{im+j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2401em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2401em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></p>



<a name="269330561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269330561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269330561">(Jan 25 2022 at 21:54)</a>:</h4>
<p>The axiom about type product associativity is then "it makes sense to talk about an n-qubit state" and the axiom about element product associativity is then "if a state is separable, what order you separate it in doesn't change the individual qubits"</p>



<a name="269330567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269330567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269330567">(Jan 25 2022 at 21:54)</a>:</h4>
<p>double $ :)</p>



<a name="269330621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269330621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269330621">(Jan 25 2022 at 21:54)</a>:</h4>
<p>thank you</p>



<a name="269331321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331321">(Jan 25 2022 at 22:01)</a>:</h4>
<p>What exactly should the first axiom say (in terms of <code>∀</code>, <code>∃</code> etc)?</p>



<a name="269331417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331417">(Jan 25 2022 at 22:01)</a>:</h4>
<p>(deleted)</p>



<a name="269331433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331433">(Jan 25 2022 at 22:01)</a>:</h4>
<p>Note that Lean doesn't understand that, e.g., <code>α × (β × γ)</code> and <code>(α × β) × γ</code> are "equal".</p>



<a name="269331496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331496">(Jan 25 2022 at 22:02)</a>:</h4>
<p>You need to insert an explicit isomorphism.</p>



<a name="269331606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331606">(Jan 25 2022 at 22:03)</a>:</h4>
<p>And probably you should use this isomorphism in the second axiom.</p>



<a name="269331651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331651">(Jan 25 2022 at 22:03)</a>:</h4>
<p>/me is away for 1-2 hrs</p>



<a name="269331668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331668">(Jan 25 2022 at 22:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269331321">said</a>:</p>
<blockquote>
<p>What exactly should the first axiom say (in terms of <code>∀</code>, <code>∃</code> etc)?</p>
</blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>g</mi><mo>∈</mo><mi mathvariant="double-struck">N</mi><mo separator="true">,</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>a</mi></mrow></msup><mo>⊗</mo><mo stretchy="false">(</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>b</mi></mrow></msup><mo>⊗</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>g</mi></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>a</mi></mrow></msup><mo>⊗</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>b</mi></mrow></msup><mo stretchy="false">)</mo><mo>⊗</mo><msup><mi>E</mi><mrow><mo>⊗</mo><mi>g</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\forall a, b, g \in \mathbb{N}, E^{\otimes a} \otimes (E^{\otimes b} \otimes E^{\otimes g}) = (E^{\otimes a} \otimes E^{\otimes b}) \otimes E^{\otimes g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">∀</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9658em;vertical-align:-0.1944em;"></span><span class="mord mathbb">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span></span></span></span></span></p>



<a name="269331729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331729">(Jan 25 2022 at 22:04)</a>:</h4>
<p>They should be the same type, so putting an isomorphism there would break it.</p>



<a name="269331797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331797">(Jan 25 2022 at 22:05)</a>:</h4>
<p>More clearly, the example I'm using is let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo><mi mathvariant="normal">≔</mi></mo><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup><mo separator="true">,</mo><mi>a</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>g</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">E \coloneqq \mathbb{C}^2, a = 1, b = 1, g = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>.</p>



<a name="269331863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331863">(Jan 25 2022 at 22:05)</a>:</h4>
<p>You shouldn't use equality of types in your axioms.</p>



<a name="269331864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331864">(Jan 25 2022 at 22:05)</a>:</h4>
<p>They won't ever be the same type. And even if they were, you shouldn't use this equality.</p>



<a name="269331879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331879">(Jan 25 2022 at 22:05)</a>:</h4>
<p>Equality of types is evil.</p>



<a name="269331950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331950">(Jan 25 2022 at 22:06)</a>:</h4>
<p>You should either make them defeq (probably, impossible), or introduce explicit isomorphisms.</p>



<a name="269331975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331975">(Jan 25 2022 at 22:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269331864">said</a>:</p>
<blockquote>
<p>They won't ever be the same type. And even if they were, you shouldn't use this equality.</p>
</blockquote>
<p>For clarity, this is not a cartesian product. This is a tensor product of which Kronecker is an example</p>



<a name="269331994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269331994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269331994">(Jan 25 2022 at 22:06)</a>:</h4>
<p>Maybe, one can say, you don't require the full power of "equality of types" as an axiom, even having a weaker "these types are explicitly isomorphic" will likely be powerful enough for what you want to use this structure for.</p>



<a name="269332069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332069">(Jan 25 2022 at 22:07)</a>:</h4>
<p>Then you'll need extra axioms about this family of isomorphisms.</p>



<a name="269332079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332079">(Jan 25 2022 at 22:07)</a>:</h4>
<p>I'm fairly sure <span class="user-mention" data-user-id="118107">@Amelia Livingston</span> ran into similar issues when working on the tensor algebra.</p>



<a name="269332121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332121">(Jan 25 2022 at 22:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269331879">said</a>:</p>
<blockquote>
<p>Equality of types is evil.</p>
</blockquote>
<p>How should I handle this, then?</p>



<a name="269332149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332149">(Jan 25 2022 at 22:07)</a>:</h4>
<p>I cannot use an isomorphism as that would destroy the power of the axiom.</p>



<a name="269332233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332233">(Jan 25 2022 at 22:08)</a>:</h4>
<p>What are you trying to do, mathematically?</p>



<a name="269332278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332278">(Jan 25 2022 at 22:08)</a>:</h4>
<p>The power of the axiom is that it is usually unprovable? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="269332382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332382">(Jan 25 2022 at 22:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269332233">said</a>:</p>
<blockquote>
<p>What are you trying to do, mathematically?</p>
</blockquote>
<p>Define a family of types endowed with a tensor product, so that I can reason about an n-qubit system.</p>



<a name="269332421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332421">(Jan 25 2022 at 22:09)</a>:</h4>
<p>Take a look at <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.monoidal_category">docs#category_theory.monoidal_category</a></p>



<a name="269332482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332482">(Jan 25 2022 at 22:10)</a>:</h4>
<p>404's out, which one?</p>



<a name="269332528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332528">(Jan 25 2022 at 22:10)</a>:</h4>
<p>Sorry, I fixed the link</p>



<a name="269332608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269332608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269332608">(Jan 25 2022 at 22:11)</a>:</h4>
<p>Note the associator axiom, for example</p>



<a name="269333001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269333001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269333001">(Jan 25 2022 at 22:14)</a>:</h4>
<p>I don't know how much category theory you want to use in your work, but using monoidal categories is one possible approach</p>



<a name="269333194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269333194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269333194">(Jan 25 2022 at 22:16)</a>:</h4>
<p>This does look useful, though I'll have to restrict the dependent product to an independent product and the associator to the identity.</p>



<a name="269333292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269333292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269333292">(Jan 25 2022 at 22:16)</a>:</h4>
<p>Thanks!</p>



<a name="269333728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269333728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269333728">(Jan 25 2022 at 22:18)</a>:</h4>
<p>But you can't restrict them to the identity!</p>



<a name="269333949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269333949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269333949">(Jan 25 2022 at 22:20)</a>:</h4>
<p>The tensor product <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊗</mo><mo stretchy="false">(</mo><mi>B</mi><mo>⊗</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\otimes(B\otimes C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span> is not equal to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>⊗</mo><mi>B</mi><mo stretchy="false">)</mo><mo>⊗</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">(A\otimes B)\otimes C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> (at least for vector spaces).</p>



<a name="269334955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269334955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269334955">(Jan 25 2022 at 22:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269333949">said</a>:</p>
<blockquote>
<p>The tensor product <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊗</mo><mo stretchy="false">(</mo><mi>B</mi><mo>⊗</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\otimes(B\otimes C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span> is not equal to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>⊗</mo><mi>B</mi><mo stretchy="false">)</mo><mo>⊗</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">(A\otimes B)\otimes C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> (at least for vector spaces).</p>
</blockquote>
<p>Is Kronecker product not an instance of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊗</mo></mrow><annotation encoding="application/x-tex">\otimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊗</span></span></span></span>?</p>



<a name="269335112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335112">(Jan 25 2022 at 22:31)</a>:</h4>
<p>I've been under the impression that it makes sense to write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup><mo>⊗</mo><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>⊗</mo><msup><mi mathvariant="double-struck">C</mi><mn>4</mn></msup><mo>=</mo><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup><mo>⊗</mo><mo stretchy="false">(</mo><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup><mo>⊗</mo><msup><mi mathvariant="double-struck">C</mi><mn>4</mn></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="double-struck">C</mi><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">(\mathbb{C}^2 \otimes \mathbb{C}^2) \otimes \mathbb{C}^4 = \mathbb{C}^2 \otimes (\mathbb{C}^2 \otimes \mathbb{C}^4) = \mathbb{C}^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span> for instance</p>



<a name="269335648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335648">(Jan 25 2022 at 22:35)</a>:</h4>
<p>The tensor product of two vector spaces is "defined" by a universal property, so it doesn't really even make sense to ask if two tensor products are equal.</p>



<a name="269335739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335739">(Jan 25 2022 at 22:36)</a>:</h4>
<p>(Of course, we agree these spaces are "canonically isomorphic".)</p>



<a name="269335746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335746">(Jan 25 2022 at 22:36)</a>:</h4>
<p>The equality symbol you're using there means "canonical isomorphism"</p>



<a name="269335760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335760">(Jan 25 2022 at 22:36)</a>:</h4>
<p>(snap!)</p>



<a name="269335770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335770">(Jan 25 2022 at 22:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269335648">said</a>:</p>
<blockquote>
<p>The tensor product of two vector spaces is "defined" by a universal property, so it doesn't really even make sense to ask if two tensor products are equal.</p>
</blockquote>
<p>Okay, so what's the word for the thing I want (an instance of a product that satisfies that property)?</p>



<a name="269335870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335870">(Jan 25 2022 at 22:37)</a>:</h4>
<p>And actually the right-hand equality (the one with C^16 on the right) should NOT be written as equality (in my opinion).</p>



<a name="269335882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269335882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269335882">(Jan 25 2022 at 22:37)</a>:</h4>
<p>What do you <em>mean</em> by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>⊗</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">V\otimes W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>? You can't mean "any vector space satisfying the universal property" because in formalised mathematics this cannot be used as a definition. So you have to choose some explicit model, perhaps some quotient of some huge group or whatever definition you want to use in your proof that tensor products exist. And the moment you make that choice none of the things you're claiming are equalities, are in fact equalities.</p>



<a name="269336012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336012">(Jan 25 2022 at 22:39)</a>:</h4>
<p>They're canonical isomorphisms, sure. But that's not what the <code>=</code> symbol means in lean.</p>



<a name="269336175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336175">(Jan 25 2022 at 22:40)</a>:</h4>
<p>In fact as Adam says that last iso to C^16 isn't even canonical. We all agree that <code>2*2*4=16</code> but when you categorify the equality changes to an isomorphism</p>



<a name="269336217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336217">(Jan 25 2022 at 22:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269335882">said</a>:</p>
<blockquote>
<p>What do you <em>mean</em> by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>⊗</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">V\otimes W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>? You can't mean "any vector space satisfying the universal property" because in formalised mathematics this cannot be used as a definition. So you have to choose some explicit model, perhaps some quotient of some huge group or whatever definition you want to use in your proof that tensor products exist. And the moment you make that choice none of the things you're claiming are equalities, are in fact equalities.</p>
</blockquote>
<p>My intention was that the meaning of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>⊗</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">V \otimes W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> was decided by the programmer at the moment that the programmer endowed the family of types containing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> with an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊗</mo></mrow><annotation encoding="application/x-tex">\otimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊗</span></span></span></span> operation. In my case, I want to use this for quantum program verification, so I'm working on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">C</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{C}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> and want to let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊗</mo></mrow><annotation encoding="application/x-tex">\otimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊗</span></span></span></span> be the Kronecker product and show that it satisfies <em>insert axioms here</em>.</p>



<a name="269336304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336304">(Jan 25 2022 at 22:42)</a>:</h4>
<p>The axioms you want are those of a monoidal category perhaps</p>



<a name="269336320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336320">(Jan 25 2022 at 22:42)</a>:</h4>
<p>Note <code>Module \C</code> is a category which should have a monoidal category instance :) <a href="https://leanprover-community.github.io/mathlib_docs/find/Module">docs#Module</a></p>



<a name="269336436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336436">(Jan 25 2022 at 22:43)</a>:</h4>
<p>When the programmer made the definition they did indeed make an explicit construction and that's exactly why we know that the tensor product can't be proved to be associative on the nose</p>



<a name="269336669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336669">(Jan 25 2022 at 22:45)</a>:</h4>
<p>And as for identifying it with C^16 you'll have to explicitly decide how to order your basis vectors of the tensor product -- the isomorphism here involves a genuine choice which you'll need to keep track of if you're doing mathematics rigourously</p>



<a name="269336761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336761">(Jan 25 2022 at 22:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269336436">said</a>:</p>
<blockquote>
<p>When the programmer made the definition they did indeed make an explicit construction and that's exactly why we know that the tensor product can't be proved to be associative on the nose</p>
</blockquote>
<p>Why wouldn't a user-supplied tensor product instance be provably associative? Would <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">C</mi><mi>n</mi></msup><mo>⊗</mo><msup><mi mathvariant="double-struck">C</mi><mi>m</mi></msup><mo><mi mathvariant="normal">≔</mi></mo><msup><mi mathvariant="double-struck">C</mi><mrow><mi>n</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{C}^n \otimes \mathbb{C}^m \coloneqq \mathbb{C}^{nm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7722em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mop" style="position:relative;top:-0.0347em;">:</span></span><span class="mrel"><span class="mspace" style="margin-right:-0.0667em;"></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nm</span></span></span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>:</mo><msup><mi mathvariant="double-struck">C</mi><mi>n</mi></msup><mo separator="true">,</mo><msub><mi>e</mi><mi>j</mi></msub><mo>:</mo><msup><mi mathvariant="double-struck">C</mi><mi>m</mi></msup><mo separator="true">,</mo><msub><mi>e</mi><mi>i</mi></msub><msub><mo>⊗</mo><mi>t</mi></msub><msub><mi>e</mi><mi>j</mi></msub><mo>=</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>m</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_i : \mathbb{C}^n, e_j : \mathbb{C}^m, e_i \otimes_t e_j = e_{im + j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mbin">⊗</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">im</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> not function as a tensor product?</p>



<a name="269336832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336832">(Jan 25 2022 at 22:47)</a>:</h4>
<p>It would function as a tensor product in that case but it's not the definition which was made in Lean</p>



<a name="269336919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336919">(Jan 25 2022 at 22:48)</a>:</h4>
<p>Your definition is isomorphic to Lean's, hence the isomorphism we're all going on about</p>



<a name="269336968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269336968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269336968">(Jan 25 2022 at 22:49)</a>:</h4>
<p>The typeclass I'm building forces the user to supply their own tensor product though, by providing it as an argument (e.g. one might say "<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">C</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{C}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathbb">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> forms a family of types endowed with the tensor product <code>kron</code>")</p>



<a name="269337095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269337095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269337095">(Jan 25 2022 at 22:50)</a>:</h4>
<p>Is this non-idiomatic for Lean code?</p>



<a name="269337558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269337558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269337558">(Jan 25 2022 at 22:54)</a>:</h4>
<p>Maybe the key words here are that <span class="user-mention" data-user-id="448090">@Quarrie</span> wants a strictification of the monoidal category of vector spaces with tensor products</p>



<a name="269337564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269337564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269337564">(Jan 25 2022 at 22:54)</a>:</h4>
<p>You can define a skeleton for the subcategory of <code>Module C</code> of f.d. spaces which has N as the type of objects. But again, associativity of multiplication of naturals is propositional equality, not definitional equality, so you will likely run into issues if you start using equality of objects in this skeletal category.</p>



<a name="269337738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269337738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269337738">(Jan 25 2022 at 22:55)</a>:</h4>
<p>(if you also want infinite dimensional vector spaces, you can work with cardinals)</p>



<a name="269337940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269337940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269337940">(Jan 25 2022 at 22:57)</a>:</h4>
<p>I'm not sure you can define a strictification like this with <code>prod</code> taking <code>Type</code>s.  This is what <code>down_convert</code> is presumably tying to solve?</p>
<p>Maybe another way is to have a function that takes <code>List Nat</code> and produces the corresponding vector space? Tensor product is then concatenation of lists, which is strictly associative. But then you still have these canonical isomorphisms for whether you concatenate then take the vector space or take the vector spaces and then tensor product.</p>



<a name="269338363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269338363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269338363">(Jan 25 2022 at 23:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269337940">said</a>:</p>
<blockquote>
<p>I'm not sure you can define a strictification like this with <code>prod</code> taking <code>Type</code>s.  This is what <code>down_convert</code> is presumably tying to solve?</p>
<p>Maybe another way is to have a function that takes <code>List Nat</code> and produces the corresponding vector space? Tensor product is then concatenation of lists, which is strictly associative. But then you still have these canonical isomorphisms for whether you concatenate then take the vector space or take the vector spaces and then tensor product.</p>
</blockquote>
<p><code>down_convert</code> is meant to define a single canonical order of association so that I can (a) check if associating in a different order produces the same result, and (b) have a convenient way to induct through the powers of <code>E</code>. Re: <code>Type u</code>, I ideally want <code>prod</code> to only have to accept powers of <code>E</code> (after all, doesn't really make sense to take the Kronecker product of objects that don't even have a scalar multiple operation, and I'd rather not deal with such when instantiating the Kronecker product as this typeclass) -- is this conveniently possible in Lean?</p>



<a name="269338634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269338634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269338634">(Jan 25 2022 at 23:03)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.kronecker">docs#matrix.kronecker</a></p>



<a name="269338713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269338713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269338713">(Jan 25 2022 at 23:03)</a>:</h4>
<p>I don't know how well this will work in practice, but what I was suggesting is trying to leave the tensor product in the <code>list nat</code> representation as long as possible, and then <code>prod</code> only takes powers of <code>E</code> since it's actually only taking these <code>list</code>s</p>



<a name="269338874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269338874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269338874">(Jan 25 2022 at 23:05)</a>:</h4>
<p>A problem with <code>Type</code> is that, unlike for terms of inductive types, you can't do any sort of <code>match</code> expression on types. So, a way around this is to manipulate algebraic expressions (here, lists of naturals) that then get turned into types.</p>



<a name="269339321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269339321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269339321">(Jan 25 2022 at 23:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F/near/269338713">said</a>:</p>
<blockquote>
<p>I don't know how well this will work in practice, but what I was suggesting is trying to leave the tensor product in the <code>list nat</code> representation as long as possible, and then <code>prod</code> only takes powers of <code>E</code> since it's actually only taking these <code>list</code>s</p>
</blockquote>
<p>An issue there would seem to be that this produces the product <em>spaces</em>, but does not offer a way to give the product <em>elements</em>.</p>



<a name="269339512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269339512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269339512">(Jan 25 2022 at 23:11)</a>:</h4>
<p>Right, that is an issue. A way around <em>that</em> is to have a wrapper around <code>list nat</code> so that it has a coercion to a Type, so you can pretend it's actually a vector space. I need to check how well this actually works in this case</p>



<a name="269340578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269340578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269340578">(Jan 25 2022 at 23:23)</a>:</h4>
<p>So basically, the user would supply:</p>
<ul>
<li>the base type</li>
<li>what's basically a Peano successor, but for tensor products</li>
<li>and the element tensor product<br>
Is this correct?</li>
</ul>



<a name="269340709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269340709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269340709">(Jan 25 2022 at 23:24)</a>:</h4>
<p>When you write a typeclass, it is useful to define at least one instance of that class.</p>



<a name="269340741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269340741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269340741">(Jan 25 2022 at 23:24)</a>:</h4>
<p>This way you'll see whether your axioms make sense in Lean.</p>



<a name="269340758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269340758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269340758">(Jan 25 2022 at 23:25)</a>:</h4>
<p>So, you can start with an instance.</p>



<a name="269340806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269340806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269340806">(Jan 25 2022 at 23:25)</a>:</h4>
<p>Define some <code>prod</code> etc (note that <code>prod</code> in the root namespace is taken), then prove some lemmas about your definitions, then define a typeclass that takes these lemmas as arguments.</p>



<a name="269341058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269341058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Quarrie <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269341058">(Jan 25 2022 at 23:28)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="269345662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269345662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269345662">(Jan 26 2022 at 00:17)</a>:</h4>
<p>Regarding a list of types, that design strategy is explored in <a href="https://leanprover-community.github.io/mathlib_docs/find/holor">docs#holor</a></p>



<a name="269346506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269346506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269346506">(Jan 26 2022 at 00:27)</a>:</h4>
<p>I haven't succeeded really with my proposal, other than defining a function that takes lists of natural numbers to specific tensor products of spaces.</p>
<p>Is there a better way to recursively take tensor products of spaces? It was awkward needing to recursively create the space and passing along the necessary typeclasses for each step.</p>
<div class="spoiler-block"><div class="spoiler-header">
<p>Code</p>
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.bilinear_form</span>
<span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>

<span class="kn">namespace</span> <span class="n">inner_product_space</span>

<span class="n">open_locale</span> <span class="n">tensor_product</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>

<span class="kd">@[reducible]</span>
<span class="kd">def</span> <span class="n">pow_space</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">M</span>

<span class="kn">section</span>
<span class="kn">include</span> <span class="n">R</span> <span class="n">M</span>
<span class="kd">class</span> <span class="n">space_for_list</span> <span class="o">(</span><span class="n">ns</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">space</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="kd">end</span>

<span class="kd">@[reducible]</span>
<span class="kd">def</span> <span class="n">tensor_space'</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="bp">Σ</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">α</span><span class="o">],</span> <span class="kd">by</span> <span class="n">exactI</span> <span class="n">module</span> <span class="n">R</span> <span class="n">α</span>
<span class="bp">|</span> <span class="o">[]</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">R</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">⟩</span>
<span class="bp">|</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">pow_space</span> <span class="n">M</span> <span class="n">n</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">⟩</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="o">::</span><span class="n">ns</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">casesI</span> <span class="n">tensor_space'</span> <span class="n">ns</span> <span class="k">with</span> <span class="n">α'</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">casesI</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">pow_space</span> <span class="n">M</span> <span class="n">n</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">α'</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">⟩,</span>
<span class="kd">end</span>

<span class="kd">def</span> <span class="n">tensor_space</span> <span class="o">(</span><span class="n">ns</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tensor_space'</span> <span class="n">R</span> <span class="n">M</span> <span class="n">ns</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">ns</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="o">(</span><span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="n">ns</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tensor_space'</span> <span class="n">R</span> <span class="n">M</span> <span class="n">ns</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">1</span>
<span class="kd">instance</span> <span class="o">(</span><span class="n">ns</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="n">ns</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tensor_space'</span> <span class="n">R</span> <span class="n">M</span> <span class="n">ns</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">2</span>

<span class="c1">-- examples that defeq works</span>
<span class="kd">lemma</span> <span class="n">tensor_space₁</span> <span class="o">{</span><span class="n">n1</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="o">[</span><span class="n">n1</span><span class="o">]</span> <span class="bp">=</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n1</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">lemma</span> <span class="n">tensor_space₂</span> <span class="o">{</span><span class="n">n1</span> <span class="n">n2</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="o">[</span><span class="n">n1</span><span class="o">,</span> <span class="n">n2</span><span class="o">]</span> <span class="bp">=</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n1</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n2</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">lemma</span> <span class="n">tensor_space₃</span> <span class="o">{</span><span class="n">n1</span> <span class="n">n2</span> <span class="n">n3</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="o">[</span><span class="n">n1</span><span class="o">,</span> <span class="n">n2</span><span class="o">,</span> <span class="n">n3</span><span class="o">]</span> <span class="bp">=</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n1</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">((</span><span class="n">fin</span> <span class="n">n2</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n3</span> <span class="bp">→</span> <span class="n">M</span><span class="o">))</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">lemma</span> <span class="n">tensor_space₄</span> <span class="o">{</span><span class="n">n1</span> <span class="n">n2</span> <span class="n">n3</span> <span class="n">n4</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">tensor_space</span> <span class="n">R</span> <span class="n">M</span> <span class="o">[</span><span class="n">n1</span><span class="o">,</span> <span class="n">n2</span><span class="o">,</span> <span class="n">n3</span><span class="o">,</span> <span class="n">n4</span><span class="o">]</span> <span class="bp">=</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n1</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">((</span><span class="n">fin</span> <span class="n">n2</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">((</span><span class="n">fin</span> <span class="n">n3</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n4</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)))</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">end</span> <span class="n">inner_product_space</span>
</code></pre></div>
</div></div>



<a name="269348267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348267">(Jan 26 2022 at 00:49)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> you could use <a href="https://leanprover-community.github.io/mathlib_docs/find/Module">docs#Module</a> with the monoidal tensor product. The correct instances will be part of the structure.</p>



<a name="269348740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348740">(Jan 26 2022 at 00:55)</a>:</h4>
<p>(deleted)</p>



<a name="269348756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348756">(Jan 26 2022 at 00:55)</a>:</h4>
<p>Thats wrong. one sec</p>



<a name="269348779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348779">(Jan 26 2022 at 00:55)</a>:</h4>
<p>This is better:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.category.Module.monoidal</span>

<span class="kd">universes</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">Module.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">A</span>
<span class="bp">|</span> <span class="o">[]</span> <span class="o">:=</span> <span class="mi">𝟙</span><span class="n">_</span> <span class="o">(</span><span class="n">Module.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Module.of</span> <span class="n">A</span> <span class="o">(</span><span class="n">fin</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="bp">⊗</span> <span class="n">foo</span> <span class="n">xs</span>
</code></pre></div>



<a name="269348872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348872">(Jan 26 2022 at 00:56)</a>:</h4>
<p>Of course you could replace <code>A</code> with any <code>A</code>-module <code>M</code>, as needed.</p>



<a name="269348979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269348979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269348979">(Jan 26 2022 at 00:58)</a>:</h4>
<p>Note that this is indeed defeq;</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">M</span> <span class="n">N</span> <span class="o">:</span> <span class="n">Module.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">tensor_product</span> <span class="n">A</span> <span class="n">M</span> <span class="n">N</span> <span class="bp">=</span> <span class="o">(</span><span class="n">M</span> <span class="bp">⊗</span> <span class="n">N</span> <span class="o">:</span> <span class="n">Module.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="269349049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269349049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269349049">(Jan 26 2022 at 00:59)</a>:</h4>
<p>but there is a clash of notations, since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊗</mo></mrow><annotation encoding="application/x-tex">\otimes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊗</span></span></span></span> is used both for the unbundled tensor product (under the <code>tensor_product</code> locale), and for the monoidal one.</p>



<a name="269353921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Is%20this%20a%20valid%20way%20of%20defining%20a%20typeclass%3F/near/269353921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Is.20this.20a.20valid.20way.20of.20defining.20a.20typeclass.3F.html#269353921">(Jan 26 2022 at 02:09)</a>:</h4>
<p>Of course, we could also use <code>list.foldr</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.category.Module.monoidal</span>

<span class="kd">universes</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">Module.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">A</span> <span class="o">:=</span>
<span class="n">list.foldr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">M</span><span class="o">,</span> <span class="n">Module.of</span> <span class="n">A</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="bp">⊗</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="mi">𝟙</span><span class="n">_</span> <span class="n">_</span><span class="o">)</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>