---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html">Halves of a sorted list are related</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="225050492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225050492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225050492">(Feb 03 2021 at 17:32)</a>:</h4>
<p>Does this exist?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
  <span class="o">[</span><span class="n">decidable_rel</span> <span class="n">r</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_trans</span> <span class="n">α</span> <span class="n">r</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_antisymm</span> <span class="n">α</span> <span class="n">r</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_total</span> <span class="n">α</span> <span class="n">r</span><span class="o">]</span>
  <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ls</span> <span class="o">:</span> <span class="n">list.sorted</span> <span class="n">r</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">∈</span> <span class="n">list.drop</span> <span class="n">k</span> <span class="n">l</span><span class="o">),</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="225053581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225053581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225053581">(Feb 03 2021 at 17:54)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/list.nth_le_of_sorted_of_le">docs#list.nth_le_of_sorted_of_le</a> is close</p>



<a name="225054571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225054571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225054571">(Feb 03 2021 at 18:00)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/6027">#6027</a></p>



<a name="225056528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225056528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225056528">(Feb 03 2021 at 18:12)</a>:</h4>
<p>Two related lemmas that also seem missing:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="gr">sorry</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">list.exists_le_i_of_mem_drop</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.drop</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="gr">sorry</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="225057011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057011">(Feb 03 2021 at 18:16)</a>:</h4>
<p>Maybe <code>mem_take_iff</code> and <code>mem_drop_iff</code> as well (or instead)?</p>



<a name="225057528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057528">(Feb 03 2021 at 18:19)</a>:</h4>
<p>To avoid the sorry in the statement, use <code>x \in l.nth i</code></p>



<a name="225057657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057657">(Feb 03 2021 at 18:20)</a>:</h4>
<p>Is there a lemma to convert from <code>x ∈ l.nth i</code> to the <code>nth_le</code> version?</p>



<a name="225057661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057661">(Feb 03 2021 at 18:20)</a>:</h4>
<p>and I think that the better way to expose this is <code>i &lt; k -&gt; (l.take k).nth i = l.nth i</code></p>



<a name="225057665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057665">(Feb 03 2021 at 18:20)</a>:</h4>
<p>yes</p>



<a name="225057819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057819">(Feb 03 2021 at 18:21)</a>:</h4>
<p>The statement I have above is the one I actually need if I want to reuse <br>
<a href="https://leanprover-community.github.io/mathlib_docs/find/list.nth_le_of_sorted_of_le">docs#list.nth_le_of_sorted_of_le</a> in <a href="https://github.com/leanprover-community/mathlib/issues/6027">#6027</a> instead of working from scratch</p>



<a name="225057936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057936">(Feb 03 2021 at 18:22)</a>:</h4>
<p>It's not hard to go back and forth from nth to nth_le</p>



<a name="225057999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225057999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225057999">(Feb 03 2021 at 18:22)</a>:</h4>
<p>it might be worth making an <code>nth</code> version of that lemma though</p>



<a name="225058078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058078">(Feb 03 2021 at 18:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">mem_take_iff</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">list.index_of</span> <span class="n">x</span> <span class="n">l</span> <span class="bp">≤</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
</code></pre></div>



<a name="225058144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058144">(Feb 03 2021 at 18:23)</a>:</h4>
<p>that's a bit different, that's about searching in a list</p>



<a name="225058171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058171">(Feb 03 2021 at 18:23)</a>:</h4>
<p>I think some combination of <code>nth_le_of_mem</code> with <code>nth_le_take'</code> gives things close to <code>mem_take_iff</code> as well</p>



<a name="225058281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058281">(Feb 03 2021 at 18:24)</a>:</h4>
<p>Here's the proof I came up with using <code>nth_le</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="n">h₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="n">generalizing</span> <span class="n">k</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hx</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">k</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hx</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">list.take</span><span class="o">,</span> <span class="n">list.mem_cons_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">(</span><span class="n">rfl</span> <span class="bp">|</span> <span class="n">hx</span><span class="o">)</span> <span class="o">:=</span> <span class="n">hx</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">k.zero_lt_succ</span><span class="o">,</span> <span class="n">l_tl.length.zero_lt_succ</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">l_ih</span> <span class="n">_</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">i.succ</span><span class="o">,</span> <span class="n">nat.succ_lt_succ</span> <span class="n">h</span><span class="o">,</span> <span class="n">nat.succ_lt_succ</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="225058291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058291">(Feb 03 2021 at 18:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Halves.20of.20a.20sorted.20list.20are.20related/near/225058144">said</a>:</p>
<blockquote>
<p>that's a bit different, that's about searching in a list</p>
</blockquote>
<p>I realise that, but we also have lemmas to convert between searching and nth, so it's an alternate approach to the original question</p>



<a name="225058302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058302">(Feb 03 2021 at 18:24)</a>:</h4>
<p>plus that version needs decidable eq</p>



<a name="225058723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225058723" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225058723">(Feb 03 2021 at 18:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Halves.20of.20a.20sorted.20list.20are.20related/near/225058281">said</a>:</p>
<blockquote>
<p>Here's the proof I came up with using <code>nth_le</code>:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="n">h₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="n">generalizing</span> <span class="n">k</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hx</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">k</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">hx</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">list.take</span><span class="o">,</span> <span class="n">list.mem_cons_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">(</span><span class="n">rfl</span> <span class="bp">|</span> <span class="n">hx</span><span class="o">)</span> <span class="o">:=</span> <span class="n">hx</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">k.zero_lt_succ</span><span class="o">,</span> <span class="n">l_tl.length.zero_lt_succ</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">l_ih</span> <span class="n">_</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">i.succ</span><span class="o">,</span> <span class="n">nat.succ_lt_succ</span> <span class="n">h</span><span class="o">,</span> <span class="n">nat.succ_lt_succ</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="n">h₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">nth_le_of_mem</span> <span class="n">hx</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">lt_min_iff</span><span class="o">,</span> <span class="n">length_take</span><span class="o">]</span> <span class="n">at</span> <span class="n">hm</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm.1</span><span class="o">,</span> <span class="n">hm.2</span><span class="o">,</span> <span class="n">nth_le_take'</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>
<p>an alternate, shorter proof</p>



<a name="225059201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225059201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225059201">(Feb 03 2021 at 18:30)</a>:</h4>
<p>What does the proof for the <code>l.nth</code> version look like?</p>



<a name="225059633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225059633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225059633">(Feb 03 2021 at 18:32)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take'</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">),</span> <span class="bp">↑</span><span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth</span> <span class="n">i</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">nth_le_of_mem</span> <span class="n">hx</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">lt_min_iff</span><span class="o">,</span> <span class="n">length_take</span><span class="o">]</span> <span class="n">at</span> <span class="n">hm</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm.1</span><span class="o">,</span> <span class="n">hm.2</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">rw</span> <span class="n">nth_le_take'</span><span class="o">,</span>
  <span class="n">apply</span> <span class="o">(</span><span class="n">nth_le_nth</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>this is what I get</p>



<a name="225059651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225059651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225059651">(Feb 03 2021 at 18:33)</a>:</h4>
<p>maybe there's a nicer way?</p>



<a name="225059737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225059737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225059737">(Feb 03 2021 at 18:33)</a>:</h4>
<p>Which of <code>↑x = l.nth i</code>, <code>some x = l.nth i</code> and <code>x ∈ l.nth i</code> is simp-normal?</p>



<a name="225060121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225060121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225060121">(Feb 03 2021 at 18:36)</a>:</h4>
<p>For me the last one isn't, and the other two don't simplify?</p>



<a name="225060632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225060632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225060632">(Feb 03 2021 at 18:39)</a>:</h4>
<p>I'll PR your first proof I think Bhavik</p>



<a name="225060634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225060634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225060634">(Feb 03 2021 at 18:39)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_drop</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.drop</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="n">h₂</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">nth_le_of_mem</span> <span class="n">hx</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">length_drop</span><span class="o">]</span> <span class="n">at</span> <span class="n">hm</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">k</span><span class="bp">+</span><span class="n">m</span><span class="o">,</span> <span class="n">nat.le_add_right</span> <span class="n">k</span> <span class="n">m</span><span class="o">,</span> <span class="n">nat.add_lt_of_lt_sub_left</span> <span class="n">hm</span><span class="o">,</span> <span class="n">nth_le_drop'</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>
<p>for the other one</p>



<a name="225060803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225060803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225060803">(Feb 03 2021 at 18:40)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.list.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">lemma</span> <span class="n">list.nth_lt_length</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l.nth</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">l.length</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">list.nth_eq_some.1</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span>

<span class="kd">lemma</span> <span class="n">list.mem_take_nth</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">k</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">nth</span> <span class="n">i</span> <span class="bp">↔</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l.nth</span> <span class="n">i</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span> <span class="o">:=</span> <span class="o">(</span><span class="n">list.nth_lt_length</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">trans_le</span> <span class="o">(</span><span class="n">list.length_take_le</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">this</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="o">[</span><span class="bp">←</span> <span class="n">list.nth_take</span> <span class="n">this</span><span class="o">]⟩</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">h</span><span class="o">,</span> <span class="n">h'</span><span class="o">⟩,</span> <span class="n">rwa</span> <span class="o">[</span><span class="n">list.nth_take</span> <span class="n">h</span><span class="o">]</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">list.mem_take_iff_nth</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l.nth</span> <span class="n">i</span> <span class="o">:=</span>
<span class="n">list.mem_iff_nth.trans</span> <span class="o">(</span><span class="n">exists_congr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">list.mem_take_nth</span><span class="o">))</span>

<span class="kd">lemma</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">)</span> <span class="n">h'</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">l.nth_le</span> <span class="n">i</span> <span class="n">h'</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">list.mem_take_iff_nth.1</span> <span class="n">hx</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩,</span>
  <span class="n">rcases</span> <span class="n">list.nth_eq_some.1</span> <span class="n">h</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">h₁</span><span class="o">,</span> <span class="n">h₂</span><span class="o">⟩,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">h₁</span><span class="o">,</span> <span class="n">h₂.symm</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="225060994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225060994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225060994">(Feb 03 2021 at 18:41)</a>:</h4>
<p>I feel like <code>k</code> should be implicit in <code>exists_i_lt_of_mem_take</code> as well</p>



<a name="225061034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061034">(Feb 03 2021 at 18:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, at this point could you PR it?</p>



<a name="225061133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061133">(Feb 03 2021 at 18:42)</a>:</h4>
<p>I don't think that one should be PR'd actually, it's just there to show how the other lemmas come together</p>



<a name="225061229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061229">(Feb 03 2021 at 18:43)</a>:</h4>
<p>the proof is kind of uninteresting, it's just unpacking the other existentials and putting them back together. That can be done in a user proof</p>



<a name="225061234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061234">(Feb 03 2021 at 18:43)</a>:</h4>
<p>My original plan was to PR <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span>'s two lemmas as <code>nth_le_of_mem_drop</code> and <code>nth_le_of_mem_take</code></p>



<a name="225061289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061289">(Feb 03 2021 at 18:43)</a>:</h4>
<p>To complement the existing <code>nth_le_of_mem</code></p>



<a name="225061412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061412">(Feb 03 2021 at 18:44)</a>:</h4>
<p>The simp normal form is <code>o = some a</code>, although I prefer <code>a \in o</code></p>



<a name="225061475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061475">(Feb 03 2021 at 18:44)</a>:</h4>
<p>If you don't think those lemmas should be PR'd, are you saying your auxiliary ones should?</p>



<a name="225061529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061529">(Feb 03 2021 at 18:45)</a>:</h4>
<p>yes, I think <code>mem_take_nth</code> is a nice lemma</p>



<a name="225061607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061607">(Feb 03 2021 at 18:45)</a>:</h4>
<p>the one for drop is a bit more complicated</p>



<a name="225061646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061646">(Feb 03 2021 at 18:45)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ls</span> <span class="o">:</span> <span class="n">list.sorted</span> <span class="n">r</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">∈</span> <span class="n">list.drop</span> <span class="n">k</span> <span class="n">l</span><span class="o">),</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">list.exists_i_lt_of_mem_take</span> <span class="n">hx</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hm₁</span><span class="o">,</span> <span class="n">hm₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">rcases</span> <span class="n">list.exists_i_lt_of_mem_drop</span> <span class="n">hy</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hn₁</span><span class="o">,</span> <span class="n">hn₂</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">exact</span> <span class="n">pairwise_iff_nth_le.mp</span> <span class="n">ls</span> <span class="n">m</span> <span class="n">n</span> <span class="n">hn₂</span> <span class="o">(</span><span class="n">lt_of_lt_of_le</span> <span class="n">hm₁</span> <span class="n">hn₁</span><span class="o">),</span>
<span class="kd">end</span>
</code></pre></div>
<p>we don't need the transitivity assumption in your original lemma</p>



<a name="225061774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061774">(Feb 03 2021 at 18:46)</a>:</h4>
<p><code>list.nth_lt_length</code> seems like a confusing name given it looks like it contains <code>nth_lt</code>, perhaps <code>list.lt_length_of_mem_nth</code>?</p>



<a name="225061834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061834">(Feb 03 2021 at 18:46)</a>:</h4>
<p>Actually I would argue that <code>nth_le</code> is the one with the bad name</p>



<a name="225061874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061874">(Feb 03 2021 at 18:47)</a>:</h4>
<p>it doesn't even have an <code>le</code> in it</p>



<a name="225061895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225061895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225061895">(Feb 03 2021 at 18:47)</a>:</h4>
<p>@Bhavik, I copy-pasted those from the definition for <code>sorted</code> I thought, but I guess I screwed up</p>



<a name="225062020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062020">(Feb 03 2021 at 18:47)</a>:</h4>
<p>having a definition be named the same as two other definitions separated by <code>_</code> leads to a whole lot of name clashes</p>



<a name="225062061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062061">(Feb 03 2021 at 18:48)</a>:</h4>
<p>same thing with <code>list.filter_map</code></p>



<a name="225062137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062137">(Feb 03 2021 at 18:48)</a>:</h4>
<p>Are you advocating a rename <code>nth_le</code> to <code>nth_lt</code> or even <code>nth_of_lt</code>?</p>



<a name="225062208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062208">(Feb 03 2021 at 18:49)</a>:</h4>
<p>no, something in one word like <code>pnth</code> or something</p>



<a name="225062243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062243">(Feb 03 2021 at 18:49)</a>:</h4>
<p>or <code>nth'</code></p>



<a name="225062407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225062407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225062407">(Feb 03 2021 at 18:50)</a>:</h4>
<p><code>nth_of_lt</code> would be much worse, because then you will be super confused reading things like <code>nth_of_lt_eq_self_of_lt</code></p>



<a name="225064855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225064855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225064855">(Feb 03 2021 at 19:06)</a>:</h4>
<p>What's wrong with this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_le_of_sorted_of_lt</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">l.sorted</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">}</span> <span class="o">{</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">l.length</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">r</span> <span class="o">(</span><span class="n">l.nth_le</span> <span class="n">a</span> <span class="n">ha</span><span class="o">)</span> <span class="o">(</span><span class="n">l.nth_le</span> <span class="n">b</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">list.pairwise_iff_nth_le.1</span> <span class="n">h</span> <span class="n">a</span> <span class="n">b</span> <span class="n">hb</span> <span class="n">hab</span>

<span class="kd">lemma</span> <span class="n">sorted.rel_of_mem_take_of_mem_drop</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">list.sorted</span> <span class="n">r</span> <span class="n">l</span><span class="o">)</span>
  <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">list.take</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">hy</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">list.drop</span> <span class="n">k</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">iy</span><span class="o">,</span> <span class="n">hiy</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">nth_le_of_mem</span> <span class="n">hy</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">ix</span><span class="o">,</span> <span class="n">hix</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">nth_le_of_mem</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">nth_le_take'</span><span class="o">,</span> <span class="n">nth_le_drop'</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">nth_le_of_sorted_of_lt</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">nat.lt_add_right</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">hix</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hix.left</span>
<span class="kd">end</span>
</code></pre></div>



<a name="225065064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225065064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225065064">(Feb 03 2021 at 19:07)</a>:</h4>
<p>I guess that is golfed if <code>list.exists_i_lt_of_mem_take</code> exists.</p>



<a name="225065124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225065124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225065124">(Feb 03 2021 at 19:08)</a>:</h4>
<p>that looks good to me, I was answering the Y instead of the X in eric's <a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a> question</p>



<a name="225065982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Halves%20of%20a%20sorted%20list%20are%20related/near/225065982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Halves.20of.20a.20sorted.20list.20are.20related.html#225065982">(Feb 03 2021 at 19:14)</a>:</h4>
<p>I've updated the PR to use <span class="user-mention" data-user-id="308899">@Yakov Pechersky</span>'s approach. Feel free to edit the PR description to include a <code>Co-authored-by</code> line.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>