---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html">In a trivial monoid, everything is a unit</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="286259980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286259980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286259980">(Jun 15 2022 at 19:15)</a>:</h4>
<p>Is the following in mathlib?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.group.units</span>

<span class="kd">lemma</span> <span class="n">monoid.unit_of_not_nontrivial</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">nontrivial</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_unit</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">cast</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">is_unit</span> <span class="bp">$</span> <span class="n">subsingleton_iff.mp</span> <span class="o">(</span><span class="n">not_nontrivial_iff_subsingleton.mp</span> <span class="n">hM</span><span class="o">)</span> <span class="mi">1</span> <span class="n">x</span><span class="o">)</span>
  <span class="n">is_unit_one</span>
<span class="bp">````</span>
</code></pre></div>



<a name="286260367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286260367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286260367">(Jun 15 2022 at 19:18)</a>:</h4>
<p>You would definitely spell it out with <code>[subsingleton M]</code> rather than <code>(hM : ¬ nontrivial M)</code>.</p>



<a name="286260390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286260390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286260390">(Jun 15 2022 at 19:18)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/is_unit_of_subsingleton">docs#is_unit_of_subsingleton</a></p>



<a name="286260498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286260498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286260498">(Jun 15 2022 at 19:19)</a>:</h4>
<p>One of the areas I find mathlib covers the most well is the trivial case :b</p>



<a name="286260870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286260870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286260870">(Jun 15 2022 at 19:22)</a>:</h4>
<p>If I want to distinguish cases according to <code>nontrivial M</code>, how do I get <code>[subsingleton M]</code> from <code> ¬ nontrivial M</code>?</p>



<a name="286260927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286260927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286260927">(Jun 15 2022 at 19:23)</a>:</h4>
<p>There are various useful lemmas near <a href="https://leanprover-community.github.io/mathlib_docs/find/subsingleton_or_nontrivial">docs#subsingleton_or_nontrivial</a></p>



<a name="286261104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286261104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286261104">(Jun 15 2022 at 19:24)</a>:</h4>
<p>OK; I realize that I'm already using this in my proof <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="286261311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286261311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286261311">(Jun 15 2022 at 19:26)</a>:</h4>
<p>Still, I think my version has the advantage that I don't have to introduce a <code>[subsingleton]</code> instance first.</p>



<a name="286261634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286261634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286261634">(Jun 15 2022 at 19:29)</a>:</h4>
<p>Do you know the <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#nontriviality">tactic#nontriviality</a>? Most of these lemmas are structured around having that tactic be able to take care of the trivial case in one line, with little or no help from the user.</p>



<a name="286262551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262551">(Jun 15 2022 at 19:36)</a>:</h4>
<p>I have a piece of code like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="n">by_cases</span> <span class="n">hR</span> <span class="o">:</span> <span class="n">nontrivial</span> <span class="n">R</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">haveI</span> <span class="o">:=</span> <span class="n">hR</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">ring.inverse_non_unit</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">map_nonunit</span> <span class="n">χ</span> <span class="n">not_is_unit_zero</span><span class="o">],</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">false.rec</span> <span class="n">_</span> <span class="o">(</span><span class="n">ha</span> <span class="o">(</span><span class="n">monoid.unit_of_not_nontrivial</span> <span class="n">hR</span> <span class="n">a</span><span class="o">)),</span> <span class="o">},</span>
</code></pre></div>
<p>I.e., I need to make a distinction between the case that a ring is nontrivial and the trivial case.<br>
I guess I could replace the <code>haveI := hR</code> line by <code>nontriviality</code>, but this does not look like a big improvement...</p>



<a name="286262616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262616">(Jun 15 2022 at 19:37)</a>:</h4>
<p>(Note that the claim that <code>0</code> is not a unit is only valid in nontrivial rings.)</p>



<a name="286262688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262688">(Jun 15 2022 at 19:37)</a>:</h4>
<p>Yes, the idea is that the <code>nontriviality R</code> tactic does lines 1,2,4 of your snippet in one (readable) command.</p>



<a name="286262814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262814">(Jun 15 2022 at 19:39)</a>:</h4>
<p>There are many examples in files about polynomial degrees for instance, where many results about e.g. <code>deg x^n</code> only hold in a non-zero ring.</p>



<a name="286262849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262849">(Jun 15 2022 at 19:39)</a>:</h4>
<p>How does the tactic remove the need to distinguish cases? I do want to allow the ring to be trivial.</p>



<a name="286262953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286262953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286262953">(Jun 15 2022 at 19:40)</a>:</h4>
<p>It clears that case for you, using an appropriate <code>simp</code> lemma normally. Letting you focus on the nontrivial case.</p>



<a name="286263239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286263239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286263239">(Jun 15 2022 at 19:43)</a>:</h4>
<p>If I put <code>nontriviality R</code> before the first line, I get the error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Could</span> <span class="n">not</span> <span class="n">prove</span> <span class="n">goal</span> <span class="n">assuming</span> <span class="bp">`</span><span class="n">subsingleton</span> <span class="n">R</span><span class="bp">`</span>
</code></pre></div>
<p>So how does it clear the trivial case?</p>



<a name="286263283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286263283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286263283">(Jun 15 2022 at 19:43)</a>:</h4>
<p>I guess the trivial case is not so trivial after all...</p>



<a name="286263297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286263297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286263297">(Jun 15 2022 at 19:43)</a>:</h4>
<p>Do you have a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?</p>



<a name="286263492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286263492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286263492">(Jun 15 2022 at 19:45)</a>:</h4>
<p>If you set up your original lemma in <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit/near/286259980">https://leanprover.zulipchat.com/#narrow/stream/217875-Is-there-code-for-X.3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit/near/286259980</a> using a <code>subsingleton</code> assumption rather than not nontrivial it might work, but its hard to say without runnable code</p>



<a name="286264435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286264435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286264435">(Jun 15 2022 at 19:53)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mwe.html">#mwe</a> seems to be difficult without copying a lot of code.<br>
The goal is of the form <code>⇑χ (ring.inverse a) = 0</code> with <code>a : R</code> and <code>ha : ¬is_unit a</code> in the state, where <code>χ : mul_char R R'</code> (a monoid hom. that sends non-units to zero).<br>
If I replace <code>χ</code> by just a monoid hom, it works.</p>



<a name="286264697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286264697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286264697">(Jun 15 2022 at 19:56)</a>:</h4>
<p>Which is perhaps strange, since <code>is_unit_of_subsingleton</code> gives a contradiction with <code>ha</code> regardless of the goal.</p>



<a name="286265506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286265506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286265506">(Jun 15 2022 at 20:02)</a>:</h4>
<p>Even with a <code>mul_char</code>, if I isolate this part of the code, it does work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">χ</span> <span class="o">:</span> <span class="n">mul_char</span> <span class="n">R</span> <span class="n">R'</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="n">χ</span> <span class="o">(</span><span class="n">ring.inverse</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">nontriviality</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>clears the trivial case.</p>



<a name="286265535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286265535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286265535">(Jun 15 2022 at 20:02)</a>:</h4>
<p>So it has to do with something in the context?</p>



<a name="286265716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286265716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286265716">(Jun 15 2022 at 20:04)</a>:</h4>
<p>I take it back: <code>nontriviality R</code> does not. Without argument, it uses <code>R'</code> <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="286265838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286265838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286265838">(Jun 15 2022 at 20:04)</a>:</h4>
<p>(Same with monoid homomorphism in place of <code>mul_char</code>.)</p>



<a name="286266002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286266002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286266002">(Jun 15 2022 at 20:05)</a>:</h4>
<p>So maybe this is a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.integral_domain</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="n">R'</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R'</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→*</span> <span class="n">R'</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">f</span> <span class="o">(</span><span class="n">ring.inverse</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">nontriviality</span> <span class="n">R</span><span class="o">,</span> <span class="c1">-- error</span>
<span class="kd">end</span>
</code></pre></div>



<a name="286267804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286267804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286267804">(Jun 15 2022 at 20:19)</a>:</h4>
<p>Yeah, I can't get <code>nontriviality</code> to work either, but maybe if you add it to <a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.nontriviality_by_assumption">docs#tactic.nontriviality_by_assumption</a></p>



<a name="286268472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286268472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286268472">(Jun 15 2022 at 20:25)</a>:</h4>
<p><code>nontriviality R using [is_unit_of_subsingleton]</code> does not work, either.<br>
What does "it" refer to in your post?</p>



<a name="286271067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286271067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286271067">(Jun 15 2022 at 20:44)</a>:</h4>
<p>This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="n">R'</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R'</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→*</span> <span class="n">R'</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">f</span> <span class="o">(</span><span class="n">ring.inverse</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">nontriviality</span> <span class="n">R</span> <span class="n">using</span> <span class="o">[</span><span class="bp">@</span><span class="n">false.elim</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">ring.inverse</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">(</span><span class="n">is_unit_of_subsingleton</span> <span class="n">a</span><span class="o">))],</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>in that it does clear the trivial case. But I have to basically spell out the proof anyway here.</p>



<a name="286271764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286271764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286271764">(Jun 15 2022 at 20:51)</a>:</h4>
<p><code>casesI subsingleton_or_nontrivial R</code> is the normal way to handle this kind of thing</p>



<a name="286278736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286278736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286278736">(Jun 15 2022 at 21:49)</a>:</h4>
<p>Yeah its a bit of a funny one, seeing as nontriviality is getting a contradiction with the assumption it works best with that assumption reverted:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.integral_domain</span>
<span class="bp">.</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="n">R'</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R'</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→*</span> <span class="n">R'</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">f</span> <span class="o">(</span><span class="n">ring.inverse</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">nontriviality</span> <span class="n">R</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">ha</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="286278755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286278755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286278755">(Jun 15 2022 at 21:49)</a>:</h4>
<p>Maybe there is some improvement needed for this tactic</p>



<a name="286280649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286280649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286280649">(Jun 15 2022 at 22:05)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/tree/alexjbest/better-nontriviality">branch#alexjbest/better-nontriviality</a>, lets see if it builds!</p>



<a name="286280837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286280837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286280837">(Jun 15 2022 at 22:07)</a>:</h4>
<p>is there any way to let it take extra simp args instead of just doing <code>*</code>? maybe that'll be slow</p>



<a name="286281061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286281061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286281061">(Jun 15 2022 at 22:08)</a>:</h4>
<p>It can already take extra simp args, just not targets. I'm not sure about slowness, there are already likely many simp lemmas being tried, so adding  a few local hypotheses seems ok, but the additional targets could be a lot.</p>



<a name="286355664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286355664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286355664">(Jun 16 2022 at 13:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit/near/286278736">said</a>:</p>
<blockquote>
<p>Yeah its a bit of a funny one, seeing as nontriviality is getting a contradiction with the assumption it works best with that assumption reverted:</p>
</blockquote>
<p>Thanks. This works fine in my proof.</p>



<a name="286359418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/In%20a%20trivial%20monoid%2C%20everything%20is%20a%20unit/near/286359418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit.html#286359418">(Jun 16 2022 at 14:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/In.20a.20trivial.20monoid.2C.20everything.20is.20a.20unit/near/286280649">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/tree/alexjbest/better-nontriviality">branch#alexjbest/better-nontriviality</a>, lets see if it builds!</p>
</blockquote>
<p>Mathlib builds but one of the tests fails, so maybe some more thought is needed. But I think this should be in scope for <code>nontriviality</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>