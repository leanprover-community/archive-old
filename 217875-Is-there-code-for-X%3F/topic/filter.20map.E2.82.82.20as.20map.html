---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html">filter map₂ as map</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="279234264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234264">(Apr 17 2022 at 18:37)</a>:</h4>
<p>I couldn't find the following:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">):</span> <span class="n">filter.map₂</span> <span class="n">m</span> <span class="n">f</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">filter.map</span> <span class="o">(</span><span class="n">uncurry</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="bp">×ᶠ</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">library_search</span>
</code></pre></div>



<a name="279234491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234491">(Apr 17 2022 at 18:42)</a>:</h4>
<p>I didn't add it. Do we have the corresponding <code>set.image2</code> lemma?</p>



<a name="279234500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234500">(Apr 17 2022 at 18:42)</a>:</h4>
<p>Let me see...</p>



<a name="279234514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234514">(Apr 17 2022 at 18:43)</a>:</h4>
<p>Doesn't seem so</p>



<a name="279234580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234580">(Apr 17 2022 at 18:44)</a>:</h4>
<p>Nope.</p>



<a name="279234596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234596">(Apr 17 2022 at 18:45)</a>:</h4>
<p>Was it intentional that filter.map₂ was not defined in terms of the applicative instance?</p>



<a name="279234652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234652">(Apr 17 2022 at 18:46)</a>:</h4>
<p>Yes, because we care about definitional equality.</p>



<a name="279234691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234691">(Apr 17 2022 at 18:47)</a>:</h4>
<p>So yeah we actually have the two lemmas you ask for, but not quite in your form: <a href="https://leanprover-community.github.io/mathlib_docs/find/set.image_prod">docs#set.image_prod</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.map_prod">docs#filter.map_prod</a>.</p>



<a name="279234696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234696">(Apr 17 2022 at 18:47)</a>:</h4>
<p>How does defintional equality affect things? I don't follow.</p>



<a name="279234702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234702">(Apr 17 2022 at 18:47)</a>:</h4>
<p>This is a concern for the end user.</p>



<a name="279234874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279234874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279234874">(Apr 17 2022 at 18:51)</a>:</h4>
<p>Which end user? I'm an end user and it' affecting me, but I don't see the connection with definitional equality.</p>



<a name="279235056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279235056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279235056">(Apr 17 2022 at 18:55)</a>:</h4>
<p>Seems that we're also missing this applicative combinator:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">applicative</span> <span class="n">f</span><span class="o">]</span> <span class="o">(</span><span class="n">fa</span> <span class="o">:</span> <span class="n">f</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">fb</span> <span class="o">:</span> <span class="n">f</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">library_search</span>
</code></pre></div>



<a name="279235177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279235177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279235177">(Apr 17 2022 at 18:58)</a>:</h4>
<p>When you have <code>hx : x \in filter.map\2 m f g</code>, you can <code>obtain \&lt;s, t, hs, ht, h\&gt; := hx</code>.</p>



<a name="279235632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279235632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279235632">(Apr 17 2022 at 19:07)</a>:</h4>
<p>Yes, that is nice. The way I was doing that without map2 was kind of painful.</p>



<a name="279235699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279235699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279235699">(Apr 17 2022 at 19:09)</a>:</h4>
<p>Anyways, I'll make a PR to add the map2 as map for filter.</p>



<a name="279236412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279236412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279236412">(Apr 17 2022 at 19:26)</a>:</h4>
<p>Question: why does  <a href="https://leanprover-community.github.io/mathlib_docs/find/set.image_prod">docs#set.image_prod</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.map_prod">docs#filter.map_prod</a> not use <code>uncurry f</code>. Is there some advantage to having the explicit lambda?</p>



<a name="279236569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279236569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279236569">(Apr 17 2022 at 19:31)</a>:</h4>
<p>Yeah, this allows rewriting inside the lambda.</p>



<a name="279237053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279237053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279237053">(Apr 17 2022 at 19:43)</a>:</h4>
<p>It makes it easier for Lean to infer <code>f</code> by unification</p>



<a name="279237198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279237198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279237198">(Apr 17 2022 at 19:46)</a>:</h4>
<p>OK</p>



<a name="279238045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238045">(Apr 17 2022 at 20:08)</a>:</h4>
<p>I've heard the mathlib community prefers to have names of lemmas, definitions etc. in plain ascii although it seems we're not doing this for the map₂ stuff. I guess we're bending the rules here?</p>



<a name="279238139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238139">(Apr 17 2022 at 20:10)</a>:</h4>
<p>That's not the only place we do this. For example we use numerals in indices to indicate an "iterated" operation: <code>forall₂</code> refers to <code>∀ a b, _</code>, <code>exists₂</code> to <code>∃ a b, _</code>, etc.</p>



<a name="279238243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238243">(Apr 17 2022 at 20:13)</a>:</h4>
<p>I see. I guess subscript indices are still OK, although they are hard to type in the browser.</p>



<a name="279238290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238290">(Apr 17 2022 at 20:14)</a>:</h4>
<p>What browser are you using? We have browser extensions to type unicode in the same way as in VScode, as well as a system-wide version.</p>



<a name="279238337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238337">(Apr 17 2022 at 20:15)</a>:</h4>
<p>I use Chrome. I usually copy/paste the fancy unicode into the browser. But Chrome search is pretty aweful, since it has problems distinguishing e.g. fancy unicode letters from plain ascii ones.</p>



<a name="279238403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238403">(Apr 17 2022 at 20:17)</a>:</h4>
<p>For example, searching for 𝓟 gives you all the regular ascii p's.</p>



<a name="279238416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238416">(Apr 17 2022 at 20:17)</a>:</h4>
<p>Wait, are you not using the API documentation search?</p>



<a name="279238483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238483">(Apr 17 2022 at 20:19)</a>:</h4>
<p>Yes, I use that too.</p>



<a name="279238497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238497">(Apr 17 2022 at 20:19)</a>:</h4>
<p>The Chrome extension is <a href="https://github.com/arthurpaulino/chrome-lean-unicode">https://github.com/arthurpaulino/chrome-lean-unicode</a></p>



<a name="279238558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279238558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279238558">(Apr 17 2022 at 20:20)</a>:</h4>
<p>Oh, nice.</p>



<a name="279241985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter%20map%E2%82%82%20as%20map/near/279241985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.20map.E2.82.82.20as.20map.html#279241985">(Apr 17 2022 at 21:43)</a>:</h4>
<p>Here's the PR: <a href="https://github.com/leanprover-community/mathlib/pull/13490/files">https://github.com/leanprover-community/mathlib/pull/13490/files</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>