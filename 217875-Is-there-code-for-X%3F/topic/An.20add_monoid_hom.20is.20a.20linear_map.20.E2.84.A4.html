---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html">An add_monoid_hom is a linear_map ℤ</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="219089899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219089899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219089899">(Dec 07 2020 at 15:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">B</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">ℤ</span><span class="o">]</span> <span class="n">B</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="219091830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219091830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219091830">(Dec 07 2020 at 15:14)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">B</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">ℤ</span><span class="o">]</span> <span class="n">B</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">library_search</span>
</code></pre></div>



<a name="219092101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219092101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219092101">(Dec 07 2020 at 15:16)</a>:</h4>
<p>it gives <code>f.to_int_linear_map</code>. I gave the <code>library_search</code> recipe to emphasize that it can be used to find data, not only proofs.</p>



<a name="219092398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219092398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219092398">(Dec 07 2020 at 15:18)</a>:</h4>
<p>I'm surprised library search doesn't immediately find the "default" linear map, i.e. the trivial map.</p>



<a name="219093283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219093283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219093283">(Dec 07 2020 at 15:25)</a>:</h4>
<p>Yeah, I didn't even try that because I made the same assumption as Adam</p>



<a name="219093758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219093758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219093758">(Dec 07 2020 at 15:29)</a>:</h4>
<p>It's true it's surprising that it doesn't give the zero map -- otherwise, <code>suggest</code> could have been helpful, as it gives several suggestions.  In fact,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">B</span><span class="o">]</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">ℤ</span><span class="o">]</span> <span class="n">B</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">library_search</span>
</code></pre></div>
<p>fails. It also doesn't find the zero map.</p>



<a name="219093951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219093951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219093951">(Dec 07 2020 at 15:30)</a>:</h4>
<p>Probably because it's given by an instance <code>has_zero</code>, not a proper def.</p>



<a name="219094894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219094894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219094894">(Dec 07 2020 at 15:37)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/add_monoid_hom.to_int_linear_map">docs#add_monoid_hom.to_int_linear_map</a></p>



<a name="219094995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219094995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219094995">(Dec 07 2020 at 15:38)</a>:</h4>
<p>What's going wrong here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>
<span class="kn">import</span> <span class="n">algebra.algebra.basic</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="n">a'</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">⊗</span> <span class="n">N</span> <span class="bp">→+</span> <span class="n">N</span> <span class="o">:=</span> <span class="o">(</span><span class="n">algebra.lmul'</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">to_add_monoid_hom</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">N</span> <span class="bp">⊗</span> <span class="n">N</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">N</span> <span class="o">:=</span> <span class="n">infer_instance</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">a''</span> <span class="o">:=</span> <span class="n">a'.to_int_linear_map</span><span class="o">,</span> <span class="c1">-- fail</span>
<span class="kd">end</span>
</code></pre></div>



<a name="219095263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219095263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219095263">(Dec 07 2020 at 15:40)</a>:</h4>
<p>imports?</p>



<a name="219095285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219095285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219095285">(Dec 07 2020 at 15:40)</a>:</h4>
<p>Not sure, let's guess <code>algebra.algebra.basic</code>?</p>



<a name="219095385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219095385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219095385">(Dec 07 2020 at 15:41)</a>:</h4>
<p>If I pass the type parameters explicitly, I get a super nasty error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">ιa</span> <span class="n">ιb</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="n">a'</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">⊗</span> <span class="n">N</span> <span class="bp">→+</span> <span class="n">N</span> <span class="o">:=</span> <span class="o">(</span><span class="n">algebra.lmul'</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">to_add_monoid_hom</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">a''</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">add_monoid_hom.to_int_linear_map</span> <span class="o">(</span><span class="n">N</span> <span class="bp">⊗</span> <span class="n">N</span><span class="o">)</span> <span class="n">N</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a'</span><span class="o">,</span>
  <span class="n">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">a'.to_int_linear_map</span>
<span class="n">term</span>
  <span class="n">a'</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">add_monoid_hom</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product</span> <span class="n">R</span> <span class="n">_inst_20</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">))</span>
    <span class="n">N</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_monoid.to_add_monoid</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product</span> <span class="n">R</span> <span class="n">_inst_20</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">semiring.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">semiring.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product.add_comm_monoid</span> <span class="n">R</span> <span class="n">_inst_20</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">semiring.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">semiring.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">algebra.to_semimodule</span> <span class="n">R</span> <span class="n">N</span> <span class="n">_inst_20</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)</span> <span class="n">_inst_22</span><span class="o">)))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">add_group.to_add_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_group</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">add_monoid_hom</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
       <span class="bp">?</span><span class="n">m_3</span>
       <span class="bp">?</span><span class="n">m_4</span><span class="o">)</span>
    <span class="n">N</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">add_group.to_add_monoid</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
          <span class="bp">?</span><span class="n">m_3</span>
          <span class="bp">?</span><span class="n">m_4</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_group</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">tensor_product</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span> <span class="n">N</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
             <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_comm_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">))</span>
             <span class="bp">?</span><span class="n">m_3</span>
             <span class="bp">?</span><span class="n">m_4</span><span class="o">)</span>
          <span class="bp">?</span><span class="n">m_5</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">add_group.to_add_monoid</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">add_comm_group.to_add_group</span> <span class="n">N</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">N</span> <span class="n">_inst_21</span><span class="o">)))</span>
</code></pre></div>
</div></div>



<a name="219095924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219095924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219095924">(Dec 07 2020 at 15:45)</a>:</h4>
<p>It's the fact that <code>R</code> is a semiring and not a ring.</p>



<a name="219095952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219095952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219095952">(Dec 07 2020 at 15:45)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>
<span class="kn">import</span> <span class="n">algebra</span>
<span class="kn">import</span> <span class="n">algebra.algebra.basic</span>

<span class="n">open_locale</span> <span class="n">tensor_product</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="n">a'</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">⊗</span> <span class="n">N</span> <span class="bp">→+</span> <span class="n">N</span> <span class="o">:=</span> <span class="o">(</span><span class="n">algebra.lmul'</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">to_add_monoid_hom</span><span class="o">,</span>
  <span class="k">let</span> <span class="o">:=</span> <span class="n">a'.to_int_linear_map</span><span class="o">,</span> <span class="c1">-- works</span>
<span class="kd">end</span>
</code></pre></div>



<a name="219096001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096001">(Dec 07 2020 at 15:45)</a>:</h4>
<p>But <code>add_monoid_hom.to_int_linear_map</code> doesn't even take <code>R</code> as an argument!</p>



<a name="219096334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096334">(Dec 07 2020 at 15:48)</a>:</h4>
<p>Ah, I see the problem</p>



<a name="219096340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096340">(Dec 07 2020 at 15:48)</a>:</h4>
<p><code>haveI : add_comm_group (N ⊗[R] N) := infer_instance,</code> fails</p>



<a name="219096370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096370">(Dec 07 2020 at 15:48)</a>:</h4>
<p>Which it shouldn't, right?</p>



<a name="219096435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096435">(Dec 07 2020 at 15:49)</a>:</h4>
<p>Yeah, I think it's true that the tensor product of two semimodules over a semiring which just so happen to be abelian groups is again an abelian group.</p>



<a name="219096455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096455">(Dec 07 2020 at 15:49)</a>:</h4>
<p>But I guess mathlib doesn't know this?</p>



<a name="219096637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096637">(Dec 07 2020 at 15:50)</a>:</h4>
<p>One would have to track down where the <code>add_comm_group</code> on the tensor product comes from.</p>



<a name="219096793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096793">(Dec 07 2020 at 15:51)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/tensor_product.add_comm_group">docs#tensor_product.add_comm_group</a></p>



<a name="219096875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096875">(Dec 07 2020 at 15:52)</a>:</h4>
<p>Right, so notice the <code>comm_ring R</code> assumption</p>



<a name="219096912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219096912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219096912">(Dec 07 2020 at 15:52)</a>:</h4>
<p>I think this can be relaxed to <code>comm_semiring</code></p>



<a name="219097030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097030">(Dec 07 2020 at 15:53)</a>:</h4>
<p>you just need either side to be an <code>add_comm_group</code> (as is basically clear from the next lines)</p>



<a name="219097163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097163">(Dec 07 2020 at 15:54)</a>:</h4>
<p>This is probably another instance of the "Mathematicians never think about semirings" thing...</p>



<a name="219097166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097166">(Dec 07 2020 at 15:54)</a>:</h4>
<p>the definition of <code>neg</code> will get more complicated though</p>



<a name="219097257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097257">(Dec 07 2020 at 15:55)</a>:</h4>
<p>Doesn't requiring just one side lead to multiple suitable instances for when both sides have neg?</p>



<a name="219097266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097266">(Dec 07 2020 at 15:55)</a>:</h4>
<p>yes</p>



<a name="219097275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097275">(Dec 07 2020 at 15:55)</a>:</h4>
<p>unless you use <code>choice</code> I guess</p>



<a name="219097324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097324">(Dec 07 2020 at 15:55)</a>:</h4>
<p>The easiest thing to do is probably </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="kd">def</span> <span class="n">tensor_product.add_comm_group</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_3</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">M</span> <span class="bp">⊗</span> <span class="n">N</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="219097387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097387">(Dec 07 2020 at 15:56)</a>:</h4>
<p>I mean, the instances will be non-defeq unless you define <code>neg</code> using choice</p>



<a name="219097499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097499">(Dec 07 2020 at 15:57)</a>:</h4>
<p>If your goal is to prove <code>false</code> then it doesn't matter which definition you pick but in the real world you might care about the definition as well</p>



<a name="219097531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097531">(Dec 07 2020 at 15:57)</a>:</h4>
<p>My goal isn't to prove false, I just was cutting down my example</p>



<a name="219097671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097671">(Dec 07 2020 at 15:58)</a>:</h4>
<p>Can you get by with just a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">N</span></span></span></span></span>-linear map? Do you need negation for what you're actually working on?</p>



<a name="219097698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097698">(Dec 07 2020 at 15:58)</a>:</h4>
<p>Yes, negation is central to what I'm doing</p>



<a name="219097708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097708">(Dec 07 2020 at 15:58)</a>:</h4>
<p>I'm sort of skeptical that your original setup is really sensible, since if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is a ring that's an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>-algebra then it's also an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>⊗</mo><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">R \otimes \mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span>-algebra</p>



<a name="219097732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097732">(Dec 07 2020 at 15:58)</a>:</h4>
<p>so wlog you could just assume <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is a ring too, and save yourself the headaches</p>



<a name="219097769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097769">(Dec 07 2020 at 15:59)</a>:</h4>
<p>Yeah, I was considering just assuming <code>R</code> is a ring</p>



<a name="219097826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097826">(Dec 07 2020 at 15:59)</a>:</h4>
<p>I've ended up here because I was trying to extract some intermediate lemmas from my proof that currently just unfolds everything</p>



<a name="219097858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219097858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219097858">(Dec 07 2020 at 15:59)</a>:</h4>
<p>But the intermediate states run into (semi)-issues that unfolding avoided</p>



<a name="219098035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098035">(Dec 07 2020 at 16:00)</a>:</h4>
<p>I think the reason I wanted <code>semiring R</code> is because <code>M</code> is _not_ necessarily a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span> module</p>



<a name="219098094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098094">(Dec 07 2020 at 16:01)</a>:</h4>
<p>M?</p>



<a name="219098132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098132">(Dec 07 2020 at 16:01)</a>:</h4>
<p>Ah heck, you're missing the context</p>



<a name="219098249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098249">(Dec 07 2020 at 16:02)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">mul_general_aux</span> <span class="o">{</span><span class="n">ιa</span> <span class="n">ιb</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">ιa</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">ιb</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">ιa</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">ιb</span><span class="o">]</span>
  <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">M</span> <span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
  <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">alternating_map</span> <span class="n">R</span> <span class="n">M</span> <span class="n">N</span> <span class="n">ιa</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">alternating_map</span> <span class="n">R</span> <span class="n">M</span> <span class="n">N</span> <span class="n">ιb</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">ιa</span> <span class="bp">⊕</span> <span class="n">ιb</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="bp">→</span> <span class="n">N</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>
<p>is where my typeclasses are coming from. I need the same <code>R</code> for <code>M</code> and <code>N</code> to form the alternating_map</p>



<a name="219098431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098431">(Dec 07 2020 at 16:03)</a>:</h4>
<p>I think the same logic applies, since you're mapping into N where you can subtract you might as well assume you can subtract in M too</p>



<a name="219098537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098537">(Dec 07 2020 at 16:04)</a>:</h4>
<p>Sometimes it is useful to deal with <code>comm_semiring R</code>. E.g., it makes sense to deal with <code>fin n → \R</code> as a semimodule over <code>nnreal</code>. Then the <code>submodule.span</code> is the cone generated by a set of vectors.</p>



<a name="219098719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098719">(Dec 07 2020 at 16:05)</a>:</h4>
<p>About the original example. Using <code>have : add_comm_group (N ⊗ N) := infer_instance</code> doesn't help because Lean immediately forgets the definition behind this <code>have</code>.</p>



<a name="219098828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098828">(Dec 07 2020 at 16:06)</a>:</h4>
<p>Sure, the intent of the <code>have</code> was just to check that the instance existed</p>



<a name="219098855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219098855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219098855">(Dec 07 2020 at 16:06)</a>:</h4>
<p>And in this case was a red herring because it didn't infer <code>[R]</code></p>



<a name="219099662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219099662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219099662">(Dec 07 2020 at 16:12)</a>:</h4>
<p>well, here is a suggestion</p>



<a name="219099721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219099721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219099721">(Dec 07 2020 at 16:13)</a>:</h4>
<p>The current definition of <code>neg</code> for the tensor product must actually involve multiplication by elements of R on one of the two factors</p>



<a name="219099888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219099888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219099888">(Dec 07 2020 at 16:13)</a>:</h4>
<p>so we could replace it by an instance that uses <code>neg</code> for the same factor, and not have the other one</p>



<a name="219100556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100556">(Dec 07 2020 at 16:16)</a>:</h4>
<p>logically I suppose it ought to be the left factor, because we have left modules</p>



<a name="219100594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100594">(Dec 07 2020 at 16:16)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.tensor_product</span>
<span class="kn">import</span> <span class="n">algebra</span>
<span class="kn">import</span> <span class="n">algebra.algebra.basic</span>

<span class="n">open_locale</span> <span class="n">tensor_product</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">n1</span> <span class="n">n2</span> <span class="o">:</span> <span class="n">N</span><span class="o">}</span> <span class="o">:</span> <span class="bp">-</span><span class="o">((</span><span class="n">n1</span> <span class="bp">⊗ₜ</span> <span class="n">n2</span><span class="o">)</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">N</span><span class="o">)</span> <span class="bp">=</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">•</span> <span class="n">n1</span><span class="o">)</span> <span class="bp">⊗ₜ</span> <span class="n">n2</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="219100698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100698">(Dec 07 2020 at 16:17)</a>:</h4>
<p>of course it won't be defeq to <code>neg n1 ⊗ₜ n2</code>, but that seems relatively unlikely to cause a problem</p>



<a name="219100895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100895">(Dec 07 2020 at 16:18)</a>:</h4>
<p>I'm not so sure. E.g. <code>(-1) \bu n</code> simplifies to <code>-n</code>.</p>



<a name="219100954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100954">(Dec 07 2020 at 16:19)</a>:</h4>
<p>Actually I guess this is a good thing...</p>



<a name="219100986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219100986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219100986">(Dec 07 2020 at 16:19)</a>:</h4>
<p>Not so sure about which part? that it wouldn't be a problem?</p>



<a name="219101293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219101293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219101293">(Dec 07 2020 at 16:21)</a>:</h4>
<p>Yeah</p>



<a name="219101316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219101316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219101316">(Dec 07 2020 at 16:21)</a>:</h4>
<p>But it's not a problem. Forget what I said.</p>



<a name="219471206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/An%20add_monoid_hom%20is%20a%20linear_map%20%E2%84%A4/near/219471206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/An.20add_monoid_hom.20is.20a.20linear_map.20.E2.84.A4.html#219471206">(Dec 10 2020 at 13:30)</a>:</h4>
<p>I've relaxed the requirements of <a href="https://leanprover-community.github.io/mathlib_docs/find/tensor_product.add_comm_group">docs#tensor_product.add_comm_group</a> in <a href="https://github.com/leanprover-community/mathlib/issues/5305">#5305</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>