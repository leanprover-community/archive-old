---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html">Working with polynomial factorizations</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275430535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275430535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275430535">(Mar 15 2022 at 20:25)</a>:</h4>
<p>Do we have the tools to prove a fact like this?  On paper I would say "split all the polynomials as products of linear factors; apply unique factorization; match up and play pigeonhole".</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.homogeneous</span>
<span class="kn">import</span> <span class="n">field_theory.is_alg_closed.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">is_alg_closed</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="n">q</span> <span class="n">c</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">}</span> <span class="o">(</span><span class="n">hA</span> <span class="o">:</span> <span class="n">A.is_homogeneous</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hB</span> <span class="o">:</span> <span class="n">B.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">q.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">c.is_homogeneous</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">,</span> <span class="n">x.is_homogeneous</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">q</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">c</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>
<p>(I was trying an exercise about the resultant (page 33 <a href="https://homepages.warwick.ac.uk/staff/Miles.Reid/MA4A5/UAG.pdf">here</a>) and this was the part that was hardest to Lean.)</p>



<a name="275430570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275430570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275430570">(Mar 15 2022 at 20:25)</a>:</h4>
<p>Assume any appropriate nondegeneracy hypotheses.</p>



<a name="275430889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275430889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275430889">(Mar 15 2022 at 20:28)</a>:</h4>
<p>We do not yet know that <code>mv_polynomial</code> is a UFD, right?</p>



<a name="275431194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275431194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275431194">(Mar 15 2022 at 20:31)</a>:</h4>
<p>I think we do for finitely many unknowns</p>



<a name="275431717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275431717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275431717">(Mar 15 2022 at 20:35)</a>:</h4>
<p>Independent of that, do we have the factorization into linear factors of (1) a 1-variable polynomial; (2) a 2-variable homogeneous polynomial ?  (Assuming an algebraically closed field in each case.)</p>



<a name="275431896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275431896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275431896">(Mar 15 2022 at 20:36)</a>:</h4>
<p>Or, say, do we know that a linear polynomial is irreducible?</p>



<a name="275432264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275432264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275432264">(Mar 15 2022 at 20:40)</a>:</h4>
<p>we have <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.irreducible_of_degree_eq_one">docs#polynomial.irreducible_of_degree_eq_one</a>; not sure about <code>mv_polynomial</code></p>



<a name="275432617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275432617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275432617">(Mar 15 2022 at 20:43)</a>:</h4>
<p>Separately, why is <code>ring_theory.polynomial.homogeneous</code> not in the subfolder <code>ring_theory.mv_polynomial</code>?</p>



<a name="275433834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275433834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275433834">(Mar 15 2022 at 20:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275431194">said</a>:</p>
<blockquote>
<p>I think we do for finitely many unknowns</p>
</blockquote>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I didn't see even this, where is it?</p>



<a name="275434484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275434484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275434484">(Mar 15 2022 at 21:00)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/ring_theory/polynomial/basic.html#polynomial.unique_factorization_monoid">https://leanprover-community.github.io/mathlib_docs/ring_theory/polynomial/basic.html#polynomial.unique_factorization_monoid</a></p>



<a name="275434517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275434517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275434517">(Mar 15 2022 at 21:00)</a>:</h4>
<p>(I am with my phone)</p>



<a name="275434614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275434614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275434614">(Mar 15 2022 at 21:01)</a>:</h4>
<p>This does not literally say that, but I am pretty sure we have all the isos needed to prove the theorem by induction</p>



<a name="275434816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275434816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275434816">(Mar 15 2022 at 21:02)</a>:</h4>
<p>In one variable everything is in <a href="https://leanprover-community.github.io/mathlib_docs/field_theory/splitting_field.html">https://leanprover-community.github.io/mathlib_docs/field_theory/splitting_field.html</a></p>



<a name="275439269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275439269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275439269">(Mar 15 2022 at 21:39)</a>:</h4>
<p>I also wondered if this lemma existed?  If not, where should it live?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.mv_polynomial.basic</span>

<span class="kn">open</span> <span class="n">mv_polynomial</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">σ</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">eval</span> <span class="n">x</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hpq</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">∣</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">eval</span> <span class="n">x</span> <span class="n">q</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">r</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hpq</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="275439821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275439821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275439821">(Mar 15 2022 at 21:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275433834">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275431194">said</a>:</p>
<blockquote>
<p>I think we do for finitely many unknowns</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> I didn't see even this, where is it?</p>
</blockquote>
<p>Yeah I can't find it: I think I was conflating it with polynomials in finitely many variables over a Noetherian ring being Noetherian. Note that a crucial part of this argument is the fact that if you're isomorphic to a Noetherian ring then you are a Noetherian ring, something which we can't prove automatically but which follows easily from the fact that a homomorphic image of a Noetherian ring is Noetherian. However the same trick does not work with UFDs! If R is a UFD then there can be injections R-&gt;S and surjections R-&gt;S to non-UFDs S (even if S is an integral domain) so we need a transfer lemma. Here's everything apart from that:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.mv_polynomial.equiv</span>
<span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">]</span>

<span class="k">#check</span> <span class="bp">@</span><span class="n">polynomial.unique_factorization_monoid</span>

<span class="kd">lemma</span> <span class="n">transfer_fact</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">S</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃+*</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
<span class="n">unique_factorization_monoid</span> <span class="n">S</span> <span class="o">:=</span> <span class="gr">sorry</span> <span class="c1">-- aargh</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>  <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">transfer_fact</span> <span class="o">((</span><span class="n">mv_polynomial.is_empty_alg_equiv</span> <span class="n">R</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">0</span><span class="o">))</span><span class="bp">.</span><span class="n">to_ring_equiv.symm</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">suffices</span> <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="o">(</span><span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="n">d</span><span class="o">)</span> <span class="n">R</span><span class="o">)),</span>
    <span class="o">{</span> <span class="n">resetI</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">transfer_fact</span> <span class="o">(</span><span class="n">mv_polynomial.fin_succ_equiv</span> <span class="n">R</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">to_ring_equiv.symm</span> <span class="o">},</span>
    <span class="n">resetI</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">polynomial.unique_factorization_monoid</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="275442193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275442193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275442193">(Mar 15 2022 at 22:04)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> <span class="user-mention" data-user-id="110087">@Scott Morrison</span> here's a good example (after many years of waiting for one!):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>

<span class="kd">lemma</span> <span class="n">ring_equiv.unique_factorization_monoid</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">S</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃+*</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
<span class="n">unique_factorization_monoid</span> <span class="n">S</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">well_founded_dvd_not_unit</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span> <span class="c1">-- well_founded dvd_not_unit</span>
  <span class="n">irreducible_iff_prime</span> <span class="o">:=</span> <span class="gr">sorry</span> <span class="c1">-- irreducible iff prime</span>
<span class="o">}</span>
</code></pre></div>
<p>One of the goals is transferring well-foundedness over an isomorphism of partial orders, the other is transferring irreducibility and primality over rings.</p>



<a name="275442292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275442292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275442292">(Mar 15 2022 at 22:05)</a>:</h4>
<p>The hard-mode challenge here is to arrange so that the proof is <code>by transport along e</code>.</p>



<a name="275442471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275442471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275442471">(Mar 15 2022 at 22:07)</a>:</h4>
<p>Mario -- <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo>→</mo><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msqrt><mrow><mo>−</mo><mn>5</mn></mrow></msqrt><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}\to\mathbb{Z}[\sqrt{-5}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1156em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8656em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-2.8256em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1744em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span> is an injection from a UFD to an integral domain non-UFD, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mo>→</mo><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msqrt><mrow><mo>−</mo><mn>5</mn></mrow></msqrt><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[X]\to\mathbb{Z}[\sqrt{-5}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1156em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mopen">[</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8656em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-2.8256em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1744em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span> (send <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mo>−</mo><mn>5</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1744em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8656em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-2.8256em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1744em;"><span></span></span></span></span></span></span></span></span> ) is a surjection from a UFD to an integral domain non-UFD, so your trick doesn't get us out of trouble.</p>



<a name="275442521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275442521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275442521">(Mar 15 2022 at 22:08)</a>:</h4>
<p>Noting that </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">ring</span> <span class="n">β</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">transport</span> <span class="n">using</span> <span class="n">e.</span>
</code></pre></div>
<p>is already real Lean code. The challenge is to "upgrade" <code>transport</code> so that it can take advantage of <code>e : R ≃+* S</code>.</p>



<a name="275442624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275442624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275442624">(Mar 15 2022 at 22:09)</a>:</h4>
<p>The game is to try and get from "R a UFD implies R[X] a UFD" (which we have) to "R a UFD implies mv_polynomial (some fintype) R is a UFD"</p>



<a name="275443364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275443364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275443364">(Mar 15 2022 at 22:20)</a>:</h4>
<p>My trick factors down to the subterms though. Do we know that "irreducible", "prime", "dvd_not_unit" and "well_founded" are preserved under relevant morphisms? I would imagine that at least some of those aren't just invariant under ring equivs, but we should have the theorem in any case</p>



<a name="275444271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275444271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275444271">(Mar 15 2022 at 22:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275430535">said</a>:</p>
<blockquote>
<p>(I was trying an exercise about the resultant (page 33 <a href="https://homepages.warwick.ac.uk/staff/Miles.Reid/MA4A5/UAG.pdf">here</a>) and this was the part that was hardest to Lean.)</p>
</blockquote>
<p>Anyway, that was an instructive exercise but I think I've done all I care to ... here's the branch if anyone else is inspired to take over :-) <a href="https://github.com/leanprover-community/mathlib/tree/resultant-quadratic-cubic">branch#resultant-quadratic-cubic</a></p>



<a name="275444966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275444966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275444966">(Mar 15 2022 at 22:37)</a>:</h4>
<p>Here's <code>unit</code> and <code>irreducible</code>: are the names correct?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.is_unit</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">is_unit.map</span> <span class="n">e</span> <span class="n">h</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.is_unit_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">is_unit.map</span> <span class="n">e</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">is_unit.map</span> <span class="n">e.symm</span> <span class="n">s</span><span class="o">,</span> <span class="n">simp</span> <span class="o">}⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.irreducible</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">h</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="n">r</span><span class="o">]</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">not_unit'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h1</span><span class="o">,</span> <span class="n">irreducible.not_unit</span> <span class="n">h</span> <span class="o">((</span><span class="n">e.is_unit_iff</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h1</span><span class="o">),</span>
  <span class="n">is_unit_or_is_unit'</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">apply_fun</span> <span class="n">e.symm</span> <span class="n">at</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_equiv.symm_apply_apply</span><span class="o">,</span> <span class="n">map_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">(</span><span class="n">ha</span> <span class="bp">|</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">irreducible.is_unit_or_is_unit'</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">b</span><span class="o">)</span> <span class="n">hr</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">rwa</span> <span class="n">e.symm.is_unit_iff</span> <span class="n">a</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">rwa</span> <span class="n">e.symm.is_unit_iff</span> <span class="n">b</span> <span class="o">},</span>
  <span class="kd">end</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.irreducible_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="n">exactI</span> <span class="n">e.irreducible</span> <span class="n">r</span><span class="o">,</span>
 <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">resetI</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.symm.irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">),</span> <span class="n">rw</span> <span class="n">e.symm_apply_apply</span><span class="o">,</span> <span class="o">}⟩</span>
</code></pre></div>
<p>for <code>prime</code> I'm not sure if we have isomorphisms of monoids with 0. For <code>well_founded</code> we need isomorphisms of partial orders -- do we have those?</p>



<a name="275445147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445147">(Mar 15 2022 at 22:39)</a>:</h4>
<p>I don't think we need <code>mul_equiv.is_unit</code>, I guess this is just for dot-notation?</p>



<a name="275445197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445197">(Mar 15 2022 at 22:39)</a>:</h4>
<p>oh yeah I was just getting the hang of it at that point :-)</p>



<a name="275445221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445221">(Mar 15 2022 at 22:39)</a>:</h4>
<p>Is <code>irreducible</code> normally used as an instance argument? I would expect it to be a regular hypothesis here</p>



<a name="275445222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445222">(Mar 15 2022 at 22:39)</a>:</h4>
<p>It should be stated using <a href="https://leanprover-community.github.io/mathlib_docs/find/mul_equiv_class">docs#mul_equiv_class</a></p>



<a name="275445347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445347">(Mar 15 2022 at 22:40)</a>:</h4>
<p>You're talking about isomorphisms of monoids with zero or the transfer lemmas? Presumably the former?</p>



<a name="275445373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445373">(Mar 15 2022 at 22:41)</a>:</h4>
<p>It would be nice if <code>mul_equiv.irreducible</code> was true in greater generality, but I guess someone can tell me that it's false (in either direction) for ring homs</p>



<a name="275445489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445489">(Mar 15 2022 at 22:42)</a>:</h4>
<p>For <code>well_founded</code> I believe we already have the theorem</p>



<a name="275445490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445490">(Mar 15 2022 at 22:42)</a>:</h4>
<p>yeah, Z -&gt; Q and Z -&gt; Z/3Z both send the irreducible 2 to the unit 2 and irreducibles can't be units</p>



<a name="275445526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445526">(Mar 15 2022 at 22:42)</a>:</h4>
<p>what about the other direction? A non-irreducible being sent to an irreducible</p>



<a name="275445570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275445570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275445570">(Mar 15 2022 at 22:43)</a>:</h4>
<p>ooh that might be OK</p>



<a name="275446134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446134">(Mar 15 2022 at 22:49)</a>:</h4>
<p>oh curses, 6 is not irreducible in Z but it's irreducible in Z[1/2]</p>



<a name="275446239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446239">(Mar 15 2022 at 22:50)</a>:</h4>
<p>What about if the ring hom is a surjection?</p>



<a name="275446331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446331">(Mar 15 2022 at 22:51)</a>:</h4>
<p>How is 6 irreducible in Z[1/2]? Isn't it still 2*3?</p>



<a name="275446337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446337">(Mar 15 2022 at 22:51)</a>:</h4>
<p>nope, XY is not irreducible in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">C</mi><mo stretchy="false">[</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{C}[X,Y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">]</span></span></span></span> but you can map that onto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">C</mi><mo stretchy="false">[</mo><mi>Y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{C}[Y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">C</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">]</span></span></span></span> by sending <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> to 1.</p>



<a name="275446351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446351">(Mar 15 2022 at 22:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275446331">said</a>:</p>
<blockquote>
<p>How is 6 irreducible in Z[1/2]? Isn't it still 2*3?</p>
</blockquote>
<p>2 is a unit</p>



<a name="275446414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446414">(Mar 15 2022 at 22:52)</a>:</h4>
<p>3 = -1 * -3 but 3 is still irreducible in the integers</p>



<a name="275446521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446521">(Mar 15 2022 at 22:53)</a>:</h4>
<p>Oh I thought you meant half-integers</p>



<a name="275446578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446578">(Mar 15 2022 at 22:54)</a>:</h4>
<p>oh that's not a ring</p>



<a name="275446589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446589">(Mar 15 2022 at 22:54)</a>:</h4>
<p>I'm doing fancy localisation</p>



<a name="275446636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446636">(Mar 15 2022 at 22:54)</a>:</h4>
<p>Strictly speaking we're talking about monoids here, although I don't know that this makes a difference</p>



<a name="275446657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446657">(Mar 15 2022 at 22:55)</a>:</h4>
<p>Right, but all my rings are monoids</p>



<a name="275446687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446687">(Mar 15 2022 at 22:55)</a>:</h4>
<p>I'm just better at thinking about rings because I'd never heard of monoids 5 years ago ;-)</p>



<a name="275446688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446688">(Mar 15 2022 at 22:55)</a>:</h4>
<p>Something can probably be said for local ring morphisms in the sense of <a href="https://leanprover-community.github.io/mathlib_docs/find/is_local_ring_hom">docs#is_local_ring_hom</a></p>



<a name="275446892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446892">(Mar 15 2022 at 22:57)</a>:</h4>
<p>That excludes the localization counterexamples mentioned above.</p>



<a name="275446931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275446931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275446931">(Mar 15 2022 at 22:57)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/of_irreducible_map">docs#of_irreducible_map</a></p>



<a name="275447014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447014">(Mar 15 2022 at 22:58)</a>:</h4>
<p>Nice! I suppose we also have that ring equivs are local?</p>



<a name="275447042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447042">(Mar 15 2022 at 22:59)</a>:</h4>
<p>Until today that was my favourite transfer example.</p>



<a name="275447148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447148">(Mar 15 2022 at 23:00)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/is_local_ring_hom_equiv">docs#is_local_ring_hom_equiv</a></p>



<a name="275447215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447215">(Mar 15 2022 at 23:00)</a>:</h4>
<p>this stuff should get some fun_like love I think :b</p>



<a name="275447592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447592">(Mar 15 2022 at 23:03)</a>:</h4>
<p>So the Mario excuse to avoid having to write a proper <code>transport</code> tactic is either to say "you haven't specified the problem well enough" or to say "there's no point having a tactic which proves that if X and Y are homeo and X is compact then Y is compact, because a continuous image of compact is compact and that's in your API so just use that". </p>
<p>My one desperate retort to this over the years has been "aah well what about local rings -- if R is local and isomorphic to S then S is local, and being local doesn't transfer along injections or surjections (because the zero ring!) so now please write me a transport tactic". However the modified workaround is this: like preprime (1 or prime) you define a pre-local ring to be either a local ring or the zero ring! Now prelocality does transfer along surjections, and nonzeroness transports along injections, and put the two together and you can deduce that localness transfers along bijections! This was a really annoying observation. But with Heather's brilliant UFD move the ball is firmly back in Mario's court ;-)</p>



<a name="275447744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447744">(Mar 15 2022 at 23:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275447148">said</a>:</p>
<blockquote>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/is_local_ring_hom_equiv">docs#is_local_ring_hom_equiv</a></p>
</blockquote>
<p>That's not it. We're looking for "R equiv S and R local implies S local" and I've just sketched a cool way to do it :-)</p>



<a name="275447968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275447968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275447968">(Mar 15 2022 at 23:07)</a>:</h4>
<p>I can't find morphisms of monoids with zero and I'm assuming that that a monoid morphism (<code>mul_hom</code>) of monoids with 0 doesn't automatically send 0 to 0, so perhaps this is a good time to go to bed.</p>



<a name="275448063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448063">(Mar 15 2022 at 23:08)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>  added <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_with_zero_hom">docs#monoid_with_zero_hom</a> recently</p>



<a name="275448200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448200">(Mar 15 2022 at 23:10)</a>:</h4>
<p>To clarify, it's the right object, but no it's not mine.</p>



<a name="275448220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448220">(Mar 15 2022 at 23:11)</a>:</h4>
<p>oopsies, sorry!</p>



<a name="275448227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448227">(Mar 15 2022 at 23:11)</a>:</h4>
<p>What I added was <a href="https://leanprover-community.github.io/mathlib_docs/find/order_monoid_with_zero_hom">docs#order_monoid_with_zero_hom</a></p>



<a name="275448240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448240">(Mar 15 2022 at 23:11)</a>:</h4>
<p>The goal being <a href="https://github.com/leanprover-community/mathlib/pull/3292">#3292</a></p>



<a name="275448396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448396">(Mar 15 2022 at 23:12)</a>:</h4>
<p>You can't be blamed because after having defined dozens of homs I myself had to check <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="275448425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448425">(Mar 15 2022 at 23:13)</a>:</h4>
<p>it's very annoying <code>f 0 = f(0 * a) = f 0 * f a</code>doesn't imply that <code>f 0 = 0</code> :/</p>



<a name="275448495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448495">(Mar 15 2022 at 23:14)</a>:</h4>
<p>I guess you need cancellation, but anyways that's a tangent</p>



<a name="275448894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448894">(Mar 15 2022 at 23:19)</a>:</h4>
<p>Oh OK great! But we don't have <code>monoid_with_zero_equiv</code>?</p>



<a name="275448905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448905">(Mar 15 2022 at 23:19)</a>:</h4>
<p>It's <code>mul_equiv</code> again</p>



<a name="275448995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275448995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275448995">(Mar 15 2022 at 23:20)</a>:</h4>
<p>The pattern is that an isomorphism respects many more properties than originally requested</p>



<a name="275449002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449002">(Mar 15 2022 at 23:20)</a>:</h4>
<p>Yes I got it. Thanks.</p>



<a name="275449011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449011">(Mar 15 2022 at 23:20)</a>:</h4>
<p>There must be something like <a href="https://leanprover-community.github.io/mathlib_docs/find/mul_hom.monoid_with_zero_hom">docs#mul_hom.monoid_with_zero_hom</a> or something on one of my branches which does exactly this strengthening, Eric.</p>



<a name="275449031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449031">(Mar 15 2022 at 23:20)</a>:</h4>
<p>The proof is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mn>0</mn><mn>1</mn></msub><mo>=</mo><msub><mn>0</mn><mn>1</mn></msub><mo>×</mo><msub><mn>0</mn><mn>2</mn></msub><mo>=</mo><msub><mn>0</mn><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">0_1=0_1\times 0_2=0_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> so the zero is unique</p>



<a name="275449093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449093">(Mar 15 2022 at 23:21)</a>:</h4>
<p>but for that you need some t such that <code>f t = 0</code>, right?</p>



<a name="275449153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449153">(Mar 15 2022 at 23:22)</a>:</h4>
<p>yeah I mean for the equivs. I'm showing that a monoid-isomorphism of monoids with 0 is a monoid-with-zero isomorphism.</p>



<a name="275449157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449157">(Mar 15 2022 at 23:22)</a>:</h4>
<p>Nope, just a <code>0</code> in the domain.</p>



<a name="275449191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449191">(Mar 15 2022 at 23:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275447592">said</a>:</p>
<blockquote>
<p>So the Mario excuse to avoid having to write a proper <code>transport</code> tactic is either to say "you haven't specified the problem well enough" or to say "there's no point having a tactic which proves that if X and Y are homeo and X is compact then Y is compact, because a continuous image of compact is compact and that's in your API so just use that". </p>
<p>My one desperate retort to this over the years has been "aah well what about local rings -- if R is local and isomorphic to S then S is local, and being local doesn't transfer along injections or surjections (because the zero ring!) so now please write me a transport tactic". However the modified workaround is this: like preprime (1 or prime) you define a pre-local ring to be either a local ring or the zero ring! Now prelocality does transfer along surjections, and nonzeroness transports along injections, and put the two together and you can deduce that localness transfers along bijections! This was a really annoying observation. But with Heather's brilliant UFD move the ball is firmly back in Mario's court ;-)</p>
</blockquote>
<p>I wouldn't call it an "excuse" so much as a framework for proving equiv lemmas. The fact that often you can make use of something weaker than an equiv is a side benefit but even without that the main point is that every notion in the library should have a theorem proving it is invariant under (suitable kinds of) equivs (or something weaker),  and so every transport lemma is only applying these lemmas to each immediate subterm, so they are generally quite short proofs.</p>



<a name="275449242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449242">(Mar 15 2022 at 23:23)</a>:</h4>
<p>Was <code>mul_equiv.irreducible</code> above a short proof? It was mildly annoying. And the <code>well_founded</code> one scares me a bit.</p>



<a name="275449322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449322">(Mar 15 2022 at 23:24)</a>:</h4>
<p>The issue is that these proofs do tend to vary in structure a bit depending on what the suitable kind of equiv is or how high-order they are, which makes writing a general tactic difficult</p>



<a name="275449340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449340">(Mar 15 2022 at 23:24)</a>:</h4>
<p>of course I don't mean excuse in a serious way, I'm just giving an irreverent summary of the situation. I do find it fascinating that it's taken years to find this good example.</p>



<a name="275449368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449368">(Mar 15 2022 at 23:25)</a>:</h4>
<p>The proof of <code>mul_equiv.irreducible</code> does look worse than it should be</p>



<a name="275449389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449389">(Mar 15 2022 at 23:25)</a>:</h4>
<p>It's an annoying condition!</p>



<a name="275449396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449396">(Mar 15 2022 at 23:25)</a>:</h4>
<p>most likely you need to be using more theorems like <code>or.map</code> or something</p>



<a name="275449499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275449499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275449499">(Mar 15 2022 at 23:26)</a>:</h4>
<p>I'm doing <code>mul_equiv.prime</code> now I've realised mul_equivs send 0 to 0</p>



<a name="275450625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275450625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275450625">(Mar 15 2022 at 23:35)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/or.map">docs#or.map</a></p>



<a name="275450674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275450674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275450674">(Mar 15 2022 at 23:36)</a>:</h4>
<p>hey! I've been duped!</p>



<a name="275450706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275450706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275450706">(Mar 15 2022 at 23:36)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/or.imp">docs#or.imp</a></p>



<a name="275454044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454044">(Mar 16 2022 at 00:25)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.mv_polynomial.equiv</span>
<span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.basic</span>
<span class="c">/-</span><span class="cm">!</span>

<span class="cm">irred iff prime stuff</span>

<span class="cm">-/</span>
<span class="kd">lemma</span> <span class="n">mul_equiv.is_unit_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">is_unit.map</span> <span class="n">e</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">is_unit.map</span> <span class="n">e.symm</span> <span class="n">s</span><span class="o">,</span> <span class="n">simp</span> <span class="o">}⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.irreducible</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">h</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="n">r</span><span class="o">]</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">not_unit'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h1</span><span class="o">,</span> <span class="n">irreducible.not_unit</span> <span class="n">h</span> <span class="o">((</span><span class="n">e.is_unit_iff</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h1</span><span class="o">),</span>
  <span class="n">is_unit_or_is_unit'</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">apply_fun</span> <span class="n">e.symm</span> <span class="n">at</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_equiv.symm_apply_apply</span><span class="o">,</span> <span class="n">map_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">(</span><span class="n">ha</span> <span class="bp">|</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">irreducible.is_unit_or_is_unit'</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">b</span><span class="o">)</span> <span class="n">hr</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">rwa</span> <span class="n">e.symm.is_unit_iff</span> <span class="n">a</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">rwa</span> <span class="n">e.symm.is_unit_iff</span> <span class="n">b</span> <span class="o">},</span>
  <span class="kd">end</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.irreducible_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">irreducible</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="n">exactI</span> <span class="n">e.irreducible</span> <span class="n">r</span><span class="o">,</span>
 <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">resetI</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.symm.irreducible</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">),</span> <span class="n">rw</span> <span class="n">e.symm_apply_apply</span><span class="o">,</span> <span class="o">}⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.prime</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">{</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="n">prime</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="n">prime</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hr.1</span> <span class="o">(</span><span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">map_zero</span> <span class="n">e.symm</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">h</span><span class="o">,</span> <span class="n">mul_equiv.symm_apply_apply</span><span class="o">],</span> <span class="o">}),</span>
  <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hr.2.1</span> <span class="bp">$</span> <span class="o">(</span><span class="n">e.is_unit_iff</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">begin</span>
    <span class="n">rintro</span> <span class="n">a</span> <span class="n">b</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">e.symm.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mul_equiv.coe_to_monoid_hom</span><span class="o">,</span> <span class="n">mul_equiv.symm_apply_apply</span><span class="o">,</span> <span class="n">map_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">(</span><span class="n">hr.2.2</span> <span class="n">_</span> <span class="n">_</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">imp</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="kd">end</span><span class="o">⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.prime_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">prime</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">prime</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">e.prime</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">convert</span> <span class="n">e.symm.prime</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">}⟩</span>

<span class="c">/-</span><span class="cm"></span>

<span class="cm">well-founded dvd not unit stuff</span>

<span class="cm">-/</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.dvd_not_unit</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hd</span> <span class="o">:</span> <span class="n">dvd_not_unit</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">dvd_not_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hd.1</span> <span class="o">(</span><span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">map_zero</span> <span class="n">e.symm</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">h</span><span class="o">,</span> <span class="n">mul_equiv.symm_apply_apply</span><span class="o">],</span> <span class="o">}),</span>
  <span class="kd">begin</span>
    <span class="n">obtain</span> <span class="o">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">hc</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hd.2</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">e</span> <span class="n">c</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hc</span> <span class="o">((</span><span class="n">e.is_unit_iff</span> <span class="n">c</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h</span><span class="o">),</span> <span class="n">e.map_mul</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="kd">end</span><span class="o">⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.dvd_not_unit_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">:</span> <span class="n">dvd_not_unit</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">dvd_not_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">e.dvd_not_unit</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">convert</span> <span class="n">e.symm.dvd_not_unit</span> <span class="n">h</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">}⟩</span>

<span class="c">/-</span><span class="cm"></span>

<span class="cm">where is my tactic which does this?</span>

<span class="cm">-/</span>

<span class="kd">lemma</span> <span class="n">ring_equiv.unique_factorization_monoid</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">S</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃+*</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">hR</span> <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
<span class="n">unique_factorization_monoid</span> <span class="n">S</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">well_founded_dvd_not_unit</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="n">i</span> <span class="o">:</span> <span class="o">(</span><span class="n">dvd_not_unit</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">S</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="bp">↪</span><span class="n">r</span> <span class="o">(</span><span class="n">dvd_not_unit</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">R</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">e.symm</span><span class="o">,</span>
    <span class="n">inj'</span> <span class="o">:=</span> <span class="n">equiv_like.injective</span> <span class="n">e.symm</span><span class="o">,</span>
    <span class="n">map_rel_iff'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">e.symm.to_mul_equiv.dvd_not_unit_iff.symm</span> <span class="o">}</span>
  <span class="k">in</span> <span class="n">rel_embedding.well_founded</span> <span class="n">i</span> <span class="n">hR.well_founded_dvd_not_unit</span><span class="o">,</span>
  <span class="n">irreducible_iff_prime</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">e.symm.to_mul_equiv.irreducible_iff</span><span class="o">,</span><span class="n">e.symm.to_mul_equiv.prime_iff</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">unique_factorization_monoid.irreducible_iff_prime</span><span class="o">,</span>
  <span class="kd">end</span> <span class="o">}</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>  <span class="o">:</span>
<span class="n">unique_factorization_monoid</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">mv_polynomial.is_empty_alg_equiv</span> <span class="n">R</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">0</span><span class="o">))</span><span class="bp">.</span><span class="n">to_ring_equiv.symm.unique_factorization_monoid</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">suffices</span> <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="o">(</span><span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="n">d</span><span class="o">)</span> <span class="n">R</span><span class="o">)),</span>
    <span class="o">{</span> <span class="n">resetI</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">(</span><span class="n">mv_polynomial.fin_succ_equiv</span> <span class="n">R</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">to_ring_equiv.symm.unique_factorization_monoid</span> <span class="o">},</span>
    <span class="n">resetI</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">polynomial.unique_factorization_monoid</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> we've got it now :-)</p>



<a name="275454115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454115">(Mar 16 2022 at 00:26)</a>:</h4>
<p>(I have no idea why I had to increase my deterministic timeout to 10^6 but it compiles for me)</p>



<a name="275454426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454426">(Mar 16 2022 at 00:32)</a>:</h4>
<p>Excellent!  Remember I have a long list of demands, I also want to split a homogeneous polynomial in 2 variables over an algebraically closed field as a product of linear factors.</p>



<a name="275454558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454558">(Mar 16 2022 at 00:34)</a>:</h4>
<p>(Maybe <span class="user-mention" data-user-id="252627">@Jujian Zhang</span> is on the way to this?)</p>



<a name="275454667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454667">(Mar 16 2022 at 00:36)</a>:</h4>
<p>My instinct is to dehomogenise, factor and rehomogenise but that doesn't sound at all nice...</p>



<a name="275454715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275454715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275454715">(Mar 16 2022 at 00:37)</a>:</h4>
<p>I'm a bit rusty here, can a homogeneous polynomial have a non-homogeneous factor?</p>



<a name="275457121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275457121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275457121">(Mar 16 2022 at 01:17)</a>:</h4>
<p>We have a bunch of homogenization stuff in flt-regular for doing precisely this sort of thing, explicitly factoring <code>x^n - y^n</code> using the dehomogonized version. So most of the lemmata for that strategy should be already there. Maybe the only thing we don’t have is that dehomogenization (e.g. evaluate some variable at 1) is inverse to homogenization</p>



<a name="275457212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275457212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275457212">(Mar 16 2022 at 01:19)</a>:</h4>
<p>I tried to set it up in a way where that would be nice though, in that homogenization doesn’t change the set of variables, so statements like dehomogenize and then rehomogenize is the identity should be literal equalities without changing rings, but we just never needed dehomogenizing yet I think</p>



<a name="275459606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275459606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275459606">(Mar 16 2022 at 02:03)</a>:</h4>
<p>That does look nice!  I'll look forward to it being in mathlib!</p>
<p><a href="https://github.com/leanprover-community/flt-regular/blob/master/src/ring_theory/polynomial/homogenization.lean">https://github.com/leanprover-community/flt-regular/blob/master/src/ring_theory/polynomial/homogenization.lean</a><br>
for anyone else wanting to find it.</p>



<a name="275463150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275463150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275463150">(Mar 16 2022 at 03:19)</a>:</h4>
<p>Full generality, using two lemmas above  :)<br>
Using this equivalent definition makes it unnecessary to deal with <code>irreducible</code> and well-foundedness.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.is_unit_iff</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="n">r</span> <span class="bp">↔</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">is_unit.map</span> <span class="n">e</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">is_unit.map</span> <span class="n">e.symm</span> <span class="n">s</span><span class="o">,</span> <span class="n">simp</span> <span class="o">}⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.prime</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span> <span class="o">{</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="n">prime</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="n">prime</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hr.1</span> <span class="o">(</span><span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="n">map_zero</span> <span class="n">e.symm</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">h</span><span class="o">,</span> <span class="n">mul_equiv.symm_apply_apply</span><span class="o">],</span> <span class="o">}),</span>
  <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">hr.2.1</span> <span class="bp">$</span> <span class="o">(</span><span class="n">e.is_unit_iff</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">begin</span>
    <span class="n">rintro</span> <span class="n">a</span> <span class="n">b</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">e.symm.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mul_equiv.coe_to_monoid_hom</span><span class="o">,</span> <span class="n">mul_equiv.symm_apply_apply</span><span class="o">,</span> <span class="n">map_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">(</span><span class="n">hr.2.2</span> <span class="n">_</span> <span class="n">_</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">imp</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">convert</span> <span class="n">e.to_monoid_hom.map_dvd</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="kd">end</span><span class="o">⟩</span>

<span class="kd">lemma</span> <span class="n">mul_equiv.unique_factorization_monoid</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
  <span class="o">[</span><span class="n">cancel_comm_monoid_with_zero</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">cancel_comm_monoid_with_zero</span> <span class="n">S</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">≃*</span> <span class="n">S</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hR</span> <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">unique_factorization_monoid</span> <span class="n">S</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">unique_factorization_monoid.iff_exists_prime_factors</span> <span class="n">at</span> <span class="n">hR</span> <span class="bp">⊢</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">rcases</span> <span class="n">hR</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">ha</span> <span class="o">(</span><span class="kd">by</span> <span class="o">{</span><span class="n">convert</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="n">e</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span><span class="n">h</span><span class="o">]}))</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">w</span><span class="o">,</span><span class="n">hp</span><span class="o">,</span><span class="n">u</span><span class="o">,</span><span class="n">h</span><span class="o">⟩,</span>
  <span class="n">use</span> <span class="n">w.map</span> <span class="n">e</span><span class="o">,</span> <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span> <span class="n">rw</span> <span class="n">multiset.mem_map</span> <span class="n">at</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">rcases</span> <span class="n">hb</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">c</span><span class="o">,</span><span class="n">hc</span><span class="o">,</span><span class="n">he</span><span class="o">⟩,</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">he</span><span class="o">,</span> <span class="n">exact</span> <span class="n">e.prime</span> <span class="o">(</span><span class="n">hp</span> <span class="n">c</span> <span class="n">hc</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">use</span> <span class="n">units.map</span> <span class="n">e.to_monoid_hom</span> <span class="n">u</span><span class="o">,</span>
    <span class="n">erw</span> <span class="o">[</span><span class="n">multiset.prod_hom</span><span class="o">,</span> <span class="bp">←</span> <span class="n">e.map_mul</span><span class="o">,</span> <span class="n">h</span><span class="o">],</span> <span class="n">simp</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="275471619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275471619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275471619">(Mar 16 2022 at 06:27)</a>:</h4>
<p>Heather, regarding homogeneity of factors, factors of a homogeneous polynomial must be homogeneous, if the coefficients lie in an integral domain.</p>
<p>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> are polynomials with coefficients in an integral domain whose product is homogeneous, they they are homogeneous.  Indeed, write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>+</mo><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f=f_0+f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> containing the sum of all the terms of minimum degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> and similarly <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msub><mi>g</mi><mn>0</mn></msub><mo>+</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">g=g_0+g_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.  The product <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">fg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> contains the homogeneous part <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><msub><mi>g</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0g_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, having degree less than or equal to the degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">fg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>.  The degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><msub><mi>g</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0g_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is strictly smaller than the degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">fg</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> if at least one of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">g_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> has degree strictly smaller than their corresponding polynomials.  Thus, if the product is homogeneous, both <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> must be homogeneous.</p>
<p>The integral domain assumption is used to see that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><msub><mi>g</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">f_0g_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is non-zero.</p>



<a name="275538144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275538144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275538144">(Mar 16 2022 at 16:28)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Nice, thanks!  That would simplify the argument a lot.</p>



<a name="275586929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275586929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275586929">(Mar 16 2022 at 22:47)</a>:</h4>
<p>So <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span class="user-mention" data-user-id="224323">@Junyan Xu</span> are you going to PR the UFD instance? :)</p>



<a name="275590938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275590938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275590938">(Mar 16 2022 at 23:37)</a>:</h4>
<p>I have limited time to address PR reviews, so it would be ideal if someone else (maybe you) PR it :)</p>
<p>I'm trying to deduce the infinite(ly many variable) case from the finite case, and it seems we don't have this <code>map_var</code> in mathlib right? If so then many lemmas I need (composition, injectivity, joint surjectivity from finsets) are probably also not there.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">map_var</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">σ</span> <span class="n">τ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">τ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span> <span class="bp">→+*</span> <span class="n">mv_polynomial</span> <span class="n">τ</span> <span class="n">R</span> <span class="o">:=</span> <span class="n">eval₂_hom</span> <span class="n">C</span> <span class="o">(</span><span class="n">X</span> <span class="bp">∘</span> <span class="n">f</span><span class="o">)</span>
</code></pre></div>



<a name="275600724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275600724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275600724">(Mar 17 2022 at 02:22)</a>:</h4>
<p>Hmm, I read every file under <code>data.mv_polynomial</code> and in the third-to-last file I discovered that it's called <a href="https://leanprover-community.github.io/mathlib_docs/find/mv_polynomial.rename">docs#mv_polynomial.rename</a> (and the desired lemmas are there!)<br>
Didn't expect even <a href="https://leanprover-community.github.io/mathlib_docs/find/mv_polynomial.exists_finset_rename">docs#mv_polynomial.exists_finset_rename</a>  is there (seems it's only applied to <a href="https://leanprover-community.github.io/mathlib_docs/find/mv_polynomial.eq_zero_or_eq_zero_of_mul_eq_zero">docs#mv_polynomial.eq_zero_or_eq_zero_of_mul_eq_zero</a>)</p>



<a name="275611689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275611689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275611689">(Mar 17 2022 at 06:24)</a>:</h4>
<p>We even know it's monadic in <code>σ</code> (-;</p>



<a name="275767425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275767425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275767425">(Mar 18 2022 at 07:24)</a>:</h4>
<p>It has now been established that a polynomial ring of arbitrary number of variables over a UFD is itself a UFD: <a href="https://gist.github.com/alreadydone/31f1ee37aba285115cdb365d3fcdfd6a#file-mv_polynomial_ufd-lean-L128">https://gist.github.com/alreadydone/31f1ee37aba285115cdb365d3fcdfd6a#file-mv_polynomial_ufd-lean-L128</a></p>



<a name="275767550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275767550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275767550">(Mar 18 2022 at 07:26)</a>:</h4>
<p>Do you mind PRing it?</p>



<a name="275767912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275767912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275767912">(Mar 18 2022 at 07:33)</a>:</h4>
<p>If someone wants to PR please feel free to do so! If no one does it I'll PR in a few days (declarations need to go into multiple files).</p>



<a name="275768220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275768220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275768220">(Mar 18 2022 at 07:38)</a>:</h4>
<p>This is the first time I use something less general to prove something strictly more general. I guess this is an appropriate occasion to mark the less general stuff <code>private</code>.</p>



<a name="275772069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275772069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275772069">(Mar 18 2022 at 08:30)</a>:</h4>
<p>I think it should be called <code>_aux</code>, because <code>private</code> has been causing mysterious bugs lately.</p>



<a name="275778917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/275778917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#275778917">(Mar 18 2022 at 09:39)</a>:</h4>
<p>In this case I don't think you need to worry. It seems like most of the private issues come from tactics applying private lemmas in other files, not from using a private lemma immediately after it is defined (and it might be fixed now anyways)</p>



<a name="276131218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276131218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276131218">(Mar 22 2022 at 00:32)</a>:</h4>
<p>PR opened at <a href="https://github.com/leanprover-community/mathlib/pull/12866">#12866</a></p>



<a name="276134884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276134884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276134884">(Mar 22 2022 at 01:49)</a>:</h4>
<p>Nice!</p>
<p>Does <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275471619">this argument</a> of Damiano now imply that the homogeneous multivariable polynomials form a unique factorization <em>monoid</em>?</p>



<a name="276137567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276137567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276137567">(Mar 22 2022 at 02:40)</a>:</h4>
<p>I think yes. Any submonoid of a <code>cancel_comm_monoid_with_zero</code> that contains zero is again a <code>cancel_comm_monoid_with_zero</code>. Damiano's argument shows that that the homogeneous polynomials in a multivariate polynomial ring over an integral domain is a <a href="https://en.wikipedia.org/wiki/Multiplicatively_closed_set">saturated submonoid</a> (if xy is in the submonoid then x and y are also). However, it seems that the weaker property, that if xy and x are in the submonoid then y is also, already implies that <code>dvd, is_unit, prime, irreducible</code> are all the same in the submonoid as in the whole polynomial ring, so we can transfer <code>wf_dvd_domain</code> and <code>irreducible_iff_prime</code> properties to the submonoid, so the submonoid is also a <code>unique_factorization_monoid</code>.</p>
<p>Now, by existence of factorization into primes the submonoid (which remains prime in the whole ring) and uniqueness in the whole polynomial ring, and since all units are homogeneous of degree 0 in a polynomial ring over a domain, we see that the factors of a homogeneous polynomial must be homogeneous, so the weaker property implies the stronger saturatedness. A weird argument!</p>



<a name="276140062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276140062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276140062">(Mar 22 2022 at 03:32)</a>:</h4>
<p>Hmm, I made some errors: with the weaker condition, primeness in the whole ring implies primeness in the submonoid, but not vice versa.</p>



<a name="276145008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276145008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276145008">(Mar 22 2022 at 05:23)</a>:</h4>
<p>I've successfully shown that a saturated submonoid of a unique_factorization_monoid containing 0 is itself a unique_factorization_monoid:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">submonoid.ufm</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_1</span> <span class="o">:</span> <span class="n">cancel_comm_monoid_with_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">submonoid</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">hmem</span> <span class="o">:</span> <span class="n">fact</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)],</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="o">⦃</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">⦄,</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∣</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span>
    <span class="n">unique_factorization_monoid</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">unique_factorization_monoid</span> <span class="bp">↥</span><span class="n">s</span>
</code></pre></div>
<p><a href="https://gist.github.com/alreadydone/869f2810d6b9a31eb2d4632e8df26c68">https://gist.github.com/alreadydone/869f2810d6b9a31eb2d4632e8df26c68</a></p>



<a name="276147230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276147230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276147230">(Mar 22 2022 at 06:11)</a>:</h4>
<p>Hmm, as currently stated, this is a vacuous statement, since everything divides 0 so everything must belong to the submonoid. The correct condition should be <code>∀ ⦃a b : α⦄, b ∈ s → b ≠ 0 → a ∣ b → a ∈ s</code>. Without <code>b ≠ 0</code>, this condition isn't satisfied by the homogeneous polynomials over a domain.</p>



<a name="276819315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276819315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276819315">(Mar 28 2022 at 01:56)</a>:</h4>
<p>I managed to formalize Damiano's argument at what I think is appropriate generality for mathlib; here I show that factors of a nonzero homogeneous element in an algebra without zero divisors graded by a <code>linear_ordered_cancel_add_comm_monoid</code> are also homogeneous: <br>
<a href="https://gist.github.com/alreadydone/6f26faa1bde01d1f7785a08bf83a6a28">https://gist.github.com/alreadydone/6f26faa1bde01d1f7785a08bf83a6a28</a></p>



<a name="276819724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276819724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276819724">(Mar 28 2022 at 02:07)</a>:</h4>
<p><span class="user-mention" data-user-id="224323">@Junyan Xu</span>, awesome!</p>



<a name="276819842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276819842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276819842">(Mar 28 2022 at 02:10)</a>:</h4>
<p>I see you got the UFM part working too?</p>



<a name="276819928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276819928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276819928">(Mar 28 2022 at 02:12)</a>:</h4>
<p>Thanks! I realize that we seem to be missing the graded_algebra instance on <code>mv_polynomial.homogeneous_submodule σ R</code> so my result can't be directly applied to mv_polynomial yet. I'm trying to construct one now; it seems everything necessary is in ring_theory.polynomial.homogeneous.</p>



<a name="276820105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276820105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276820105">(Mar 28 2022 at 02:17)</a>:</h4>
<p>Yes I made the UFM part work with the appropriate nonzero assumption, so you can concatenate the two gists. I'm not sure how useful the UFM instance is though; I used the UFM instance to show that being prime in the homogeneous submonoid is the same as being prime in the whole ring, but the irreducible_iff equivalence doesn't rely on UFM and may be good enough for applications.</p>



<a name="276820171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276820171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276820171">(Mar 28 2022 at 02:19)</a>:</h4>
<p>Well, so <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/275430535">here</a> was my original motivation:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.homogeneous</span>
<span class="kn">import</span> <span class="n">field_theory.is_alg_closed.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">is_alg_closed</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="n">q</span> <span class="n">c</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">}</span> <span class="o">(</span><span class="n">hA</span> <span class="o">:</span> <span class="n">A.is_homogeneous</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hB</span> <span class="o">:</span> <span class="n">B.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">q.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">c.is_homogeneous</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">,</span> <span class="n">x.is_homogeneous</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">q</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">c</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="276820247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276820247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276820247">(Mar 28 2022 at 02:21)</a>:</h4>
<p>It certainly feels like it should reduce to some factorization argument, but I don't have a theory about what the exact shortest path is.</p>



<a name="276827953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276827953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276827953">(Mar 28 2022 at 05:13)</a>:</h4>
<p>I think you would only need that the mv_polynomial in two variables is UFD if you use the dehomogenize-factor-homogenize approach suggested by Kevin. However it might be easier to show that every homogeneous polynomial has a linear homogeneous factor (over alg_closed field), and to iterate this process it's most convenient to use the saturatedness I just showed to deduce the other factor is also homogeneous, so eventually we factorize B,q,A,c into products of multisets of linear factors. It's easy to show linear factors are irreducible (total_degree of a product of polynomials over an integral domain is the sum of total_degrees, so one of the factors must be degree 0, hence a constant and a unit). Then you use 2+3&gt;2+2=1+3 to show that no matter how you permute the elements, the multisets of factors of q and c must overlap up to associates, so you get a (homogeneous) linear factor that divides both.</p>



<a name="276827955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276827955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276827955">(Mar 28 2022 at 05:13)</a>:</h4>
<p>It turns out there are already two PRs <a href="https://github.com/leanprover-community/mathlib/pull/8913">#8913</a> and <a href="https://github.com/leanprover-community/mathlib/pull/10119">#10119</a> (latest activity 23 days ago by <span class="user-mention" data-user-id="252627">@Jujian Zhang</span>) providing the graded_algebra instance.</p>



<a name="276831821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/276831821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#276831821">(Mar 28 2022 at 06:26)</a>:</h4>
<p>I just cleaned up <a href="https://github.com/leanprover-community/mathlib/pull/10119">#10119</a>, it should be usable now if you need it</p>



<a name="278208215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278208215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278208215">(Apr 07 2022 at 18:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/276820247">said</a>:</p>
<blockquote>
<p>It certainly feels like it should reduce to some factorization argument, but I don't have a theory about what the exact shortest path is.</p>
</blockquote>
<p>What about something like: factor <code>q</code> into linear factors <code>x_1 x_2</code>, then use that linear factors are prime? (Most of the discussion above seemed to be about irreducible, but primeness seems like what is actually needed). So <code>x_1</code> divides <code>A</code> or <code>c</code>. If it doesn't divide <code>c</code>, then factor <code>x_1</code> out of <code>A</code> leaving a scalar, then cancel the <code>x_1</code>, so now <code>x_2 | c</code>.</p>



<a name="278208296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278208296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278208296">(Apr 07 2022 at 18:41)</a>:</h4>
<p>This avoids all the pigeonhole principle / multiset overlap messiness.</p>



<a name="278208697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278208697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278208697">(Apr 07 2022 at 18:44)</a>:</h4>
<p>In fact it's enough (in this toy example) to just obtain <em>some</em> linear factor of q, since then the leftover factor is automatically also of degree 1.</p>



<a name="278262282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278262282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278262282">(Apr 08 2022 at 06:36)</a>:</h4>
<p><span class="user-mention" data-user-id="391579">@Jake Levinson</span> Are you at all tempted to do it for me? :)</p>



<a name="278360009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278360009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278360009">(Apr 08 2022 at 20:45)</a>:</h4>
<p>Hmm, I just tried running it and got</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">field_theory.is_alg_closed.basic</span>
<span class="n">could</span> <span class="n">not</span> <span class="n">resolve</span> <span class="kn">import</span><span class="o">:</span> <span class="n">field_theory.is_alg_closed.basic</span>
</code></pre></div>
<p>I think my Lean install might be out of date.</p>



<a name="278370086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278370086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278370086">(Apr 08 2022 at 22:31)</a>:</h4>
<p>If you've got <code>leanproject</code> installed then you can just use it to get bang up to date fully compiled lean and mathlib, although exactly what you type depends on whether you're working with mathlib itself or with another project having mathlib as a dependency. If you're working in mathlib then <code>git pull</code> followed by <code>leanproject get-cache</code> should get you up to date.</p>



<a name="278376428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278376428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278376428">(Apr 09 2022 at 00:11)</a>:</h4>
<p>I was trying to construct the monoid iso (homogenization/dehomogenization) between R[x] and the submonoid of homogeneous polynomials in R[x,y] not divisible by y, so as to transfer factorization into linear polynomials in R[x] to factorization into linear homogeneous polynomials in R[x,y], for a domain R. The submonoid in R[x,y] is simply the meet (intersection) of the complement of the prime ideal (y) and <code>set_like.homogeneous_submonoid (homogeneous_submodule (fin 2) R)</code>. However, I was stuck at the first step: showing that y is a prime element. I tried to use canonical isomorphisms to reduce it to <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.prime_X">docs#polynomial.prime_X</a>, but encountered some inexplicable issues, most recently a typeclass issue: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.homogeneous</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.basic</span>

<span class="kn">namespace</span> <span class="n">mv_polynomial</span>
<span class="n">open_locale</span> <span class="n">polynomial</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">prime_X</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">σ</span><span class="o">)</span> <span class="o">:</span> <span class="n">prime</span> <span class="o">(</span><span class="n">X</span> <span class="n">n</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="k">let</span> <span class="o">:=</span> <span class="n">sum_alg_equiv</span> <span class="n">R</span> <span class="n">punit</span> <span class="o">({</span><span class="n">n</span><span class="o">}</span><span class="bp">ᶜ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">σ</span><span class="o">),</span> <span class="k">let</span> <span class="o">:=</span> <span class="n">this.to_mul_equiv</span><span class="o">,</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">failed to synthesize type class instance for</span>
<span class="cm">R : Type u_1,</span>
<span class="cm">σ : Type u_2,</span>
<span class="cm">_inst_1 : comm_ring R,</span>
<span class="cm">_inst_2 : is_domain R,</span>
<span class="cm">n : σ,</span>
<span class="cm">_inst : Π (a : Prop), decidable a,</span>
<span class="cm">this : mv_polynomial (punit ⊕ ↥{n}ᶜ) R ≃ₐ[R] mv_polynomial punit (mv_polynomial ↥{n}ᶜ R) :=</span>
<span class="cm">  sum_alg_equiv R punit ↥{n}ᶜ</span>
<span class="cm">⊢ algebra R (mv_polynomial punit (mv_polynomial ↥{n}ᶜ R))</span>
<span class="cm">-/</span>
<span class="kd">end</span>
</code></pre></div>
<p>It's really weird that we already have the alg_equiv <code>this</code> in the context, but Lean complains it can't find the algebra instance on the target!<br>
Unfortunately I didn't have time to look into this further lately.</p>



<a name="278378124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278378124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278378124">(Apr 09 2022 at 00:47)</a>:</h4>
<p>I'm taking a look, but I don't know this part of mathlib at all. For example, where do I find the lemma that <code>{σ : Type} {a b c : mv_polynomial σ K} 
  (ha : a ≠ 0) (H : a * b = a * c) : b = c</code>?</p>
<p>Currently every time I try to use <code>library_search</code> it crashes VS Code with a memory consumption error. I don't know if this is something wrong with my installation or what.</p>



<a name="278381037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278381037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278381037">(Apr 09 2022 at 01:53)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span>  Here's the proof outline I was imagining. (I think some of these sorries might be easy to fill in, but as I mentioned I'm having trouble with Lean and VS Code at the moment, so I had limited searching ability...)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.homogeneous</span>
<span class="kn">import</span> <span class="n">field_theory.is_alg_closed.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">is_alg_closed</span> <span class="n">K</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">mv_polynomial.is_homogeneous.factor</span>
  <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">K</span><span class="o">}</span>
  <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">g.is_homogeneous</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">∣</span> <span class="n">g</span><span class="o">)</span> <span class="o">:</span>
<span class="n">f.is_homogeneous</span> <span class="o">(</span><span class="n">f.total_degree</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="c1">-- proof: by Damiano's argument higher up the thread (look at minimum and maximum degree parts of f)</span>

<span class="kd">lemma</span> <span class="n">mv_polynomial.prime_of_linear</span>
  <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">K</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">f.is_homogeneous</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
<span class="n">prime</span> <span class="n">f</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="c1">-- proof: irreducibility (by degree counting) + UFD</span>

<span class="kd">lemma</span> <span class="n">mv_polynomial.has_linear_factor</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">)</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">f.is_homogeneous</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span>
<span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">,</span> <span class="n">x.is_homogeneous</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">f</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="c1">-- proof: possibly annoying since it involves dehomogenizing</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="n">q</span> <span class="n">c</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">}</span> <span class="o">(</span><span class="n">hA</span> <span class="o">:</span> <span class="n">A.is_homogeneous</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">hB</span> <span class="o">:</span> <span class="n">B.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">q.is_homogeneous</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">c.is_homogeneous</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">q_ne_zero</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">A_ne_zero</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span><span class="o">,</span> <span class="n">x.is_homogeneous</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">q</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">c</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hxq</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">q.has_linear_factor</span> <span class="n">hq</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">hxc</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">c</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hxq</span><span class="o">,</span> <span class="n">hxc</span><span class="o">⟩,</span> <span class="o">},</span>

  <span class="k">have</span> <span class="n">hxA</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∣</span> <span class="n">A</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">prime.dvd_or_dvd</span> <span class="o">(</span><span class="n">x.prime_of_linear</span> <span class="n">hx</span><span class="o">)</span> <span class="n">_</span><span class="o">)</span> <span class="n">hxc</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">,</span> <span class="bp">←</span> <span class="n">H</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">hxq.trans</span> <span class="o">(</span><span class="n">dvd_mul_left</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="o">},</span>

  <span class="c1">-- pull out factors</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqxy</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hxq</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">A'</span><span class="o">,</span> <span class="n">hAxA'</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hxA</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">hAxA'</span><span class="o">,</span> <span class="n">hqxy</span><span class="o">,</span> <span class="o">(</span><span class="kd">by</span> <span class="n">ring</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">*</span> <span class="o">(</span><span class="n">B</span> <span class="bp">*</span> <span class="n">y</span><span class="o">))]</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_assoc</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">x_ne_zero</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">apply</span> <span class="n">A_ne_zero</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hAxA'</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">],</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">H'</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">A'</span> <span class="bp">*</span> <span class="n">c</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">sub_eq_zero</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">eq_zero_or_eq_zero_of_mul_eq_zero</span> <span class="n">_</span><span class="o">)</span> <span class="n">x_ne_zero</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_sub</span><span class="o">,</span> <span class="n">H</span><span class="o">,</span> <span class="n">sub_self</span><span class="o">],</span> <span class="o">},</span>


  <span class="k">have</span> <span class="n">hyq</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">q</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">▸</span> <span class="n">hqxy</span><span class="o">⟩,</span>

  <span class="k">have</span> <span class="n">hy</span> <span class="o">:</span> <span class="n">y.is_homogeneous</span> <span class="mi">1</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">hq.factor</span> <span class="n">hyq</span><span class="o">,</span>
    <span class="n">apply</span> <span class="bp">@</span><span class="n">nat.add_left_cancel</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hq.inj_right</span> <span class="n">_</span> <span class="n">q_ne_zero</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">hqxy.symm</span> <span class="bp">▸</span> <span class="n">hx.mul</span> <span class="o">(</span><span class="n">hq.factor</span> <span class="n">hyq</span><span class="o">)),</span> <span class="o">},</span>

  <span class="k">have</span> <span class="n">hA''</span> <span class="o">:</span> <span class="n">A'.is_homogeneous</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">hA.factor</span> <span class="o">(⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">x</span> <span class="n">A'</span> <span class="bp">▸</span> <span class="n">hAxA'</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">A'</span> <span class="bp">∣</span> <span class="n">A</span><span class="o">),</span>
    <span class="n">apply</span> <span class="bp">@</span><span class="n">nat.add_left_cancel</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hA.inj_right</span> <span class="n">_</span> <span class="n">A_ne_zero</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hAxA'.symm</span> <span class="bp">▸</span> <span class="n">hx.mul</span> <span class="o">(</span><span class="n">hA.factor</span> <span class="o">(⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">x</span> <span class="n">A'</span> <span class="bp">▸</span> <span class="n">hAxA'</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">A'</span> <span class="bp">∣</span> <span class="n">A</span><span class="o">)),</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">A'_ne_zero</span> <span class="o">:</span> <span class="n">A'</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">apply</span> <span class="n">A_ne_zero</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hAxA'</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">],</span> <span class="o">},</span>

  <span class="k">have</span> <span class="n">A'_inv</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">K</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">A'_mul</span> <span class="o">:</span> <span class="n">A'_inv</span> <span class="bp">*</span> <span class="n">A'</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="c1">-- inverse of a nonzero constant?</span>

  <span class="k">have</span> <span class="n">hyc</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">c</span><span class="o">,</span>
  <span class="o">{</span> <span class="k">have</span> <span class="n">H''</span> <span class="o">:</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">y</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A'_inv</span> <span class="bp">*</span> <span class="n">B</span><span class="o">),</span>
    <span class="n">symmetry</span><span class="o">,</span>
    <span class="k">calc</span> <span class="n">y</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A'_inv</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="bp">=</span> <span class="n">A'_inv</span> <span class="bp">*</span> <span class="o">(</span><span class="n">B</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span>  <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span>
                      <span class="bp">...</span> <span class="bp">=</span> <span class="n">A'_inv</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A'</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">H'</span>
                      <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="n">A'_inv</span> <span class="bp">*</span> <span class="n">A'</span><span class="o">)</span> <span class="bp">*</span> <span class="n">c</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span>
                      <span class="bp">...</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">c</span>             <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">A'_mul</span>
                      <span class="bp">...</span> <span class="bp">=</span> <span class="n">c</span>                 <span class="o">:</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">H''</span><span class="o">⟩,</span> <span class="o">},</span>

  <span class="n">exact</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="o">,</span> <span class="n">hyq</span><span class="o">,</span> <span class="n">hyc</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="278386596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278386596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278386596">(Apr 09 2022 at 04:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="391579">Jake Levinson</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Working.20with.20polynomial.20factorizations/near/278378124">said</a>:</p>
<blockquote>
<p>I'm taking a look, but I don't know this part of mathlib at all. For example, where do I find the lemma that <code>{σ : Type} {a b c : mv_polynomial σ K} 
  (ha : a ≠ 0) (H : a * b = a * c) : b = c</code>?</p>
</blockquote>
<p>It's <a href="https://leanprover-community.github.io/mathlib_docs/find/cancel_monoid_with_zero.mul_left_cancel_of_ne_zero">docs#cancel_monoid_with_zero.mul_left_cancel_of_ne_zero</a>; the instance should be automatic for a domain or field K.</p>



<a name="278392352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Working%20with%20polynomial%20factorizations/near/278392352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake Levinson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Working.20with.20polynomial.20factorizations.html#278392352">(Apr 09 2022 at 06:52)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="224323">@Junyan Xu</span> . I've golfed it a little more. Should I edit my post above or post a fresh version?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>