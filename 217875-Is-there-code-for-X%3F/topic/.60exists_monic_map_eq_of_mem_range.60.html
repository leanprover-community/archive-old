---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html">`exists_monic_map_eq_of_mem_range`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="291538025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291538025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291538025">(Aug 01 2022 at 06:56)</a>:</h4>
<p>Do we have this somewhere?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.eval</span>

<span class="kd">lemma</span> <span class="n">exists_monic_map_eq_of_mem_range</span> <span class="o">{</span><span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→+*</span> <span class="n">S</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">S</span><span class="o">}</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">polynomial.map_ring_hom</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">range</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hp'</span> <span class="o">:</span> <span class="n">p.monic</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">p'</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">),</span> <span class="n">p'.monic</span> <span class="bp">∧</span> <span class="n">p'.map</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="291539082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291539082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291539082">(Aug 01 2022 at 07:13)</a>:</h4>
<p>I just proved this a while ago, see <a href="https://gist.github.com/alreadydone/ab2de3d78ca1288ff96456d4c799b6ee">this gist</a>. Feel free to PR!<br>
<span class="user-mention silent" data-user-id="224323">Junyan Xu</span> <a href="#narrow/stream/330515-LftCM22/topic/quadratic.20fields/near/289810340">said</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_map_of_frange_subset_srange</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">B</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">B</span><span class="o">)</span>
  <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">B</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">p.frange</span> <span class="bp">⊆</span> <span class="o">(</span><span class="n">f.srange</span> <span class="o">:</span> <span class="n">set</span> <span class="n">B</span><span class="o">))</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">q</span> <span class="o">:</span> <span class="n">A</span><span class="o">[</span><span class="n">X</span><span class="o">],</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">q.map</span> <span class="n">f</span> <span class="bp">∧</span> <span class="n">q.nat_degree</span> <span class="bp">=</span> <span class="n">p.nat_degree</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">p.monic</span> <span class="bp">→</span> <span class="n">q.monic</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div>
<p>Its proof would be much easier if <code>f</code> is injective because <code>f.srange</code> would then be isomorphic to A and we can use <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.map">docs#polynomial.map</a>. I might PR them some time but feel free to PR them for me if you need the result soon.</p>
</blockquote>



<a name="291541667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291541667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291541667">(Aug 01 2022 at 07:49)</a>:</h4>
<p>Ah. I am also using it to prove the same result!<br>
I think this result is slightly more general than your <code>eq_smul_is_integral_of_is_localization</code> though?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">is_localization.exists_multiple_is_integral</span> <span class="o">{</span><span class="n">R</span> <span class="n">R'</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R'</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">R'</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R'</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">is_scalar_tower</span> <span class="n">R</span> <span class="n">R'</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">submonoid</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">is_localization</span> <span class="n">M</span> <span class="n">R'</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">is_integral</span> <span class="n">R'</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">M</span><span class="o">,</span> <span class="n">is_integral</span> <span class="n">R</span> <span class="o">(</span><span class="n">m</span> <span class="bp">•</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="291544546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291544546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291544546">(Aug 01 2022 at 08:24)</a>:</h4>
<p>That's interesting! I know it has to be useful somewhere because it's mentioned in <a href="https://math.stackexchange.com/a/119134/12932">here</a>. The <code>d</code> I get from <a href="https://leanprover-community.github.io/mathlib_docs/find/is_localization.common_denom">docs#is_localization.common_denom</a> in the proof of <code>frange_scale_roots_subset_srange</code> is in M, so you just need to not forget that information to get your desired result.</p>



<a name="291659657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291659657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291659657">(Aug 02 2022 at 03:13)</a>:</h4>
<p>I found <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.lifts_and_degree_eq_and_monic">docs#polynomial.lifts_and_degree_eq_and_monic</a> when finding where the result should go for the PR.</p>



<a name="291676494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291676494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291676494">(Aug 02 2022 at 07:57)</a>:</h4>
<p>Nice find! I didn't know the file <code>lifts</code> exists. Turns out it was proven by <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> in <a href="https://github.com/leanprover-community/mathlib/pull/4796">#4796</a>, and although he saw my earlier post, he didn't point this out to me ... Maybe because he's forgotten about his own work :) or because the lemma was at the bottom of the post.</p>
<p>So it seems that <code>lifts</code> is the right way to state the lemma, and I guess you can the existing lemma directly. My lemma <code>eq_map_of_frange_subset_srange</code> subsumes <code>polynomial.mem_lifts_and_degree_eq</code> and <code>polynomial.lifts_and_degree_eq_and_monic</code> and is shorter than them combined, but is stated in a slightly different way, so it would need some work to golf the existing proofs,</p>



<a name="291678194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291678194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291678194">(Aug 02 2022 at 08:16)</a>:</h4>
<p>I added a lemma in terms of <code>nat_degree</code> and removed the <code>nontrivial</code> instance consequently. There might also be benefits of unifying all the lemma there and golf it using your approach, but I think it the result are as strong as yours for now and I refrained from doing a complete refactor. <br>
The PR is at <a href="https://github.com/leanprover-community/mathlib/pull/15809">#15809</a> (with <code>is_integral.exists_multiple_integral_of_is_localization</code>) if you are interested.</p>



<a name="291706503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291706503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291706503">(Aug 02 2022 at 13:11)</a>:</h4>
<p>I don't remember seeing your post, but it's very possible I didn't notice <code>lift</code> was relevant. In any case I am very happy if someone uses it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="291717355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291717355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291717355">(Aug 02 2022 at 14:31)</a>:</h4>
<p><a href="#narrow/stream/330515-LftCM22/topic/quadratic.20fields/near/289825974">This</a> was your reply to my earlier post; you certainly saw it but maybe not that specific part? Or because it's stated in terms of <code>frange</code> <code>srange</code> instead of <code>lifts</code> you didn't recognize.</p>
<blockquote>
<p>Since this is strictly more general than a lemma already in the library I suggest to PR it as soon as possible. Short PRs are very welcome, and generalization is usually uncontroversial, so it can be merged quickly and then it won't be your problem to maintain the proof. (Mathlib changes very quickly, so a proof working today can be broken tomorrow.)</p>
</blockquote>



<a name="291736641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291736641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291736641">(Aug 02 2022 at 16:51)</a>:</h4>
<p>You're totally right, I simply didn't think to <code>lift</code>, I am sorry!</p>



<a name="291742745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291742745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291742745">(Aug 02 2022 at 17:40)</a>:</h4>
<p>Never mind <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> I'm just hoping I knew it earlier so Andrew could save the time looking for it.</p>



<a name="291744508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60exists_monic_map_eq_of_mem_range%60/near/291744508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60exists_monic_map_eq_of_mem_range.60.html#291744508">(Aug 02 2022 at 17:55)</a>:</h4>
<p>In any case, I am very grateful that this is already in mathlib since the PR process is tedious. Thanks for the work!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>