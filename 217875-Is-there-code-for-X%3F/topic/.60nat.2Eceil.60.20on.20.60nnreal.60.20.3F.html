---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html">`nat.ceil` on `nnreal` ?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="274353230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274353230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274353230">(Mar 07 2022 at 06:06)</a>:</h4>
<p>Hey! It seems <code>nnreal</code> is not an instance of <code>floor_semiring</code>, thus making <code>nat.ceil</code> impossible. Is that right?</p>



<a name="274353854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274353854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274353854">(Mar 07 2022 at 06:18)</a>:</h4>
<p>I don't remember the axioms of a <code>floor_semiring</code>. Are you saying this is missing from mathlib? Or that there is a maths problem?</p>



<a name="274355266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274355266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274355266">(Mar 07 2022 at 06:46)</a>:</h4>
<p>That it _might_ be missing from mathlib. I'm not 100% sure it's satisfied by <code>nnreal</code> but as far as I can see, it is.</p>



<a name="274357688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274357688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274357688">(Mar 07 2022 at 07:30)</a>:</h4>
<p>PR welcome!</p>



<a name="274363121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274363121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274363121">(Mar 07 2022 at 08:51)</a>:</h4>
<p>I tried to spin something up, but I'm getting <em>lost in coercion</em>s</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">floor_semiring</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">nat.floor</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="n">ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">nat.ceil</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="n">floor_of_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span><span class="n">zlea</span><span class="o">⟩</span> <span class="n">ha</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="gr">sorry</span><span class="o">},</span>
  <span class="n">gc_floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">nat.le_floor_iff</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a.val</span> <span class="n">n</span> <span class="n">a.prop</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">aok</span> <span class="o">:</span> <span class="bp">⌊</span><span class="n">a.val</span><span class="bp">⌋₊</span> <span class="bp">=</span> <span class="bp">⌊</span><span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">⌋₊</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">leok</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">↔</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">↑</span><span class="n">n</span><span class="o">)</span> <span class="bp">≤</span> <span class="bp">↑</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">nnreal.coe_le_coe</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">leok'</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">↔</span> <span class="bp">↑</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="bp">≤</span> <span class="bp">↑</span><span class="n">a</span><span class="o">,</span> <span class="kd">by</span> <span class="gr">sorry</span><span class="o">,</span><span class="c1">--  by rw [←coe_coe] at leok,</span>
    <span class="n">rw</span> <span class="n">leok'</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">this</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="n">gc_ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">unfold</span><span class="o">,</span><span class="n">exact</span> <span class="n">nat.ceil_le</span><span class="o">}}</span> <span class="c">/-</span><span class="cm">floor_semiring.gc_ceil (a:ℝ) n,-/</span><span class="o">}</span>
</code></pre></div>



<a name="274363871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274363871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274363871">(Mar 07 2022 at 09:00)</a>:</h4>
<p>Can <code>norm_cast</code> help with the coercions?</p>



<a name="274371670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274371670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274371670">(Mar 07 2022 at 10:17)</a>:</h4>
<p>thanks! let me see</p>



<a name="274378898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274378898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274378898">(Mar 07 2022 at 11:32)</a>:</h4>
<p>This looks like a more general version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">{</span><span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">ordered_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">floor_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span> <span class="n">floor_semiring</span> <span class="o">{</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">//</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">r</span><span class="o">}</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">floor_semiring.floor</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span>
  <span class="n">ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">floor_semiring.ceil</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span>
  <span class="n">floor_of_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">floor_semiring.floor_of_neg</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">gc_floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span> <span class="n">ha</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">refine</span> <span class="o">(</span><span class="n">floor_semiring.gc_floor</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="k">from</span> <span class="n">ha</span><span class="o">))</span><span class="bp">.</span><span class="n">trans</span> <span class="n">_</span><span class="o">,</span>
    <span class="gr">sorry</span>  <span class="c1">-- `rw [←subtype.coe_le_coe, nonneg.coe_nat_cast]`, with the below</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">gc_ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">refine</span> <span class="o">(</span><span class="n">floor_semiring.gc_ceil</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">_</span><span class="o">,</span>
    <span class="gr">sorry</span>  <span class="c1">-- `rw [←subtype.coe_le_coe, nonneg.coe_nat_cast]`, with the below</span>
  <span class="kd">end</span><span class="o">}</span>
</code></pre></div>



<a name="274379001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274379001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274379001">(Mar 07 2022 at 11:34)</a>:</h4>
<p>We seem to be missing some coercion lemmas</p>



<a name="274379249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274379249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274379249">(Mar 07 2022 at 11:36)</a>:</h4>
<p>Like this one(edit: <a href="https://github.com/leanprover-community/mathlib/pull/12490">#12490</a>):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp, norm_cast]</span>
<span class="kn">protected</span> <span class="kd">lemma</span> <span class="n">nonneg.coe_nat_cast</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">ordered_semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="bp">↑</span><span class="n">n</span> <span class="o">:</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">//</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">})</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">map_nat_cast</span> <span class="o">(</span><span class="n">nonneg.coe_ring_hom</span> <span class="o">:</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">//</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">}</span> <span class="bp">→+*</span> <span class="n">α</span><span class="o">)</span> <span class="n">n</span>
</code></pre></div>



<a name="274379577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274379577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274379577">(Mar 07 2022 at 11:40)</a>:</h4>
<p>Another approach is proving the semiring analogue of <a href="https://leanprover-community.github.io/mathlib_docs/find/archimedean.floor_ring">docs#archimedean.floor_ring</a></p>



<a name="274380748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274380748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274380748">(Mar 07 2022 at 11:52)</a>:</h4>
<p><span class="user-mention" data-user-id="461830">@Rémi Bottinelli</span> the reason <code>exact nat.ceil_le</code> won't work is that it needs a <code>floor_semiring</code>. You can coerce to reals and then it works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">gc_ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="n">norm_cast</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">nat.ceil_le</span>
  <span class="kd">end</span><span class="o">,</span> <span class="o">}</span> <span class="c">/-</span><span class="cm">floor_semiring.gc_ceil (a:ℝ) n,-/</span>
</code></pre></div>



<a name="274381427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274381427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274381427">(Mar 07 2022 at 12:00)</a>:</h4>
<p>And re your original proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="k">have</span> <span class="n">leok</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">↔</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">↑</span><span class="n">n</span><span class="o">)</span> <span class="bp">≤</span> <span class="bp">↑</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">nnreal.coe_le_coe</span><span class="o">,</span>
    <span class="n">push_cast</span> <span class="n">at</span> <span class="n">leok</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">leok</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">this</span><span class="o">,</span>
</code></pre></div>



<a name="274385049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274385049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274385049">(Mar 07 2022 at 12:39)</a>:</h4>
<p>This typechecks, but I assume <span class="user-mention" data-user-id="310045">@Eric Wieser</span>'s code(!) is what one should use. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">floor_semiring</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">nat.floor</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="n">ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">nat.ceil</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="n">floor_of_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span><span class="n">zlea</span><span class="o">⟩</span> <span class="n">ha</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="k">have</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="n">nnreal.coe_lt_coe.mpr</span> <span class="n">ha</span><span class="o">,</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">zlea</span><span class="o">,</span><span class="n">this</span><span class="o">],},</span>
  <span class="n">gc_floor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span> <span class="n">h</span><span class="o">,</span> <span class="kd">by</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">↔</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">↑</span><span class="n">n</span><span class="o">)</span> <span class="bp">≤</span> <span class="bp">↑</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">nnreal.coe_le_coe</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">apply_mod_cast</span>  <span class="bp">@</span><span class="n">nat.le_floor_iff</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="n">n</span> <span class="n">a.prop</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="n">gc_ceil</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">unfold</span><span class="o">,</span><span class="n">exact_mod_cast</span> <span class="bp">@</span><span class="n">nat.ceil_le</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="n">n</span><span class="o">}}</span>
</code></pre></div>



<a name="274386500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274386500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274386500">(Mar 07 2022 at 12:53)</a>:</h4>
<p>As I say, I think you should deduce it from <code>archimedean</code></p>



<a name="274386750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274386750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274386750">(Mar 07 2022 at 12:55)</a>:</h4>
<p>That would have worse defeqs, wouldn't it?</p>



<a name="274386790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274386790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274386790">(Mar 07 2022 at 12:55)</a>:</h4>
<p>Probably. Is there some <code>copy</code> trick you can do?</p>



<a name="274386912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274386912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274386912">(Mar 07 2022 at 12:56)</a>:</h4>
<p>What statement are you proposing, Kevin?</p>



<a name="274386996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274386996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274386996">(Mar 07 2022 at 12:57)</a>:</h4>
<p>This I assume?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">archimedean.floor_semiring</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">[</span><span class="n">linear_ordered_semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">archimedean</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
<span class="n">floor_semiring</span> <span class="n">α</span>
</code></pre></div>



<a name="274387055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274387055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274387055">(Mar 07 2022 at 12:57)</a>:</h4>
<p>That would probably be nice to have, and a nice PR to make; but I think the <code>nonneg.floor_semiring</code> instance above is the one we ultimately want to put on <code>nnreal</code>.</p>



<a name="274388953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274388953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274388953">(Mar 07 2022 at 13:12)</a>:</h4>
<p>Would such a def/instance be doable without auxiliary lemmas? As far as I can see, you'd have to replicate many of the ones needed for <code>floor_ring</code> to deal with <code>nat</code> instead of <code>int</code>.</p>



<a name="274391567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274391567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274391567">(Mar 07 2022 at 13:34)</a>:</h4>
<p>Presumably those auxiliary lemmas either already exist, or ought to</p>



<a name="274394333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274394333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274394333">(Mar 07 2022 at 13:56)</a>:</h4>
<p>I wrote <code>floor_semiring</code> specifically for <code>ℝ≥0</code> but indeed it looks like I forgot to actually add the instance!</p>



<a name="274395533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274395533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274395533">(Mar 07 2022 at 14:05)</a>:</h4>
<p>I guess we'll want it for <code>nnrat</code> too eventually</p>



<a name="274395734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274395734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274395734">(Mar 07 2022 at 14:06)</a>:</h4>
<p>Yup. Working on it!</p>



<a name="274414302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60nat.ceil%60%20on%20%60nnreal%60%20%3F/near/274414302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F.html#274414302">(Mar 07 2022 at 16:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/.60nat.2Eceil.60.20on.20.60nnreal.60.20.3F/near/274394333">said</a>:</p>
<blockquote>
<p>I wrote <code>floor_semiring</code> specifically for <code>ℝ≥0</code> but indeed it looks like I forgot to actually add the instance!</p>
</blockquote>
<p>Added in <a href="https://github.com/leanprover-community/mathlib/pull/12495">#12495</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>