---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html">with_zero (multiplicative A) ≃* multiplicative (with_bot A)</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272980650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272980650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272980650">(Feb 23 2022 at 17:20)</a>:</h4>
<p>Do we have something like this anywhere?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">section</span>
<span class="kn">local</span> <span class="kn">attribute</span> <span class="o">[</span><span class="n">reducible</span><span class="o">]</span> <span class="n">with_zero</span>

<span class="kd">def</span> <span class="n">with_zero.to_additive</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">with_zero</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">A</span><span class="o">)</span> <span class="bp">≃*</span> <span class="n">multiplicative</span> <span class="o">(</span><span class="n">with_bot</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">exact</span> <span class="n">mul_equiv.refl</span> <span class="n">_</span>
<span class="kd">end</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_zero.to_additive_zero</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">with_zero.to_additive</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">with_zero</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">A</span><span class="o">))</span> <span class="bp">=</span> <span class="n">multiplicative.of_add</span> <span class="bp">⊥</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_zero.to_additive_coe</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">multiplicative</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">with_zero.to_additive</span> <span class="bp">↑</span><span class="n">x</span> <span class="bp">=</span> <span class="n">multiplicative.of_add</span> <span class="o">(</span><span class="n">x.to_add</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_zero.to_additive_symm_bot</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">with_zero.to_additive.symm</span> <span class="o">(</span><span class="n">multiplicative.of_add</span> <span class="o">(</span><span class="bp">⊥</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">A</span><span class="o">))</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_zero.to_additive_coe_of_add</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">with_zero.to_additive.symm</span> <span class="o">(</span><span class="n">multiplicative.of_add</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">A</span><span class="o">))</span> <span class="bp">=</span>
    <span class="n">multiplicative.of_add</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="272981162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272981162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272981162">(Feb 23 2022 at 17:23)</a>:</h4>
<p>I ask because this combined with <a href="https://github.com/leanprover-community/mathlib/pull/8889">#8889</a> gives an <code>if</code>-free definition of <a href="https://github.com/leanprover-community/mathlib/pull/12245">#12245</a>'s</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">infty_valuation_def</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ratfunc</span> <span class="n">Fq</span><span class="o">)</span> <span class="o">:</span> <span class="n">with_zero</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">with_zero.to_additive.symm</span> <span class="bp">$</span>
  <span class="n">multiplicative.of_add</span> <span class="o">(</span><span class="n">r.num.degree.map</span> <span class="n">coe</span> <span class="bp">-</span> <span class="n">r.denom.degree.map</span> <span class="n">coe</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">ℤ</span><span class="o">)</span>
</code></pre></div>
<p>(cc <span class="user-mention" data-user-id="406490">@María Inés de Frutos Fernández</span>)</p>



<a name="272986350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272986350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> María Inés de Frutos Fernández <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272986350">(Feb 23 2022 at 17:53)</a>:</h4>
<p>As far as I know this is not in mathlib.<br>
I think it would be nice to have the <code>with_top</code> version of this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">with_zero.to_additive</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">with_zero</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">A</span><span class="o">)</span> <span class="bp">≃*</span> <span class="n">multiplicative</span> <span class="o">(</span><span class="n">with_top</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">exact</span> <span class="n">mul_equiv.refl</span> <span class="n">_</span>
</code></pre></div>
<p>It might help to easily relate the <code>valuation</code> <code>infty_valuation</code> with its associated <code>add_valuation</code> (and more generally for other nonarchimedean valuations).</p>



<a name="272986650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272986650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> María Inés de Frutos Fernández <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272986650">(Feb 23 2022 at 17:55)</a>:</h4>
<p>Currently in mathlib we seem to have more API for <code>valuation</code> and <code>with_zero</code> than for <code>add_valuation</code> and <code>with_top</code>, so I just use <code>valuation</code>, but it would be nice if there were a simple way to convert from one to the other.</p>



<a name="272993616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272993616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272993616">(Feb 23 2022 at 18:42)</a>:</h4>
<p><del>You're right, <code>with_top</code> is probably the right choice, not <code>with_bot</code>, since that also makes this  preserve the ordering relation.</del></p>



<a name="272993829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272993829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272993829">(Feb 23 2022 at 18:44)</a>:</h4>
<p>I retract that comment, <code>with_bot</code> is the one that preserves order after all</p>



<a name="272994434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272994434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272994434">(Feb 23 2022 at 18:49)</a>:</h4>
<p>With valuations in particular, Maria's convention is the useful one, because additive valuations like "v(n) = the highest power of p dividing n" have v(0)=+∞ and when converting to a multiplicative valuation you reverse the order.</p>



<a name="272994620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272994620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272994620">(Feb 23 2022 at 18:51)</a>:</h4>
<p>v_mult(n)=e^v_add(n) with 0&lt;e&lt;1 (traditionally e=1/p)</p>



<a name="272994889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272994889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272994889">(Feb 23 2022 at 18:53)</a>:</h4>
<p>I can't quite make the precise connection between your comment and my isomorphism above, although I can believe it's there</p>



<a name="272995072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272995072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272995072">(Feb 23 2022 at 18:54)</a>:</h4>
<p>If G is a totally ordered abelian group then with_bot G and with_top G are order isomorphic via <code>inv</code>.</p>



<a name="272995133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272995133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272995133">(Feb 23 2022 at 18:55)</a>:</h4>
<p>Yes, so I think I'd argue you should be chaining the equiv I suggest above with such an <code>inv</code> order isomorphism</p>



<a name="272995192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272995192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272995192">(Feb 23 2022 at 18:55)</a>:</h4>
<p>I guess we have <a href="https://leanprover-community.github.io/mathlib_docs/find/order_iso.inv">docs#order_iso.inv</a> but no <code>with_*</code> version?</p>



<a name="272995418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272995418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272995418">(Feb 23 2022 at 18:57)</a>:</h4>
<p>Hmm, I still think I'm missing something - <code>order_iso.inv : G ≃o order_dual G</code>, so either the total order changes things in a way I can't see, or you mean that <code>with_top G ≃o with_bot (order_dual G)</code> via inv.</p>



<a name="272995954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272995954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272995954">(Feb 23 2022 at 19:01)</a>:</h4>
<p>You're rght -- there is an unsolvable "op" problem here. Additive valuations have the axiom v(ab)&gt;= min v(a) v(b) and multiplicative valuations have the axiom v(ab) &lt;= max v(a) v(b) and this is already culturally embedded. This is what's behind Maria's comment.</p>



<a name="272997578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272997578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272997578">(Feb 23 2022 at 19:13)</a>:</h4>
<p>Right, so there's an <code>order_dual</code> hiding in the difference too</p>



<a name="272998880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272998880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272998880">(Feb 23 2022 at 19:24)</a>:</h4>
<p>It took me forever, but I think you're describing <code>foo</code> or <code>bar</code> in:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.order.group</span>
<span class="kn">import</span> <span class="n">control.equiv_functor</span>

<span class="kd">def</span> <span class="n">order_iso.with_bot_dual</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_le</span> <span class="n">G</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">order_dual</span> <span class="o">(</span><span class="n">with_top</span> <span class="n">G</span><span class="o">)</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">with_bot</span> <span class="o">(</span><span class="n">order_dual</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">order_iso.refl</span> <span class="n">_</span>

<span class="kd">def</span> <span class="n">order_iso.with_top_dual</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_le</span> <span class="n">G</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">order_dual</span> <span class="o">(</span><span class="n">with_bot</span> <span class="n">G</span><span class="o">)</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">with_top</span> <span class="o">(</span><span class="n">order_dual</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">order_iso.refl</span> <span class="n">_</span>

<span class="kd">def</span> <span class="n">order_iso.with_top</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">with_top</span> <span class="n">α</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">with_top</span> <span class="n">β</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_equiv</span> <span class="o">:=</span> <span class="k">show</span> <span class="n">option</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">option</span> <span class="n">β</span><span class="o">,</span> <span class="k">from</span> <span class="n">equiv_functor.map_equiv</span> <span class="n">_</span> <span class="n">e</span><span class="o">,</span>
  <span class="n">map_rel_iff'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">y</span><span class="bp">;</span>
      <span class="n">dsimp</span> <span class="o">[</span><span class="n">equiv_functor.map_equiv</span><span class="o">,</span> <span class="n">equiv_functor.map</span><span class="o">]</span><span class="bp">;</span>
      <span class="n">dsimp</span> <span class="o">[</span><span class="n">with_top.none_eq_top</span><span class="o">,</span> <span class="n">with_top.some_eq_coe</span><span class="o">]</span><span class="bp">;</span>
      <span class="n">try</span> <span class="o">{</span><span class="n">simp</span><span class="o">},</span>
    <span class="n">exact</span> <span class="n">e.map_rel_iff</span><span class="o">,</span>
  <span class="kd">end</span> <span class="o">}</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">G</span><span class="o">]</span>
  <span class="o">[</span><span class="n">covariant_class</span> <span class="n">G</span> <span class="n">G</span> <span class="o">(</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="bp">≤</span><span class="o">)]</span>
  <span class="o">[</span><span class="n">covariant_class</span> <span class="n">G</span> <span class="n">G</span> <span class="o">(</span><span class="n">function.swap</span> <span class="o">(</span><span class="bp">*</span><span class="o">))</span> <span class="o">(</span><span class="bp">≤</span><span class="o">)]</span>

<span class="kd">def</span> <span class="n">bar</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">G</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">with_top</span> <span class="o">(</span><span class="n">order_dual</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">order_iso.with_top</span> <span class="o">(</span><span class="n">order_iso.inv</span> <span class="n">G</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">G</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">order_dual</span> <span class="o">(</span><span class="n">with_bot</span> <span class="n">G</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">bar.trans</span> <span class="n">order_iso.with_top_dual.symm</span>
</code></pre></div>



<a name="272999313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999313">(Feb 23 2022 at 19:27)</a>:</h4>
<p>Right! We use <code>foo</code> and then <code>to_additive</code> when translating from mult to add</p>



<a name="272999511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999511">(Feb 23 2022 at 19:29)</a>:</h4>
<p>Oh duh, did I forget to add the above <code>with_top</code>/<code>with_bot</code> equivalences?</p>



<a name="272999590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999590">(Feb 23 2022 at 19:29)</a>:</h4>
<p>The other important one we're missing is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">order_iso.with_top</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">has_le</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_le</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">with_top</span> <span class="n">α</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">with_top</span> <span class="n">β</span> <span class="o">:=</span>
</code></pre></div>



<a name="272999808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999808">(Feb 23 2022 at 19:31)</a>:</h4>
<p>Have a look at <a href="https://github.com/leanprover-community/mathlib/pull/11677">#11677</a> <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="272999889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999889">(Feb 23 2022 at 19:31)</a>:</h4>
<p>I needed those for <a href="https://leanprover-community.github.io/mathlib_docs/find/lattice_hom">docs#lattice_hom</a> in order to construct the free functor from <code>Lattice</code> to <code>BoundedLattice</code>.</p>



<a name="272999948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/272999948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#272999948">(Feb 23 2022 at 19:32)</a>:</h4>
<p>I don't see the <code>order_iso</code> version there</p>



<a name="273000107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273000107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273000107">(Feb 23 2022 at 19:33)</a>:</h4>
<p>No, it's not there, but I was about to add it</p>



<a name="273000859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273000859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273000859">(Feb 23 2022 at 19:39)</a>:</h4>
<p>I edited it above</p>



<a name="273000931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273000931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273000931">(Feb 23 2022 at 19:40)</a>:</h4>
<p>The proof is gross, we should probably have an <code>equiv_functor</code> instance for <code>with_top</code></p>



<a name="273034629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273034629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273034629">(Feb 24 2022 at 01:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/with_zero.20.28multiplicative.20A.29.20.E2.89.83*.20multiplicative.20.28with_bot.20A.29/near/272998880">said</a>:</p>
<blockquote>
<p>It took me forever, but I think you're describing <code>foo</code> or <code>bar</code> in:<br>
&lt;snip&gt;</p>
</blockquote>
<p>I PR'd these three isos in <a href="https://github.com/leanprover-community/mathlib/pull/12264">#12264</a></p>



<a name="273117557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273117557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273117557">(Feb 24 2022 at 16:58)</a>:</h4>
<p>The last pieces are in <a href="https://github.com/leanprover-community/mathlib/pull/12275">#12275</a>. I'm not sure exactly how useful these are, but I think with all of them together you can push the type tags around while preserving structure.</p>



<a name="273118098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273118098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273118098">(Feb 24 2022 at 17:01)</a>:</h4>
<p>You should definitely have a look at <a href="https://github.com/leanprover-community/mathlib/tree/GroupWithZero">branch#GroupWithZero</a></p>



<a name="273120123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273120123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273120123">(Feb 24 2022 at 17:15)</a>:</h4>
<p>Is there any overlap? I don't see it</p>



<a name="273122304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273122304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273122304">(Feb 24 2022 at 17:30)</a>:</h4>
<p>My <code>monoid_hom.with_zero</code> is very close to your <code>mul_equiv.with_zero_congr</code>.</p>



<a name="273126075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273126075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273126075">(Feb 24 2022 at 17:58)</a>:</h4>
<p>It's also very close to the <a href="https://leanprover-community.github.io/mathlib_docs/find/with_zero.map">docs#with_zero.map</a> we already have, right?</p>



<a name="273142029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/with_zero%20%28multiplicative%20A%29%20%E2%89%83%2A%20multiplicative%20%28with_bot%20A%29/near/273142029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/with_zero.20(multiplicative.20A).20.E2.89.83*.20multiplicative.20(with_bot.20A).html#273142029">(Feb 24 2022 at 20:01)</a>:</h4>
<p>Yeah</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>