---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html">filter.has_scalar missing?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275381919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275381919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275381919">(Mar 15 2022 at 14:42)</a>:</h4>
<p>I was surprised that this does not exists yet, given that we have filter.has_mul, filter.has_add and so on. Or maybe it's hidden somewhere where I can't find it? Should I make a PR?</p>



<a name="275382645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275382645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275382645">(Mar 15 2022 at 14:46)</a>:</h4>
<p>filter.has_inv also seems to be missing.</p>



<a name="275468766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275468766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275468766">(Mar 16 2022 at 05:24)</a>:</h4>
<p>If you're going to edit this file, then please add missing docstrings as well.</p>



<a name="275484183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275484183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275484183">(Mar 16 2022 at 09:19)</a>:</h4>
<p>I'm filling in similar gaps in <a href="https://tqft.net/mathlib/algebra/pointwise">file#algebra/pointwise</a> in <a href="https://github.com/leanprover-community/mathlib/pull/12694">#12694</a> if that draws inspiration. I can also just do it if you do not feel like it.</p>



<a name="275530398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275530398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275530398">(Mar 16 2022 at 15:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/filter.2Ehas_scalar.20missing.3F/near/275484183">said</a>:</p>
<blockquote>
<p>I'm filling in similar gaps in <a href="https://tqft.net/mathlib/algebra/pointwise">file#algebra/pointwise</a> in <a href="https://github.com/leanprover-community/mathlib/pull/12694">#12694</a> if that draws inspiration. I can also just do it if you do not feel like it.</p>
</blockquote>
<p>Pretty please.</p>



<a name="275740617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275740617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275740617">(Mar 17 2022 at 23:10)</a>:</h4>
<p>Preliminatory work in <a href="https://github.com/leanprover-community/mathlib/pull/12789">#12789</a></p>



<a name="275928076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/275928076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#275928076">(Mar 19 2022 at 20:30)</a>:</h4>
<p>It looks like we can streamline the definitions. Having a think...</p>



<a name="276723885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276723885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276723885">(Mar 26 2022 at 12:32)</a>:</h4>
<p>So I see that your PR was merged with a TODO. Are you still working on it? If not, I could make a PR with stuff that I have already regarding smul and inv.</p>



<a name="276723898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276723898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276723898">(Mar 26 2022 at 12:32)</a>:</h4>
<p>Yes I am :)</p>



<a name="276723908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276723908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276723908">(Mar 26 2022 at 12:33)</a>:</h4>
<p>I figured that we could significantly shorten the API by writing constructors in terms of <a href="https://leanprover-community.github.io/mathlib_docs/find/sup_bot_hom">docs#sup_bot_hom</a>.</p>



<a name="276724066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276724066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276724066">(Mar 26 2022 at 12:37)</a>:</h4>
<p>Alright, thanks. Can you elaborate on how you plan to use sup_bot_hom?</p>



<a name="276724212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276724212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276724212">(Mar 26 2022 at 12:40)</a>:</h4>
<p>If you have a look at <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.has_mul">docs#filter.has_mul</a>, you see that the reason the definition works is that <code>(s₁ ∪ s₂) * t = s₁ * t ∪ s₂ * t</code>, <code>s * (t₁ ∪ t₂) = s * t₁ ∪ s * t₂</code>, <code>∅ * s = ∅</code>, <code>s * ∅ = ∅</code>. Hence you can replace <code>(*)</code> by any <code>f : sup_bot_hom (set α) (sup_bot_hom (set β) (set γ))</code> and it will just work.</p>



<a name="276724298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276724298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276724298">(Mar 26 2022 at 12:42)</a>:</h4>
<p>Interesting. So it should also work in the case of smul since smul is supremum-preserving?</p>



<a name="276724319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276724319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276724319">(Mar 26 2022 at 12:43)</a>:</h4>
<p>Exactly! And <code>neg</code>, and <code>inv</code> (with a unary variant)...</p>



<a name="276724444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276724444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276724444">(Mar 26 2022 at 12:46)</a>:</h4>
<p>Great. Looking forward to it.</p>



<a name="276925646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276925646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276925646">(Mar 28 2022 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="416322">@Bernd Losert</span>, is there anything that you want which is not on <a href="https://github.com/leanprover-community/mathlib/tree/more_filter_pointwise">branch#more_filter_pointwise</a>? For example, more stuff analogous to <a href="https://tqft.net/mathlib/data/set/pointwise">file#data/set/pointwise</a></p>



<a name="276928642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276928642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276928642">(Mar 28 2022 at 20:43)</a>:</h4>
<p>Great work! You have a lot of stuff that I need. Here's one I don't see:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">set.smul_subset_smul_left</span> <span class="o">[</span><span class="n">has_scalar</span> <span class="n">M</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">t</span> <span class="n">t'</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">}</span>
  <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hsub</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">⊆</span> <span class="n">t'</span><span class="o">)</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">•</span> <span class="n">s</span> <span class="bp">⊆</span> <span class="n">t'</span> <span class="bp">•</span> <span class="n">s</span>
</code></pre></div>
<p>but I guess we can get that one using <code>set.image2_subset_left</code>? Here's another, which actually took me a while to prove:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">filter.inv_smul_of_smul</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">mul_action</span> <span class="n">G</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">G</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">f'</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hle</span> <span class="o">:</span> <span class="n">f'</span> <span class="bp">≤</span> <span class="n">g</span> <span class="bp">•</span> <span class="n">f</span><span class="o">)</span> <span class="o">[</span><span class="n">hf'</span> <span class="o">:</span> <span class="n">f'.ne_bot</span><span class="o">]</span> <span class="o">:</span> <span class="o">((</span><span class="n">g</span><span class="bp">⁻¹</span> <span class="bp">•</span> <span class="n">f'</span><span class="o">)</span> <span class="bp">⊓</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">ne_bot</span> <span class="o">:=</span>
</code></pre></div>



<a name="276931864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276931864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276931864">(Mar 28 2022 at 21:12)</a>:</h4>
<p>Oh I can add that first one real quick.</p>



<a name="276932059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/276932059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#276932059">(Mar 28 2022 at 21:13)</a>:</h4>
<p>I am not quite sure the second one should be a lemma. I feel like we could split it down. Also, it weirdly mixes instance and explicit <code>ne_bot</code> arguments.</p>



<a name="277040562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277040562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277040562">(Mar 29 2022 at 17:36)</a>:</h4>
<p>Yeah, I guess I am confused about whether ne_bot should be instance arguments or regular arguments since mathlib sometimes does one or the other or both.</p>



<a name="277040816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277040816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277040816">(Mar 29 2022 at 17:38)</a>:</h4>
<p>In any case, the second lemma is a very peculiar result that I needed for proving another more interesting result.</p>



<a name="277144235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277144235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277144235">(Mar 30 2022 at 13:29)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13062">#13062</a> for the first half</p>



<a name="277760967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277760967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277760967">(Apr 04 2022 at 16:52)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/13170">#13170</a> for the second half</p>



<a name="277763111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277763111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277763111">(Apr 04 2022 at 17:05)</a>:</h4>
<p>I was just looking at that. Looks really nice.</p>



<a name="277773159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773159">(Apr 04 2022 at 18:15)</a>:</h4>
<p>Glad you like it!</p>



<a name="277773533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773533">(Apr 04 2022 at 18:18)</a>:</h4>
<p>Can't you use <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.bind">docs#filter.bind</a> for these map constructions?</p>



<a name="277773646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773646">(Apr 04 2022 at 18:19)</a>:</h4>
<p>I would be eager to know how, because <a href="https://github.com/leanprover-community/mathlib/pull/13170">#13170</a> was all about adding seminontrivial API.</p>



<a name="277773728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773728">(Apr 04 2022 at 18:20)</a>:</h4>
<p>Can't you use <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.bind">docs#filter.bind</a> for these map constructions?</p>



<a name="277773893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773893">(Apr 04 2022 at 18:21)</a>:</h4>
<p>(sorry for the duplication. I'm on mobile with my university's "very good" wifi)</p>



<a name="277773953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/277773953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#277773953">(Apr 04 2022 at 18:21)</a>:</h4>
<p>Note that we care about definitional equality. My <code>filter.map₂</code> allows you to get the basically simplest condition.</p>



<a name="278682757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278682757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278682757">(Apr 12 2022 at 12:05)</a>:</h4>
<p><span class="user-mention" data-user-id="416322">@Bernd Losert</span>, there you have it!</p>



<a name="278715939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278715939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278715939">(Apr 12 2022 at 16:16)</a>:</h4>
<p>Awesome. Thank you so much. I will update my code.</p>



<a name="278715996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278715996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278715996">(Apr 12 2022 at 16:16)</a>:</h4>
<p>Sorry it took near a month. mathlib do be like that.</p>



<a name="278763664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278763664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278763664">(Apr 12 2022 at 22:49)</a>:</h4>
<p>No worries. I'm having a some trouble using lemmas like <code>filter.mem_inv</code>. The lemma that I was using was this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">filter.mem_inv_iff</span> <span class="o">[</span><span class="n">has_inv</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">s</span> <span class="bp">∈</span> <span class="n">f</span><span class="bp">⁻¹</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">f</span><span class="o">,</span> <span class="n">t</span><span class="bp">⁻¹</span> <span class="bp">⊆</span> <span class="n">s</span>
</code></pre></div>
<p>What's the easiest way to get this result from <code>filter.mem_inv</code>?</p>



<a name="278763916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278763916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278763916">(Apr 12 2022 at 22:52)</a>:</h4>
<p>You can instantiate <code>t</code> to be <code>s⁻¹</code>.</p>



<a name="278764771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278764771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278764771">(Apr 12 2022 at 23:02)</a>:</h4>
<p>Sorry, I don't follow.</p>



<a name="278764966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278764966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278764966">(Apr 12 2022 at 23:05)</a>:</h4>
<p>Also, I'm getting this error in one of my proofs:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">uncurry</span> <span class="n">has_scalar.smul</span><span class="o">)</span> <span class="o">(</span><span class="n">map</span> <span class="n">has_inv.inv</span> <span class="n">g</span> <span class="bp">×ᶠ</span> <span class="bp">↑</span><span class="n">k'</span><span class="o">))</span><span class="bp">.</span><span class="n">ne_bot</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="o">(</span><span class="n">g</span><span class="bp">⁻¹</span> <span class="bp">•</span> <span class="bp">↑</span><span class="n">k'</span><span class="o">)</span><span class="bp">.</span><span class="n">ne_bot</span>
</code></pre></div>
<p>Are these things not definitionally equal?</p>



<a name="278765084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765084">(Apr 12 2022 at 23:06)</a>:</h4>
<p>I mean that the <code>t</code> in <code>∃ t ∈ f, t⁻¹ ⊆ s</code> can always be taken as <code>s⁻¹</code>.</p>



<a name="278765217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765217">(Apr 12 2022 at 23:08)</a>:</h4>
<p>I believe not, because I defined <a href="https://leanprover-community.github.io/mathlib_docs/find/filter">docs#filter</a>.map₂, without referring to <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.map">docs#filter.map</a>. So defeq breaking isn't that surprising. This should be a lemma about <code>map₂</code> and <code>uncurry</code>, though, and I can try writing it down if you show me your code.</p>



<a name="278765487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765487">(Apr 12 2022 at 23:12)</a>:</h4>
<blockquote>
<p>I mean that the t in ∃ t ∈ f, t⁻¹ ⊆ s can always be taken as s⁻¹.</p>
</blockquote>
<p>Ah, you're right. I will still need to create a lemma for this though. I thought I could get away with a oneliner conversion.</p>
<p>Here's the snippet from the proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">set</span> <span class="n">k</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">g</span><span class="bp">⁻¹</span> <span class="bp">•</span> <span class="bp">↑</span><span class="n">k'</span> <span class="k">with</span> <span class="n">hdef</span><span class="o">,</span>
  <span class="n">haveI</span> <span class="o">:</span> <span class="n">k.ne_bot</span> <span class="o">:=</span> <span class="n">filter.ne_bot.map</span> <span class="o">(</span><span class="n">filter.ne_bot.prod</span> <span class="o">(</span><span class="n">filter.ne_bot.map</span> <span class="n">hnb</span> <span class="n">has_inv.inv</span><span class="o">)</span> <span class="n">k'.ne_bot</span><span class="o">)</span> <span class="o">(</span><span class="n">uncurry</span> <span class="o">(</span><span class="bp">•</span><span class="o">))</span>
</code></pre></div>



<a name="278765550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765550">(Apr 12 2022 at 23:13)</a>:</h4>
<p>Why not use <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.ne_bot.smul">docs#filter.ne_bot.smul</a>?</p>



<a name="278765625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765625">(Apr 12 2022 at 23:14)</a>:</h4>
<p>Ah, cool. Let me try it with that.</p>



<a name="278765760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765760">(Apr 12 2022 at 23:16)</a>:</h4>
<p>Yep, that worked.</p>



<a name="278765762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765762">(Apr 12 2022 at 23:16)</a>:</h4>
<p>Sorry, <a href="https://leanprover-community.github.io/mathlib_docs/find/smul_ne_bot_iff">docs#smul_ne_bot_iff</a></p>



<a name="278765779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765779">(Apr 12 2022 at 23:16)</a>:</h4>
<p>Oh misread twice. That cancelled out</p>



<a name="278765959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/filter.has_scalar%20missing%3F/near/278765959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bernd Losert <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/filter.2Ehas_scalar.20missing.3F.html#278765959">(Apr 12 2022 at 23:19)</a>:</h4>
<p>Ah shucks. There are other parts of the code showing the "invalid type ascription" issue. I guess I'll have to rethink some of these proofs.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>