---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html">polynomial.comp_prod</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="276727099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727099">(Mar 26 2022 at 13:50)</a>:</h4>
<p>Dear All,</p>
<p>I am struggling to find the lemma below: I tried <code>library_search, suggest, hint</code>, looking around in relevant files, all to no avail.  I also tried seeing if the docs linkifier told me that my guessed name was the actual name, but also that failed!  Can someone please tell me what the lemma is called?</p>
<p>Or explain to me that it is false, because I still do not understand what <code>comp</code> and <code>prod</code> do?</p>
<p>Thanks!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.eval</span>

<span class="n">open_locale</span> <span class="n">polynomial</span> <span class="n">big_operators</span>

<span class="kd">lemma</span> <span class="n">polynomial.comp_prod</span> <span class="o">{</span><span class="n">ι</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ι</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">s.prod</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span> <span class="bp">=</span> <span class="bp">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="o">((</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="276727115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727115">(Mar 26 2022 at 13:51)</a>:</h4>
<p>This is becoming comical <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.prod_comp">docs#polynomial.prod_comp</a></p>



<a name="276727130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727130">(Mar 26 2022 at 13:51)</a>:</h4>
<p>It's not quite what you ask for, but the glue belongs to the realm of big operators.</p>



<a name="276727176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727176">(Mar 26 2022 at 13:52)</a>:</h4>
<p>Seriously?!?!</p>



<a name="276727190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727190">(Mar 26 2022 at 13:52)</a>:</h4>
<p>Sometimes I wonder whether formalizing math is what I should be doing...</p>



<a name="276727198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727198">(Mar 26 2022 at 13:53)</a>:</h4>
<p>Damiano, how are you looking for lemmas? My goto is the search bar in the online docs.</p>



<a name="276727285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727285">(Mar 26 2022 at 13:55)</a>:</h4>
<p>I mostly try the auto-complete, then I try stating the lemma in isolation and using library_search.  Finally, I open files that appear relevant and do a mix of Ctrl+F and browsing.</p>



<a name="276727296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727296">(Mar 26 2022 at 13:55)</a>:</h4>
<p>Anyway, at least this time I have not been able to fill in the glue right away, but I'll try harder with the lemma that you suggested!</p>



<a name="276727351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727351">(Mar 26 2022 at 13:56)</a>:</h4>
<p>ctrl+shift+f in VSCode is always nice, and you can search by name in the docs which is also worth checking</p>



<a name="276727455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727455">(Mar 26 2022 at 13:59)</a>:</h4>
<p>In this specific case, I think that my inability has been hindered by my difficulty of converting betweem finsets and multisets.  I can see that the lemma that Yaël linked is very close to what I want, I might have even glanced at it, but decided that I was unable to make it work, since it used multisets, instead of finsets.</p>



<a name="276727461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727461">(Mar 26 2022 at 13:59)</a>:</h4>
<p>Here is a follow up: how can I get Lean to construct the multiset image of the finset s under the map f?</p>



<a name="276727528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727528">(Mar 26 2022 at 14:00)</a>:</h4>
<p>and I hope that the answer is not finset.image.to_multiset or something like this!</p>



<a name="276727541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727541">(Mar 26 2022 at 14:00)</a>:</h4>
<p>(let me try that right away!)</p>



<a name="276727566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727566">(Mar 26 2022 at 14:00)</a>:</h4>
<p>wait what is the construction you want? Does the constant function send {1,2} to {x} or {x,x}? If you change a finset to a multiset you'll not get duplicates of course.</p>



<a name="276727639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727639">(Mar 26 2022 at 14:02)</a>:</h4>
<p>I was referring to the context of the lemma above: I have a finset of \iota, a map from \iota to another type and I want the "multiset image" of the map.  Thus, if the map is constant, I want a lot of the same elements in the multiset.</p>
<p>The source though has no repetitions.</p>



<a name="276727664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727664">(Mar 26 2022 at 14:03)</a>:</h4>
<p>that is, with more maths notations, I want <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>:</mo><mi>i</mi><mo>∈</mo><mi>s</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[f(i) : i \in s]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">]</span></span></span></span> as a multiset, since this is what I need to feed to the lemma that Yaël suggested.</p>



<a name="276727722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727722">(Mar 26 2022 at 14:05)</a>:</h4>
<p>Kevin, in your example, I would want <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{x,x\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">}</span></span></span></span>.</p>



<a name="276727724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727724">(Mar 26 2022 at 14:05)</a>:</h4>
<p>A <code>finset</code> is definitionally a <code>multiset</code>. <code>finset.prod s f</code> is definitionally <code>(multiset.map s f).prod</code>.</p>



<a name="276727814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727814">(Mar 26 2022 at 14:07)</a>:</h4>
<p>Yaël, thanks!  I had not tried forcing Lean to accept it: this is not elegant, but works!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.comp_prod</span> <span class="o">{</span><span class="n">ι</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ι</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">s.prod</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span> <span class="bp">=</span> <span class="bp">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="o">((</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span>
  <span class="n">convert</span> <span class="n">polynomial.prod_comp</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
<span class="o">}</span>
</code></pre></div>



<a name="276727880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727880">(Mar 26 2022 at 14:08)</a>:</h4>
<p>I had tried <code>rw</code> which failed, but I had not tried convert, since I was not hoping for defeqs!</p>



<a name="276727990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276727990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276727990">(Mar 26 2022 at 14:11)</a>:</h4>
<p>Should this lemma then go into mathlib?</p>



<a name="276728118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276728118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276728118">(Mar 26 2022 at 14:14)</a>:</h4>
<p>It doesn't seem to me that we've yet decided how much duplication between <code>multiset.prod</code> and <code>finset.prod</code> we want.</p>



<a name="276728140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276728140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276728140">(Mar 26 2022 at 14:15)</a>:</h4>
<p>Actually, you should be able to golf the above to one line without a <code>convert</code>. What does <code>(polynomial.prod_comp _ _).trans $ by library_search</code> produce?</p>



<a name="276728604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276728604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276728604">(Mar 26 2022 at 14:25)</a>:</h4>
<p>Sorry, I'm taking a break!  Will report once I'm back!</p>



<a name="276735365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276735365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276735365">(Mar 26 2022 at 17:02)</a>:</h4>
<p>I tried it now and it times out.  However, <code>library_search</code> often seems to time out for me...</p>



<a name="276735499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276735499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276735499">(Mar 26 2022 at 17:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/polynomial.2Ecomp_prod/near/276728140">said</a>:</p>
<blockquote>
<p>Actually, you should be able to golf the above to one line without a <code>convert</code>. What does <code>(polynomial.prod_comp _ _).trans $ by library_search</code> produce?</p>
</blockquote>
<p><code>by simpa</code> works at the end, but I think I made people unhappy when I admitted I used <code>simpa</code> for <code>simp</code>+<code>refl</code></p>



<a name="276736591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/polynomial.comp_prod/near/276736591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/polynomial.2Ecomp_prod.html#276736591">(Mar 26 2022 at 17:30)</a>:</h4>
<p>This is also a proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.comp_prod</span> <span class="o">{</span><span class="n">ι</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ι</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">s.prod</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span> <span class="bp">=</span> <span class="bp">∏</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="o">((</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">(</span><span class="n">polynomial.prod_comp</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">multiset.map_map</span><span class="o">],</span>
<span class="c1">-- here the goal is</span>
<span class="c1">-- (multiset.map ((λ (q : R[X]), q.comp p) ∘ f) s.val).prod.coeff n = (∏ (i : ι) in s, (f i).comp p).coeff n</span>
<span class="c1">-- and the following refl proves it</span>
  <span class="n">refl</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>