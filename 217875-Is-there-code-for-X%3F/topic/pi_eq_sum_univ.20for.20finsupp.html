---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html">pi_eq_sum_univ for finsupp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="254855076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254855076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254855076">(Sep 25 2021 at 17:15)</a>:</h4>
<p>Is there any equivalent to <a href="https://leanprover-community.github.io/mathlib_docs/find/pi_eq_sum_univ">docs#pi_eq_sum_univ</a> but for <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp">docs#finsupp</a>? I guess it could be called <code>finsupp.eq_sum_smul_single</code>, or similar.</p>



<a name="254855895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254855895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254855895">(Sep 25 2021 at 17:27)</a>:</h4>
<p>I'd expect the statement to not include a smul</p>



<a name="254856095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254856095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254856095">(Sep 25 2021 at 17:30)</a>:</h4>
<p>Something like <code> ∑ x in f.support, single x (f x) = f</code> is the statement I'd expect</p>



<a name="254856384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254856384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254856384">(Sep 25 2021 at 17:34)</a>:</h4>
<p>Interesting...</p>



<a name="254856434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254856434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254856434">(Sep 25 2021 at 17:35)</a>:</h4>
<p>While I'm there, do we not have an equivalent of <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.single_le_sum">docs#finset.single_le_sum</a>, and instances <code>pseudo_metric_space (ι →₀ ℝ)</code>, <code>topological_space (ι →₀ ℝ)</code> and similar?</p>



<a name="254856539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254856539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254856539">(Sep 25 2021 at 17:36)</a>:</h4>
<p>Are those even sensemaking? In my mind, <code>ι →₀ α</code> behaves basically like <code>ι → α</code>. But maybe I'm topologically wrong.</p>



<a name="254861426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254861426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254861426">(Sep 25 2021 at 18:51)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.sum_single">docs#finsupp.sum_single</a> is the statement</p>



<a name="254861454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254861454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254861454">(Sep 25 2021 at 18:51)</a>:</h4>
<p>Which is defeq to the version I gave above</p>



<a name="254867305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867305">(Sep 25 2021 at 20:16)</a>:</h4>
<p>Thanks! This is the lemma I wanted:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">finsupp.linear_combi_single_eq</span> <span class="o">{</span><span class="n">α</span> <span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→₀</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">f.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">•</span> <span class="n">finsupp.single</span> <span class="n">a</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">M</span><span class="o">))</span> <span class="bp">=</span> <span class="n">f</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp_rw</span> <span class="o">[</span><span class="n">finsupp.smul_single</span><span class="o">,</span> <span class="n">smul_eq_mul</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">f.sum_single</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="254867422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867422">(Sep 25 2021 at 20:18)</a>:</h4>
<p>Name suggestions are welcome.</p>



<a name="254867638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867638">(Sep 25 2021 at 20:22)</a>:</h4>
<p>(deleted)</p>



<a name="254867675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867675">(Sep 25 2021 at 20:22)</a>:</h4>
<p>Is there anything special about <code>finsupp.single a 1</code> that makes that useful?</p>



<a name="254867763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867763">(Sep 25 2021 at 20:24)</a>:</h4>
<p>Yes, it matches <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.center_mass_eq_of_sum_1">docs#finset.center_mass_eq_of_sum_1</a></p>



<a name="254867769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867769">(Sep 25 2021 at 20:24)</a>:</h4>
<p>Also I think you should have <code>b</code> instead of <code>f a</code> there</p>



<a name="254867785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867785">(Sep 25 2021 at 20:24)</a>:</h4>
<p>Because the whole point in <code>finsupp.sum f g</code> is that <code>g</code> gets called as <code>g a (f a)</code></p>



<a name="254867819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254867819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254867819">(Sep 25 2021 at 20:25)</a>:</h4>
<p>Hmm... What's that point, actually?</p>



<a name="254868026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868026">(Sep 25 2021 at 20:29)</a>:</h4>
<p>Note that I'm redefining <a href="https://leanprover-community.github.io/mathlib_docs/find/std_simplex">docs#std_simplex</a> in terms of <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp">docs#finsupp</a> and that I use this lemma at the interface with the non-<code>finsupp</code> land of <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.center_mass">docs#finset.center_mass</a>. Eventually, <code>finset.center_mass</code> will take in finsupps and maybe that weirdness will disappear?</p>



<a name="254868060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868060">(Sep 25 2021 at 20:29)</a>:</h4>
<p>The branch is <a href="https://github.com/leanprover-community/mathlib/tree/std_simplex_finsupp">branch#std_simplex_finsupp</a>. This will be of interest to <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span>.</p>



<a name="254868134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868134">(Sep 25 2021 at 20:30)</a>:</h4>
<p>(I feel like I'm hitting a wall of bricks, so help is more than welcome!)</p>



<a name="254868312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868312">(Sep 25 2021 at 20:33)</a>:</h4>
<p>I think that Eric is suggesting that you lemma should prove <code>f.sum (λ a b, b • finsupp.single a (1 : M)) = f</code> (note the <code>b</code> instead of <code>f a</code>) since <code>f.sum g</code> is the sum over <code>a</code> of <code>g a (f a)</code>.</p>



<a name="254868501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868501">(Sep 25 2021 at 20:36)</a>:</h4>
<p>Yes yes, I got that and I changed it. What I do not get is why we have <code>g a (f a)</code> in the first place, and not just <code>g a</code>.</p>



<a name="254868532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868532">(Sep 25 2021 at 20:37)</a>:</h4>
<p>Ah, is it because we have many lemmas that assume <code>h a 0 = 0</code>, or similar?</p>



<a name="254868601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868601">(Sep 25 2021 at 20:38)</a>:</h4>
<p>you are looking for something that uses only the support of <code>f</code> and not its values then? You want to sum <code>g</code> over the support of <code>f</code></p>



<a name="254868647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868647">(Sep 25 2021 at 20:39)</a>:</h4>
<p>with only <code>g a</code> and not <code>g a (f a)</code> it sounds more like a finset affair than finsupp</p>



<a name="254868659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868659">(Sep 25 2021 at 20:39)</a>:</h4>
<p>Well, I can ad hoc define <code>g' := λ a, g a (f a)</code>. That's using the values of <code>f</code>.</p>



<a name="254868696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868696">(Sep 25 2021 at 20:39)</a>:</h4>
<p>indeed, as you did in the code above. That's right.</p>



<a name="254868763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254868763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254868763">(Sep 25 2021 at 20:40)</a>:</h4>
<p>I am not very familiar with finsupp, so I don't have much to add to that :)</p>



<a name="254869438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/pi_eq_sum_univ%20for%20finsupp/near/254869438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/pi_eq_sum_univ.20for.20finsupp.html#254869438">(Sep 25 2021 at 20:50)</a>:</h4>
<p>the lemma <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.sum_add_index">docs#finsupp.sum_add_index</a> looks like a good reason for wanting the <code>g a b</code> version (for some applications)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>