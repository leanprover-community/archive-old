---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html">Pseudometric def of uniform space</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="297797815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297797815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297797815">(Sep 08 2022 at 14:48)</a>:</h4>
<p>I'm wondering about the pseudometric definition of a uniform space:<br>
<a href="https://en.wikipedia.org/wiki/Uniform_space#Pseudometrics_definition">https://en.wikipedia.org/wiki/Uniform_space#Pseudometrics_definition</a></p>
<p>I.e. the fact that any family of pseudometrics gives rise to a uniform space structure, and conversely, that any uniform space structure arises from some such family. (Of course, this converse is the more interesting direction!)</p>
<p>I'm quite sure we don't have anything like this in mathlib, but I suppose it doesn't hurt to ask.</p>
<p>Assuming we don't have this, let's also discuss how to formulate this in Lean.</p>



<a name="297803398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297803398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297803398">(Sep 08 2022 at 15:13)</a>:</h4>
<p>That sounds like seminorms to me. I suggest writing a hom type <code>pseudo_metric</code> and its corresponding hom class that would be inserted under seminorms</p>



<a name="297804560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297804560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297804560">(Sep 08 2022 at 15:18)</a>:</h4>
<p>seminorms give pseudometrics, but they're not the same.</p>



<a name="297804580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297804580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297804580">(Sep 08 2022 at 15:18)</a>:</h4>
<p>we do have <a href="https://leanprover-community.github.io/mathlib_docs/find/pseudo_metric_space">docs#pseudo_metric_space</a></p>



<a name="297804649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297804649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297804649">(Sep 08 2022 at 15:18)</a>:</h4>
<p>No, I mean this is similar to how we treat families of seminorms.</p>



<a name="297805003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297805003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297805003">(Sep 08 2022 at 15:20)</a>:</h4>
<p>what do you mean by the "corresponding hom class" of a pseudo metric?</p>



<a name="297805028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297805028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297805028">(Sep 08 2022 at 15:20)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">A</span> <span class="n">topological</span> <span class="n">vector</span> <span class="n">space</span> <span class="n">is</span> <span class="n">locally</span> <span class="n">convex</span> <span class="k">if</span> <span class="n">and</span> <span class="n">only</span> <span class="k">if</span> <span class="n">its</span> <span class="n">topology</span> <span class="n">is</span> <span class="n">induced</span> <span class="kd">by</span> <span class="n">a</span> <span class="n">family</span> <span class="n">of</span> <span class="n">seminorms.</span>
</code></pre></div>
<p>is the normed world statement that's similar to yours (cf <a href="https://en.wikipedia.org/wiki/Seminorm">Wikipedia</a>).</p>



<a name="297806498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297806498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297806498">(Sep 08 2022 at 15:27)</a>:</h4>
<p>Anyway, I don't think introducing a whole new type of pseudo-metrics is necessary. We can just talk about families of terms of <a href="https://leanprover-community.github.io/mathlib_docs/find/pseudo_metric_space">docs#pseudo_metric_space</a></p>



<a name="297814971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297814971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297814971">(Sep 08 2022 at 16:06)</a>:</h4>
<p>Why are you interested in this definition of uniform structures?</p>



<a name="297819063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297819063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297819063">(Sep 08 2022 at 16:27)</a>:</h4>
<p>Specifically, I have a situation with a (uniform) topological ring (satisfying some additional hypotheses which I won't spell out) and I would like to relate it to valuation theory. One reasonable first step is to consider such a family of pseudometrics which give the uniform structure. (The way such a thing is usually related to valuation theory in the literature is somewhat different, but I would like to see whether this approach would offer a cleaner formalization.)</p>



<a name="297823360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297823360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297823360">(Sep 08 2022 at 16:49)</a>:</h4>
<p>We don’t need anything new to formulate this</p>



<a name="297823403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297823403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297823403">(Sep 08 2022 at 16:49)</a>:</h4>
<p>yeah I agree.</p>



<a name="297823539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297823539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297823539">(Sep 08 2022 at 16:50)</a>:</h4>
<p>The uniform space defined by a family of pseudo metrics is juste the infimum of the uniform spaces for each pseudo metric right ?</p>



<a name="297823601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297823601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297823601">(Sep 08 2022 at 16:50)</a>:</h4>
<p>Yes, I think that's right.</p>



<a name="297824340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297824340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297824340">(Sep 08 2022 at 16:54)</a>:</h4>
<p>Actually a similar thing could have been done for seminorms, we just have to take the infimum of the topologies generated by each one individually. But we need <a href="https://leanprover-community.github.io/mathlib_docs/find/with_seminorms">docs#with_seminorms</a> because saying « this topology is generated by these seminorms » is extremely frequent, but I don’t think that is the case for pseudo metrics, is that right?</p>



<a name="297824851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297824851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297824851">(Sep 08 2022 at 16:57)</a>:</h4>
<p>I think I remember seeing the proof of it in Bourbaki but I’m not home and my iPad has no battery left…</p>



<a name="297825493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297825493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297825493">(Sep 08 2022 at 17:00)</a>:</h4>
<p>It is indeed in Bourbaki</p>



<a name="297825573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297825573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297825573">(Sep 08 2022 at 17:00)</a>:</h4>
<p>From wiki: <code>Bourbaki: General Topology Chapter IX §1 no. 4</code></p>



<a name="297837350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297837350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297837350">(Sep 08 2022 at 18:03)</a>:</h4>
<p>Oh but we almost have it, give me a few minutes</p>



<a name="297838405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297838405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297838405">(Sep 08 2022 at 18:09)</a>:</h4>
<p>Okay maybe a bit more than a few minutes but it should definitely not be too hard</p>



<a name="297855180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297855180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297855180">(Sep 08 2022 at 19:55)</a>:</h4>
<p>Ok so this is <strong><em>extremely</em></strong> ugly and impractical to use, but basically here is the proof : </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">topology.metric_space.metrizable_uniformity</span>

<span class="kn">open</span> <span class="n">set</span> <span class="n">topological_space</span>
<span class="n">open_locale</span> <span class="n">uniformity</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">D</span> <span class="o">:</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span> <span class="o">(</span><span class="n">pseudo_metric_space</span> <span class="n">X</span><span class="o">),</span>
  <span class="n">u</span> <span class="bp">=</span> <span class="bp">⨅</span> <span class="n">V</span><span class="o">,</span> <span class="o">(</span><span class="n">D</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">to_uniform_space</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="bp">𝓑</span> <span class="o">:</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="o">:=</span>
    <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="bp">@</span><span class="n">nat.rec</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">)</span>
    <span class="o">⟨</span><span class="n">symmetrize_rel</span> <span class="n">V.1</span><span class="o">,</span> <span class="n">symmetrize_mem_uniformity</span> <span class="n">V.2</span><span class="o">⟩</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">U</span><span class="o">,</span> <span class="o">⟨</span><span class="n">classical.some</span> <span class="bp">$</span> <span class="n">comp_symm_mem_uniformity_sets</span> <span class="n">U.2</span><span class="o">,</span>
      <span class="o">(</span><span class="n">classical.some_spec</span> <span class="bp">$</span> <span class="n">comp_symm_mem_uniformity_sets</span> <span class="n">U.2</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">⟩),</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_comp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">X</span><span class="o">)</span> <span class="bp">○</span> <span class="bp">𝓑</span> <span class="n">V</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">⊆</span> <span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span>
    <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">hn</span><span class="bp">;</span>
    <span class="o">[</span><span class="n">set</span> <span class="n">m</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">set</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">n.succ</span><span class="o">]</span><span class="bp">;</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">classical.some_spec</span> <span class="bp">$</span> <span class="n">comp_symm_mem_uniformity_sets</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">m</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">snd.2</span><span class="o">,</span> <span class="o">},</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_symmetric</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span> <span class="n">symmetric_rel</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">X</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span>
    <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">hn</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">symmetric_symmetrize_rel</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">classical.some_spec</span> <span class="bp">$</span> <span class="n">comp_symm_mem_uniformity_sets</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">snd.1</span> <span class="o">}</span> <span class="o">},</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_zero_V</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span><span class="o">,</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">X</span> <span class="bp">×</span> <span class="n">X</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">V</span> <span class="o">:=</span>
    <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="n">symmetrize_rel_subset_self</span> <span class="n">V</span><span class="o">,</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_decreasing'</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span> <span class="bp">𝓑</span> <span class="n">V</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">≤</span> <span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">V</span> <span class="n">n</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">𝓑</span><span class="n">_comp</span> <span class="n">V</span> <span class="n">n</span> <span class="o">(</span><span class="n">subset_comp_self</span> <span class="n">_</span> <span class="n">hx</span><span class="o">),</span>
    <span class="n">rw</span> <span class="n">id_rel_subset</span><span class="o">,</span>
    <span class="n">exact</span> <span class="bp">λ</span> <span class="n">y</span><span class="o">,</span> <span class="n">refl_mem_uniformity</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="bp">$</span> <span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="o">},</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_decreasing</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span><span class="o">,</span> <span class="n">antitone</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span><span class="o">)</span> <span class="o">:=</span>
    <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="n">antitone_nat_of_succ_le</span> <span class="o">(</span><span class="bp">𝓑</span><span class="n">_decreasing'</span> <span class="n">V</span><span class="o">),</span>
  <span class="k">have</span> <span class="bp">𝓑</span><span class="n">_is_basis</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span><span class="o">,</span> <span class="n">filter.is_basis</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">true</span><span class="o">)</span> <span class="o">(</span><span class="n">subtype.val</span> <span class="bp">∘</span> <span class="bp">𝓑</span> <span class="n">V</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="n">V</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">true.intro</span><span class="o">⟩,</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="o">⟨</span><span class="n">max</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">true.intro</span><span class="o">,</span> <span class="n">subset_inter</span>
      <span class="o">(</span><span class="bp">𝓑</span><span class="n">_decreasing</span> <span class="n">V</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">𝓑</span><span class="n">_decreasing</span> <span class="n">V</span> <span class="n">_</span><span class="o">)⟩⟩</span><span class="bp">;</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">le_max_iff</span><span class="o">,</span> <span class="n">le_refl</span><span class="o">,</span> <span class="n">true_or</span><span class="o">,</span> <span class="n">or_true</span><span class="o">]</span> <span class="o">},</span>
  <span class="k">let</span> <span class="bp">𝒰</span> <span class="o">:</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span> <span class="n">uniform_space</span> <span class="n">X</span> <span class="o">:=</span>
    <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="n">uniform_space.of_core</span> <span class="o">(</span><span class="n">uniform_space.core.mk_of_basis</span> <span class="o">(</span><span class="bp">𝓑</span><span class="n">_is_basis</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">filter_basis</span>
      <span class="o">(</span><span class="kd">by</span> <span class="o">{</span><span class="n">rintros</span> <span class="n">r</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="bp">-</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="n">x</span><span class="o">,</span> <span class="n">exact</span> <span class="n">refl_mem_uniformity</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">})</span>
      <span class="o">(</span><span class="kd">by</span> <span class="o">{</span><span class="n">rintros</span> <span class="n">r</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="bp">-</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">exact</span> <span class="o">⟨</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">true.intro</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">(</span><span class="bp">𝓑</span><span class="n">_symmetric</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">ge</span><span class="o">⟩})</span>
      <span class="o">(</span><span class="kd">by</span> <span class="o">{</span><span class="n">rintros</span> <span class="n">r</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="bp">-</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">exact</span> <span class="o">⟨</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span> <span class="o">⟨</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">true.intro</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="bp">𝓑</span><span class="n">_comp</span> <span class="n">V</span> <span class="n">n</span><span class="o">⟩</span> <span class="o">})),</span>
  <span class="k">have</span> <span class="bp">𝒰</span><span class="n">_basis</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span><span class="o">,</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="o">(</span><span class="bp">𝒰</span> <span class="n">V</span><span class="o">))</span><span class="bp">.</span><span class="n">has_basis</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">true</span><span class="o">)</span> <span class="o">(</span><span class="n">subtype.val</span> <span class="bp">∘</span> <span class="bp">𝓑</span> <span class="n">V</span><span class="o">)</span> <span class="o">:=</span>
    <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="o">(</span><span class="bp">𝓑</span><span class="n">_is_basis</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">has_basis</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">V_mem_</span><span class="bp">𝒰</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span> <span class="o">:</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">,</span> <span class="n">V.1</span> <span class="bp">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="o">(</span><span class="bp">𝒰</span> <span class="n">V</span><span class="o">)),</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">V</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="bp">𝒰</span><span class="n">_basis</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">mem_iff</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">true.intro</span><span class="o">,</span> <span class="bp">𝓑</span><span class="n">_zero_V</span> <span class="n">V</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">u_eq_</span><span class="bp">𝒰</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="bp">⨅</span> <span class="n">V</span><span class="o">,</span> <span class="bp">𝒰</span> <span class="n">V</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="n">le_antisymm</span> <span class="o">(</span><span class="n">le_infi</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">V</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">V</span> <span class="n">hV</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">change</span> <span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span> <span class="bp">≤</span> <span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="o">(</span><span class="bp">𝒰</span> <span class="n">V</span><span class="o">),</span>
      <span class="n">rw</span> <span class="o">(</span><span class="bp">𝒰</span><span class="n">_basis</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">ge_iff</span><span class="o">,</span>
      <span class="n">exact</span> <span class="bp">λ</span> <span class="n">n</span> <span class="n">_</span><span class="o">,</span> <span class="o">(</span><span class="bp">𝓑</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">infi_uniformity</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">filter.mem_infi_of_mem</span> <span class="n">_</span> <span class="o">(</span><span class="n">V_mem_</span><span class="bp">𝒰</span> <span class="o">(⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">hV</span><span class="o">⟩</span> <span class="o">:</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">X</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">))</span> <span class="o">}</span> <span class="o">},</span>
  <span class="k">have</span> <span class="bp">𝒰</span><span class="n">_exists_dist</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">V</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">d</span> <span class="o">:</span> <span class="n">pseudo_metric_space</span> <span class="n">X</span><span class="o">,</span> <span class="bp">𝒰</span> <span class="n">V</span> <span class="bp">=</span> <span class="n">d.to_uniform_space</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">V</span><span class="o">,</span>
    <span class="n">letI</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">X</span> <span class="o">:=</span> <span class="bp">𝒰</span> <span class="n">V</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">𝓤</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">has_countable_basis</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">true</span><span class="o">)</span> <span class="o">(</span><span class="n">subtype.val</span> <span class="bp">∘</span> <span class="bp">𝓑</span> <span class="n">V</span><span class="o">)</span> <span class="o">:=</span>
    <span class="o">{</span> <span class="n">countable</span> <span class="o">:=</span> <span class="n">to_countable</span> <span class="n">_</span><span class="o">,</span>
      <span class="bp">..𝒰</span><span class="n">_basis</span> <span class="n">V</span> <span class="o">},</span>
    <span class="n">haveI</span> <span class="o">:</span> <span class="o">(</span><span class="bp">𝓤</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">is_countably_generated</span> <span class="o">:=</span> <span class="n">this.is_countably_generated</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">uniform_space.pseudo_metric_space</span> <span class="n">X</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="n">choose</span> <span class="n">D</span> <span class="n">hD</span> <span class="n">using</span> <span class="bp">𝒰</span><span class="n">_exists_dist</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">D</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">u_eq_</span><span class="bp">𝒰</span><span class="o">,</span>
  <span class="n">ext</span> <span class="n">V</span> <span class="o">:</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">hD</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
<span class="kd">end</span>
</code></pre></div>



<a name="297855449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297855449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297855449">(Sep 08 2022 at 19:57)</a>:</h4>
<p>I will clean it and make a PR in the next few fays, which gives some time to discuss how we <em>should</em> state it to make it usable</p>



<a name="297855585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297855585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297855585">(Sep 08 2022 at 19:58)</a>:</h4>
<p>(The reason it is so big is because it should be splitted in a lot of intermediate constructions, with each <code>have</code> being a lemma basically)</p>



<a name="297856269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297856269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297856269">(Sep 08 2022 at 20:02)</a>:</h4>
<p>I was under the impression that there should be a "canonical" family of pseudometrics that does the job. Something like the collection of all pseudometrics for which the associated map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">X \times X \to\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span> is uniformly continuous.</p>



<a name="297856759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297856759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297856759">(Sep 08 2022 at 20:06)</a>:</h4>
<p>But what you have is also canonical, and doesn't involve a "large" family!</p>



<a name="297864384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Pseudometric%20def%20of%20uniform%20space/near/297864384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Pseudometric.20def.20of.20uniform.20space.html#297864384">(Sep 08 2022 at 21:00)</a>:</h4>
<p>Oh, you are probably right, and I should have thought about it because I was thinking about a similar thing just a week ago while reviewing <a href="https://github.com/leanprover-community/mathlib/pull/15035">#15035</a> (but I didn't take the time to write my thoughts yet, sorry <span class="user-mention" data-user-id="412682">@Moritz Doll</span> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> ). Anyway, I will think about it between my lectures tomorrow (and of course not <em>during</em> the lectures, who would do that) and see if I can make it work</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>