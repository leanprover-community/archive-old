---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html">injective.ne</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="221280031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221280031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221280031">(Dec 31 2020 at 09:47)</a>:</h4>
<p>Dear All,</p>
<p>I found myself needing the lemmas below, that I could not find in mathlib.  Of course, I could replace them by their proofs, when I need them, but it feels like these lemmas might be useful.  In particular, <code>injective.ne (a ≠ 0)</code> is used a lot in usual mathematical arguments, since rings have opposites (what an unnatural assumption).  Should the lemmas below be imported to mathlib?  Should there be a few general statements saying that homs (with appropriate assumptions) are injective if and only if they map non-zero elements to non-zero elements?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.eval</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">),</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">ne</span> <span class="n">f0</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">polynomial.injective_int_real</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">ℤ</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">A</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">ring_hom.eq_int_cast</span><span class="o">,</span> <span class="n">int.cast_inj</span><span class="o">]</span> <span class="n">using</span> <span class="n">A</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">polynomial.injective.ne</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">ℤ</span> <span class="n">ℝ</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">polynomial.injective.ne_of_inj_algebra_map</span> <span class="n">f0</span> <span class="n">polynomial.injective_int_real</span>
</code></pre></div>



<a name="221281027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221281027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221281027">(Dec 31 2020 at 10:13)</a>:</h4>
<p>I usually use <code>mt f_inj.eq</code></p>



<a name="221281077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221281077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221281077">(Dec 31 2020 at 10:14)</a>:</h4>
<p>it seems easier to just use <code>mt</code> rather than make contrapositive versions of everything</p>



<a name="221281126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221281126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221281126">(Dec 31 2020 at 10:15)</a>:</h4>
<p>Thanks for the suggestion!  Let me internalize this and see how it works in the lemmas above!</p>



<a name="221283400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283400">(Dec 31 2020 at 11:04)</a>:</h4>
<p>I am missing something very basic here: I have been trying to get the contrapositive, but none of <code>mt h</code>, <code>mt h_inj</code>,<code>mt h_inj.eq</code>, <code>mt h.eq</code> works in the first lemma above.  After <code>unfold</code>ing <code>h</code>, I get the impression that Lean does not like the two variables implicit in <code>h</code>, but I have failed to give them explicitly, even with <code>@h [...]</code>.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">),</span>
  <span class="n">unfold</span> <span class="n">function.injective</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">mt</span> <span class="bp">@</span><span class="n">h</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span><span class="o">)</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="mi">0</span><span class="o">),</span>
<span class="c1">--type mismatch at application</span>
<span class="c1">--  mt h</span>
<span class="c1">--term</span>
<span class="c1">--  h</span>
<span class="c1">--has type</span>
<span class="c1">--  ∀ ⦃a₁ a₂ : R⦄, ⇑(algebra_map R A) a₁ = ⇑(algebra_map R A) a₂ → a₁ = a₂</span>
<span class="c1">--but is expected to have type</span>
<span class="c1">--  ?m_1 → ?m_2</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221283574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283574">(Dec 31 2020 at 11:08)</a>:</h4>
<p>What you've written can't be right because <code>mt</code> is expecting an input which is a proof of P -&gt; Q, and you're giving it <code>@h</code> which is much more complicated. Do you just need brackets around the (@h ...)?</p>



<a name="221283603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283603">(Dec 31 2020 at 11:09)</a>:</h4>
<p><code>mt</code> is a function so will eat the next term it sees as its input -- function application has super-high binding power or priority or whatever it's called -- the BIDMAS thing.</p>



<a name="221283656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283656">(Dec 31 2020 at 11:10)</a>:</h4>
<p>"precedence" maybe?</p>



<a name="221283712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283712">(Dec 31 2020 at 11:12)</a>:</h4>
<p>Ok, this is part of the issue!  The other part is that I probably gave the wrong inputs to <code>h</code>.  I will fiddle with this a little longer!</p>
<p>Thanks!</p>



<a name="221283737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283737">(Dec 31 2020 at 11:12)</a>:</h4>
<p>Just <code>apply mt</code> and then pick up the pieces maybe?</p>



<a name="221283847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221283847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221283847">(Dec 31 2020 at 11:15)</a>:</h4>
<p>ok, I feel very clumsy, but what's below works!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">),</span>
  <span class="n">apply</span> <span class="n">mt</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">j</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">f0</span><span class="o">,</span>
  <span class="n">apply</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span> <span class="n">j</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">not_false</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>with <code>show_term</code> and some compressing, this is what it becomes:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">mt</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">f0</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span> <span class="n">j</span><span class="o">))</span> <span class="n">not_false</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221284154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284154">(Dec 31 2020 at 11:23)</a>:</h4>
<p>that looks odd... you shouldn't need <code>not_false</code></p>



<a name="221284157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284157">(Dec 31 2020 at 11:23)</a>:</h4>
<p>that's the identity function</p>



<a name="221284195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284195">(Dec 31 2020 at 11:24)</a>:</h4>
<p>I think <code>f0</code> should be the last argument to <code>mt</code></p>



<a name="221284207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284207">(Dec 31 2020 at 11:24)</a>:</h4>
<p>does <code>mt (map_injective (algebra_map R A) h) f0</code> work?</p>



<a name="221284234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284234">(Dec 31 2020 at 11:25)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">refine</span> <span class="n">mt</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span> <span class="n">f0</span><span class="o">,</span>

<span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">mt</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span>
<span class="n">term</span>
  <span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">function.injective</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">?</span><span class="n">m_1</span>
</code></pre></div>



<a name="221284313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284313">(Dec 31 2020 at 11:26)</a>:</h4>
<p>I may be making my life complicated by combining the injectivity of <code>h</code>and the injectivity of the induced map on <code>polynomial R</code>, though.</p>



<a name="221284315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284315">(Dec 31 2020 at 11:26)</a>:</h4>
<p>Oh, the <code>{{}}</code> is getting in the way</p>



<a name="221284347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284347">(Dec 31 2020 at 11:27)</a>:</h4>
<p>maybe <code>(map_injective (algebra_map R A) h).eq_iff.1</code> works?</p>



<a name="221284395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284395">(Dec 31 2020 at 11:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">refine</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">eq_iff.1</span><span class="o">,</span>

<span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">=</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_2</span> <span class="bp">→</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">=</span> <span class="bp">?</span><span class="n">m_2</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="mi">0</span>
</code></pre></div>



<a name="221284399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284399">(Dec 31 2020 at 11:28)</a>:</h4>
<p>.2</p>



<a name="221284408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284408">(Dec 31 2020 at 11:28)</a>:</h4>
<p>oh hey, <code>injective.ne</code> is a thing</p>



<a name="221284410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284410">(Dec 31 2020 at 11:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m_1</span> <span class="bp">=</span> <span class="bp">?</span><span class="n">m_2</span> <span class="bp">→</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">=</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_2</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="mi">0</span>
</code></pre></div>



<a name="221284415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284415">(Dec 31 2020 at 11:29)</a>:</h4>
<p>yes, I was using <code>injective.ne</code> in my original proof.</p>



<a name="221284424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284424">(Dec 31 2020 at 11:29)</a>:</h4>
<p>still <code>mt (injective_proof).eq_iff.2 f0</code> I mean</p>



<a name="221284486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284486">(Dec 31 2020 at 11:30)</a>:</h4>
<p>ok if <code>injective.ne</code> exists already then <code>(injective_proof).ne f0</code> is better</p>



<a name="221284520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284520">(Dec 31 2020 at 11:31)</a>:</h4>
<p>injective_proof of the map on rings, right?  what is called <code>h</code>, to be clear?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">),</span>
  <span class="n">refine</span> <span class="n">mt</span> <span class="o">(</span><span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">eq_iff.2</span> <span class="n">f0</span><span class="o">,</span> <span class="c1">-- does not work</span>
<span class="c1">--type mismatch at application</span>
<span class="c1">--  mt h.eq_iff.mpr</span>
<span class="c1">--term</span>
<span class="c1">--  h.eq_iff.mpr</span>
<span class="c1">--has type</span>
<span class="c1">--  ?m_1 = ?m_2 → ⇑(algebra_map R A) ?m_1 = ⇑(algebra_map R A) ?m_2</span>
<span class="c1">--but is expected to have type</span>
<span class="c1">--  map (algebra_map R A) f = map (algebra_map R A) 0 → ?m_1</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221284531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284531">(Dec 31 2020 at 11:31)</a>:</h4>
<p>But looking at your theorem, it looks like it's just saying <code>injective (algebra_map R A) -&gt; injective (map (algebra_map R A))</code></p>



<a name="221284584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284584">(Dec 31 2020 at 11:32)</a>:</h4>
<p>.1 then</p>



<a name="221284590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284590">(Dec 31 2020 at 11:32)</a>:</h4>
<p>I just try it both ways and see which one lean likes</p>



<a name="221284599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284599">(Dec 31 2020 at 11:32)</a>:</h4>
<p>you can see in the error that the arrow is going the wrong way</p>



<a name="221284605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284605">(Dec 31 2020 at 11:33)</a>:</h4>
<p>Yes, the theorem should be saying that is the map on coefficients is injective, then the map on polynomials is injective.</p>



<a name="221284623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284623">(Dec 31 2020 at 11:33)</a>:</h4>
<p>then why not prove that?</p>



<a name="221284631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284631">(Dec 31 2020 at 11:33)</a>:</h4>
<p>and use <code>injective.ne</code> or <code>injective.eq_iff</code> or whatever on the result</p>



<a name="221284680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284680">(Dec 31 2020 at 11:34)</a>:</h4>
<p>What if you start with <code>contrapose! f0</code>?</p>



<a name="221284685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284685">(Dec 31 2020 at 11:34)</a>:</h4>
<p>Yes, I am happy with this.  I was wondering whether the lemmas above are something that is good to have in mathlib, that's all!<br>
I am happy to learn new ways to prove stuff, though!</p>



<a name="221284695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284695">(Dec 31 2020 at 11:35)</a>:</h4>
<p>Do we have the theorem about <code>injective (algebra_map R A) -&gt; injective (map (algebra_map R A))</code>? That's the version that looks good for mathlib</p>



<a name="221284707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284707">(Dec 31 2020 at 11:35)</a>:</h4>
<p>this stuff with negations in it looks too specialized</p>



<a name="221284767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284767">(Dec 31 2020 at 11:36)</a>:</h4>
<p>with <code>contrapose! f=0</code>, this is the state:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">R</span><span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span>
<span class="n">A</span><span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span>
<span class="n">_inst_1</span><span class="o">:</span> <span class="n">comm_semiring</span> <span class="n">R</span>
<span class="n">_inst_2</span><span class="o">:</span> <span class="n">semiring</span> <span class="n">A</span>
<span class="n">_inst_3</span><span class="o">:</span> <span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span>
<span class="n">f</span><span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span>
<span class="n">h</span><span class="o">:</span> <span class="n">function.injective</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span>
<span class="n">f0</span><span class="o">:</span> <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span> <span class="mi">0</span>
<span class="bp">⊢</span> <span class="n">f</span> <span class="bp">=</span> <span class="mi">0</span>
</code></pre></div>



<a name="221284786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284786">(Dec 31 2020 at 11:37)</a>:</h4>
<p>Isn't this a cleaner state?</p>



<a name="221284789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284789">(Dec 31 2020 at 11:37)</a>:</h4>
<p>oh, <code>map_injective</code> is literally the theorem I said</p>



<a name="221284792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284792">(Dec 31 2020 at 11:37)</a>:</h4>
<p>Yes, and it is also the one whose contrapositive I was trying to prove!</p>



<a name="221284844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284844">(Dec 31 2020 at 11:38)</a>:</h4>
<p>There should be a theorem that a function is injective iff <code>f x = 0 -&gt; x = 0</code> and variations on that</p>



<a name="221284852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284852">(Dec 31 2020 at 11:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">polynomial.injective.ne_of_inj_algebra_map</span>
  <span class="o">{</span><span class="n">R</span> <span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">f0</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">contrapose</span><span class="bp">!</span> <span class="n">f0</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span>  <span class="n">map_zero</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">at</span> <span class="n">f0</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">map_injective</span> <span class="n">_</span>  <span class="n">h</span> <span class="n">f0</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221284861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284861">(Dec 31 2020 at 11:39)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/ring_hom.injective_iff">docs#ring_hom.injective_iff</a></p>



<a name="221284924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284924">(Dec 31 2020 at 11:40)</a>:</h4>
<p>Ah, thanks for <code>ring_hom.injective_iff</code>!</p>



<a name="221284936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284936">(Dec 31 2020 at 11:41)</a>:</h4>
<p>Cleaner:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">begin</span>
  <span class="n">contrapose</span><span class="bp">!</span> <span class="n">f0</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">map_injective</span> <span class="n">_</span>  <span class="n">h</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">f0</span><span class="o">])</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221284990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221284990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221284990">(Dec 31 2020 at 11:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">by</span> <span class="n">simpa</span> <span class="n">using</span> <span class="o">(</span><span class="n">map_injective</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">ne</span> <span class="n">f0</span>
</code></pre></div>



<a name="221285054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285054">(Dec 31 2020 at 11:44)</a>:</h4>
<p>So, if I wanted to use the proof with <code>simpa</code> in the middle of another proof, how should I do to avoid a "non-terminal <code>simp</code>"?</p>



<a name="221285068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285068">(Dec 31 2020 at 11:44)</a>:</h4>
<p><code>have : map (algebra_map R A) f ≠ 0 := by simpa using (map_injective (algebra_map R A) h).ne f0</code></p>



<a name="221285069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285069">(Dec 31 2020 at 11:44)</a>:</h4>
<p>ok, thanks!</p>



<a name="221285075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285075">(Dec 31 2020 at 11:44)</a>:</h4>
<p>for some reason, I do not like <code>have</code>, but this is just me!</p>



<a name="221285090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285090">(Dec 31 2020 at 11:45)</a>:</h4>
<p><code>apply theorem foo bar (show map (algebra_map R A) f ≠ 0, by simpa using (map_injective (algebra_map R A) h).ne f0)</code></p>



<a name="221285158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285158">(Dec 31 2020 at 11:46)</a>:</h4>
<p>Thanks!  I will learn to use <code>show</code>!</p>



<a name="221285161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285161">(Dec 31 2020 at 11:46)</a>:</h4>
<p>That's funny because <code>have</code> is the only tactic we constantly use on paper. I still dream of getting to the point where, as in Isabelle, a (nontrivial) Lean proof would only be a sequence of <code>have : ..., by auto</code>.</p>



<a name="221285175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285175">(Dec 31 2020 at 11:47)</a>:</h4>
<p>you may not need <code>show</code> depending on how much context lean has in <code>theorem foo bar _</code></p>



<a name="221285180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285180">(Dec 31 2020 at 11:47)</a>:</h4>
<p>I <em>think</em> with <code>have</code>, but when I write lean arguments, I find that it slows down quite a bit and <code>refine</code> works <em>much</em> better!</p>



<a name="221285230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285230">(Dec 31 2020 at 11:48)</a>:</h4>
<p>ok, I will practice with and without <code>show</code>.</p>



<a name="221285236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285236">(Dec 31 2020 at 11:48)</a>:</h4>
<p>with refine, <code>refine foo bar _, {simpa ...}, ...</code></p>



<a name="221285262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285262">(Dec 31 2020 at 11:49)</a>:</h4>
<p>Thank you all for the suggestions!  Even though many of these bits and pieces were already in my mind, seeing them come together in this simple example is really useful!</p>



<a name="221285354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285354">(Dec 31 2020 at 11:50)</a>:</h4>
<p>I am starting to understand the difference between <code>refine</code> and <code>apply</code>.  If I understand correctly, the use of the underscore may make a difference in the last suggestion <code>refine foo bar _, {simpa ...}, ...</code>, right?</p>



<a name="221285380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285380">(Dec 31 2020 at 11:51)</a>:</h4>
<p>e.g. <code>apply foo bar _, {simpa ...}, ...</code> may not generate the goal to be solved with <code>{simpa ...}</code>, correct?</p>



<a name="221285852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/injective.ne/near/221285852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/injective.2Ene.html#221285852">(Dec 31 2020 at 12:01)</a>:</h4>
<p><code>refine</code> is cooler than <code>apply</code> because it knows the goals of every underscore. <code>apply</code> is just <code>refine</code> without underscores and it doesn't always work because of (a) the apply bug and (b) <code>apply F (by simp)</code> doesn't always work because Lean might not know what it's supposed to be proving by <code>simp</code> because of elaboration issues. <code>refine F (by simp) _ _ _</code> will work.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>