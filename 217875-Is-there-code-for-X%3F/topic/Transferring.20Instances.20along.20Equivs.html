---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html">Transferring Instances along Equivs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="240767537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240767537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ken Lee <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240767537">(May 30 2021 at 18:14)</a>:</h4>
<p>Say I have <code>(M N : Type u) (f : M equiv N) [monoid M]</code>, is there a way of transfering the monoid structure of <code>M</code> via <code>f</code> to <code>N</code> without "typing everything out"?</p>
<p>In my situation, I have a monoid instance on <code>M = (punit --&gt; N)</code>.</p>



<a name="240767921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240767921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240767921">(May 30 2021 at 18:25)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#transport">tactic#transport</a></p>



<a name="240768353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240768353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ken Lee <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240768353">(May 30 2021 at 18:36)</a>:</h4>
<p>Beautiful. Thanks!</p>



<a name="240770219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240770219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ken Lee <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240770219">(May 30 2021 at 19:28)</a>:</h4>
<p>actually, why is this a tactic and not a definition?</p>



<a name="240770381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240770381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240770381">(May 30 2021 at 19:33)</a>:</h4>
<p>You can use this for other kinds of algebraic structures as well (which is only possible in lean with metaprogramming)</p>



<a name="240770429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240770429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240770429">(May 30 2021 at 19:34)</a>:</h4>
<p>If you want a definition for monoids only, you can make one yourself using this tactic</p>



<a name="240770595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240770595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240770595">(May 30 2021 at 19:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">algebra</span>

<span class="kd">def</span> <span class="n">transport_monoid</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">monoid</span> <span class="n">β</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">transport</span> <span class="n">using</span> <span class="n">e</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">e</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="kd">by</span> <span class="n">letI</span> <span class="o">:=</span> <span class="n">transport_monoid</span> <span class="n">e</span><span class="bp">;</span> <span class="n">exact</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">β</span><span class="o">))</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">(</span><span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">e</span> <span class="o">(</span><span class="n">e.symm</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">e.symm</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="kd">by</span> <span class="n">letI</span> <span class="o">:=</span> <span class="n">transport_monoid</span> <span class="n">e</span><span class="bp">;</span> <span class="n">exact</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="240773964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240773964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240773964">(May 30 2021 at 21:04)</a>:</h4>
<p>Does <a href="https://leanprover-community.github.io/mathlib_docs/find/function.injective.monoid">docs#function.injective.monoid</a> help?</p>



<a name="240773971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240773971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240773971">(May 30 2021 at 21:04)</a>:</h4>
<p>Or <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.monoid">docs#equiv.monoid</a></p>



<a name="240773981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240773981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240773981">(May 30 2021 at 21:05)</a>:</h4>
<p>Which is the version without needing a tactic</p>



<a name="240774157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240774157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ken Lee <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240774157">(May 30 2021 at 21:09)</a>:</h4>
<p>it's okay. <code>transport</code> doesn't look like it's gonna do anything crazy like <code>tidy</code>. I was just wondering why it's in the meta, and not within the type theory.</p>



<a name="240774496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240774496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240774496">(May 30 2021 at 21:17)</a>:</h4>
<p>It's in the meta because writing all of <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.monoid">docs#equiv.monoid</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.group">docs#equiv.group</a>, etc by hand would be super tedious. Except we did that anyway, so I'm not really sure why we have both.</p>



<a name="240775331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240775331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ken Lee <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240775331">(May 30 2021 at 21:37)</a>:</h4>
<p>but is it possible to have a single <code>transport</code> function within the type theory that allows you to transfer across any kind of structure across equivs?</p>



<a name="240775615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240775615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240775615">(May 30 2021 at 21:45)</a>:</h4>
<p>Depends on the definition of <code>structure</code>. If you encode things in terms of universal algebra, then yes, but then translating back to the structures like monoids, groups, etc. as they're usually defined in mathlib still would require meta code.</p>



<a name="240778853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240778853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aaron Anderson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240778853">(May 30 2021 at 23:12)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> I’m moving toward that with <a href="https://github.com/leanprover-community/mathlib/issues/7754">#7754</a>...</p>



<a name="240778913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240778913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240778913">(May 30 2021 at 23:14)</a>:</h4>
<p>I would be happy to start porting this stuff I did a while ago here <a href="https://github.com/adamtopaz/UnivAlg">https://github.com/adamtopaz/UnivAlg</a> once we settle on a way to work with first order structures!</p>



<a name="240782148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240782148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240782148">(May 31 2021 at 00:57)</a>:</h4>
<p>I had planned about a year ago to steadily make <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#equiv_rw">tactic#equiv_rw</a> (the real trick underlying <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#transport">tactic#transport</a>) more and more powerful. There is a lot that can be done here! (There's not reason it can't deal with quantifiers, and if could also be a lot cleverer about using equivs-with-structure.) But I got distracted by other things.</p>



<a name="240782197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240782197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240782197">(May 31 2021 at 00:58)</a>:</h4>
<p>If you look in the test file for <code>transport</code> you'll see it happily transports <code>lie_ring</code>, etc., --- so it exists because it is / is-intended-to-be a general purpose tool.</p>



<a name="240782198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240782198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240782198">(May 31 2021 at 00:58)</a>:</h4>
<p>The hard coded things like <code>docs#equiv.monoid</code> predate it.</p>



<a name="240782397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240782397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240782397">(May 31 2021 at 01:04)</a>:</h4>
<p>Does it transport things like topological spaces?</p>



<a name="240792475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240792475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240792475">(May 31 2021 at 05:03)</a>:</h4>
<p>No, but that was the example I was last working on. (Obviously not hard coding something for topological spaces, but teaching it to cope with the relevant sorts of quantifiers/dependencies.)</p>



<a name="240792538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Transferring%20Instances%20along%20Equivs/near/240792538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Transferring.20Instances.20along.20Equivs.html#240792538">(May 31 2021 at 05:04)</a>:</h4>
<p>I really wanted to transport compactness across a homeomorphism (again, by a metaprogram that had never heard of spaces, homeomorphisms, or compactness). Certainly doable,  just takes some work.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>