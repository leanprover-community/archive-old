---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html">existence of equiv mapping nodup same length lists</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="321749589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321749589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321749589">(Jan 17 2023 at 03:42)</a>:</h4>
<p>Is there a theorem or set of theorems in mathlib that would help to prove this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">l1.length</span> <span class="bp">=</span> <span class="n">l2.length</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">l1.nodup</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">l2.nodup</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">≃</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">l1.map</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">l2</span>
</code></pre></div>



<a name="321749966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321749966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321749966">(Jan 17 2023 at 03:49)</a>:</h4>
<p>Title should read "equiv" not "function". Not sure how to change it.</p>



<a name="321791494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321791494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321791494">(Jan 17 2023 at 09:59)</a>:</h4>
<p>I couldn't find anything precisely matching your description. The closest I found is you might be able to compose two usages of <a href="https://leanprover-community.github.io/mathlib_docs/find/list.nodup.nth_le_equiv_of_forall_mem_list">docs#list.nodup.nth_le_equiv_of_forall_mem_list</a>.</p>



<a name="321817643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321817643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321817643">(Jan 17 2023 at 12:24)</a>:</h4>
<p>Maybe there is something that connects equiv.perm and list.perm that you could use.</p>



<a name="321849521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321849521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321849521">(Jan 17 2023 at 14:55)</a>:</h4>
<p>Here's a crude proof of a slight generalization of this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">logic.equiv.fintype</span>

<span class="kd">theorem</span> <span class="n">foo</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
  <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">l1.length</span> <span class="bp">=</span> <span class="n">l2.length</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">l1.nodup</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">l2.nodup</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">≃</span> <span class="n">α</span><span class="o">,</span> <span class="n">l1.map</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">l2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="n">induction</span> <span class="n">l1</span> <span class="k">with</span> <span class="n">x</span> <span class="n">l1</span> <span class="n">ih</span> <span class="n">generalizing</span> <span class="n">l2</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">list.length</span><span class="o">,</span> <span class="n">eq_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">list.eq_nil_of_length_eq_zero</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">equiv.refl</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">refl</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">l2</span> <span class="k">with</span> <span class="n">y</span> <span class="n">l2</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">h1</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">list.length</span><span class="o">,</span> <span class="n">add_left_inj</span><span class="o">]</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">list.nodup_cons</span><span class="o">]</span> <span class="n">at</span> <span class="n">h2</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">f</span><span class="o">,</span> <span class="n">hf</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">ih</span> <span class="n">h2.2</span> <span class="n">l2</span> <span class="n">h1</span> <span class="n">h3.2</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">l2</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hf</span><span class="o">,</span> <span class="n">h2</span><span class="o">],</span>
  <span class="n">use</span> <span class="n">f.trans</span> <span class="o">(</span><span class="n">equiv.swap</span> <span class="n">y</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)),</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">list.map</span><span class="o">,</span> <span class="n">equiv.coe_trans</span><span class="o">,</span> <span class="n">function.comp_app</span><span class="o">,</span> <span class="n">equiv.swap_apply_right</span><span class="o">,</span>
    <span class="n">eq_self_iff_true</span><span class="o">,</span> <span class="n">true_and</span><span class="o">],</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">list.map_congr</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span> <span class="n">hz</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">function.comp_app</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">equiv.swap_apply_of_ne_of_ne</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">h3.1</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span><span class="n">hf</span><span class="o">,</span> <span class="n">list.mem_map</span><span class="o">,</span> <span class="n">embedding_like.apply_eq_iff_eq</span><span class="o">,</span> <span class="n">exists_eq_right</span><span class="o">]</span> <span class="n">using</span> <span class="n">hz</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">h</span><span class="o">,</span> <span class="bp">←</span> <span class="n">hf</span><span class="o">],</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="n">hz</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="321884780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321884780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321884780">(Jan 17 2023 at 17:26)</a>:</h4>
<p>Interesting, wasn't expecting an inductive proof using <code>equiv.swap</code>. Was thinking of a proof using <a href="https://leanprover-community.github.io/mathlib_docs/find/cardinal.mk_compl_eq_mk_compl_finite">docs#cardinal.mk_compl_eq_mk_compl_finite</a>, and <a href="https://leanprover-community.github.io/mathlib_docs/find/list.nodup.nth_le_equiv_of_forall_mem_list">docs#list.nodup.nth_le_equiv_of_forall_mem_list</a> will be helpful there.</p>



<a name="321901210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321901210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321901210">(Jan 17 2023 at 18:47)</a>:</h4>
<p>Just spitballing here, what's wrong with an explicit construction here? I'm hitting a roadblock in proving, I feel like I forgot to capture some edge case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="n">refine</span> <span class="o">⟨⟨</span>
   <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l1</span> <span class="k">then</span> <span class="n">l2.nth_le</span> <span class="o">(</span><span class="n">l1.index_of</span> <span class="n">x</span><span class="o">)</span> <span class="o">((</span><span class="n">list.index_of_lt_length.mpr</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">trans_le</span> <span class="n">h1.le</span><span class="o">)</span> <span class="k">else</span> <span class="n">x</span><span class="o">,</span>
   <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l2</span> <span class="k">then</span> <span class="n">l1.nth_le</span> <span class="o">(</span><span class="n">l2.index_of</span> <span class="n">x</span><span class="o">)</span> <span class="o">((</span><span class="n">list.index_of_lt_length.mpr</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">trans_le</span> <span class="n">h1.ge</span><span class="o">)</span> <span class="k">else</span> <span class="n">x</span><span class="o">,</span>
   <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span> <span class="n">_</span><span class="o">⟩,</span>
</code></pre></div>



<a name="321904367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321904367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321904367">(Jan 17 2023 at 19:03)</a>:</h4>
<p>Yeah I feel like there might even be a "minimal equiv", which does what it has to do on <code>l1</code>, closes every chain x1 -&gt; x2 -&gt; x3 -&gt; ... -&gt; xn by sending xn to x1, and then is the identity away from l1 union l2 (but Yakov I think that your code as it stands has problems with l1=[1] and l2=[2] because it sends 1 to 2 and also 2 to 2)</p>



<a name="321907190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321907190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321907190">(Jan 17 2023 at 19:16)</a>:</h4>
<p>I'm pretty sure I saw a PR linking <code>list.perm</code> to <code>equiv.perm</code></p>



<a name="321977699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/321977699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#321977699">(Jan 18 2023 at 05:52)</a>:</h4>
<p>Thank you for all of the suggestions. I'm thinking through how to proceed.</p>



<a name="322198370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322198370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322198370">(Jan 19 2023 at 04:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="238446">Anne Baanen</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists/near/321791494">said</a>:</p>
<blockquote>
<p>I couldn't find anything precisely matching your description. The closest I found is you might be able to compose two usages of <a href="https://leanprover-community.github.io/mathlib_docs/find/list.nodup.nth_le_equiv_of_forall_mem_list">docs#list.nodup.nth_le_equiv_of_forall_mem_list</a>.</p>
</blockquote>
<p>I'm not sure I understand what this theorem says. What would <code>l</code> and <code>α</code>be in this instance? Is <code>α = ℕ</code>? If so, can a <code>list</code> be infinite and hold all of the elements of <code>ℕ</code>?</p>



<a name="322218866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322218866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322218866">(Jan 19 2023 at 08:07)</a>:</h4>
<p>No, lists can't be infinite. This lemma can be used to give a bijection between l1 and l2 but there's still more work to do after that.</p>



<a name="322220459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322220459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322220459">(Jan 19 2023 at 08:17)</a>:</h4>
<p>Ok. Thank you.</p>



<a name="322221110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322221110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322221110">(Jan 19 2023 at 08:21)</a>:</h4>
<p>Would the rest consist of getting a bijection between (ℕ - l1) and (ℕ - l2) and then somehow combining the two bijections?</p>



<a name="322221753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322221753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322221753">(Jan 19 2023 at 08:25)</a>:</h4>
<p>Right, but there's already a full proof above, written after Anne's suggestion</p>



<a name="322222028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322222028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kayla Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322222028">(Jan 19 2023 at 08:26)</a>:</h4>
<p>I was just curious if it could be made more succinct.</p>



<a name="322222660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/existence%20of%20equiv%20mapping%20nodup%20same%20length%20lists/near/322222660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/existence.20of.20equiv.20mapping.20nodup.20same.20length.20lists.html#322222660">(Jan 19 2023 at 08:30)</a>:</h4>
<p>That's an NP hard problem but the answer is probably "yes".</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>