---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html">cyclic ring</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="289347539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289347539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289347539">(Jul 12 2022 at 16:05)</a>:</h4>
<p>How easy is it to define R[X] / (X^n - 1) for arbitrary rings R and naturals n?</p>



<a name="289348566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289348566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289348566">(Jul 12 2022 at 16:13)</a>:</h4>
<p>Is R commutative?</p>



<a name="289348853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289348853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289348853">(Jul 12 2022 at 16:15)</a>:</h4>
<p>What do you want about it? Is this enough?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="bp">⧸</span> <span class="n">ideal.span</span> <span class="o">({</span><span class="n">X</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">R</span><span class="o">[</span><span class="n">X</span><span class="o">])</span>
</code></pre></div>



<a name="289362113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289362113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289362113">(Jul 12 2022 at 17:54)</a>:</h4>
<p>R is commutative. That looks fairly nice - what I want to do is treat fin n -&gt; R as if it was that (that is to say, transport the addition and multiplication over).</p>



<a name="289362641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289362641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289362641">(Jul 12 2022 at 17:58)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/cyclotomic_field">docs#cyclotomic_field</a> for the field case has some fair api</p>



<a name="289368767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289368767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gian Cordana Sanjaya <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289368767">(Jul 12 2022 at 18:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330967">Wrenna Robson</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/cyclic.20ring/near/289362113">said</a>:</p>
<blockquote>
<p>R is commutative. That looks fairly nice - what I want to do is treat fin n -&gt; R as if it was that (that is to say, transport the addition and multiplication over).</p>
</blockquote>
<p>Hmm... just out of curiosity, can't we use a group ring, something like R[multiplicative (zmod n)]? Is there a code for group rings?</p>



<a name="289370763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289370763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289370763">(Jul 12 2022 at 19:01)</a>:</h4>
<p>Yes and yes! Probably they're called monoid algebras or something...</p>



<a name="289370994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289370994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289370994">(Jul 12 2022 at 19:03)</a>:</h4>
<p>We have <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra">docs#monoid_algebra</a></p>



<a name="289397283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289397283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289397283">(Jul 12 2022 at 23:09)</a>:</h4>
<p>Hmm hmm!</p>



<a name="289399472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289399472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289399472">(Jul 12 2022 at 23:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330967">Wrenna Robson</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/cyclic.20ring/near/289362113">said</a>:</p>
<blockquote>
<p>R is commutative. That looks fairly nice - what I want to do is treat fin n -&gt; R as if it was that (that is to say, transport the addition and multiplication over).</p>
</blockquote>
<p>Do you really want to transport multiplication over? fin n -&gt; R has the product ring structure with componentwise multiplication, I think.</p>



<a name="289400535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289400535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289400535">(Jul 12 2022 at 23:55)</a>:</h4>
<p><code>add_monoid_algebra R (zmod n)</code> sound like what you want based on the original message</p>



<a name="289400785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289400785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289400785">(Jul 12 2022 at 23:59)</a>:</h4>
<blockquote>
<p><code>add_monoid_algebra R (zmod n)</code> sound like what you want based on the original message</p>
</blockquote>
<p>Seems great, and the underlying <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.to_fun">docs#finsupp.to_fun</a> has type defeq to fin n -&gt; R.</p>



<a name="289417529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289417529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289417529">(Jul 13 2022 at 05:37)</a>:</h4>
<p>Or if computability is a concern, <code>⊕ i : zmod n, R</code> (open_locale direct_sum)</p>



<a name="289417660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289417660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289417660">(Jul 13 2022 at 05:40)</a>:</h4>
<p>Actually what I said it's not correct. Only when it's <code>add_monoid_algebra R (zmod (n+1))</code>, the type is defeq to <code>fin (n+1) -&gt; R</code>.</p>



<a name="289419352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289419352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289419352">(Jul 13 2022 at 06:14)</a>:</h4>
<blockquote>
<p>Or if computability is a concern, ⊕ i : zmod n, R (open_locale direct_sum)</p>
</blockquote>
<p>That <code>⊕</code> needs to be bigger ... \O+<br>
but this doesn't work out of the box:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.direct_sum.ring</span>
<span class="kn">import</span> <span class="n">data.zmod.defs</span>
<span class="n">open_locale</span> <span class="n">direct_sum</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">R</span> <span class="n">n</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="o">(</span><span class="bp">⨁</span> <span class="n">i</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">n</span><span class="o">,</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply_instance</span>
</code></pre></div>
<p>We need a instance of <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.gcomm_ring">docs#direct_sum.gcomm_ring</a> for constant A for <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.comm_ring">docs#direct_sum.comm_ring</a> to apply. direct_sum uses dfinsupp, which is more computable finsupp; but I think the correct solution is to make finsupp more computable.</p>



<a name="289419639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289419639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289419639">(Jul 13 2022 at 06:20)</a>:</h4>
<p>Oh, that instance is supposed to exist</p>



<a name="289419650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289419650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289419650">(Jul 13 2022 at 06:20)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/comm_semiring.direct_sum_gcomm_semiring">docs#comm_semiring.direct_sum_gcomm_semiring</a> already exists, I guess I forgot to add the ring version</p>



<a name="289419665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289419665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289419665">(Jul 13 2022 at 06:20)</a>:</h4>
<p>(originally the ring version wasn't needed, but then <code>ring.int_cast</code> appeared and now it is)</p>



<a name="289419780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289419780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289419780">(Jul 13 2022 at 06:23)</a>:</h4>
<p>But I agree that a better fix might be to redefine <code>finsupp</code>; I know people keep saying "polynomial being noncomputable is a feature", but I don't see why that means <code>finsupp</code> needs to be noncomputable too</p>



<a name="289430577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289430577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289430577">(Jul 13 2022 at 08:53)</a>:</h4>
<p>So the reason I wanted it on fin n -&gt; R is that I also want the Hamming distance on this thing... but I may have other solutions to that.</p>



<a name="289431335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289431335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289431335">(Jul 13 2022 at 09:01)</a>:</h4>
<p>You can cast <code>direct_sum</code> and <code>add_monoid_algebra</code> to a function</p>



<a name="289432217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289432217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289432217">(Jul 13 2022 at 09:11)</a>:</h4>
<p>Aye. Difference being that for Hamming weight the domain has to be finite, wheras that isn't a requirement for a finsupp.</p>



<a name="289432247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289432247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289432247">(Jul 13 2022 at 09:12)</a>:</h4>
<p>What exactly is it about the finsupp construction that makes it non-constructive?</p>



<a name="289433212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289433212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289433212">(Jul 13 2022 at 09:20)</a>:</h4>
<p>Sure, but <code>zmod n</code> is finite (n≠0) so that's not relevant here?</p>



<a name="289433403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289433403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289433403">(Jul 13 2022 at 09:22)</a>:</h4>
<p>The constructivity is lost in <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.has_add">docs#finsupp.has_add</a> which needs to know which coefficients are zero. Rather than requiring <code>decidable_eq</code> on the coefficients which would be annoying, it uses classical decidability</p>



<a name="289433464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289433464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289433464">(Jul 13 2022 at 09:22)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/dfinsupp.has_add">docs#dfinsupp.has_add</a> uses an approach which does not require knowing which coefficients are zero (by storing the set of elements that <em>might</em> not be zero instead of the ones that are non-zero)</p>



<a name="289433514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289433514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289433514">(Jul 13 2022 at 09:23)</a>:</h4>
<p>Oh, indeed, here it is not relevant.</p>



<a name="289439436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289439436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289439436">(Jul 13 2022 at 10:27)</a>:</h4>
<p>God the finsupp file is massive. It feels like the first step for a refactor is just splitting it up...</p>



<a name="289439632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289439632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289439632">(Jul 13 2022 at 10:30)</a>:</h4>
<p>I was about to ask why has_add needs decidable equality on the coefficients but of course it's because adding it might change the zero set...</p>



<a name="289443143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289443143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289443143">(Jul 13 2022 at 11:15)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> was also looking at trying such a refactor, it might be good to coordinate</p>



<a name="289464053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/cyclic%20ring/near/289464053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/cyclic.20ring.html#289464053">(Jul 13 2022 at 14:06)</a>:</h4>
<p>It's certainly not something I'd just start without consultation! But if a division of labour is possible I would be interested in helping.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>