---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html">A typeclass for nat subtraction</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="227104517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227104517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227104517">(Feb 20 2021 at 17:11)</a>:</h4>
<p>It would be nice if <code>fin 3 -&gt; nat</code> could inherit nat subtraction element wise, but there is no typeclass that axiomatizes nat subtraction, meaning that there are no lemmas that would automatically be applicable. <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.nat_sub">docs#finsupp.nat_sub</a> is something that could benefit from this.</p>



<a name="227105588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227105588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227105588">(Feb 20 2021 at 17:31)</a>:</h4>
<p>You could still give pi-types an elementwise <code>has_sub</code>, right?</p>



<a name="227107160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107160">(Feb 20 2021 at 17:59)</a>:</h4>
<p>Yes, but it would be nice to show that <code>a - 0 = a</code>, <code>a - a = 0</code>, and <code>0 - a = 0</code> for the pi type too</p>



<a name="227107233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107233">(Feb 20 2021 at 18:00)</a>:</h4>
<p>And be able to use the same lemma name for those rewrites on both nat and pi-types-to-nat</p>



<a name="227107246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107246">(Feb 20 2021 at 18:01)</a>:</h4>
<p>We should call it <code>monud</code> <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="227107350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107350">(Feb 20 2021 at 18:02)</a>:</h4>
<p>I guess I'm asking for two typeclasses, since the first two of those axioms are satisfied by add_group, but the latter diverges</p>



<a name="227107410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107410">(Feb 20 2021 at 18:03)</a>:</h4>
<p>So nat would implement <code>saturated_sub</code>, and both saturated_sub and add_group implement <code>cancel_sub</code> or something</p>



<a name="227107471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107471">(Feb 20 2021 at 18:04)</a>:</h4>
<p>the first one seems like it should be an extension of add_cancel_monoid satisfying <code>a + b - b = a</code></p>



<a name="227107617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107617">(Feb 20 2021 at 18:07)</a>:</h4>
<p>Isn't there a <code>pi.semiring</code> instance?</p>



<a name="227107632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107632">(Feb 20 2021 at 18:07)</a>:</h4>
<p>Oh sorry, semiring doesn't have sub</p>



<a name="227107650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227107650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227107650">(Feb 20 2021 at 18:08)</a>:</h4>
<p>(yet another reason why no one should ever use nat sub...)</p>



<a name="227108794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227108794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227108794">(Feb 20 2021 at 18:27)</a>:</h4>
<p>There are pi instances for most typeclasses - the issue is that there is no typeclass that nat subtraction satisfies, so pi instances can't inherit any lemmas about it</p>



<a name="227109233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109233">(Feb 20 2021 at 18:35)</a>:</h4>
<p>Do we have <a href="https://leanprover-community.github.io/mathlib_docs/find/cancellative_semiring">docs#cancellative_semiring</a> ?</p>



<a name="227109293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109293">(Feb 20 2021 at 18:36)</a>:</h4>
<p>I guess not, but if we did you could define subtraction on such things similarly to nat subtraction (sending something to zero when it doesn't make sense)</p>



<a name="227109333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109333">(Feb 20 2021 at 18:37)</a>:</h4>
<p>Then define the ring-completion and prove that a cancellative semiring embeds in its ring completion, thereby generalizing a bunch of results about the interaction between nat and int</p>



<a name="227109380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109380">(Feb 20 2021 at 18:38)</a>:</h4>
<p>Here's some precedent <a href="https://en.wikipedia.org/wiki/Monus">https://en.wikipedia.org/wiki/Monus</a> (the long version of <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>'s suggested name might be  <code>comm_add_monoid_with_monus</code>)</p>



<a name="227109571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109571">(Feb 20 2021 at 18:41)</a>:</h4>
<p>In this version, <code>comm_add_monoid_with_monus</code> starts with a <code>comm_add_monoid</code> whose addition operation defines a partial order, and then <code>a - b</code> is the least <code>c</code> that solves <code>a &lt;= b + c</code></p>



<a name="227109589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/A%20typeclass%20for%20nat%20subtraction/near/227109589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/A.20typeclass.20for.20nat.20subtraction.html#227109589">(Feb 20 2021 at 18:41)</a>:</h4>
<p>I don't think this axiomatizes <span class="user-mention" data-user-id="310045">@Eric Wieser</span>'s original use case though.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>