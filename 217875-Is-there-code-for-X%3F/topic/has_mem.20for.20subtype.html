---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html">has_mem for subtype</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="199382962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199382962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199382962">(Jun 01 2020 at 15:29)</a>:</h4>
<p>I'm not sure if this should go here, or in "new members"... is there a standard way of doing this? <code>apply_instance</code> didn't find anything.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_mem</span> <span class="n">T</span> <span class="o">(</span><span class="n">set</span> <span class="o">(</span><span class="n">subtype</span> <span class="n">S</span><span class="o">))</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="199383032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383032">(Jun 01 2020 at 15:29)</a>:</h4>
<p>What are you trying to ask? <del>This doesn't seem to make any sense.</del></p>



<a name="199383119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383119">(Jun 01 2020 at 15:30)</a>:</h4>
<p>I want an instance of <code>has_mem</code> for subsets of a subtype</p>



<a name="199383154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383154">(Jun 01 2020 at 15:30)</a>:</h4>
<p>I'm a bit surprised it doesn't exist in mathlib.</p>



<a name="199383168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383168">(Jun 01 2020 at 15:30)</a>:</h4>
<p>Oh I see, so if <code>U : subtype S</code> then you can imagine U as a subset of T.</p>



<a name="199383230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383230">(Jun 01 2020 at 15:31)</a>:</h4>
<p><del>You understand that there is some coercion happening when you write <code>subtype S</code>? <code>S</code> is a term, not a type.</del></p>



<a name="199383415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383415">(Jun 01 2020 at 15:32)</a>:</h4>
<p><del>You have disappeared into another topic, but I guess <code>subtype S</code> is a bit weird, because maybe if you wanted <code>S</code> to be a type you would have used a subtype of T instead of <code>set T</code></del></p>



<a name="199383535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383535">(Jun 01 2020 at 15:33)</a>:</h4>
<p>I could get by with this too: </p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">set</span> <span class="o">(</span><span class="n">subtype</span> <span class="n">S</span><span class="o">))</span> <span class="o">(</span><span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


<p>but <code>apply_instance</code> doesn't find anything for this either.</p>



<a name="199383646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383646">(Jun 01 2020 at 15:34)</a>:</h4>
<p>As you say, I just want to think of subsets of a subtype of <code>T</code> as subsets of <code>T</code>.</p>



<a name="199383726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383726">(Jun 01 2020 at 15:34)</a>:</h4>
<p>I see. Most of what I said was nonsense, sorry (I'd forgotten what <code>subtype</code> did).</p>



<a name="199383770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383770">(Jun 01 2020 at 15:35)</a>:</h4>
<p>Yeah, I agree that this looks like it could be a thing.</p>



<a name="199383964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199383964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199383964">(Jun 01 2020 at 15:37)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_mem</span> <span class="n">T</span> <span class="o">(</span><span class="n">set</span> <span class="o">(</span><span class="n">subtype</span> <span class="n">S</span><span class="o">))</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">t</span> <span class="n">U</span><span class="o">,</span> <span class="n">t</span> <span class="err">∈</span> <span class="n">subtype</span><span class="bp">.</span><span class="n">val</span> <span class="err">&#39;&#39;</span> <span class="n">U</span><span class="bp">⟩</span>
</code></pre></div>



<a name="199384145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384145">(Jun 01 2020 at 15:38)</a>:</h4>
<p><code>instance bar (T : Type*) (S : set T) : has_coe (subtype S) T := by apply_instance</code> exists</p>



<a name="199384301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384301">(Jun 01 2020 at 15:40)</a>:</h4>
<p>but you can't coerce from <code>set (subtype S)</code> to <code>set T</code> because these are terms, not types.</p>



<a name="199384374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384374">(Jun 01 2020 at 15:41)</a>:</h4>
<p>I thought <code>set T</code> is the type of subsets of <code>T</code>, no?</p>



<a name="199384444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384444">(Jun 01 2020 at 15:41)</a>:</h4>
<p>Oh yeah you're right again, so there could be a coercion</p>



<a name="199384459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384459">(Jun 01 2020 at 15:41)</a>:</h4>
<p>It's easy to do once you have <code>has_mem</code></p>



<a name="199384466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384466">(Jun 01 2020 at 15:41)</a>:</h4>
<p>I haven't done any Lean for a few days, I need to warm up :-)</p>



<a name="199384573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384573">(Jun 01 2020 at 15:42)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">foo2</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">set</span> <span class="o">(</span><span class="n">subtype</span> <span class="n">S</span><span class="o">))</span> <span class="o">(</span><span class="n">set</span> <span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">t</span><span class="o">,</span> <span class="n">t</span> <span class="err">∈</span> <span class="n">U</span> <span class="bp">⟩</span>
</code></pre></div>



<a name="199384653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384653">(Jun 01 2020 at 15:43)</a>:</h4>
<p>I wasn't familiar with the <code>''</code> notation, though. Thanks for that!</p>



<a name="199384757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199384757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199384757">(Jun 01 2020 at 15:44)</a>:</h4>
<p>or <code>instance (T : Type*) (S : set T) : has_coe (set (subtype S)) (set T) := ⟨λ U t, t ∈ subtype.val '' U⟩</code> if the other instance isn't there. Yeah, at least I got the notation for <code>set.image</code> right :-)</p>



<a name="199427253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199427253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199427253">(Jun 01 2020 at 21:37)</a>:</h4>
<p>This instance is not okay, because <code>set (subtype S)</code> already has a <code>has_mem</code>, with <code>subtype S</code> on the left, and the left argument of <code>has_mem</code> is an out_param so there is only allowed to be one such instance.</p>



<a name="199494904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/has_mem%20for%20subtype/near/199494904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/has_mem.20for.20subtype.html#199494904">(Jun 02 2020 at 14:00)</a>:</h4>
<p>Is this also an issue for the <code>has_coe</code> instance that Kevin mentioned?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>