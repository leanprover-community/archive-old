---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/matrices.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html">matrices</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="244292982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244292982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244292982">(Jun 29 2021 at 14:46)</a>:</h4>
<p>Are the identity matrices and permutation matrices defined in mathlib?</p>



<a name="244293146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244293146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244293146">(Jun 29 2021 at 14:47)</a>:</h4>
<p>The identity matrix is simply <code>1</code> in the correct type. I don't know about permutation matrices.</p>



<a name="244293356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244293356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244293356">(Jun 29 2021 at 14:49)</a>:</h4>
<p><code>perm.to_matrix</code> would be a good definition. I don't think it exists yet.</p>



<a name="244293434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244293434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244293434">(Jun 29 2021 at 14:49)</a>:</h4>
<p>At this moment you can compose <a href="https://leanprover-community.github.io/mathlib_docs/find/pequiv.to_matrix">docs#pequiv.to_matrix</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.to_pequiv">docs#equiv.to_pequiv</a></p>



<a name="244293688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244293688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244293688">(Jun 29 2021 at 14:51)</a>:</h4>
<p>See for example <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.det_permutation">docs#matrix.det_permutation</a> for how this is used</p>



<a name="244295529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/244295529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#244295529">(Jun 29 2021 at 15:00)</a>:</h4>
<p>How about anything related to permutation equivalence or similarity of matrices?</p>



<a name="280731438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280731438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280731438">(Apr 30 2022 at 11:23)</a>:</h4>
<p>Where is the correspondence between matrices and linear maps?</p>



<a name="280731548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280731548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280731548">(Apr 30 2022 at 11:25)</a>:</h4>
<p><code>matrix/to_lin.lean</code>.</p>



<a name="280732805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280732805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280732805">(Apr 30 2022 at 11:57)</a>:</h4>
<p>Ugh, this is too horrible. I want to use the fact that invertible matrices over a ring with invariant basis number are square. However our definition of IBN is in terms of linear maps, not matrices. So fine, you say, let's use <code>matrix.to_lin'</code> and <code>linear_map.to_matrix'</code> to convert. However, these are set up as <code>R</code>-linear equivalences, and in order to have that, whoever wrote the file assumed the ring was commutative. This means that I can't cope with division rings. Now everything is fine, you can define <code>matrix.to_lin'</code> as an <em>additive</em> equivalence just fine when <code>R</code> is non-commutative (and it still plays well with composition/matrix multiplication). But it means that I need to rip out and rewrite <code>linear_algebra/matrix/to_lin.lean</code> to handle noncommutative rings... :-(</p>



<a name="280733872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280733872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280733872">(Apr 30 2022 at 12:23)</a>:</h4>
<p>Oh ****, it's even worse than that. Because we've set up the scalar action of a ring on functions to that ring by left multiplication (perfectly reasonably), if we want to convert a matrix to an <code>R</code>-linear map we need to use <code>matrix.vec_mul</code>, not <code>matrix.mul_vec</code>. Making that change at this point is too horrible to contemplate right now.</p>



<a name="280734104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280734104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280734104">(Apr 30 2022 at 12:29)</a>:</h4>
<p>I am going to go to sleep and hope that in the meantime someone says "oh, I love doing refactors like that".</p>



<a name="280735957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280735957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280735957">(Apr 30 2022 at 13:14)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.to_lin">docs#matrix.to_lin</a> could be a made a linear map over a different ring</p>



<a name="280763109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763109">(May 01 2022 at 00:01)</a>:</h4>
<p>We just need to get on with the bimodule / two-sided scalar actions refactor. Given a not-necessarily-commutative ring R, R is an R-R bimodule, and functions <code>X -&gt; R</code> are an R-R bimodule, and also has actions by matrices from the left and from the right. Acting by a matrix on the left gives a function <code>X -&gt; R</code> to <code>Y -&gt; R</code>, and this is linear with respect to the right action by R. Conversely on the other side.</p>



<a name="280763125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763125">(May 01 2022 at 00:01)</a>:</h4>
<p>We need to admit to these facts in <code>linear_algebra/matrix/to_lin.lean</code>. :-)</p>



<a name="280763193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763193">(May 01 2022 at 00:03)</a>:</h4>
<p>A good challenge, I think, is proving that invertible matrices over a ring with invariant basis number are square. This is absolutely maths-trivial, but unspeakable in current mathlib.</p>



<a name="280763338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763338">(May 01 2022 at 00:06)</a>:</h4>
<p>I think we have all the pieces you need for the bimodules spelling already</p>



<a name="280763366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763366">(May 01 2022 at 00:07)</a>:</h4>
<p>You can make <code>to_lin</code> a <code>(n → R) →ₗ [Rᵐᵒᵖ] (n → R)</code> today</p>



<a name="280763489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280763489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280763489">(May 01 2022 at 00:11)</a>:</h4>
<p>Note that it's not possible to have an action of <code>matrix m n R</code> on <code>n → R</code> (at least, not a <code>mul_action</code>), because rectangular matrices have a type incompatible with <code>has_mul</code></p>



<a name="280768349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280768349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280768349">(May 01 2022 at 02:28)</a>:</h4>
<p>I don't mind that we can't have matrices act by a <code>mul_action</code>.</p>



<a name="280768392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280768392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280768392">(May 01 2022 at 02:28)</a>:</h4>
<p>I've put up <a href="https://github.com/leanprover-community/mathlib/pull/13845">#13845</a>, which illustrates the change I'd like: <code>matrix.square_of_invertible</code> to work without the commutativity assumption.</p>



<a name="280768469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280768469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280768469">(May 01 2022 at 02:30)</a>:</h4>
<p>I don't think having <code>to_lin'</code> produce a <code>(n → R) →ₗ [Rᵐᵒᵖ] (n → R)</code> is actually that helpful. Instead I want <code>to_lin</code> to use <code>vec_mul</code> instead of <code>mul_vec</code>, but I have no idea how much refactoring that will take.</p>



<a name="280768487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280768487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280768487">(May 01 2022 at 02:31)</a>:</h4>
<p>I guess there should just be two versions of <code>to_lin'</code>, one via the right action (giving an R-linear map) and one via the left action (giving an R^mop-linear map).</p>



<a name="280782784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280782784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280782784">(May 01 2022 at 08:48)</a>:</h4>
<p>My claim is that the one via the left action that we currently have is the map that people would expect to find, and that <code>→ₗ [Rᵐᵒᵖ]</code> is unhelpful only because we're missing generalizations elsewhere too</p>



<a name="280824020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/matrices/near/280824020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/matrices.html#280824020">(May 02 2022 at 01:18)</a>:</h4>
<p>Okay, <a href="https://github.com/leanprover-community/mathlib/pull/13870">#13870</a> does the bare beginnings of this refactor, for now just giving me what I need to proceed with some representation theory, and an extensive note explaining what will need to happen later.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>