---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html">Finsupp generalisations</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="305713882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305713882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305713882">(Oct 23 2022 at 21:57)</a>:</h4>
<p>Is there a generalisation of <code>finsupp</code> to things like <code>option</code> or <code>has_bot</code>?</p>



<a name="305715319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715319">(Oct 23 2022 at 22:11)</a>:</h4>
<p>What do you mean?</p>



<a name="305715357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715357">(Oct 23 2022 at 22:11)</a>:</h4>
<p>Finitely supported functions where the support is everything that not "something".</p>



<a name="305715519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715519">(Oct 23 2022 at 22:13)</a>:</h4>
<p>Yeah, more precisely, a structure with fields something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">support</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span>
<span class="o">(</span><span class="n">to_fun</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">option</span> <span class="n">M</span><span class="o">)</span>
<span class="o">(</span><span class="n">mem_support_to_fun</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">self.support</span> <span class="bp">↔</span> <span class="n">self.to_fun</span> <span class="n">a</span> <span class="bp">≠</span> <span class="n">none</span><span class="o">)</span>
</code></pre></div>
<p>but with all the API that goes alongside <code>finsupp</code>.</p>



<a name="305715626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715626">(Oct 23 2022 at 22:14)</a>:</h4>
<p>It's probably rather easy to construct the equivalence to <code>finsupp α (with_zero M)</code> and transport all the lemmas across if I need them,</p>



<a name="305715648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715648">(Oct 23 2022 at 22:14)</a>:</h4>
<p>but if the API already exists that would of course be a little nicer.</p>



<a name="305715842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305715842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305715842">(Oct 23 2022 at 22:16)</a>:</h4>
<p>Oh I'm finally there! You want the <em>target</em> to be the <code>option</code>.</p>



<a name="305724231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305724231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305724231">(Oct 23 2022 at 23:50)</a>:</h4>
<p>would it make sense to have a <code>has_zero</code> instance for <code>option M</code>? or would that conflict with the existing <code>with_zero</code> and <code>with_one</code> functions?</p>



<a name="305724750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305724750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305724750">(Oct 23 2022 at 23:56)</a>:</h4>
<p>on a side note, this doesn't seem right: <a href="/user_uploads/3121/iNCzuQwPhhmKJG5pj_DpBfHh/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/iNCzuQwPhhmKJG5pj_DpBfHh/image.png" title="image.png"><img src="/user_uploads/3121/iNCzuQwPhhmKJG5pj_DpBfHh/image.png"></a></div>



<a name="305724841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305724841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305724841">(Oct 23 2022 at 23:57)</a>:</h4>
<p>might have to do with the <code>@[to_additive]</code> on the repr for one</p>



<a name="305725071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305725071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305725071">(Oct 23 2022 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> I think you added these instances... am I missing something or is there duplication here?</p>



<a name="305725227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305725227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305725227">(Oct 24 2022 at 00:01)</a>:</h4>
<p>That looks like a mistake indeed</p>



<a name="305725279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305725279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305725279">(Oct 24 2022 at 00:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380294">Matt Diamond</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Finsupp.20generalisations/near/305724231">said</a>:</p>
<blockquote>
<p>would it make sense to have a <code>has_zero</code> instance for <code>option M</code>? or would that conflict with the existing <code>with_zero</code> and <code>with_one</code> functions?</p>
</blockquote>
<p>I think a better approach would be to redefine <code>finsupp A B</code> as <code>finsupp' A B 0</code> or something, if we want to go down this path.</p>



<a name="305725369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305725369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305725369">(Oct 24 2022 at 00:02)</a>:</h4>
<p>makes sense... that would certainly be more flexible</p>



<a name="305760413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305760413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305760413">(Oct 24 2022 at 07:20)</a>:</h4>
<p>Whoops! You're right I added one too many.</p>



<a name="305812883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305812883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305812883">(Oct 24 2022 at 12:56)</a>:</h4>
<p>This is a refactor I think I'd be comfortable trying to do if other people think this is a good idea.</p>



<a name="305819620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/305819620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#305819620">(Oct 24 2022 at 13:31)</a>:</h4>
<p>Note that <a href="https://github.com/leanprover-community/mathlib/pull/16160">#16160</a> is a similar refactor (and accidentally the goal <a href="https://github.com/leanprover-community/mathlib/pull/15161">#15161</a> is something related to finsupp).</p>



<a name="306301812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/306301812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#306301812">(Oct 26 2022 at 18:15)</a>:</h4>
<p>I'd like to start writing this PR. The documentation says that I should ask for write access to non-master mathlib branches - could someone please do this for me? My GitHub username is <code>zeramorphic</code>.</p>



<a name="306302884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/306302884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#306302884">(Oct 26 2022 at 18:21)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="2494">@maintainers</span></p>



<a name="306310491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/306310491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#306310491">(Oct 26 2022 at 19:02)</a>:</h4>
<p><span class="user-mention" data-user-id="492774">@Sky Wilshaw</span> Invitation sent: <a href="https://github.com/leanprover-community/mathlib/invitations">https://github.com/leanprover-community/mathlib/invitations</a></p>



<a name="306310563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Finsupp%20generalisations/near/306310563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Finsupp.20generalisations.html#306310563">(Oct 26 2022 at 19:03)</a>:</h4>
<p>Thank you!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>