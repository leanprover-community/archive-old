---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html">graded rings</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="259105057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259105057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259105057">(Oct 26 2021 at 14:31)</a>:</h4>
<p>I'm back thinking about graded rings and how better to do <a href="https://github.com/leanprover-community/mathlib/issues/9717">#9717</a> . I think that we need some internally graded ring. Do we have something like this already? I just looked around and found internally graded monoids, groups and modules, but not rings:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.direct_sum.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">ι</span><span class="o">]</span>
  <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">add_subgroup</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">ι</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">plays_well_with_multiplication</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">ring_is_internally_graded</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">direct_sum.add_subgroup_is_internal</span> <span class="n">A</span> <span class="bp">∧</span> <span class="n">plays_well_with_multiplication</span> <span class="n">A</span>
</code></pre></div>
<p>Furthermore, should it be a typeclass?</p>



<a name="259106401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259106401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259106401">(Oct 26 2021 at 14:39)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="310045">@Eric Wieser</span></p>



<a name="259117003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259117003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259117003">(Oct 26 2021 at 15:45)</a>:</h4>
<p>I think <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.gsemiring.of_submodules">docs#direct_sum.gsemiring.of_submodules</a> is the closest we have</p>



<a name="259117102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259117102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259117102">(Oct 26 2021 at 15:46)</a>:</h4>
<p>I think what you're proposing is replacing its arguments with typeclasses</p>



<a name="259118004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259118004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259118004">(Oct 26 2021 at 15:53)</a>:</h4>
<p>Also don't you need that the bijection implied by <code>is_internal</code> preserves multiplication? Or is that always true?</p>



<a name="259124930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259124930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259124930">(Oct 26 2021 at 16:41)</a>:</h4>
<p>I didn't define the external multiplication at all</p>



<a name="259124967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259124967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259124967">(Oct 26 2021 at 16:41)</a>:</h4>
<p>so you can just define it to be the internal multiplication</p>



<a name="259125486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259125486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259125486">(Oct 26 2021 at 16:44)</a>:</h4>
<p>I suspect I can make a term of type <code>direct_sum.gsemiring (lam x, \u(A x))</code> knowing just <code>plays_well_with_multiplication</code> and also <code>plays_well_with_identity : 1 \in A 0</code> (which I forgot above).</p>



<a name="259136461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259136461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259136461">(Oct 26 2021 at 17:59)</a>:</h4>
<p>Yes, I'm sure you can make that instance</p>



<a name="259136706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259136706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259136706">(Oct 26 2021 at 18:01)</a>:</h4>
<p>My question is whether you have enough to follow up with <code>R ≃+* ⊕ i, A i</code></p>



<a name="259138261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259138261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259138261">(Oct 26 2021 at 18:13)</a>:</h4>
<p>And I claim that mathematically I do, although one will need to know that an abelian group homomorphism from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>⊕</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\oplus_i A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to somewhere is determined by what it does on each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>



<a name="259138658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259138658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259138658">(Oct 26 2021 at 18:16)</a>:</h4>
<p>That's <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_semiring">docs#direct_sum.to_semiring</a></p>



<a name="259138807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259138807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259138807">(Oct 26 2021 at 18:17)</a>:</h4>
<p>Oh, or maybe just <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_monoid">docs#direct_sum.to_monoid</a> since you said abelian group not ring</p>



<a name="259138954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259138954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259138954">(Oct 26 2021 at 18:18)</a>:</h4>
<p>I think the pieces you need are mostly there, just not the API</p>



<a name="259146014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259146014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259146014">(Oct 26 2021 at 19:09)</a>:</h4>
<p>I haven't written any non-teaching Lean code for so long, so I thought I'd have a go; I didn't finish though and now I need to go and cook:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.direct_sum.algebra</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">ι</span><span class="o">]</span>
  <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">add_subgroup</span> <span class="n">R</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">ι</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">plays_well_with_multiplication</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ι</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">},</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">plays_well_with_one</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">A</span> <span class="mi">0</span>

<span class="kd">def</span> <span class="n">ring_is_internally_graded</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">direct_sum.add_subgroup_is_internal</span> <span class="n">A</span> <span class="bp">∧</span>
  <span class="n">plays_well_with_one</span> <span class="n">A</span> <span class="bp">∧</span>
  <span class="n">plays_well_with_multiplication</span> <span class="n">A</span>

<span class="kd">def</span> <span class="n">gsemiring.of_ring_is_internally_graded</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">ring_is_internally_graded</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">direct_sum.gsemiring</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span> <span class="o">⟨</span><span class="n">hint</span><span class="o">,</span> <span class="n">hone</span><span class="o">,</span> <span class="n">hmul</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">h</span> <span class="k">in</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="n">ai</span> <span class="n">aj</span><span class="o">,</span> <span class="o">⟨</span><span class="n">ai.1</span> <span class="bp">*</span> <span class="n">aj.1</span><span class="o">,</span> <span class="n">hmul</span> <span class="n">ai.2</span> <span class="n">aj.2</span><span class="o">⟩,</span>
  <span class="n">mul_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="n">ai</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">mul_zero</span> <span class="n">_</span><span class="o">},</span>
  <span class="n">zero_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">zero_mul</span> <span class="n">_</span><span class="o">},</span>
  <span class="n">mul_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">mul_add</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">},</span>
  <span class="n">add_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">add_mul</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">},</span>
  <span class="n">one</span> <span class="o">:=</span> <span class="o">⟨(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="n">hone</span><span class="o">⟩,</span>
  <span class="n">one_mul</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">rintro</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">ai</span><span class="o">⟩,</span> <span class="n">unfold</span> <span class="n">has_one.one</span><span class="o">,</span> <span class="n">unfold</span> <span class="n">has_mul.mul</span><span class="o">,</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">mul_one</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">rintro</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">ai</span><span class="o">⟩,</span> <span class="n">unfold</span> <span class="n">has_one.one</span><span class="o">,</span> <span class="n">unfold</span> <span class="n">has_mul.mul</span><span class="o">,</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">rintro</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">ai</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">j</span><span class="o">,</span> <span class="n">aj</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">k</span><span class="o">,</span> <span class="n">ak</span><span class="o">⟩,</span> <span class="n">unfold</span> <span class="n">has_mul.mul</span><span class="o">,</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">],</span> <span class="o">},</span>
  <span class="n">gnpow</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">n</span> <span class="n">i</span><span class="o">,</span> <span class="n">nat.rec_on</span> <span class="n">n</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">ai</span><span class="o">,</span> <span class="o">⟨(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="kd">by</span> <span class="n">convert</span> <span class="n">hone</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">zero_smul</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩)</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">f</span> <span class="n">ai</span><span class="o">,</span> <span class="o">⟨</span><span class="n">ai.1</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">ai</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="kd">by</span> <span class="n">convert</span> <span class="n">hmul</span> <span class="n">ai.2</span> <span class="o">(</span><span class="n">f</span> <span class="n">ai</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">succ_nsmul</span> <span class="n">i</span> <span class="n">n</span><span class="o">⟩),</span>
  <span class="n">gnpow_zero'</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">gnpow_succ'</span> <span class="o">:=</span> <span class="gr">sorry</span>
  <span class="o">}</span>
</code></pre></div>



<a name="259146034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259146034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259146034">(Oct 26 2021 at 19:09)</a>:</h4>
<p>What are the correct names for all these things which I'm giving silly names to?</p>



<a name="259153221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259153221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259153221">(Oct 26 2021 at 20:02)</a>:</h4>
<p>Your last def would be shorter and sorry-free in terms of <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.gsemiring.of_add_subgroups">docs#direct_sum.gsemiring.of_add_subgroups</a></p>



<a name="259153562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259153562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259153562">(Oct 26 2021 at 20:05)</a>:</h4>
<p>(and does not use the fact the grading is internal!)</p>



<a name="259153756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259153756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259153756">(Oct 26 2021 at 20:06)</a>:</h4>
<p><span class="user-mention" data-user-id="252627">@Jujian Zhang</span> do you want to take over? I'm not sure I'll have any more time for this today</p>



<a name="259154299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259154299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259154299">(Oct 26 2021 at 20:10)</a>:</h4>
<p>I think to make the API worthwhile, the <code>plays_well_with_multiplication</code> defs probably ought to be typeclasses</p>



<a name="259166049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259166049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259166049">(Oct 26 2021 at 21:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.direct_sum.algebra</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">ι</span><span class="o">]</span>
  <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">add_subgroup</span> <span class="n">R</span><span class="o">)</span>

<span class="kd">variable</span> <span class="o">(</span><span class="n">R</span><span class="o">)</span>
<span class="kd">class</span> <span class="n">graded_ring</span> <span class="o">:=</span>
<span class="o">(</span> <span class="n">is_internal</span> <span class="o">:</span>  <span class="n">direct_sum.add_subgroup_is_internal</span> <span class="n">A</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">one_degree_zero</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">A</span> <span class="mi">0</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">mul_respect_grading</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ι</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">},</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">gsemiring.of_ring_is_internally_graded</span> <span class="o">[</span><span class="n">graded_ring</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">direct_sum.gsemiring</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">direct_sum.gsemiring.of_add_subgroups</span> <span class="n">A</span> <span class="o">(</span><span class="n">graded_ring.one_degree_zero</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="n">ai</span> <span class="n">aj</span><span class="o">,</span> <span class="n">graded_ring.mul_respect_grading</span> <span class="n">ai.2</span> <span class="n">aj.2</span><span class="o">)</span>
</code></pre></div>



<a name="259166148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259166148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259166148">(Oct 26 2021 at 21:47)</a>:</h4>
<p>By typeclass, do you mean something like this? Maybe pr <a href="https://github.com/leanprover-community/mathlib/issues/9717">#9717</a> should be rewritten using internal definitions so that homogeneous ideals and other lemmas would work for <code>mv_polynomial</code></p>



<a name="259168685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259168685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259168685">(Oct 26 2021 at 22:07)</a>:</h4>
<p>Can you construct the ring isomorphism <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>≅</mo><msub><mo>⊕</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R\cong \oplus_i A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≅</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>?</p>



<a name="259168729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259168729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259168729">(Oct 26 2021 at 22:08)</a>:</h4>
<p>I guess <code>≃+*</code> will be <a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv">docs#ring_equiv</a></p>



<a name="259171138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259171138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259171138">(Oct 26 2021 at 22:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">test</span> <span class="o">[</span><span class="n">graded_ring</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span> <span class="o">(</span><span class="bp">⨁</span> <span class="n">i</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">≃+*</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span>  <span class="n">direct_sum.to_add_monoid</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">subtype</span><span class="o">,</span> <span class="n">map_zero'</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span> <span class="o">}),</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="o">(</span><span class="n">equiv.of_bijective</span> <span class="n">_</span> <span class="n">graded_ring.is_internal</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">begin</span> <span class="n">refine</span> <span class="n">equiv.symm_apply_apply</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="kd">end</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">begin</span> <span class="n">convert</span> <span class="n">equiv.apply_symm_apply</span> <span class="o">(</span><span class="n">equiv.of_bijective</span> <span class="n">_</span> <span class="n">graded_ring.is_internal</span><span class="o">)</span> <span class="n">_</span><span class="o">,</span> <span class="kd">end</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>



<a name="259171174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259171174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259171174">(Oct 26 2021 at 22:29)</a>:</h4>
<p>This should work (mod <code>sorries</code>)</p>



<a name="259171352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259171352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259171352">(Oct 26 2021 at 22:30)</a>:</h4>
<p>Oh very nice! I think <code>map_mul'</code> was the sorry Eric was concerned about</p>



<a name="259171572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259171572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259171572">(Oct 26 2021 at 22:33)</a>:</h4>
<p>I think the next thing we want is a "project onto I'th factor" function <code>proj i : R -&gt; R</code> and a proof that <code>proj i r ∈ A i</code></p>



<a name="259171920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259171920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259171920">(Oct 26 2021 at 22:37)</a>:</h4>
<p>Can we define <code>proj i</code> to be the composition of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>→</mo><msub><mo>⊕</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R \to \oplus_i A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>⊕</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub><mo>→</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\oplus_i A_i \to A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>→</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">A_i \to R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></p>



<a name="259172251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259172251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259172251">(Oct 26 2021 at 22:41)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="kd">begin</span> <span class="n">rw</span> <span class="o">[</span><span class="n">direct_sum.eq_sum_of</span> <span class="n">_</span> <span class="n">x</span><span class="o">,</span> <span class="n">direct_sum.eq_sum_of</span> <span class="n">_</span> <span class="n">y</span><span class="o">],</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">finset.sum_mul_sum</span><span class="o">,</span> <span class="n">add_monoid_hom.map_sum</span><span class="o">,</span> <span class="n">add_monoid_hom.map_sum</span><span class="o">,</span> <span class="n">add_monoid_hom.map_sum</span><span class="o">,</span> <span class="n">finset.sum_mul_sum</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">finset.sum_congr</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">rintros</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">⟩</span> <span class="n">hmem</span><span class="o">,</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span><span class="o">,</span>
</code></pre></div>



<a name="259172323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259172323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259172323">(Oct 26 2021 at 22:42)</a>:</h4>
<p>Right, this might be the only way to do it</p>



<a name="259172345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259172345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259172345">(Oct 26 2021 at 22:42)</a>:</h4>
<p>Something like this should work: write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>:</mo><msub><mo>⊕</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x:\oplus_i A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_i x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>:</mo><msub><mo>⊕</mo><mi>j</mi></msub><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">y:\oplus_j A_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mbin">⊕</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\sum y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>. Then expand etc.</p>



<a name="259178172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259178172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259178172">(Oct 27 2021 at 00:03)</a>:</h4>
<p>Using <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_semiring">docs#direct_sum.to_semiring</a> will be easier than using <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_add_monid">docs#direct_sum.to_add_monid</a> and filling the map_mul manually (as I said upthread!)</p>



<a name="259178383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259178383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259178383">(Oct 27 2021 at 00:06)</a>:</h4>
<p><span class="user-mention" data-user-id="252627">@Jujian Zhang</span>, your <code>graded_ring</code> typeclass is what my comment was suggesting yes.</p>



<a name="259178730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259178730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259178730">(Oct 27 2021 at 00:12)</a>:</h4>
<p>I'd  argue though that we should use a data-carrying typeclass:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">graded_ring</span> <span class="o">:=</span>
<span class="o">(</span> <span class="n">decompose</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="bp">⊕</span> <span class="n">i</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span>
<span class="o">(</span> <span class="n">left_inv</span> <span class="o">:</span> <span class="n">function.left_inverse</span> <span class="n">decompose</span> <span class="gr">sorry</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">right_inv</span> <span class="o">:</span> <span class="n">function.left_inverse</span> <span class="n">decompose</span> <span class="gr">sorry</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">one_degree_zero</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">A</span> <span class="mi">0</span> <span class="o">)</span>
<span class="o">(</span> <span class="n">mul_respect_grading</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ι</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">},</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span>
</code></pre></div>
<p>Where the <code>sorry</code>s are the <code>to_add_monoid subtype</code> monster I don't want to type on mobile.</p>



<a name="259223259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259223259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259223259">(Oct 27 2021 at 11:17)</a>:</h4>
<p>I have opened another pr (<a href="https://github.com/leanprover-community/mathlib/issues/10002">#10002</a>) containing the above code and an instance that <code>mv_polynomial</code> is graded</p>



<a name="259223639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259223639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259223639">(Oct 27 2021 at 11:21)</a>:</h4>
<p>Thanks! Please update the title to follow the style guide.</p>



<a name="259223921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259223921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259223921">(Oct 27 2021 at 11:23)</a>:</h4>
<p>At some point we will need/want graded algebras. Should we just do everything for graded algebras from the start?</p>



<a name="259223947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259223947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259223947">(Oct 27 2021 at 11:23)</a>:</h4>
<p>So, should the <code>A i</code> be submodules over some base ring?</p>



<a name="259224045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224045">(Oct 27 2021 at 11:24)</a>:</h4>
<p>That would also deal with the ring/semiring distinction (in case someone wants to consider the grading of polynomials over <code>ℕ</code>)</p>



<a name="259224384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224384">(Oct 27 2021 at 11:27)</a>:</h4>
<p>We have all the pieces to build that too</p>



<a name="259224437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224437">(Oct 27 2021 at 11:27)</a>:</h4>
<p>I think the question is whether we want to force users to convert their <code>add_submonoid</code>s and <code>add_subgroup</code>s into nat and int-<code>submodule</code>s.</p>



<a name="259224485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224485">(Oct 27 2021 at 11:28)</a>:</h4>
<p>At the moment, we just duplicate all the API for each of them</p>



<a name="259224598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224598">(Oct 27 2021 at 11:28)</a>:</h4>
<p>My hunch is that whatever the user is doing will almost always be an algebra already. Basically, I claim that every interesting lemma about graded rings also has a companion for graded algebras, and the user should be proving that one instead.</p>



<a name="259224608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224608">(Oct 27 2021 at 11:29)</a>:</h4>
<p>This was the type of problem I was trying to solve with <code>set_like</code> but lost steam on; if we had a typeclass saying "this is a subtype whose addition / smul / zero is the one induced by coercion", then we could generalize</p>



<a name="259224662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224662">(Oct 27 2021 at 11:29)</a>:</h4>
<p>I think there are very few cases where you genuinely want to work with a graded <code>ℤ</code>-algebra, instead of generalizing.</p>



<a name="259224721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259224721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259224721">(Oct 27 2021 at 11:30)</a>:</h4>
<p>For reference, <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_algebra">docs#direct_sum.to_algebra</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.galgebra.of_submodules">docs#direct_sum.galgebra.of_submodules</a> are the parallel defs to <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.to_semiring">docs#direct_sum.to_semiring</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.gsemiring.of_add_subgroups">docs#direct_sum.gsemiring.of_add_subgroups</a>.</p>



<a name="259584677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259584677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259584677">(Oct 29 2021 at 21:19)</a>:</h4>
<p>If ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is graded by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ι</mi><mo>→</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\iota\to A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ι</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, do we require that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mo>=</mo><mi mathvariant="normal">⊥</mi></mrow><annotation encoding="application/x-tex">A_i\cap A_j = \bot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">⊥</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i\ne j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>?</p>



<a name="259585081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259585081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259585081">(Oct 29 2021 at 21:23)</a>:</h4>
<p>Shameless plug of <a href="https://leanprover-community.github.io/mathlib_docs/find/set.pairwise_disjoint">docs#set.pairwise_disjoint</a> and <a href="https://github.com/leanprover-community/mathlib/issues/9898">#9898</a> which gives you the correct generality for what you just said.</p>



<a name="259586550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259586550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259586550">(Oct 29 2021 at 21:40)</a>:</h4>
<p>No it won't, that statement isn't strong enough; you need the <code>sup_indep</code> PR for that, <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>.</p>



<a name="259586595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259586595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259586595">(Oct 29 2021 at 21:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="252627">Jujian Zhang</span>, Are you looking for <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.submodule_is_internal.independent">docs#direct_sum.submodule_is_internal.independent</a>?</p>



<a name="259586778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259586778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259586778">(Oct 29 2021 at 21:42)</a>:</h4>
<p>Uh? Okay. But that's not what Jujian just wrote.</p>



<a name="259586854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259586854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259586854">(Oct 29 2021 at 21:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/graded.20rings/near/259586595">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="252627">Jujian Zhang</span>, Are you looking for <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.submodule_is_internal.independent">docs#direct_sum.submodule_is_internal.independent</a>?</p>
</blockquote>
<p>Thank you.</p>



<a name="259586929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259586929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259586929">(Oct 29 2021 at 21:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/graded.20rings/near/259586778">said</a>:</p>
<blockquote>
<p>Uh? Okay. But that's not what Jujian just wrote.</p>
</blockquote>
<p>I originally wrote <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A_i \cap A_j = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, I thought <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> might be confused with empty set so I changed it to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">⊥</mi></mrow><annotation encoding="application/x-tex">\bot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">⊥</span></span></span></span></p>



<a name="259587131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587131">(Oct 29 2021 at 21:47)</a>:</h4>
<p>No, that's not what I meant. There's a difference between asking pairwise disjointness and arbitrary disjointness.</p>



<a name="259587238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587238">(Oct 29 2021 at 21:49)</a>:</h4>
<p>Typicall, take the vector subspaces of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> <code>(x, 0)</code>, <code>(0, x)</code>, <code>(x, x)</code>. They are pairwise disjoint but are each in the sup of the other two.</p>



<a name="259587277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587277">(Oct 29 2021 at 21:49)</a>:</h4>
<p>That's the difference between <a href="https://leanprover-community.github.io/mathlib_docs/find/set.pairwise_disjoint">docs#set.pairwise_disjoint</a> and <code>finset.sup_indep</code> (introduced in <a href="https://github.com/leanprover-community/mathlib/issues/9867">#9867</a>)/docs#complete_lattice.independent.</p>



<a name="259587321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587321">(Oct 29 2021 at 21:50)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> , since each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are only <code>add_subgroup R</code>, is there a version of <code>direct_sum.add_subgroup_is_internal.independent</code>? Thank you.</p>



<a name="259587363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587363">(Oct 29 2021 at 21:50)</a>:</h4>
<p>No, because it would have been annoying to repeat the proof two more times, so I didn't bother</p>



<a name="259587388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587388">(Oct 29 2021 at 21:51)</a>:</h4>
<p>Let me try and copy paste then to see if I can do it.</p>



<a name="259587396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587396">(Oct 29 2021 at 21:51)</a>:</h4>
<p>There might be an easier way</p>



<a name="259587412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587412">(Oct 29 2021 at 21:51)</a>:</h4>
<p>You can use <a href="https://leanprover-community.github.io/mathlib_docs/find/add_subgroup.to_int_submodule">docs#add_subgroup.to_int_submodule</a> to convert your subgroups into submodules</p>



<a name="259587429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587429">(Oct 29 2021 at 21:51)</a>:</h4>
<p>And then probably use the lemmas, then massage the results back into statements about <code>add_subgroup</code>s</p>



<a name="259587497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587497">(Oct 29 2021 at 21:52)</a>:</h4>
<p>Alternative, abandon <code>add_subgroup</code> altogether and just work with <code>submodule int R</code> which is isomorphic anyway</p>



<a name="259587555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587555">(Oct 29 2021 at 21:53)</a>:</h4>
<p>Which is what <span class="user-mention" data-user-id="112680">@Johan Commelin</span> suggested upthread I think. It feels sort of ugly, but repeating everything three times is more ugly, especially if we can't work out how to reuse the proofs</p>



<a name="259587716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587716">(Oct 29 2021 at 21:55)</a>:</h4>
<p>The only reason I am asking for this is because I want the following lemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">graded_ring.proj_homogeneous_element</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">graded_ring.proj</span> <span class="n">R</span> <span class="n">A</span> <span class="n">i</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="259587836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587836">(Oct 29 2021 at 21:56)</a>:</h4>
<p>I couldn't get it work without knowing trivial intersection. If I could get this lemma without trivial intersection then we can delay making the decesion whether we should use <code>submodule int R</code></p>



<a name="259587911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587911">(Oct 29 2021 at 21:57)</a>:</h4>
<p>If it's just one lemma, then I'd probably try to do the <code>add_subgroup</code> to <code>submodule int</code> dance inside your proof</p>



<a name="259587989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259587989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259587989">(Oct 29 2021 at 21:58)</a>:</h4>
<p>That is, prove the statement for submodules inside that proof, then use <code>convert submodule_proof</code> and see what nasty goals arise</p>



<a name="259588053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588053">(Oct 29 2021 at 21:59)</a>:</h4>
<p>Note that as types, <code>↥(A i)</code> and <code>↥(A i).to_int_subgroup</code> are defeq</p>



<a name="259588172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588172">(Oct 29 2021 at 22:00)</a>:</h4>
<p>I couldn't find <code>add_subgroup.to_int_module</code></p>



<a name="259588251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588251">(Oct 29 2021 at 22:00)</a>:</h4>
<p><del>Hmm, I could have sworn that existed</del> <del>fixed the link above</del></p>



<a name="259588338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588338">(Oct 29 2021 at 22:01)</a>:</h4>
<p>Seems we only have <a href="https://leanprover-community.github.io/mathlib_docs/find/add_submonoid.to_nat_submodule">docs#add_submonoid.to_nat_submodule</a></p>



<a name="259588385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588385">(Oct 29 2021 at 22:02)</a>:</h4>
<p>Do you want to make a quick PR to define the int one too?</p>



<a name="259588397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588397">(Oct 29 2021 at 22:02)</a>:</h4>
<p><code>add_comm_group.int_module</code><br>
there is this</p>



<a name="259588415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588415">(Oct 29 2021 at 22:02)</a>:</h4>
<p>This should work</p>



<a name="259588434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588434">(Oct 29 2021 at 22:02)</a>:</h4>
<p>That's only half the picture</p>



<a name="259588457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588457">(Oct 29 2021 at 22:03)</a>:</h4>
<p>You should be able to just duplicate what <a href="https://leanprover-community.github.io/mathlib_docs/find/add_submonoid.to_nat_submodule">docs#add_submonoid.to_nat_submodule</a> does, probably in the same file if you're lucky</p>



<a name="259588482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588482">(Oct 29 2021 at 22:03)</a>:</h4>
<p>Under the hood, lean will find <a href="https://leanprover-community.github.io/mathlib_docs/find/add_comm_group.int_module">docs#add_comm_group.int_module</a> when type checking your statement</p>



<a name="259588928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259588928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259588928">(Oct 29 2021 at 22:09)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/7221">#7221</a> was the PR that added the nat one; I think we left the int one to avoid using all of <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span>'s time!</p>



<a name="259589078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259589078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259589078">(Oct 29 2021 at 22:10)</a>:</h4>
<p>Thanks for the suggestion. It's getting late. I will try to do this tomorrow. Have a good night</p>



<a name="259590721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259590721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259590721">(Oct 29 2021 at 22:28)</a>:</h4>
<p>I am too old to remember what I did 6 months ago <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="259693061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259693061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259693061">(Oct 29 2021 at 22:43)</a>:</h4>
<p>That's what <code>git blame</code> is for ;)</p>



<a name="259693587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259693587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jujian Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259693587">(Oct 29 2021 at 22:49)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/10051">#10051</a>, now I sleep 🤪</p>



<a name="259997877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/259997877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#259997877">(Nov 02 2021 at 13:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="252627">Jujian Zhang</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/graded.20rings/near/259587321">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> , since each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are only <code>add_subgroup R</code>, is there a version of <code>direct_sum.add_subgroup_is_internal.independent</code>? Thank you.</p>
</blockquote>
<p>I PR'd this in <a href="https://github.com/leanprover-community/mathlib/issues/10108">#10108</a></p>



<a name="260069360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/graded%20rings/near/260069360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/graded.20rings.html#260069360">(Nov 02 2021 at 22:58)</a>:</h4>
<p>I'm trying a slightly different approach to graded rings in <a href="https://github.com/leanprover-community/mathlib/issues/10127">#10127</a>, which I'll have another look at tomorrow</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>