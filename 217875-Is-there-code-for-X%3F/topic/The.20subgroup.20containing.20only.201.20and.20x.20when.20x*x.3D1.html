---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html">The subgroup containing only 1 and x when x*x=1</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="219146664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219146664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219146664">(Dec 07 2020 at 22:18)</a>:</h4>
<p>I imagine the proof of the three fields is trivial (<code>cases, simp</code>?), but does this construction have a name?</p>



<a name="219146707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219146707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219146707">(Dec 07 2020 at 22:18)</a>:</h4>
<p><del><code>to_mul (zmod 2)</code>?</del> Oh you want a subgroup.</p>



<a name="219146902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219146902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219146902">(Dec 07 2020 at 22:20)</a>:</h4>
<p>Yeah, I was looking at an old review comment and considering making <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.perm.mod_swap">docs#equiv.perm.mod_swap</a> a subgroup</p>



<a name="219165643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219165643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219165643">(Dec 08 2020 at 02:51)</a>:</h4>
<p>What's wrong with <code>subgroup.closure {x}</code>?</p>



<a name="219165702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219165702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219165702">(Dec 08 2020 at 02:52)</a>:</h4>
<p>Or <code>subgroup.gpowers x</code>?</p>



<a name="219165736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219165736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219165736">(Dec 08 2020 at 02:53)</a>:</h4>
<p>I think that having a lemms <code>mem_gpowers_iff_of_mul_self_eq_one</code> and <code>coe_gpowper_of_...</code> (possibly with a shorter name) is better than having one more definition.</p>



<a name="219168668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219168668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219168668">(Dec 08 2020 at 03:52)</a>:</h4>
<p>I think what you actually want is a proof that <code>(subgroup.gpowers x : set \a) = {1, x}</code> or something like this</p>



<a name="219168674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219168674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219168674">(Dec 08 2020 at 03:52)</a>:</h4>
<p>One has to think about how they want to actually formalize some mathematical statement</p>



<a name="219168678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219168678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219168678">(Dec 08 2020 at 03:52)</a>:</h4>
<p>not everything should be translated literally</p>



<a name="219175139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219175139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219175139">(Dec 08 2020 at 06:19)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">group_theory.order_of_element</span>

<span class="kd">universes</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">of_mul_self_eq_one_aux</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="n">G</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">carrier</span> <span class="o">:=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">},</span>
  <span class="n">one_mem'</span> <span class="o">:=</span> <span class="n">or.inl</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">g₁</span> <span class="n">g₂</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.mem_insert_iff</span><span class="o">,</span> <span class="n">set.mem_singleton_iff</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="o">(</span><span class="n">rfl</span> <span class="bp">|</span> <span class="n">rfl</span><span class="o">)</span> <span class="o">(</span><span class="n">rfl</span> <span class="bp">|</span> <span class="n">rfl</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">exact</span> <span class="n">mul_one</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">exact</span> <span class="n">one_mul</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">exact</span> <span class="n">mul_one</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hx</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">inv_mem'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">g</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.mem_insert_iff</span><span class="o">,</span> <span class="n">set.mem_singleton_iff</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="o">(</span><span class="n">rfl</span> <span class="bp">|</span> <span class="n">rfl</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">exact</span> <span class="n">one_inv</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">exact</span> <span class="n">inv_eq_of_mul_eq_one</span> <span class="n">hx</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">of_mul_self_eq_one</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">subgroup.gpowers</span> <span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">}</span> <span class="o">:=</span>
<span class="k">show</span> <span class="o">(</span><span class="n">subgroup.gpowers</span> <span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">=</span> <span class="n">of_mul_self_eq_one_aux</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
<span class="k">from</span> <span class="n">congr_arg</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">le_antisymm</span> <span class="o">(</span><span class="n">subgroup.gpowers_subset</span> <span class="bp">$</span> <span class="n">or.inr</span> <span class="n">rfl</span><span class="o">)</span> <span class="bp">$</span>
<span class="bp">λ</span> <span class="n">g</span> <span class="n">hg</span><span class="o">,</span> <span class="n">or.cases_on</span> <span class="n">hg</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">hg1</span><span class="o">,</span> <span class="n">hg1.symm</span> <span class="bp">▸</span> <span class="n">subgroup.one_mem</span> <span class="n">_</span><span class="o">)</span> <span class="bp">$</span>
<span class="bp">λ</span> <span class="n">hgx</span><span class="o">,</span> <span class="n">hgx</span> <span class="bp">▸</span> <span class="n">subgroup.mem_gpowers</span> <span class="n">_</span>
</code></pre></div>



<a name="219176033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219176033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219176033">(Dec 08 2020 at 06:40)</a>:</h4>
<p>A more general lemma could be <code>x ^ n = 1 → (gpowers x : set G) = (λ k, x ^ k) '' (Iio n)</code></p>



<a name="219177511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177511">(Dec 08 2020 at 07:13)</a>:</h4>
<p>The problem with <code>closure {x}</code> is that it's non-computable. Kenny's <code>of_mul_self_eq_one_aux</code> is exactly what I was after, but felt like I didn't want to write if there was a chance it already existed.</p>



<a name="219177756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177756">(Dec 08 2020 at 07:19)</a>:</h4>
<p>How can it be (non)computable?</p>



<a name="219177769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177769">(Dec 08 2020 at 07:19)</a>:</h4>
<p>It has only a <code>Prop</code>-valued function inside.</p>



<a name="219177825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177825">(Dec 08 2020 at 07:20)</a>:</h4>
<p>Or do you want <code>[∀ y, decidable (y ∈ s)]</code>?</p>



<a name="219177840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177840">(Dec 08 2020 at 07:21)</a>:</h4>
<p>Sorry, you're right; I was imprecise</p>



<a name="219177913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177913">(Dec 08 2020 at 07:23)</a>:</h4>
<p>You can't turn it into an <code>instance</code> for <code>gpowers</code> but I'd prefer to have <code>def gpowers_fin (x : G) (n : nat) (h : x ^ n = 1) := gpowers x</code> and instances on this def.</p>



<a name="219177991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177991">(Dec 08 2020 at 07:24)</a>:</h4>
<p>Or you can use <code>monoid_hom.range</code> of the natural map from <code>multiplicative (zmod n)</code>.</p>



<a name="219177997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219177997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219177997">(Dec 08 2020 at 07:24)</a>:</h4>
<p>(and prove that this range equals <code>gpowers</code>)</p>



<a name="219178045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219178045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219178045">(Dec 08 2020 at 07:25)</a>:</h4>
<p>BTW, do we have <code>(zmod n →+ G) ≃ {g : G // n \bu[\N] g = 0}</code> and a similar equiv for <code>multiplicative (zmod n) →* G</code>?</p>



<a name="219179600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/The%20subgroup%20containing%20only%201%20and%20x%20when%20x%2Ax%3D1/near/219179600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/The.20subgroup.20containing.20only.201.20and.20x.20when.20x*x.3D1.html#219179600">(Dec 08 2020 at 07:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">group_theory.subgroup</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kn">namespace</span> <span class="n">subgroup</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">of_pow_eq_one</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hxn</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">gpowers</span> <span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">=</span> <span class="o">((</span><span class="bp">^</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="bp">''</span> <span class="o">(</span><span class="n">set.Iio</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">set.ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">g</span><span class="o">,</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="bp">λ</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hmn</span><span class="o">,</span> <span class="n">hxmg</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span> <span class="n">hxmg</span> <span class="bp">▸</span> <span class="n">gpow_coe_nat</span> <span class="n">x</span> <span class="n">m</span><span class="o">⟩⟩),</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="o">((</span><span class="n">m</span> <span class="bp">%</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">nat_abs</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">%</span> <span class="n">n</span> <span class="o">:=</span>
    <span class="n">int.nat_abs_of_nonneg</span> <span class="o">(</span><span class="n">int.mod_nonneg</span> <span class="n">m</span> <span class="bp">$</span> <span class="n">int.coe_nat_ne_zero_iff_pos.2</span> <span class="n">hn</span><span class="o">),</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">m</span> <span class="bp">%</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">nat_abs</span><span class="o">,</span> <span class="n">int.coe_nat_lt.1</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">this</span><span class="o">,</span> <span class="n">exact</span> <span class="n">int.mod_lt_of_pos</span> <span class="n">m</span> <span class="o">(</span><span class="n">int.coe_nat_pos.2</span> <span class="n">hn</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">gpow_coe_nat</span><span class="o">,</span> <span class="n">this</span><span class="o">,</span> <span class="bp">←</span> <span class="n">hm</span><span class="o">],</span>
    <span class="n">conv_rhs</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">int.mod_add_div</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span> <span class="n">gpow_add</span><span class="o">,</span> <span class="n">gpow_mul</span><span class="o">,</span>
        <span class="n">gpow_coe_nat</span><span class="o">,</span> <span class="n">hxn</span><span class="o">,</span> <span class="n">one_gpow</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">of_mul_self_eq_one</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">gpowers</span> <span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">G</span><span class="o">)</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="n">x</span><span class="o">}</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">of_pow_eq_one</span> <span class="n">x</span> <span class="mi">2</span> <span class="n">dec_trivial</span> <span class="bp">$</span> <span class="o">(</span><span class="n">pow_two</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">hx</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="bp">$</span>
<span class="kd">by</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">set.Iio_def</span><span class="o">,</span> <span class="n">nat.lt_succ_iff_lt_or_eq</span><span class="o">,</span> <span class="n">nat.not_lt_zero</span><span class="o">,</span> <span class="n">false_or</span><span class="o">,</span>
    <span class="n">set.set_of_or</span><span class="o">,</span> <span class="n">set.image_union</span><span class="o">,</span> <span class="n">set.set_of_eq_eq_singleton</span><span class="o">,</span> <span class="n">set.image_singleton</span><span class="o">,</span>
    <span class="n">pow_zero</span><span class="o">,</span> <span class="n">pow_one</span><span class="o">,</span> <span class="n">set.singleton_union</span><span class="o">]</span>

<span class="kd">end</span> <span class="n">subgroup</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>