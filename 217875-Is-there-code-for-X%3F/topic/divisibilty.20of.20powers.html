---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html">divisibilty of powers</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="317027835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317027835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317027835">(Dec 20 2022 at 19:49)</a>:</h4>
<p>In <a href="https://github.com/leanprover-community/mathlib/pull/17632">my PR</a>, I also proved the following statements</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">odd_pow_lem</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">∣</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">odd</span> <span class="o">(</span><span class="n">n</span> <span class="bp">/</span> <span class="n">k</span><span class="o">))</span> <span class="o">:</span> <span class="n">a</span><span class="bp">^</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span>
<span class="kd">lemma</span> <span class="n">sub_one_dvd_pow_sub_one</span> <span class="o">(</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span>
</code></pre></div>
<p>I wasn't able to find these in mathlib. Technically I only need the case when <code>k = 1</code> for <code>odd_pow_lem</code>. If they aren't already in mathlib, do they belong?<br>
I also have proofs of the more general <code>lemma ab_lem (a b n : ℕ) : (a - b) ∣ (a^n - b^n)</code> and Kevin Buzzard suggested that I reformalize <code>odd_pow_lem</code> as <code>lemma odd_pow_lem (a : ℤ) (q k : ℕ) (h₂ : odd q) : a^k + 1 ∣ a^(q * k) + 1</code> to avoid natural number division.</p>



<a name="317028441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317028441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317028441">(Dec 20 2022 at 19:52)</a>:</h4>
<p><span class="user-mention" data-user-id="398581">@Mantas Baksys</span>, thoughts?</p>



<a name="317029657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317029657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317029657">(Dec 20 2022 at 20:00)</a>:</h4>
<p>I think that <code>lemma ab_lem (a b n : ℕ) : (a - b) ∣ (a^n - b^n)</code> is extremely useful.</p>



<a name="317030419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317030419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317030419">(Dec 20 2022 at 20:05)</a>:</h4>
<p>This one is not in your PR, is it?</p>



<a name="317030624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317030624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317030624">(Dec 20 2022 at 20:06)</a>:</h4>
<p>It used to be, but I removed it because I only ever used the <code>b = 1</code> case.<br>
It has a (ungolfed) proof <a href="https://github.com/osbourn/fermat-pseudoprimes/blob/99bba0e1a33779abc8d4cb0c02c26f25f89fc0f5/src/fermat_psp.lean#L178">here</a></p>



<a name="317030901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317030901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317030901">(Dec 20 2022 at 20:08)</a>:</h4>
<p>I would say that <code>odd_pow_lem</code> is better stated off as <code>odd q -&gt; a + 1 | a^q + 1</code> avoiding natural division and the divisibility hypothesis, and then you can apply with <code>a = a^k</code> if you want your version. As for <code>sub_one_dvd_pow_sub_one</code> I think it's probably better stated for <code>a : int</code>, and deduced for naturals afterwards (note that it looks true for a=0 so <code>h</code> should be removed in the final version, but you can do cases on a when proving the natural version)</p>



<a name="317031679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317031679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317031679">(Dec 20 2022 at 20:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="521331">Niels Voss</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/divisibilty.20of.20powers/near/317030624">said</a>:</p>
<blockquote>
<p>It used to be, but I removed it because I only ever used the <code>b = 1</code> case.<br>
It has a (ungolfed) proof <a href="https://github.com/osbourn/fermat-pseudoprimes/blob/99bba0e1a33779abc8d4cb0c02c26f25f89fc0f5/src/fermat_psp.lean#L178">here</a></p>
</blockquote>
<p>Nice!</p>
<p>Just one comment... for me, the terms with "triangle" are hard to read.<br>
Instead of:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">exact</span> <span class="o">(</span><span class="n">eq.symm</span> <span class="n">h₈</span><span class="o">)</span> <span class="bp">▸</span> <span class="n">h₇</span>
</code></pre></div>
<p>I'd write:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rwa</span> <span class="bp">←</span><span class="n">h₈</span> <span class="n">at</span>  <span class="n">h₇</span>
</code></pre></div>



<a name="317032238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317032238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317032238">(Dec 20 2022 at 20:17)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/algebra/geom_sum.html#geom_sum%E2%82%82_mul">docs#geom_sum₂_mul</a> and friends might be useful.</p>



<a name="317032368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317032368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317032368">(Dec 20 2022 at 20:18)</a>:</h4>
<p>(This came up in my seminar a while ago. I was certain I had seen this somewhere in mathlib, but could not find it when I was looking for it. The name is not what I had expected...)</p>



<a name="317033057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317033057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317033057">(Dec 20 2022 at 20:22)</a>:</h4>
<blockquote>
<p>I would say that <code>odd_pow_lem</code> is better stated off as <code>odd q -&gt; a + 1 | a^q + 1</code> avoiding natural division and the divisibility hypothesis, and then you can apply with <code>a = a^k</code> if you want your version.</p>
</blockquote>
<p>I agree, for some reason it never occurred to me that the two forms are actually equivalent</p>



<a name="317036655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317036655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317036655">(Dec 20 2022 at 20:44)</a>:</h4>
<p>Here are some short proofs of <code>ab_lem</code> for <code>ℤ</code> and <code>ℕ</code> using the lemma Michael Stoll suggested</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">private</span> <span class="kd">lemma</span> <span class="n">ab_lem</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">-</span> <span class="n">b</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="n">b</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="n">dvd.intro_left</span> <span class="n">_</span> <span class="o">(</span><span class="n">geom_sum₂_mul</span> <span class="n">a</span> <span class="n">b</span> <span class="n">n</span><span class="o">)</span>

<span class="kn">private</span> <span class="kd">lemma</span> <span class="n">ab_lem'</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">-</span> <span class="n">b</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="n">b</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_cases</span> <span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">,</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="n">b</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span> <span class="n">nat.pow_le_pow_of_le_left</span> <span class="n">h</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact_mod_cast</span> <span class="n">ab_lem</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">↑</span><span class="n">b</span> <span class="n">n</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="n">a</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span> <span class="n">nat.pow_le_pow_of_le_left</span> <span class="o">(</span><span class="k">show</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">nat.sub_eq_zero_iff_le.mpr</span> <span class="n">this</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="bp">▸</span> <span class="n">dvd_zero</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="317040435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317040435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317040435">(Dec 20 2022 at 21:08)</a>:</h4>
<p>You can <code>cases le_total b a</code></p>



<a name="317055088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317055088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317055088">(Dec 20 2022 at 22:55)</a>:</h4>
<p>Or split on <code>le_or_lt</code>.</p>



<a name="317271576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317271576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317271576">(Dec 22 2022 at 00:23)</a>:</h4>
<p><a href="https://artofproblemsolving.com/wiki/index.php/Sum_and_difference_of_powers">This link</a> suggests that for all <code>a, b, n</code> where <code>n</code> is odd then <code>a + b ∣ a^n + b^n</code>, which is basically a more general version of what I proved. Since <code>geom_sum₂_mul</code> is in the library, is there something similar for sums of odd powers?</p>



<a name="317271986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317271986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317271986">(Dec 22 2022 at 00:28)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/geom">docs#geom</a>_sum₂_mul</p>



<a name="317272001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317272001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317272001">(Dec 22 2022 at 00:28)</a>:</h4>
<p>oh great the linkifier is broken</p>



<a name="317272044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317272044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317272044">(Dec 22 2022 at 00:29)</a>:</h4>
<p>geom_sum2_mul seems to pretty much be that lemma with <code>x = a, y = -b</code>, no?</p>



<a name="317272222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317272222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317272222">(Dec 22 2022 at 00:31)</a>:</h4>
<p>Yeah it does, I was just wondering if there was a more convenient form to use</p>



<a name="317272964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317272964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317272964">(Dec 22 2022 at 00:40)</a>:</h4>
<p>I don't think so, I also don't think a PR that makes it would be unwelcome though! not sure how far away <code>geom_sum</code> is from a port but some lemma called <code>odd.pow_add_X</code> or something of the sort would be nice</p>



<a name="317275526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317275526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317275526">(Dec 22 2022 at 01:14)</a>:</h4>
<p>I tried proving that <code>(finset.range n).sum (λ (i : ℕ), (-1)^i * a ^ i * b ^ (n - 1 - i)) * (a + b) = a^n + b^n</code>. Proving that <code>(finset.range n).sum (λ (i : ℕ), (a ^ i * (-b) ^ (n - 1 - i)) * (a + b) = a^n + b^n</code> is basically a direct result of <code>geom_sum₂_mul</code>. Proving that the two finset sums are equal is harder, as it requires showing that <code>(-1 : ℤ) ^ i = (-1) ^ (n - 1 - i)</code>, for odd n, which is not true in general due to how natural number subtraction works.</p>
<p>I don't actually care about what is inside the finset sum for my PR because it only depends on divisibility, but I could try finishing the proof if it would be helpful to have in the library.</p>



<a name="317275597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317275597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317275597">(Dec 22 2022 at 01:15)</a>:</h4>
<p>I'd say just upload the divisibility proof and if people want the "proper" proof, they'll ask. Mention these details in the PR description!</p>



<a name="317275798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317275798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317275798">(Dec 22 2022 at 01:18)</a>:</h4>
<p>Which file and namespace would these go into? I'm planning on doing <code>a - b | a^n - b^n</code> and <code>odd n -&gt; a + b | a^n + b^n</code> for both <code>a b : nat</code> and <code>a b : int</code> (maybe it works for any comm ring in general)?</p>



<a name="317275928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317275928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317275928">(Dec 22 2022 at 01:20)</a>:</h4>
<p>I'd try to stick to comm_rings if you can, I find it unlikely it'd be accepted for <code>a b : int</code> only. I'd put the second one in the <code>odd</code> namespace (not sure about the name) and the first one, I'd call <code>sub_dvd_pow_sub_pow</code> maybe?</p>



<a name="317276089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317276089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317276089">(Dec 22 2022 at 01:23)</a>:</h4>
<p>I don't know how far down the import chain <code>algebra.geom_sum</code> is, but I'd imagine it would be after <code>data.nat.parity</code>. Should these just go in <code>algebra.geom_sum</code>?</p>



<a name="317276502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317276502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317276502">(Dec 22 2022 at 01:29)</a>:</h4>
<p>It may be easier to plug in <code>x = -a, y = b</code> into geom_sum2_mul to get</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">finset.range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="bp">-</span><span class="n">a</span><span class="o">)</span> <span class="bp">^</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">i</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">-</span><span class="n">a</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="n">a</span><span class="o">)</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span>
</code></pre></div>
<p>and cancel a minus sign from both sides (when n is odd).</p>



<a name="317276666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317276666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317276666">(Dec 22 2022 at 01:32)</a>:</h4>
<p>That definitely would help if I was trying to provide a version of <code>geom_sum₂_mul</code> for subtraction. I don't think it matters for just divisibility though.<br>
It would avoid all problems with natural number subtraction in my attempted proof above though.</p>



<a name="317277069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317277069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317277069">(Dec 22 2022 at 01:38)</a>:</h4>
<p><span class="user-mention" data-user-id="521331">@Niels Voss</span> I don't understand why <a href="https://leanprover-community.github.io/mathlib_docs/algebra/geom_sum.html#geom_sum%E2%82%82_mul">docs#geom_sum₂_mul</a> doesn't solve all your problems? What are you trying to prove?</p>



<a name="317277160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317277160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317277160">(Dec 22 2022 at 01:40)</a>:</h4>
<p>To get <code>a + b ∣ a^n + b^n</code> for <code>n</code> odd and <code>a</code>, <code>b</code> naturals, just prove it for integers and then observe that a natural divides another one iff the corresponding integer divides the other one.</p>



<a name="317277307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317277307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317277307">(Dec 22 2022 at 01:42)</a>:</h4>
<p>It does, I just thought that it would be nice if the lemmas were in a more convenient and <code>library_search</code> friendly form for the rest of the library. If this isn't necessary, my PR could just use <code>geom_sum₂_mul</code> directly.</p>



<a name="317277745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317277745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317277745">(Dec 22 2022 at 01:50)</a>:</h4>
<p>I was just referring to the fact that you seemed to be re-proving results about <code>(finset.range n).sum (λ (i : ℕ), (-1)^i * a ^ i * b ^ (n - 1 - i))</code>, which should not be necessary. You don't want to go there.</p>



<a name="317277830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317277830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317277830">(Dec 22 2022 at 01:52)</a>:</h4>
<p>Yeah, I don't really know why I was trying to do that (I guess I thought it would add something to <code>algebra.geom_sum</code>?) but you are right that it isn't necessary for divisibility.</p>



<a name="317278182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317278182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317278182">(Dec 22 2022 at 01:59)</a>:</h4>
<p>Here's what I have so far:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">sub_dvd_pow_sub_pow</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
  <span class="n">dvd.intro_left</span> <span class="n">_</span> <span class="o">(</span><span class="n">geom_sum₂_mul</span> <span class="n">x</span> <span class="n">y</span> <span class="n">n</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">nat.sub_dvd_pow_sub_pow</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">le_or_lt</span> <span class="n">y</span> <span class="n">x</span> <span class="k">with</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span> <span class="n">nat.pow_le_pow_of_le_left</span> <span class="n">h</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact_mod_cast</span> <span class="n">sub_dvd_pow_sub_pow</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">↑</span><span class="n">y</span> <span class="n">n</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≤</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span> <span class="n">nat.pow_le_pow_of_le_left</span> <span class="n">h.le</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">nat.sub_eq_zero_of_le</span> <span class="n">this</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="bp">▸</span> <span class="n">dvd_zero</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">theorem</span> <span class="n">odd.add_dvd_pow_add_pow</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="bp">+</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h₁</span> <span class="o">:=</span> <span class="n">geom_sum₂_mul</span> <span class="n">x</span> <span class="o">(</span><span class="bp">-</span><span class="n">y</span><span class="o">)</span> <span class="n">n</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">odd.neg_pow</span> <span class="n">h</span> <span class="n">y</span><span class="o">,</span> <span class="n">sub_neg_eq_add</span><span class="o">,</span> <span class="n">sub_neg_eq_add</span><span class="o">]</span> <span class="n">at</span> <span class="n">h₁</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">dvd.intro_left</span> <span class="n">_</span> <span class="n">h₁</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">theorem</span> <span class="n">nat.add_dvd_pow_add_pow_of_odd</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="n">n</span> <span class="bp">+</span> <span class="n">y</span><span class="bp">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">exact_mod_cast</span> <span class="n">odd.add_dvd_pow_add_pow</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">↑</span><span class="n">y</span> <span class="n">h</span>
</code></pre></div>
<p>I don't really know if I should change any of the names.</p>



<a name="317278650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317278650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317278650">(Dec 22 2022 at 02:07)</a>:</h4>
<p>Nice! </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">algebra.geom_sum</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
</code></pre></div>
<p>for the <a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>



<a name="317278731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317278731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317278731">(Dec 22 2022 at 02:08)</a>:</h4>
<p>Oh yeah, sorry I forgot to mention that this is in <code>algebra/geom_sum.lean</code> (outside of any namespace though). It can be moved if needed.</p>



<a name="317279832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317279832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317279832">(Dec 22 2022 at 02:26)</a>:</h4>
<p>As a general guideline, is there always a space between <code>x</code> and <code>^</code> in <code>x ^ y</code>? Because I haven't always been adding them.</p>



<a name="317282272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317282272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317282272">(Dec 22 2022 at 03:05)</a>:</h4>
<p>I always put them in, others often don't; it's a bit weird because usually there are concrete conventions for everything.</p>



<a name="317703709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317703709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317703709">(Dec 24 2022 at 10:48)</a>:</h4>
<p>I put them too.</p>



<a name="317720400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/divisibilty%20of%20powers/near/317720400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/divisibilty.20of.20powers.html#317720400">(Dec 24 2022 at 12:49)</a>:</h4>
<p>It is an infix operator. As such, it <em>should</em> get spaces around it. But this rule is loosely enforced.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>