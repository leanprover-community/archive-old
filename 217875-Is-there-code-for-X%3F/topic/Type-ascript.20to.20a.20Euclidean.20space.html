---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html">Type-ascript to a Euclidean space</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="278227501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278227501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278227501">(Apr 07 2022 at 21:16)</a>:</h4>
<p>Because <span class="user-mention" data-user-id="260507">@Heather Macbeth</span> is so reluctant to adding the "identity" <code>euclidean_space 𝕜 n ≃ (n → 𝕜)</code>, I still don't know how to correctly type-ascript something to <code>euclidean_space</code>. How do people do it?</p>



<a name="278228151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278228151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278228151">(Apr 07 2022 at 21:21)</a>:</h4>
<p>Update: Adding it instantly solve my problem. Are you really that against it, Heather?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">to_euclidean_space</span> <span class="o">{</span><span class="bp">𝕜</span> <span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">n</span> <span class="bp">→</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="bp">≃</span> <span class="n">euclidean_space</span> <span class="bp">𝕜</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">equiv.refl</span> <span class="n">_</span>
</code></pre></div>



<a name="278228723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278228723" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278228723">(Apr 07 2022 at 21:27)</a>:</h4>
<p>What's your use case?  I usually use <code>id</code>.</p>



<a name="278229029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278229029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278229029">(Apr 07 2022 at 21:30)</a>:</h4>
<p>I have some <code>x : fin n → ℕ</code> and want to talk about its Euclidean norm as an element of <code>euclidean_space ℝ (fin n)</code> but writing down <code>∥(λ i : fin n, (x i : ℝ) : euclidean_space ℝ (fin n))∥</code> results in the wrong norm being picked up.</p>



<a name="278229108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278229108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278229108">(Apr 07 2022 at 21:31)</a>:</h4>
<p>Can you make <code>x</code> of type Euclidean space initially?</p>



<a name="278229918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278229918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278229918">(Apr 07 2022 at 21:38)</a>:</h4>
<p>No, unfortunately not, because I need it to be in my discrete <code>fin n → ℕ</code> for combinatorial reasons in the assumptions of the lemma.</p>



<a name="278230480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278230480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278230480">(Apr 07 2022 at 21:44)</a>:</h4>
<p>Hmm ... can you share the code?</p>



<a name="278230941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278230941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278230941">(Apr 07 2022 at 21:50)</a>:</h4>
<p>It might not be very workable right now but you can have a look at <a href="https://github.com/leanprover-community/mathlib/tree/behrend">branch#behrend</a></p>



<a name="278231024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278231024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278231024">(Apr 07 2022 at 21:50)</a>:</h4>
<p>The relevant declaration is <code>slice_norm</code>.</p>



<a name="278232019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278232019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278232019">(Apr 07 2022 at 22:00)</a>:</h4>
<p>FWIW, I'm in favor of such a definition since it seems to work out well for multiplicative, but 1) I haven't used this bit of the library much so Heather's opinion is worth more in context, and 2) we <em>maybe</em> want to bundle as much as the weakest case permits (more than an equiv), to save us writing <code>to_euclidean_space_zero</code> lemmas and similar. On the other hand, the advantage of writing such lemmas manually is they become available to dsimp.</p>



<a name="278232304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278232304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278232304">(Apr 07 2022 at 22:02)</a>:</h4>
<p>Yes, I took the weakest bundling because I didn't know which was the correct one, but we could surely go for the strongest generically true one.</p>



<a name="278241845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278241845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278241845">(Apr 08 2022 at 00:00)</a>:</h4>
<p>Looking at your use case, what you really want is to turn <code>{x : fin n → ℕ}</code> to Euclidean space.  And this is a headache I've encountered with regular pi-types before.  So maybe we should have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">euclidean_space.mk</span> <span class="o">(</span><span class="bp">𝕜</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">euclidean_space</span> <span class="bp">𝕜</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">f</span> <span class="bp">∘</span> <span class="n">v</span>
</code></pre></div>



<a name="278241988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278241988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278241988">(Apr 08 2022 at 00:00)</a>:</h4>
<p>which allows you to write, in your use case,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">slice_norm</span> <span class="o">{</span><span class="n">n</span> <span class="n">d</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">sphere_slice</span> <span class="n">n</span> <span class="n">d</span> <span class="n">k</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∥</span><span class="n">euclidean_space.mk</span> <span class="n">ℝ</span> <span class="n">coe</span> <span class="n">x</span><span class="bp">∥</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="n">k</span> <span class="o">:=</span>
</code></pre></div>



<a name="278262981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278262981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278262981">(Apr 08 2022 at 06:49)</a>:</h4>
<p>Does <code>id x : euclidean_space 𝕜 n</code> work for you? It's the standard trick of inserting an <code>id</code> to make sure that Lean has no freedom to get it wrong.</p>



<a name="278269824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278269824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278269824">(Apr 08 2022 at 08:11)</a>:</h4>
<p>What's the benefit of using <code>id</code> vs having a dedicated name?</p>



<a name="278269968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278269968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278269968">(Apr 08 2022 at 08:13)</a>:</h4>
<p>As soon as you start simplifying, your <code>id</code> is going to vanish and your types are likely to stop making sense in the goal view</p>



<a name="278269985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278269985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278269985">(Apr 08 2022 at 08:13)</a>:</h4>
<p>With a dedicated name you can control when it does and does not vanish</p>



<a name="278270083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278270083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278270083">(Apr 08 2022 at 08:14)</a>:</h4>
<p>(probably you only want it to vanish for <code>to_euclidean v i = v i</code>, <code>to_euclidean 0 = 0</code>, etc)</p>



<a name="278270163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278270163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278270163">(Apr 08 2022 at 08:15)</a>:</h4>
<p>A notation <code>!ₑ[x, y, z] = to_euclidean ![x, y, z]</code> might be a nice way to prevent it being too verbose in the goal view in some cases</p>



<a name="278271283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278271283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278271283">(Apr 08 2022 at 08:25)</a>:</h4>
<p>The point of  <code>id</code> is that this trick is useful all over the place, and doesn't need any new API. I agree that a proper API around <code>to_euclidean</code> would be nicer, but if it is solving a problem that you can avoid with a simple trick like that I'm not sure it is worth investing manpower in it.</p>



<a name="278272705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/278272705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#278272705">(Apr 08 2022 at 08:38)</a>:</h4>
<p>This is a path to being sloppy in type-checking and letting the wrong norm slip in accidentally. <code>id</code> is a hack and should be treated as such. I am trying to manipulate some <code>fin n → ℕ</code> as terms of <code>euclidean_space ℝ (fin n)</code> and this is a mess. <code>to_euclidean</code> is an easy lasting solution. It requires 7 lemmas of API (cf <a href="https://leanprover-community.github.io/mathlib_docs/find/to_lex">docs#to_lex</a>) and a correction of the existing lemmas, then <em>it will just work</em>.</p>



<a name="280235393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Type-ascript%20to%20a%20Euclidean%20space/near/280235393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Type-ascript.20to.20a.20Euclidean.20space.html#280235393">(Apr 26 2022 at 16:31)</a>:</h4>
<p>It turns out we already have <code>from_euclidean_space</code>, it's <a href="https://leanprover-community.github.io/mathlib_docs/find/pi_Lp.equiv">docs#pi_Lp.equiv</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>