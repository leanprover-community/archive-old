---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html">✔ Two ways to sum finsets</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="319482155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482155">(Jan 04 2023 at 22:10)</a>:</h4>
<p>Is there a way to fill in this sorry?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators</span>
<span class="n">open_locale</span> <span class="n">big_operators</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">R</span><span class="o">]</span>
<span class="kd">lemma</span> <span class="n">sum_convert</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">x</span> <span class="o">:</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x.val</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="319482209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482209">(Jan 04 2023 at 22:11)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_subtype">docs#finset.sum_subtype</a></p>



<a name="319482453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482453">(Jan 04 2023 at 22:12)</a>:</h4>
<p>I'm surprised we don't have the one specifically about the case of a coerced finset (but with <code>coe</code> not <code>subtype.val</code> as in the question)</p>



<a name="319482669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482669">(Jan 04 2023 at 22:14)</a>:</h4>
<p>Aha, <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_coe_sort">docs#finset.sum_coe_sort</a></p>



<a name="319482747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482747">(Jan 04 2023 at 22:14)</a>:</h4>
<p>I don't know how you find these theorems so quickly<br>
Anyways, here's the finished lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators</span>
<span class="n">open_locale</span> <span class="n">big_operators</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">private</span> <span class="kd">lemma</span> <span class="n">sum_convert</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">x</span> <span class="o">:</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x.val</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">symmetry</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">finset.sum_subtype</span> <span class="n">_</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">refl</span><span class="o">)</span> <span class="n">_</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="319482848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319482848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319482848">(Jan 04 2023 at 22:15)</a>:</h4>
<p>Actually, finset.sum_coe_sort just solves the lemma directly</p>



<a name="319483018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483018">(Jan 04 2023 at 22:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="521331">Niels Voss</span> has marked this topic as resolved.</p>



<a name="319483088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hanting Zhang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483088">(Jan 04 2023 at 22:17)</a>:</h4>
<p>there's a running joke that <code>yael_search</code> is the fastest way you'll find any piece of mathlib code :P</p>



<a name="319483154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483154">(Jan 04 2023 at 22:18)</a>:</h4>
<p>I have <a href="https://leanprover-community.github.io/mathlib_docs">https://leanprover-community.github.io/mathlib_docs</a> open and I know the naming convention. Here your theorem involves <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum">docs#finset.sum</a>, so it will be in the <code>finset</code> namespace. Then it is about <code>finset.sum</code> over a <a href="https://leanprover-community.github.io/mathlib_docs/find/subtype">docs#subtype</a> or even more specifically over the <a href="https://leanprover-community.github.io/mathlib_docs/find/coe_sort">docs#coe_sort</a> of a finset, so I typed <code>finsumsub</code> in the search bar on the top right without hitting enter, and it gave me <code>finset.sum_subtype</code>.</p>



<a name="319483499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483499">(Jan 04 2023 at 22:21)</a>:</h4>
<p>In that case I should have read the statement more closely before giving it to you, because I had forgotten about <code>finset.sum_coe_sort</code>.</p>



<a name="319483692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483692">(Jan 04 2023 at 22:22)</a>:</h4>
<p>See I didn't even realize that the left hand side of the statement involved a coercion until I thought to unfold it using tactics, then it took me over 2 minutes to read the type of the function</p>



<a name="319483828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319483828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319483828">(Jan 04 2023 at 22:23)</a>:</h4>
<blockquote>
<p>See I didn't even realize that the left hand side of the statement involved a coercion</p>
</blockquote>
<p>Did you see the arrow in the goal view? All vertical arrows are coercions, no need to unfold until you see the letters <code>coe</code></p>



<a name="319484122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319484122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Niels Voss <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319484122">(Jan 04 2023 at 22:25)</a>:</h4>
<p>Well I think the goal view just displayed the ∑ notation, and I somehow didn't see the arrow next to the <code>s</code><br>
Coercions are somewhat magical to me, just recently I had a coercion in a goal state and when I copied it to the code it broke</p>



<a name="319484206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Two%20ways%20to%20sum%20finsets/near/319484206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Two.20ways.20to.20sum.20finsets.html#319484206">(Jan 04 2023 at 22:25)</a>:</h4>
<p>That's not magic at all. That's Lean 3's pretty-printing not round-tripping. <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>