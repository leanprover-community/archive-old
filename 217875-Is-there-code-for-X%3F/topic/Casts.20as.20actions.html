---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html">Casts as actions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="304215724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304215724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304215724">(Oct 15 2022 at 15:36)</a>:</h4>
<p>Are these hidden somewhere?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.cast</span>

<span class="kn">namespace</span> <span class="n">nat</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_monoid_with_one</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">add_action</span> <span class="n">ℕ</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">add_action.comp_hom</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">nat.cast_add_monoid_hom</span> <span class="n">α</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">vadd_def</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">+ᵥ</span> <span class="n">a</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">+</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">end</span> <span class="n">nat</span>

<span class="kn">namespace</span> <span class="n">int</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_group_with_one</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">add_action</span> <span class="n">ℤ</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">add_action.comp_hom</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">int.cast_add_hom</span> <span class="n">α</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">vadd_def</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">+ᵥ</span> <span class="n">a</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">n</span> <span class="bp">+</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">end</span> <span class="n">int</span>

<span class="kn">namespace</span> <span class="n">rat</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">char_zero</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">add_action</span> <span class="n">ℚ</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">add_action.comp_hom</span> <span class="n">_</span> <span class="bp">$</span> <span class="o">(</span><span class="n">rat.cast_hom</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">to_add_monoid_hom</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">vadd_def</span> <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">+ᵥ</span> <span class="n">a</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">q</span> <span class="bp">+</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">end</span> <span class="n">rat</span>
</code></pre></div>



<a name="304215791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304215791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304215791">(Oct 15 2022 at 15:37)</a>:</h4>
<p>Of course the corresponding <code>mul_action</code>s also hold.</p>



<a name="304217726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304217726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304217726">(Oct 15 2022 at 15:53)</a>:</h4>
<p>The first one looks like <code>add_action.comp_hom nat.cast_add_monoid_hom</code></p>



<a name="304217790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304217790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304217790">(Oct 15 2022 at 15:54)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/add_action.comp_hom">docs#add_action.comp_hom</a></p>



<a name="304217837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304217837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304217837">(Oct 15 2022 at 15:54)</a>:</h4>
<p>And the others in the obvious way</p>



<a name="304217934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304217934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304217934">(Oct 15 2022 at 15:55)</a>:</h4>
<p>I think there's a high risk of non-defeq diamonds with those instances though, something to be careful of</p>



<a name="304218005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304218005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304218005">(Oct 15 2022 at 15:55)</a>:</h4>
<p>Golfed</p>



<a name="304218146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304218146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304218146">(Oct 15 2022 at 15:56)</a>:</h4>
<p>Time for a <code>nvadd</code> field to <code>add_monoid_with_one</code>? <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="304218237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304218237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304218237">(Oct 15 2022 at 15:57)</a>:</h4>
<p>At least this works</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">nat.add_action</span> <span class="bp">=</span> <span class="n">add_monoid.to_add_action</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">int.add_action</span> <span class="bp">=</span> <span class="n">add_monoid.to_add_action</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">rat.add_action</span> <span class="bp">=</span> <span class="n">add_monoid.to_add_action</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="304218435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304218435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304218435">(Oct 15 2022 at 15:59)</a>:</h4>
<p>I'm more concerned about prod, pi, and complex</p>



<a name="304218512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Casts%20as%20actions/near/304218512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Casts.20as.20actions.html#304218512">(Oct 15 2022 at 16:00)</a>:</h4>
<p>But maybe this instance is safe more generally for <code>[algebra R A] : add_action R A</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>