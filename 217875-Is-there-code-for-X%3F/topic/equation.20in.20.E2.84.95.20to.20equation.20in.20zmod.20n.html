---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html">equation in ℕ to equation in zmod n</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="291481436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291481436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291481436">(Jul 31 2022 at 09:51)</a>:</h4>
<p>I feel like I'm missing something obvious here.  If I'm trying to prove, for example,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>and I have the corresponding statement that holds for all <code>x : ℕ</code> (in this case, <code>nat.sq_sub_sq x 1</code>), can I use the equation in <code>ℕ</code> to prove the equation in <code>zmod n</code>?</p>



<a name="291481500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291481500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291481500">(Jul 31 2022 at 09:53)</a>:</h4>
<p>I suspect the answer is either going to be "No, of course not, because ..." or "Of course, it's just ...".   Either way, I have the <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span> ready!</p>



<a name="291481850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291481850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291481850">(Jul 31 2022 at 10:02)</a>:</h4>
<p>No, not really, but it is an equation in the language of rings and <code>zmod n</code> is a ring so <code>by ring</code> should work</p>



<a name="291481883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291481883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291481883">(Jul 31 2022 at 10:02)</a>:</h4>
<p>in fact this theorem is considreably harder over <code>nat</code> because <code>-</code> doesn't mean the usual thing</p>



<a name="291483442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291483442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291483442">(Jul 31 2022 at 10:39)</a>:</h4>
<p>Yeah the canonical map (call it f) from nat to zmod n is surjective which is one of the ingredients you'd need for this, but it does not satisfy f(a-b) = f(a) - f(b) which would be another.</p>



<a name="291483520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291483520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291483520">(Jul 31 2022 at 10:40)</a>:</h4>
<p>eg x-(x+1)=0 can be proved for nat but can't be deduced for zmod n</p>



<a name="291483560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291483560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291483560">(Jul 31 2022 at 10:41)</a>:</h4>
<p>Yes, I'd once again forgotten about the problem of subtraction.</p>



<a name="291483717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291483717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291483717">(Jul 31 2022 at 10:44)</a>:</h4>
<p>For instance, when <code>x=0</code> the statement over <code>ℕ</code> and over <code>zmod n</code> are both true but represent "different" identities.</p>



<a name="291483976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291483976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291483976">(Jul 31 2022 at 10:50)</a>:</h4>
<p>Yeah, I realise now that if I want to get a result for <code>zmod n</code> from something more generic, the natural generalisation is something like <code>comm_ring R</code>, not <code>ℕ</code>.</p>



<a name="291484002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291484002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291484002">(Jul 31 2022 at 10:51)</a>:</h4>
<p>And indeed the example I gave above has <code>_root_.sq_sub_sq x 1</code> for <code>x : R</code>.</p>



<a name="291484695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291484695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291484695">(Jul 31 2022 at 11:06)</a>:</h4>
<p>How about from \Z?</p>



<a name="291486257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291486257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291486257">(Jul 31 2022 at 11:45)</a>:</h4>
<p>Then it becomes the statement "evaluation of a polynomial commutes with ring homomorphisms" which presumably is there somewhere...</p>



<a name="291488971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291488971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291488971">(Jul 31 2022 at 12:52)</a>:</h4>
<p>Is it <a href="https://leanprover-community.github.io/mathlib_docs/data/polynomial/eval.html#polynomial.eval%E2%82%82_at_apply">this</a> result? BTW: How can I paste <code>docs</code> links if there is a subscript? The usual way did not work...</p>



<a name="291490444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291490444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291490444">(Jul 31 2022 at 13:23)</a>:</h4>
<p>You can't, we need to fix the Zulip linkifiers (if they can be fixed)</p>



<a name="291826452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291826452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291826452">(Aug 03 2022 at 10:05)</a>:</h4>
<p>Related to my previous question, do we have this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hα0</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">zmod</span> <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">)}</span>
  <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="291826622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291826622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291826622">(Aug 03 2022 at 10:07)</a>:</h4>
<p>The proof for <code>x : zmod p</code> is more straightforward, because we have [no_zero_divisors (zmod p)]`.</p>



<a name="291826784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291826784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291826784">(Aug 03 2022 at 10:09)</a>:</h4>
<p>And I can prove this (without any issues with subtraction)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>but I can't see how to use this to get a proof of the above.</p>



<a name="291826915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291826915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291826915">(Aug 03 2022 at 10:10)</a>:</h4>
<p>No need for <code>hα0 : 0 &lt; α</code>, it's true for <code>α = 0</code></p>



<a name="291827647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291827647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291827647">(Aug 03 2022 at 10:18)</a>:</h4>
<p>Why not <code>x : int</code> instead of <code>x : nat</code> for the intermediate result?</p>



<a name="291827663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291827663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291827663">(Aug 03 2022 at 10:18)</a>:</h4>
<p>Then the result would be easier to use.</p>



<a name="291828204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291828204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291828204">(Aug 03 2022 at 10:24)</a>:</h4>
<p>I've started an attempt on that, but I've run into difficulties proving it and other difficulties in using it for the <code>zmod (p^α)</code> result — I get tangled up in coercions.</p>



<a name="291828604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291828604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291828604">(Aug 03 2022 at 10:28)</a>:</h4>
<p>The outline of the proof for <code>x : nat</code> is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">),</span> <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span><span class="n">nat.sq_sub_sq</span><span class="o">,</span> <span class="n">simpa</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="bp">¬</span> <span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">),</span> <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>  <span class="c1">-- because if p divides both then p ∣ 2</span>
  <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">h_plus</span> <span class="n">h_minus</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="gr">sorry</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
<p>where the last two <code>sorry</code>s are taken care of with <a href="https://leanprover-community.github.io/mathlib_docs/find/prime.pow_dvd_of_dvd_mul_left">docs#prime.pow_dvd_of_dvd_mul_left</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/prime.pow_dvd_of_dvd_mul_right">docs#prime.pow_dvd_of_dvd_mul_right</a>.</p>



<a name="291828697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291828697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291828697">(Aug 03 2022 at 10:29)</a>:</h4>
<p>But I can't see how to write the counterpart of <code>¬ p ∣ (x + 1) </code> and <code>¬ p ∣ (x - 1) </code> in the <code>zmod (p^α)</code> case.</p>



<a name="291903211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291903211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291903211">(Aug 03 2022 at 18:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> has marked this topic as unresolved.</p>



<a name="291903347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291903347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291903347">(Aug 03 2022 at 18:46)</a>:</h4>
<p>Sorry, I didn't check back into the thread after I marked it as resolved. Thanks <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> for writing up a solution!</p>



<a name="291903869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291903869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291903869">(Aug 03 2022 at 18:51)</a>:</h4>
<p>Here's the version I figured out:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.parity</span>
<span class="kn">import</span> <span class="n">data.zmod.algebra</span>
<span class="kn">import</span> <span class="n">ring_theory.int.basic</span>

<span class="kn">open</span> <span class="n">nat</span> <span class="n">zmod</span>

<span class="sd">/-- If an odd prime power `p^α` divides `x^2 - 1` then it divides `x-1` or `x+1`. -/</span>
<span class="kd">lemma</span> <span class="n">square_roots_of_one_int</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span> <span class="bp">∣</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">pp'</span> <span class="o">:=</span> <span class="n">prime_iff_prime_int.1</span> <span class="n">pp</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">diffsquare</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">)</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span> <span class="o">{</span> <span class="n">ring_nf</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">root</span><span class="o">]</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="bp">¬</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="bp">¬</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span><span class="n">not_and_distrib</span><span class="o">,</span>
    <span class="n">rintro</span> <span class="o">⟨</span><span class="n">hp1</span><span class="o">,</span> <span class="n">hp2</span><span class="o">⟩,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">),</span> <span class="o">{</span> <span class="n">exact</span> <span class="n">dvd_sub</span> <span class="n">hp1</span> <span class="n">hp2</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="o">,</span> <span class="o">{</span> <span class="n">ring</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="n">h4</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℤ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="mi">1</span><span class="bp">^</span><span class="mi">2</span><span class="o">,</span> <span class="kd">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="n">prime_two_or_dvd_of_dvd_two_mul_pow_self_two</span> <span class="n">pp</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">pp.ne_one</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">odd_iff_not_even</span><span class="o">]</span> <span class="n">at</span> <span class="n">hp_odd</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hp_odd</span> <span class="n">even_two</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">h_plus</span> <span class="n">h_minus</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">apply</span> <span class="n">prime.pow_dvd_of_dvd_mul_left</span> <span class="n">pp'</span> <span class="n">α</span> <span class="n">h_plus</span><span class="o">,</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">]</span> <span class="n">using</span> <span class="n">diffsquare</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">apply</span> <span class="n">prime.pow_dvd_of_dvd_mul_right</span> <span class="n">pp'</span> <span class="n">α</span> <span class="n">h_minus</span><span class="o">,</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">]</span> <span class="n">using</span> <span class="n">diffsquare</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="sd">/-- If `x : zmod (p^α)` (for odd prime `p`) satisfies `x^2 = 1` then `x = 1 ∨ x = -1` -/</span>
<span class="kd">lemma</span> <span class="n">square_roots_of_one_zmod</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">zmod</span> <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">)}</span>
  <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">or.imp</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">square_roots_of_one_int</span> <span class="n">p</span> <span class="n">α</span> <span class="bp">↑</span><span class="n">x</span> <span class="n">pp</span> <span class="n">hp_odd</span> <span class="n">_</span> <span class="o">),</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="mi">1</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">eq_comm</span><span class="o">,</span> <span class="n">this</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">eq_comm</span><span class="o">,</span> <span class="n">this</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="mi">1</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">this</span><span class="o">,</span> <span class="n">root</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="291905025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/equation%20in%20%E2%84%95%20to%20equation%20in%20zmod%20n/near/291905025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/equation.20in.20.E2.84.95.20to.20equation.20in.20zmod.20n.html#291905025">(Aug 03 2022 at 19:00)</a>:</h4>
<p>Of course I was cheating in the latter proof by leaving the <code>simp</code>s unsqueezed.  Here's a better version with tem changed to <code>{norm,push}_cast</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.parity</span>
<span class="kn">import</span> <span class="n">data.zmod.algebra</span>
<span class="kn">import</span> <span class="n">ring_theory.int.basic</span>

<span class="kn">open</span> <span class="n">nat</span> <span class="n">zmod</span>

<span class="sd">/-- If `x : zmod (p^α)` (for odd prime `p`) satisfies `x^2 = 1` then `x = 1 ∨ x = -1` -/</span>
<span class="kd">lemma</span> <span class="n">square_roots_of_one_zmod</span> <span class="o">{</span><span class="n">p</span> <span class="n">α</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">pp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hp_odd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">zmod</span> <span class="o">(</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">)}</span>
  <span class="o">(</span><span class="n">root</span> <span class="o">:</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">or.imp</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">square_roots_of_one_int</span> <span class="n">p</span> <span class="n">α</span> <span class="bp">↑</span><span class="n">x</span> <span class="n">pp</span> <span class="n">hp_odd</span> <span class="n">_</span> <span class="o">),</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="mi">1</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">eq_comm</span><span class="o">,</span> <span class="n">this</span><span class="o">,</span> <span class="n">nat.cast_pow</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">push_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">eq_comm</span><span class="o">,</span> <span class="n">this</span><span class="o">],</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="n">h</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">int_coe_eq_int_coe_iff_dvd_sub</span> <span class="mi">1</span> <span class="o">(</span><span class="bp">↑</span><span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="bp">↑</span><span class="n">p</span><span class="bp">^</span><span class="n">α</span><span class="o">),</span>
    <span class="n">push_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">this</span><span class="o">,</span> <span class="n">root</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>