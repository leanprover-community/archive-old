---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html">finding instance declaration</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275929513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929513">(Mar 19 2022 at 21:02)</a>:</h4>
<p>In linear_algebra/basic.lean there is a lemma I am trying to use</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">span_smul_eq_of_is_unit</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">span</span> <span class="n">R</span> <span class="o">(</span><span class="n">r</span> <span class="bp">•</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">span</span> <span class="n">R</span> <span class="n">s</span>
</code></pre></div>
<p>When I try to use this in my context, ( <code>R =  𝕜, r = c, s = {g}, M =  𝕜[X]</code>  )</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">should_be_simple</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">:</span> <span class="n">span</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">c</span> <span class="bp">•</span> <span class="o">({</span><span class="n">g</span><span class="o">}:</span> <span class="n">set</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">]))</span> <span class="bp">=</span> <span class="n">span</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="o">({</span><span class="n">g</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>lean complains:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="bp">𝕜</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">field</span> <span class="bp">𝕜</span><span class="o">,</span>
<span class="n">g</span> <span class="o">:</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">],</span>
<span class="n">c</span> <span class="o">:</span> <span class="bp">𝕜</span>
<span class="bp">⊢</span> <span class="n">has_scalar</span> <span class="bp">𝕜</span> <span class="o">(</span><span class="n">set</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">])</span>
</code></pre></div>
<p>I am trying to see if I'm just reading the syntax wrong, so I want to chase down the <code>has_scalar</code> instance that is being used in the lemma above. I did some text searches like 'instance : has_scalar...' but I feel like there has to be a better way. I am looking more for strategies to get me past questions like this more than just an answer to this particular instance.</p>



<a name="275929539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929539">(Mar 19 2022 at 21:03)</a>:</h4>
<p>If you go to the docs, <a href="https://leanprover-community.github.io/mathlib_docs/find/has_scalar">docs#has_scalar</a>, you'll see a list of all of the instances.  This is a good place to start.</p>



<a name="275929589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929589">(Mar 19 2022 at 21:04)</a>:</h4>
<p>Here I see <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.has_scalar">docs#polynomial.has_scalar</a> on that list.</p>



<a name="275929590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929590">(Mar 19 2022 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="477005">@Justin Thomas</span> Did you intend to write <code>(c • ({g}: set 𝕜[X]))</code>? Or do you mean <code>({c • g}: set 𝕜[X])</code>?</p>



<a name="275929605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929605">(Mar 19 2022 at 21:05)</a>:</h4>
<p>They are the same thanks to <a href="https://leanprover-community.github.io/mathlib_docs/find/set.smul_singleton">docs#set.smul_singleton</a></p>



<a name="275929691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929691">(Mar 19 2022 at 21:06)</a>:</h4>
<p>That list doesn't contain "transitive" instances (e.g. a normed space is a module is a <code>distrib_mul_action</code> is a <code>mul_action</code> is a <code>has_scalar</code>), so there's still some guesswork.</p>



<a name="275929860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929860">(Mar 19 2022 at 21:10)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> thanks. I did not know about that. Is it auto-generated? So guaranteed to be up to date?  seems like lean should combine set.has_scalar and polynomial.has_scalar. I don't know how to give it a hint to find these.</p>



<a name="275929864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929864">(Mar 19 2022 at 21:10)</a>:</h4>
<p>Yes, it's autogenerated every two hours.</p>



<a name="275929937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929937">(Mar 19 2022 at 21:12)</a>:</h4>
<p>In this case you might need to say <code>open_locale pointwise</code> to get the <a href="https://leanprover-community.github.io/mathlib_docs/find/set.has_scalar_set">docs#set.has_scalar_set</a>  instance.</p>



<a name="275929939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929939">(Mar 19 2022 at 21:12)</a>:</h4>
<p>See the docstring on that instance.</p>



<a name="275929964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275929964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275929964">(Mar 19 2022 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>  I mean <code>(c • ({g}: set 𝕜[X]))</code>because I am trying to match <code>(r • s)</code>in <code>span_smul_eq_of_is_unit</code>.</p>



<a name="275930039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930039">(Mar 19 2022 at 21:15)</a>:</h4>
<p>Fair enough. So yeah, then you probably need to have <code>open_locale pointwise</code> as Heather points out.</p>



<a name="275930101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930101">(Mar 19 2022 at 21:16)</a>:</h4>
<p><strong>Heather Macbeth</strong> thanks so much! <code>open_locale pointwise</code> is what I was missing!! (off to figure out what that means...)</p>



<a name="275930234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930234">(Mar 19 2022 at 21:19)</a>:</h4>
<p>bonus question. Why do I need to put the <code>{g}: set 𝕜[X]</code> extra type annotation?<br>
Here is what I had at one point that lean really dislikes</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- maybe is_unit c ?</span>
<span class="kd">lemma</span> <span class="n">should_be_simple</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">])</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">:</span> <span class="n">span</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="n">c</span> <span class="bp">•</span> <span class="o">{</span><span class="n">g</span><span class="o">}</span> <span class="bp">=</span> <span class="n">span</span> <span class="bp">𝕜</span><span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">g</span><span class="o">}</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="275930298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930298">(Mar 19 2022 at 21:21)</a>:</h4>
<p>Here <code>{g}</code> is just a notation, <a href="https://leanprover-community.github.io/mathlib_docs/find/has_singleton">docs#has_singleton</a>, and Lean has to figure out what kind of singleton is meant (set? finset? ...)</p>



<a name="275930309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930309">(Mar 19 2022 at 21:21)</a>:</h4>
<p>I actually introduced a notation before because of precisely this issue</p>



<a name="275930360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930360">(Mar 19 2022 at 21:22)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/48eacc63751375da61238b90773c4208e768eabc/src/linear_algebra/span.lean#L307">https://github.com/leanprover-community/mathlib/blob/48eacc63751375da61238b90773c4208e768eabc/src/linear_algebra/span.lean#L307</a></p>



<a name="275930391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930391">(Mar 19 2022 at 21:23)</a>:</h4>
<p>So you can write <code>𝕜[X] ∙ g</code> for <code>span 𝕜[X] {g}</code> (and it builds in that it's the <code>set</code>-singleton that's meant.)</p>



<a name="275930472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justin Thomas <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930472">(Mar 19 2022 at 21:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/finding.20instance.20declaration/near/275930391">said</a>:</p>
<blockquote>
<p>So you can write <code>𝕜[X] ∙ g</code> for <code>span 𝕜[X] {g}</code> (and it builds in that it's the <code>set</code>-singleton that's meant.)</p>
</blockquote>
<p>much nicer. Is there a way to discover notations in the docs similar to instances?</p>



<a name="275930489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finding%20instance%20declaration/near/275930489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finding.20instance.20declaration.html#275930489">(Mar 19 2022 at 21:25)</a>:</h4>
<p>No, in fact; it would be nice but there's currently no autogeneration of documentation for notation.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>