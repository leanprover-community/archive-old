---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html">If `f` is a multilinear map then `λ v, f (v ∘ σ)` is too</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="217986991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217986991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217986991">(Nov 26 2020 at 10:43)</a>:</h4>
<p>That is, if I have a multilinear map of <code>n</code> inputs, I can turn it into a multilinear map over <code>m</code> inputs by "wiring up" the inputs however I like</p>



<a name="217993361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217993361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217993361">(Nov 26 2020 at 12:01)</a>:</h4>
<p>This isn't true unless <code>σ</code> is a bijection (and so <code>n = m</code>)</p>



<a name="217994698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217994698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217994698">(Nov 26 2020 at 12:16)</a>:</h4>
<p>Ah right, I see the mistake in my reasoning</p>



<a name="217995021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217995021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217995021">(Nov 26 2020 at 12:20)</a>:</h4>
<p>Does this exist for <code>σ : A ≃ B</code> then? If not, what would be a good name? <code>multilinear_map.comp_domain f σ</code>?</p>



<a name="217995808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217995808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217995808">(Nov 26 2020 at 12:29)</a>:</h4>
<p>Maybe even <code>multilinear_map.congr_domain</code>, since the result is an equiv between maps in <code>n</code> inputs and maps in <code>m</code> inputs</p>



<a name="217996953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217996953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217996953">(Nov 26 2020 at 12:42)</a>:</h4>
<p>I thought about that too. (to be clear, as Reid points out this is an equiv between maps with inputs of type A and B, not with different numbers of inputs)</p>



<a name="217997032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217997032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217997032">(Nov 26 2020 at 12:43)</a>:</h4>
<p>Also note that we have <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.dom_congr">docs#finsupp.dom_congr</a>, in case we want precedent in the naming</p>



<a name="217997053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217997053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217997053">(Nov 26 2020 at 12:43)</a>:</h4>
<p>Ah, here's the concern - this is a congruence in the domain of the domain, not in the domain itself</p>



<a name="217997147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/217997147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#217997147">(Nov 26 2020 at 12:44)</a>:</h4>
<p>Sounds like <code>dom_dom_congr</code> then <span aria-label="oops" class="emoji emoji-1f643" role="img" title="oops">:oops:</span></p>



<a name="218116072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/218116072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#218116072">(Nov 27 2020 at 17:49)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">function.update_comp_equiv</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">α'</span> <span class="o">:</span> <span class="kt">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α'</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">≃</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">function.update</span> <span class="n">f</span> <span class="n">a</span> <span class="n">v</span><span class="o">)</span> <span class="bp">∘</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">function.update</span> <span class="o">(</span><span class="n">f</span> <span class="bp">∘</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">g.symm</span> <span class="n">a</span><span class="o">)</span> <span class="n">v</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span><span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">function.update_comp</span> <span class="n">_</span> <span class="o">(</span><span class="n">g.injective</span><span class="o">),</span> <span class="n">g.apply_symm_apply</span><span class="o">]}</span>

<span class="kd">lemma</span> <span class="n">function.update_comp_equiv_apply</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">α'</span> <span class="o">:</span> <span class="kt">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α'</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α'</span> <span class="bp">≃</span> <span class="n">α</span><span class="o">)</span>
 <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">a'</span> <span class="o">:</span> <span class="n">α'</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">function.update</span> <span class="n">f</span> <span class="n">a</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="n">a'</span><span class="o">)</span> <span class="bp">=</span> <span class="n">function.update</span> <span class="o">(</span><span class="n">f</span> <span class="bp">∘</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">g.symm</span> <span class="n">a</span><span class="o">)</span> <span class="n">v</span> <span class="n">a'</span> <span class="o">:=</span>
<span class="n">congr_fun</span> <span class="o">(</span><span class="n">function.update_comp_equiv</span> <span class="n">f</span> <span class="n">g</span> <span class="n">a</span> <span class="n">v</span><span class="o">)</span> <span class="n">a'</span>

<span class="kd">def</span> <span class="n">multilinear_map.dom_dom_congr</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">multilinear_map</span> <span class="n">R</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">,</span> <span class="n">M</span><span class="o">)</span> <span class="n">N</span><span class="o">)</span> <span class="o">(</span><span class="n">σ</span> <span class="o">:</span> <span class="n">equiv.perm</span> <span class="n">ι</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">multilinear_map</span> <span class="n">R</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">,</span> <span class="n">M</span><span class="o">)</span> <span class="n">N</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span><span class="o">,</span> <span class="n">m</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">v</span> <span class="o">(</span><span class="n">σ</span> <span class="n">i</span><span class="o">)),</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span> <span class="n">i</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp_rw</span> <span class="n">function.update_comp_equiv_apply</span> <span class="n">v</span><span class="o">,</span> <span class="n">rw</span> <span class="n">m.map_add</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_smul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span> <span class="n">i</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp_rw</span> <span class="n">function.update_comp_equiv_apply</span> <span class="n">v</span><span class="o">,</span> <span class="n">rw</span> <span class="n">m.map_smul</span><span class="o">,</span> <span class="o">},</span> <span class="o">}</span>
</code></pre></div>
<p>Should I be using a <code>congr</code>-like name for those <code>function</code> lemmas? Do they belong in <code>equiv</code> instead?</p>



<a name="218120078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/If%20%60f%60%20is%20a%20multilinear%20map%20then%20%60%CE%BB%20v%2C%20f%20%28v%20%E2%88%98%20%CF%83%29%60%20is%20too/near/218120078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/If.20.60f.60.20is.20a.20multilinear.20map.20then.20.60.CE.BB.20v.2C.20f.20(v.20.E2.88.98.20.CF.83).60.20is.20too.html#218120078">(Nov 27 2020 at 18:47)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5136">#5136</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>