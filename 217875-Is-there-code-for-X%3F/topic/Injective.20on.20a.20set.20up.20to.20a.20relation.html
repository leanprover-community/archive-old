---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html">Injective on a set up to a relation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202008021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202008021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202008021">(Jun 25 2020 at 18:38)</a>:</h4>
<p>I couldn't find a definition like the following in mathlib:</p>
<div class="codehilite"><pre><span></span><code><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="kn">reducible</span><span class="o">]</span> <span class="n">def</span> <span class="n">inj_on_by</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∀</span><span class="o">⦃</span><span class="n">x₁</span> <span class="n">x₂</span> <span class="o">:</span> <span class="n">α</span><span class="o">⦄,</span> <span class="n">x₁</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">x₂</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x₁</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x₂</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">x₁</span> <span class="n">x₂</span>
</code></pre></div>


<p>(this is a variation on <code>set.inj_on</code> in <code>data/set/function.lean</code>).  For the particular use I have in mind, <code>α</code> has a setoid instance, in case that matters.</p>
<p>So, (1) is there some other definition I should be using? or, barring that, (2) would this function be welcome in <code>data/set/function.lean</code> or elsewhere?</p>



<a name="202008170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202008170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202008170">(Jun 25 2020 at 18:40)</a>:</h4>
<p>This looks <em>very</em> specialized.</p>



<a name="202008386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202008386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202008386">(Jun 25 2020 at 18:41)</a>:</h4>
<p><code>inj_on</code> is already pretty obscure, I would say</p>



<a name="202008561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202008561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202008561">(Jun 25 2020 at 18:43)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> I guess you want to use this in your graph theory stuff, right? Could you explain a bit more how/why?</p>



<a name="202008586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202008586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202008586">(Jun 25 2020 at 18:43)</a>:</h4>
<p><a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a></p>



<a name="202011561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202011561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202011561">(Jun 25 2020 at 19:07)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> One of the axioms for undirected graphs in the Chou formalization is exactly <code>inj_on_by link.via links (≈)</code>, where <code>links</code> is a set of <code>link</code> elements, defined by</p>
<div class="codehilite"><pre><span></span><code><span class="kn">structure</span> <span class="n">link</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">src</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">via</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">dest</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>

<span class="n">def</span> <span class="n">link</span><span class="bp">.</span><span class="n">rev</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">link</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">link</span> <span class="n">α</span> <span class="n">β</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">x</span><span class="bp">.</span><span class="n">dest</span><span class="o">,</span> <span class="n">x</span><span class="bp">.</span><span class="n">via</span><span class="o">,</span> <span class="n">x</span><span class="bp">.</span><span class="n">src</span><span class="bp">⟩</span>
</code></pre></div>


<p>with an equivalence relation given by </p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">same_edge</span> <span class="o">:</span> <span class="n">link</span> <span class="n">α</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">link</span> <span class="n">α</span> <span class="n">β</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="bp">∨</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="bp">.</span><span class="n">rev</span>
</code></pre></div>


<p>That is, if two links carry the same edge (have the same <code>via</code>), then they are equal up to orientation reversal.</p>
<p>It's not essential that this definition actually exists, and I'm fine with writing out the full definition of the axiom in the structure.  This would be the only one of the three axioms involving any quantifiers.</p>
<p>In the context of all the axioms, we want <code>link.via</code> on the <code>links</code> set to have <code>link.rev</code> acting on its fibers.</p>
<p>Another way of thinking about this particular axiom is that <code>link.via</code> descends to a map on the quotient of <code>link α β</code> by <code>same_edge</code>, and we wish for this map to be injective.  It seems like it would be more trouble than it's worth to use quotient types to specify this axiom.</p>



<a name="202012462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202012462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202012462">(Jun 25 2020 at 19:15)</a>:</h4>
<p>I think it's easiest to just write it out</p>



<a name="202012556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202012556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202012556">(Jun 25 2020 at 19:16)</a>:</h4>
<p><code>\forall x y, x.via = y.via → same_edge x y</code><br>
is that what you want, or am I missing something?</p>



<a name="202015674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202015674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202015674">(Jun 25 2020 at 19:43)</a>:</h4>
<p>Since there's a set of links, it would be</p>
<div class="codehilite"><pre><span></span><code><span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">},</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">links</span> <span class="bp">→</span> <span class="n">y</span> <span class="err">∈</span> <span class="n">links</span> <span class="bp">→</span> <span class="n">x</span><span class="bp">.</span><span class="n">via</span> <span class="bp">=</span> <span class="n">y</span><span class="bp">.</span><span class="n">via</span> <span class="bp">→</span> <span class="n">same_edge</span> <span class="n">x</span> <span class="n">y</span>
</code></pre></div>


<p>but yeah, that's pretty much it.</p>
<p>I just thought I'd ask in case this was somehow less specialized than I imagined it to be, or if there was some convenient setoid thing I didn't know about.</p>
<p>Thanks for the advice everyone.</p>



<a name="202015896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Injective%20on%20a%20set%20up%20to%20a%20relation/near/202015896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Injective.20on.20a.20set.20up.20to.20a.20relation.html#202015896">(Jun 25 2020 at 19:45)</a>:</h4>
<p>Yeah, just use what you wrote. It's fine.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>