---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html">Compositum of finite field extensions is finite</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="265322898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265322898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Monnet <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265322898">(Dec 17 2021 at 16:32)</a>:</h4>
<p>(This question is copy-pasted from one in New Members)</p>
<p>I need the fact that for finite field extensions <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">E_1/K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>2</mn></msub><mi mathvariant="normal">/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">E_2/K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>, contained in some larger field <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span>, we have that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><msub><mi>E</mi><mn>2</mn></msub><mi mathvariant="normal">/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">E_1E_2 / K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is also finite. Here is a statement of the lemma in Lean:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">field_theory.galois</span>
<span class="kn">import</span> <span class="n">data.set.basic</span>
<span class="kn">import</span> <span class="n">algebra.group.basic</span>

<span class="kd">lemma</span> <span class="n">comp_finrank_is_finrank</span> <span class="o">(</span><span class="n">K</span> <span class="n">L</span><span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span> <span class="o">(</span><span class="n">E1</span> <span class="n">E2</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">E1</span> <span class="bp">∧</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">E2</span> <span class="bp">→</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="bp">↥</span><span class="o">(</span><span class="n">Sup</span> <span class="o">{</span><span class="n">E</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span> <span class="bp">|</span> <span class="n">E</span> <span class="bp">=</span> <span class="n">E1</span> <span class="bp">∨</span> <span class="n">E</span> <span class="bp">=</span> <span class="n">E2</span><span class="o">})</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Does anyone know if this lemma already exists in mathlib? I've looked through a few of the field theory entries and I can't find anything that looks like this.</p>



<a name="265323171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265323171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265323171">(Dec 17 2021 at 16:34)</a>:</h4>
<p><del>Your LaTeX is a sup but your code is an inf.</del>(fixed)</p>



<a name="265323480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265323480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265323480">(Dec 17 2021 at 16:36)</a>:</h4>
<p>I think the idiomatic way to ask the LaTeX question is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">field_theory.galois</span>
<span class="kn">import</span> <span class="n">data.set.basic</span>
<span class="kn">import</span> <span class="n">algebra.group.basic</span>

<span class="kd">lemma</span> <span class="n">subalgebra.finite_dimensional_sup</span> <span class="o">(</span><span class="n">K</span> <span class="n">L</span><span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
  <span class="o">(</span><span class="n">E1</span> <span class="n">E2</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">E1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">E2</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="bp">↥</span><span class="o">(</span><span class="n">E1</span> <span class="bp">⊔</span> <span class="n">E2</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>and I agree that we don't seem to have it. Note that it won't follow from the corresponding statement about submodules <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.finite_dimensional_sup">docs#submodule.finite_dimensional_sup</a> because the submodule sup is in general smaller than the subalgebra sup.</p>



<a name="265323706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265323706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Monnet <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265323706">(Dec 17 2021 at 16:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite/near/265323171">said</a>:</p>
<blockquote>
<p>Your LaTeX is a sup but your code is an inf.</p>
</blockquote>
<p>Fixed</p>



<a name="265323914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265323914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265323914">(Dec 17 2021 at 16:39)</a>:</h4>
<p>AFAIR, we have transitivity, so you need to prove that the dimension of <code>E1 ⊔ E2</code> over <code>E1</code> is less than or equal to the dimension of <code>E2</code> over <code>K</code>.</p>



<a name="265323981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265323981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265323981">(Dec 17 2021 at 16:40)</a>:</h4>
<p>But I never used this part of the library.</p>



<a name="265324097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265324097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265324097">(Dec 17 2021 at 16:41)</a>:</h4>
<p>Do we know that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E_1 \otimes E_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> surjects onto it?</p>



<a name="265324106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265324106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265324106">(Dec 17 2021 at 16:41)</a>:</h4>
<p>Oh I guess it should be called <code>intermediate_field.finite_dimensional_sup</code></p>



<a name="265324552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265324552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265324552">(Dec 17 2021 at 16:44)</a>:</h4>
<p><span class="user-mention" data-user-id="253861">@Thomas Browning</span> did you need this stuff for e.g. normal closure?</p>



<a name="265356306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265356306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265356306">(Dec 17 2021 at 20:28)</a>:</h4>
<p>I can't remember seeing/using this sort of thing. We were just working with towers, I think.</p>



<a name="265378924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265378924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265378924">(Dec 18 2021 at 00:10)</a>:</h4>
<p>It's a shame that this isn't there, this is the sort of thing which is quite fiddly if you're not an expert, and Sebastian is just starting.</p>



<a name="265379032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265379032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265379032">(Dec 18 2021 at 00:11)</a>:</h4>
<p>I guess the lemma to prove is that if X spans E2 as a K-module then it spans E1 cup E2 as an E1-module</p>



<a name="265379048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265379048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265379048">(Dec 18 2021 at 00:11)</a>:</h4>
<p>But stating that is fiddly</p>



<a name="265397048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265397048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265397048">(Dec 18 2021 at 06:41)</a>:</h4>
<p>Here's a proof. I can start PRing it tomorrow, if you would like.</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<p>lemma alg_hom.range_comp {R A B C : Type*} [comm_semiring R] [semiring A] [semiring B]<br>
  [semiring C]<br>
  [algebra R A] [algebra R B] [algebra R C] (f : A →ₐ[R] B) (g : B →ₐ[R] C) :<br>
  (g.comp f).range = <a href="http://f.range.map">f.range.map</a> g :=<br>
set_like.coe_injective (set.range_comp g f)</p>
<p>lemma alg_hom.range_comp_le_range {R A B C : Type*} [comm_semiring R] [semiring A] [semiring B]<br>
  [semiring C]<br>
  [algebra R A] [algebra R B] [algebra R C] (f : A →ₐ[R] B) (g : B →ₐ[R] C) :<br>
  (g.comp f).range ≤ g.range :=<br>
set_like.coe_mono (set.range_comp_subset_range f g)</p>
<p>lemma subalgebra.mem_sup_left {R A : Type*} [comm_semiring R] [semiring A] [algebra R A]<br>
  {S T : subalgebra R A} : ∀ {x : A}, x ∈ S → x ∈ S ⊔ T :=<br>
show S ≤ S ⊔ T, from le_sup_left</p>
<p>lemma subalgebra.mem_sup_right {R A : Type*} [comm_semiring R] [semiring A] [algebra R A]<br>
  {S T : subalgebra R A} : ∀ {x : A}, x ∈ T → x ∈ S ⊔ T :=<br>
show T ≤ S ⊔ T, from le_sup_right</p>
<p>lemma subalgebra.mul_mem_sup {R A : Type*} [comm_semiring R] [semiring A] [algebra R A]<br>
  {S T : subalgebra R A} {x y : A} (hx : x ∈ S) (hy : y ∈ T) : x * y ∈ S ⊔ T :=<br>
(S ⊔ T).mul_mem (subalgebra.mem_sup_left hx) (subalgebra.mem_sup_right hy)</p>
<p>lemma algebra.tensor_product.product_map_range {R A B S : Type*} [comm_semiring R]<br>
  [semiring A] [semiring B] [comm_semiring S] [algebra R A] [algebra R B] [algebra R S]<br>
  (f : A →ₐ[R] S) (g : B →ₐ[R] S) :<br>
  (algebra.tensor_product.product_map f g).range = f.range ⊔ g.range :=<br>
begin<br>
  refine le_antisymm _ (sup_le _ _),<br>
  { have := tensor_product.span_tmul_eq_top R A B,<br>
    replace : algebra.adjoin R {t : A ⊗ B | ∃ (a : A) (b : B), a ⊗ₜ[R] b = t} = ⊤ :=<br>
<a href="http://top_le_iff.mp">top_le_iff.mp</a> ((<a href="http://eq_top_iff.mp">eq_top_iff.mp</a> this).trans (algebra.span_le_adjoin R _)),<br>
    rw [←algebra.map_top, ←this, ←algebra.adjoin_image, algebra.adjoin_le_iff],<br>
    rintros _ ⟨_, ⟨a, b, rfl⟩, rfl⟩,<br>
    rw algebra.tensor_product.product_map_apply_tmul,<br>
    exact subalgebra.mul_mem_sup (f.mem_range_self a) (g.mem_range_self b) },<br>
  { conv_lhs { rw ← algebra.tensor_product.product_map_left f g },<br>
    apply alg_hom.range_comp_le_range },<br>
  { conv_lhs { rw ← algebra.tensor_product.product_map_right f g },<br>
    apply alg_hom.range_comp_le_range },<br>
end</p>
<p>lemma subalgebra.finite_dimensional_sup {K L : Type*} [field K] [comm_ring L] [algebra K L]<br>
  (E1 E2 : subalgebra K L) [finite_dimensional K E1] [finite_dimensional K E2] :<br>
  finite_dimensional K ↥(E1 ⊔ E2) :=<br>
begin<br>
  let g := algebra.tensor_product.product_map E1.val E2.val,<br>
  suffices : g.to_linear_map.range = (E1 ⊔ E2).to_submodule,<br>
  { have key := g.to_linear_map.finite_dimensional_range,<br>
    rwa this at key },<br>
  suffices : g.range = E1 ⊔ E2,<br>
  { rw ← this,<br>
    refl },<br>
  rw [algebra.tensor_product.product_map_range, E1.range_val, E2.range_val],<br>
end</p>
<p>lemma intermediate_field.range_val {K L : Type*} [field K] [field L] [algebra K L]<br>
  (S : intermediate_field K L) : S.val.range = S.to_subalgebra :=<br>
S.to_subalgebra.range_val</p>
<p>lemma le_integral_closure_iff_is_integral {R A : Type*} [comm_ring R] [comm_ring A]<br>
  [algebra R A] {S : subalgebra R A} : S ≤ integral_closure R A ↔ algebra.is_integral R S :=<br>
begin<br>
  have : (∀ x : S, is_integral R (algebra_map S A x)) ↔ (∀ x : S, is_integral R x) :=<br>
  forall_congr (λ x, is_integral_algebra_map_iff subtype.coe_injective),<br>
  exact set_like.forall.symm.trans this,<br>
end</p>
<p>lemma is_field_of_is_integral_of_is_field'<br>
  {R S : Type*} [field R] [comm_ring S] [is_domain S]<br>
  [algebra R S] (H : algebra.is_integral R S) (hRS : function.injective (algebra_map R S)) :<br>
  is_field S :=<br>
begin<br>
  refine ⟨⟨0, 1, zero_ne_one⟩, mul_comm, λ x hx, _⟩,<br>
  have key0 := fg_adjoin_singleton_of_integral x (H x),<br>
  let A := algebra.adjoin R ({x} : set S),<br>
  let f : A →ₗ[R] A :=<br>
  { to_fun := λ y, ⟨x, algebra.mem_adjoin_iff.mpr (subring.mem_closure.mpr (λ T hT,<br>
      show _, from <a href="http://set.singleton_subset_iff.mp">set.singleton_subset_iff.mp</a> (<a href="http://set.union_subset_iff.mp">set.union_subset_iff.mp</a> hT).2))⟩ * y,<br>
    map_add' := λ y z, mul_add _ y z,<br>
    map_smul' := λ y z, mul_smul_comm y _ z, },<br>
  have key : function.injective f,<br>
  { rw [←linear_map.ker_eq_bot, eq_bot_iff],<br>
    intros y hy,<br>
    exact (eq_zero_or_eq_zero_of_mul_eq_zero hy).resolve_left (λ h, hx (<a href="http://subtype.ext_iff.mp">subtype.ext_iff.mp</a> h)) },<br>
  haveI key' : is_noetherian R A.to_submodule := is_noetherian_of_fg_of_noetherian A.to_submodule<br>
    (fg_adjoin_singleton_of_integral x (H x)),<br>
  haveI this : module.finite R A.to_submodule := module.is_noetherian.finite R A,<br>
  tactic.unfreeze_local_instances,<br>
  change module.finite R A at this,<br>
  obtain ⟨y, hy⟩ := @linear_map.surjective_of_injective R A _ _ _ _ f key 1,<br>
  exact ⟨y, <a href="http://subtype.ext_iff.mp">subtype.ext_iff.mp</a> hy⟩,<br>
end</p>
<p>lemma intermediate_field.sup_to_subalgebra {K L : Type*} [field K] [field L] [algebra K L]<br>
  (E1 E2 : intermediate_field K L) [finite_dimensional K E1] [finite_dimensional K E2] :<br>
  (E1 ⊔ E2).to_subalgebra = E1.to_subalgebra ⊔ E2.to_subalgebra :=<br>
begin<br>
  have h1 : algebra.is_integral K E1 :=<br>
  (is_algebraic_iff_is_integral' K).mp algebra.is_algebraic_of_finite,<br>
  have h2 : algebra.is_integral K E2 :=<br>
  (is_algebraic_iff_is_integral' K).mp algebra.is_algebraic_of_finite,<br>
  have h3 : algebra.is_integral K ↥(E1.to_subalgebra ⊔ E2.to_subalgebra) :=<br>
<a href="http://le_integral_closure_iff_is_integral.mp">le_integral_closure_iff_is_integral.mp</a> (sup_le<br>
    (le_integral_closure_iff_is_integral.mpr h1) (le_integral_closure_iff_is_integral.mpr h2)),<br>
  have h4 := is_field_of_is_integral_of_is_field' h3 (ring_hom.injective _),<br>
  let S : intermediate_field K L := (E1.to_subalgebra ⊔ E2.to_subalgebra).to_intermediate_field<br>
    (λ x hx, by<br>
    { by_cases hx' : x = 0,<br>
      { rw [hx', inv_zero],<br>
        exact (E1.to_subalgebra ⊔ E2.to_subalgebra).zero_mem },<br>
      { obtain ⟨y, hy⟩ := h4.mul_inv_cancel<br>
          (show (⟨x, hx⟩ : E1.to_subalgebra ⊔ E2.to_subalgebra) ≠ 0,<br>
            from (λ h, hx' (<a href="http://subtype.ext_iff.mp">subtype.ext_iff.mp</a> h))),<br>
        have key : ↑y = x⁻¹ := eq_inv_of_mul_right_eq_one (<a href="http://subtype.ext_iff.mp">subtype.ext_iff.mp</a> hy),<br>
        rw ← key,<br>
        exact y.2 } }),<br>
  exact le_antisymm (show E1 ⊔ E2 ≤ S, from sup_le<br>
    (show E1.to_subalgebra ≤ E1.to_subalgebra ⊔ E2.to_subalgebra, from le_sup_left)<br>
    (show E2.to_subalgebra ≤ E1.to_subalgebra ⊔ E2.to_subalgebra, from le_sup_right))<br>
    (sup_le (show E1 ≤ E1 ⊔ E2, from le_sup_left)<br>
    (show E2 ≤ E1 ⊔ E2, from le_sup_right)),<br>
end</p>
<p>lemma intermediate_field.finite_dimensional_sup {K L : Type*} [field K] [field L] [algebra K L]<br>
  (E1 E2 : intermediate_field K L) [h1 : finite_dimensional K E1] [h2 : finite_dimensional K E2] :<br>
  finite_dimensional K ↥(E1 ⊔ E2) :=<br>
begin<br>
  let g := algebra.tensor_product.product_map E1.val E2.val,<br>
  suffices : g.to_linear_map.range = (E1 ⊔ E2).to_subalgebra.to_submodule,<br>
  { have key := g.to_linear_map.finite_dimensional_range,<br>
    rwa this at key },<br>
  suffices : g.range = (E1 ⊔ E2).to_subalgebra,<br>
  { rw ← this,<br>
    refl },<br>
  rw [algebra.tensor_product.product_map_range, E1.range_val, E2.range_val],<br>
  exact (intermediate_field.sup_to_subalgebra E1 E2).symm,<br>
end</p>
</div></div>



<a name="265407578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265407578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265407578">(Dec 18 2021 at 09:10)</a>:</h4>
<p>Oh my goodness! Thank you so much Thomas!</p>



<a name="265409566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265409566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Monnet <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265409566">(Dec 18 2021 at 09:57)</a>:</h4>
<p>Thanks Thomas, that’s incredibly helpful!</p>



<a name="265416355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265416355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265416355">(Dec 18 2021 at 12:41)</a>:</h4>
<p>So I can't quite get Thomas' code running because I seem to be missing an instance.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">K</span> <span class="n">L</span> <span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">M</span><span class="o">]</span>
  <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">K</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">K</span> <span class="o">(</span><span class="n">L</span> <span class="bp">⊗</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>
<p>Am I missing an import?</p>



<a name="265434903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265434903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265434903">(Dec 18 2021 at 18:34)</a>:</h4>
<p>You're probably missing <code>linear_algebra/tensor_product_basis.lean</code>. Sorry, I should have added imports.</p>



<a name="265617486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265617486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265617486">(Dec 20 2021 at 21:23)</a>:</h4>
<p>Here's the PR: <a href="https://github.com/leanprover-community/mathlib/pull/10938">#10938</a></p>



<a name="265622594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265622594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265622594">(Dec 20 2021 at 22:18)</a>:</h4>
<p>Thanks Thomas!</p>
<p>I think that to do the stuff with normality we need a little more about splitting fields, for example "if L/K is an extension, and f in K[X] splits in E_i for a bunch of subfields, then it splits in their Inf".</p>



<a name="265623599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265623599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265623599">(Dec 20 2021 at 22:31)</a>:</h4>
<p>That particular thing doesn't sound too hard, since you can look at the roots of f. One way of doing this is to factor f in L (in terms of a multiset of elements of L), show that each root lies in the Inf, then construct a multiset in the Inf, and finally invoke the lemma about splitting iff there exists a multiset.</p>



<a name="265623861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265623861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265623861">(Dec 20 2021 at 22:34)</a>:</h4>
<p>Is there a specific goal that all this is building up to?</p>



<a name="265623888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265623888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265623888">(Dec 20 2021 at 22:34)</a>:</h4>
<p>Topology on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi></mrow><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="double-struck">Q</mi><mo stretchy="true">‾</mo></mover><mi mathvariant="normal">/</mi><mi mathvariant="double-struck">Q</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q}).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1389em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">Gal</span></span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8889em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbb">Q</span></span></span><span style="top:-3.8089em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1667em;"><span></span></span></span></span></span><span class="mord">/</span><span class="mord mathbb">Q</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></p>



<a name="265623902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Compositum%20of%20finite%20field%20extensions%20is%20finite/near/265623902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Compositum.20of.20finite.20field.20extensions.20is.20finite.html#265623902">(Dec 20 2021 at 22:34)</a>:</h4>
<p>We already have it, but we're trying to do it properly (i.e. make a better definition for which it will be possible to develop an API)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>