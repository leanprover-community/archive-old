---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html">Equal within s imply same limit within s</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202031687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202031687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202031687">(Jun 25 2020 at 22:08)</a>:</h4>
<p>Do we have something like this ? </p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202032023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032023">(Jun 25 2020 at 22:12)</a>:</h4>
<p>You need a lemma whose name contains "congr".</p>



<a name="202032039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032039">(Jun 25 2020 at 22:12)</a>:</h4>
<p>This is not a riddle, that's all I can say at first sight.</p>



<a name="202032052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032052">(Jun 25 2020 at 22:12)</a>:</h4>
<p>Now I'll look at mathlib.</p>



<a name="202032114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032114">(Jun 25 2020 at 22:13)</a>:</h4>
<p>Oh, you got parentheses wrong</p>



<a name="202032215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032215">(Jun 25 2020 at 22:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202032114">said</a>:</p>
<blockquote>
<p>Oh, you got parentheses wrong</p>
</blockquote>
<p>Where ?</p>



<a name="202032244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032244">(Jun 25 2020 at 22:15)</a>:</h4>
<p>The forall is binding too much.</p>



<a name="202032305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032305">(Jun 25 2020 at 22:15)</a>:</h4>
<p>Oh yeah</p>



<a name="202032387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032387">(Jun 25 2020 at 22:16)</a>:</h4>
<p>There is no point in having all this right of the colon anyway.</p>



<a name="202032574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032574">(Jun 25 2020 at 22:18)</a>:</h4>
<p>Indeed</p>



<a name="202032980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202032980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202032980">(Jun 25 2020 at 22:23)</a>:</h4>
<p>It seems this lemma doesn't exist yet, but <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.tendsto.congr'">docs#filter.tendsto.congr'</a> does.</p>



<a name="202033266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202033266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202033266">(Jun 25 2020 at 22:27)</a>:</h4>
<p>Do you want the answer or do you want to try to finish using this hint only?</p>



<a name="202033321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202033321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202033321">(Jun 25 2020 at 22:27)</a>:</h4>
<p>The proof I have is 72 characters long.</p>



<a name="202033682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202033682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202033682">(Jun 25 2020 at 22:31)</a>:</h4>
<p>My PC just crashed, but yeah I've seen this one and I'm trying to deduce mine</p>



<a name="202034233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034233">(Jun 25 2020 at 22:38)</a>:</h4>
<p>I have this : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span>
    <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">tendsto_congr&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">univ</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">filter</span><span class="bp">.</span><span class="n">univ_sets</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">use</span> <span class="o">(</span><span class="k">by</span> <span class="n">tauto</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">univ_inter</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202034297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034297">(Jun 25 2020 at 22:39)</a>:</h4>
<p>I think I'm going too deep in the definition unfolding</p>



<a name="202034439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034439">(Jun 25 2020 at 22:41)</a>:</h4>
<p>And the first line is useless, I should have removed it</p>



<a name="202034513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034513">(Jun 25 2020 at 22:42)</a>:</h4>
<p>Your proof doesn't work here. Are you using an old mathlib?</p>



<a name="202034566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034566">(Jun 25 2020 at 22:43)</a>:</h4>
<p>For the purpose of this conversation, old probably means older than <a href="https://github.com/leanprover-community/mathlib/commit/d287d34590761dc6237c7b21d9427580b2d339c4">https://github.com/leanprover-community/mathlib/commit/d287d34590761dc6237c7b21d9427580b2d339c4</a>.</p>



<a name="202034643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034643">(Jun 25 2020 at 22:45)</a>:</h4>
<p>I definitely underestimated update frequency then <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="202034657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034657">(Jun 25 2020 at 22:45)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_stats.html">https://leanprover-community.github.io/mathlib_stats.html</a></p>



<a name="202034722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034722">(Jun 25 2020 at 22:46)</a>:</h4>
<p>HUGE lockdown peak x)</p>



<a name="202034742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034742">(Jun 25 2020 at 22:46)</a>:</h4>
<p>Of course!</p>



<a name="202034934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034934">(Jun 25 2020 at 22:49)</a>:</h4>
<p>I was in another file with one more <code>open</code>, but it works now :</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">mean_value</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">h</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">tendsto_congr&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">univ</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">filter</span><span class="bp">.</span><span class="n">univ_sets</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">use</span> <span class="o">(</span><span class="k">by</span> <span class="n">tauto</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">univ_inter</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202034990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202034990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202034990">(Jun 25 2020 at 22:50)</a>:</h4>
<p>Well, I think it should at least</p>



<a name="202035974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202035974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202035974">(Jun 25 2020 at 23:03)</a>:</h4>
<p>No, it doesn't work here. Did you update mathlib?</p>



<a name="202036305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202036305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202036305">(Jun 25 2020 at 23:08)</a>:</h4>
<p><code>leanproject up</code> ?</p>



<a name="202078365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202078365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202078365">(Jun 26 2020 at 11:27)</a>:</h4>
<p>Well I've just run <code>leanproject up</code> and this definitely compile :</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">mean_value</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">h</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">tendsto_congr&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">univ</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">filter</span><span class="bp">.</span><span class="n">univ_sets</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">use</span> <span class="o">(</span><span class="k">by</span> <span class="n">tauto</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">univ_inter</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202078827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202078827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202078827">(Jun 26 2020 at 11:32)</a>:</h4>
<p>The main trick you're missing in <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.mem_inf_sets_of_right">docs#filter.mem_inf_sets_of_right</a> . One could argue this is relying on internal details of <code>nhds_within</code>, and the <code>nhds_within</code> API is lacking.</p>



<a name="202079336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079336">(Jun 26 2020 at 11:38)</a>:</h4>
<p>This works for me:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tendsto_congr&#39;</span> <span class="o">(</span><span class="n">eventually_eq_iff_exists_mem</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">self_mem_nhds_within</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span> <span class="n">hf</span>
</code></pre></div>


<p>I am cheating because this won't work for you, as I have somewhere in <code>filter/basic.lean</code> the lemma</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">eventually_eq_iff_exists_mem</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">l</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">s</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">filter</span><span class="bp">.</span><span class="n">eventually_iff_exists_mem</span>
</code></pre></div>



<a name="202079583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079583">(Jun 26 2020 at 11:42)</a>:</h4>
<p>Spoilers!</p>



<a name="202079626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079626">(Jun 26 2020 at 11:43)</a>:</h4>
<p>Well even <code>filter.eventually_iff_exists_mem</code> doesn't exist for me, should it ?</p>



<a name="202079635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079635">(Jun 26 2020 at 11:43)</a>:</h4>
<p>Not so much because it doesn't work with current mathlib :)</p>



<a name="202079643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079643">(Jun 26 2020 at 11:43)</a>:</h4>
<p>AH</p>



<a name="202079710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079710">(Jun 26 2020 at 11:44)</a>:</h4>
<p>Anatole, do you want to see a short solution that actually work, or do you want to keep trying?</p>



<a name="202079715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079715">(Jun 26 2020 at 11:44)</a>:</h4>
<p>No, it doesn't exist either. But it is not hard to prove. It's just to illustrate that having basic API (which is currently missing) helps a lot to prove further statements.</p>



<a name="202079751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079751">(Jun 26 2020 at 11:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202079710">said</a>:</p>
<blockquote>
<p>Anatole, do you want to see a short solution that actually work, or do you want to keep trying?</p>
</blockquote>
<p>I'll take it, I like to learn by imitating x)</p>



<a name="202079776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079776">(Jun 26 2020 at 11:45)</a>:</h4>
<p><code>λ h, tendsto.congr' $ mem_inf_sets_of_right (eventually_principal.mpr h)</code></p>



<a name="202079777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079777">(Jun 26 2020 at 11:45)</a>:</h4>
<p>Guess I should train to use term-mode too</p>



<a name="202079820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079820">(Jun 26 2020 at 11:46)</a>:</h4>
<p>But again the correct solution is add lots of tiny lemmas that are easy to find.</p>



<a name="202079906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202079906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202079906">(Jun 26 2020 at 11:47)</a>:</h4>
<p>After the third line of your solution, you need to stop and think: there should be a lemma here. Then type <code>extract_goal</code>, do some cleanup, prove and use.</p>



<a name="202080010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080010">(Jun 26 2020 at 11:49)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span>  there is a serious issue with precedences for the eventually_eq notation.</p>



<a name="202080278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080278">(Jun 26 2020 at 11:52)</a>:</h4>
<p>Anatole, the issue is that <code>eventually_eq</code> and <code>eventually_le</code> are <em>very</em> recent and still lack of lot of lemmas. Even <code>eventually</code> and <code>frequently</code> are not so old and still lack lemmas. If you unfold all see to basic filter stuff, involving only membership and lattices operations on filters, then all the lemmas are there. But we need a lot of plumbing.</p>



<a name="202080520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080520">(Jun 26 2020 at 11:56)</a>:</h4>
<p>Wow tidy is powerful</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">h</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">tendsto_congr&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">mem_inf_sets_of_right</span><span class="o">,</span>
  <span class="n">tidy</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202080538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080538">(Jun 26 2020 at 11:56)</a>:</h4>
<p>But I don't think that's what you were hoping me to do</p>



<a name="202080591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080591">(Jun 26 2020 at 11:57)</a>:</h4>
<p><code>tidy?</code> will tell you how it proved it</p>



<a name="202080675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080675">(Jun 26 2020 at 11:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">h</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">tendsto_congr&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">mem_inf_sets_of_right</span><span class="o">,</span>
  <span class="n">assumption</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202080681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202080681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202080681">(Jun 26 2020 at 11:58)</a>:</h4>
<p>x)</p>



<a name="202081600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202081600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202081600">(Jun 26 2020 at 12:11)</a>:</h4>
<p>Here is your plumbing exercise:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>

<span class="n">open_locale</span> <span class="n">filter</span> <span class="n">topological_space</span>
<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_iff</span>  <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="err">𝓝</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_of_eq_on</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">eq_on</span> <span class="n">f</span> <span class="n">g</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_congr</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="n">sorry</span>
</code></pre></div>


<p>Make sure you understand the choices of binders. The second and third proofs should be one line long terms. The first one will probably be longer, which means it should probably be split further.</p>



<a name="202082145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202082145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202082145">(Jun 26 2020 at 12:16)</a>:</h4>
<p>Hey, I got shorter than you  <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span> </p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">tendsto_congr&#39;</span> <span class="o">(</span><span class="n">mem_inf_sets_of_right</span> <span class="o">(</span><span class="k">by</span> <span class="n">exact</span> <span class="n">h</span><span class="o">)))</span><span class="bp">.</span><span class="mi">1</span>
</code></pre></div>



<a name="202082185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202082185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202082185">(Jun 26 2020 at 12:16)</a>:</h4>
<p>Now it is not entirely clear why <code>by exact h</code> can't be replaced by <code>h</code> here <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="202082532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202082532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202082532">(Jun 26 2020 at 12:21)</a>:</h4>
<p>For readability, you can use</p>
<div class="codehilite"><pre><span></span><code><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">tendsto_congr&#39;</span> <span class="err">$</span> <span class="n">mem_inf_sets_of_right</span> <span class="err">$</span> <span class="k">by</span> <span class="n">exact</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span>
</code></pre></div>



<a name="202082597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202082597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202082597">(Jun 26 2020 at 12:21)</a>:</h4>
<p>The fact that <code>by exact</code> is needed shows Lean elaboration has trouble. You're not being nice to Lean, it has to unfold many definition in the right order to get there. This is why you need plumbing.</p>



<a name="202083451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202083451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202083451">(Jun 26 2020 at 12:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202080010">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span>  there is a serious issue with precedences for the eventually_eq notation.</p>
</blockquote>
<p>What exactly do you mean? <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?</p>



<a name="202083592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202083592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202083592">(Jun 26 2020 at 12:34)</a>:</h4>
<p><a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202081600">https://leanprover.zulipchat.com/#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202081600</a> is autonomous. The first statement needs unexpected parentheses.</p>



<a name="202083604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202083604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202083604">(Jun 26 2020 at 12:34)</a>:</h4>
<p>And I know I saw other examples yesterday.</p>



<a name="202086680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202086680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202086680">(Jun 26 2020 at 13:05)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">notation</span> <span class="n">f</span> <span class="bp">`</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="n">l</span><span class="o">:</span><span class="mi">50</span> <span class="bp">`</span><span class="o">]</span> <span class="bp">`</span><span class="o">:</span><span class="mi">0</span> <span class="n">g</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">filter</span><span class="bp">.</span><span class="n">eventually_eq</span> <span class="n">l</span> <span class="n">f</span> <span class="n">g</span>
</code></pre></div>


<p>works in this case.</p>



<a name="202091808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202091808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202091808">(Jun 26 2020 at 13:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="268315">Anatole Dedecker</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s/near/202079777">said</a>:</p>
<blockquote>
<p>Guess I should train to use term-mode too</p>
</blockquote>
<p>If you concentrate on proving and tactic mode then you will slowly realise which proofs have "content" (e.g. they use high-powered tactics) and which proofs are literally just "intro, apply, cases, exact" which are really just ways to make a function piece by piece. For these "basic" proofs it's a good exercise to turn it into term mode (because you learn some weird tricks sometimes). After a while you can write hybrid proofs, where the intro/apply stuff is in term mode, and the occasional high-powered tactic like <code>rw</code> is just done by briefly dropping into tactic mode with <code>by rw ...</code></p>



<a name="202188999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202188999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202188999">(Jun 27 2020 at 14:42)</a>:</h4>
<p>I've been busy IRL since yesterday afternoon, but here is the plumbing <span class="user-mention" data-user-id="110031">@Patrick Massot</span> . I could shorten the first, especially if I finally start to learn <code>rcases</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> but I'll work on this later, cause my parents are exploiting me right now x) </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">tidy</span>

<span class="n">open_locale</span> <span class="n">filter</span> <span class="n">topological_space</span>
<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_iff</span>  <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="err">𝓝</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">eventually_eq</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">eventually_iff</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">eventually_iff</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mem_nhds_within</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mem_nhds_sets_iff</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">u</span> <span class="n">hu</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hu</span> <span class="k">with</span> <span class="n">hu</span> <span class="n">hau</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hau</span> <span class="k">with</span> <span class="n">hau</span> <span class="n">hus</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">u</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span> <span class="n">hxs</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hus</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">and</span><span class="bp">.</span><span class="n">intro</span> <span class="n">hx</span> <span class="n">hxs</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">and</span><span class="bp">.</span><span class="n">intro</span> <span class="n">hu</span> <span class="n">hau</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">t</span> <span class="n">ht</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ht</span> <span class="k">with</span> <span class="n">htsub</span> <span class="n">ht</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ht</span> <span class="k">with</span> <span class="n">ht</span> <span class="n">hta</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">t</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ht</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hta</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hx</span> <span class="k">with</span> <span class="n">hxt</span> <span class="n">hxs</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">htsub</span> <span class="n">hxt</span> <span class="n">hxs</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_of_eq_on</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">eq_on</span> <span class="n">f</span> <span class="n">g</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span> <span class="o">:=</span>
<span class="n">mem_inf_sets_of_right</span> <span class="n">h</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_congr</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">tendsto_congr&#39;</span> <span class="err">$</span> <span class="n">eventually_eq_nhds_within_of_eq_on</span> <span class="n">hfg</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">hf</span>
</code></pre></div>



<a name="202202766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202202766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202202766">(Jun 27 2020 at 20:03)</a>:</h4>
<p>Indeed you need to learn about <code>rintros</code>/<code>rcases</code>. But actually you are not using any tactic here. After the rewrite, everything you wrote has completely straightforward translation to term mode. You can also group your <code>rw</code> in one tactic invocation.</p>



<a name="202202827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202202827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202202827">(Jun 27 2020 at 20:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_iff</span>  <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="err">𝓝</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">eventually_eq</span><span class="o">,</span> <span class="n">eventually_iff</span><span class="o">,</span> <span class="n">eventually_iff</span><span class="o">,</span> <span class="n">mem_nhds_within</span><span class="o">,</span> <span class="n">mem_nhds_sets_iff</span><span class="o">],</span>
  <span class="n">exact</span> <span class="bp">⟨λ</span> <span class="bp">⟨</span><span class="n">u</span><span class="o">,</span> <span class="n">hu</span><span class="o">,</span> <span class="n">hau</span><span class="o">,</span> <span class="n">hus</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">u</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span> <span class="n">hxs</span><span class="o">,</span> <span class="n">hus</span> <span class="bp">⟨</span><span class="n">hx</span><span class="o">,</span> <span class="n">hxs</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">hu</span><span class="o">,</span> <span class="n">hau</span><span class="bp">⟩⟩</span><span class="o">,</span>
         <span class="bp">λ</span> <span class="bp">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">htsub</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hta</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hta</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">x</span> <span class="bp">⟨</span><span class="n">hxt</span><span class="o">,</span> <span class="n">hxs</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">htsub</span> <span class="n">hxt</span> <span class="n">hxs</span><span class="bp">⟩⟩</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202202840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202202840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202202840">(Jun 27 2020 at 20:04)</a>:</h4>
<p>This is exactly your proof, but without wasting too much space.</p>



<a name="202202947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202202947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202202947">(Jun 27 2020 at 20:07)</a>:</h4>
<p>Note also:</p>
<ul>
<li>nobody is interested in seeing this proof since the statement is obvious. mathlib style in this case is to compress the proof.</li>
<li>actually you don't loose any information. You can still move your cursor and see the tactic state. Note that the tactic state is update when you move your cursor from left to right in the <code>rw</code> line but also in the exact line.</li>
<li>you still miss intermediate lemmas that could be useful.</li>
</ul>



<a name="202203159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202203159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202203159">(Jun 27 2020 at 20:13)</a>:</h4>
<p>Elaborating on the third point: don't you find it weird that you had to use the definition of neighborhoods in this proof? Don't you feel the lemma should be more general than that?</p>



<a name="202203209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Equal%20within%20s%20imply%20same%20limit%20within%20s/near/202203209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Equal.20within.20s.20imply.20same.20limit.20within.20s.html#202203209">(Jun 27 2020 at 20:14)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>

<span class="n">open_locale</span> <span class="n">filter</span> <span class="n">topological_space</span>
<span class="kn">open</span> <span class="n">filter</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>  <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_inf_principal_iff</span>  <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">F</span> <span class="err">⊓</span> <span class="err">𝓟</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="n">F</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">eventually_eq</span><span class="o">,</span> <span class="n">eventually_iff</span><span class="o">,</span> <span class="n">mem_inf_principal</span><span class="o">]</span>

<span class="kn">lemma</span> <span class="n">eventually_eq_nhds_within_iff</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="bp">=</span><span class="err">ᶠ</span><span class="o">[</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">]</span> <span class="n">g</span><span class="o">)</span> <span class="bp">↔</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="err">𝓝</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">eventually_eq_inf_principal_iff</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>