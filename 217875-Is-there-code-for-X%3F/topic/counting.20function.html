---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html">counting function</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="249880076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249880076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249880076">(Aug 18 2021 at 17:02)</a>:</h4>
<p>A question inspired by discussion in General: is there a counting function which returns the n-th natural number satisfying predicate f?</p>



<a name="249880394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249880394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249880394">(Aug 18 2021 at 17:04)</a>:</h4>
<p>AFAIK, there is <code>nat.find</code> which you would have to iterate, otherwise, if you had a bound on the n-th natural number, you could use <code>find_greatest</code> I suppose.</p>



<a name="249881734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249881734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249881734">(Aug 18 2021 at 17:13)</a>:</h4>
<p>Well, I am just thinking of creating a bounding function and a basic API to it as my first contribution to mathlib, and want to get sure I will not duplicate something already implemented.</p>



<a name="249882220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249882220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249882220">(Aug 18 2021 at 17:16)</a>:</h4>
<p>If you can write (at least roughly) a type for the function you have in mind, you can get a more precise answer about what exists.  (It's also good to run API ideas past the community anyway.)</p>



<a name="249886298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249886298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249886298">(Aug 18 2021 at 17:47)</a>:</h4>
<p>I think this works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.conditionally_complete_lattice</span>

<span class="sd">/-- `satisfied_by p i n c` states that there are `n` values less than or equal to `i` which satisfy `p`, and</span>
<span class="sd">that `p m` is satisfied iff`c`. -/</span>
<span class="kd">inductive</span> <span class="n">satisfied_by</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">bool</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">zero_pos</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="mi">0</span> <span class="mi">1</span> <span class="n">tt</span>
<span class="bp">|</span> <span class="n">zero_neg</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">p</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="mi">0</span> <span class="mi">0</span> <span class="n">ff</span>
<span class="bp">|</span> <span class="n">succ_pos</span> <span class="o">{</span><span class="n">i</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">c</span> <span class="o">:</span> <span class="n">bool</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="n">i.succ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="n">i</span> <span class="n">n</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="n">i.succ</span> <span class="n">n.succ</span> <span class="n">tt</span>
<span class="bp">|</span> <span class="n">succ_neg</span> <span class="o">{</span><span class="n">i</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">c</span> <span class="o">:</span> <span class="n">bool</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">p</span> <span class="n">i.succ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="n">i</span> <span class="n">n</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="n">i.succ</span> <span class="n">n</span> <span class="n">ff</span>

<span class="sd">/-- a counting function which returns the `n`-th natural number satisfying predicate p -/</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="bp">⨅</span> <span class="n">i</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">satisfied_by</span> <span class="n">p</span> <span class="n">i</span> <span class="n">n</span> <span class="n">tt</span><span class="o">),</span> <span class="n">i</span>
</code></pre></div>



<a name="249887699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249887699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249887699">(Aug 18 2021 at 17:57)</a>:</h4>
<p>So this returns <code>0</code> when no such <code>n</code>-th nat exists, right?</p>



<a name="249887752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249887752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249887752">(Aug 18 2021 at 17:57)</a>:</h4>
<p>Yeah, I think so. There's probably a nicer way than using <code>infi</code></p>



<a name="249888195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249888195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249888195">(Aug 18 2021 at 18:00)</a>:</h4>
<p>Of course, you'll probably want to show that <code>decidable_pred (λ (i : ℕ), satisfied_by p i n tt)</code>, which I think is true but is going to be a painful case-bash</p>



<a name="249888211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249888211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249888211">(Aug 18 2021 at 18:00)</a>:</h4>
<p>Perhaps you can do it with fewer constructors</p>



<a name="249888749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249888749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249888749">(Aug 18 2021 at 18:03)</a>:</h4>
<p>I don't think you need the bools at all?</p>



<a name="249888826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249888826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249888826">(Aug 18 2021 at 18:04)</a>:</h4>
<p>I think a computable version that just assumes the set is infinite would be nice?</p>



<a name="249888829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249888829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249888829">(Aug 18 2021 at 18:04)</a>:</h4>
<p>No, but I figured they'd make things easier later</p>



<a name="249889011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249889011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249889011">(Aug 18 2021 at 18:05)</a>:</h4>
<p>The alternative would be to use <code>satisfied_by p i n ∧ p i</code> instead of <code>satisfied_by p i n tt</code></p>



<a name="249889112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249889112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249889112">(Aug 18 2021 at 18:05)</a>:</h4>
<p>if you're taking the infi can't we just use the smallest <code>i</code> with <code>satisfied_by p i n</code>?</p>



<a name="249889309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249889309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249889309">(Aug 18 2021 at 18:07)</a>:</h4>
<p>Sure, i just thought that condition might come up in the computable version</p>



<a name="249889491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249889491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249889491">(Aug 18 2021 at 18:08)</a>:</h4>
<p>ahh I think I get the motivation</p>



<a name="249889656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249889656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249889656">(Aug 18 2021 at 18:09)</a>:</h4>
<p>I think this would be another option:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.conditionally_complete_lattice</span>
<span class="kn">import</span> <span class="n">order.preorder_hom</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">nonempty</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="o">((</span><span class="bp">&lt;</span><span class="o">)</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n.succ</span> <span class="bp">→</span> <span class="n">fin</span> <span class="n">n.succ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="bp">→</span><span class="n">r</span> <span class="o">((</span><span class="bp">&lt;</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="bp">//</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">p</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)}</span>
    <span class="k">then</span> <span class="n">h.some</span> <span class="o">(</span><span class="n">fin.last</span> <span class="n">n</span><span class="o">)</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div>



<a name="249891312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249891312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249891312">(Aug 18 2021 at 18:22)</a>:</h4>
<p>Or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- import might need to be changed to `data.nat.lattice` in a more recent version of mathlib</span>
<span class="kn">import</span> <span class="n">order.conditionally_complete_lattice</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span>
<span class="bp">|</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">Inf</span> <span class="o">{</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">,</span> <span class="n">count</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">i</span> <span class="o">}</span>
</code></pre></div>



<a name="249891596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249891596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249891596">(Aug 18 2021 at 18:24)</a>:</h4>
<p>These are really nice. I especially like that the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> is then simply <code>count prime n</code>.</p>



<a name="249892100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249892100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249892100">(Aug 18 2021 at 18:28)</a>:</h4>
<p>A more restrictive but computable version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.parity</span>
<span class="kn">import</span> <span class="n">data.nat.primes</span>

<span class="kd">def</span> <span class="n">nth_with_aux</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">p</span><span class="o">]</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">i</span> <span class="n">j</span> <span class="o">:=</span> <span class="n">j</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">i</span> <span class="n">j</span> <span class="o">:=</span> <span class="k">let</span> <span class="n">j</span> <span class="o">:=</span> <span class="n">nat.find</span> <span class="o">(</span><span class="n">h</span> <span class="n">i</span><span class="o">)</span>
               <span class="k">in</span> <span class="n">nth_with_aux</span> <span class="n">n</span> <span class="n">j.succ</span> <span class="n">j</span>

<span class="c1">-- maybe `find_nth` would be a more appropriate name</span>
<span class="kd">def</span> <span class="n">nth_with</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">p</span><span class="o">]</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">nth_with_aux</span> <span class="n">h</span> <span class="n">n.succ</span> <span class="mi">0</span> <span class="mi">0</span>

<span class="kd">lemma</span> <span class="n">inf_evens</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">∧</span> <span class="n">even</span> <span class="n">j</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">h</span> <span class="o">:</span> <span class="n">even</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl.ge</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩,</span>
  <span class="n">use</span> <span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">nat.even_succ.mpr</span> <span class="n">h</span><span class="o">],</span>
<span class="kd">end</span>

<span class="k">#eval</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">nth_with</span> <span class="n">inf_evens</span><span class="o">)</span>
<span class="c1">-- [0, 2, 4, 6]</span>

<span class="k">#eval</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">]</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">nth_with</span> <span class="n">nat.exists_infinite_primes</span><span class="o">)</span>
<span class="c1">-- [2, 3, 5, 7, 11]</span>
</code></pre></div>



<a name="249892146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249892146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249892146">(Aug 18 2021 at 18:29)</a>:</h4>
<p>Taking a step back, why are we calling this <code>count</code>? This is the "nth element satisfying <code>p</code>". We should have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.conditionally_complete_lattice</span>
<span class="kn">import</span> <span class="n">set_theory.fincard</span>

<span class="kn">namespace</span> <span class="n">nat</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="n">nat.card</span> <span class="o">{</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span> <span class="o">}</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">nth</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span>
<span class="bp">|</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">Inf</span> <span class="o">{</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">,</span> <span class="n">nth</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">i</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">nat</span>
</code></pre></div>



<a name="249892464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249892464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249892464">(Aug 18 2021 at 18:31)</a>:</h4>
<p>With my example, if you import <code>data.nat.primes</code> too, you can do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">]</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">nth_with</span> <span class="n">nat.exists_infinite_primes</span><span class="o">)</span>
<span class="c1">-- [2, 3, 5, 7, 11]</span>
</code></pre></div>



<a name="249893202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249893202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249893202">(Aug 18 2021 at 18:36)</a>:</h4>
<p>i'm currently trying to make a decidable instance for Eric's definition, and just want to <code>resetI</code> all the time, e.g.:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">{</span><span class="n">i</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">p</span> <span class="n">n</span><span class="o">)]</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">satisfied_by</span> <span class="n">p</span> <span class="n">i</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">n.rec_on</span> <span class="o">(</span><span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span>
          <span class="k">then</span> <span class="n">decidable.is_false</span> <span class="o">(</span><span class="n">not_satisfied_of_zero</span> <span class="n">h</span> <span class="n">i</span><span class="o">)</span>
          <span class="k">else</span>
          <span class="bp">@</span><span class="n">nat.rec_on</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">satisfied_by</span> <span class="n">p</span> <span class="n">i</span> <span class="mi">0</span><span class="o">))</span> <span class="n">i</span> <span class="o">(</span><span class="n">decidable.is_true</span> <span class="o">(</span><span class="n">satisfied_by.zero_neg</span> <span class="n">h</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">hi</span><span class="o">,</span> <span class="bp">@</span><span class="n">decidable.by_cases</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hi</span> <span class="gr">sorry</span> <span class="gr">sorry</span><span class="o">)</span>
          <span class="o">)</span>
</code></pre></div>
<p>this makes me feel that I'm doing it wrong; what's the "correct" way to make decidable instances?</p>



<a name="249894647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249894647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249894647">(Aug 18 2021 at 18:47)</a>:</h4>
<p>eq compiler</p>



<a name="249895651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249895651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249895651">(Aug 18 2021 at 18:54)</a>:</h4>
<p>As another idea, could we first define the inverse of nth, (which is just number of elements satisfying p which are less than the given number), and then define nth as its inverse?</p>



<a name="249895767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249895767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249895767">(Aug 18 2021 at 18:55)</a>:</h4>
<p>Defining functions through inversion is usually a bad idea.</p>



<a name="249897451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249897451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249897451">(Aug 18 2021 at 19:05)</a>:</h4>
<p>Okay, thanks. As for the rubbish values: if there are only n numbers satisfying p, we could set nth p k = (nth p (k-1)) + 1 for <code>n \le k</code>, because this way we have the main theorems about nth (that it is injective, strictly monotone, and that <code>k \le nth p k</code>) without having to supply that there are infinitely many numbers satisfying p. Because otherwise it doesn't really matter what the rubbish values are, does it?</p>



<a name="249897608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249897608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249897608">(Aug 18 2021 at 19:06)</a>:</h4>
<p>(btw, how do I render <code>\le</code> correctly in the chat?)</p>



<a name="249898587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/249898587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#249898587">(Aug 18 2021 at 19:14)</a>:</h4>
<p>(dollar dollar \leq dollar dollar)</p>



<a name="250114397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250114397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250114397">(Aug 20 2021 at 13:04)</a>:</h4>
<p>Can anyone prove</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>with <span class="user-mention" data-user-id="111080">@Floris van Doorn</span>'s definition above? It seems quite tricky!</p>



<a name="250114573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250114573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250114573">(Aug 20 2021 at 13:05)</a>:</h4>
<p>If I can fill that in I have the pleasant fact:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">set.infinite.order_iso_nat</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">s.infinite</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">ℕ</span> <span class="o">:=</span>
</code></pre></div>



<a name="250114917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250114917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250114917">(Aug 20 2021 at 13:08)</a>:</h4>
<p>Why isn't <code>count</code> just something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">p</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="n">list.length</span> <span class="o">((</span><span class="n">list.range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">filter</span> <span class="n">p</span><span class="o">)</span>
</code></pre></div>



<a name="250114955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250114955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250114955">(Aug 20 2021 at 13:08)</a>:</h4>
<p>I put my work so far on an API for <code>count</code> and <code>nth</code> in <a href="https://github.com/leanprover-community/mathlib/tree/count">branch#count</a>, in <code>data.nat.count</code>. Contributions welcome.</p>



<a name="250114988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250114988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250114988">(Aug 20 2021 at 13:08)</a>:</h4>
<p>I'm perfectly happy with that definition as well.</p>



<a name="250115149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250115149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250115149">(Aug 20 2021 at 13:10)</a>:</h4>
<p>But now I'm off to sleep.</p>



<a name="250115186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250115186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250115186">(Aug 20 2021 at 13:10)</a>:</h4>
<p>I'll have a go!</p>



<a name="250115520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250115520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250115520">(Aug 20 2021 at 13:13)</a>:</h4>
<p>Wait, your lemma is wrong, Scott. What if <code>\not p n</code>?</p>



<a name="250116670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250116670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250116670">(Aug 20 2021 at 13:23)</a>:</h4>
<p>There's a hypothesis <code>h : p n</code>?</p>



<a name="250117056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250117056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250117056">(Aug 20 2021 at 13:27)</a>:</h4>
<p>Ah, of course.</p>



<a name="250117160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250117160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250117160">(Aug 20 2021 at 13:28)</a>:</h4>
<p>We should state that <code>nth</code> and <code>count</code> form a Galois connection, then <code>p n</code> tantamounts to <code>n</code> closed.</p>



<a name="250117531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250117531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250117531">(Aug 20 2021 at 13:31)</a>:</h4>
<p>They are not just a Galois connection, they're inverses, right?</p>



<a name="250117948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250117948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250117948">(Aug 20 2021 at 13:35)</a>:</h4>
<p>Yes, but not between <code>ℕ</code> and <code>ℕ</code>.</p>



<a name="250118069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250118069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250118069">(Aug 20 2021 at 13:36)</a>:</h4>
<p>good point</p>



<a name="250156958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250156958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250156958">(Aug 20 2021 at 18:43)</a>:</h4>
<p>Proved <code>nth_count</code> from the Galois connection and another sorry.</p>



<a name="250157146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250157146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250157146">(Aug 20 2021 at 18:44)</a>:</h4>
<p><code>nth_count_gc</code> doesn't seem to work for me <span class="user-mention" data-user-id="387244">@Yaël Dillies</span></p>



<a name="250165306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250165306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250165306">(Aug 20 2021 at 19:57)</a>:</h4>
<p>Yeah, the definition of <code>count</code> is probably off by one</p>



<a name="250173701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250173701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250173701">(Aug 20 2021 at 21:16)</a>:</h4>
<p>i meant your proof, but I think it's pretty invariably flawed in general:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count_gc</span>  <span class="o">:</span> <span class="n">galois_connection</span> <span class="o">(</span><span class="n">nth</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">a</span><span class="o">,</span>
  <span class="c">/-</span><span class="cm"></span>
<span class="cm">  case nat.zero</span>
<span class="cm">    p: ℕ → Prop</span>
<span class="cm">    b: ℕ</span>
<span class="cm">    h: 0 ≤ count p b</span>

<span class="cm">  ⊢ nth p 0 ≤ b</span>
<span class="cm">  -/</span>
<span class="kd">end</span>
</code></pre></div>



<a name="250176639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250176639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250176639">(Aug 20 2021 at 21:47)</a>:</h4>
<p>Okay whoops, it's the other way around</p>



<a name="250176900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250176900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250176900">(Aug 20 2021 at 21:50)</a>:</h4>
<p>sorry I didn't just fix it, don't have much of an intuition for galois connections yet</p>



<a name="250176922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250176922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250176922">(Aug 20 2021 at 21:51)</a>:</h4>
<p>i've never seen them really described as a separate concept outside mathlib</p>



<a name="250176939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250176939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250176939">(Aug 20 2021 at 21:51)</a>:</h4>
<p>i've pushed some proofs though</p>



<a name="250181733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250181733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250181733">(Aug 20 2021 at 22:57)</a>:</h4>
<p>I'm confused by the state of the new commits. It looks like there are a bunch of lemmas proved as consequences of the incorrect statement about a galois connection.</p>



<a name="250181980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250181980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250181980">(Aug 20 2021 at 23:00)</a>:</h4>
<p>After deleting those parts, the <code>computable</code> section has no content, besides a duplicate of <code>count_eq_count_add_one</code> in the <code>noncomputable</code> section.</p>



<a name="250181994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250181994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250181994">(Aug 20 2021 at 23:01)</a>:</h4>
<p>so I think I'll just delete the computable section.</p>



<a name="250182552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250182552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250182552">(Aug 20 2021 at 23:08)</a>:</h4>
<p>I've changed the definition of <code>count</code> to the computable version, and added a lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">count_eq_card</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">count</span> <span class="n">p</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">fintype.card</span> <span class="o">{</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span> <span class="o">}</span> <span class="o">:=</span>
</code></pre></div>
<p>for when the cardinality version is more useful.</p>



<a name="250182819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250182819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250182819">(Aug 20 2021 at 23:13)</a>:</h4>
<p>I've pushed this now. (But <span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> and <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>, please do double check that I didn't remove something useful about galois connections.)</p>



<a name="250198460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250198460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250198460">(Aug 21 2021 at 05:27)</a>:</h4>
<p>What's true is <code>galois_connection (count p) (nth p)</code>. All the results I had in the computable section can be turned around and it should be about as easy as before to get <code>nth_count</code>.</p>



<a name="250200336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250200336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250200336">(Aug 21 2021 at 06:17)</a>:</h4>
<p>Surely you're assuming <code>p</code> is true infinitely often before there is a galois connection.</p>



<a name="250205209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250205209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250205209">(Aug 21 2021 at 08:28)</a>:</h4>
<p>Yep</p>



<a name="250205666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250205666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250205666">(Aug 21 2021 at 08:41)</a>:</h4>
<p>Ah, yes, you have some results unconditional on that.</p>



<a name="250206070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250206070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250206070">(Aug 21 2021 at 08:46)</a>:</h4>
<p>In particular the lemma that I think is the "hard" one:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>doesn't depend on it being true infinitely often.</p>



<a name="250206396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250206396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250206396">(Aug 21 2021 at 08:53)</a>:</h4>
<p>Yeah, I understand your point now</p>



<a name="250207377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207377">(Aug 21 2021 at 09:19)</a>:</h4>
<p>There are some off by one errors that I think I've just fixed.</p>



<a name="250207604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207604">(Aug 21 2021 at 09:25)</a>:</h4>
<p>Argh, <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>, your last commit seems to be badly broken (8f3294ca76cf5c5b8d9d0f91fd4ba6eba031f4b7).</p>



<a name="250207608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207608">(Aug 21 2021 at 09:25)</a>:</h4>
<p>It has duplicated definitions, lots of errors, etc.</p>



<a name="250207687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207687">(Aug 21 2021 at 09:27)</a>:</h4>
<p>For now I've just reverted it, but hopefully you can recover your work from your commit.</p>



<a name="250207768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207768">(Aug 21 2021 at 09:29)</a>:</h4>
<p>Wow, it is a weird feeling to say I want to work on a feature, and see so much work being already done on it : )<br>
Anyway, the instructions say I should ask here for a permission to edit branches of mathlib. My GitHub username is SymmetryUnbroken</p>



<a name="250207938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207938">(Aug 21 2021 at 09:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250207377">said</a>:</p>
<blockquote>
<p>There are some off by one errors that I think I've just fixed.</p>
</blockquote>
<p><code>list.range</code> doesn't include the upper bound -- I think it needed the succ.</p>



<a name="250207986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207986">(Aug 21 2021 at 09:34)</a>:</h4>
<p>Sorry, just pushed again.</p>



<a name="250207999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250207999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250207999">(Aug 21 2021 at 09:34)</a>:</h4>
<p>I had to revert out the broken commit before I could commit my fixes.</p>



<a name="250208004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208004">(Aug 21 2021 at 09:34)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span>, invitation sent.</p>



<a name="250208005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208005">(Aug 21 2021 at 09:35)</a>:</h4>
<p>(I'm hacking together <code>count_set_fintype</code>)</p>



<a name="250208016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208016">(Aug 21 2021 at 09:35)</a>:</h4>
<p>If several people are working on this branch, lets make sure we only commit things without red squiggles. :-)</p>



<a name="250208088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208088">(Aug 21 2021 at 09:36)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span>, isn't <code>count_set_fintype</code> already done?</p>



<a name="250208097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208097">(Aug 21 2021 at 09:37)</a>:</h4>
<p>Sorry, miscopied. <code>count_eq_card</code></p>



<a name="250208106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208106">(Aug 21 2021 at 09:37)</a>:</h4>
<p>Excellent, thanks!</p>



<a name="250208305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208305">(Aug 21 2021 at 09:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250207938">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250207377">said</a>:</p>
<blockquote>
<p>There are some off by one errors that I think I've just fixed.</p>
</blockquote>
<p><code>list.range</code> doesn't include the upper bound -- I think it needed the succ.</p>
</blockquote>
<p>Ah yeah I was correcting that in my broken commit</p>



<a name="250208619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208619">(Aug 21 2021 at 09:49)</a>:</h4>
<p>Why is count defined so that it includes the upper bound?</p>



<a name="250208666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208666">(Aug 21 2021 at 09:50)</a>:</h4>
<p>I think <code>count_nth_of_le_card</code> needs to be split into the finite and the infinite case for <code>p</code>, because <code>nat.card p = 0</code> can mean two very different things</p>



<a name="250208677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208677">(Aug 21 2021 at 09:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208619">said</a>:</p>
<blockquote>
<p>Why is count defined so that it includes the upper bound?</p>
</blockquote>
<p>otherwise we don't have the Galois connection</p>



<a name="250208688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208688">(Aug 21 2021 at 09:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208666">said</a>:</p>
<blockquote>
<p>I think <code>count_nth_of_le_card</code> needs to be split into the finite and the infinite case for <code>p</code>, because <code>nat.card p = 0</code> can mean two very different things</p>
</blockquote>
<p>or use the ordinal inequality used in <code>nth_mem_of_le_card</code></p>



<a name="250208777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208777">(Aug 21 2021 at 09:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208677">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208619">said</a>:</p>
<blockquote>
<p>Why is count defined so that it includes the upper bound?</p>
</blockquote>
<p>otherwise we don't have the Galois connection</p>
</blockquote>
<p>In the sense of F(a) ≤ b if and only if a ≤ G(b)?</p>



<a name="250208901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208901">(Aug 21 2021 at 09:56)</a>:</h4>
<p>Also, if I use "git pull origin count", I get the count file, but it has errors (red underscores), is it fine? Or am I getting the file the wrong way?</p>



<a name="250208923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208923">(Aug 21 2021 at 09:57)</a>:</h4>
<p>it currently has one red underline...</p>



<a name="250208924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208924">(Aug 21 2021 at 09:57)</a>:</h4>
<p>:-(</p>



<a name="250208983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208983">(Aug 21 2021 at 09:58)</a>:</h4>
<p>In <code>count_nth_gc</code>, that <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> just introduced.</p>



<a name="250208985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208985">(Aug 21 2021 at 09:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208777">said</a>:</p>
<blockquote>
<p>In the sense of F(a) ≤ b if and only if a ≤ G(b)?</p>
</blockquote>
<p>Yep,  exactly</p>



<a name="250208986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208986">(Aug 21 2021 at 09:58)</a>:</h4>
<p>Mine has 4 of them, starting with the definition of nth</p>



<a name="250208987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208987">(Aug 21 2021 at 09:58)</a>:</h4>
<p>That's a problem.</p>



<a name="250208989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208989">(Aug 21 2021 at 09:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208983">said</a>:</p>
<blockquote>
<p>In <code>count_nth_gc</code>, that <span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> just introduced.</p>
</blockquote>
<p>Public shaming <span aria-label="stuck out tongue closed eyes" class="emoji emoji-1f61d" role="img" title="stuck out tongue closed eyes">:stuck_out_tongue_closed_eyes:</span></p>



<a name="250208990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208990">(Aug 21 2021 at 09:59)</a>:</h4>
<p>:-)</p>



<a name="250208991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208991">(Aug 21 2021 at 09:59)</a>:</h4>
<p>did you get cache and restart the lean server?</p>



<a name="250208996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250208996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250208996">(Aug 21 2021 at 09:59)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span></p>



<a name="250209000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209000">(Aug 21 2021 at 09:59)</a>:</h4>
<p>there's no cache at the moment, I guess</p>



<a name="250209003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209003">(Aug 21 2021 at 09:59)</a>:</h4>
<p>Probably not</p>



<a name="250209082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209082">(Aug 21 2021 at 10:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250208991">said</a>:</p>
<blockquote>
<p>did you get cache and restart the lean server?</p>
</blockquote>
<p>Is it described somewhere how to do it?</p>



<a name="250209085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209085">(Aug 21 2021 at 10:00)</a>:</h4>
<p>you can just get some from an old one with <code>--rev</code> because we're only touching the one file</p>



<a name="250209107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209107">(Aug 21 2021 at 10:00)</a>:</h4>
<p>If you:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">leanproject</span> <span class="n">up</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">count</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">leanproject</span> <span class="n">build</span>
</code></pre></div>



<a name="250209108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209108">(Aug 21 2021 at 10:00)</a>:</h4>
<p>and then restart VSCode, all should be good</p>



<a name="250209202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209202">(Aug 21 2021 at 10:02)</a>:</h4>
<p><code>leanproject up</code> updates to the last commit, and then tries to download precompiles oleans for that commit. On <code>master</code> those are guaranteed to exist; on other branches they are about an hour or more behind.</p>



<a name="250209217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209217">(Aug 21 2021 at 10:02)</a>:</h4>
<p>So that recipe should pull the oleans for master, then switch to the current <code>count</code> branch, and recompiles anything that has changed relative to master (which should be only <code>count.lean</code>)</p>



<a name="250209232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209232">(Aug 21 2021 at 10:03)</a>:</h4>
<p>Oh wait, I think we may need to not include the upper bound in <code>count</code> for the gc to work.</p>



<a name="250209293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209293">(Aug 21 2021 at 10:04)</a>:</h4>
<p>Yup, <code>count 0</code> should always be <code>0</code></p>



<a name="250209306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209306">(Aug 21 2021 at 10:05)</a>:</h4>
<p>Do you mind if we do not include <code>n</code> in the definition of <code>count</code>?</p>



<a name="250209372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209372">(Aug 21 2021 at 10:06)</a>:</h4>
<p>I think that not including the upper bound is the correct way.</p>



<a name="250209375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209375">(Aug 21 2021 at 10:06)</a>:</h4>
<p>No objection from me. All I care about is the last statement in the file, which I need for something else. :-)</p>



<a name="250209379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209379">(Aug 21 2021 at 10:06)</a>:</h4>
<p>Oh please, I look away 5min and here are 11 commits waiting to be pulled <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="250209405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209405">(Aug 21 2021 at 10:07)</a>:</h4>
<p>I merged master, so Vladimir could retrieve oleans.</p>



<a name="250209406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209406">(Aug 21 2021 at 10:07)</a>:</h4>
<p>sorry</p>



<a name="250209446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209446">(Aug 21 2021 at 10:08)</a>:</h4>
<p>The prime-counting function traditionally includes the upper bound -- why is it the correct way not to include it?</p>



<a name="250209451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209451">(Aug 21 2021 at 10:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250209107">said</a>:</p>
<blockquote>
<p>If you:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">leanproject</span> <span class="n">up</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">count</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">leanproject</span> <span class="n">build</span>
</code></pre></div><br>
</p>
</blockquote>
<p>I tried to do it, didn't help. The Inf in the def nth gets the red line.</p>



<a name="250209459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209459">(Aug 21 2021 at 10:08)</a>:</h4>
<p>What is the error message?</p>



<a name="250209462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209462">(Aug 21 2021 at 10:08)</a>:</h4>
<p>Did you get any errors from <code>leanproject up</code>?</p>



<a name="250209463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209463">(Aug 21 2021 at 10:08)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="n">p</span><span class="o">,</span>
<span class="n">nth</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span><span class="o">,</span>
<span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span>
<span class="bp">⊢</span> <span class="n">has_Inf</span> <span class="n">ℕ</span>
</code></pre></div>



<a name="250209485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209485">(Aug 21 2021 at 10:09)</a>:</h4>
<p>Weird. What do you get from <code>lean --version</code>?</p>



<a name="250209524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209524">(Aug 21 2021 at 10:10)</a>:</h4>
<p>Lean (version 3.27.0, commit de35266fe596, Release)</p>



<a name="250209560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209560">(Aug 21 2021 at 10:11)</a>:</h4>
<p>leanproject up gave no error messages, just said it found some local oleans</p>



<a name="250209571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209571">(Aug 21 2021 at 10:11)</a>:</h4>
<p>Did you install elan? It seems you might have installed a fixed version of Lean, which won't work. You need elan, which will look at the repository you are working in and pick the right version automatically.</p>



<a name="250209617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209617">(Aug 21 2021 at 10:12)</a>:</h4>
<p>oh! I now get the same error message...</p>



<a name="250209618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209618">(Aug 21 2021 at 10:12)</a>:</h4>
<p>Sorry. :-)</p>



<a name="250209624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209624">(Aug 21 2021 at 10:12)</a>:</h4>
<p>regardless of whether you get the same error, that's definitely the wrong version of lean ;b</p>



<a name="250209642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209642">(Aug 21 2021 at 10:13)</a>:</h4>
<p>Yes, so you should still sort of out the lean version.</p>



<a name="250209693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209693">(Aug 21 2021 at 10:14)</a>:</h4>
<p>But the <code>has_Inf</code> error I've fixed (by adding an import --- when I updated to master, someone must have removed a transitive import in the meantime, so we weren't importing <code>data.nat.lattice</code> anymore...)</p>



<a name="250209711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209711">(Aug 21 2021 at 10:15)</a>:</h4>
<p>ahh, <a href="https://github.com/leanprover-community/mathlib/issues/8708">#8708</a></p>



<a name="250209803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209803">(Aug 21 2021 at 10:18)</a>:</h4>
<p>Thanks, that error message disappeared!</p>



<a name="250209937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250209937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250209937">(Aug 21 2021 at 10:21)</a>:</h4>
<p>And I have elan 0.11.0 (b25724876 2021-03-09)</p>



<a name="250210008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210008">(Aug 21 2021 at 10:22)</a>:</h4>
<p>wait, did you run <code>lean --version</code> from the <code>mathlib</code> directory?</p>



<a name="250210009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210009">(Aug 21 2021 at 10:22)</a>:</h4>
<p>or somewhere else?</p>



<a name="250210083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210083">(Aug 21 2021 at 10:24)</a>:</h4>
<p>I don't remember, probably from the root. Anyway, I ran elan update, and I now have lean version 3.32.1 (though elan update had errors while self-updating)</p>



<a name="250210122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210122">(Aug 21 2021 at 10:25)</a>:</h4>
<p>because the thing is that <code>lean</code> is a smart executable and can execute different versions depending on where you are</p>



<a name="250210128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210128">(Aug 21 2021 at 10:25)</a>:</h4>
<p>so it really does matter in which directory you run it</p>



<a name="250210210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210210">(Aug 21 2021 at 10:27)</a>:</h4>
<p>Okay, thanks! I think that is now sorted out.</p>



<a name="250210291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210291">(Aug 21 2021 at 10:29)</a>:</h4>
<p>I'm off for the evening, good luck everyone. :-)</p>



<a name="250210458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210458">(Aug 21 2021 at 10:33)</a>:</h4>
<p>(I accidentally just pushed without making sure there were no errors after dealing with a merge conflict...)</p>
<p>(never mind, it's all fine)</p>



<a name="250210532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210532">(Aug 21 2021 at 10:35)</a>:</h4>
<p>Where is this gone?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">count_succ_eq_succ_count</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">count</span> <span class="n">p</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">count</span> <span class="n">p</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
</code></pre></div>



<a name="250210537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210537">(Aug 21 2021 at 10:35)</a>:</h4>
<p>There was a proof and I can't find it anymore.</p>



<a name="250210597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210597">(Aug 21 2021 at 10:36)</a>:</h4>
<p>Ah, found it!</p>



<a name="250210750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210750">(Aug 21 2021 at 10:40)</a>:</h4>
<p>If I want to add a change, do I just git push origin count?</p>



<a name="250210758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210758">(Aug 21 2021 at 10:41)</a>:</h4>
<p>Yes</p>



<a name="250210914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210914">(Aug 21 2021 at 10:45)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> What's going on down here?</p>
<p><a href="/user_uploads/3121/0-yH461ASygZpP33MNMMO0u-/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/0-yH461ASygZpP33MNMMO0u-/image.png" title="image.png"><img src="/user_uploads/3121/0-yH461ASygZpP33MNMMO0u-/image.png"></a></div>



<a name="250210964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250210964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250210964">(Aug 21 2021 at 10:46)</a>:</h4>
<p>Whoops, that's unwanted. Delete the second one.</p>



<a name="250211277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250211277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250211277">(Aug 21 2021 at 10:54)</a>:</h4>
<p>I'm in orange bar hell <span aria-label="slight frown" class="emoji emoji-1f641" role="img" title="slight frown">:slight_frown:</span></p>



<a name="250211293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250211293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250211293">(Aug 21 2021 at 10:55)</a>:</h4>
<p><code>leanproject get-cache --rev=f36c98e877dd86af12606a</code> and a restart server always fixes my orange bar hell :)</p>



<a name="250211435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250211435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250211435">(Aug 21 2021 at 10:59)</a>:</h4>
<p>there seem to be some errors in the current commit -- i'm going through and fixing them and will be pushing in a moment</p>



<a name="250211695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250211695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250211695">(Aug 21 2021 at 11:05)</a>:</h4>
<p>ok, they're fixed</p>



<a name="250213018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213018">(Aug 21 2021 at 11:41)</a>:</h4>
<p>As far as I understand, the line lemma nth_count (n : ℕ) (h : p n) : nth p (count p n - 1) = n should not have "- 1" in it. I have tried to push this tiny change. Did it work?</p>



<a name="250213234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213234">(Aug 21 2021 at 11:47)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> It looks like you just merged the remote branch and pushed your merge commit</p>



<a name="250213288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213288">(Aug 21 2021 at 11:48)</a>:</h4>
<p>(and I just pushed my own merge commits)</p>



<a name="250213307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213307">(Aug 21 2021 at 11:49)</a>:</h4>
<p>What does it mean? Or maybe I could read about it somewhere?</p>



<a name="250213316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213316">(Aug 21 2021 at 11:49)</a>:</h4>
<p>I am just really new to github</p>



<a name="250213317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213317">(Aug 21 2021 at 11:49)</a>:</h4>
<p>It doesn't include the removal of the "- 1"</p>



<a name="250213379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213379">(Aug 21 2021 at 11:50)</a>:</h4>
<p>What are you using for git?</p>



<a name="250213467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213467">(Aug 21 2021 at 11:52)</a>:</h4>
<p>"What" in what sense? I just type "git push origin count" in the terminal.</p>



<a name="250213490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213490">(Aug 21 2021 at 11:53)</a>:</h4>
<p>There are many interfaces -- GitHub has a graphical application you can use, for instance.  I personally use magit in Emacs, though sometimes I do a command in the terminal</p>



<a name="250213628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213628">(Aug 21 2021 at 11:56)</a>:</h4>
<p>Have you become acquainted with "git status" yet? it shows you the files that you have changed locally.  To create a commit, you can use <code>git add ...filenames</code> and then <code>git commit -m "short message"</code>.  At this point, you want to <code>git pull origin count</code> to merge any changes others have made (and then possibly deal with merge conflicts...), and then <code>git push origin count</code>.</p>



<a name="250213864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213864">(Aug 21 2021 at 12:01)</a>:</h4>
<p>but for a colleague who was new to git this summer, I set him up with <a href="https://desktop.github.com/">GitHub Desktop</a>, which seemed to work well.</p>
<p>To learn more than you need to know about git, there's the <a href="https://git-scm.com/book/en/v2">Pro Git</a> book</p>



<a name="250213923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213923">(Aug 21 2021 at 12:02)</a>:</h4>
<p>Thanks! It seems it worked. And I will look into those resources.</p>



<a name="250213953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250213953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250213953">(Aug 21 2021 at 12:03)</a>:</h4>
<p>We can confirm it worked: <a href="https://github.com/leanprover-community/mathlib/commit/0c0484d9e67eef92e3d1f074adab91efbcb527b6">https://github.com/leanprover-community/mathlib/commit/0c0484d9e67eef92e3d1f074adab91efbcb527b6</a></p>



<a name="250214010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250214010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250214010">(Aug 21 2021 at 12:05)</a>:</h4>
<p>Great, thank you!</p>



<a name="250214045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250214045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250214045">(Aug 21 2021 at 12:05)</a>:</h4>
<p>(I've pushed one more change to remove the error in the last definition)</p>



<a name="250214109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250214109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250214109">(Aug 21 2021 at 12:07)</a>:</h4>
<p>If you look at the end of <a href="https://github.com/leanprover-community/mathlib/compare/count">https://github.com/leanprover-community/mathlib/compare/count</a>, you can see two commits that you created.  The  first contains your change, with respect to what you thought was the current version of the repositiory, and the second is a "merge commit" that joins together two histories: your local one and the remote (GitHub) one.  Earlier you had pushed a merge with no changes.</p>



<a name="250214203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250214203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250214203">(Aug 21 2021 at 12:08)</a>:</h4>
<p>Thanks!</p>



<a name="250214289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250214289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250214289">(Aug 21 2021 at 12:10)</a>:</h4>
<p>I don't know if I'd ever seen it on the GitHub website, but other tools can show you how the various histories intertwine -- which commits refer to which commits.</p>
<p>In this one, time goes upwards:</p>
<p><a href="/user_uploads/3121/0mKLyNl6aOgCI0VKybw2BVGa/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/0mKLyNl6aOgCI0VKybw2BVGa/image.png" title="image.png"><img src="/user_uploads/3121/0mKLyNl6aOgCI0VKybw2BVGa/image.png"></a></div>



<a name="250215669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250215669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250215669">(Aug 21 2021 at 12:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250213018">said</a>:</p>
<blockquote>
<p>As far as I understand, the line lemma nth_count (n : ℕ) (h : p n) : nth p (count p n - 1) = n should not have "- 1" in it. I have tried to push this tiny change. Did it work?</p>
</blockquote>
<p>I think the <code>-1</code> is correct: remember that <code>nth</code> is zero-indexed!</p>



<a name="250215930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250215930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250215930">(Aug 21 2021 at 12:48)</a>:</h4>
<p>well, say p is always true, n = 1. Then count p 1-1 = count p 0 = 0, nth p 0 = 0 rather than 1. So -1 breaks things.</p>



<a name="250216018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250216018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250216018">(Aug 21 2021 at 12:51)</a>:</h4>
<p>Oh, we changed to counting in <code>{0,...,n-1}</code>! Sorry, my mistake.</p>



<a name="250218187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250218187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250218187">(Aug 21 2021 at 13:39)</a>:</h4>
<p>GC, GC, GC!</p>



<a name="250223731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250223731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250223731">(Aug 21 2021 at 15:46)</a>:</h4>
<p>I completed the <code>count_succ</code> lemmas to try an induction, if that sparks ideas.</p>



<a name="250233985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250233985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250233985">(Aug 21 2021 at 19:50)</a>:</h4>
<p>Make sure to check what's in a commit before pushing it.  <a href="https://github.com/leanprover-community/mathlib/commit/bac4ea22b72d16169babd1ba36cb0f20e40e75cd">This one</a> introduced duplicate lemmas (and for some reason replaced the <code>count_succ</code> proofs that I had fixed earlier).  <a href="https://github.com/leanprover-community/mathlib/commit/e30823352c6fb0f34d9eee664aa5ce56f4024663">This one</a> deletes my proof of <code>exists_gt_of_infinite</code>, causing Eric to reprove it later.</p>



<a name="250234012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250234012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250234012">(Aug 21 2021 at 19:52)</a>:</h4>
<p>There are bound to be merge issues with so many people editing the same small file simultaneously, which means extra diligence needed <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="250234074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250234074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250234074">(Aug 21 2021 at 19:53)</a>:</h4>
<p>aah the lemma was right there why did I go round loops to prove the same thing LOL</p>



<a name="250234429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250234429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250234429">(Aug 21 2021 at 20:01)</a>:</h4>
<p>But I do check the diff before merging <span aria-label="big frown" class="emoji emoji-2639" role="img" title="big frown">:big_frown:</span> It must be lying a bit.</p>



<a name="250250435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250250435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250250435">(Aug 22 2021 at 02:45)</a>:</h4>
<p>When I'm working on a branch that others are working on actively, sometimes I will do some work without committing, then run <code>git stash</code>, <code>git pull</code>, <code>git stash apply</code>. It's hard to go wrong this way.</p>



<a name="250269528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250269528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250269528">(Aug 22 2021 at 11:31)</a>:</h4>
<p>I just made some good progress on <a href="https://github.com/leanprover-community/mathlib/tree/count">branch#count</a>. In particular, the main statement I want</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">set.infinite.order_iso_nat</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">s.infinite</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≃</span><span class="n">o</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>
<p>still has a bunch of sorries, but they all seem very doable! Again if anyone wants to help fill in a few please do so.</p>



<a name="250269542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250269542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250269542">(Aug 22 2021 at 11:31)</a>:</h4>
<p>The route I found does _not_ go via building the galois connection, so I took the liberty of moving everything off the direct route to <code>order_iso_nat</code> below it.</p>



<a name="250269587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250269587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250269587">(Aug 22 2021 at 11:32)</a>:</h4>
<p>In fact, I think the galois connection is consequence of <code>order_iso_nat</code> and <code>nth_count</code> without too much difficulty.</p>



<a name="250478422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250478422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250478422">(Aug 24 2021 at 12:42)</a>:</h4>
<p>Hello! I did some work towards the galois connection. I would appreciate some feedback, as this is my first attempt to push some code, rather that delete a -1.</p>



<a name="250478854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250478854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250478854">(Aug 24 2021 at 12:45)</a>:</h4>
<p>Also, I feel that nth_count_le would be useful in the galois connection proof, so I moved it upwards</p>



<a name="250480022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250480022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250480022">(Aug 24 2021 at 12:54)</a>:</h4>
<p>Also, could someone explain me why can't the first sorry in count_nth_gc be simply closed by exact hc? The goal and the hc statement look identical to me.</p>



<a name="250481727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250481727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250481727">(Aug 24 2021 at 13:07)</a>:</h4>
<p>You can try <code>convert hc</code> and see what it leaves as goals</p>



<a name="250482099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250482099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250482099">(Aug 24 2021 at 13:10)</a>:</h4>
<p>Thanks. It leaves nothing at all!</p>



<a name="250482227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250482227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250482227">(Aug 24 2021 at 13:11)</a>:</h4>
<p>I feel bewildered about that.</p>



<a name="250482586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250482586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250482586">(Aug 24 2021 at 13:13)</a>:</h4>
<p>I have pushed convert hc and closed this sorry.</p>



<a name="250483645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250483645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250483645">(Aug 24 2021 at 13:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/250482099">said</a>:</p>
<blockquote>
<p>Thanks. It leaves nothing at all!</p>
</blockquote>
<p>That means the difference is too big for the unifier to figure out, but just small enough for <code>convert</code> (really <code>congr</code>) to figure out, so it's probably some term in a <code>subsingleton</code> type. From looking at the code, it might be a clash between <code>open_locale classical</code> and <code>variable [decidable_pred p]</code>: <code>classical.decidable p</code> is not definitially equal to any instance argument, but <code>decidable</code> has a subsingleton instance that <code>congr</code> can use.</p>



<a name="250487631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250487631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250487631">(Aug 24 2021 at 13:51)</a>:</h4>
<p>take care with the merge in the future - I think you merged the wrong way round, so the merge commit made a weird diff</p>



<a name="250488725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250488725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250488725">(Aug 24 2021 at 13:59)</a>:</h4>
<p>also when you split into subgoals, it's in mathlib style to always brace around it - it makes the code a lot more readable</p>



<a name="250489162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250489162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250489162">(Aug 24 2021 at 14:01)</a>:</h4>
<p>but otherwise this is very good, thanks!</p>



<a name="250489887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250489887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250489887">(Aug 24 2021 at 14:06)</a>:</h4>
<p>Thanks. Where can I see that the diff is weird?</p>



<a name="250489962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250489962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250489962">(Aug 24 2021 at 14:07)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>  whilst looking for some other stuff, I found <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.subtype.order_iso_of_nat">docs#nat.subtype.order_iso_of_nat</a>; is this good enough for what you needed it? (not to discourage you from working on this branch too ;b)</p>



<a name="250490078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250490078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250490078">(Aug 24 2021 at 14:08)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/commit/baf6d178760376981c38c2bfb286562f105d560e">https://github.com/leanprover-community/mathlib/commit/baf6d178760376981c38c2bfb286562f105d560e</a> <span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span></p>



<a name="250492713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250492713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250492713">(Aug 24 2021 at 14:27)</a>:</h4>
<p>Thanks, will be more careful.</p>



<a name="250561052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250561052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250561052">(Aug 24 2021 at 23:00)</a>:</h4>
<p><span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> that's perfect! I should try library_search more often. :-)</p>



<a name="250561142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250561142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250561142">(Aug 24 2021 at 23:01)</a>:</h4>
<p>I suspect we can relate that existing order iso to count and nth, and this will be helpful for building the galois connection.</p>



<a name="250597837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250597837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250597837">(Aug 25 2021 at 09:35)</a>:</h4>
<p>Finished the proof of the Galois connection (modulo the lemmas it uses)</p>



<a name="250598128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598128">(Aug 25 2021 at 09:38)</a>:</h4>
<p>By the way, is it possible and/or useful to create notation p[m] =nth p m? It is potentially easier to read (e.g nat.prime[m] makes a lot of sense for me).</p>



<a name="250598527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598527">(Aug 25 2021 at 09:43)</a>:</h4>
<p>It's possible, but I'm always inclined to be very cautious introducing new notation.</p>



<a name="250598567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598567">(Aug 25 2021 at 09:43)</a>:</h4>
<p>And certainly anything involving square brackets is dangerously prone to clashing with other notations.</p>



<a name="250598666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598666">(Aug 25 2021 at 09:44)</a>:</h4>
<p>I think we should definitely use a lot more use of localised notation, though; I think it's a great shame the amount of long function names we end up using often</p>



<a name="250598699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598699">(Aug 25 2021 at 09:45)</a>:</h4>
<p>Especially with the <code>open scoped</code> stuff in Lean4</p>



<a name="250598818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250598818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250598818">(Aug 25 2021 at 09:46)</a>:</h4>
<p>Okay. Also, should one place a space after a \&lt;- ? The styleguide doesn't say anything about it, but there are such spaces in the examples there.</p>



<a name="250599070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250599070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250599070">(Aug 25 2021 at 09:49)</a>:</h4>
<p>The style guide is silent on that, and both seem acceptable.</p>



<a name="250599146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250599146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250599146">(Aug 25 2021 at 09:50)</a>:</h4>
<p>same as the style guide on ending commas, which I'm glad we won't have to deal with in Lean4 because there's huge variances on what's what</p>



<a name="250599154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250599154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250599154">(Aug 25 2021 at 09:50)</a>:</h4>
<p>I searched for all lines containing <code>simp</code> or <code>rw</code> and counted how many <code>←</code>s there were with and without a space: about 3100 without a space and 7400 with a space.</p>



<a name="250599872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250599872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250599872">(Aug 25 2021 at 09:59)</a>:</h4>
<p>Thanks.</p>



<a name="250912850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250912850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250912850">(Aug 27 2021 at 10:42)</a>:</h4>
<p>I did some work on nth_succ_of_zero, and I hope it is in the right direction. The goal there was of type Inf ... = Inf ... + 1, and it looked like if I manage to put this + 1 inside the Inf, the sets will become equal. So I wrote a lemma (yet without proof) that Inf {m : ℕ | p m} + n = max (Inf {m : ℕ | p (m - n)}) n, which I could not find in the file with Infs, applied it, and began to iron out the edge cases where the right Inf is zero.</p>



<a name="250921562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250921562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250921562">(Aug 27 2021 at 12:06)</a>:</h4>
<p>are you sure <code>Inf_plus</code> is the right way to do this? On your second <code>by_cases</code>, we'd need <code>p 1</code>, which I don't think we either have nor could figure out (remember, ∀ x, 0 - x = 0)</p>



<a name="250922609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250922609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250922609">(Aug 27 2021 at 12:16)</a>:</h4>
<p>We have p 1, it is called hp</p>



<a name="250922763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250922763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250922763">(Aug 27 2021 at 12:18)</a>:</h4>
<p>It seems to me this approach would work, but I am not sure this is the right way.</p>



<a name="250922986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250922986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250922986">(Aug 27 2021 at 12:20)</a>:</h4>
<p>Also, it can be the case that the better form of Inf_plus is lemma Inf_plus {n: ℕ} {p: set ℕ} (h: 0 &lt; Inf {m : ℕ | p m}) : Inf {m : ℕ | p m} + n = Inf {m : ℕ | p (m - n)}</p>



<a name="250922997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250922997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250922997">(Aug 27 2021 at 12:21)</a>:</h4>
<p>(Because it is stronger)</p>



<a name="250925520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250925520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250925520">(Aug 27 2021 at 12:45)</a>:</h4>
<p>you get <code>p 1</code> from <code>h0 </code> which needs <code>p 1</code> in and of itself</p>



<a name="250925537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250925537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250925537">(Aug 27 2021 at 12:45)</a>:</h4>
<p>like to actually be proved</p>



<a name="250925817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250925817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250925817">(Aug 27 2021 at 12:47)</a>:</h4>
<p>h0 is getting Inf = 0 from (not 0 &lt; Inf), this should be closed trivially.</p>



<a name="250925938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250925938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250925938">(Aug 27 2021 at 12:48)</a>:</h4>
<p>I can commit it in a few minutes</p>



<a name="250927057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/250927057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#250927057">(Aug 27 2021 at 12:58)</a>:</h4>
<p>Done. Also have changed Inf_plus statement.</p>



<a name="251043535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251043535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251043535">(Aug 28 2021 at 09:35)</a>:</h4>
<p>I have just proved Inf_plus, but I see something was done on it 7 minutes ago.</p>



<a name="251043601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251043601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251043601">(Aug 28 2021 at 09:36)</a>:</h4>
<p>So I guess if I push my proof now, this would cause a merge problem, wouldn't it?</p>



<a name="251043769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251043769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251043769">(Aug 28 2021 at 09:40)</a>:</h4>
<p>You won't be able to push unless you first merge the remote changes.</p>



<a name="251043799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251043799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251043799">(Aug 28 2021 at 09:40)</a>:</h4>
<p>Start with <code>git pull</code> and hope for the best!</p>



<a name="251044023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251044023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251044023">(Aug 28 2021 at 09:44)</a>:</h4>
<p>Okay. I pushed my proof, putting it into lemma Inf_plus', because I felt uncomfortable deleting the existing beginning of a proof.</p>



<a name="251044357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251044357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251044357">(Aug 28 2021 at 09:51)</a>:</h4>
<p>don't worry about it, a full proof is better than my half-baked attempt at one :b</p>



<a name="251061939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251061939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251061939">(Aug 28 2021 at 15:07)</a>:</h4>
<p>I have proved count_nth_of_infinite. I think basically same proof would work for bounded cardinalities, and then we would be able use it all over, as having one-sided inverse is neat.</p>



<a name="251062212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251062212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251062212">(Aug 28 2021 at 15:11)</a>:</h4>
<p>I would be thankful if someone filled up count_eq_card_finset, which is basically expressing count in terms of finset.card - it should be trivial, but I have not learned to work with cardinalities different from finset yet.</p>



<a name="251062394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251062394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251062394">(Aug 28 2021 at 15:14)</a>:</h4>
<p>I'll take a look</p>



<a name="251062628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251062628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251062628">(Aug 28 2021 at 15:19)</a>:</h4>
<p>You were right about triviality, the proof ended up being <code>rfl</code> <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="251062655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251062655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251062655">(Aug 28 2021 at 15:20)</a>:</h4>
<p>I had a longer proof that ended with the <code>refl</code> tactic, and I kept deleting lines until nothing was left.</p>



<a name="251063582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251063582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251063582">(Aug 28 2021 at 15:36)</a>:</h4>
<p>Thanks! Trivial indeed : )</p>



<a name="251064351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251064351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251064351">(Aug 28 2021 at 15:49)</a>:</h4>
<p>i'm surprised it's <code>rfl</code>, I thought finset was some level of list quotients and proofs with quotients couldn't be <code>rfl</code></p>



<a name="251064354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251064354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251064354">(Aug 28 2021 at 15:49)</a>:</h4>
<p>that's nice</p>



<a name="251066273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251066273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251066273">(Aug 28 2021 at 16:23)</a>:</h4>
<p><span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> Here's what's going on: a <code>finset</code> is a <code>nodup</code> <code>multiset</code>, and a <code>multiset</code> is the quotient of  <code>list</code> by <code>list.perm</code>. The definition of <code>finset.card</code> is <code>multiset.card</code> of its <code>multiset</code>, and the definition of <code>multiset.card</code> is the <code>list.length</code> of a representative <code>list</code> (using <code>quot.lift</code> for well-definedness).  Similarly, both <code>finset.range</code> and <code>finset.filter</code> are defined in terms of <code>list.range</code> and <code>list.filter</code>, in that the latter functions are by definition the <code>list</code> representatives for the <code>finset</code>s.</p>
<p>A key fact is that Lean has the following reduction rule (where reduction is what underlies what it means for things to be defeq):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">quot.lift</span> <span class="n">f</span> <span class="n">p</span> <span class="o">(</span><span class="n">quot.mk</span> <span class="n">a</span><span class="o">)</span> <span class="bp">~~&gt;</span> <span class="n">f</span> <span class="n">a</span>
</code></pre></div>
<p>So, for example,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">finset.range</span> <span class="mi">37</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">~~&gt;</span> <span class="n">quot.lift</span> <span class="n">list.length</span> <span class="n">_</span> <span class="o">(</span><span class="n">quot.mk</span> <span class="o">(</span><span class="n">list.range</span> <span class="mi">37</span><span class="o">))</span>
                       <span class="bp">~~&gt;</span> <span class="n">list.length</span> <span class="o">(</span><span class="n">list.range</span> <span class="mi">37</span><span class="o">)</span>
</code></pre></div>
<p>We can see this in action for <code>count_eq_card_finset</code> using <code>#reduce</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#reduce</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">finset.card</span> <span class="o">(</span><span class="n">finset.filter</span> <span class="n">p</span> <span class="o">(</span><span class="n">finset.range</span> <span class="n">n</span><span class="o">))</span>
<span class="c1">-- λ (n : ℕ), (filter p (range_core n nil)).length</span>
</code></pre></div>



<a name="251066581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251066581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251066581">(Aug 28 2021 at 16:29)</a>:</h4>
<p>Another example of something involving quotients that's intentionally defeq to something more basic is the edge set for simple graphs. It's convenient how <code>⟦(v, w)⟧ ∈ G.edge_set</code> is by definition <code>G.adj v w</code>.</p>



<a name="251119749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251119749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251119749">(Aug 29 2021 at 09:25)</a>:</h4>
<p>The main problem in the case of finite p was that we didn't have prove that the set over which we take Inf is nonempty (unlike in the infinite case, where it is easily infinite). Now I have proved lemma nth_mem_of_le_card_aux, which computes the cardilities of those sets, allowing to prove them to be nonempty.</p>



<a name="251122283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251122283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251122283">(Aug 29 2021 at 10:12)</a>:</h4>
<p>(Renamed the lemma, and proved a slightly stronger lemma nth_set_card)</p>



<a name="251123466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251123466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251123466">(Aug 29 2021 at 10:34)</a>:</h4>
<p>And now I have proved p(nth p n) in the finite case.</p>



<a name="251449740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251449740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251449740">(Aug 31 2021 at 20:03)</a>:</h4>
<p>I have proved nth_count. Again, I haven't deleted the existing unfinished proof, and added my proof as nth_count' instead. Please tell me if it is fine to remove the unfinished proof.</p>



<a name="251456940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251456940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251456940">(Aug 31 2021 at 20:49)</a>:</h4>
<p>Usually replacing an unfinished proof by a complete proof is fine. And if the old proof exists in the git history, then people can dig it up there if they want/need it.</p>



<a name="251457326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251457326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251457326">(Aug 31 2021 at 20:51)</a>:</h4>
<p>I'm going through things right now, by the way <span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span>.  I'll delete the old proof.</p>



<a name="251478736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251478736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251478736">(Aug 31 2021 at 23:52)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> I've pushed my changes and am done for now.  I tried simplifying proofs, and hopefully I succeed in not obfuscating them.</p>



<a name="251498540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251498540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251498540">(Sep 01 2021 at 04:27)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> Thanks! I do hope I will learn to write those shorter proofs at some point.</p>



<a name="251513249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251513249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251513249">(Sep 01 2021 at 07:11)</a>:</h4>
<p>I have proved count_nth_le. I think it means that the galois connection theorem is now proved completely (without sorries all the way down). I think I will try look at the latest edits Kyle Miller has made to the file and try to edit my last proof accordingly.</p>



<a name="251580151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/251580151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#251580151">(Sep 01 2021 at 15:36)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> A way you can check is to use the <code>#print axioms count_nth_gc</code> command.  If it's sorry-free, it won't print <code>[sorry]</code>, and I can confirm it doesn't.</p>



<a name="252205385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252205385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252205385">(Sep 06 2021 at 17:44)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> I have finally looked into your edits. I understood that I should use squeeze_simp rather than simp, and I have changed it in my latest commit. Could you maybe give some other general advise on how to write proofs so that they do not require cleaning up, please?</p>



<a name="252208466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252208466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252208466">(Sep 06 2021 at 18:18)</a>:</h4>
<p>It's probably better not to worry too much about it while doing the hard part of actually finishing the proofs in the first place.  Later on, you can go in with your sandpaper to give the proof a nicer finish.</p>
<p>I think mainly what helped were the <code>refine</code>, <code>convert</code> and <code>convert_to</code> tactics, and also noticing when small arguments could be passed directly to a lemma in an <code>apply</code>.  What could also help is studying what is going on overall in a theorem, to try to make things that would be defined with a <code>have</code> be automatically generated as a subgoal.</p>
<p>For example, in <code>nth_count_eq_Inf</code>, I notice</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>        <span class="n">apply</span> <span class="n">count_strict_mono</span><span class="o">,</span>
        <span class="o">{</span> <span class="n">exact</span> <span class="n">hp</span><span class="o">,</span> <span class="o">},</span>
        <span class="o">{</span> <span class="n">exact</span> <span class="n">ha</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>
<p>Looking at the type of <code>count_strict_mono</code>, we see it takes the predicate <code>p</code> along with two proofs.  So, we can simplify this to</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>        <span class="n">exact</span> <span class="n">count_strict_mono</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">ha</span><span class="o">,</span>
</code></pre></div>
<p>(I used an underscore since it can figure out <code>p</code>, but you could also write <code>p</code> in its place.  Doesn't matter either way.)</p>



<a name="252208840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252208840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252208840">(Sep 06 2021 at 18:22)</a>:</h4>
<p>Or, consider the large-scale structure of the proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count_eq_Inf</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Inf</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">nth</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span><span class="o">:</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">count</span> <span class="n">p</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">nth</span> <span class="n">p</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">i</span><span class="o">}</span> <span class="bp">=</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">},</span>
  <span class="o">{</span> <span class="bp">...</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>After <code>rw nth</code>, the left-hand side becomes <code>Inf</code>, and <code>h</code> is for rewriting its set.  Instead, you can do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count_eq_Inf</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Inf</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">nth</span><span class="o">,</span>
  <span class="n">congr'</span> <span class="mi">1</span><span class="o">,</span>
  <span class="bp">...</span>
<span class="kd">end</span>
</code></pre></div>
<p>since <code>congr' 1</code> will create the exact hypothesis you've written for <code>have h</code>.  I find it easier to follow in this form since there isn't this lone <code>rw h</code> at the very end.</p>



<a name="252209374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252209374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252209374">(Sep 06 2021 at 18:28)</a>:</h4>
<p>Or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count_eq_Inf</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Inf</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">nth</span><span class="o">,</span>
  <span class="k">suffices</span> <span class="n">h</span> <span class="o">:</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">count</span> <span class="n">p</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">nth</span> <span class="n">p</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">i</span><span class="o">}</span> <span class="bp">=</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">h</span> <span class="o">},</span>
  <span class="bp">...</span>
<span class="kd">end</span>
</code></pre></div>



<a name="252209774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252209774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252209774">(Sep 06 2021 at 18:32)</a>:</h4>
<p>Another pattern: rather than</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="n">apply</span> <span class="n">lt_of_lt_of_le</span><span class="o">,</span>
    <span class="n">swap</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">hn</span><span class="o">,},</span>
</code></pre></div>
<p>you can use <code>refine</code> like so:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="n">refine</span> <span class="n">lt_of_lt_of_le</span> <span class="n">_</span> <span class="n">hn</span><span class="o">,</span>
</code></pre></div>
<p>I think this makes it clearer that the intent is, that the rest of the proof is to fill in the less-than part of this transitivity proof.</p>



<a name="252210843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252210843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252210843">(Sep 06 2021 at 18:44)</a>:</h4>
<p>After some transformations like these, it ended up in this form:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_count_eq_Inf</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Inf</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">nth</span><span class="o">,</span>
  <span class="n">congr'</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">ext</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.mem_set_of_eq</span><span class="o">,</span> <span class="n">and.congr_right_iff</span><span class="o">],</span>
  <span class="n">intro</span> <span class="n">hp</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">by_contra</span> <span class="n">ha</span><span class="o">,</span>
    <span class="n">push_neg</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hn</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="o">(</span><span class="n">count</span> <span class="n">p</span> <span class="n">a</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">h</span> <span class="n">_</span> <span class="o">(</span><span class="n">count_strict_mono</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">ha</span><span class="o">),</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">nth_count</span> <span class="n">p</span> <span class="n">hp</span><span class="o">,</span> <span class="n">lt_self_iff_false</span><span class="o">]</span> <span class="n">at</span> <span class="n">hn</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">hn</span> <span class="n">k</span> <span class="n">hk</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">lt_of_lt_of_le</span> <span class="n">_</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">apply</span> <span class="o">(</span><span class="n">count_monotone</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">reflect_lt</span><span class="o">,</span>
    <span class="n">convert</span> <span class="n">hk</span><span class="o">,</span>
    <span class="n">obtain</span> <span class="o">(</span><span class="n">hfi</span><span class="bp">|</span><span class="n">hfi</span><span class="o">)</span> <span class="o">:=</span> <span class="n">em</span> <span class="o">(</span><span class="n">set.finite</span> <span class="n">p</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">count_nth_of_lt_card_finite</span> <span class="n">_</span> <span class="n">hfi</span><span class="o">,</span>
      <span class="n">apply</span> <span class="n">lt_trans</span> <span class="n">hk</span><span class="o">,</span>
      <span class="n">apply</span> <span class="n">lt_of_le_of_lt</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="n">count_monotone</span> <span class="n">_</span> <span class="n">hn</span><span class="o">,</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="n">count_lt_card</span> <span class="n">p</span> <span class="n">hfi</span> <span class="n">hp</span><span class="o">,</span> <span class="o">},</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">count_nth_of_infinite</span> <span class="n">p</span> <span class="n">hfi</span><span class="o">,</span> <span class="o">},</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
</div></div>
<p>I find it to be relatively easy to follow this kind of proof with the infoview, but these things are a matter of taste.</p>
<p>(I didn't commit this change)</p>



<a name="252262713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252262713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252262713">(Sep 07 2021 at 07:29)</a>:</h4>
<p>Thank you very much for your advise! So, do you say that I should first finish the file, so that no sorries are left, and only then begin refactoring?</p>



<a name="252296306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252296306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252296306">(Sep 07 2021 at 12:24)</a>:</h4>
<p>And I commited the little changes, in line with your recommendations.</p>



<a name="252413502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252413502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252413502">(Sep 08 2021 at 06:38)</a>:</h4>
<p>Do we still have a need for nth_succ_of_zero? I think it is easy to prove now, but it seems like an auxiliary lemma which I have bypassed by using other proofs. Do you consider it still relevant?</p>



<a name="252413964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252413964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252413964">(Sep 08 2021 at 06:44)</a>:</h4>
<p>I think it can be dropped.</p>



<a name="252413983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252413983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252413983">(Sep 08 2021 at 06:45)</a>:</h4>
<p>Something that will be essential for PRing this material is connecting it with what is already in <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.subtype.order_iso_of_nat">docs#nat.subtype.order_iso_of_nat</a>.</p>



<a name="252413991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252413991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252413991">(Sep 08 2021 at 06:45)</a>:</h4>
<p>(and higher up in that file)</p>



<a name="252414107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252414107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252414107">(Sep 08 2021 at 06:46)</a>:</h4>
<p>Sorry, wrong link</p>



<a name="252414114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252414114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252414114">(Sep 08 2021 at 06:46)</a>:</h4>
<p>I meant <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.subtype.of_nat">docs#nat.subtype.of_nat</a></p>



<a name="252414145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252414145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252414145">(Sep 08 2021 at 06:47)</a>:</h4>
<p>at the least we need lemmas relating this to <code>nth</code>.</p>



<a name="252414156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252414156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252414156">(Sep 08 2021 at 06:47)</a>:</h4>
<p>possibly we should redefine it in terms of <code>nth</code>.</p>



<a name="252418269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252418269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252418269">(Sep 08 2021 at 07:32)</a>:</h4>
<p>Thanks. I will look into it - I'm still unsure how to work with those types of objects though.</p>



<a name="252418591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252418591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252418591">(Sep 08 2021 at 07:35)</a>:</h4>
<p>Also - can anyone help me with why in the nth_lt_of_lt_count proof the line "apply lt_of_count_lt" (now the only line commented out) does not work, and how to fix it?</p>



<a name="252418702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/252418702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#252418702">(Sep 08 2021 at 07:36)</a>:</h4>
<p>I want to finish the last couple of lemmas in the end of the file first, and then I'll think about nat subtypes.</p>



<a name="253240070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253240070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253240070">(Sep 14 2021 at 12:17)</a>:</h4>
<p>I have finished the proof of nth_lt_of_lt_count. I have removed the lemma nth_le_of_le_count, as it is wrong: even though 2 \le count <a href="http://nat.prime">nat.prime</a> 4, we do not have nth <a href="http://nat.prime">nat.prime</a> 2 \le  4.</p>



<a name="253240523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253240523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253240523">(Sep 14 2021 at 12:21)</a>:</h4>
<p>It sounds like it was the wrong way around. <code>le_nth_of_count_le</code> should be correct instead.</p>



<a name="253240574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253240574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253240574">(Sep 14 2021 at 12:21)</a>:</h4>
<p>and similarly <code>lt_nth_of_count_lt</code> should be wrong.</p>



<a name="253240688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253240688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253240688">(Sep 14 2021 at 12:22)</a>:</h4>
<p>I love Galois connections <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span></p>



<a name="253241537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253241537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253241537">(Sep 14 2021 at 12:29)</a>:</h4>
<p>Yeah, sure, le_nth_of_count_le is now trivial. Done it!</p>



<a name="253241933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253241933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253241933">(Sep 14 2021 at 12:32)</a>:</h4>
<p>If you want to turn iff into one way implications, you can use <code>alias iff_theorem ↔ name_of_the_first_imp name_of_the_second_imp</code>.</p>



<a name="253245916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253245916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253245916">(Sep 14 2021 at 13:01)</a>:</h4>
<p>I could not actually do it, as the Galois connection lemma uses assumptions that p is infinite, but those lemmas do not.</p>



<a name="253246049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253246049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253246049">(Sep 14 2021 at 13:02)</a>:</h4>
<p>Well one of them must use it. You can place an <code>_</code> instead of the lemma you don't want <code>alias</code> to generate.</p>



<a name="253318152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253318152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253318152">(Sep 14 2021 at 20:24)</a>:</h4>
<p>No, those lemmas are equivalent, as they are just contrapositions of each other. And none of them assume infinitude of p.</p>



<a name="253318342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253318342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253318342">(Sep 14 2021 at 20:25)</a>:</h4>
<p>Neither of the <code>←</code> and <code>→</code> implications need <code>p</code> infinite, but <code>↔</code> does? Is it really what you mean?</p>



<a name="253370427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253370427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253370427">(Sep 15 2021 at 06:53)</a>:</h4>
<p>No. I mean that one of -&gt; and &lt;- is not implemented, and we have a -&gt; b and ~b -&gt; ~a instead.</p>



<a name="253375027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253375027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253375027">(Sep 15 2021 at 07:45)</a>:</h4>
<p>I have proved the lemma nth_nonzero_of_ge_nonzero and removed another lemma which seemed like a leftover of a no longer relevant proof by induction. Now the only sorry left is to prove nth_eq_order_iso_of_nat.</p>



<a name="253375396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253375396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253375396">(Sep 15 2021 at 07:49)</a>:</h4>
<p>Ah yes, that's different indeed. Good work by the way!</p>



<a name="253448598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253448598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253448598">(Sep 15 2021 at 16:51)</a>:</h4>
<p>I have finished the proof of nth_eq_order_iso_of_nat!</p>



<a name="253448724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253448724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253448724">(Sep 15 2021 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> you were particularly interested in that.</p>



<a name="253448812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253448812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253448812">(Sep 15 2021 at 16:52)</a>:</h4>
<p>Also, this means that no sorries are currently left in the count file!</p>



<a name="253449778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253449778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253449778">(Sep 15 2021 at 16:58)</a>:</h4>
<p>So I would like to ask everyone's advise on what to do next. I have seen the idea that PRs should be kept fairly small and manageable, so I would be inclined to polish up the existing lemmas, rearrange them and PR the file. But I am new to mathlib development, and so I am not sure how things are done here.</p>



<a name="253450397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253450397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253450397">(Sep 15 2021 at 17:01)</a>:</h4>
<p>I'm willing to go through the file, fix lemma names if needed and such... if you want.</p>



<a name="253450468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253450468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253450468">(Sep 15 2021 at 17:01)</a>:</h4>
<p>I very much love file restructuring <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span></p>



<a name="253450735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253450735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253450735">(Sep 15 2021 at 17:03)</a>:</h4>
<p>Oh, you are definitely welcome!</p>



<a name="253451044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/253451044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#253451044">(Sep 15 2021 at 17:05)</a>:</h4>
<p>I usually prefer writing new code to restructuring the old one : )</p>



<a name="254704726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254704726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254704726">(Sep 24 2021 at 13:37)</a>:</h4>
<p>OK, so I've pushed some changes; mostly golfing (-200 lines or so!) to the file. I think most changes should be done by now! I also fixed (hopefully) all linting issues. I'd appreciate if one of you could check the file (especially the names of stuff, <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>  your skills would be appreciated :]) but I think we should PR this sooner rather than later so that stuff doesn't bitrot</p>



<a name="254827630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254827630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254827630">(Sep 25 2021 at 10:20)</a>:</h4>
<p>Let me have another look!</p>



<a name="254835895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254835895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254835895">(Sep 25 2021 at 12:30)</a>:</h4>
<p>I must say I see absolutely no point in using <code>cardinal</code>. This to me seems like a pretty artificial way to unify the cases where <code>p</code> is true finitely vs infinitely often.</p>



<a name="254836136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254836136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254836136">(Sep 25 2021 at 12:34)</a>:</h4>
<p><code>count_succ'</code> is a too specialized case of <code>count_add {a b : ℕ} : count p (a + b) = count p a + count (λ k, p (a + k)) b</code>. I'm trying to prove that now.</p>



<a name="254839077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254839077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254839077">(Sep 25 2021 at 13:19)</a>:</h4>
<p>Done!</p>



<a name="254839709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254839709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254839709">(Sep 25 2021 at 13:27)</a>:</h4>
<p>how come you localised the instance?</p>



<a name="254840867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254840867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254840867">(Sep 25 2021 at 13:43)</a>:</h4>
<p>Isn't it a pretty peculiar use-case? We're providing a fintype instance for the coercion to Sort of a sep of the set of naturals strictly less than <code>n</code>.</p>



<a name="254842479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254842479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254842479">(Sep 25 2021 at 14:06)</a>:</h4>
<p>I feel like it's not going to hurt anyone to have it around, either</p>



<a name="254844929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254844929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254844929">(Sep 25 2021 at 14:42)</a>:</h4>
<p>Would it make sense to feed in <code>(set_of p).infinite</code> through TC inference?</p>



<a name="254845401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254845401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254845401">(Sep 25 2021 at 14:49)</a>:</h4>
<p>hmm, I feel like there's some good reason  why <code>infinite</code> isn't a class already though</p>



<a name="254845873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254845873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254845873">(Sep 25 2021 at 14:56)</a>:</h4>
<p>Yeah sure. I meant to use <code>fact</code></p>



<a name="254846106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254846106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254846106">(Sep 25 2021 at 15:00)</a>:</h4>
<p>no strong feelings either way there</p>



<a name="254849655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254849655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254849655">(Sep 25 2021 at 15:52)</a>:</h4>
<p>I would avoid writing things using <code>fact</code> unless it really makes life fundamentally easier at the point of use.</p>



<a name="254850089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850089">(Sep 25 2021 at 15:59)</a>:</h4>
<p>I'm pretty sure <code>count_set.fintype</code> should be an instance, but generalized a bit.  This could go in <code>data.set.finite</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">set.finite.fintype_pred_sep</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">x</span><span class="o">}]</span>
  <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">q</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">fintype</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">q</span> <span class="n">x</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">apply</span> <span class="n">set.fintype_sep</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">x</span><span class="o">}</span>

<span class="c1">-- Now it's automatic:</span>
<span class="kd">def</span> <span class="n">count_set.fintype</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">p</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="n">infer_instance</span>
</code></pre></div>



<a name="254850431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850431">(Sep 25 2021 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> I see you changed <code>(set_of p).finite</code> back to <code>set.finite p</code>.  The issue is that <code>p</code> is not a set, so <code>set.finite p</code> is "wrong".</p>



<a name="254850526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850526">(Sep 25 2021 at 16:04)</a>:</h4>
<p>I am pretty sure it has already been used like that in mathlib... There's not even any coercion as <code>set</code> is a type synonym.</p>



<a name="254850556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850556">(Sep 25 2021 at 16:05)</a>:</h4>
<p>yeah but it's breaking the abstraction barrier</p>



<a name="254850576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850576">(Sep 25 2021 at 16:05)</a>:</h4>
<p>Maybe someone decides to make <code>set</code> irreducible one day and then your code breaks.</p>



<a name="254850642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850642">(Sep 25 2021 at 16:06)</a>:</h4>
<p>It's breaking the abstraction barrier.  I carefully went through everything in this a while back to make sure whenever a predicate is used as a set, it's cast using <code>set_of</code>.</p>



<a name="254850706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254850706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254850706">(Sep 25 2021 at 16:07)</a>:</h4>
<p>Oh well, sorry about that.</p>



<a name="254851171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254851171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254851171">(Sep 25 2021 at 16:15)</a>:</h4>
<p>What's wrong with cardinals?  I'm just going to record the deleted lemmas here in case <span class="user-mention" data-user-id="110087">@Scott Morrison</span> has any comment, since he added originally them I believe.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">count_nth_of_lt_card</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">cardinal</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">cardinal.mk</span> <span class="o">(</span><span class="n">set_of</span> <span class="n">p</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">count</span> <span class="n">p</span> <span class="o">(</span><span class="n">nth</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span>

<span class="kd">lemma</span> <span class="n">nth_mem_of_lt_card</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">cardinal</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">cardinal.mk</span> <span class="o">(</span><span class="n">set_of</span> <span class="n">p</span><span class="o">))</span> <span class="o">:</span> <span class="n">p</span> <span class="o">(</span><span class="n">nth</span> <span class="n">p</span> <span class="n">n</span><span class="o">)</span>
</code></pre></div>
<p>Also, did this one go somewhere, or is it a trivial consequence of other lemmas so was deleted?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nth_nonzero_of_ge_nonzero</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">p</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span><span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">nth</span> <span class="n">p</span> <span class="n">k</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">nth</span> <span class="n">p</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span>
</code></pre></div>



<a name="254851201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254851201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254851201">(Sep 25 2021 at 16:15)</a>:</h4>
<p>It's now <code>nth_zero_of_nth_zero</code>.</p>



<a name="254851300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254851300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254851300">(Sep 25 2021 at 16:17)</a>:</h4>
<p>The only thing you're doing with cardinals is checking the finite case, and the omega case. There's nothing more happening with them and, as expected, they aren't used by anything else.</p>



<a name="254851681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254851681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254851681">(Sep 25 2021 at 16:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/254851300">said</a>:</p>
<blockquote>
<p>they aren't used by anything else.</p>
</blockquote>
<p>Let's delete the whole file then, since none of it's being used elsewhere <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> (I know that's not fair, since we know one of the theorems has use in another project.)</p>
<p>It's possible they have limited future utility -- just wanted to make sure Scott had a chance to notice their departure.</p>



<a name="254852879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254852879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254852879">(Sep 25 2021 at 16:42)</a>:</h4>
<p>It looks like there's an accidental battle between <code>rw</code> and <code>simp</code> in the git history.  I think <code>rw</code> has won this match <span aria-label="checkered flag" class="emoji emoji-1f3c1" role="img" title="checkered flag">:checkered_flag:</span></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">count_set_fintype</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="n">fintype.of_finset</span> <span class="o">((</span><span class="n">finset.range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">filter</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mem_filter</span><span class="o">,</span> <span class="n">mem_range</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">])</span>

<span class="c1">--&gt; two days ago</span>

<span class="kd">instance</span> <span class="n">count_set_fintype</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="n">fintype.of_finset</span> <span class="o">((</span><span class="n">finset.range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">filter</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span>

<span class="c1">--&gt; yesterday</span>

<span class="kd">def</span> <span class="n">count_set.fintype</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">p</span> <span class="n">i</span><span class="o">}</span> <span class="o">:=</span>
<span class="n">fintype.of_finset</span> <span class="o">((</span><span class="n">finset.range</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">filter</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mem_filter</span><span class="o">,</span> <span class="n">mem_range</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">])</span>
</code></pre></div>



<a name="254853995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254853995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254853995">(Sep 25 2021 at 17:00)</a>:</h4>
<p>Whooops. The fervent partisan of "A <code>simp</code> should not replace less than two full lines of <code>rw</code>" is me.</p>



<a name="254876236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254876236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254876236">(Sep 25 2021 at 22:40)</a>:</h4>
<p>My take on the simp vs rw "war" is that replacing <code>simp</code> with <code>rw</code> is nice for explicitness and speed --- but this shouldn't come at the cost of really polishing and perfecting the simp set, if only for downstream users.</p>



<a name="254876253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254876253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254876253">(Sep 25 2021 at 22:40)</a>:</h4>
<p>I'm happy with the deleted lemmas staying deleted.</p>



<a name="254932020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254932020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254932020">(Sep 26 2021 at 13:36)</a>:</h4>
<p>Regarding a lemma upthread; note that <code>sep</code> (<a href="https://leanprover-community.github.io/mathlib_docs/find/has_sep">docs#has_sep</a>) refers to <code>{x ∈ s | p x}</code> not <code>{x | p x}</code></p>



<a name="254935810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254935810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254935810">(Sep 26 2021 at 14:35)</a>:</h4>
<p>do you still think that lemma has the right name?</p>



<a name="254936697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/254936697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#254936697">(Sep 26 2021 at 14:49)</a>:</h4>
<p>No, <code>fintype_pred_sep</code> should probably be called <code>fintype_setof_and_right</code></p>



<a name="255475255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/255475255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#255475255">(Sep 29 2021 at 21:11)</a>:</h4>
<p>I did the PR! I hope I followed the conventions correctly : )</p>



<a name="255475612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/255475612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#255475612">(Sep 29 2021 at 21:13)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/9457">#9457</a>!</p>



<a name="255494380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/255494380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#255494380">(Sep 29 2021 at 23:52)</a>:</h4>
<p>Could you update the top post of the PR to include coauthor information? Format is:<br>
<code>Co-authored-by: Name Name &lt;email@address.com&gt;</code><br>
(don't worry to much about getting the emails right; you could try pulling them off here)</p>



<a name="258257939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258257939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258257939">(Oct 19 2021 at 19:31)</a>:</h4>
<p>So, I finally got my computer back, and hope to continue working on this PR.</p>



<a name="258258062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258258062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258258062">(Oct 19 2021 at 19:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>, I have updated the top post of the PR as you have asked.</p>



<a name="258258618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258258618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258258618">(Oct 19 2021 at 19:36)</a>:</h4>
<p>When I try to open the count file in VS code, it underlines literally everything with red, saying that there is not enough memory. Am I the only one to have this problem? Could any other changes to mathlib have broken something here?</p>



<a name="258258982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258258982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258258982">(Oct 19 2021 at 19:39)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> (1) How much memory do you have? (2) Did you <code>git pull</code> and <code>leanproject get-cache</code> recently?</p>



<a name="258259777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258259777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258259777">(Oct 19 2021 at 19:44)</a>:</h4>
<p>1) Which memory exactly? Where do I look it up?<br>
2) I have deleted and redownloaded the mathlib_count branch half an hour ago, so I hope it would solve any such problems.</p>



<a name="258259841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258259841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258259841">(Oct 19 2021 at 19:45)</a>:</h4>
<p>But did you run <code>leanproject get-cache</code>?</p>



<a name="258260170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260170">(Oct 19 2021 at 19:47)</a>:</h4>
<p>I have right now, it <code>Failed to fetch cached oleans</code></p>



<a name="258260424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260424">(Oct 19 2021 at 19:49)</a>:</h4>
<p>Update <code>elan</code>. It now gives you the name of the commit you can try.</p>



<a name="258260602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260602">(Oct 19 2021 at 19:50)</a>:</h4>
<p>Did you mean "Update <code>leanproject</code>"?</p>



<a name="258260696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260696">(Oct 19 2021 at 19:51)</a>:</h4>
<p>Eh yes</p>



<a name="258260926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260926">(Oct 19 2021 at 19:52)</a>:</h4>
<p>Saying <code>leanproject update</code> (while inside mathlib_count folder) also results in <code>Failed to fetch cached oleans</code></p>



<a name="258260981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258260981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258260981">(Oct 19 2021 at 19:53)</a>:</h4>
<p>So can I assume that only have this problem?</p>



<a name="258261046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258261046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258261046">(Oct 19 2021 at 19:53)</a>:</h4>
<p>I think you need <code>pip install -U mathlibtools</code> to update <code>leanproject</code></p>



<a name="258261773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258261773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258261773">(Oct 19 2021 at 19:58)</a>:</h4>
<p>This problem can be fixed, your issue is that your computer doesn't want to compile all of Lean's maths library but there is a way of getting it to download compiled files which will solve the memory errors</p>



<a name="258262729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258262729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258262729">(Oct 19 2021 at 20:04)</a>:</h4>
<p>If I download the master branch, it compiles just fine. If I download the count branch, it has memory problems. So I would think that my problems have to do something not with leanproject nor with the memory of my computer, but with something in the count branch.</p>



<a name="258263089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263089">(Oct 19 2021 at 20:06)</a>:</h4>
<p>That's why I ask if anyone has the same problems with this branch.</p>



<a name="258263095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263095">(Oct 19 2021 at 20:06)</a>:</h4>
<p>The count branch is probably quite a bit older than current master. So the olean files don't match.</p>



<a name="258263126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263126">(Oct 19 2021 at 20:07)</a>:</h4>
<p>What is the exact branch name? I'll try.</p>



<a name="258263188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263188">(Oct 19 2021 at 20:07)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>, count</p>



<a name="258263423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263423">(Oct 19 2021 at 20:08)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> which file should I open?</p>



<a name="258263465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263465">(Oct 19 2021 at 20:09)</a>:</h4>
<p><code>data.nat.count</code></p>



<a name="258263468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263468">(Oct 19 2021 at 20:09)</a>:</h4>
<p>data/nat/count</p>



<a name="258263527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263527">(Oct 19 2021 at 20:09)</a>:</h4>
<p>Works flawlessly for me</p>



<a name="258263606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263606">(Oct 19 2021 at 20:10)</a>:</h4>
<p>Here is what I did:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>git checkout count
git pull
leanproject get-cache
</code></pre></div>



<a name="258263678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263678">(Oct 19 2021 at 20:10)</a>:</h4>
<p>After that, I opened mathlib in VScode, and opened <code>data/nat/count</code>.</p>



<a name="258263702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258263702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258263702">(Oct 19 2021 at 20:10)</a>:</h4>
<p>There were orange bars for 2-3 seconds, that's it.</p>



<a name="258264289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258264289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258264289">(Oct 19 2021 at 20:14)</a>:</h4>
<p>Thanks! I still have the problem, I'll try to figure something out.</p>



<a name="258266064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258266064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258266064">(Oct 19 2021 at 20:26)</a>:</h4>
<p>Do you have any other (modified) files open in vscode</p>



<a name="258267241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258267241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258267241">(Oct 19 2021 at 20:34)</a>:</h4>
<p>What was the output from <code>leanproject get-cache</code>?</p>



<a name="258267469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258267469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258267469">(Oct 19 2021 at 20:36)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span>, no</p>



<a name="258267588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258267588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258267588">(Oct 19 2021 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>, now it says something that includes </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">There</span> <span class="n">are</span> <span class="n">multiple</span> <span class="n">viable</span> <span class="n">caches</span> <span class="k">from</span> <span class="n">parent</span> <span class="n">commits</span><span class="o">:</span>
<span class="n">ee74b6717</span>
<span class="n">e61584d59</span>
</code></pre></div>



<a name="258267979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258267979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258267979">(Oct 19 2021 at 20:39)</a>:</h4>
<p>Try <code>leanproject get-cache --fallback=download-all</code></p>



<a name="258268442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258268442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258268442">(Oct 19 2021 at 20:42)</a>:</h4>
<p><a href="/user_uploads/3121/5f89arH6gRv2f1jr689mpL7K/Screenshot-from-2021-10-19-23-41-38.png">Screenshot-from-2021-10-19-23-41-38.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/5f89arH6gRv2f1jr689mpL7K/Screenshot-from-2021-10-19-23-41-38.png" title="Screenshot-from-2021-10-19-23-41-38.png"><img src="/user_uploads/3121/5f89arH6gRv2f1jr689mpL7K/Screenshot-from-2021-10-19-23-41-38.png"></a></div>



<a name="258268953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258268953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258268953">(Oct 19 2021 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span>, what you have said did download something, but it did not solve the problem with memory</p>



<a name="258269097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258269097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258269097">(Oct 19 2021 at 20:46)</a>:</h4>
<p>Did you restart the lean server after the download?</p>



<a name="258269104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258269104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258269104">(Oct 19 2021 at 20:46)</a>:</h4>
<p>What was the output from <code>leanproject get-cache --fallback=download-all</code>?</p>



<a name="258269790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258269790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258269790">(Oct 19 2021 at 20:50)</a>:</h4>
<p><a href="/user_uploads/3121/5g0A0ZwYndwPEELgTQ_b8axR/Screenshot-from-2021-10-19-23-50-27.png">Screenshot-from-2021-10-19-23-50-27.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/5g0A0ZwYndwPEELgTQ_b8axR/Screenshot-from-2021-10-19-23-50-27.png" title="Screenshot-from-2021-10-19-23-50-27.png"><img src="/user_uploads/3121/5g0A0ZwYndwPEELgTQ_b8axR/Screenshot-from-2021-10-19-23-50-27.png"></a></div>



<a name="258269869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258269869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258269869">(Oct 19 2021 at 20:51)</a>:</h4>
<p>I have reinstalled mathlib_count again, and did this thing, here is what I got. The memory problem persists.</p>



<a name="258271363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258271363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258271363">(Oct 19 2021 at 21:01)</a>:</h4>
<p>How do I uninstall Lean, if I'd like to try it out?</p>



<a name="258276097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258276097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258276097">(Oct 19 2021 at 21:34)</a>:</h4>
<p>How did you install <code>elan</code>? If you installed it via the shell script, you can <code>rm -rf ~/.elan</code>.</p>



<a name="258276134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258276134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258276134">(Oct 19 2021 at 21:34)</a>:</h4>
<p>How are you opening your <code>.lean</code> file? You're opening the mathlib folder in VSCode, not some subfolder, right?</p>



<a name="258276181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258276181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258276181">(Oct 19 2021 at 21:35)</a>:</h4>
<p>Yes, mathlib folder.</p>



<a name="258277487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258277487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258277487">(Oct 19 2021 at 21:44)</a>:</h4>
<p>Trying to reinstall elan did not help.</p>



<a name="258279899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258279899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258279899">(Oct 19 2021 at 22:03)</a>:</h4>
<p>Just to be clear, the oleans you should be getting are from commit <code>ee74b67171</code>.</p>



<a name="258280096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258280096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258280096">(Oct 19 2021 at 22:04)</a>:</h4>
<p>I can confirm that <code>data.nat.count</code> works fine for me on the <code>count</code> branch with those oleans. What is the output of <code>leanproject --version</code>? If it's not <code>1.1.0</code> you could try updating.</p>



<a name="258280325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258280325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258280325">(Oct 19 2021 at 22:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/258260926">said</a>:</p>
<blockquote>
<p>Saying <code>leanproject update</code> (while inside mathlib_count folder) also results in <code>Failed to fetch cached oleans</code></p>
</blockquote>
<p>This shouldn't happen. Is your local copy of <code>count</code> equal with the version on github? Did you try</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">git</span> <span class="n">checkout</span> <span class="n">count</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">leanproject</span> <span class="n">get</span><span class="bp">-</span><span class="n">cache</span>
</code></pre></div>
<p>? What does <code>git status</code> look like after these commands? Does <code>get-cache</code> get the oleans for <code>ee74b67171</code>?</p>



<a name="258280951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258280951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258280951">(Oct 19 2021 at 22:12)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> are you sure it is ee74b67171? I have ee74b6717.</p>



<a name="258281010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281010">(Oct 19 2021 at 22:12)</a>:</h4>
<p>version of leanproject is 1.1.0, version of lean is 3.33.0</p>



<a name="258281232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281232">(Oct 19 2021 at 22:14)</a>:</h4>
<p>I have tried the three lines, though I have to use git pull origin count, as otherwise it does not understand where to pull from.</p>



<a name="258281276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281276">(Oct 19 2021 at 22:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409003">Vladimir Goryachev</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/258280951">said</a>:</p>
<blockquote>
<p>are you sure it is ee74b67171? I have ee74b6717.</p>
</blockquote>
<p>A slightly confusing thing about git: a full commit id is 40 characters, but git will report an unambiguous prefix given all the other commits in the repository.  These two likely refer to the same thing.</p>



<a name="258281464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281464">(Oct 19 2021 at 22:16)</a>:</h4>
<p>if I specify <code>leanproject get-cache --rev ee74b6717</code>, it says that it applies cash and deletes two zombies.</p>



<a name="258281527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281527">(Oct 19 2021 at 22:17)</a>:</h4>
<p><code>git status</code> returns</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">On</span> <span class="n">branch</span> <span class="n">count</span>
<span class="n">nothing</span> <span class="n">to</span> <span class="n">commit</span><span class="o">,</span> <span class="n">working</span> <span class="n">tree</span> <span class="n">clean</span>
</code></pre></div>



<a name="258281774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281774">(Oct 19 2021 at 22:19)</a>:</h4>
<p>After you've run <code>leanproject get-cache</code>, you should be able to run <code>leanpkg build</code> and have it return quickly (&lt;20s). Could you confirm that? Or is it recompiling, even on the command line?</p>



<a name="258281800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258281800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258281800">(Oct 19 2021 at 22:19)</a>:</h4>
<p>(I should also say that it doesn't hurt to give <em>more</em> of the commit id: <code>leanproject get-cache --rev ee74b67171b26da3fa6f3a8b4af5ea2d7b333137</code> is the full form, based on the commits I see <a href="https://github.com/leanprover-community/mathlib/commits/count">here</a>.  I clicked on the first one and looked at the url.)</p>



<a name="258449192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258449192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258449192">(Oct 20 2021 at 21:43)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>  It is recompiling on the command line.</p>



<a name="258454349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258454349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258454349">(Oct 20 2021 at 22:27)</a>:</h4>
<p>That is ... weird. Can you show us the output of <code>leanproject get-cache --rev ee74b6717</code>, and the output of <code>git status</code>?</p>



<a name="258463318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258463318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258463318">(Oct 20 2021 at 23:57)</a>:</h4>
<p>Have you made local changes? If you pull and push does anything happen? This is difficult to debug because it's working for everyone else</p>



<a name="258467632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258467632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258467632">(Oct 21 2021 at 00:37)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> <a href="/user_uploads/3121/Mt9vQfHIxPWQgXiWw0QvJSMZ/Screenshot-from-2021-10-21-03-35-36.png">Screenshot-from-2021-10-21-03-35-36.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/Mt9vQfHIxPWQgXiWw0QvJSMZ/Screenshot-from-2021-10-21-03-35-36.png" title="Screenshot-from-2021-10-21-03-35-36.png"><img src="/user_uploads/3121/Mt9vQfHIxPWQgXiWw0QvJSMZ/Screenshot-from-2021-10-21-03-35-36.png"></a></div>



<a name="258467735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258467735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258467735">(Oct 21 2021 at 00:38)</a>:</h4>
<p>and now <code>leanpkg build</code>?</p>



<a name="258467918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258467918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258467918">(Oct 21 2021 at 00:40)</a>:</h4>
<p>Does not intend to stop. <a href="/user_uploads/3121/YlBVeybaI5jC_yzIauJOzoqM/Screenshot-from-2021-10-21-03-40-04.png">Screenshot-from-2021-10-21-03-40-04.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/YlBVeybaI5jC_yzIauJOzoqM/Screenshot-from-2021-10-21-03-40-04.png" title="Screenshot-from-2021-10-21-03-40-04.png"><img src="/user_uploads/3121/YlBVeybaI5jC_yzIauJOzoqM/Screenshot-from-2021-10-21-03-40-04.png"></a></div>



<a name="258467966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258467966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258467966">(Oct 21 2021 at 00:41)</a>:</h4>
<p>Okay, somehow you have got a bad local cache. Let's force it to pull a new one.</p>



<a name="258468077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468077">(Oct 21 2021 at 00:42)</a>:</h4>
<p>How do I do it? And should I let this thing run to completion, or terminate it?</p>



<a name="258468092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468092">(Oct 21 2021 at 00:42)</a>:</h4>
<p>no ,kill it</p>



<a name="258468099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468099">(Oct 21 2021 at 00:42)</a>:</h4>
<p>I'm just checking locally for you</p>



<a name="258468376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468376">(Oct 21 2021 at 00:45)</a>:</h4>
<p>To me that looks like some core Lean file got changed. Uninstalling and reinstalling elan might not have done anything because it might not have cleaned out the existing core lean files. And when you reinstalled it, it was happy to use the files that already existed.</p>



<a name="258468463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468463">(Oct 21 2021 at 00:46)</a>:</h4>
<p>Try</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rm</span> <span class="bp">~/.</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">ee74b67171b26da3fa6f3a8b4af5ea2d7b333137.tar.xz</span>
<span class="n">leanproject</span> <span class="n">get</span><span class="bp">-</span><span class="n">cache</span>
<span class="n">leanpkg</span> <span class="n">build</span>
</code></pre></div>



<a name="258468484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258468484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258468484">(Oct 21 2021 at 00:46)</a>:</h4>
<p>If that still fails, we'll need to work out how to more thoroughly clean your system.</p>



<a name="258469188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258469188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258469188">(Oct 21 2021 at 00:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="308899">Yakov Pechersky</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/counting.20function/near/258468376">said</a>:</p>
<blockquote>
<p>To me that looks like some core Lean file got changed. Uninstalling and reinstalling elan might not have done anything because it might not have cleaned out the existing core lean files. And when you reinstalled it, it was happy to use the files that already existed.</p>
</blockquote>
<p>I think there was a change to <code>elan</code> a while back that made core Lean files read-only (though that's certainly still a possibility).</p>



<a name="258469782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258469782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258469782">(Oct 21 2021 at 00:58)</a>:</h4>
<p>It failed. Is there a way to delete everything connected to Lean completely, to reinstall it again?</p>



<a name="258470033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258470033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258470033">(Oct 21 2021 at 01:00)</a>:</h4>
<p>It can depend a bit on what installation method you used, but deleting <code>~/.mathlib</code> and <code>~/.elan</code> is a good start.</p>



<a name="258470056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258470056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258470056">(Oct 21 2021 at 01:01)</a>:</h4>
<p>If after that <code>lean</code> fails at the command line, you're probably good to start over again.</p>



<a name="258543389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258543389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258543389">(Oct 21 2021 at 13:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>  Did not help.<br>
Also, is it expected behavior that if I take the master branch, and slightly edit data.nat.basic (e.g. add an additional enter), then most other files in nat (e.g. data.nat.lattice) do not recompile in time and get this "excessive memory consumption"?</p>



<a name="258548308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258548308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258548308">(Oct 21 2021 at 13:49)</a>:</h4>
<p>Also, in the general branch, there was a discussion that elan broke two days ago, right before I tried to get back to lean. Could it be relevant?</p>



<a name="258551896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258551896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258551896">(Oct 21 2021 at 14:10)</a>:</h4>
<p>And, do I understand my situation correctly? Mathlib takes long to compile. So there exist those olean files, which are proofs that indicate that the files are checked and are true. This count branch has inserted a couple of trivial lines in data.nat.basic, so it requires to recompile almost all the mathlib from scratch, as everything depends on nat.basic. Everyone else can simply download oleans for the count branch, but my computer does not see them for some reason. Is this correct?</p>



<a name="258552375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258552375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258552375">(Oct 21 2021 at 14:13)</a>:</h4>
<p>That sounds like a correct summary to me.</p>



<a name="258564631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258564631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258564631">(Oct 21 2021 at 15:17)</a>:</h4>
<p>I set it to compile from the command line. I'll see how it goes.</p>



<a name="258604514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258604514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258604514">(Oct 21 2021 at 19:36)</a>:</h4>
<p>It is compiling. The nat files now became workable with, as their yellow stripes disappear quickly. However, the compiler showed me an error message while compiling (and then continued on). It said that it does not know the identifier <code>sub_lt_iff_right</code>, which is used in the lemma Inf_plus. I have googled it and only found <code>tsub_lt_iff_right</code>. Where is <code>sub_lt_iff_right</code>? Also, if I enter VS Code, it also underscore this identifier with red and says that it is unknown.</p>



<a name="258605715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258605715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258605715">(Oct 21 2021 at 19:45)</a>:</h4>
<p>Also, when compiling other files, the compiler sometimes warns me that data.nat.lattice uses sorry. There is no sorry there, so I guess it just says it because there is a mistake in the data.nat.lattice (the one about sub_lt_iff_right)</p>



<a name="258606902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258606902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258606902">(Oct 21 2021 at 19:54)</a>:</h4>
<p><code>sub_lt_iff_right</code> (and a bucnh of other lemmas) has been renamed to <code>tsub_lt_iff_right</code> recently by Floris.</p>



<a name="258608860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258608860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258608860">(Oct 21 2021 at 20:06)</a>:</h4>
<p>Then how do Johan Commelin and Kevin Buzzard say the branch compiles just fine??</p>



<a name="258610542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258610542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258610542">(Oct 21 2021 at 20:18)</a>:</h4>
<p>You must have taken cache from <code>master</code>.</p>



<a name="258610576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258610576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258610576">(Oct 21 2021 at 20:18)</a>:</h4>
<p>Just merge now and everything will be alright.</p>



<a name="258612521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258612521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258612521">(Oct 21 2021 at 20:32)</a>:</h4>
<p>What exactly do you mean by merge here?</p>



<a name="258614205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258614205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258614205">(Oct 21 2021 at 20:43)</a>:</h4>
<p>What does <code>git rev-parse HEAD</code> say? This will get the actual commit ID you're working with, and it would be good to check. (It ought to say <code>ee74b67171b26da3fa6f3a8b4af5ea2d7b333137</code>)</p>



<a name="258615142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258615142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258615142">(Oct 21 2021 at 20:50)</a>:</h4>
<p>One other thing I might suggest is <code>leanproject clean</code> to delete all the oleans from the project and then <code>leanproject get-cache</code>.</p>
<p>Given your trouble with <code>tsub_...</code>, the following seems unlikely to help, but you might also check what the modified times are for a lean file and its corresponding olean.  If your system clock is incorrect, potentially the lean file might appear to be newer than its olean.  (I believe Lean uses modified times for olean invalidation.)</p>



<a name="258615551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258615551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258615551">(Oct 21 2021 at 20:53)</a>:</h4>
<p>(I know someone who for awhile had his system clock set incorrectly by a few years, and his e-mails from the future would sit at the tops of our inboxes...)</p>



<a name="258620229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258620229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258620229">(Oct 21 2021 at 21:27)</a>:</h4>
<p>Everyone, thank you for your help, I figured out what happened! I am illiterate with git, so when I have read in "How to contribute to mathlib" guide that one should use <code>leanproject get -b mathlib:shiny_lemma</code> to contribute, I decided that this must be the default way of downloading branches. So to get the <code>count</code> branch, I was just saying <code>leanproject get -b mathlib:count</code>, followed by <code>git pull origin count</code>. This used to work when data.nat.basic was not altered, but it stopped to work after it was altered, as everything had to be recompiled. Now I have googled around, learned of the wonderful <code>checkout</code> functionality of git, and now it works and I have no problems.</p>
<p>So, maybe that piece of documentation should be rewritten? As people whose interest is primarily in pure mathematics are a meaningful portion of potential new contributours, I guess I am not the only one for whom it was the first time working with git. So I think instructions on how to contribute should be mindful of such people.</p>



<a name="258621412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258621412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258621412">(Oct 21 2021 at 21:38)</a>:</h4>
<p>I've accidentally used <code>-b</code> before and been confused, too.  <code>leanproject get mathlib:count</code> downloads the actual count branch.  The <code>-b</code> option is just for creating new branches.</p>
<p>What your sequence of commands does is (1) download the <code>master</code> branch with its oleans, (2) create a new local branch based on that one with a name derived from <code>mathlib:count</code>, (3) try to merge in the <code>origin/count</code> branch.  This leaves you in a state where you have oleans for <code>master</code>, and files that are some mixture of <code>master</code> and <code>count</code> (depending on how the merge went).  If you then went ahead and followed the suggestion to do <code>leanproject get-cache --rev ee74b6717</code> then you'd have <em>really</em> the wrong oleans (since they'd be for the original <code>count</code> branch), so no wonder Lean was trying to compile everything from scratch!</p>



<a name="258621762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258621762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258621762">(Oct 21 2021 at 21:41)</a>:</h4>
<p>Yeah, I understand now. In fact, I have done <code>leanproject get-cache --rev ee74b6717</code>, and it did download some oleans, but they (logically) did not help.</p>



<a name="258659037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258659037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258659037">(Oct 22 2021 at 03:58)</a>:</h4>
<p>It's always complicated to provide "easy" tools like <code>leanproject</code>, but without obscuring what's going on underneath (e.g. with <code>git</code>). :-(</p>



<a name="258659061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258659061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258659061">(Oct 22 2021 at 03:58)</a>:</h4>
<p>If you have a suggested sentence or two that we could add to the docs to that would have saved you, please propose them and we can think about incorporating them!</p>



<a name="258661073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258661073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258661073">(Oct 22 2021 at 04:28)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> Wow, that was a nasty trap. I'm very glad that you figured it out.</p>



<a name="258690469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258690469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258690469">(Oct 22 2021 at 10:12)</a>:</h4>
<p>Thanks! <br>
As for changes I would propose for "How to contribute to mathlib":</p>
<ul>
<li>Move the part (6) upwards: it describes things which happen before opening a PR.</li>
<li>Add a few words about git, e.g.</li>
</ul>
<p>As with most projects stored on github, mathlib exists as a collection of copies, called branches. The main copy, called master, is the version which is shown to the world, and so must not include any half-finished work. So, all the other branches exist exactly for that purpose: to store various work in progress. When you complete the changes in a branch, you merge that branch with the master, making your results available to the world.</p>
<p>Note that while you can edit secondary branches freely, merging with the master requires approval from more experienced contributor, as described in the section "Lifecycle of a PR".</p>
<ul>
<li>
<p>And finally, I would add to the point 6 the following. "The simplest way to start making changes is to create your own branch. To do it, &lt;here go the first two bullet points of the point 6&gt;. However, if you want to get an existing branch, for example to help someone else with their changes, or to get a branch you have been working on on another computer, be sure to use &lt;git checkout? leanproject get without -b? I am still not sure what is the community-approved way is&gt; instead.</p>
</li>
<li>
<p>(I'd also fix the typo "steps for for sharing")</p>
</li>
</ul>



<a name="258691696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258691696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258691696">(Oct 22 2021 at 10:23)</a>:</h4>
<p>As for working on the PR.<br>
Maybe the simplest thing would be to separate the things which are preliminary to nth and count, and PR them separately. I mean changes to data.nat.basic and data.nat.lattice, as well as lemmas list.range_add, multiset.range_add and finset.range_add (which I believe should be moved to their respective files).</p>
<p>The harder thing would be to redefine nat.subtype.order_iso_of_nat in terms of nth, and make the count file its dependency. Does anyone have objections to the fact that it should be done?</p>



<a name="258710806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258710806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258710806">(Oct 22 2021 at 13:25)</a>:</h4>
<p>PRing lemmas deep down in the heirarchy separately is always a good idea, especially if the stuff built on top of them isn't ready yet</p>



<a name="258721267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258721267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258721267">(Oct 22 2021 at 14:42)</a>:</h4>
<p>OK. Should I create a separate branch for each of those changes?</p>



<a name="258721313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258721313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258721313">(Oct 22 2021 at 14:43)</a>:</h4>
<p>For each related set of changes, yes.</p>



<a name="258796280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258796280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258796280">(Oct 23 2021 at 01:44)</a>:</h4>
<p>I've made a PR updating the advice for pull requests, at <a href="https://github.com/leanprover-community/leanprover-community.github.io/pull/212">https://github.com/leanprover-community/leanprover-community.github.io/pull/212</a>. Improvements welcome --- please just push changes directly, you don't need to check with me. :-)</p>



<a name="258807195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258807195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258807195">(Oct 23 2021 at 06:39)</a>:</h4>
<p><span class="user-mention" data-user-id="409003">@Vladimir Goryachev</span> Would you mind reviewing <span aria-label="this" class="emoji emoji-1f446" role="img" title="this">:this:</span> ?</p>



<a name="258809902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/258809902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#258809902">(Oct 23 2021 at 07:49)</a>:</h4>
<p>Thank you, this is much more clear now!  The instructions look much more complete, and I think I would have much easier time if I had them available. However, I am to unproficient with the said tools to review on how optimal the proposed solutions are.</p>



<a name="259199813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/259199813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vladimir Goryachev <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#259199813">(Oct 27 2021 at 07:03)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> You have suggested renaming Inf_plus into Inf_add. What is your reasoning behind it?</p>



<a name="259200409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/counting%20function/near/259200409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/counting.20function.html#259200409">(Oct 27 2021 at 07:11)</a>:</h4>
<p>Uniformity with the rest of the library. It may be worth reading <a href="https://leanprover-community.github.io/contribute/naming.html">#naming</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>