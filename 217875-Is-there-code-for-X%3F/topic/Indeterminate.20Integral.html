---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html">Indeterminate Integral</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="286214408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286214408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286214408">(Jun 15 2022 at 13:51)</a>:</h4>
<p>I was wondering if there is a way to take an indeterminate integral of a single-variable function. I was trying to work backwards from the derivative of a function and show that if a function has this as its derivative, the function must be this, for example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.calculus.deriv</span>

<span class="kd">example</span>
<span class="o">(</span><span class="n">f</span> <span class="n">f'</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span>
<span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">has_deriv_at</span> <span class="n">f</span> <span class="o">(</span><span class="n">f'</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">hf'</span> <span class="o">:</span> <span class="n">f'</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">2</span><span class="bp">*</span><span class="n">x</span><span class="o">)</span>
<span class="o">:</span>
<span class="bp">∀</span><span class="o">(</span><span class="n">C</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">C</span>
<span class="o">:=</span>
<span class="kd">begin</span>

<span class="kd">end</span>
</code></pre></div>
<p>I was trying to prove it by contradiction, but I couldn't quite figure it out.</p>



<a name="286219790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286219790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286219790">(Jun 15 2022 at 14:29)</a>:</h4>
<p>The statement is false; I think you meant "exists" not "forall"</p>



<a name="286221854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286221854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286221854">(Jun 15 2022 at 14:43)</a>:</h4>
<p>Ok, my bad, I was thinking it would be for any constant C, because it is true that x^2 +2 and x^2 +3 both have the derivative 2*x</p>



<a name="286221963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286221963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286221963">(Jun 15 2022 at 14:44)</a>:</h4>
<p>With changing the statement to exists, where would I start with proving this? I'm having trouble finding a way to do an antiderivative in Lean</p>



<a name="286224056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286224056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286224056">(Jun 15 2022 at 14:57)</a>:</h4>
<p>Something using <a href="https://leanprover-community.github.io/mathlib_docs/find/is_const_of_deriv_eq_zero">docs#is_const_of_deriv_eq_zero</a> applied to <code>λ x, f x - x^2</code>?</p>



<a name="286228318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286228318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286228318">(Jun 15 2022 at 15:24)</a>:</h4>
<p>I made progress with that, and I think its the right track, but I ran into an illogical argument. While going through, I ended with a goal of f x - x^2 = f x, which implies that x^2 = 0. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.calculus.deriv</span>
<span class="kn">import</span> <span class="n">analysis.calculus.mean_value</span>


<span class="kd">example</span>
<span class="o">(</span><span class="n">f</span> <span class="n">f'</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span><span class="n">ℝ</span><span class="o">}</span>
<span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">has_deriv_at</span> <span class="n">f</span> <span class="o">(</span><span class="n">f'</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">hf'</span> <span class="o">:</span> <span class="n">f'</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">2</span><span class="bp">*</span><span class="n">x</span><span class="o">)</span>
<span class="o">:</span>
<span class="n">f</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span>
<span class="o">:=</span>
<span class="kd">begin</span>
<span class="k">have</span> <span class="n">h1</span><span class="o">:</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="n">y</span><span class="o">,</span>
<span class="n">apply</span> <span class="n">is_const_of_deriv_eq_zero</span><span class="o">,</span>
<span class="n">rw</span> <span class="n">differentiable</span><span class="o">,</span>
<span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
<span class="n">specialize</span> <span class="n">hf</span> <span class="n">x</span><span class="o">,</span>
<span class="n">apply</span> <span class="n">has_deriv_at.differentiable_at</span><span class="o">,</span>
<span class="n">convert</span> <span class="n">hf</span><span class="o">,</span>
<span class="n">funext</span><span class="o">,</span>

<span class="kd">end</span>
</code></pre></div>



<a name="286229568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286229568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286229568">(Jun 15 2022 at 15:33)</a>:</h4>
<p>nvm, I think I fixed it</p>



<a name="286230884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286230884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286230884">(Jun 15 2022 at 15:41)</a>:</h4>
<p>you can certainly get to an unprovable proof state from a true statement</p>



<a name="286231097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286231097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286231097">(Jun 15 2022 at 15:43)</a>:</h4>
<p>Yea, I see that. I've made progress. Currently I have the statement </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">has_deriv_at</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_1</span> <span class="n">x</span>
</code></pre></div>
<p>I feel like I should be able to prove this without having to write this as a premise, I was looking around the special function tab and trying to see if there was a lemma for this</p>



<a name="286231373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286231373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286231373">(Jun 15 2022 at 15:45)</a>:</h4>
<p>wait, I was overthinking it. Its just has_deriv_at.pow <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="286231398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286231398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286231398">(Jun 15 2022 at 15:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Indeterminate.20Integral/near/286230884">said</a>:</p>
<blockquote>
<p>you can certainly get to an unprovable proof state from a true statement</p>
</blockquote>
<p>But in this case the statement is not true, I think (the conclusion should be <code>∃(C:ℝ), f = λ x, x^2 + C</code>)</p>



<a name="286235610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286235610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286235610">(Jun 15 2022 at 16:11)</a>:</h4>
<p>A very ugly version:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.calculus.deriv</span>
<span class="kn">import</span> <span class="n">analysis.calculus.mean_value</span>

<span class="kd">example</span>
<span class="o">(</span><span class="n">f</span> <span class="n">f'</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span>
<span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">has_deriv_at</span> <span class="n">f</span> <span class="o">(</span><span class="n">f'</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">hf'</span> <span class="o">:</span> <span class="n">f'</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">2</span><span class="bp">*</span><span class="n">x</span><span class="o">)</span>
<span class="o">:</span>
<span class="bp">∃</span><span class="o">(</span><span class="n">C</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span> <span class="n">f</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">C</span>
<span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span> <span class="n">y</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">is_const_of_deriv_eq_zero</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">differentiable.add</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">intro</span> <span class="n">x</span><span class="o">,</span> <span class="n">exact</span> <span class="o">(</span><span class="n">hf</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">differentiable_at</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">simp</span> <span class="o">}},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">deriv_sub</span><span class="o">,</span> <span class="n">sub_eq_zero</span><span class="o">],</span>
      <span class="o">{</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">hf'</span><span class="o">]</span> <span class="n">using</span> <span class="o">(</span><span class="n">hf</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">deriv</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">hf</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">differentiable_at</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">simp</span> <span class="o">}}},</span>
  <span class="n">use</span> <span class="n">f</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">ext</span> <span class="n">z</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">h1</span> <span class="n">z</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
</div></div>



<a name="286248741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Indeterminate%20Integral/near/286248741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Max Bobbin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Indeterminate.20Integral.html#286248741">(Jun 15 2022 at 17:49)</a>:</h4>
<p>Thank you! I was almost there but got stuck, realized I needed my have statement to be forall. I was using lambda function. Thank you for the help!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>