---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html">✔ Cofinite maps?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="316206894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316206894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316206894">(Dec 16 2022 at 08:07)</a>:</h4>
<p>Hey, I'd need some code around "cofinite" maps, i.e.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">-&gt;</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">\</span><span class="k">forall</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">Y</span><span class="o">,</span> <span class="n">s.finite</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="n">set.preimage</span> <span class="n">f</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span>
</code></pre></div>
<ol>
<li>Is there code for it?</li>
<li>If not, would that belong in mathlib?</li>
</ol>



<a name="316207361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316207361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316207361">(Dec 16 2022 at 08:11)</a>:</h4>
<p>There's <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.cofinite">docs#filter.cofinite</a> - is that related?</p>



<a name="316208257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208257">(Dec 16 2022 at 08:17)</a>:</h4>
<p>Do you mean <code>s : set Y</code>? or am I confused</p>



<a name="316208361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208361">(Dec 16 2022 at 08:18)</a>:</h4>
<p>I do, sorry.</p>



<a name="316208431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208431">(Dec 16 2022 at 08:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Cofinite.20maps.3F/near/316207361">said</a>:</p>
<blockquote>
<p>There's <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.cofinite">docs#filter.cofinite</a> - is that related?</p>
</blockquote>
<p>I don't think it is? I'm not sure the name here is really good, but that's the best I know.</p>



<a name="316208650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208650">(Dec 16 2022 at 08:20)</a>:</h4>
<p>I would say <code>f</code> has finite fibers</p>



<a name="316208675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208675">(Dec 16 2022 at 08:21)</a>:</h4>
<p>which isn't what you wrote, but it's equivalent</p>



<a name="316208683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208683">(Dec 16 2022 at 08:21)</a>:</h4>
<p>right</p>



<a name="316208825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316208825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316208825">(Dec 16 2022 at 08:22)</a>:</h4>
<p>disregarding the name, isn't it better to _define_ it as preimages of finite being finite, simply because it's easier to show that it composes, and implies the fiber definition directly (the other direction is a tiny bit more involved) ?</p>



<a name="316209806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316209806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316209806">(Dec 16 2022 at 08:29)</a>:</h4>
<p>Yes maybe! but you will still probably want to know that you can check it on single fibers, anyways</p>



<a name="316211890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316211890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316211890">(Dec 16 2022 at 08:44)</a>:</h4>
<p>Alright ,thanks!</p>



<a name="316211917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316211917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316211917">(Dec 16 2022 at 08:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461830">Rémi Bottinelli</span> has marked this topic as resolved.</p>



<a name="316212325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316212325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316212325">(Dec 16 2022 at 08:46)</a>:</h4>
<p>That would help a lot with <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.preimage">docs#finset.preimage</a>, which can't be used as soon as your function isn't injective.</p>



<a name="316254623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316254623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316254623">(Dec 16 2022 at 12:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461830">Rémi Bottinelli</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/.E2.9C.94.20Cofinite.20maps.3F/near/316208431">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Cofinite.20maps.3F/near/316207361">said</a>:</p>
<blockquote>
<p>There's <a href="https://leanprover-community.github.io/mathlib_docs/find/filter.cofinite">docs#filter.cofinite</a> - is that related?</p>
</blockquote>
<p>I don't think it is? I'm not sure the name here is really good, but that's the best I know.</p>
</blockquote>
<p>They definitely are! </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.filter.cofinite</span>

<span class="kn">open</span> <span class="n">set</span> <span class="n">filter</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∀</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">Y</span><span class="o">,</span> <span class="n">s.finite</span> <span class="bp">→</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">cofinite</span> <span class="n">cofinite</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">tendsto_def</span><span class="o">,</span> <span class="n">mem_cofinite</span><span class="o">,</span> <span class="bp">←</span> <span class="n">preimage_compl</span><span class="o">],</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">H</span> <span class="n">s</span><span class="o">,</span> <span class="n">H</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">H</span> <span class="n">s</span><span class="o">,</span> <span class="n">compl_compl</span> <span class="n">s</span> <span class="bp">▸</span> <span class="n">H</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">⟩</span>
<span class="kd">end</span>
</code></pre></div>



<a name="316256136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316256136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316256136">(Dec 16 2022 at 12:42)</a>:</h4>
<p>In algebraic geometry, maps with finite fibres are called quasi-finite maps (this is not exactly true, there is some other technical condition which is sometimes also assumed but which is true in essentially all applications)</p>



<a name="316256671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316256671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316256671">(Dec 16 2022 at 12:45)</a>:</h4>
<p>I'm inclined to suggest <code>function.finite</code> as name for this concept.</p>



<a name="316257101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316257101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316257101">(Dec 16 2022 at 12:47)</a>:</h4>
<p>why not <code>function.proper</code>?</p>



<a name="316295415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316295415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316295415">(Dec 16 2022 at 15:35)</a>:</h4>
<p><code>proper</code> is usually interchangeable with <a href="https://leanprover-community.github.io/mathlib_docs/find/cocompact_map">docs#cocompact_map</a> (<code>tendsto cocompact cocompact</code>). So maybe this indeed should be named <code>cofinite</code> ...</p>



<a name="316295905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316295905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316295905">(Dec 16 2022 at 15:37)</a>:</h4>
<p>I'm not sure we should use topological terminology when there's no topology around. I guess you could also put some bornology on discrete spaces such that finite sets are bounded. And then <code>cofinite = cobounded</code>, and hence you could use bounded maps for this notion.</p>



<a name="316296059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316296059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316296059">(Dec 16 2022 at 15:38)</a>:</h4>
<p>So I would rather have a name that directly corresponds to the finiteness that is inherent in the concept.</p>



<a name="316296078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316296078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316296078">(Dec 16 2022 at 15:38)</a>:</h4>
<p>IIRC there is a general categorical notion of properness, and these two are special cases</p>



<a name="316296255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316296255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316296255">(Dec 16 2022 at 15:39)</a>:</h4>
<p>Ok, that's a better justification (-;</p>



<a name="316296869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316296869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316296869">(Dec 16 2022 at 15:41)</a>:</h4>
<p>Let me see what the nlab thinks</p>



<a name="316297622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316297622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316297622">(Dec 16 2022 at 15:45)</a>:</h4>
<p>Let me apologize in advance to any bystanders...<br>
<a href="https://ncatlab.org/nlab/show/proper+geometric+morphism">https://ncatlab.org/nlab/show/proper+geometric+morphism</a></p>



<a name="316321000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%E2%9C%94%20Cofinite%20maps%3F/near/316321000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.E2.9C.94.20Cofinite.20maps.3F.html#316321000">(Dec 16 2022 at 17:29)</a>:</h4>
<p>But because of mathlib's use of unbundled constructs it would conflict to refer to this as properness, since then a proper map (in the sense of topology) won't be proper in this sense.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>