---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html">metrics are nonnegative</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="218733994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218733994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218733994">(Dec 03 2020 at 18:21)</a>:</h4>
<p>I proved that something was a <code>metric_space</code> but now I'm noticing that I was never asked to prove my metric was nonnegative!<br>
Is this a bug?</p>



<a name="218734282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218734282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218734282">(Dec 03 2020 at 18:23)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/dist_nonneg/src">src#dist_nonneg</a> is derived from the triangle equality that you did prove</p>



<a name="218734485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218734485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218734485">(Dec 03 2020 at 18:24)</a>:</h4>
<p>Thanks... that's a nice way to set it up</p>



<a name="218742273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742273">(Dec 03 2020 at 19:25)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> how might I tell <code>dist_nonneg</code> which metric I want to use?</p>



<a name="218742492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742492">(Dec 03 2020 at 19:27)</a>:</h4>
<p>Looks like you need an instance of <code>metric_space</code></p>



<a name="218742530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742530">(Dec 03 2020 at 19:27)</a>:</h4>
<p>Yes, I have that, but then I'm not sure how to invoke it.</p>



<a name="218742532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742532">(Dec 03 2020 at 19:27)</a>:</h4>
<p>In most cases you don't - the way the typeclasses are set up usually means you have exactly one metric per your</p>



<a name="218742599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742599">(Dec 03 2020 at 19:28)</a>:</h4>
<p>Did you construct a metric_space instance as a def as opposed to an instance?</p>



<a name="218742757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742757">(Dec 03 2020 at 19:29)</a>:</h4>
<p>I have this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">section</span> <span class="n">jaccard_numerator</span>
    <span class="sd">/-- Instantiate finset ℕ as a metric space. -/</span>
    <span class="kd">instance</span> <span class="n">jaccard_numerator.metric_space</span> <span class="o">(</span><span class="n">hm</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">M</span><span class="o">):</span> <span class="n">metric_space</span> <span class="o">(</span><span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span>
    <span class="c1">-- omitting the details</span>
    <span class="o">}</span>
<span class="kd">end</span> <span class="n">jaccard_numerator</span>
</code></pre></div>



<a name="218742790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742790">(Dec 03 2020 at 19:29)</a>:</h4>
<p>Ah, you have variables....</p>



<a name="218742857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742857">(Dec 03 2020 at 19:30)</a>:</h4>
<p>So typeclass inference can't find this instance since it doesn't know how to fill in <code>hm</code> and <code>hM</code>.</p>



<a name="218742884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742884">(Dec 03 2020 at 19:30)</a>:</h4>
<p>What is the type of <code>m</code>?</p>



<a name="218742901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742901">(Dec 03 2020 at 19:30)</a>:</h4>
<p>real number</p>



<a name="218742922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742922">(Dec 03 2020 at 19:30)</a>:</h4>
<p>You can make this a def, and use <code>@dist_nonneg</code> and put in your definition manually.</p>



<a name="218742965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218742965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218742965">(Dec 03 2020 at 19:31)</a>:</h4>
<p>Or you can create a type alias for <code>finset \N</code></p>



<a name="218743001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743001">(Dec 03 2020 at 19:31)</a>:</h4>
<p>But I think the proofs needed will still be missing.</p>



<a name="218743008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743008">(Dec 03 2020 at 19:31)</a>:</h4>
<p>Which folds those proofs into the type</p>



<a name="218743192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743192">(Dec 03 2020 at 19:33)</a>:</h4>
<p>(deleted)</p>



<a name="218743238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743238">(Dec 03 2020 at 19:33)</a>:</h4>
<p>That's not what I meant</p>



<a name="218743261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743261">(Dec 03 2020 at 19:33)</a>:</h4>
<p><code>m</code> should be part of the type itself</p>



<a name="218743293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743293">(Dec 03 2020 at 19:33)</a>:</h4>
<p>Or like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">foo</span> <span class="o">(</span><span class="n">m</span> <span class="n">M</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℕ</span><span class="o">)</span>
<span class="o">(</span><span class="n">hm</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">)</span>
<span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">M</span><span class="o">)</span>
</code></pre></div>



<a name="218743301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743301">(Dec 03 2020 at 19:33)</a>:</h4>
<p>Otherwise when you do <code>dist x y</code> you have two different ms</p>



<a name="218743359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743359">(Dec 03 2020 at 19:34)</a>:</h4>
<p>No point having the proofs as fields there</p>



<a name="218743377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743377">(Dec 03 2020 at 19:34)</a>:</h4>
<p>Since they're the same for all foo objects</p>



<a name="218743383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743383">(Dec 03 2020 at 19:34)</a>:</h4>
<p>Those are presumably needed in defining the instance.</p>



<a name="218743428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743428">(Dec 03 2020 at 19:34)</a>:</h4>
<p>Yes, if <code>0&lt;m</code> fails then it's not a metric space</p>



<a name="218743445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743445">(Dec 03 2020 at 19:35)</a>:</h4>
<p>Yeah, but put them before the :=</p>



<a name="218743452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743452">(Dec 03 2020 at 19:35)</a>:</h4>
<p>or if <code>m \le M</code> fails</p>



<a name="218743487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743487">(Dec 03 2020 at 19:35)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">(</span><span class="n">m</span> <span class="n">M</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hm</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="n">finset</span> <span class="n">ℕ</span>
</code></pre></div>



<a name="218743594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743594">(Dec 03 2020 at 19:36)</a>:</h4>
<p>Yeah, this should work.</p>



<a name="218743598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743598">(Dec 03 2020 at 19:36)</a>:</h4>
<p>Then <code>metric_space (foo n M hm hM)</code></p>



<a name="218743667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743667">(Dec 03 2020 at 19:37)</a>:</h4>
<p>Thanks I'll try that... will probably still have some questions</p>



<a name="218743733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743733">(Dec 03 2020 at 19:37)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">{</span><span class="n">m</span> <span class="n">M</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hm</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="n">finset</span> <span class="n">ℕ</span>
<span class="kd">instance</span> <span class="o">{</span><span class="n">m</span> <span class="n">M</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">hm</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">}</span> <span class="o">{</span><span class="n">hM</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">M</span><span class="o">}</span> <span class="o">:</span> <span class="n">metric_space</span> <span class="o">(</span><span class="n">foo</span> <span class="n">hm</span> <span class="n">hM</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="218743952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218743952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218743952">(Dec 03 2020 at 19:39)</a>:</h4>
<p>Can you combine hm and hM into a statement about <a href="https://leanprover-community.github.io/mathlib_docs/find/Ioo">docs#Ioo</a></p>



<a name="218744042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218744042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218744042">(Dec 03 2020 at 19:40)</a>:</h4>
<p>I wish we could write   <code>h : 0 &lt; m &lt; M</code></p>



<a name="218744137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218744137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218744137">(Dec 03 2020 at 19:41)</a>:</h4>
<p>But yes, you can say that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> is in the interval <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,M)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span>.</p>



<a name="218744204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218744204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218744204">(Dec 03 2020 at 19:41)</a>:</h4>
<p>(even though <span class="user-mention" data-user-id="310045">@Eric Wieser</span> 's link is broken)</p>



<a name="218744423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218744423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218744423">(Dec 03 2020 at 19:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="347475">Bjørn Kjos-Hanssen</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/metrics.20are.20nonnegative/near/218742273">said</a>:</p>
<blockquote>
<p>how might I tell <code>dist_nonneg</code> which metric I want to use?</p>
</blockquote>
<p>What do you want to use the result of having a proof that jaccard distance is nonnegative for?</p>



<a name="218744835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218744835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218744835">(Dec 03 2020 at 19:46)</a>:</h4>
<p>Well it's a numerator of a generalization of Jaccard distance... :) but this numerator I want to use in a proof about the generalization itself, in order to prove <code>eq_of_dist_eq_zero</code> for the latter</p>



<a name="218745177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745177">(Dec 03 2020 at 19:49)</a>:</h4>
<p>Then you might prefer to use <code>uniform_space_of_dist</code> instead</p>



<a name="218745378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745378">(Dec 03 2020 at 19:51)</a>:</h4>
<p>And have a helper <code>dist_nonneg</code> to not require a <code>metric_space</code> but just a term of <code>uniform_space</code></p>



<a name="218745521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745521">(Dec 03 2020 at 19:52)</a>:</h4>
<p>Because for <code>uniform_space_of_dist</code> you provide the <code>dist</code> explicitly instead of implicitly</p>



<a name="218745546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745546">(Dec 03 2020 at 19:52)</a>:</h4>
<p>(which I think might be useful for <span class="user-mention" data-user-id="364351">@Lars Ericson</span> as well...?)</p>



<a name="218745883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745883">(Dec 03 2020 at 19:55)</a>:</h4>
<p>But will that be a weaker result, then? If I just prove it's a <code>uniform_space</code> instead of a metric space?</p>



<a name="218745923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218745923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218745923">(Dec 03 2020 at 19:55)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> is saying to put the <code>dist</code> as a variable in the lemma.</p>



<a name="218746094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218746094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218746094">(Dec 03 2020 at 19:56)</a>:</h4>
<p>You're trying to prove statements about __this__ particular distance function, not spaces that have this distance function, right?</p>



<a name="218746329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218746329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218746329">(Dec 03 2020 at 19:58)</a>:</h4>
<p>Right, I'm working with no additional "space" structure beside the distance function... except that the domain is fixed to be <code>finset \N</code></p>



<a name="218747196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218747196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218747196">(Dec 03 2020 at 20:04)</a>:</h4>
<p>There's several ways of getting out the unbundled result from the <code>metric_space</code> bundled structure. Can you share your larger problem statement?</p>



<a name="218747410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218747410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218747410">(Dec 03 2020 at 20:06)</a>:</h4>
<p>I can share but maybe I should ask first if you mean something like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">eq_of_jn_eq_zero</span> <span class="o">(</span><span class="n">myspace</span> <span class="o">:</span> <span class="n">metric_space</span> <span class="o">(</span><span class="n">finset</span> <span class="n">ℕ</span><span class="o">))</span> <span class="o">(</span><span class="n">hm</span><span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">m</span><span class="o">)</span>  <span class="c1">--- omitting the rest</span>
</code></pre></div>



<a name="218747513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218747513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218747513">(Dec 03 2020 at 20:07)</a>:</h4>
<p>and then do someting like <code>myspace.dist_nonneg</code>?</p>



<a name="218747982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218747982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218747982">(Dec 03 2020 at 20:11)</a>:</h4>
<p>with a <code>hdist : myspace.dist = jaccard_distance_func</code> could work</p>



<a name="218771006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/metrics%20are%20nonnegative/near/218771006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bjørn Kjos-Hanssen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/metrics.20are.20nonnegative.html#218771006">(Dec 03 2020 at 23:44)</a>:</h4>
<p>Anyway, I was able to get what was needed by just using <span class="user-mention" data-user-id="310045">@Eric Wieser</span> 's original pointer to <code>dist_nonneg</code> and replicating that proof</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>