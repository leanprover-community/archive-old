---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html">Localization at units</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="237957500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237957500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237957500">(May 08 2021 at 13:52)</a>:</h4>
<p>I would like to have an isomorphism between a ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and its localization at one <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. More generally, the localization of a ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> at a submonoid consisting only of units, should be isomorphic to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, because the identity is a localization map. Is there something approximating that in the library?</p>



<a name="237964020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237964020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237964020">(May 08 2021 at 15:32)</a>:</h4>
<p>You should be able to create a <code>localization_map</code> between <code>R</code> and <code>R</code>, that exhibits the identity map as a localization at <code>{1}</code>.</p>



<a name="237966019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237966019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237966019">(May 08 2021 at 16:00)</a>:</h4>
<p><span class="user-mention" data-user-id="384542">@Justus Springer</span> the lowdown on localisation is that given R and S there is "the explicit localisation R[1/S]" in Lean (i.e. a model for the localisation) and there is also "the predicate that an R-algebra A is isomorphic to R[1/S]". So you can get what you want by first proving that the R-algebra R satisfies the predicate for S={1}, and then using the fact that everything which satisfies the predicate is isomorphic to the explicit localisation, if that is what your question is. If you formalised the question in Lean rather than just making a mathematical statement, it would be easier to see what you were after.</p>



<a name="237966166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237966166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237966166">(May 08 2021 at 16:02)</a>:</h4>
<p>PS if it's not in the library already that R satisfies the localisation predicate for S=1 or more generally <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⊆</mo><msup><mi>R</mi><mo>×</mo></msup></mrow><annotation encoding="application/x-tex">S\subseteq R^\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">×</span></span></span></span></span></span></span></span></span></span></span> then it probably should be!</p>



<a name="237967325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237967325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237967325">(May 08 2021 at 16:18)</a>:</h4>
<p>Yeah that's exactly what I meant. Just wanted to make sure I'm not missing something obvious before I spend too much time working on the general problem. It's not in the library as far as I can see.</p>



<a name="237967362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237967362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237967362">(May 08 2021 at 16:19)</a>:</h4>
<p>Here's a toy version I got to work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.localization</span>
<span class="kn">import</span> <span class="n">algebra.category.CommRing.basic</span>

<span class="kd">noncomputable theory</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">submonoid</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">M</span><span class="o">,</span> <span class="n">is_unit</span> <span class="n">x</span><span class="o">)</span>
<span class="kn">include</span> <span class="n">hM</span>

<span class="kd">def</span> <span class="n">localization_at_units_iso</span> <span class="o">:</span> <span class="n">localization</span> <span class="n">M</span> <span class="bp">≃+*</span> <span class="n">R</span> <span class="o">:=</span>
<span class="n">localization.ring_equiv_of_quotient</span> <span class="bp">$</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="o">(</span><span class="n">CommRing.of</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">_</span> <span class="bp">→+*</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">to_localization_map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">y</span><span class="o">,</span> <span class="n">hM</span> <span class="n">_</span> <span class="n">y.2</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">y</span><span class="o">,</span> <span class="n">refine</span> <span class="o">⟨⟨</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">⟩,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">⟩,},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">1</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">]⟩,</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">_</span><span class="o">)⟩,</span>
    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">hc</span><span class="o">⟩,</span>
    <span class="n">rcases</span> <span class="n">is_unit_iff_exists_inv.mp</span> <span class="o">(</span><span class="n">hM</span> <span class="n">_</span> <span class="n">c.2</span><span class="o">)</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">convert</span> <span class="n">congr_arg</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span><span class="o">,</span> <span class="n">z</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="n">hc</span> <span class="bp">;</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">mul_assoc</span><span class="o">,</span> <span class="n">hb</span><span class="o">],</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="237968659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237968659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237968659">(May 08 2021 at 16:39)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.localization</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">submonoid</span> <span class="n">R</span><span class="o">)</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">localization_at_units_iso</span> <span class="o">(</span><span class="n">hM</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">M</span><span class="o">,</span> <span class="n">is_unit</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="n">localization</span> <span class="n">M</span> <span class="bp">≃+*</span> <span class="n">R</span> <span class="o">:=</span>
<span class="n">localization.ring_equiv_of_quotient</span>
<span class="o">{</span> <span class="n">map_units'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">y</span><span class="o">,</span> <span class="n">hM</span> <span class="n">y.1</span> <span class="n">y.2</span><span class="o">,</span>
  <span class="n">surj'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">z</span><span class="o">,</span> <span class="o">⟨⟨</span><span class="n">z</span><span class="o">,</span> <span class="mi">1</span><span class="o">⟩,</span> <span class="n">mul_one</span> <span class="n">z</span><span class="o">⟩,</span>
  <span class="n">eq_iff_exists'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">1</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simpa</span> <span class="n">using</span> <span class="n">h</span><span class="o">⟩,</span>
    <span class="bp">λ</span> <span class="o">⟨⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">hc</span><span class="o">⟩,</span> <span class="n">h</span><span class="o">⟩,</span> <span class="o">(</span><span class="n">is_unit.mul_left_inj</span> <span class="o">(</span><span class="n">hM</span> <span class="n">c</span> <span class="n">hc</span><span class="o">))</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span><span class="o">⟩,</span>
  <span class="bp">..</span><span class="n">ring_hom.id</span> <span class="n">R</span> <span class="o">}</span>
</code></pre></div>



<a name="237969038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969038">(May 08 2021 at 16:44)</a>:</h4>
<p>It's just the same proof, but I never need to go into tactic mode (or use category theory)</p>



<a name="237969232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969232">(May 08 2021 at 16:47)</a>:</h4>
<p>Thanks!</p>



<a name="237969296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969296">(May 08 2021 at 16:48)</a>:</h4>
<p>Let's see if I can put something together here.</p>



<a name="237969352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969352">(May 08 2021 at 16:49)</a>:</h4>
<p>This doesn't actually need the additive structure of rings, so it might as well go into <code>group_theory/monoid_localization</code> I assume...</p>



<a name="237969471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969471">(May 08 2021 at 16:50)</a>:</h4>
<p>Why do we assume M is a submonoid here?</p>



<a name="237969600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969600">(May 08 2021 at 16:52)</a>:</h4>
<p>Localization is defined only at submonoids isn't it?<br>
If I can divide by <code>f</code> and by <code>g</code> I can also divide by <code>fg</code>.</p>



<a name="237969633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969633">(May 08 2021 at 16:53)</a>:</h4>
<p>I can see it is defined only at submonoids in Lean, but it isn't in the real world.</p>



<a name="237969663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969663">(May 08 2021 at 16:53)</a>:</h4>
<p>Of course localizing at a random subset will be the same thing as localizing at the submonoid generated by this subset.</p>



<a name="237969712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969712">(May 08 2021 at 16:54)</a>:</h4>
<p>But for formalization purposes I'm surprised we imposed that useless assumption.</p>



<a name="237969736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969736">(May 08 2021 at 16:54)</a>:</h4>
<p>If you define a localization by the obvious universal property then the submonoid condition is completely useless.</p>



<a name="237969991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237969991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237969991">(May 08 2021 at 16:58)</a>:</h4>
<p>I'm not sure. I guess the map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>R</mi><mo>→</mo><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">M\times R\to R_M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sending <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">r/s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">s</span></span></span></span> wouldn't be surjective if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> wasn't a submonoid?</p>



<a name="237970033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970033">(May 08 2021 at 16:59)</a>:</h4>
<p>And this surjectivity is one of the defining properties of localization maps, as it's defined in Lean.</p>



<a name="237970048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Justus Springer <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970048">(May 08 2021 at 17:00)</a>:</h4>
<p>It's not defined by the universal property I think.</p>



<a name="237970188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970188">(May 08 2021 at 17:01)</a>:</h4>
<p>Maybe we need to change the definition of <code>localization_map</code>?</p>



<a name="237970229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970229">(May 08 2021 at 17:01)</a>:</h4>
<p>This was done by Kenny in 2017 as one of the very first projects that either he or I had been involved in, that's why we localise at submonoids -- we were copying out of Atiyah--Macdonald and had no idea about Lean; indeed this project taught us a lot about it.</p>



<a name="237970588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970588">(May 08 2021 at 17:06)</a>:</h4>
<p>I think <code>localization_map</code> should be refactored to be a predicate on ring homomorphisms, or maybe a mixin on top of <code>algebra</code>. But this is quite a massive refactor, and I haven't found time or energy to do it.</p>



<a name="237970614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970614">(May 08 2021 at 17:07)</a>:</h4>
<p>Currently we need to resort to some ugly hacks to make the codomain of a <code>localization_map</code> into an <code>algebra</code>.</p>



<a name="237970639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970639">(May 08 2021 at 17:08)</a>:</h4>
<p>Also <code>f.to_map</code> isn't very nice to read.</p>



<a name="237970692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970692">(May 08 2021 at 17:08)</a>:</h4>
<p>I acctually really like <span class="user-mention" data-user-id="130377">@David Wärn</span> 's definition of <code>is_free_group</code>. We could do something like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra</span>

<span class="kd">universes</span> <span class="n">u</span>

<span class="kd">class</span> <span class="n">localization_map</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">B</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">maps_to_unit</span> <span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">f</span> <span class="n">s</span><span class="o">))</span>
<span class="o">(</span><span class="n">lift</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">s</span><span class="o">),</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">g</span> <span class="n">s</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="n">B</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">))</span>
<span class="o">(</span><span class="n">lift_comp</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">cond</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span><span class="o">),</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">g</span> <span class="n">s</span><span class="o">))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">lift</span> <span class="n">g</span> <span class="n">cond</span><span class="o">)</span><span class="bp">.</span><span class="n">comp</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="o">)</span>
<span class="o">(</span><span class="n">lift_unique</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">cond</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span><span class="o">),</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">g</span> <span class="n">s</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">)</span> <span class="o">:</span> <span class="n">h.comp</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span> <span class="bp">→</span> <span class="n">h</span> <span class="bp">=</span> <span class="n">lift</span> <span class="n">g</span> <span class="n">cond</span><span class="o">)</span>
</code></pre></div>



<a name="237970732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970732">(May 08 2021 at 17:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="384542">Justus Springer</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Localization.20at.20units/near/237969991">said</a>:</p>
<blockquote>
<p>I'm not sure. I guess the map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>R</mi><mo>→</mo><msub><mi>R</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">M\times R\to R_M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sending <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">r/s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">/</span><span class="mord mathnormal">s</span></span></span></span> wouldn't be surjective if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> wasn't a submonoid?</p>
</blockquote>
<p>Of course you can't use this formula. You need to replace <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> by the generated submonoid.</p>



<a name="237970771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970771">(May 08 2021 at 17:09)</a>:</h4>
<p>This allow you do to thing like localizing at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{f\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">}</span></span></span></span> without introducing a special case notation for instance.</p>



<a name="237970774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970774">(May 08 2021 at 17:09)</a>:</h4>
<p>(queue the complaints about semirings in 3...2...1...)</p>



<a name="237970966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970966">(May 08 2021 at 17:12)</a>:</h4>
<p>We'll want eliminators for other universes as well, I guess.</p>



<a name="237970978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970978">(May 08 2021 at 17:13)</a>:</h4>
<p>Yeah I'm not sure what to do about universes...</p>



<a name="237970983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970983">(May 08 2021 at 17:13)</a>:</h4>
<p>And maybe a constructor for the current defn</p>



<a name="237970995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237970995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237970995">(May 08 2021 at 17:13)</a>:</h4>
<p>Do we ever want a localization of a (semi)ring which is not in the same universe?</p>



<a name="237971040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971040">(May 08 2021 at 17:14)</a>:</h4>
<p>Every time you "construct" a localization, it ends up in the same universe</p>



<a name="237971106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971106">(May 08 2021 at 17:15)</a>:</h4>
<p>I can think of various ways of ending up with "<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi></mrow><annotation encoding="application/x-tex">\mathbb{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85556em;vertical-align:-0.16667em;"></span><span class="mord mathbb">Q</span></span></span></span>" in arbitrary universes.</p>



<a name="237971167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971167">(May 08 2021 at 17:16)</a>:</h4>
<p>If you have the rational functions on some proper variety or something.</p>



<a name="237971184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971184">(May 08 2021 at 17:16)</a>:</h4>
<p>Like the prime subfield of a field <code>K : Type LARGE</code>?</p>



<a name="237971213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971213">(May 08 2021 at 17:16)</a>:</h4>
<p>I guess the solution is to have <code>is_function_field_of X rat</code> and <code>is_prime_subfield_of K rat</code>, etc...</p>



<a name="237971214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971214">(May 08 2021 at 17:16)</a>:</h4>
<p>Yeah good point, in this case we would want that the canonical map <code>int \to K</code> is a localization to the prime subfield</p>



<a name="237971260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971260">(May 08 2021 at 17:18)</a>:</h4>
<p>Damiano was also toying with the idea of having <code>prelocalization_map</code>s. So that <code>int -&gt; real</code> was an example. Half of the theory works for that notion.</p>



<a name="237971302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971302">(May 08 2021 at 17:18)</a>:</h4>
<p>Okay, here's a fix:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra</span>

<span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kd">class</span> <span class="n">localization_map</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">B</span><span class="o">]</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">maps_to_unit</span> <span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">f</span> <span class="n">s</span><span class="o">))</span>
<span class="o">(</span><span class="n">unique_lift</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u</span> <span class="n">v</span><span class="o">)}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">)</span>
  <span class="o">(</span><span class="n">cond</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span><span class="o">),</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">g</span> <span class="n">s</span><span class="o">)),</span> <span class="bp">∃!</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">→+*</span> <span class="n">C</span><span class="o">),</span> <span class="n">h.comp</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">g</span><span class="o">)</span>
</code></pre></div>



<a name="237971381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971381">(May 08 2021 at 17:20)</a>:</h4>
<p>Or perhaps we need <code>C : Type v</code>?</p>



<a name="237971503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971503">(May 08 2021 at 17:21)</a>:</h4>
<p>The easiest would be to have a defn that doesn't mention universes...</p>



<a name="237971568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971568">(May 08 2021 at 17:22)</a>:</h4>
<p>I don't understand, I thought Kevin was always saying Neil's predicate did exactly that.</p>



<a name="237971592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971592">(May 08 2021 at 17:22)</a>:</h4>
<p>Yeah, we could just use Neil's predicate with the submonoid generated by the set (in the commutative ring case!)</p>



<a name="237971621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Localization%20at%20units/near/237971621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Localization.20at.20units.html#237971621">(May 08 2021 at 17:23)</a>:</h4>
<p>But that's okay because all semirings are commutative rings</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>