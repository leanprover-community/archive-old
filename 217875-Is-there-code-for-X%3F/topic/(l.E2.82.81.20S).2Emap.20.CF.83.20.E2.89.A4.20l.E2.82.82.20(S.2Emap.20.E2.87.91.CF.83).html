---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html">(l₁ S).map σ ≤ l₂ (S.map ⇑σ)</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="266287385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266287385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266287385">(Dec 28 2021 at 19:55)</a>:</h4>
<p>Much to my annoyance I'm stuck on both of these, although I can prove that each implies the other.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.galois</span>
<span class="kn">import</span> <span class="n">topology.algebra.filter_basis</span>

<span class="kd">lemma</span> <span class="n">foo</span> <span class="o">{</span><span class="n">K</span> <span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
  <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">L</span><span class="o">)</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">σ</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">→ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
<span class="o">(</span><span class="n">intermediate_field.adjoin</span> <span class="n">K</span> <span class="n">S</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">σ</span> <span class="bp">≤</span>
<span class="n">intermediate_field.adjoin</span> <span class="n">K</span> <span class="o">(</span><span class="n">σ</span> <span class="bp">''</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span> <span class="c1">-- they're equal but I can do ≥</span>

<span class="kd">lemma</span> <span class="n">foo2</span> <span class="o">{</span><span class="n">K</span> <span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
  <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">L</span><span class="o">)</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">σ</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">→ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">M</span><span class="o">),</span>
  <span class="n">σ</span> <span class="bp">''</span> <span class="n">S</span> <span class="bp">⊆</span> <span class="n">F</span> <span class="bp">→</span> <span class="o">(</span><span class="n">intermediate_field.adjoin</span> <span class="n">K</span> <span class="n">S</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">σ</span> <span class="bp">≤</span> <span class="n">F</span> <span class="o">:=</span> <span class="gr">sorry</span> <span class="c1">-- this is</span>
  <span class="c1">-- an iff but the other way is easy</span>

  <span class="c1">-- Note we have `intermediate_field.gi`</span>
</code></pre></div>
<p>The Galois insertion info:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="c1">-- α is set L or set M</span>
  <span class="c1">-- β is intermediate_field L or intermediate_field M</span>
  <span class="c1">-- l is `adjoin K`</span>
  <span class="c1">-- u is `coe`</span>
</code></pre></div>
<p>I don't know if there's a general statement about Galois insertions. Here there are two involved.</p>



<a name="266287717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266287717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266287717">(Dec 28 2021 at 19:59)</a>:</h4>
<p>Is <a href="https://leanprover-community.github.io/mathlib_docs/find/intermediate_field.adjoin_map">docs#intermediate_field.adjoin_map</a> what you are looking for?</p>



<a name="266288117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266288117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266288117">(Dec 28 2021 at 20:04)</a>:</h4>
<p>Yes, this is what he is looking for</p>



<a name="266288179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266288179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266288179">(Dec 28 2021 at 20:04)</a>:</h4>
<p>But the Galois connection magic he is asking for is also interesting, I think we still miss the relevant lemma.</p>



<a name="266289727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266289727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266289727">(Dec 28 2021 at 20:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> is <a href="https://leanprover-community.github.io/mathlib_docs/find/intermediate_field.map">docs#intermediate_field.map</a> part of a Galois connection?</p>



<a name="266293050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293050">(Dec 28 2021 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I wrote what I think is a bit of Galois connection magic that mathlib is missing, together with a sample application (I could have used your example if you had answered my previous message).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">group_theory.subgroup.basic</span>


<span class="kd">variables</span>
  <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Y</span><span class="o">]</span>


<span class="kd">lemma</span> <span class="n">galois_connection.eq_l</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">u</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">z</span> <span class="o">:</span> <span class="n">Y</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">l</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">z</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span> <span class="bp">≤</span> <span class="n">y</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">u</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="n">rfl</span> <span class="n">y</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h</span> <span class="n">x</span> <span class="n">y</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">H</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">((</span><span class="n">h</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="bp">$</span> <span class="o">(</span><span class="n">H</span> <span class="n">z</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">le_rfl</span><span class="o">)</span><span class="bp">.</span><span class="n">antisymm</span> <span class="o">((</span><span class="n">H</span> <span class="bp">$</span> <span class="n">l</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="o">(</span><span class="n">h.le_u_l</span> <span class="n">x</span><span class="o">))</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">galois_connection.eq_u</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">u</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span><span class="n">z</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">y</span> <span class="o">:</span> <span class="n">Y</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">u</span> <span class="n">y</span>  <span class="bp">=</span> <span class="n">z</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">z</span> <span class="bp">↔</span> <span class="n">l</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="n">rfl</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">h</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">H</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">((</span><span class="n">H</span> <span class="bp">$</span> <span class="n">u</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="o">(</span><span class="n">h.l_u_le</span> <span class="n">y</span><span class="o">))</span><span class="bp">.</span><span class="n">antisymm</span> <span class="o">((</span><span class="n">h</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="bp">$</span> <span class="o">(</span><span class="n">H</span> <span class="n">z</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">le_rfl</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">variables</span>
  <span class="o">{</span><span class="n">Z</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Z</span><span class="o">]</span> <span class="o">{</span><span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">W</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">gc_magic</span>
  <span class="o">{</span><span class="n">lYX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">rXY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lYX</span> <span class="n">rXY</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">rZW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">(</span><span class="n">hZW</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWZ</span> <span class="n">rZW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">rYW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">(</span><span class="n">hWY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWY</span> <span class="n">rYW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lZX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">{</span><span class="n">rXZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXZ</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lZX</span> <span class="n">rXZ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">rXY</span> <span class="bp">∘</span> <span class="n">rYW</span> <span class="bp">=</span> <span class="n">rXZ</span> <span class="bp">∘</span> <span class="n">rZW</span><span class="o">)</span> <span class="o">:</span> <span class="n">lWZ</span> <span class="bp">∘</span> <span class="n">lZX</span> <span class="bp">=</span> <span class="n">lWY</span> <span class="bp">∘</span> <span class="n">lYX</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">hZW.eq_l</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">w</span><span class="o">,</span>
  <span class="k">calc</span>
  <span class="n">lWY</span> <span class="o">(</span><span class="n">lYX</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">w</span> <span class="bp">↔</span> <span class="n">lYX</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">rYW</span> <span class="n">w</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">hWY</span>
              <span class="bp">...</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">rXY</span> <span class="o">(</span><span class="n">rYW</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">hXY</span>
              <span class="bp">...</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">rXY</span> <span class="o">(</span><span class="n">rYW</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">hXY</span>
              <span class="bp">...</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">rXZ</span> <span class="o">(</span><span class="n">rZW</span> <span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="k">show</span> <span class="n">rXY</span> <span class="o">(</span><span class="n">rYW</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="n">rXZ</span> <span class="o">(</span><span class="n">rZW</span> <span class="n">w</span><span class="o">),</span> <span class="k">from</span> <span class="n">congr_fun</span> <span class="n">h</span> <span class="n">w</span>
              <span class="bp">...</span> <span class="bp">↔</span> <span class="n">lZX</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">rZW</span> <span class="n">w</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">hXZ</span>
<span class="kd">end</span>

<span class="kn">open</span> <span class="n">subgroup</span> <span class="n">set</span>

<span class="c">/-</span><span class="cm"> We can now reprove: -/</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">monoid_hom.map_closure</span>

<span class="sd">/-- The image by a group morphism of the subgroup generated by a set is the subgroup generated by</span>
<span class="sd">the image of this set. -/</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">G</span> <span class="n">H</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">H</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→*</span> <span class="n">H</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">map</span> <span class="n">f</span> <span class="bp">∘</span> <span class="n">closure</span> <span class="bp">=</span> <span class="n">closure</span> <span class="bp">∘</span> <span class="o">(</span><span class="n">image</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">gc_magic</span> <span class="n">set.image_preimage</span> <span class="o">(</span><span class="n">gc_map_comap</span> <span class="n">f</span><span class="o">)</span> <span class="o">(</span><span class="n">subgroup.gi</span> <span class="n">H</span><span class="o">)</span><span class="bp">.</span><span class="n">gc</span> <span class="o">(</span><span class="n">subgroup.gi</span> <span class="n">G</span><span class="o">)</span><span class="bp">.</span><span class="n">gc</span> <span class="n">rfl</span>
</code></pre></div>



<a name="266293121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293121">(Dec 28 2021 at 21:14)</a>:</h4>
<p>Note that I don't use <code>galois_connection.eq_u</code> and I was too lazy to derive it using the previous one and <code>order_dual</code>.</p>



<a name="266293172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293172">(Dec 28 2021 at 21:15)</a>:</h4>
<p>Those lemmas prove that both sides of a Galois adjunction are characterized by their universal property, this bit already seems to be missing. But the part I really like is <code>gc_magic</code>.</p>



<a name="266293293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293293">(Dec 28 2021 at 21:16)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> do you know whether this is already somewhere?</p>



<a name="266293322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293322">(Dec 28 2021 at 21:17)</a>:</h4>
<p><code>gc_magic</code> looks new to me, I think <a href="https://leanprover-community.github.io/mathlib_docs/find/galois_connection.composw">docs#galois_connection.composw</a> was the only lemma I found about more than one connection</p>



<a name="266293348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293348">(Dec 28 2021 at 21:17)</a>:</h4>
<p>If <code>eq_u</code> and <code>eq_l</code> exist, I know where to find them.</p>



<a name="266293423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293423">(Dec 28 2021 at 21:18)</a>:</h4>
<p>Do they exist as <code>l_eq</code>?</p>



<a name="266293447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293447">(Dec 28 2021 at 21:19)</a>:</h4>
<p>No.</p>



<a name="266293458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293458">(Dec 28 2021 at 21:19)</a>:</h4>
<p>And I should indeed rename those lemmas, I switched sides after naming them.</p>



<a name="266293480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293480">(Dec 28 2021 at 21:19)</a>:</h4>
<p>What about <a href="https://leanprover-community.github.io/mathlib_docs/find/galois_connection.is_least_l">docs#galois_connection.is_least_l</a> ?</p>



<a name="266293544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293544">(Dec 28 2021 at 21:20)</a>:</h4>
<p>It should certainly help</p>



<a name="266293669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293669">(Dec 28 2021 at 21:22)</a>:</h4>
<p>But indeed those specific lemmas eem to be missing, maybe because you're meant to go through the lemma I just gave + the correct <code>is_least</code>/<code>is_greatest</code> lemma (which don't seem to exist either? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span>)</p>



<a name="266293688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266293688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266293688">(Dec 28 2021 at 21:22)</a>:</h4>
<p>At least it would help if it had correct binders <span aria-label="angry" class="emoji emoji-1f620" role="img" title="angry">:angry:</span></p>



<a name="266295490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266295490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266295490">(Dec 28 2021 at 21:52)</a>:</h4>
<p>I don't think the "correct <code>is_least</code>/<code>is_greatest</code> lemma" can exist. Here we also need to use that the set appearing in <a href="https://leanprover-community.github.io/mathlib_docs/find/galois_connection.is_least_l">docs#galois_connection.is_least_l</a> is upward closed.</p>



<a name="266297044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266297044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266297044">(Dec 28 2021 at 22:11)</a>:</h4>
<p>Here's another way to show <code>gc_magic</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">gc_magic</span>
  <span class="o">{</span><span class="n">lYX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">rXY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lYX</span> <span class="n">rXY</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">rZW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">(</span><span class="n">hZW</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWZ</span> <span class="n">rZW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">rYW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">(</span><span class="n">hWY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWY</span> <span class="n">rYW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lZX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">{</span><span class="n">rXZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXZ</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lZX</span> <span class="n">rXZ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">rXY</span> <span class="bp">∘</span> <span class="n">rYW</span> <span class="bp">=</span> <span class="n">rXZ</span> <span class="bp">∘</span> <span class="n">rZW</span><span class="o">)</span> <span class="o">:</span> <span class="n">lWZ</span> <span class="bp">∘</span> <span class="n">lZX</span> <span class="bp">=</span> <span class="n">lWY</span> <span class="bp">∘</span> <span class="n">lYX</span> <span class="o">:=</span>
<span class="n">funext</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">hXZ.compose</span> <span class="n">hZW</span><span class="o">)</span><span class="bp">.</span><span class="n">is_least_l.unique</span> <span class="o">(</span><span class="n">h</span> <span class="bp">▸</span> <span class="o">(</span><span class="n">hXY.compose</span> <span class="n">hWY</span><span class="o">)</span><span class="bp">.</span><span class="n">is_least_l</span><span class="o">)</span>
</code></pre></div>



<a name="266297466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266297466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266297466">(Dec 28 2021 at 22:16)</a>:</h4>
<p>This is nice but less fun in my opinion.</p>



<a name="266297683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266297683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266297683">(Dec 28 2021 at 22:19)</a>:</h4>
<p>The proofs are ultimately the same; they're both an easy case of a general category theory fact. <code>is_least_l</code> characterises the left side of a Galois connection already.</p>



<a name="266297695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266297695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266297695">(Dec 28 2021 at 22:19)</a>:</h4>
<p>Yes, I understand.</p>



<a name="266297704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266297704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266297704">(Dec 28 2021 at 22:19)</a>:</h4>
<p>But I like the <code>calc</code> block</p>



<a name="266298657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266298657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266298657">(Dec 28 2021 at 22:35)</a>:</h4>
<p>Actually the result is even closer to be already here:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.galois_connection</span>


<span class="kd">variables</span>
  <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Y</span><span class="o">]</span>

<span class="kd">variables</span>
  <span class="o">{</span><span class="n">Z</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Z</span><span class="o">]</span> <span class="o">{</span><span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">W</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">l_comm_of_u_comm</span>
  <span class="o">{</span><span class="n">lYX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">uXY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lYX</span> <span class="n">uXY</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">uZW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">(</span><span class="n">hZW</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWZ</span> <span class="n">uZW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">uYW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">(</span><span class="n">hWY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWY</span> <span class="n">uYW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lZX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">{</span><span class="n">uXZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXZ</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lZX</span> <span class="n">uXZ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">uXY</span> <span class="bp">∘</span> <span class="n">uYW</span> <span class="bp">=</span> <span class="n">uXZ</span> <span class="bp">∘</span> <span class="n">uZW</span><span class="o">)</span> <span class="o">:</span> <span class="n">lWZ</span> <span class="bp">∘</span> <span class="n">lZX</span> <span class="bp">=</span> <span class="n">lWY</span> <span class="bp">∘</span> <span class="n">lYX</span> <span class="o">:=</span>
<span class="n">funext</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">hXZ.compose</span> <span class="n">hZW</span><span class="o">)</span><span class="bp">.</span><span class="n">l_unique</span> <span class="o">(</span><span class="n">hXY.compose</span> <span class="n">hWY</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">congr_fun</span> <span class="n">h.symm</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>



<a name="266298802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266298802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266298802">(Dec 28 2021 at 22:38)</a>:</h4>
<p>And if we go for an applied version and commute some equality we get to:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.galois_connection</span>


<span class="kd">variables</span>
  <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Y</span><span class="o">]</span>

<span class="kd">variables</span>
  <span class="o">{</span><span class="n">Z</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">Z</span><span class="o">]</span> <span class="o">{</span><span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">partial_order</span> <span class="n">W</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">l_comm_of_u_comm</span>
  <span class="o">{</span><span class="n">lYX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">uXY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lYX</span> <span class="n">uXY</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">uZW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">(</span><span class="n">hZW</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWZ</span> <span class="n">uZW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lWY</span> <span class="o">:</span> <span class="n">Y</span> <span class="bp">→</span> <span class="n">W</span><span class="o">}</span> <span class="o">{</span><span class="n">uYW</span> <span class="o">:</span> <span class="n">W</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">(</span><span class="n">hWY</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lWY</span> <span class="n">uYW</span><span class="o">)</span>
  <span class="o">{</span><span class="n">lZX</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Z</span><span class="o">}</span> <span class="o">{</span><span class="n">uXZ</span> <span class="o">:</span> <span class="n">Z</span> <span class="bp">→</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hXZ</span> <span class="o">:</span> <span class="n">galois_connection</span> <span class="n">lZX</span> <span class="n">uXZ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">w</span><span class="o">,</span> <span class="n">uXZ</span> <span class="o">(</span><span class="n">uZW</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="n">uXY</span> <span class="o">(</span><span class="n">uYW</span> <span class="n">w</span><span class="o">))</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">:</span> <span class="n">lWZ</span> <span class="o">(</span><span class="n">lZX</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">lWY</span> <span class="o">(</span><span class="n">lYX</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">hXZ.compose</span> <span class="n">hZW</span><span class="o">)</span><span class="bp">.</span><span class="n">l_unique</span> <span class="o">(</span><span class="n">hXY.compose</span> <span class="n">hWY</span><span class="o">)</span> <span class="n">h</span>
</code></pre></div>



<a name="266298825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266298825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266298825">(Dec 28 2021 at 22:39)</a>:</h4>
<p>Maybe I'm starting to like that way of telling the story.</p>



<a name="266299205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266299205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266299205">(Dec 28 2021 at 22:46)</a>:</h4>
<p>Fun fact: X and Z only need preorders here.</p>



<a name="266299254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266299254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266299254">(Dec 28 2021 at 22:47)</a>:</h4>
<p>Clearly I'm having way too much fun with this stuff. I should stop and go to bed.</p>



<a name="266299556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266299556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266299556">(Dec 28 2021 at 22:53)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/11114">#11114</a>. I still kept my <code>le_eq</code> and <code>u_eq</code> lemmas just in case they turn out to be useful for something else. Concerning applications, I only replaced the subgroup proof.</p>



<a name="266301684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%28l%E2%82%81%20S%29.map%20%CF%83%20%E2%89%A4%20l%E2%82%82%20%28S.map%20%E2%87%91%CF%83%29/near/266301684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/(l.E2.82.81.20S).2Emap.20.CF.83.20.E2.89.A4.20l.E2.82.82.20(S.2Emap.20.E2.87.91.CF.83).html#266301684">(Dec 28 2021 at 23:31)</a>:</h4>
<p>This is really nice. Thanks!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>