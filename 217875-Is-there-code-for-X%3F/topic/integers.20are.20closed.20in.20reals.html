---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html">integers are closed in reals</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="237699571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699571">(May 06 2021 at 17:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">topology.instances.real</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">z</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>Is there a statement like this in mathlib somewhere?</p>



<a name="237699737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699737">(May 06 2021 at 17:43)</a>:</h4>
<p>It's called is_closed.eq or something like that... Works with t2 instance</p>



<a name="237699824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699824">(May 06 2021 at 17:44)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/is_closed_eq">docs#is_closed_eq</a></p>



<a name="237699841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699841">(May 06 2021 at 17:44)</a>:</h4>
<p>Ah wait not quite, but should be easy with that</p>



<a name="237699855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699855">(May 06 2021 at 17:44)</a>:</h4>
<p>I don't think that applies here -- right</p>



<a name="237699960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237699960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237699960">(May 06 2021 at 17:45)</a>:</h4>
<p>Oh that's a Z, sorry yeah that's a bit different</p>



<a name="237700264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237700264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237700264">(May 06 2021 at 17:47)</a>:</h4>
<p>Presumably the correct formulation is to have a closed embedding from Z to R</p>



<a name="237700630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237700630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237700630">(May 06 2021 at 17:50)</a>:</h4>
<p>Here's how I ended up doing it:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">z</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span><span class="n">is_open_compl_iff</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">z</span><span class="o">}</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="bp">⋃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">Ioo</span> <span class="n">z</span> <span class="o">(</span><span class="n">z</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">ext</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">not_exists</span><span class="o">,</span> <span class="n">mem_Union</span><span class="o">,</span> <span class="n">mem_Ioo</span><span class="o">,</span> <span class="n">mem_set_of_eq</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">q</span><span class="o">,</span>
      <span class="n">refine</span> <span class="o">⟨</span><span class="n">floor</span> <span class="n">x</span><span class="o">,</span> <span class="n">lt_of_le_of_ne</span> <span class="o">(</span><span class="n">floor_le</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">ne.symm</span> <span class="o">(</span><span class="n">q</span> <span class="n">_</span><span class="o">)),</span> <span class="n">_</span><span class="o">⟩,</span>
      <span class="n">apply</span> <span class="n">lt_floor_add_one</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz₁</span><span class="o">,</span> <span class="n">hz₂</span><span class="o">⟩</span> <span class="n">y</span> <span class="n">rfl</span><span class="o">,</span>
      <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">hz₁</span> <span class="n">hz₂</span><span class="o">,</span>
      <span class="n">linarith</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_open_Union</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">is_open_Ioo</span><span class="o">),</span>
<span class="kd">end</span>
</code></pre></div>



<a name="237720579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237720579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237720579">(May 06 2021 at 20:07)</a>:</h4>
<p>I wanted to have a quick look at Zulip before resuming work after dinner. I saw this. I thought I should do it properly. Then I found a couple of API holes (also called rabbit holes). One hour later...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">topology.instances.real</span>

<span class="n">open_locale</span> <span class="n">topological_space</span> <span class="n">uniformity</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">uniform_space</span> <span class="n">set</span>

<span class="kd">lemma</span> <span class="n">uniform_space.mem_closure_iff_symm_ball</span>  <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">closure</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">V</span><span class="o">},</span> <span class="n">V</span> <span class="bp">∈</span> <span class="bp">𝓤</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">symmetric_rel</span> <span class="n">V</span> <span class="bp">→</span> <span class="o">(</span><span class="n">s</span> <span class="bp">∩</span> <span class="n">ball</span> <span class="n">x</span> <span class="n">V</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mem_closure_iff_nhds_basis</span> <span class="o">(</span><span class="n">has_basis_nhds</span> <span class="n">x</span><span class="o">)],</span>
  <span class="n">tauto</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">uniform_space.mem_closure_iff_ball</span>  <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">closure</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">V</span><span class="o">},</span> <span class="n">V</span> <span class="bp">∈</span> <span class="bp">𝓤</span> <span class="n">X</span> <span class="bp">→</span> <span class="o">(</span><span class="n">ball</span> <span class="n">x</span> <span class="n">V</span> <span class="bp">∩</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">nonempty</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp_rw</span> <span class="o">[</span><span class="n">mem_closure_iff_nhds</span><span class="o">,</span> <span class="n">mem_nhds_iff</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span> <span class="n">V</span> <span class="n">V_in</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h</span> <span class="o">(</span><span class="n">ball</span> <span class="n">x</span> <span class="n">V</span><span class="o">)</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">V_in</span><span class="o">,</span> <span class="n">subset.refl</span> <span class="n">_</span><span class="o">⟩</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="n">h</span> <span class="n">t</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">V_in</span><span class="o">,</span> <span class="n">Vt</span><span class="o">⟩,</span>
    <span class="n">exact</span> <span class="n">nonempty.mono</span> <span class="o">(</span><span class="n">inter_subset_inter_left</span> <span class="n">s</span> <span class="n">Vt</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="n">V_in</span><span class="o">)</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">eq_of_uniformity</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">separated_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">V</span><span class="o">},</span> <span class="n">V</span> <span class="bp">∈</span> <span class="bp">𝓤</span> <span class="n">X</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">separated_def.mp</span> <span class="o">‹</span><span class="n">separated_space</span> <span class="n">X</span><span class="o">›</span> <span class="n">x</span> <span class="n">y</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">h</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">eq_of_uniformity_basis</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">separated_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
  <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">set</span> <span class="o">(</span><span class="n">X</span> <span class="bp">×</span> <span class="n">X</span><span class="o">)}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="o">(</span><span class="bp">𝓤</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">has_basis</span> <span class="n">p</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span><span class="o">},</span> <span class="n">p</span> <span class="n">i</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">s</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">eq_of_uniformity</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">V</span> <span class="n">V_in</span><span class="o">,</span> <span class="k">let</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">H</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hs.mem_iff.mp</span> <span class="n">V_in</span> <span class="k">in</span> <span class="n">H</span> <span class="o">(</span><span class="n">h</span> <span class="n">hi</span><span class="o">))</span>

<span class="kd">lemma</span> <span class="n">eq_of_forall_symmetric</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">separated_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">V</span><span class="o">},</span> <span class="n">V</span> <span class="bp">∈</span> <span class="bp">𝓤</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">symmetric_rel</span> <span class="n">V</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">V</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">eq_of_uniformity_basis</span> <span class="n">has_basis_symmetric</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">and_imp</span><span class="o">]</span> <span class="n">using</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">h</span><span class="o">)</span>

<span class="kn">open</span> <span class="n">uniform_space</span>

<span class="kd">lemma</span> <span class="n">ball_inter_left</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="n">W</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">β</span> <span class="bp">×</span> <span class="n">β</span><span class="o">))</span> <span class="o">:</span> <span class="n">ball</span> <span class="n">x</span> <span class="o">(</span><span class="n">V</span> <span class="bp">∩</span> <span class="n">W</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">ball</span> <span class="n">x</span> <span class="n">V</span> <span class="o">:=</span>
<span class="n">ball_mono</span> <span class="o">(</span><span class="n">inter_subset_left</span> <span class="n">V</span> <span class="n">W</span><span class="o">)</span> <span class="n">x</span>

<span class="kd">lemma</span> <span class="n">ball_inter_right</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="n">W</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">β</span> <span class="bp">×</span> <span class="n">β</span><span class="o">))</span> <span class="o">:</span> <span class="n">ball</span> <span class="n">x</span> <span class="o">(</span><span class="n">V</span> <span class="bp">∩</span> <span class="n">W</span><span class="o">)</span> <span class="bp">⊆</span> <span class="n">ball</span> <span class="n">x</span> <span class="n">W</span> <span class="o">:=</span>
<span class="n">ball_mono</span> <span class="o">(</span><span class="n">inter_subset_right</span> <span class="n">V</span> <span class="n">W</span><span class="o">)</span> <span class="n">x</span>

<span class="kd">lemma</span> <span class="n">is_closed_of_spaced_out</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">separated_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">{</span><span class="n">V₀</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">X</span> <span class="bp">×</span> <span class="n">X</span><span class="o">)}</span>
  <span class="o">(</span><span class="n">V₀_in</span> <span class="o">:</span> <span class="n">V₀</span> <span class="bp">∈</span> <span class="bp">𝓤</span> <span class="n">X</span><span class="o">)</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">},</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">V₀</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
<span class="n">is_closed</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">comp_symm_mem_uniformity_sets</span> <span class="n">V₀_in</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">V₁</span><span class="o">,</span> <span class="n">V₁_in</span><span class="o">,</span> <span class="n">V₁_symm</span><span class="o">,</span> <span class="n">h_comp</span><span class="o">⟩,</span>
  <span class="n">apply</span> <span class="n">is_closed_of_closure_subset</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mem_closure_iff_ball</span><span class="o">]</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hx</span> <span class="n">V₁_in</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="o">,</span> <span class="n">hy'</span><span class="o">⟩,</span>
  <span class="k">suffices</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_forall_symmetric</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">V</span> <span class="n">V_in</span> <span class="n">V_symm</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hx</span> <span class="o">(</span><span class="n">inter_mem_sets</span> <span class="n">V₁_in</span> <span class="n">V_in</span><span class="o">)</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="o">,</span> <span class="n">hz'</span><span class="o">⟩,</span>
  <span class="k">suffices</span> <span class="o">:</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">y</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ball_inter_right</span> <span class="n">x</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hz</span> <span class="o">},</span>
  <span class="n">exact</span> <span class="n">hs</span> <span class="n">hz'</span> <span class="n">hy'</span> <span class="o">(</span><span class="n">h_comp</span> <span class="bp">$</span> <span class="n">mem_comp_of_mem_ball</span> <span class="n">V₁_symm</span> <span class="o">(</span><span class="n">ball_inter_left</span> <span class="n">x</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hz</span><span class="o">)</span> <span class="n">hy</span><span class="o">)</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">n</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">is_closed_of_spaced_out</span> <span class="o">(</span><span class="n">metric.uniformity_basis_dist.mem_of_mem</span> <span class="bp">$</span> <span class="n">one_half_pos</span><span class="o">)</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rintros</span> <span class="bp">-</span> <span class="bp">-</span> <span class="o">⟨</span><span class="n">p</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">q</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">abs</span> <span class="o">(</span><span class="n">p</span> <span class="bp">-</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">),</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="c">/-</span><span class="cm"></span>
<span class="cm">  p q : ℤ,</span>
<span class="cm">  h : (abs (p - q) : ℝ) &lt; 1 / 2</span>
<span class="cm">  ⊢ p = q</span>
<span class="cm">  -/</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="237722538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237722538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237722538">(May 06 2021 at 20:23)</a>:</h4>
<p>If I remember correctly, there is a lemma that says that an integer of absolute value less than one is zero, though it might be for <code>nat.abs</code>.  I'm on mobile, though</p>



<a name="237722877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237722877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237722877">(May 06 2021 at 20:25)</a>:</h4>
<p>I certainly hope this sorry is provable. But I have no interest at all in proving it. All the fun is above the example.</p>



<a name="237723482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237723482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237723482">(May 06 2021 at 20:31)</a>:</h4>
<p>Sure, I just felt proud, since I think that the lemma about abs was my first PRed <code>simp</code> lemma!  <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="237724193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237724193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237724193">(May 06 2021 at 20:36)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/data/int/basic.html#int.eq_zero_iff_abs_lt_one">https://leanprover-community.github.io/mathlib_docs/data/int/basic.html#int.eq_zero_iff_abs_lt_one</a></p>



<a name="237724439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237724439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237724439">(May 06 2021 at 20:37)</a>:</h4>
<p>You never forget your first simp lemma...</p>



<a name="237724668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237724668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237724668">(May 06 2021 at 20:39)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">n</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">is_closed_of_spaced_out</span> <span class="o">(</span><span class="n">metric.uniformity_basis_dist.mem_of_mem</span> <span class="bp">$</span> <span class="n">zero_lt_one</span><span class="o">)</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rintros</span> <span class="bp">-</span> <span class="bp">-</span> <span class="o">⟨</span><span class="n">p</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">q</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">abs</span> <span class="o">(</span><span class="n">p</span> <span class="bp">-</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="o">),</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq_of_sub_eq_zero</span> <span class="o">(</span><span class="n">int.eq_zero_iff_abs_lt_one.mp</span> <span class="n">h</span><span class="o">)</span>
<span class="kd">end</span>
</code></pre></div>



<a name="237724685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237724685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237724685">(May 06 2021 at 20:39)</a>:</h4>
<p>Indeed it does the job</p>



<a name="237724747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237724747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237724747">(May 06 2021 at 20:40)</a>:</h4>
<p>Note that I opened <a href="https://github.com/leanprover-community/mathlib/issues/7538">#7538</a> containing all preliminaries for the above proof.</p>



<a name="237743250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/integers%20are%20closed%20in%20reals/near/237743250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/integers.20are.20closed.20in.20reals.html#237743250">(May 06 2021 at 22:59)</a>:</h4>
<p>Nice! I also used <a href="https://leanprover-community.github.io/mathlib_docs/find/int.eq_zero_iff_abs_lt_one">docs#int.eq_zero_iff_abs_lt_one</a> for similar proofs :D</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>