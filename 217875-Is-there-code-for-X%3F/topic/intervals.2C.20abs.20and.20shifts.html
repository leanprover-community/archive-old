---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html">intervals, abs and shifts</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="220213217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220213217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220213217">(Dec 17 2020 at 07:17)</a>:</h4>
<p>In the course of reviewing a PR (<a href="https://github.com/leanprover-community/mathlib/issues/5361">#5361</a>), I needed the lemmas below.  Do they already appear?  What would be a good home?  As I have not used very much the side of mathlib with <code>Icc</code>s and the like, I do not really know where they could go.</p>
<p>Any suggestions would be very much appreciated!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- A lemma relating a compact interval and its shifts. -/</span>
<span class="kd">lemma</span> <span class="n">sub_mem_Icc_iff</span> <span class="o">(</span><span class="n">α</span> <span class="n">i</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">α</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="n">i</span> <span class="bp">↔</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="n">α</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">α</span> <span class="bp">+</span> <span class="n">i</span><span class="o">))</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span>
  <span class="o">⟨</span><span class="n">sub_le_iff_le_add.mpr</span> <span class="o">(</span><span class="n">neg_le_sub_iff_le_add.mp</span> <span class="n">a.1</span><span class="o">),</span> <span class="n">sub_le_iff_le_add.mp</span> <span class="o">(</span><span class="n">sub_le.mpr</span> <span class="n">a.2</span><span class="o">)⟩,</span>
  <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="o">⟨</span><span class="n">neg_le_sub_iff_le_add.mpr</span> <span class="o">(</span><span class="n">sub_le_iff_le_add.mp</span> <span class="n">a.1</span><span class="o">)</span> <span class="o">,</span> <span class="n">sub_le_iff_le_add'.mpr</span> <span class="n">a.2</span><span class="o">⟩⟩</span>

<span class="sd">/-- A lemma describing a compact interval via absolute values. -/</span>
<span class="kd">lemma</span> <span class="n">abs_le_iff_mem_Icc</span> <span class="o">(</span><span class="n">α</span> <span class="n">i</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">abs</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">α</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">i</span> <span class="bp">↔</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="n">α</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">α</span> <span class="bp">+</span> <span class="n">i</span><span class="o">))</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">⟨</span><span class="n">sub_le_of_abs_sub_le_left</span> <span class="n">h</span><span class="o">,</span> <span class="n">sub_le_iff_le_add'.mp</span> <span class="o">(</span><span class="n">abs_le.mp</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">⟩,</span>
  <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">abs_le.mpr</span> <span class="o">((</span><span class="n">sub_mem_Icc_iff</span> <span class="n">α</span> <span class="n">i</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">h</span><span class="o">)⟩</span>

<span class="sd">/-- An element of an open interval is closer to the left end-point than</span>
<span class="sd">the length of the interval. -/</span>
<span class="kd">lemma</span> <span class="n">abs_lt_abs_left</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">abs</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">abs</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">abs_lt</span><span class="o">,</span> <span class="n">neg_lt</span><span class="o">,</span> <span class="n">lt_abs</span><span class="o">,</span> <span class="n">lt_abs</span><span class="o">,</span> <span class="n">neg_sub</span><span class="o">,</span> <span class="n">neg_sub</span><span class="o">],</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">or.inr</span> <span class="o">(</span><span class="n">sub_lt_sub_right</span> <span class="n">hc.2</span> <span class="n">a</span><span class="o">),</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">sub_lt_sub</span> <span class="o">(</span><span class="n">lt_trans</span> <span class="n">hc.1</span> <span class="n">hc.2</span><span class="o">)</span> <span class="n">hc.1</span><span class="o">)⟩,</span>
<span class="kd">end</span>

<span class="sd">/-- An element of an open interval is closer to the right end-point than</span>
<span class="sd">the length of the interval. -/</span>
<span class="kd">lemma</span> <span class="n">abs_lt_abs_right</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">abs</span> <span class="o">(</span><span class="n">c</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">abs</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">abs_sub</span><span class="o">,</span> <span class="n">sub_eq_neg_add</span><span class="o">,</span> <span class="n">sub_eq_neg_add</span><span class="o">,</span> <span class="bp">←</span> <span class="n">neg_neg</span> <span class="n">b</span><span class="o">,</span> <span class="bp">←</span> <span class="n">neg_neg</span> <span class="n">a</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">abs_lt_abs_left</span> <span class="o">⟨</span><span class="n">neg_lt_neg_iff.mpr</span> <span class="n">hc.2</span><span class="o">,</span> <span class="n">neg_lt_neg_iff.mpr</span> <span class="n">hc.1</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="220287895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220287895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220287895">(Dec 17 2020 at 19:11)</a>:</h4>
<p>Is there any reason to use <code>Icc (- i) i</code> instead of an arbitrary <code>Icc</code> in the first lemma?</p>



<a name="220290292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220290292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220290292">(Dec 17 2020 at 19:29)</a>:</h4>
<p>No real reason other than a lot of the arguments use "symmetric" intervals.  I can definitely change this with virtually no effort!</p>



<a name="220340129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220340129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220340129">(Dec 18 2020 at 06:10)</a>:</h4>
<p>Below are a version of the first lemma above, with arbitrary endpoints and a proof of the symmetric one as a consequence.</p>
<p>Is there a preference between the <code>simp only</code> proof and the term mode proof in <code>sub_mem_Icc_iff</code>?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- A lemma relating a compact interval and its shifts. -/</span>
<span class="kd">lemma</span> <span class="n">sub_mem_Icc_iff</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">l</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="n">l</span> <span class="n">m</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">m</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">le_sub_iff_add_le'</span><span class="o">,</span> <span class="n">sub_le_iff_le_add'</span><span class="o">,</span> <span class="n">iff_self</span><span class="o">,</span> <span class="n">mem_Icc</span><span class="o">]</span>
<span class="c1">--⟨λ a, ⟨le_sub_iff_add_le'.mp a.1, sub_le_iff_le_add'.mp a.2⟩,</span>
<span class="c1">--    λ b, ⟨le_sub_iff_add_le'.mpr b.1, sub_le_iff_le_add'.mpr b.2⟩⟩</span>

<span class="sd">/-- A lemma relating a symmetric compact interval and its shifts. -/</span>
<span class="kd">lemma</span> <span class="n">sub_mem_Icc_iff_symmetric</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="n">z</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">Icc</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">sub_mem_Icc_iff</span><span class="o">,</span> <span class="n">tactic.ring.add_neg_eq_sub</span> <span class="n">y</span> <span class="n">z</span><span class="o">]</span>
</code></pre></div>



<a name="220350473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220350473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220350473">(Dec 18 2020 at 09:24)</a>:</h4>
<p>The statement of the former would seem more natural to me with the + terms on the right commuted</p>



<a name="220350566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220350566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220350566">(Dec 18 2020 at 09:25)</a>:</h4>
<p>You mean <code>lemma sub_mem_Icc_iff (x y l m : ℝ) : (x - y ∈ Icc l m ↔ x ∈ Icc (l + y) (m + y))</code>?</p>



<a name="220350685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220350685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220350685">(Dec 18 2020 at 09:26)</a>:</h4>
<p>Also I'm surprised <code>add_neg_eq_sub</code> is hidden away in <code>tactic.ring</code> as <a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.ring.add_neg_eq_sub">docs#tactic.ring.add_neg_eq_sub</a>. is there a more public name?</p>



<a name="220350730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220350730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220350730">(Dec 18 2020 at 09:27)</a>:</h4>
<p>I was also surprised by this, but I could not find it and <code>library_search</code> gave me... that!</p>



<a name="220350787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220350787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220350787">(Dec 18 2020 at 09:28)</a>:</h4>
<p><code>sub_eq_add_neg</code></p>



<a name="220351611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/intervals%2C%20abs%20and%20shifts/near/220351611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/intervals.2C.20abs.20and.20shifts.html#220351611">(Dec 18 2020 at 09:36)</a>:</h4>
<p>Reassuringly the <code>ring</code> one is just written in terms of that one</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>