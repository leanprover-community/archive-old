---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html">finset.extend_by_zero variant</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="250020484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250020484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250020484">(Aug 19 2021 at 17:42)</a>:</h4>
<p>Is something like this already somewhere? I didn't see anything in <code>algebra.big_operators.basic</code>.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">finset.sum_extend_by_zero'</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="bp">∈</span> <span class="n">s</span><span class="o">)]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="k">then</span> <span class="n">f</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">finset.sum_add_sum_compl</span> <span class="n">s</span> <span class="n">_</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span> <span class="n">s</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="bp">∅</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">finset.sum_ite</span><span class="o">,</span> <span class="n">this</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="250020523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250020523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250020523">(Aug 19 2021 at 17:42)</a>:</h4>
<p>Yes there is something close</p>



<a name="250020847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250020847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250020847">(Aug 19 2021 at 17:44)</a>:</h4>
<p>!docs#finset.sum_extend_by_zero</p>



<a name="250020863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250020863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250020863">(Aug 19 2021 at 17:45)</a>:</h4>
<p>Argh! Not on Discord.</p>



<a name="250021065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250021065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250021065">(Aug 19 2021 at 17:46)</a>:</h4>
<p>Is this what you were looking for?</p>



<a name="250021223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250021223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250021223">(Aug 19 2021 at 17:47)</a>:</h4>
<p>That lemma's why this got a <code>'</code> -- I want to change the bounds of the sum to <code>finset.univ</code></p>



<a name="250021385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250021385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250021385">(Aug 19 2021 at 17:48)</a>:</h4>
<p>I guess it could also be a <code>finset.sum_subset_extend</code>, where you can extend the bound while introducing an <code>ite</code>.</p>



<a name="250021411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250021411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250021411">(Aug 19 2021 at 17:49)</a>:</h4>
<p>Ah yeah I assume not then.</p>



<a name="250022137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250022137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250022137">(Aug 19 2021 at 17:54)</a>:</h4>
<p>Does it exist if you phrase it in terms of <a href="https://leanprover-community.github.io/mathlib_docs/find/set.indicator">docs#set.indicator</a>?</p>



<a name="250022796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250022796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250022796">(Aug 19 2021 at 17:59)</a>:</h4>
<p>I'd forgotten about that function, but I don't see anything.</p>
<p>Maybe another question is whether there's something pre-existing for the following <code>finset.sum_subset_extend</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">finset.sum_subset_extend</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">{</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="bp">∈</span> <span class="n">s</span><span class="o">)]</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">⊆</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">t</span><span class="o">,</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="k">then</span> <span class="n">f</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">finset.sum_subset</span> <span class="n">h</span><span class="o">,</span> <span class="bp">←</span><span class="n">finset.sum_attach</span><span class="o">],</span>
  <span class="n">swap</span><span class="o">,</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">ht</span> <span class="n">hs</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hs</span><span class="o">],</span>
  <span class="n">nth_rewrite</span> <span class="mi">1</span> <span class="bp">←</span><span class="n">finset.sum_attach</span><span class="o">,</span>
  <span class="n">congr</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">finset.extend_by_zero'</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="bp">∈</span> <span class="n">s</span><span class="o">)]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="k">then</span> <span class="n">f</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">rw</span> <span class="n">sum_subset_extend</span> <span class="o">(</span><span class="n">subset_univ</span> <span class="n">s</span><span class="o">)</span>
</code></pre></div>



<a name="250023503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250023503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250023503">(Aug 19 2021 at 18:03)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/set.sum_indicator_subset">docs#set.sum_indicator_subset</a>?</p>



<a name="250025485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250025485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250025485">(Aug 19 2021 at 18:16)</a>:</h4>
<p>Thanks, <code>sum_extend_by_zero'</code> is equivalent to the following dance:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rw</span> <span class="n">set.sum_indicator_subset</span> <span class="n">_</span> <span class="o">(</span><span class="n">subset_univ</span> <span class="n">_</span><span class="o">),</span>
<span class="n">simp_rw</span> <span class="o">[</span><span class="n">set.indicator_apply</span><span class="o">,</span> <span class="n">mem_coe</span><span class="o">],</span>
</code></pre></div>



<a name="250026781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250026781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250026781">(Aug 19 2021 at 18:24)</a>:</h4>
<p>Is <code>refl</code> not enough to close the goal after the rw?</p>



<a name="250027111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250027111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250027111">(Aug 19 2021 at 18:26)</a>:</h4>
<p>It's mid-proof.  I wanted <code>finset.sum_extend_by_zero'</code> specifically to get a sum into a particular form.</p>



<a name="250027400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250027400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250027400">(Aug 19 2021 at 18:28)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/7d8fc747f273c0be4f7a3f384c43cb69320daeec/src/combinatorics/simple_graph/adj_matrix.lean#L183">https://github.com/leanprover-community/mathlib/blob/7d8fc747f273c0be4f7a3f384c43cb69320daeec/src/combinatorics/simple_graph/adj_matrix.lean#L183</a></p>



<a name="250039461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250039461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250039461">(Aug 19 2021 at 19:47)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.indicator_function</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="kd">lemma</span> <span class="n">finset.sum_extend_by_zero'</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="o">(</span><span class="bp">∈</span> <span class="n">s</span><span class="o">)]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">s</span> <span class="k">then</span> <span class="n">f</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">convert</span> <span class="n">set.sum_indicator_subset</span> <span class="n">_</span> <span class="o">(</span><span class="n">finset.subset_univ</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">ext</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">congr</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>was what I was thinking of</p>



<a name="250039496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250039496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250039496">(Aug 19 2021 at 19:47)</a>:</h4>
<p>I guess<code>set.indicator</code> is unpleasant here because it has the wrong decidable instance</p>



<a name="250039821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250039821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250039821">(Aug 19 2021 at 19:49)</a>:</h4>
<p>So I guess we should rewrite every proof in the file about <code>set.indicator</code> to be about <code>ite</code>, and then reprove the <code>indicator</code> / <code>classical.decidable</code> version as a special case?</p>



<a name="250041693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/250041693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#250041693">(Aug 19 2021 at 20:02)</a>:</h4>
<p>Another pain point is that <code>set.indicator</code> is for sets, but these are finsets. <span class="user-mention" data-user-id="310045">@Eric Wieser</span> Have you thought about making <code>finset</code> a <code>set_like</code>? Then <code>indicator</code> could be generalized for any <code>set_like</code>, and the <code>set.indicator_apply</code> lemma could put things in terms of the correct <code>has_mem</code>.</p>



<a name="256748701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256748701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256748701">(Oct 08 2021 at 14:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/finset.2Eextend_by_zero.20variant/near/250039496">said</a>:</p>
<blockquote>
<p>I guess<code>set.indicator</code> is unpleasant here because it has the wrong decidable instance</p>
</blockquote>
<p>I was just using <code>set.indicator</code> and discovered that it contains <code>classical</code> decidability instances in its definition. This should be fixed, right?</p>



<a name="256749226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256749226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256749226">(Oct 08 2021 at 14:35)</a>:</h4>
<p><code>classical</code> decidability instances in definitions are a deliberate design choice</p>



<a name="256749282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256749282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256749282">(Oct 08 2021 at 14:36)</a>:</h4>
<p>They just should never appear directly in lemmas</p>



<a name="256749395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256749395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256749395">(Oct 08 2021 at 14:36)</a>:</h4>
<p>If a decidability instance in a <em>definition</em> is tripping you up, then either:</p>
<ul>
<li>Your use case requires definitional equality and you're probably in for a bad time anyway</li>
<li>You're unfolding when you should be using API</li>
</ul>



<a name="256749538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256749538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256749538">(Oct 08 2021 at 14:37)</a>:</h4>
<p>OK thanks, let me see if I can resolve my situation with this useful guide.</p>



<a name="256751448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/finset.extend_by_zero%20variant/near/256751448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/finset.2Eextend_by_zero.20variant.html#256751448">(Oct 08 2021 at 14:50)</a>:</h4>
<p>FWIW I just used the same pattern as your example above: <code>convert</code>, <code>ext</code>, <code>congr</code> instead of <code>exact</code>: <a href="https://github.com/leanprover-community/mathlib/pull/9629/files#diff-ece920d3095b577efda5ca995226b64d018390dfbefdb264722220712d38682bR727">https://github.com/leanprover-community/mathlib/pull/9629/files#diff-ece920d3095b577efda5ca995226b64d018390dfbefdb264722220712d38682bR727</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>