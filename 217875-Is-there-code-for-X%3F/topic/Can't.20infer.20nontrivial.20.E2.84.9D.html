---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html">Can't infer nontrivial ℝ</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="296426831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296426831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296426831">(Aug 31 2022 at 18:41)</a>:</h4>
<p>Just started exploring the analysis part of mathlib. Why can't Lean infer the instance <code>nontrivial ℝ</code>? How would you prove this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">lt_div_iff</span> <span class="n">zero_lt_two</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">zero_mul</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hr</span><span class="o">,</span>
  <span class="n">apply_instance</span> <span class="c1">-- why can't Lean infer nontrivial ℝ?</span>
<span class="kd">end</span>
</code></pre></div>



<a name="296426939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296426939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296426939">(Aug 31 2022 at 18:41)</a>:</h4>
<p>Can you include imports?</p>



<a name="296426975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296426975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296426975">(Aug 31 2022 at 18:41)</a>:</h4>
<p>(sorry, I meant to post this on #general)</p>



<a name="296427057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296427057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296427057">(Aug 31 2022 at 18:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">geometry.manifold.mfderiv</span>
<span class="kn">import</span> <span class="n">analysis.ODE.picard_lindelof</span>
</code></pre></div>



<a name="296427147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296427147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296427147">(Aug 31 2022 at 18:42)</a>:</h4>
<p>Same behaviour with just:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.ODE.picard_lindelof</span>
</code></pre></div>



<a name="296427606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296427606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296427606">(Aug 31 2022 at 18:45)</a>:</h4>
<p>I'm finding that</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.ODE.picard_lindelof</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">lt_div_iff</span> <span class="n">zero_lt_two</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">zero_mul</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hr</span><span class="o">,</span>
  <span class="n">apply_instance</span>
<span class="kd">end</span>
</code></pre></div>
<p>works just fine on a recent mathlib</p>



<a name="296427712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296427712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296427712">(Aug 31 2022 at 18:45)</a>:</h4>
<p>When you mean "why can't Lean infer nontrivial ℝ?", do you mean "why am I presented this goal?"?</p>



<a name="296428411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296428411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296428411">(Aug 31 2022 at 18:49)</a>:</h4>
<p>I've never really understood what causes <code>rw</code> to need to introduce instance goals (especially since there are a number of others here that it seems to find just fine), but giving it a hint that the lemma is about the reals helps it out:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hr</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">r</span> <span class="bp">/</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">lt_div_iff</span> <span class="o">(</span><span class="n">zero_lt_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">zero_mul</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hr</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="296429237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296429237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296429237">(Aug 31 2022 at 18:54)</a>:</h4>
<p>This is a recurring problem with the <code>zero_lt_...</code> lemmas, so I'm adding a version with the type explicit in <a href="https://github.com/leanprover-community/mathlib/pull/16172">#16172</a>.</p>



<a name="296429962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296429962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296429962">(Aug 31 2022 at 18:58)</a>:</h4>
<p><code>linarith</code> also works :)</p>



<a name="296430059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296430059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296430059">(Aug 31 2022 at 18:59)</a>:</h4>
<p>Or just <a href="https://leanprover-community.github.io/mathlib_docs/find/half_pos">docs#half_pos</a></p>



<a name="296430083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296430083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296430083">(Aug 31 2022 at 18:59)</a>:</h4>
<p>but who can remember that?!</p>



<a name="296430109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296430109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296430109">(Aug 31 2022 at 18:59)</a>:</h4>
<p>Me, in fact <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="296431013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296431013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296431013">(Aug 31 2022 at 19:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D/near/296427712">said</a>:</p>
<blockquote>
<p>When you mean "why can't Lean infer nontrivial ℝ?", do you mean "why am I presented this goal?"?</p>
</blockquote>
<p>Yeah. Why would Lean present me with this goal when <code>apply_instance</code> ends up finding it with no extra steps anyway?</p>



<a name="296431112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296431112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296431112">(Aug 31 2022 at 19:05)</a>:</h4>
<p>In the past when I've seen this behaviour it was because my own lemma included an unnecessary / unused typeclass variable</p>



<a name="296431185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Can%27t%20infer%20nontrivial%20%E2%84%9D/near/296431185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Can't.20infer.20nontrivial.20.E2.84.9D.html#296431185">(Aug 31 2022 at 19:05)</a>:</h4>
<p>I think the reason has to do with the internals of how <code>rw</code> fills in metavariables.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>