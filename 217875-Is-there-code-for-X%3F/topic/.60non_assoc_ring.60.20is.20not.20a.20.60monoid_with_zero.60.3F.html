---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html">`non_assoc_ring` is not a `monoid_with_zero`?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="308823585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308823585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308823585">(Nov 09 2022 at 16:29)</a>:</h4>
<p>I was just trying to use a result that wants a <code>monoid_with_zero</code> on a <code>non_assoc_ring</code>, but I get the complaint <code>failed to synthesize type class instance</code>. Looking at <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_with_zero">docs#monoid_with_zero</a> and the instances listed there, I see <code>semiring.to_monoid_with_zero</code>, but not <code>non_assoc_ring.to_monoid_with_zero</code> (or <code>non_assoc_semiring.to_monoid_with_zero</code>). Is this a gap in mathlib?</p>



<a name="308823938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308823938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308823938">(Nov 09 2022 at 16:30)</a>:</h4>
<p>Monoids are by definition associative, right? <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid_with_zero.mul_assoc">docs#monoid_with_zero.mul_assoc</a></p>



<a name="308824399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308824399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308824399">(Nov 09 2022 at 16:33)</a>:</h4>
<p>OK, of course! I was trying to generalize a result that I want for the integers (but involves only 0, 1 and -1) as far as possible, but it seems I went to far...</p>



<a name="308824589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308824589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308824589">(Nov 09 2022 at 16:34)</a>:</h4>
<p>We have <a href="https://leanprover-community.github.io/mathlib_docs/find/non_assoc_semiring.to_mul_zero_one_class">docs#non_assoc_semiring.to_mul_zero_one_class</a> though</p>



<a name="308824724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308824724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308824724">(Nov 09 2022 at 16:34)</a>:</h4>
<p>But this is not enough, since I need <code>-1</code>.</p>



<a name="308825103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825103">(Nov 09 2022 at 16:36)</a>:</h4>
<p>So I'm using <code>ring</code> now instead...</p>



<a name="308825157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825157">(Nov 09 2022 at 16:37)</a>:</h4>
<p>Or is there something like a <code>monoid_with_zero_and_negation</code>?</p>



<a name="308825487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825487">(Nov 09 2022 at 16:38)</a>:</h4>
<p>maybe <a href="https://leanprover-community.github.io/mathlib_docs/find/has_distrib_neg">docs#has_distrib_neg</a> in addition?</p>



<a name="308825549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825549">(Nov 09 2022 at 16:39)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/non_unital_non_assoc_ring.to_has_distrib_neg">docs#non_unital_non_assoc_ring.to_has_distrib_neg</a></p>



<a name="308825690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825690">(Nov 09 2022 at 16:39)</a>:</h4>
<p>OK, I'll try that after finishing the proof!</p>



<a name="308825737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825737">(Nov 09 2022 at 16:39)</a>:</h4>
<p>Thus is the thing you didn't want to use sign_type for, right?</p>



<a name="308825965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308825965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308825965">(Nov 09 2022 at 16:40)</a>:</h4>
<p>I want to use it with a ring (like the integers), which is not an instance of <code>sign_type</code>...</p>



<a name="308826100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308826100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308826100">(Nov 09 2022 at 16:41)</a>:</h4>
<p>One could state it for <code>sign_type</code>, I suppose, but then <code>sign_type</code> should be an instance of all the things needed here anyway, so the result should specialize to that case.</p>



<a name="308830753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308830753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308830753">(Nov 09 2022 at 17:04)</a>:</h4>
<p>What I need is <a href="https://leanprover-community.github.io/mathlib_docs/find/list.prod_eq_zero">docs#list.prod_eq_zero</a>, which wants a <code>monoid_with_zero</code>, but I would think that <a href="https://leanprover-community.github.io/mathlib_docs/find/mul_zero_class">docs#mul_zero_class</a> should be sufficient? I also need <a href="https://leanprover-community.github.io/mathlib_docs/find/list.prod_eq_one">docs#list.prod_eq_one</a>, which wants a <code>monoid</code>, but something weaker (like <a href="https://leanprover-community.github.io/mathlib_docs/find/mul_one_class">docs#mul_one_class</a>) should also suffice there.</p>



<a name="308831738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308831738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308831738">(Nov 09 2022 at 17:09)</a>:</h4>
<p>Yes many lemmas about <code>prod</code> assume the operation is associative, because otherwise there are many choices for the product, so it isn't particularly clear why producting from the left is the right one. But I'm sure this assumption can be removed in this case of a degenerate product.</p>



<a name="308832661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308832661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308832661">(Nov 09 2022 at 17:15)</a>:</h4>
<p>The proof of <code>prod_eq_one</code> probably has to change to a more explicit induction though, <code>prod_eq_pow_card</code> doesn't make sense without a power operation, which <code>mul_one_class</code> doesn't have</p>



<a name="308842014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308842014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308842014">(Nov 09 2022 at 18:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F/near/308825157">said</a>:</p>
<blockquote>
<p>Or is there something like a <code>monoid_with_zero_and_negation</code>?</p>
</blockquote>
<p>Isn't that just an additive group?</p>



<a name="308844554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308844554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308844554">(Nov 09 2022 at 18:21)</a>:</h4>
<p>Not sure what you mean? There is no <code>add_monoid_with_zero</code>, something like the interval <code>Icc -1 1</code> in the reals is a monoid with zero and negation, but not an additive group</p>



<a name="308844851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308844851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308844851">(Nov 09 2022 at 18:23)</a>:</h4>
<p>I assume "with negation" means "with lawful negation"?</p>



<a name="308844996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308844996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308844996">(Nov 09 2022 at 18:24)</a>:</h4>
<p>which implies you also have an addition and most likely an additive group structure</p>



<a name="308845263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308845263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308845263">(Nov 09 2022 at 18:25)</a>:</h4>
<p>I'm not sure there are any particular properties you can point to of negation on <code>Icc -1 1</code> other than that it's an involution</p>



<a name="308845383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308845383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308845383">(Nov 09 2022 at 18:26)</a>:</h4>
<p>We have all sorts of things like <a href="https://leanprover-community.github.io/mathlib_docs/find/has_distrib_neg">docs#has_distrib_neg</a> that don't have additive structures</p>



<a name="308845522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308845522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308845522">(Nov 09 2022 at 18:27)</a>:</h4>
<p>In any case I agree that the question do we have "monoid_with_zero_and_negation" needs to be a bit more specific to make sense</p>



<a name="308845785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308845785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308845785">(Nov 09 2022 at 18:28)</a>:</h4>
<p>After thinking about it, I would say that trying to go for <code>mul_zero_one_class</code> with <code>has_distrib_neg</code> doesn't make that much sense, since in all use cases I can imagine, one will have a monoiod anyway. So I'm going with <code>[monoid_with_zero α] [has_distrib_neg α]</code> (which seems to capture what I meant by a <code>monoid_with_zero_and_negation</code>).</p>



<a name="308847938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308847938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308847938">(Nov 09 2022 at 18:40)</a>:</h4>
<p>beware, that will put two multiplications on your type and so is probably not what you want</p>



<a name="308848160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308848160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308848160">(Nov 09 2022 at 18:41)</a>:</h4>
<p>I don't think thats the case here, <code>has_distrib_neg</code> is a mixin</p>



<a name="308854963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308854963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308854963">(Nov 09 2022 at 19:16)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">list.prod_eq_neg_one</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_distrib_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hh</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">≠</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">∨</span> <span class="n">l</span> <span class="bp">≠</span> <span class="o">[])</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">l.prod</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_cases</span> <span class="n">h₀</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">l</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">h₀</span><span class="o">,</span> <span class="n">list.prod_eq_zero</span> <span class="n">h₀</span> <span class="bp">▸</span> <span class="n">h</span><span class="o">⟩,</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">eq_or_ne</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="k">with</span> <span class="n">h₁</span> <span class="n">h₁</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">l</span> <span class="k">with</span> <span class="n">a</span> <span class="n">l'</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">false.elim</span> <span class="o">(</span><span class="n">or.neg_resolve_left</span> <span class="n">hh</span> <span class="n">h₁</span> <span class="n">rfl</span><span class="o">)},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="o">(</span><span class="n">list.mem_cons_self</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
                <span class="n">or.elim</span> <span class="o">(</span><span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">ht</span> <span class="n">a</span> <span class="o">(</span><span class="n">list.mem_cons_self</span> <span class="n">_</span> <span class="n">_</span><span class="o">))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="n">H</span><span class="o">,</span> <span class="n">h₀</span> <span class="o">(</span><span class="n">H</span> <span class="bp">▸</span> <span class="n">list.mem_cons_self</span> <span class="n">_</span> <span class="n">_</span><span class="o">)))</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">H</span><span class="o">,</span> <span class="n">h₁</span> <span class="bp">▸</span> <span class="n">H</span><span class="o">)</span> <span class="n">id</span><span class="o">⟩,</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">by_contra'</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">list.prod_eq_one</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">hn</span><span class="o">,</span> <span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">or.resolve_right</span> <span class="o">(</span><span class="n">or.assoc.mpr</span> <span class="o">(</span><span class="n">ht</span> <span class="n">n</span> <span class="n">hn</span><span class="o">))</span> <span class="o">(</span><span class="n">hf</span> <span class="n">n</span> <span class="n">hn</span><span class="o">))</span>
                            <span class="o">(</span><span class="bp">λ</span> <span class="n">hf'</span><span class="o">,</span> <span class="n">h₀</span> <span class="o">(</span><span class="n">hf'</span> <span class="bp">▸</span> <span class="n">hn</span><span class="o">)))</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h₁</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">list.int_prod_eq_neg_one</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">l.prod</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span> <span class="o">:=</span>
<span class="n">list.prod_eq_neg_one</span> <span class="o">(</span><span class="n">or.inl</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span> <span class="n">ht</span> <span class="n">h</span>
</code></pre></div>
<p>The extra assumption <code>hh</code> is a bit annoying, but unavoidable...</p>



<a name="308861060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/308861060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#308861060">(Nov 09 2022 at 19:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/217875-Is-there-code-for-X.3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F/near/308845263">said</a>:</p>
<blockquote>
<p>I'm not sure there are any particular properties you can point to of negation on <code>Icc -1 1</code> other than that it's an involution</p>
</blockquote>
<p>It's an <em>order-reversing</em> involution (assuming negation is order-reversing on the underlying type of <code>1</code> and <code>-1</code>). Which means that a series of lemmas about <code>neg</code> and orders, that currently are only available for additive groups (and with unfortunate <code>left</code>/<code>right</code> duplication), are also true for that interval (as well as for <code>ereal</code>, <code>sign_type</code>, etc.).</p>
<p>I don't expect to return to the series of PRs aiming at making those lemmas more widely applicable (that started with <a href="https://github.com/leanprover-community/mathlib/pull/16187">#16187</a>) until after the mathlib4 migration is complete, since they'd now involving changing a mixture of frozen and unfrozen files. But if someone does wish to work in that area before then (and deal with doing PRs in both places) I could outline what I think some of the next few steps might be.</p>



<a name="309078237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/309078237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#309078237">(Nov 10 2022 at 20:57)</a>:</h4>
<p>Here is a simpler version.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">list</span>

<span class="kd">lemma</span> <span class="n">prod_ne_zero_or_one</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid_with_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h₀</span> <span class="o">:</span> <span class="n">l.prod</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">l.prod</span> <span class="bp">≠</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_contra'</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h₁</span> <span class="o">(</span><span class="n">prod_eq_one</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hf</span> <span class="n">x</span> <span class="n">hx</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">hf'</span><span class="o">,</span> <span class="n">h₀</span> <span class="bp">$</span> <span class="n">prod_eq_zero</span> <span class="bp">$</span> <span class="n">hf'</span> <span class="bp">▸</span> <span class="n">hx</span><span class="o">),</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">int_prod_eq_neg_one</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">∈</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">n</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">l.prod</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">l</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hx₀</span><span class="o">,</span> <span class="n">hx₁</span><span class="o">⟩</span> <span class="o">:=</span>
    <span class="n">prod_ne_zero_or_one</span> <span class="o">(</span><span class="n">ne_of_eq_of_ne</span> <span class="n">h</span> <span class="n">dec_trivial</span><span class="o">)</span> <span class="o">(</span><span class="n">ne_of_eq_of_ne</span> <span class="n">h</span> <span class="n">dec_trivial</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">or.resolve_left</span> <span class="o">(</span><span class="n">ht</span> <span class="n">x</span> <span class="n">hx</span><span class="o">)</span> <span class="n">hx₀</span><span class="o">)</span> <span class="n">hx₁</span> <span class="bp">▸</span> <span class="n">hx</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">list</span>
</code></pre></div>
<p>I have some additional API lemmas on Legendre and Jacobi symbols that I would like to PR at some point, one of which needs <code>int_prod_eq_neg_one</code> from above. Would it make sense to PR these two lemmas and put them somewhere into <code>data.list.big_operators</code>? Or should I better do the proof of <code>int_prod_eq_neg_one</code> locally where it is needed? I can image that it is too specialized for mathlib, but it can easily be generalized to rings of characteristic zero (at the cost of having to put in explicit proofs of <code>-1 ≠ 0</code> and <code>-1 ≠ 1</code>). Or maybe do it for nontrivial rings and add <code>-1 ≠ 1</code> as an assumption...</p>



<a name="309118321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/309118321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#309118321">(Nov 11 2022 at 02:10)</a>:</h4>
<p><code>int_prod_eq_neg_one</code> shouldn't need <code>ht</code> at all (any product of integers equal to <code>-1</code> must include a term equal to <code>-1</code>).</p>



<a name="309152529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/309152529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#309152529">(Nov 11 2022 at 09:05)</a>:</h4>
<p>True. But then it doesn't generalize to a lot of other rings <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> <br>
(Also, in my use case, I know beforehand that the factors are in {0, 1, -1}, so there is no penalty in having the assumption.)</p>



<a name="309152699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/%60non_assoc_ring%60%20is%20not%20a%20%60monoid_with_zero%60%3F/near/309152699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/.60non_assoc_ring.60.20is.20not.20a.20.60monoid_with_zero.60.3F.html#309152699">(Nov 11 2022 at 09:06)</a>:</h4>
<p>Tthe question then is, would it make sense to have <code>int_prod_eq_neg_one</code> without <code>ht</code> as a lemma in mathlib?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>