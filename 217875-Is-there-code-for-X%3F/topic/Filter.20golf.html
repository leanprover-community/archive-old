---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html">Filter golf</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="227308681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227308681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227308681">(Feb 22 2021 at 17:52)</a>:</h4>
<p>Is there a slick way of proving this fact about filters?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">γ</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">δ</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">))</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div>
<p>At the moment I have a long proof, but perhaps I am unpacking things that don't need to be unpacked.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">topology.subset_properties</span>

<span class="kn">open</span> <span class="n">filter</span>

<span class="kd">lemma</span> <span class="n">filter.tendsto.finite_preimage_compact</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">))</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_compact</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">set.finite</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">s</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">tendsto_def</span><span class="o">]</span> <span class="n">at</span> <span class="n">hf</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mem_cofinite</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">this</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">mem_cocompact</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">,</span> <span class="n">rfl.subset</span><span class="o">⟩</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">γ</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">δ</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">))</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="n">cofinite</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">tendsto_def</span><span class="o">,</span> <span class="n">mem_cofinite</span><span class="o">,</span> <span class="n">mem_cocompact'</span><span class="o">],</span>
  <span class="n">rintros</span> <span class="n">s</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hts</span><span class="o">⟩,</span>
  <span class="k">let</span> <span class="n">t₁</span> <span class="o">:</span> <span class="n">set</span> <span class="n">γ</span> <span class="o">:=</span> <span class="n">prod.fst</span> <span class="bp">''</span> <span class="n">t</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">t₂</span> <span class="o">:</span> <span class="n">set</span> <span class="n">δ</span> <span class="o">:=</span> <span class="n">prod.snd</span> <span class="bp">''</span> <span class="n">t</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">ht₁</span> <span class="o">:</span> <span class="n">is_compact</span> <span class="n">t₁</span> <span class="o">:=</span> <span class="n">ht.image</span> <span class="n">continuous_fst</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">ht₂</span> <span class="o">:</span> <span class="n">is_compact</span> <span class="n">t₂</span> <span class="o">:=</span> <span class="n">ht.image</span> <span class="n">continuous_snd</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hft</span> <span class="o">:</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">t₁</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span> <span class="n">hf.finite_preimage_compact</span> <span class="n">ht₁</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hgt</span> <span class="o">:</span> <span class="o">(</span><span class="n">g</span> <span class="bp">⁻¹'</span> <span class="n">t₂</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span> <span class="o">:=</span> <span class="n">hg.finite_preimage_compact</span> <span class="n">ht₂</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">(</span><span class="n">hft.prod</span> <span class="n">hgt</span><span class="o">)</span><span class="bp">.</span><span class="n">subset</span> <span class="n">_</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="bp">⁻¹'</span> <span class="o">(</span><span class="n">t₁.prod</span> <span class="n">t₂</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">t₁</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">g</span> <span class="bp">⁻¹'</span> <span class="n">t₂</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">ext</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">set.preimage_compl</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">ht'</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">⊆</span> <span class="n">t₁.prod</span> <span class="n">t₂</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">⟨⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩⟩</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="n">set.preimage_mono</span> <span class="o">(</span><span class="n">set.subset.trans</span> <span class="n">hts</span> <span class="n">ht'</span><span class="o">),</span>
<span class="kd">end</span>
</code></pre></div>



<a name="227312971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227312971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227312971">(Feb 22 2021 at 18:20)</a>:</h4>
<p>Nice question! I was wondering whether some <code>filter.prod</code> trick could help, but it seems to me that the product of the cofinite filters on alpha and beta is not the cofinite filter on alpha x beta. </p>
<p>One thing I noticed when thinking about filters over the last week or so is that there's this dual concept of an ideal. Just like in topological spaces where it's equivalent to carry around the open sets or the closed sets, in a parallel universe the fundamental concept turned out not to be a filter but the ideal of sets whose complements were in the filter. So you get the finite ideal, the subset-of-compact ideal etc, and the axioms are just the duals of the filter axioms -- empty set is in the ideal, shrinking an element of the ideal gives you something in the ideal, and union of two things in the ideal is in the ideal. I would imagine that there's a product of ideals, and the product of two finite ideals is the finite ideal on the product, but somehow the fact that (a + b) * (c + d) isn't ac+bd means that this doesn't translate into the product of two cofinite filters being the cofinite filter.</p>



<a name="227313129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227313129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227313129">(Feb 22 2021 at 18:21)</a>:</h4>
<p>I guess the reason filters caught on rather than ideals is that the neighbourhood filter translates into the ideal of subsets whose closure does not contain x, which has a "not" in so it's somehow an indication that you're doing something the wrong way around.</p>



<a name="227313367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227313367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227313367">(Feb 22 2021 at 18:22)</a>:</h4>
<p>They're not the same filter, but they're comparable.</p>



<a name="227313666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227313666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227313666">(Feb 22 2021 at 18:25)</a>:</h4>
<p>The reason I mention all this is that your proof is somehow ideal-theoretic. You're trying to prove the preimage of a cocompact set is cofinite, and this is the same as proving that the preimage of a subset-of-a-compact-set is finite. But any subset-of-a-compact-set is a subset of a product of subsets-of-a-compact-set (consider projections), and a product of finite sets is finite, so done. I know you know all this, I'm just noting that because we have all this machinery for filters and perhaps less machinery for ideals you're having to turn everything around manually.</p>



<a name="227314062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227314062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227314062">(Feb 22 2021 at 18:27)</a>:</h4>
<p>Note that there recently was a PR about such ideals: <a href="https://github.com/leanprover-community/mathlib/issues/5937">#5937</a></p>



<a name="227315393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315393">(Feb 22 2021 at 18:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Filter.20golf/near/227313367">said</a>:</p>
<blockquote>
<p>They're not the same filter, but they're comparable.</p>
</blockquote>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> This comment refers to the relationship between <code>(cofinite : filter (α × β))</code> and <code>(cofinite : filter α).prod (cofinite : filter β)</code>?</p>



<a name="227315472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315472">(Feb 22 2021 at 18:37)</a>:</h4>
<p>Presumably comparable means one is &lt; the other?</p>



<a name="227315724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315724">(Feb 22 2021 at 18:39)</a>:</h4>
<p>Yeah exactly.</p>



<a name="227315730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315730">(Feb 22 2021 at 18:39)</a>:</h4>
<p>I see.  But then presumably the same inequality holds for the relationship between <code>cocompact (α × β)</code> and <code>(cocompact α).prod (cocompact β)</code>, so it doesn't help us (one inequality goes the helpful direction, one the unhelpful direction)?</p>



<a name="227315769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315769">(Feb 22 2021 at 18:39)</a>:</h4>
<p>Hmm.... yeah you're probably right</p>



<a name="227315775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315775">(Feb 22 2021 at 18:39)</a>:</h4>
<p>Right, that's my gut instinct too</p>



<a name="227315864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315864">(Feb 22 2021 at 18:40)</a>:</h4>
<p>But with the ideals it might work perfectly</p>



<a name="227315952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315952">(Feb 22 2021 at 18:40)</a>:</h4>
<p>I think the filter prod is something like the meet of two pulled back ideals and we want the join,</p>



<a name="227315967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227315967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227315967">(Feb 22 2021 at 18:41)</a>:</h4>
<p>Or possibly vice versa</p>



<a name="227316030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227316030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227316030">(Feb 22 2021 at 18:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Filter.20golf/near/227312971">said</a>:</p>
<blockquote>
<p>I would imagine that there's a product of ideals, and the product of two finite ideals is the finite ideal on the product, but somehow the fact that (a + b) * (c + d) isn't ac+bd means that this doesn't translate into the product of two cofinite filters being the cofinite filter.</p>
</blockquote>
<p>It'd be nice to have a name and API for this operation on filters, whatever it is!</p>



<a name="227317156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227317156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227317156">(Feb 22 2021 at 18:49)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">coprod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">filter</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">f.comap</span> <span class="n">prod.fst</span> <span class="bp">⊔</span> <span class="n">g.comap</span> <span class="n">prod.snd</span>
</code></pre></div>
<p>? I've got no idea if <code>filter.coprod</code> is a silly name for it.</p>



<a name="227319908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227319908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227319908">(Feb 22 2021 at 19:06)</a>:</h4>
<p>Ah, this is great!  I can now prove</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">coprod</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">cofinite</span> <span class="o">:=</span>
</code></pre></div>



<a name="227320093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320093">(Feb 22 2021 at 19:07)</a>:</h4>
<p>Me too! So at least the construction isn't completely degenerate :-) Here's my effort:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.filter.cofinite</span>

<span class="kn">namespace</span> <span class="n">filter</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">coprod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">filter</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">f.comap</span> <span class="n">prod.fst</span> <span class="bp">⊔</span> <span class="n">g.comap</span> <span class="n">prod.snd</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="o">(</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">S</span><span class="o">)</span><span class="bp">ᶜ</span> <span class="o">:=</span> <span class="n">set.preimage_compl</span>

<span class="kn">open</span> <span class="n">set</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">filter.coprod</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">cofinite</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span> <span class="n">S</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">filter.coprod</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">mem_comap_sets</span><span class="o">,</span> <span class="n">mem_sup_sets</span><span class="o">,</span> <span class="n">mem_cofinite</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨⟨</span><span class="n">A</span><span class="o">,</span> <span class="n">hAf</span><span class="o">,</span> <span class="n">hAS</span><span class="o">⟩,</span> <span class="n">B</span><span class="o">,</span> <span class="n">hBf</span><span class="o">,</span> <span class="n">hBS</span><span class="o">⟩,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">compl_subset_compl</span><span class="o">,</span> <span class="bp">←</span> <span class="n">preimage_compl</span><span class="o">]</span> <span class="n">at</span> <span class="n">hAS</span> <span class="n">hBS</span><span class="o">,</span>
    <span class="k">let</span> <span class="n">ABc</span> <span class="o">:=</span> <span class="n">set.prod</span> <span class="n">A</span><span class="bp">ᶜ</span> <span class="n">B</span><span class="bp">ᶜ</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hS</span> <span class="o">:</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="bp">⊆</span> <span class="n">ABc</span> <span class="o">:=</span> <span class="n">subset_inter</span> <span class="n">hAS</span> <span class="n">hBS</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">finite.prod</span> <span class="n">hAf</span> <span class="n">hBf</span><span class="o">)</span><span class="bp">.</span><span class="n">subset</span> <span class="n">hS</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hS</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="o">(</span><span class="n">prod.fst</span> <span class="bp">''</span> <span class="n">S</span><span class="bp">ᶜ</span><span class="o">)</span><span class="bp">ᶜ</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">compl_compl</span><span class="o">,</span>
      <span class="n">use</span> <span class="n">hS.image</span> <span class="n">prod.fst</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">preimage_compl</span><span class="o">,</span> <span class="n">compl_subset_comm</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subset_preimage_image</span> <span class="n">prod.fst</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">use</span> <span class="o">(</span><span class="n">prod.snd</span> <span class="bp">''</span> <span class="n">S</span><span class="bp">ᶜ</span><span class="o">)</span><span class="bp">ᶜ</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">compl_compl</span><span class="o">,</span>
      <span class="n">use</span> <span class="n">hS.image</span> <span class="n">prod.snd</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">preimage_compl</span><span class="o">,</span> <span class="n">compl_subset_comm</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subset_preimage_image</span> <span class="n">prod.snd</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="o">}</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">filter</span>
</code></pre></div>



<a name="227320254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320254">(Feb 22 2021 at 19:08)</a>:</h4>
<p>Presumably one also wants a lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">δ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">b</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">c.coprod</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div>



<a name="227320260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320260">(Feb 22 2021 at 19:08)</a>:</h4>
<p>I was rather hoping that <code>finish</code> could take over at some point but I never managed to get it to :-(</p>



<a name="227320314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320314">(Feb 22 2021 at 19:08)</a>:</h4>
<p>And then some category theorist should tell us whether we're allowed to call it a coproduct :)</p>



<a name="227320365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320365">(Feb 22 2021 at 19:09)</a>:</h4>
<p>So of course now the question is whether there is some kind of useful <code>tendsto.coprod</code></p>



<a name="227320432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320432">(Feb 22 2021 at 19:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Filter.20golf/near/227320254">said</a>:</p>
<blockquote>
<p>Presumably one also wants a lemma</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">δ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">b</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">c.coprod</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Yes, this, right?</p>



<a name="227320558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320558">(Feb 22 2021 at 19:10)</a>:</h4>
<p>So coproduct of cofinite will be cofinite, for basically the same reasons?</p>



<a name="227320622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320622">(Feb 22 2021 at 19:10)</a>:</h4>
<p>You mean cocompact, right?  I suspect so ....</p>



<a name="227320644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320644" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320644">(Feb 22 2021 at 19:11)</a>:</h4>
<p>Yes, sorry to add the confusion! cocompact.</p>



<a name="227320675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320675">(Feb 22 2021 at 19:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Filter.20golf/near/227320314">said</a>:</p>
<blockquote>
<p>And then some category theorist should tell us whether we're allowed to call it a coproduct :)</p>
</blockquote>
<p>If this is the coproduct in the category given by the lattice stucture, then sure! (looks like it is!)</p>



<a name="227320799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320799">(Feb 22 2021 at 19:11)</a>:</h4>
<p>The thing is that this "product of filters" isn't some internal product, it's a map <code>filter X x filter Y -&gt; filter (X x Y)</code></p>



<a name="227320864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320864">(Feb 22 2021 at 19:12)</a>:</h4>
<p>(I need to go teach, see you in a bit)</p>



<a name="227320876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320876">(Feb 22 2021 at 19:12)</a>:</h4>
<p>For all I know, filter.coprod should go to <code>filter X \coprod Y</code> or whatever</p>



<a name="227320901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227320901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227320901">(Feb 22 2021 at 19:12)</a>:</h4>
<p>oh maybe it's not a good name then...</p>



<a name="227322865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227322865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227322865">(Feb 22 2021 at 19:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/217875-Is-there.20code.20for.20X.3F/topic/Filter.20golf/near/227320254">said</a>:</p>
<blockquote>
<p>Presumably one also wants a lemma</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">δ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">b</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">c.coprod</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div><br>
</p>
</blockquote>
<p>It's true :D</p>



<a name="227323298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227323298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227323298">(Feb 22 2021 at 19:29)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">order.filter.cofinite</span>

<span class="kn">namespace</span> <span class="n">filter</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="c1">-- this corresponds to `ideal.prod`, where an ideal on a type X is</span>
<span class="c1">-- a set of subsets of X such that the complements of these sets</span>
<span class="c1">-- are a filter.</span>
<span class="kn">protected</span> <span class="kd">def</span> <span class="n">coprod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">filter</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">f.comap</span> <span class="n">prod.fst</span> <span class="bp">⊔</span> <span class="n">g.comap</span> <span class="n">prod.snd</span>

<span class="kn">open</span> <span class="n">set</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">filter.coprod</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">cofinite</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span> <span class="n">S</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">filter.coprod</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">mem_comap_sets</span><span class="o">,</span> <span class="n">mem_sup_sets</span><span class="o">,</span> <span class="n">mem_cofinite</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨⟨</span><span class="n">A</span><span class="o">,</span> <span class="n">hAf</span><span class="o">,</span> <span class="n">hAS</span><span class="o">⟩,</span> <span class="n">B</span><span class="o">,</span> <span class="n">hBf</span><span class="o">,</span> <span class="n">hBS</span><span class="o">⟩,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">compl_subset_compl</span><span class="o">,</span> <span class="bp">←</span> <span class="n">preimage_compl</span><span class="o">]</span> <span class="n">at</span> <span class="n">hAS</span> <span class="n">hBS</span><span class="o">,</span>
    <span class="k">let</span> <span class="n">ABc</span> <span class="o">:=</span> <span class="n">set.prod</span> <span class="n">A</span><span class="bp">ᶜ</span> <span class="n">B</span><span class="bp">ᶜ</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hS</span> <span class="o">:</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="bp">⊆</span> <span class="n">ABc</span> <span class="o">:=</span> <span class="n">subset_inter</span> <span class="n">hAS</span> <span class="n">hBS</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">finite.prod</span> <span class="n">hAf</span> <span class="n">hBf</span><span class="o">)</span><span class="bp">.</span><span class="n">subset</span> <span class="n">hS</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hS</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="o">(</span><span class="n">prod.fst</span> <span class="bp">''</span> <span class="n">S</span><span class="bp">ᶜ</span><span class="o">)</span><span class="bp">ᶜ</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">compl_compl</span><span class="o">,</span>
      <span class="n">use</span> <span class="n">hS.image</span> <span class="n">prod.fst</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">preimage_compl</span><span class="o">,</span> <span class="n">compl_subset_comm</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subset_preimage_image</span> <span class="n">prod.fst</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">use</span> <span class="o">(</span><span class="n">prod.snd</span> <span class="bp">''</span> <span class="n">S</span><span class="bp">ᶜ</span><span class="o">)</span><span class="bp">ᶜ</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">compl_compl</span><span class="o">,</span>
      <span class="n">use</span> <span class="n">hS.image</span> <span class="n">prod.snd</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">preimage_compl</span><span class="o">,</span> <span class="n">compl_subset_comm</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subset_preimage_image</span> <span class="n">prod.snd</span> <span class="n">S</span><span class="bp">ᶜ</span> <span class="o">}</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">δ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">b</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">c.coprod</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">tendsto_def</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">filter.coprod</span> <span class="n">at</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">mem_comap_sets</span><span class="o">,</span> <span class="n">mem_sup_sets</span><span class="o">]</span> <span class="n">at</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hs</span> <span class="k">with</span> <span class="o">⟨⟨</span><span class="n">C</span><span class="o">,</span> <span class="n">hCc</span><span class="o">,</span> <span class="n">hCs</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">D</span><span class="o">,</span> <span class="n">hDd</span><span class="o">,</span> <span class="n">hDs</span><span class="o">⟩⟩,</span>
  <span class="n">unfold</span> <span class="n">filter.coprod</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">mem_comap_sets</span><span class="o">,</span> <span class="n">mem_sup_sets</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">tendsto_def</span> <span class="n">at</span> <span class="n">hf</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">hf</span> <span class="n">C</span> <span class="n">hCc</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">f</span> <span class="bp">⁻¹'</span> <span class="n">C</span><span class="o">,</span> <span class="n">hf</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="o">⟨</span><span class="n">aa</span><span class="o">,</span><span class="n">bb</span><span class="o">⟩</span> <span class="n">haaC</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hCs</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">haaC</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">tendsto_def</span> <span class="n">at</span> <span class="n">hg</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">hg</span> <span class="n">D</span> <span class="n">hDd</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">g</span> <span class="bp">⁻¹'</span> <span class="n">D</span><span class="o">,</span> <span class="n">hg</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="o">⟨</span><span class="n">aa</span><span class="o">,</span><span class="n">bb</span><span class="o">⟩</span> <span class="n">hbbD</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">hDs</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hbbD</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">filter</span>
</code></pre></div>



<a name="227325345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227325345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227325345">(Feb 22 2021 at 19:41)</a>:</h4>
<p>About two weeks ago I would have ignored this question because I didn't know what a filter was. It was preparing <a href="https://xenaproject.wordpress.com/2021/02/18/formalising-mathematics-workshop-5-filters/">last week's workshop</a> and my current work on this week's workshop which meant that I was no longer scared of them. The way I'm thinking about filters now is that they are some kind of weird generalisation of subsets. Filters are a lattice containing the lattice of subsets (thought of as principal filters) as a sublattice, and given a filter F you can ask which subsets S have the property that F &lt;= S. The fundamental fact about filters is that this set S of subsets determines the filter, and indeed F.sets is precisely these subsets. What about the subsets contained in F? For some reason these give far less information. This asymmetry is fixed if you model a filter by ideals; then you get some other model of a "fuzzy set" which is determined by the subsets it contains but not by the ones it's contained in. Given a subset you get a filter, the principal filter, and conversely given a filter you can just take the intersection of the subsets it is contained in and get some kind of "best approximation subset" of a filter. I am surprised that this isn't some fundamental construction, it seems to be some kind of standard adjoint functor / galois insertion thing but I couldn't find it in order.filter.basic . </p>
<p>That was what I learnt last week. This week I've been thinking about <code>tendsto</code>, and it's equally simple. If f : X -&gt; Y and S is a subset of X and T is a subset of Y, then the concept "f restricts to a function from S to T" can be said in the following two equivalent ways: f(S) subset T, or S subset f^{-1}(T). This is the <code>tendsto</code> predicate on principal filters, it just says the image of  set 1 is contained in  set 2. image and preimage are adjoint functors between <code>set X</code> and <code>set Y</code> and because we're in this situation where all hom sets have size &lt;= 1 (partially ordered sets like these complete lattices are categories with all hom sets having size &lt;= 1) if you have two adjoint functors (or a Galois connection or however you want to think of it) then you get a predicate: either Hom(a,Phi b)=Hom(Psi a,b) has size 0 or size 1, and if it has size 1 then you say the predicate is satisfied. For filters this predicate is precisely <code>tendsto</code>, and informally <code>tendsto f F G</code> is the statement that the function f : X -&gt; Y restricts to a function from the fuzzy set (F : filter X) to the fuzzy set (G : filter Y).</p>
<p>None of this point of view helps at all with your question! It's just that it helps me be a whole lot less scared by filters. In particular, when I was focussed on the underlying F.sets I would find the fact that &lt;= was "backwards" really confusing -- thinking of filters as fuzzy subsets has completely eliminated this confusion.</p>



<a name="227325973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227325973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227325973">(Feb 22 2021 at 19:45)</a>:</h4>
<p>A great example of a fuzzy set is the neighbourhood filter of a point in a topological space; the corresponding fuzzy set is an infinitesimal neighbourhood of the point in the sense of Isaac Newton. A function is continuous if the preimage of an infinitesimal nhd of f(a) contains an infinitesimal nhd of a and this is precisely <code>tendsto (N a) (N (f a))</code>, or in other words f doesn't just map a to f(a), it maps the infinitesimal nhd of a to the infinitesimal nhd of f(a).</p>
<p>Sorry, I should go back to writing all this down in a blog post rather than here! In the mean time someone needs to come along and tell us how we're re-inventing the wheel with <code>filter.coprod</code>.</p>



<a name="227332780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227332780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227332780">(Feb 22 2021 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>, mind if I add a proof of the <code>cocompact</code> version and then open a PR?  (Or feel free to do it yourself.)</p>



<a name="227333076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227333076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227333076">(Feb 22 2021 at 20:35)</a>:</h4>
<p>Obviously, we can close the PR if someone figures out how this is a wheel-reinvention :)</p>



<a name="227333314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227333314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227333314">(Feb 22 2021 at 20:37)</a>:</h4>
<p>If you and Kevin have been reinventing the wheel all this time, then we surely need to better document the wheel!</p>



<a name="227339819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227339819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227339819">(Feb 22 2021 at 21:25)</a>:</h4>
<p>Please feel free to open a PR! I have three open right now which is more than my usual max and so I'd rather not open another one. My proof is a typical Kevin meandering, probably it can be cleared up. <span class="user-mention" data-user-id="110031">@Patrick Massot</span> is this already a thing?</p>



<a name="227340004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340004">(Feb 22 2021 at 21:26)</a>:</h4>
<p>I haven't followed. Is the question about golfing you last big code message?</p>



<a name="227340272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340272">(Feb 22 2021 at 21:28)</a>:</h4>
<p>TL;DR Kevin defined a notion of coproduct of filters, </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">coprod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">filter</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">f.comap</span> <span class="n">prod.fst</span> <span class="bp">⊔</span> <span class="n">g.comap</span> <span class="n">prod.snd</span>
</code></pre></div>
<p>which is useful for the original problem.  Is this a known concept?</p>



<a name="227340353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340353">(Feb 22 2021 at 21:29)</a>:</h4>
<p>It differs from <a href="http://filter.prod">filter.prod</a> because we use the join not the meet</p>



<a name="227340405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340405">(Feb 22 2021 at 21:29)</a>:</h4>
<p>Its properties:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">filter.coprod</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">cofinite</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">cofinite</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">filter.coprod</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">cocompact</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">cocompact</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">δ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">δ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">δ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">b</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x.1</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.2</span><span class="o">))</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">c.coprod</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="227340420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340420">(Feb 22 2021 at 21:29)</a>:</h4>
<p>The name might be wrong, we made it up</p>



<a name="227340491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340491">(Feb 22 2021 at 21:30)</a>:</h4>
<p>I've never seen this (and the same does feel wrong)</p>



<a name="227340664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340664">(Feb 22 2021 at 21:31)</a>:</h4>
<p>The name cocompact is also weird because it makes me think of groups acting with compact quotients. Is this new?</p>



<a name="227340714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340714">(Feb 22 2021 at 21:31)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/filter.cocompact">docs#filter.cocompact</a></p>



<a name="227340828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340828">(Feb 22 2021 at 21:32)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/4666">#4666</a></p>



<a name="227340895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340895">(Feb 22 2021 at 21:33)</a>:</h4>
<p>Oh, I merged that...</p>



<a name="227340947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340947">(Feb 22 2021 at 21:33)</a>:</h4>
<p><span aria-label="older man" class="emoji emoji-1f474" role="img" title="older man">:older_man:</span></p>



<a name="227340990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227340990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227340990">(Feb 22 2021 at 21:33)</a>:</h4>
<p>Yury introduced it, but I found it useful today in order to work with proper maps (which are <code>tendsto _ cocompact cocompact</code>)</p>



<a name="227341062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227341062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227341062">(Feb 22 2021 at 21:34)</a>:</h4>
<p>I'm sure Kevin has another definition for proper maps...</p>



<a name="227341290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227341290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227341290">(Feb 22 2021 at 21:35)</a>:</h4>
<p>But actually for complex varieties I think they coincide</p>



<a name="227341571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227341571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227341571">(Feb 22 2021 at 21:37)</a>:</h4>
<p>For this coprod name, if S is a subset of X and T is a subset of Y then the coproduct is S x Y union X x T. Does this have a name in set land? Is it some kind of box construction or something?</p>



<a name="227341621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227341621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227341621">(Feb 22 2021 at 21:37)</a>:</h4>
<p>(thinking of sets as principal filters)</p>



<a name="227341872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227341872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227341872">(Feb 22 2021 at 21:39)</a>:</h4>
<p>It's complement of the product of the complements for sets, but unlike sets filters don't have this canonical complement antiautomorphism</p>



<a name="227362162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227362162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227362162">(Feb 23 2021 at 00:15)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/6472">#6472</a>, anyone should feel free to suggest a better name for the construction (or we can also just rewrite to refer to it as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">f.comap</span> <span class="n">prod.fst</span> <span class="bp">⊔</span> <span class="n">g.comap</span> <span class="n">prod.snd</span>
</code></pre></div>
<p>throughout, without naming it).</p>



<a name="227364781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227364781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227364781">(Feb 23 2021 at 00:41)</a>:</h4>
<p>Seems to me that <code>coprod</code> has a natural meaning as a filter on alpha \coprod beta (push forward and then \lub). <span class="user-mention" data-user-id="110032">@Reid Barton</span> do you know a good name for this construction?</p>



<a name="227405165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227405165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227405165">(Feb 23 2021 at 09:53)</a>:</h4>
<p>The issue is that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>×</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha \times \beta</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> is <em>not</em> the coproduct in Type. The coproduct in Type is the sum type.</p>



<a name="227405247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227405247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227405247">(Feb 23 2021 at 09:54)</a>:</h4>
<p>Also I think we can include in the PR </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">principal_coprod_principal</span> <span class="o">(</span><span class="n">s</span>  <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
<span class="o">(</span><span class="bp">𝓟</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">coprod</span> <span class="o">(</span><span class="bp">𝓟</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">𝓟</span> <span class="o">(</span><span class="n">s</span><span class="bp">ᶜ.</span><span class="n">prod</span> <span class="n">t</span><span class="bp">ᶜ</span><span class="o">)</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">filter.coprod</span><span class="o">,</span> <span class="n">comap_principal</span><span class="o">,</span> <span class="n">comap_principal</span><span class="o">,</span> <span class="n">sup_principal</span><span class="o">],</span>
  <span class="n">congr</span><span class="o">,</span>
  <span class="n">ext</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="bp">;</span> <span class="n">tauto</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="227405615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227405615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227405615">(Feb 23 2021 at 09:57)</a>:</h4>
<p>And maybe it's a good time to start including counter-examples. Here we want an example with <code> map (prod.map f  g) (a.coprod b) &lt; filter.prod (map f a) (map g b)</code>. Using the above lemma you can make an example where all types are <code>fin 2</code>.</p>



<a name="227405650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227405650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227405650">(Feb 23 2021 at 09:57)</a>:</h4>
<p>Also the proof of the tendsto lemma can be reduced to <code>map_prod_map_coprod_le.trans (coprod_mono hf hg)</code></p>



<a name="227405804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227405804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227405804">(Feb 23 2021 at 09:59)</a>:</h4>
<p>And I still don't have a good name. Maybe <code>cross_prod</code> since the case of principal filters is drawing a cross in the product space.</p>



<a name="227429370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227429370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227429370">(Feb 23 2021 at 13:29)</a>:</h4>
<p>I had it in my head that there was a word for this in topology, like smash product or something, it's probably not that but in the set case this is surely construction which is useful to somebody</p>



<a name="227455673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227455673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227455673">(Feb 23 2021 at 16:06)</a>:</h4>
<p>Is this analogous?  Given vector bundles <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">E_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> over manifolds <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> respectively, one has the projections <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub><mo>:</mo><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>M</mi><mn>2</mn></msub><mo>→</mo><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\pi_i:M_1\times M_2\to M_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and can pull back to vector bundles <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub><msup><mrow></mrow><mo>∗</mo></msup><msub><mi>E</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\pi_i{}^*E_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.838696em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_1\times M_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.  One can then, in two ways, get a "combined" vector bundle over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>×</mo><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_1\times M_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub><msup><mrow></mrow><mo>∗</mo></msup><msub><mi>E</mi><mn>1</mn></msub><mo>⊗</mo><msub><mi>π</mi><mn>2</mn></msub><msup><mrow></mrow><mo>∗</mo></msup><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\pi_1{}^*E_1\otimes \pi_2{}^*E_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.838696em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.838696em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (which I have seen denoted <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>⊠</mo><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E_1\boxtimes E_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin amsrm">⊠</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub><msup><mrow></mrow><mo>∗</mo></msup><msub><mi>E</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>π</mi><mn>2</mn></msub><msup><mrow></mrow><mo>∗</mo></msup><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\pi_1{}^*E_1\oplus \pi_2{}^*E_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.838696em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.838696em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>Presumably there's a similar story for sheaves.</p>



<a name="227461031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227461031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227461031">(Feb 23 2021 at 16:36)</a>:</h4>
<p>Maybe you should denote the second one with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊞</mo></mrow><annotation encoding="application/x-tex">\boxplus</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.675em;vertical-align:0em;"></span><span class="mord amsrm">⊞</span></span></span></span>?</p>



<a name="227461180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227461180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227461180">(Feb 23 2021 at 16:37)</a>:</h4>
<p>I think this is the one which is analogous to the construction you were discussing, right?</p>



<a name="227913869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227913869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227913869">(Feb 26 2021 at 11:24)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> you requested my review but haven't integrated the above lemma and remove the equality question.</p>



<a name="227915717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227915717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227915717">(Feb 26 2021 at 11:41)</a>:</h4>
<p>I really like how the proofs got even more golfed in the PR process :-)</p>



<a name="227942019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227942019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227942019">(Feb 26 2021 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> When you say "remove the equality question", this is by giving an example of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">map</span> <span class="o">(</span><span class="n">prod.map</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">map</span> <span class="n">f</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">coprod</span> <span class="o">(</span><span class="n">map</span> <span class="n">g</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>
<p>?  In the discussion above you referred to an example with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">map</span> <span class="o">(</span><span class="n">prod.map</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">a.coprod</span> <span class="n">b</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">map</span> <span class="n">f</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">map</span> <span class="n">g</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>



<a name="227984139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227984139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227984139">(Feb 26 2021 at 20:01)</a>:</h4>
<p>Oh sorry, this was a typo.</p>



<a name="227984187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227984187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227984187">(Feb 26 2021 at 20:01)</a>:</h4>
<p>I meant <code>map (prod.map f g) (a.coprod b) &lt; (map f a).coprod (map g b)</code></p>



<a name="227985080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/227985080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#227985080">(Feb 26 2021 at 20:07)</a>:</h4>
<p>I fear I lost the piece of paper where I wrote that counter-example. It was something like alpha = beta = gamma = delta = fin 2, f = id, g = lambda x, 1, a = b = principal {0].</p>



<a name="228029891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228029891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228029891">(Feb 27 2021 at 03:43)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Thanks, indeed it works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="bp">𝓟</span> <span class="o">{</span><span class="n">a</span><span class="o">}))</span><span class="bp">.</span><span class="n">coprod</span> <span class="o">(</span><span class="n">map</span> <span class="n">id</span> <span class="o">(</span><span class="bp">𝓟</span> <span class="o">{</span><span class="n">i</span><span class="o">}))</span>
  <span class="bp">=</span> <span class="bp">𝓟</span> <span class="o">(({</span><span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">)</span> <span class="bp">∪</span> <span class="o">(</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="o">{</span><span class="n">i</span><span class="o">})</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">map_principal</span><span class="o">,</span> <span class="n">map_principal</span><span class="o">,</span> <span class="n">principal_coprod_principal</span><span class="o">],</span>
  <span class="n">congr</span><span class="o">,</span>
  <span class="n">ext</span> <span class="o">⟨</span><span class="n">b'</span><span class="o">,</span> <span class="n">i'</span><span class="o">⟩,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">tauto</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">map</span> <span class="o">(</span><span class="n">prod.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="n">id</span><span class="o">)</span> <span class="o">((</span><span class="bp">𝓟</span> <span class="o">{</span><span class="n">a</span><span class="o">})</span><span class="bp">.</span><span class="n">coprod</span> <span class="o">(</span><span class="bp">𝓟</span> <span class="o">{</span><span class="n">i</span><span class="o">}))</span>
  <span class="bp">=</span> <span class="bp">𝓟</span> <span class="o">(({</span><span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">principal_coprod_principal</span><span class="o">,</span> <span class="n">map_principal</span><span class="o">],</span>
  <span class="n">congr</span><span class="o">,</span>
  <span class="n">ext</span> <span class="o">⟨</span><span class="n">b'</span><span class="o">,</span> <span class="n">i'</span><span class="o">⟩,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="o">⟨⟨</span><span class="n">a''</span><span class="o">,</span> <span class="n">i''</span><span class="o">⟩,</span> <span class="n">h₁</span><span class="o">,</span> <span class="o">⟨</span><span class="n">h₂</span><span class="o">,</span> <span class="n">h₃</span><span class="o">⟩⟩,</span>
    <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="o">⟨</span><span class="n">h₁</span><span class="o">,</span> <span class="n">h₂</span><span class="o">⟩,</span>
    <span class="n">use</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">i'</span><span class="o">),</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="n">h₁.symm</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228029953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228029953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228029953">(Feb 27 2021 at 03:44)</a>:</h4>
<p>Do we actually want this (a not-intrinsically-interesting counterexample) in mathlib?  Maybe in archive or test?</p>



<a name="228030215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228030215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228030215">(Feb 27 2021 at 03:50)</a>:</h4>
<p>For now I just pushed the principal filter lemma and a description of the counterexample in words.</p>



<a name="228043592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228043592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228043592">(Feb 27 2021 at 08:30)</a>:</h4>
<p>I would keep those as examples right after the inequality lemma. What would be really great would be to figure out how to use <code>slim_check</code> for this kind of things. I'm sure most wrong results about filters have this kind of counter-examples.</p>



<a name="228044194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228044194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228044194">(Feb 27 2021 at 08:42)</a>:</h4>
<p>Heather, I created a <code>counterexamples</code> branch of mathlib, with a folder <code>counterexamples</code> in <code>src</code>: I am putting there the formalized counterexamples that I come across.  There are two at the moment.</p>
<p>I'd be very happy if you wanted to contribute something there!</p>



<a name="228067139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228067139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228067139">(Feb 27 2021 at 16:13)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> For sure, I'll add it to the branch, is the plan to incorporate the branch into master at some point?</p>



<a name="228067238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228067238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228067238">(Feb 27 2021 at 16:15)</a>:</h4>
<p>I think that it would be good if it appeared in mathlib, but I am happy to go with what everyone else also thinks is appropriate.</p>
<p>Personally, I find examples and counterexamples to be fundamental aspects of mathematics, so I would really like them to be in mathlib!</p>
<p>I remember many years ago reading books called `counterexamples in [topology/analysis/geometry]" and being fascinated by them!</p>



<a name="228068697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228068697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228068697">(Feb 27 2021 at 16:42)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> I pushed the counterexamples.  <span class="user-mention" data-user-id="321459">@Damiano Testa</span> I'll add them to the counterexamples branch once my PR is merged -- they rely on a new definition in the PR, <code>filter.coprod</code> (or maybe it will be renamed).</p>



<a name="228068876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/Filter%20golf/near/228068876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/Filter.20golf.html#228068876">(Feb 27 2021 at 16:44)</a>:</h4>
<p>Great!  Of course there is no rush!  I am very happy to see the counterexamples branch grow!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>