---
layout: archive
title: Zulip Chat Archive
permalink: /stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/index.html">Berkeley Lean Seminar</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html">Massot Exercise 0037</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="200687680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200687680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin McPhail-Snyder <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200687680">(Jun 12 2020 at 15:53)</a>:</h4>
<p>I had a question about exercise 0037 in the Massot tutorial. The solution is</p>
<div class="codehilite"><pre><span></span><code><span class="c1">-- A sequence admits at most one limit</span>
<span class="c1">-- 0037</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l&#39;</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">hyp</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">hyp&#39;</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_abs_sub_le_all</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">ε</span> <span class="n">ε_pos</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N</span> <span class="n">hN</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp&#39;</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N&#39;</span> <span class="n">hN&#39;</span><span class="o">,</span>
  <span class="k">calc</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="bp">=</span> <span class="bp">|</span><span class="o">(</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">))</span> <span class="bp">+</span> <span class="o">(</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">apply</span> <span class="n">abs_add</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">abs_sub</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">hN</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">le_max_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">),</span> <span class="n">hN&#39;</span> <span class="o">(</span><span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">le_max_right</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)]</span>
<span class="kn">end</span>
</code></pre></div>


<p>I mostly get why this works, but I don't really understand what's happening in the last line here: what's that syntax?</p>
<p>I think I would better understand a solution along the lines of</p>
<div class="codehilite"><pre><span></span><code><span class="c1">-- A sequence admits at most one limit</span>
<span class="c1">-- 0037</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l&#39;</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">hyp</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">hyp&#39;</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_abs_sub_le_all</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">ε</span> <span class="n">ε_pos</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N</span> <span class="n">hN</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp&#39;</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N&#39;</span> <span class="n">hN&#39;</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span>
  <span class="k">calc</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="bp">=</span> <span class="bp">|</span><span class="o">(</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">apply</span> <span class="n">abs_add</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">abs_sub</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span> <span class="err">???</span> <span class="o">]</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="kn">end</span>
</code></pre></div>


<p>but I couldn't get this working: you need to add lemmas that n is bigger than N and N', and I got lost doing this; I'm also not quite sure how to feed those lemmas to linarith or similar. Is the awkwardness of carrying around these extra lemmas why the solution is in that form? Or is that a valid style and I just don't know quite how to do it?</p>



<a name="200690184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200690184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200690184">(Jun 12 2020 at 16:10)</a>:</h4>
<p>Its not inconvenient at all to have those extra hypothesis imo. Specially because they are just specialized versions of <code>hN</code> and <code>hN'</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l&#39;</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">hyp</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">hyp&#39;</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_abs_sub_le_all</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">ε</span> <span class="n">ε_pos</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N</span> <span class="n">hN</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp&#39;</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N&#39;</span> <span class="n">hN&#39;</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">hN</span> <span class="n">n</span> <span class="o">(</span><span class="n">le_max_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">),</span>
  <span class="n">specialize</span> <span class="n">hN&#39;</span> <span class="n">n</span> <span class="o">(</span><span class="n">le_max_right</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">),</span>
  <span class="k">calc</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="bp">=</span> <span class="bp">|</span><span class="o">(</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">((</span><span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">apply</span> <span class="n">abs_add</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">abs_sub</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="kn">end</span>
</code></pre></div>



<a name="200690255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200690255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200690255">(Jun 12 2020 at 16:11)</a>:</h4>
<p>You could have also given them directly to <code>linarith</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l&#39;</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">hyp</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">hyp&#39;</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_abs_sub_le_all</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">ε</span> <span class="n">ε_pos</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N</span> <span class="n">hN</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp&#39;</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N&#39;</span> <span class="n">hN&#39;</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span><span class="o">,</span>
  <span class="k">calc</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="bp">=</span> <span class="bp">|</span><span class="o">(</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">((</span><span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">apply</span> <span class="n">abs_add</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">abs_sub</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">hN</span> <span class="n">n</span> <span class="o">(</span><span class="n">le_max_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">),</span> <span class="n">hN&#39;</span> <span class="n">n</span> <span class="o">(</span><span class="n">le_max_right</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)]</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="kn">end</span>
</code></pre></div>



<a name="200690405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200690405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200690405">(Jun 12 2020 at 16:12)</a>:</h4>
<p>You can give extra lemmas for <code>linarith</code> to work with by listing them inside <code>[]</code>.</p>



<a name="200690431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200690431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200690431">(Jun 12 2020 at 16:12)</a>:</h4>
<p><code>linarith</code> will then use these extra lemmas as if they were in the context.</p>



<a name="200690641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200690641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200690641">(Jun 12 2020 at 16:15)</a>:</h4>
<p>Essentially: <code>have h := ..., linarith</code> is effectively the same as <code>linarith [...]</code>.</p>



<a name="200691184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200691184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200691184">(Jun 12 2020 at 16:19)</a>:</h4>
<p>Note that this is the case with multiple tactics. For example, <code>simp</code> by itself it will only simplify a handful of lemmas, however, if you want to to use more you can use <code>simp [lemma_1, lemma_2]</code>.</p>



<a name="200694591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200694591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200694591">(Jun 12 2020 at 16:46)</a>:</h4>
<p>Part of what's going on here is also that <code>linarith</code> is capable of doing a small amount of arithmetic, like knowing that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>ϵ</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">a &lt; \epsilon / 2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϵ</span><span class="mord">/</span><span class="mord">2</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>&lt;</mo><mi>ϵ</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">b &lt; \epsilon / 2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϵ</span><span class="mord">/</span><span class="mord">2</span></span></span></span> then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>&lt;</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">a + b &lt; \epsilon</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span>. So the <code>ring</code> on the last line is not necessary</p>



<a name="200695454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200695454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin McPhail-Snyder <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200695454">(Jun 12 2020 at 16:54)</a>:</h4>
<p>Thanks! That clarified things.</p>



<a name="200695753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200695753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin McPhail-Snyder <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200695753">(Jun 12 2020 at 16:56)</a>:</h4>
<p>Here the underscore syntax is some sort of anonymous function?</p>



<a name="200698181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200698181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200698181">(Jun 12 2020 at 17:18)</a>:</h4>
<p>Lean will try to figure out what to put <code>_</code>. I could have also been explicit: <code>le_max_left N N'</code>.</p>



<a name="200698257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200698257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200698257">(Jun 12 2020 at 17:18)</a>:</h4>
<p>I find that in some cases its way better to use <code>_</code>, and if you do too I think you will also eventually become frustrated that Lean can't infer even more!</p>



<a name="200698457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200698457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200698457">(Jun 12 2020 at 17:20)</a>:</h4>
<p>A notable example I recently ran into was <code>and_not_self (mk (quotient s) * mk ↥s ≤ mk (quotient s) * mk ↥s)</code>, which (in my context) could be reduced to the much more legible <code>and_not_self _</code></p>



<a name="200701311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200701311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200701311">(Jun 12 2020 at 17:44)</a>:</h4>
<p><span class="user-mention" data-user-id="304545">@Calvin McPhail-Snyder</span> you can switch between term and tactic mode at any time. I think <code>set</code> can be easier to use than <code>let</code> sometimes. Here is the solution you posted with <code>set</code> instead of <code>let</code>, and your <code>???</code> replaced by some sorrys:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">seq_limit</span> <span class="n">u</span> <span class="n">l&#39;</span> <span class="bp">→</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">hyp</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">hyp&#39;</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">eq_of_abs_sub_le_all</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">ε</span> <span class="n">ε_pos</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N</span> <span class="n">hN</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hyp&#39;</span> <span class="o">(</span><span class="n">ε</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="k">with</span> <span class="n">N&#39;</span> <span class="n">hN&#39;</span><span class="o">,</span>
  <span class="n">set</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">max</span> <span class="n">N</span> <span class="n">N&#39;</span> <span class="k">with</span> <span class="n">hn</span><span class="o">,</span>
  <span class="k">calc</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="bp">=</span> <span class="bp">|</span><span class="o">(</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="o">)</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">l</span> <span class="bp">-</span> <span class="n">u</span> <span class="n">n</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">apply</span> <span class="n">abs_add</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l</span><span class="bp">|</span> <span class="bp">+</span> <span class="bp">|</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l&#39;</span><span class="bp">|</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">abs_sub</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">ε</span><span class="bp">/</span><span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">hN</span> <span class="n">n</span> <span class="k">begin</span> <span class="n">sorry</span> <span class="kn">end</span><span class="o">,</span> <span class="n">hN&#39;</span> <span class="n">n</span> <span class="k">begin</span> <span class="n">sorry</span> <span class="kn">end</span> <span class="o">]</span>
            <span class="bp">...</span> <span class="bp">≤</span> <span class="n">ε</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="kn">end</span>
</code></pre></div>


<p>You can just fill in those sorrys in tactic mode, they're independent little puzzles. The advantage of <code>set</code> is that the hypothesis <code>n = max N N'</code> has a name now. It's true by definition, but this can be intimidating for beginners.</p>



<a name="200701596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200701596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200701596">(Jun 12 2020 at 17:46)</a>:</h4>
<p>Once you've convinced yourself that <code>exact le_max left _ _</code> solves the first sorry, you can replace <code>begin exact X end</code> with <code>X</code>, and this is what Patrick did.</p>



<a name="200710540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200710540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200710540">(Jun 12 2020 at 18:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Massot.20Exercise.200037/near/200701311">said</a>:</p>
<blockquote>
<p>The advantage of <code>set</code> is that the hypothesis <code>n = max N N'</code> has a name now. It's true by definition, but this can be intimidating for beginners.</p>
</blockquote>
<p>One thread I've been slowly trying to pull is to understand why <code>let</code> definitions aren't picked up by <code>linarith</code>.  Mario mentioned it was only recently that a tactic could even see the definition of something, so there's that.  I could see there being some sort of performance penalty, but not in the adding of the equalities to the context: <code>rfl</code> of definitionally equal things should be basically free.  From perusing the code, <code>linarith</code> looks for all inequalities and breaks them up into linear factors ("atoms"), and by default it doesn't try too hard to check whether different atoms are the same.</p>
<p>While I'm somewhat willing to make Lean happy, I'd rather it be the other way around.</p>
<p>(I thought I read that there was going to be a big change to <code>linarith</code> in the next few weeks, once someone got back, but I can't find it again.)</p>



<a name="200711725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200711725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200711725">(Jun 12 2020 at 19:07)</a>:</h4>
<p>I'm not a computer scientist, but my impression is the following. I don't understand what <code>linarith</code> is doing, but I know for sure that if you just give it straight hypotheses <code>h1 : a &lt; b</code> <code>h2 : b &lt; c</code> <code>h3 : c &lt; 5</code> and then have goal <code>a &lt; 10</code> then <code>linarith</code> <em>just works</em>. And then you start wondering why it can't solve <code>a &lt;= max a b</code> because that's also some trivial linear inequality, right? Or why it can't see through <code>let</code> bindings. So I went through a phase of basically reporting "bug reports" of the form "<code>linarith</code> should do this, right? It's trivial" and believe you me, the CS community here has <em>bent over backwards</em> to accommodate my requests for tactics to make life easier for mathematicians -- but when it came to requests like this, it was explained to me that what I was doing was basically asking for "mission creep". <code>linarith</code> does what it does, and does it well, but it doesn't do things like digging into let bindings or applying le_max_left or abs_le etc -- there is some sort of basic principle of computer science I think, and these requests to start asking for extra functionality are somehow going against this principle.</p>



<a name="200712149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712149">(Jun 12 2020 at 19:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">,</span> <span class="c1">-- n = a by definition so `change` works</span>
  <span class="n">linarith</span> <span class="c1">-- still works</span>
<span class="kn">end</span>
</code></pre></div>


<p>It does seem to be able to see through let binders. It's stuff like <code>le_max_left</code> and <code>abs_le</code> which it doesn't know.</p>



<a name="200712174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712174">(Jun 12 2020 at 19:11)</a>:</h4>
<p>I think I've already accepted <code>linarith</code> not being able to prove  anything like <code>a &lt;= max a b</code>.  I also know that mission creep is exactly "why can't it just do this one extra thing?"  But, this is "in the current context, turn the definitions into equalities as if you had used <code>set</code>."</p>



<a name="200712213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712213">(Jun 12 2020 at 19:11)</a>:</h4>
<p>It doesn't seem to see things like that if its <code>let n := a + 1</code> rather than just a variable.  I'll have to check again.</p>



<a name="200712319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712319">(Jun 12 2020 at 19:12)</a>:</h4>
<p>Can you show me the explicit example where <code>let</code> is failing and <code>set</code> fixes it? linarith is doing great with random simple examples obfuscated by <code>let</code>, for me</p>



<a name="200712512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712512">(Jun 12 2020 at 19:14)</a>:</h4>
<p>There are changes to <code>linarith</code> on the cards -- go to the <a href="https://github.com/leanprover-community/mathlib">mathlib github page</a>, click on "pull requests" and then search for linarith. You can see the current state of the pull requests and what people are saying about them. Rob Lewis is the guy who wrote it and who was away for a while recently.</p>



<a name="200712853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200712853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200712853">(Jun 12 2020 at 19:18)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- OK</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- not OK</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">set</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span> <span class="k">with</span> <span class="n">eq</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- OK</span>
<span class="kn">end</span>
</code></pre></div>



<a name="200713710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200713710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200713710">(Jun 12 2020 at 19:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Massot.20Exercise.200037/near/200712512">said</a>:</p>
<blockquote>
<p>There are changes to <code>linarith</code> on the cards -- go to the <a href="https://github.com/leanprover-community/mathlib">mathlib github page</a></p>
</blockquote>
<p>Thanks for directing me to the PRs.  I'll keep an eye open, and once it's in maybe I'll try to figure out how to modify <code>linarith</code> to deal with <code>let</code> definitions and see if it causes anything to go wrong.</p>



<a name="200714037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200714037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200714037">(Jun 12 2020 at 19:26)</a>:</h4>
<p>Here are the examples, a bit less contrived:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- OK</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- not OK</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">set</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span> <span class="k">with</span> <span class="n">eq</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span> <span class="c1">-- OK</span>
<span class="kn">end</span>
</code></pre></div>



<a name="200715644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200715644" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200715644">(Jun 12 2020 at 19:40)</a>:</h4>
<p>Because I don't understand <code>let</code>, I fear that asking Rob/Mario to make this work is precisely one of these "just one more thing" requests. It's not even clear to me that a PR would be welcome. If you understand more about computers than I do then feel free to engage them on the topic over in #maths, they'll happily try and explain the issues to you I'm sure. For all I know it is a reasonable request. Once when this came up Rob wrote <code>set</code> for me, and I've been using <code>set</code> ever since.</p>



<a name="200716803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200716803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200716803">(Jun 12 2020 at 19:50)</a>:</h4>
<p>Thanks for pushing for <code>set</code> -- it's definitely a nice quality of life improvement.</p>
<p>I think the reason we've been noticing this is because of all the limit proofs in Massot's tutorials.  You frequently need to specialize some limit at some particular epsilon, and before we knew about <code>set</code> we would avoid <code>let</code> definitions altogether because <code>linarith</code> wouldn't be able to fill in the positivity proof:</p>
<div class="codehilite"><pre><span></span><code><span class="n">set</span> <span class="n">ε</span> <span class="o">:=</span> <span class="o">(</span><span class="n">u</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">l</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span> <span class="k">with</span> <span class="n">εeq</span><span class="o">,</span>
<span class="n">specialize</span> <span class="n">h</span> <span class="n">ε</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">),</span>
</code></pre></div>



<a name="200718154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200718154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200718154">(Jun 12 2020 at 20:02)</a>:</h4>
<p>A lot of the enhancements made by Rob and Mario and people Rob has supervised have come from people just trying to do maths in #maths, running into problems, asking for help, and then these people have selflessly made tools for us. We have <code>norm_num</code> because I was whinging that I couldn't solve (4 : real) &lt; 5. Then I started getting undergraduates interested and they ran into problems with algebra, so Mario wrote <code>ring</code>, and then they ran into problems with moving freely from <code>nat</code> to <code>int</code> and so Rob supervised a student to write <code>norm_cast</code>. I have had an extremely positive experience with these CS people. Whenever we run into problems, they try to help us out. This is one of the reasons that I've stuck around -- we run into problems when trying to do mathematics, and they solve them for us. I think one of the reasons it works like this is that writing tactics in Lean is perhaps not too hard to do if you know what you're doing -- or perhaps these people are looking for publications -- who knows. But if you are trying to do mathematics and running into problems, <a class="stream" data-stream-id="116395" href="/#narrow/stream/116395-maths">#maths</a> is the place to go.</p>



<a name="200724631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200724631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin McPhail-Snyder <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200724631">(Jun 12 2020 at 21:07)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I didn't know about <code>set</code> and I think my frustration was caused by trying to use <code>let</code> instead. Thanks!</p>



<a name="200724660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200724660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200724660">(Jun 12 2020 at 21:07)</a>:</h4>
<p>I think <code>set</code> was written after the tutorials were made right?</p>



<a name="200724801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200724801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200724801">(Jun 12 2020 at 21:09)</a>:</h4>
<p>At some point when I was doing the tutorials I kept writing things like <code>have : \exists N, N \ge N1 \and N \ge N2 := begin use max N1 N2, ....</code> and then doing cases with the resulting statement to get around this issue</p>



<a name="200724815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Massot%20Exercise%200037/near/200724815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Massot.20Exercise.200037.html#200724815">(Jun 12 2020 at 21:09)</a>:</h4>
<p>learning about <code>set</code> was pretty nice after that</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>