---
layout: archive
title: Zulip Chat Archive
permalink: /stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/index.html">Berkeley Lean Seminar</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html">Unfolding Definitions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="201068669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201068669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201068669">(Jun 16 2020 at 20:19)</a>:</h4>
<p>I was playing around with unfolding definitions and I was getting a little stuck. For example,</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">dsimp</span><span class="o">[(</span><span class="bp">≤</span><span class="o">)],</span>
<span class="kn">end</span>
</code></pre></div>


<p>turns the goal into</p>
<div class="codehilite"><pre><span></span><code><span class="err">⊢</span> <span class="mi">0</span><span class="bp">.</span><span class="n">less_than_or_equal</span> <span class="mi">1</span>
</code></pre></div>


<p>but after that, how would you unfold/unravel the definition of "less_than_or_equal_to"?</p>



<a name="201068771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201068771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201068771">(Jun 16 2020 at 20:20)</a>:</h4>
<p>Right click on the definition and peek it to see what it is.</p>



<a name="201068811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201068811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201068811">(Jun 16 2020 at 20:20)</a>:</h4>
<p>If you know how something is defined, it's much easier to figure out how to deal with it.</p>



<a name="201068918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201068918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201068918">(Jun 16 2020 at 20:21)</a>:</h4>
<p>Oh -- you'll have to write <code>#check nat.less_than_or_equal</code> -- we are still a couple of pull requests away from being able to click on stuff in the goal (it's coming soon)</p>



<a name="201069045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069045">(Jun 16 2020 at 20:22)</a>:</h4>
<p>Great, thanks!</p>



<a name="201069066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069066">(Jun 16 2020 at 20:22)</a>:</h4>
<p>So do you understand the definition?</p>



<a name="201069332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069332">(Jun 16 2020 at 20:24)</a>:</h4>
<p>I understand what it's doing, although I'm not familiar with some of the words/symbols used</p>



<a name="201069609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069609">(Jun 16 2020 at 20:27)</a>:</h4>
<p>The only command being used is <code>inductive</code> -- everything else is being defined. Did you look at chapter 7 of <a href="https://leanprover.github.io/theorem_proving_in_lean/">#tpil</a> on inductive types?</p>



<a name="201069779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069779">(Jun 16 2020 at 20:28)</a>:</h4>
<p>I'll take a look at that. I guess I was asking more about unfolding definitions in general, rather than this specific one.</p>



<a name="201069812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069812">(Jun 16 2020 at 20:29)</a>:</h4>
<p>If you write <code>#print prefix nat.less_than_or_equal</code> you'll see all the things generated when Lean made that inductive type, but most of them were generated by a computer and are of no relevance to you. The key things are <code>rec</code>, <code>refl</code> and <code>step</code>; everything else is made from them.</p>



<a name="201069893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201069893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201069893">(Jun 16 2020 at 20:29)</a>:</h4>
<p>To deal with unfolding in general you need to know what's going on. The techniques vary depending on what the thing you're trying to get to the bottom of is.</p>



<a name="201070455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201070455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201070455">(Jun 16 2020 at 20:34)</a>:</h4>
<p>Got it</p>



<a name="201070735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201070735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201070735">(Jun 16 2020 at 20:36)</a>:</h4>
<p><code>unfold X</code> means something like <code>simp only [X._equation_lemma_1, X._equation_lemma_2, ...]</code> so it only works for things with equation lemmas, e.g. a definition made using the equation compiler and some other definitions. I'm not sure there's a general answer to your question. Often if you look at the definition of something then directly after it there's a lemma proved which shows you how to unfold the thing using a rewrite.</p>



<a name="201071378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201071378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201071378">(Jun 16 2020 at 20:43)</a>:</h4>
<p>My understanding is also that <code>dsimp</code> does things like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>-reduction. Is that correct?</p>



<a name="201071671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201071671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201071671">(Jun 16 2020 at 20:46)</a>:</h4>
<p>Yes I think it does, although you might be able to switch this off somehow with some option to dsimp</p>



<a name="201072644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201072644" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Lutz <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201072644">(Jun 16 2020 at 20:54)</a>:</h4>
<p>What if you only want to do <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>-reduction and nothing else?</p>



<a name="201072767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201072767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201072767">(Jun 16 2020 at 20:55)</a>:</h4>
<p>You can do it manually with <code>change</code>, or there might be some options to <code>simp</code>, or there will be some weird way of doing it using some meta command which does precisely beta reduction. You could ask in #general, preferably with an explicit example</p>



<a name="201075243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201075243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201075243">(Jun 16 2020 at 21:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="298851">Patrick Lutz</span> <a href="#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Unfolding.20Definitions/near/201072644">said</a>:</p>
<blockquote>
<p>What if you only want to do <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>-reduction and nothing else?</p>
</blockquote>
<p>I don't know exactly what it does, but <code>dsimp only</code> (short for <code>dsimp only []</code>) does <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>-reductions and seemingly little (if anything) else.  I've been using <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>'s suggestion of <code>change</code>, too, for getting things into the right form.  The <code>convert_to</code> tactic looks interesting, but I haven't tried it yet.</p>



<a name="201097744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201097744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201097744">(Jun 17 2020 at 03:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Unfolding.20Definitions/near/201068771">said</a>:</p>
<blockquote>
<p>Right click on the definition and peek it to see what it is.</p>
</blockquote>
<p>I haven't understood why it looks like</p>
<div class="codehilite"><pre><span></span><code><span class="kn">inductive</span> <span class="n">less_than_or_equal</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">refl</span> <span class="o">:</span> <span class="n">less_than_or_equal</span> <span class="n">a</span>
<span class="bp">|</span> <span class="n">step</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">b</span><span class="o">},</span> <span class="n">less_than_or_equal</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">less_than_or_equal</span> <span class="o">(</span><span class="n">succ</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>


<p>rather than something like</p>
<div class="codehilite"><pre><span></span><code><span class="kn">inductive</span> <span class="n">my_less_than_or_equal</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">refl</span> <span class="o">{</span><span class="n">a</span><span class="o">}</span> <span class="o">:</span> <span class="n">my_less_than_or_equal</span> <span class="n">a</span> <span class="n">a</span>
<span class="bp">|</span> <span class="n">step</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">my_less_than_or_equal</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">my_less_than_or_equal</span> <span class="n">a</span> <span class="o">(</span><span class="n">succ</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>


<p>Is it just a matter of taste to factor out the <code>a</code>?  (I've seen this pattern elsewhere in the standard library and mathlib, too.)</p>



<a name="201104625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/240192-Berkeley%20Lean%20Seminar/topic/Unfolding%20Definitions/near/201104625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/240192-Berkeley-Lean-Seminar/topic/Unfolding.20Definitions.html#201104625">(Jun 17 2020 at 06:09)</a>:</h4>
<p>Yes I <em>think</em> it's just a matter of taste. You could ask the experts to make sure</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>