---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html">#7948 `nontrivial` instance for `nnreal`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="242717116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717116">(Jun 15 2021 at 11:01)</a>:</h4>
<p>There are probably about ten ways to do this, and I've picked the easiest but most-obviously-wrong way (i.e. just noting explicitly that <code>0</code> is not <code>1</code>). What's the Right Way? I imagine there's a way to make it completely automatic, since nnreal is a <code>semiring</code>, but I'm new to Lean's type classes and mathlib's hierarchy. <a href="https://github.com/leanprover-community/mathlib/pull/7948">https://github.com/leanprover-community/mathlib/pull/7948</a></p>



<a name="242717278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717278">(Jun 15 2021 at 11:03)</a>:</h4>
<p>I think the right way is to note that <code>nnreal</code> is a <code>semiring</code> that is <code>char_zero</code>.</p>



<a name="242717295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717295">(Jun 15 2021 at 11:03)</a>:</h4>
<p>Because those satisfy <code>0 \ne 1</code></p>



<a name="242717362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717362">(Jun 15 2021 at 11:04)</a>:</h4>
<p>Showing my unfamiliarity with type classes: do you think it's likely there will have to be a line in <code>nnreal.lean</code>, or is it possible that some general fact further up the hierarchy will allow a type class to be generated automatically without any change to <code>nnreal.lean</code>?</p>



<a name="242717526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717526">(Jun 15 2021 at 11:06)</a>:</h4>
<p>There should be enough in <code>nnreal.lean</code> already.</p>



<a name="242717549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717549">(Jun 15 2021 at 11:07)</a>:</h4>
<p>I think <code>nontrivial</code> also follows from <code>archimedean</code> or from <code>canonically_ordered_semiring</code></p>



<a name="242717611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717611">(Jun 15 2021 at 11:07)</a>:</h4>
<p>It also follows from <code>infinite</code>.</p>



<a name="242717617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717617">(Jun 15 2021 at 11:07)</a>:</h4>
<p><code>example : nontrivial nnreal := by suggest</code> finds three different existing ways</p>



<a name="242717653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717653">(Jun 15 2021 at 11:08)</a>:</h4>
<p>one of which is from infinite</p>



<a name="242717698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717698">(Jun 15 2021 at 11:08)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">exact</span> <span class="n">infinite.nontrivial</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">exact</span> <span class="n">group_with_zero.to_nontrivial</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">exact</span> <span class="n">linear_ordered_semiring.to_nontrivial</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span>
</code></pre></div>



<a name="242717706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717706">(Jun 15 2021 at 11:08)</a>:</h4>
<p>On the other hand, <code>nontrivial</code> is a <code>Prop</code> so in a certain sense it does not matter too much how you do it.</p>



<a name="242717709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717709">(Jun 15 2021 at 11:08)</a>:</h4>
<p><code>by apply_instance</code> produces <code>exact infinite.nontrivial ℝ≥0</code>.</p>



<a name="242717764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717764">(Jun 15 2021 at 11:09)</a>:</h4>
<p>I guess I knew already that there are dozens of maths-reasons why nnreal is <code>nontrivial</code>; my question is more about what the Right Way is for Lean, e.g. is there a change that can be made upstream somewhere so that literally no textual change needs to be made to <code>nnreal.lean</code></p>



<a name="242717773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717773">(Jun 15 2021 at 11:09)</a>:</h4>
<p>So, the <em>correct</em> answer is that ℝ≥0 is infinite!  <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="242717955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242717955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242717955">(Jun 15 2021 at 11:11)</a>:</h4>
<p>I think that the instance is already there.  If Lean is asking for a proof of <code>nontrivial ℝ≥0</code>, you may have gotten to this stage using, e.g., <code>apply</code> instead of <code>refine</code>.  This is where I see these spurious instance requests appearing.</p>



<a name="242718046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242718046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242718046">(Jun 15 2021 at 11:12)</a>:</h4>
<p>Ah, I think that is probably why I ended up wanting this - so it's very likely this PR is actually completely unnecessary, and I should go back and use <code>refine</code> instead of <code>apply</code> at the point where I found myself needing this</p>



<a name="242718057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242718057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242718057">(Jun 15 2021 at 11:12)</a>:</h4>
<p>Thanks, that sounds like the Right Answer to me!</p>



<a name="242718060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242718060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242718060">(Jun 15 2021 at 11:12)</a>:</h4>
<p>In fact, <code>infinite nnreal</code> is derived by the typeclass system from <code>char_zero nnreal</code>, which is derived from <code>linear_ordered_semiring nnreal</code>.</p>



<a name="242718104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242718104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242718104">(Jun 15 2021 at 11:13)</a>:</h4>
<p>So <span class="user-mention" data-user-id="112680">@Johan Commelin</span> is also correct!</p>



<a name="242718184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237948%20%60nontrivial%60%20instance%20for%20%60nnreal%60/near/242718184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237948.20.60nontrivial.60.20instance.20for.20.60nnreal.60.html#242718184">(Jun 15 2021 at 11:14)</a>:</h4>
<p>Patrick, as far as I understand, <code>refine</code> uses more of the given types, while <code>apply</code> "starts from scratch".  Thus, <code>refine</code> will often find instances that are automatic, while <code>apply</code> sometimes misses them.  However, sometimes <code>apply</code> works, while <code>refine</code> does not... it is a bit of an art and a bit of black magic!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>