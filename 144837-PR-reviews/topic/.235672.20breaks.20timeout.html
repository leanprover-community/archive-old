---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html">#5672 breaks timeout</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="223001979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223001979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223001979">(Jan 16 2021 at 19:43)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5672">#5672</a> doesn't build, not because of the files that it modifies, but because then it times out in a completely unrelated file (<code>times_cont_mdiff.lean</code> in the manifold part). Indeed, the theorem <a href="https://leanprover-community.github.io/mathlib_docs/find/times_cont_mdiff_on.times_cont_mdiff_on_tangent_map_within">docs#times_cont_mdiff_on.times_cont_mdiff_on_tangent_map_within</a> takes, on my computer, 27s on master and 30s with the PR.</p>
<p>I tried to understand a little bit what is going on. It turns out that, in the proofs of this file, every call to <code>simp</code> tries to show that everything is a subsingleton. I mean, for instance, if I replace the proof of a lemma with <code>simp only</code> like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">times_cont_diff_within_at_local_invariant_prop_mono</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">‚Ñï</span><span class="o">)</span>
  <span class="o">‚¶É</span><span class="n">s</span> <span class="n">x</span> <span class="n">t</span><span class="o">‚¶Ñ</span> <span class="o">‚¶É</span><span class="n">f</span> <span class="o">:</span> <span class="n">H</span> <span class="bp">‚Üí</span> <span class="n">H'</span><span class="o">‚¶Ñ</span> <span class="o">(</span><span class="n">hts</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">‚äÜ</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">times_cont_diff_within_at_prop</span> <span class="n">I</span> <span class="n">I'</span> <span class="n">n</span> <span class="n">f</span> <span class="n">s</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">times_cont_diff_within_at_prop</span> <span class="n">I</span> <span class="n">I'</span> <span class="n">n</span> <span class="n">f</span> <span class="n">t</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>then the trace instance of the <code>simp only</code> starts with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">category_theory.is_iso.subsingleton</span> <span class="bp">?</span><span class="n">x_1</span> <span class="bp">?</span><span class="n">x_2</span> <span class="bp">?</span><span class="n">x_3</span> <span class="bp">?</span><span class="n">x_4</span> <span class="bp">?</span><span class="n">x_5</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
</code></pre></div>
<p>Then, after a long time checking that it can not prove that <code>Type u_1</code> is a subsingleton, it tries to prove <code>subsingleton (nondiscrete_normed_field ùïú)</code> (and fails again). Then <code>subsingleton (Type u_2)</code>. And so on, on every object that shows up in the statement. And the output stops with <code>message too long, truncated at 262144 characters</code>. So, I am not surprised that <a href="https://github.com/leanprover-community/mathlib/issues/5672">#5672</a>, that introduces a new way to check that something is a subsingleton, increases the compile time. Of course, <a href="https://github.com/leanprover-community/mathlib/issues/5672">#5672</a> is not at fault, but I don't understand what is going on here.</p>



<a name="223002393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223002393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223002393">(Jan 16 2021 at 19:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> aah, in the PR there was also a timeout with <code>witt_vector</code>, see the PR page.</p>



<a name="223002444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223002444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223002444">(Jan 16 2021 at 19:54)</a>:</h4>
<p>The issue there was that I was using <code>convert</code> and probably it was now looking for some <code>subsingleton</code> instance and spending a lot of time on that. So I changed it to <code>convert ... using 1</code> and the problem was gone.</p>



<a name="223002458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223002458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223002458">(Jan 16 2021 at 19:55)</a>:</h4>
<p>But, with <code>simp</code> the solution is maybe not so easy...</p>



<a name="223002463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223002463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223002463">(Jan 16 2021 at 19:55)</a>:</h4>
<p>In fact <code>simp</code> does that in all the files. This seems crazy. I don't think it has always been like that. <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> , is there a recent change to Lean that might have changed the simp behavior?</p>



<a name="223003065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223003065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223003065">(Jan 16 2021 at 20:09)</a>:</h4>
<p>I think it's always done that. I remember a long time ago tracking some horrible <code>simp</code> behavior in category theory to some bad <code>subsingleton</code> lemmas</p>



<a name="223003127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223003127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223003127">(Jan 16 2021 at 20:10)</a>:</h4>
<p>I have wondered if <a href="https://leanprover-community.github.io/mathlib_docs/find/eq_iff_true_of_subsingleton">docs#eq_iff_true_of_subsingleton</a> is a bad simp lemma, but it doesn't seem to be the culprit here</p>



<a name="223004186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223004186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223004186">(Jan 16 2021 at 20:23)</a>:</h4>
<p>Indeed, I have tried to go back a little bit in time, and I always see this behavior. Is there a good reason for this? It looks like a major performance problem to me.</p>



<a name="223005082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223005082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223005082">(Jan 16 2021 at 20:42)</a>:</h4>
<p>As a data point, <a href="https://leanprover-community.github.io/mathlib_docs/find/times_cont_mdiff_on.times_cont_mdiff_on_tangent_map_within">docs#times_cont_mdiff_on.times_cont_mdiff_on_tangent_map_within</a> takes 27s to compile on my computer. If I add <code>local attribute [-instance]</code> to all subsingleton instances, it drops to 5s. Given this, I think we should either fix simp, or disable all the subsingleton instances and only activate them locally where needed. Thoughts?</p>



<a name="223006591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223006591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223006591">(Jan 16 2021 at 21:12)</a>:</h4>
<p>wow, that's a pretty impressive speedup</p>



<a name="223006768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223006768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223006768">(Jan 16 2021 at 21:15)</a>:</h4>
<p>Just adding <code>local attribute [-instance] unique.subsingleton pi.subsingleton</code> is enough to go from 27s to 9s. I'm wondering if I should add these to <code>open_locale manifold</code> for now, as the manifold code is very <code>simp</code>-heavy, while waiting for a more proper fix.</p>



<a name="223006961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223006961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223006961">(Jan 16 2021 at 21:19)</a>:</h4>
<p>If you add those to the manifold files, what is the speed gain for that part of the library?</p>



<a name="223007008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223007008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223007008">(Jan 16 2021 at 21:20)</a>:</h4>
<p>sounds like you might shave off several minutes</p>



<a name="223007111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223007111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223007111">(Jan 16 2021 at 21:22)</a>:</h4>
<p>That's likely. Fixing simp over the whole library should even be much more substantial.</p>



<a name="223007908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223007908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223007908">(Jan 16 2021 at 21:39)</a>:</h4>
<p>I'm taking this PR off the queue again... another batch failed just now</p>



<a name="223007975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223007975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223007975">(Jan 16 2021 at 21:41)</a>:</h4>
<p>I'm confused how it ended back on the queue, since it was already canceled.</p>



<a name="223007983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223007983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223007983">(Jan 16 2021 at 21:41)</a>:</h4>
<p>I don't understand what bors is doing. Normally, it should have been cancelled when I merged master.</p>



<a name="223008043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223008043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223008043">(Jan 16 2021 at 21:42)</a>:</h4>
<p>You don't understand bors, you just get used to it...</p>



<a name="223008178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223008178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223008178">(Jan 16 2021 at 21:46)</a>:</h4>
<p>Well, I opened an issue <a href="https://github.com/bors-ng/bors-ng/issues/1130">https://github.com/bors-ng/bors-ng/issues/1130</a></p>



<a name="223008310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223008310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223008310">(Jan 16 2021 at 21:49)</a>:</h4>
<p><code>hack(manifold): ...</code> --- should we update the style guide to include hacks?</p>



<a name="223008311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223008311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223008311">(Jan 16 2021 at 21:49)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5779">#5779</a>. I'd be curious to know how much it shaves off the compile time.</p>



<a name="223008315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223008315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223008315">(Jan 16 2021 at 21:49)</a>:</h4>
<p>I couldn't find a better name :-)</p>



<a name="223034339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034339">(Jan 17 2021 at 09:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="#narrow/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout/near/223007111">said</a>:</p>
<blockquote>
<p>That's likely. Fixing simp over the whole library should even be much more substantial.</p>
</blockquote>
<p>In principle failures to infer <code>subsingleton</code> should be cached, and there seems to be something pathological in these examples. I have no sense of what kind of effect a change here would have on the whole library, either in terms of breakage or speedup.</p>



<a name="223034447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034447">(Jan 17 2021 at 09:38)</a>:</h4>
<p>Yes they are cached. But when there are many types around it takes apparently a lot of time to check that all of them are not subsingletons. I would understand if <code>simp</code> tried to see if there is a subsingleton when it sees an equality <code>x = y</code> and wants to discharge it. But the problem is that it does check for subsingletons even when there is no equality to be discharged, before trying anything else.</p>



<a name="223034551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034551">(Jan 17 2021 at 09:41)</a>:</h4>
<p><code>simp</code> uses <code>congr</code> to traverse terms, and <code>congr</code> checks all of the function's arguments for subsingleton to see if that subterm equality proof can be elided</p>



<a name="223034778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034778">(Jan 17 2021 at 09:48)</a>:</h4>
<p>Can you say a little bit more about that? Is it something like <code>simp</code>sees <code>f a b : alpha</code>, and down the road it simplifies <code>a</code>to <code>a'</code>, so it will reduce <code>f a b</code> to <code>f a ' b</code> and build a proof of the reduction. But if <code>alpha</code> were a subsingleton then the reduction would be for free, so it would use that instead as a shortcut?</p>



<a name="223034911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034911">(Jan 17 2021 at 09:52)</a>:</h4>
<p>If simp sees <code>f a b</code>, before it traverses into the subterms, it first needs a congr theorem to apply. So it asks <code>congr</code> to build a congr lemma for <code>f</code>, that is, a theorem of the form <code>x = x' -&gt; y = y' -&gt; f x y = f x' y'</code>, and while doing so congr will try to see if it can discharge one of the <code>x = x'</code> and <code>y = y'</code> theorems using <code>subsingleton.elim</code>. Let's say it's successful in discharging <code>y = y'</code>; then it will return to simp the theorem <code>x = x' -&gt; f x y = f x' y'</code>, and then simp will simplify <code>a</code> to <code>a'</code> and return <code>f a' b</code></p>



<a name="223034917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034917">(Jan 17 2021 at 09:52)</a>:</h4>
<p>I'm not sure if it tries to simplify <code>b</code> as well under these circumstances, I think it just ignores it</p>



<a name="223034983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223034983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223034983">(Jan 17 2021 at 09:55)</a>:</h4>
<p>Just for the record of what we are talking about. Given the lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">set_option</span> <span class="n">trace.class_instances</span> <span class="n">true</span>

<span class="kd">lemma</span> <span class="n">zou</span> <span class="o">(</span><span class="n">Œ±</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Œ±</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>the instance trace that shows up when clicking on the <code>simp</code> is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">order_dual.subsingleton</span> <span class="bp">?</span><span class="n">x_1</span> <span class="bp">?</span><span class="n">x_2</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton_unique</span> <span class="bp">?</span><span class="n">x_3</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">trunc.subsingleton</span> <span class="bp">?</span><span class="n">x_4</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">subsingleton_pempty</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">subsingleton.prod</span> <span class="bp">?</span><span class="n">x_5</span> <span class="bp">?</span><span class="n">x_6</span> <span class="bp">?</span><span class="n">x_7</span> <span class="bp">?</span><span class="n">x_8</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">empty.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">punit.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.subsingleton</span> <span class="bp">?</span><span class="n">x_9</span> <span class="bp">?</span><span class="n">x_10</span> <span class="bp">?</span><span class="n">x_11</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">decidable.subsingleton</span> <span class="bp">?</span><span class="n">x_12</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">subsingleton_prop</span> <span class="bp">?</span><span class="n">x_13</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton</span> <span class="bp">?</span><span class="n">x_14</span> <span class="bp">?</span><span class="n">x_15</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">set.unique_singleton</span> <span class="bp">?</span><span class="n">x_16</span> <span class="bp">?</span><span class="n">x_17</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.unique</span> <span class="bp">?</span><span class="n">x_18</span> <span class="bp">?</span><span class="n">x_19</span> <span class="bp">?</span><span class="n">x_20</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">fin.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">punit.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">unique</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">order_dual.subsingleton</span> <span class="bp">?</span><span class="n">x_1</span> <span class="bp">?</span><span class="n">x_2</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton_unique</span> <span class="bp">?</span><span class="n">x_3</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">trunc.subsingleton</span> <span class="bp">?</span><span class="n">x_4</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">subsingleton_pempty</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">subsingleton.prod</span> <span class="bp">?</span><span class="n">x_5</span> <span class="bp">?</span><span class="n">x_6</span> <span class="bp">?</span><span class="n">x_7</span> <span class="bp">?</span><span class="n">x_8</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">empty.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">punit.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.subsingleton</span> <span class="bp">?</span><span class="n">x_9</span> <span class="bp">?</span><span class="n">x_10</span> <span class="bp">?</span><span class="n">x_11</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">decidable.subsingleton</span> <span class="bp">?</span><span class="n">x_12</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">subsingleton_prop</span> <span class="bp">?</span><span class="n">x_13</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton</span> <span class="bp">?</span><span class="n">x_14</span> <span class="bp">?</span><span class="n">x_15</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">set.unique_singleton</span> <span class="bp">?</span><span class="n">x_16</span> <span class="bp">?</span><span class="n">x_17</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.unique</span> <span class="bp">?</span><span class="n">x_18</span> <span class="bp">?</span><span class="n">x_19</span> <span class="bp">?</span><span class="n">x_20</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">fin.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">punit.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">unique</span> <span class="n">Œ±</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="n">Œ±</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="n">Œ±</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">order_dual.subsingleton</span> <span class="bp">?</span><span class="n">x_1</span> <span class="bp">?</span><span class="n">x_2</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton_unique</span> <span class="bp">?</span><span class="n">x_3</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">trunc.subsingleton</span> <span class="bp">?</span><span class="n">x_4</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">subsingleton_pempty</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">subsingleton.prod</span> <span class="bp">?</span><span class="n">x_5</span> <span class="bp">?</span><span class="n">x_6</span> <span class="bp">?</span><span class="n">x_7</span> <span class="bp">?</span><span class="n">x_8</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">empty.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">punit.subsingleton</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.subsingleton</span> <span class="bp">?</span><span class="n">x_9</span> <span class="bp">?</span><span class="n">x_10</span> <span class="bp">?</span><span class="n">x_11</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">decidable.subsingleton</span> <span class="bp">?</span><span class="n">x_12</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">subsingleton_prop</span> <span class="bp">?</span><span class="n">x_13</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">unique.subsingleton</span> <span class="bp">?</span><span class="n">x_14</span> <span class="bp">?</span><span class="n">x_15</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">set.unique_singleton</span> <span class="bp">?</span><span class="n">x_16</span> <span class="bp">?</span><span class="n">x_17</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">pi.unique</span> <span class="bp">?</span><span class="n">x_18</span> <span class="bp">?</span><span class="n">x_19</span> <span class="bp">?</span><span class="n">x_20</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">fin.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_15</span> <span class="o">:</span> <span class="n">unique</span> <span class="n">Œ±</span> <span class="o">:=</span> <span class="n">punit.unique</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">unique</span> <span class="n">Œ±</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="n">Œ±</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="n">caching</span> <span class="n">failure</span> <span class="n">for</span> <span class="n">subsingleton</span> <span class="n">Œ±</span>
</code></pre></div>
<p>(Not sure that the cache is working optimally here, by the way)</p>



<a name="223035160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223035160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223035160">(Jan 17 2021 at 10:00)</a>:</h4>
<p>My guess is that this is happening during the construction of a congr lemma for <code>eq</code></p>



<a name="223035318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223035318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223035318">(Jan 17 2021 at 10:04)</a>:</h4>
<p>Do you think there would be a way to disable this for <code>congr</code> when it is called from <code>simp</code> (or maybe just use cached subsingleton instances, but don't look for new ones -- and cache once and for all beforehand the fact that Prop is a subsingleton, this one is definitely relevant)? Since most types aren't subsingletons, this seems like a waste of time.</p>



<a name="223035399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223035399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223035399">(Jan 17 2021 at 10:06)</a>:</h4>
<p>Here's an example of using the congr lemma generator directly (if you trace instances you will see the same subsingleton searches come up)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">open</span> <span class="n">tactic</span>
<span class="kd">lemma</span> <span class="n">zou</span> <span class="o">(</span><span class="n">Œ±</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Œ±</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="k">do</span>
  <span class="n">t</span> <span class="bp">‚Üê</span> <span class="n">target</span><span class="o">,</span>
  <span class="n">lem</span> <span class="bp">‚Üê</span> <span class="n">mk_specialized_congr_lemma_simp</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">trace</span> <span class="n">lem.type</span>
</code></pre></div>



<a name="223035426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223035426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223035426">(Jan 17 2021 at 10:07)</a>:</h4>
<p>This trick has always struck me as a waste of time. I think it should be a default-disabled simp option</p>



<a name="223035502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223035502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223035502">(Jan 17 2021 at 10:09)</a>:</h4>
<p>it's certainly occasionally useful, for example when you want to get out of a pickle involving a diamond that doesn't definitionally commute, but it's not something that is worth checking all the time</p>



<a name="223232442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223232442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223232442">(Jan 19 2021 at 14:22)</a>:</h4>
<p>I just did a nonscientific test with the <code>simp_nf</code> linter. Adding <code>local attribute [-instance] unique.subsingleton pi.subsingleton</code> before running it shaved off 16% of the runtime.</p>



<a name="223232576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/223232576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#223232576">(Jan 19 2021 at 14:23)</a>:</h4>
<p>So this seems like a pretty significant performance hit in general, one that's worth taking a look at.</p>



<a name="224042101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224042101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224042101">(Jan 26 2021 at 14:00)</a>:</h4>
<p>Playing a little bit more with this -- a proof in <a href="https://github.com/leanprover-community/mathlib/issues/5878">#5878</a> takes 30s on my computer, adding <code>local attribute [-instance] unique.subsingleton pi.subsingleton</code> makes it twice as fast. I noticed that there is a caching issue: all <code>simp</code> calls in the proof try to show that the same types are not subsingletons, again and again and again. Mwe:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.specific_limits</span>

<span class="kd">set_option</span> <span class="n">trace.class_instances</span> <span class="n">true</span>

<span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">Œ±</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="n">t</span> <span class="o">:</span> <span class="n">Œ±</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">hy</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">t</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">hy</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>Both <code>simp</code> calls try to show that <code>Type u_1</code> is a subsingleton, and that <code>Œ±</code> is a subsingleton. I.e., the instance search for the first call is not cached for the second one. <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> , is it something to be expected? (Btw, it also tries to show that <code>Œ±</code> is an <code>add_comm_monoid</code>, for some reason I don't get -- this is not cached either from one simp call to the next)</p>



<a name="224050187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224050187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224050187">(Jan 26 2021 at 14:56)</a>:</h4>
<p>It's not expected.  Type class caching should work across tactics.  But I don't have time to debug this at the moment.</p>



<a name="224052678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224052678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224052678">(Jan 26 2021 at 15:13)</a>:</h4>
<p>It's definitely very low priority since Lean 4 is coming.</p>



<a name="224053328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224053328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224053328">(Jan 26 2021 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> should we just add a bunch of these instances to locales? Even if Lean 4 is around the corner, I don't mind shaving several multiples of 10 minutes from the total compile time.</p>



<a name="224053762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224053762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224053762">(Jan 26 2021 at 15:20)</a>:</h4>
<p>The thing is that these instances are sometimes useful. To craft  <a href="https://github.com/leanprover-community/mathlib/tree/singleton_instances">branch#singleton_instances</a>, I had to fix all the breakage coming from disabling just <code>unique.subsingleton</code>, and there were many of them.  And in the end it's really just a hack, which might trip some people since it makes <code>simp</code> or <code>congr</code> effectively less powerful.</p>



<a name="224054165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224054165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224054165">(Jan 26 2021 at 15:23)</a>:</h4>
<p>So personnally I'd go for proper fix or no fix -- slightly longer compile time is not really a problem when it's not done on my computer :-)</p>



<a name="224054207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224054207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224054207">(Jan 26 2021 at 15:23)</a>:</h4>
<p>ok, agreed</p>



<a name="224054749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/224054749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#224054749">(Jan 26 2021 at 15:26)</a>:</h4>
<p>I have registered an issue <a href="https://github.com/leanprover-community/lean/issues/521">lean#521</a> to make sure it's not completely forgotten.</p>



<a name="225144614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/225144614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#225144614">(Feb 04 2021 at 10:59)</a>:</h4>
<p>In recent PRs we've recently stopped adding any more subsingleton instances. I've filed <a href="https://github.com/leanprover-community/mathlib/issues/6025">#6025</a> to track the fact we're doing that, so that we can eventually convert them back to instances once all is fixed</p>



<a name="228692045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/228692045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#228692045">(Mar 04 2021 at 00:07)</a>:</h4>
<p>I was having performance problems with proofs that use a lot of <code>simp only</code>s, and when I traced the simplifier, I saw all the subsingleton nonsense. Floris pointed me to this thread, and disabling them worked beautifully. For the record, below is a locale I made to solve the problem. (I harvested all the names from the simplifier trace.)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">localized</span> <span class="s2">"attribute [-instance] unique.subsingleton pi.subsingleton invertible.subsingleton</span>
<span class="s2">subsingleton_fin_one subsingleton_fin_zero zmod.subsingleton_units fintype.subsingleton</span>
<span class="s2">principal_seg.subsingleton initial_seg.subsingleton zmod.subsingleton_ring_equiv</span>
<span class="s2">zmod.subsingleton_ring_hom nat_algebra_subsingleton int_algebra_subsingleton</span>
<span class="s2">add_comm_group.module.subsingleton rat.subsingleton_ring_hom vector.zero_subsingleton</span>
<span class="s2">ring_hom.int.subsingleton_ring_hom nat.subsingleton_ring_hom plift.subsingleton ulift.subsingleton</span>
<span class="s2">unique.subsingleton_unique trunc.subsingleton subsingleton_pempty subsingleton.prod</span>
<span class="s2">empty.subsingleton punit.subsingleton decidable.subsingleton subsingleton_prop char_p.subsingleton"</span>
<span class="k">in</span> <span class="n">disable_subsingleton_simps</span>
</code></pre></div>



<a name="228692618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/228692618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#228692618">(Mar 04 2021 at 00:12)</a>:</h4>
<p>If that's just every subsingleton instance, presumably <code>#print instances subsingleton</code> would harvest them too?</p>



<a name="228695254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/228695254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#228695254">(Mar 04 2021 at 00:37)</a>:</h4>
<p>Oh, uh, yeah.... Here's the list harvested from <code>#print instances</code>. If I counted right, it picked up one more.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">localized</span> <span class="s2">"attribute [-instance] principal_seg.subsingleton initial_seg.subsingleton</span>
<span class="s2">invertible.subsingleton subsingleton_fin_one subsingleton_fin_zero zmod.subsingleton_ring_equiv</span>
<span class="s2">zmod.subsingleton_ring_hom zmod.subsingleton_units nat_algebra_subsingleton int_algebra_subsingleton</span>
<span class="s2">add_comm_group.module.subsingleton rat.subsingleton_ring_hom fintype.subsingleton</span>
<span class="s2">vector.zero_subsingleton ring_hom.int.subsingleton_ring_hom nat.subsingleton_ring_hom</span>
<span class="s2">plift.subsingleton ulift.subsingleton unique.subsingleton_unique trunc.subsingleton</span>
<span class="s2">subsingleton_pempty subsingleton.prod empty.subsingleton punit.subsingleton pi.subsingleton</span>
<span class="s2">decidable.subsingleton char_p.subsingleton unique.subsingleton"</span>
<span class="k">in</span> <span class="n">disable_singleton_simps</span>
</code></pre></div>



<a name="228695421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/228695421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#228695421">(Mar 04 2021 at 00:40)</a>:</h4>
<p>Maybe two more.</p>



<a name="233324163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/233324163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#233324163">(Apr 06 2021 at 14:05)</a>:</h4>
<p>Is <a href="https://leanprover-community.github.io/mathlib_docs/find/eq_iff_true_of_subsingleton">docs#eq_iff_true_of_subsingleton</a> to blame here for subsingleton making <code>simp</code> slow?</p>



<a name="233701657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/233701657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#233701657">(Apr 08 2021 at 18:06)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> Could we check by timing mathlib with and without the simp lemma?</p>



<a name="233702044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/233702044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#233702044">(Apr 08 2021 at 18:09)</a>:</h4>
<p>Even finding a slow simp and replacing it with <code>simp [-eq_iff_true_of_subsingleton]</code> would be enough to check I think</p>



<a name="292866687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/292866687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hern√°ndez <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#292866687">(Aug 11 2022 at 04:47)</a>:</h4>
<p>Well Lean 4 still isn't here and this still isn't solved, has anything changed in the past 18 months?</p>



<a name="293036129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293036129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293036129">(Aug 12 2022 at 02:11)</a>:</h4>
<p>I guess <code>unique</code> instances are not so bad because once you disable <code>unique.subsingleton</code> (as some of the hacks above do) then they are no longer involved in <code>subsingleton</code> instance search ... The context is <a href="https://github.com/leanprover-community/mathlib/pull/16017#issuecomment-1212574728">#16017</a>.</p>
<p>If the changes to core Lean doesn't warrant a reconsideration of the ban on new subsingleton/unique instances, please let me know and I'll just close <a href="https://github.com/leanprover-community/mathlib/pull/16017">#16017</a>.</p>



<a name="293072256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293072256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293072256">(Aug 12 2022 at 09:20)</a>:</h4>
<p>The problem has been solved by <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span>  some time ago: simp no longer uses subsingleton instances, so the ban does not make sense any more.</p>



<a name="293121083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293121083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293121083">(Aug 12 2022 at 14:34)</a>:</h4>
<p>Thanks, that's great to know! Seems it's fixed in <a href="https://github.com/leanprover-community/lean/pull/665">lean#665</a> and it's been there for 7 months! I think <a href="https://github.com/leanprover-community/mathlib/pull/16017">#16017</a> can go ahead then? <span class="user-mention" data-user-id="310045">@Eric Wieser</span> </p>
<p>So we should probably make a PR to replace subsingleton defs that <a href="https://github.com/leanprover-community/mathlib/search?q=gh-6025">reference gh-6025</a> by instances, and then we can close <a href="https://github.com/leanprover-community/mathlib/pull/6025">#6025</a>.</p>



<a name="293135385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293135385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293135385">(Aug 12 2022 at 15:27)</a>:</h4>
<p>I think it would be best to start by removing the hacks, just to be sure they're no longer needed</p>



<a name="293138353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293138353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293138353">(Aug 12 2022 at 15:41)</a>:</h4>
<p>looks like <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> <a href="https://github.com/leanprover-community/mathlib/commit/c7626b7dfe2bf35b48cf43178a32d74f5dbf8b3f#diff-02976f8e19552b3c7ea070e30761e4e99f1333085cc5bb94fa170861c6ed27bcL497-L498">already removed one hack</a> mentioned above.</p>



<a name="293228091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293228091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293228091">(Aug 13 2022 at 05:28)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> I have benchmarked the performance before and after removing the hack in <em>analysis/normed_space/multilinear</em> using <code>set_option profiler true</code>. Below is the data collected (with numbers &lt; 1s omitted, and I only recorded "tactic execution" numbers at the beginning). I think the difference is pretty much negligible; with the hack (the left number) declarations compile slightly faster in general, but sometimes they compile faster without the hack (the right number). Of course these numbers may fluctuate due to multithreading etc. but you get the idea. Based on the numbers, I'm in favor of removing the hack.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">elaboration</span> <span class="n">of</span> <span class="n">bound_of_shell</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">55</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">89</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">62</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">86</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">exists_bound_of_continuous</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">22</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">46</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">49</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">66</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_image_sub_le_of_bound'</span> <span class="n">took</span> <span class="mi">9</span><span class="bp">.</span><span class="mi">84</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">10</span><span class="bp">.</span><span class="mi">7</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">65</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">7</span><span class="n">s</span>

<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">79</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">9</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">8</span><span class="bp">.</span><span class="mi">19</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">8</span><span class="bp">.</span><span class="mi">87</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_image_sub_le_of_bound</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">29</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">38</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">79</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">77</span><span class="n">s</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">28</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">28</span><span class="n">s</span>

<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">42</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">45</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_of_bound</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">89</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">86</span><span class="n">s</span>

<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">55</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">51</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">op_norm_zero_iff</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">19</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">22</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">op_norm_neg</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">56</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">64</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_pi</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">77</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">94</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">restrict_scalars_linear</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">23</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">4</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_eval</span> <span class="n">took</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">37</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">19</span><span class="n">s</span>

<span class="bp">!</span> <span class="n">elaboration</span> <span class="n">of</span> <span class="n">has_sum_eval</span> <span class="n">took</span> <span class="mi">6</span><span class="bp">.</span><span class="mi">38</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">98</span><span class="n">s</span>

<span class="bp">!</span> <span class="n">elaboration</span> <span class="n">of</span> <span class="n">complete_space</span> <span class="n">took</span> <span class="mi">8</span><span class="bp">.</span><span class="mi">62</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">7</span><span class="bp">.</span><span class="mi">67</span><span class="n">s</span>

<span class="bp">!</span> <span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_mk_pi_algebra_of_empty</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">75</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">32</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_mk_pi_algebra</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">06</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">73</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_mk_pi_algebra_fin_zero</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">12</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">88</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_mk_pi_algebra_fin</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">84</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">64</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">norm_mk_pi_field</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">64</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">37</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">pi_field_equiv</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">25</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">48</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">comp_continuous_multilinear_mapL</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">3</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">81</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">flip_multilinear</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">69</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">7</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">mk_continuous_linear</span> <span class="n">took</span> <span class="mi">14</span><span class="bp">.</span><span class="mi">9</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">15</span><span class="bp">.</span><span class="mi">1</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">mk_continuous_multilinear</span> <span class="n">took</span> <span class="mi">11</span><span class="bp">.</span><span class="mi">8</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">11</span><span class="bp">.</span><span class="mi">8</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.norm_map_cons_le</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">38</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">43</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.norm_map_snoc_le</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">33</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">42</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_curry_left_equiv</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">04</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">02</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.uncurry_right</span> <span class="n">took</span> <span class="mi">7</span><span class="bp">.</span><span class="mi">62</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">8</span><span class="bp">.</span><span class="mi">2</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.curry_right</span> <span class="n">took</span> <span class="mi">7</span><span class="bp">.</span><span class="mi">12</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">7</span><span class="bp">.</span><span class="mi">56</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.uncurry_curry_right</span> <span class="n">took</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">95</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">99</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_curry_right_equiv</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">21</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">19</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.apply_zero_curry0</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">28</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">68</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.uncurry0_curry0</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">49</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">16</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.curry0_norm</span> <span class="n">took</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">96</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">75</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.fin0_apply_norm</span> <span class="n">took</span> <span class="mi">8</span><span class="bp">.</span><span class="mi">27</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">7</span><span class="bp">.</span><span class="mi">74</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">continuous_multilinear_map.uncurry0_norm</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">56</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">18</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">curry_sum</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">71</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">39</span><span class="n">s</span>

<span class="bp">!</span> <span class="n">elaboration</span> <span class="n">of</span> <span class="n">uncurry_sum</span> <span class="n">took</span> <span class="mi">11</span><span class="bp">.</span><span class="mi">4</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">9</span><span class="bp">.</span><span class="mi">5</span><span class="n">s</span>

<span class="n">elaboration</span> <span class="n">of</span> <span class="n">curry_sum_equiv</span> <span class="n">took</span> <span class="mi">2</span><span class="bp">.</span><span class="mi">2</span><span class="n">s</span> <span class="bp">-</span> <span class="mi">1</span><span class="bp">.</span><span class="mi">77</span><span class="n">s</span>
</code></pre></div>



<a name="293228333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293228333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293228333">(Aug 13 2022 at 05:32)</a>:</h4>
<p>It would be harder to test the localized hack in <em>geometry/manifold/charted_space</em>, since the locale is not opened in the same file, and I'd need to find files with <code>open_locale manifold</code> to test it. Any recommendations?</p>



<a name="293228525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293228525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293228525">(Aug 13 2022 at 05:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> Since you added the manifold hack, do you have any file that you want me to test on, or should I just remove the hack without worrying about it?</p>



<a name="293229082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293229082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293229082">(Aug 13 2022 at 05:46)</a>:</h4>
<p><span class="user-mention" data-user-id="459227">@Violeta Hern√°ndez</span> I've pushed <a href="https://github.com/leanprover-community/mathlib/tree/remove_subsingleton_hack">branch#remove_subsingleton_hack</a> to see if it builds. It replaced all defs mentioning gh-6025 by global instances. The next step would be removing explicit invocations (haveI, letI) of these added instances.</p>



<a name="293232302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293232302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hern√°ndez <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293232302">(Aug 13 2022 at 06:35)</a>:</h4>
<p>Nice!</p>



<a name="293332575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%235672%20breaks%20timeout/near/293332575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.235672.20breaks.20timeout.html#293332575">(Aug 14 2022 at 00:35)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/16046">#16046</a> chore(*): restore subsingleton instances and remove hacks<br>
is now open.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>