---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html">#13483 `sort_summands`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="279591760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279591760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279591760">(Apr 20 2022 at 19:26)</a>:</h4>
<p>The PR is ready for review.  It introduces a tactic to simplify dealing with additive expressions.  It makes "isolating" subexpressions easy and allows to "zoom in" on partial sums convenient.</p>
<p>I would still like to get pattern matching to work on the symbols passed by the user, but this can wait for a later PR.</p>
<p>Any comments welcome!</p>



<a name="279592196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279592196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279592196">(Apr 20 2022 at 19:30)</a>:</h4>
<p>It allows to move terms to the left, say for collecting them together with a <code>←add_mul</code>, or to the right, if say, one of them is "bigger" than the remaining ones, so that it is isolated from the rest.</p>



<a name="279592486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279592486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279592486">(Apr 20 2022 at 19:33)</a>:</h4>
<p>Can it be extended to multiplicative expressions?</p>



<a name="279592929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279592929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279592929">(Apr 20 2022 at 19:37)</a>:</h4>
<p>Yes, I have a draft for that</p>



<a name="279593000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279593000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279593000">(Apr 20 2022 at 19:37)</a>:</h4>
<p>In fact, it can likely be extended to any binary commutative and associative operation.</p>



<a name="279593077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279593077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279593077">(Apr 20 2022 at 19:38)</a>:</h4>
<p>Though, my meta programming skills may not be able to do it</p>



<a name="279593237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279593237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279593237">(Apr 20 2022 at 19:39)</a>:</h4>
<p>My initial input was to automate computations of degrees of polynomials and being able to isolate the highest degree term is key for that.</p>



<a name="279593374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279593374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279593374">(Apr 20 2022 at 19:40)</a>:</h4>
<p>Once the highest degree is to the right, <code>nat_degree_add_eq_right_of_nat_degree_lt</code> essentially takes you home.</p>



<a name="279593617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279593617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279593617">(Apr 20 2022 at 19:42)</a>:</h4>
<p>If you have an expression involving sums and you want to cancel terms or collect terms together, it should be painless to isolate the terms you want and work in them.</p>



<a name="279639771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279639771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279639771">(Apr 21 2022 at 06:00)</a>:</h4>
<p>Yaël, to be more specific about products, if you look at line 125 of <code>tactic.sort</code>, you find <code>get_summands</code>.  This looks for sums in an expression and returns them.</p>
<p>Changing the match to a different binary operation would give you the same sorting structure, but with respect to your custom operation.</p>
<p>I think that the remaining change would have to be on line 150, where <code>simp</code> expects additions.  This would have to change either <code>s/add/mul</code>, or whatever commutation lemmas you have for your operation.</p>
<p>Likely, something else will break, but maybe not much.</p>



<a name="279641728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279641728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279641728">(Apr 21 2022 at 06:36)</a>:</h4>
<p>I guess you can have two user-facing tactics depending on which operation you wish to simplify.</p>



<a name="279642128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279642128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279642128">(Apr 21 2022 at 06:43)</a>:</h4>
<p>At the moment, this is in the list of <code>todo</code> at the end of the module doc-string.  I like the idea of adding support for multiplication, but I think that it belongs to a separate PR.</p>



<a name="279642494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2313483%20%60sort_summands%60/near/279642494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2313483.20.60sort_summands.60.html#279642494">(Apr 21 2022 at 06:50)</a>:</h4>
<p>Especially since "simply change this, everything else will work automatically" is usually false.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>