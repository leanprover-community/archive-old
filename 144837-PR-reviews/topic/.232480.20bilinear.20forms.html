---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html">#2480 bilinear forms</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="194963719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194963719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194963719">(Apr 22 2020 at 17:20)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> has made a really nice PR with the definition of bilinear forms. At some point in the theory, you need to konw that <code>2</code> is invertible in the base ring. We need to make a design choice here. I would like to have some more eyes and brains on this code. Will the current approach play well, or should we try something else?</p>



<a name="194972204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194972204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194972204">(Apr 22 2020 at 18:26)</a>:</h4>
<p>½ is such a fundamental thing. Maybe it even makes sense to add a type class specifically for this.</p>



<a name="194972814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194972814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194972814">(Apr 22 2020 at 18:31)</a>:</h4>
<p>I agree. Characteristic different from <code>2</code> is an assumption that shows up really often (notably when dealing with quadratic forms :)</p>



<a name="194973202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194973202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194973202">(Apr 22 2020 at 18:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/194972204" title="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/194972204">said</a>:</p>
<blockquote>
<p>½ is such a fundamental thing. Maybe it even makes sense to add a type class specifically for this.</p>
</blockquote>
<p>I like the notation!</p>



<a name="194982845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194982845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194982845">(Apr 22 2020 at 19:52)</a>:</h4>
<p>½ or <code>2 ≠ 0</code>?</p>



<a name="194982889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194982889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194982889">(Apr 22 2020 at 19:52)</a>:</h4>
<p>Probably ½</p>



<a name="194983593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194983593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194983593">(Apr 22 2020 at 19:58)</a>:</h4>
<p>You need ½ for this quadratic forms business (e.g., Z[½] is fine even though it's not a field, but Z is not even though 2 ≠ 0). But it's not clear to me how to organize it with respect to the algebraic hierarchy.</p>



<a name="194983638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194983638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194983638">(Apr 22 2020 at 19:58)</a>:</h4>
<p>I mean, obviously you need some axioms about ½</p>



<a name="194984876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194984876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194984876">(Apr 22 2020 at 20:08)</a>:</h4>
<p><code>is_unit 2</code>?</p>



<a name="194984942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/194984942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#194984942">(Apr 22 2020 at 20:08)</a>:</h4>
<p>Or <code>½ * 2 = 2 * ½ = 1</code> if we want to allow computable instances (probably yes).</p>



<a name="195017190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017190">(Apr 23 2020 at 04:13)</a>:</h4>
<p>So, maybe we add <code>has_half</code> as a class that only captures the data of the term and enables the notation (like <code>has_zero</code> and <code>has_one</code>) and another class</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">two_invertible</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="kn">extends</span> <span class="n">has_half</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">half_mul_two</span> <span class="o">:</span> <span class="err">½</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">(</span><span class="n">two_mul_half</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="err">½</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>


<p>What do people think of this idea? (In particular, I'd like to know what <span class="user-mention" data-user-id="238446">@Anne Baanen</span> thinks.)</p>



<a name="195017253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017253">(Apr 23 2020 at 04:14)</a>:</h4>
<p>(I don't know if <code>semiring R</code> can be weakened... you need <code>1</code>, <code>2</code> and <code>*</code>. So you probably need <code>has_one</code>, <code>has_mul</code> and <code>has_add</code>? Maybe also <code>has_zero</code>?</p>



<a name="195017915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017915">(Apr 23 2020 at 04:30)</a>:</h4>
<p>Why not parameterize this over <code>2</code>?</p>



<a name="195017922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017922">(Apr 23 2020 at 04:31)</a>:</h4>
<p>like <code>invertible a</code> for numeral <code>a</code></p>



<a name="195017932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017932">(Apr 23 2020 at 04:31)</a>:</h4>
<p>I'm not a fan of the notation though. It's a bit hard to see in a monospace font</p>



<a name="195017987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195017987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195017987">(Apr 23 2020 at 04:32)</a>:</h4>
<p>plus it's yet another way to express this constant, making simp normal form more complicated</p>



<a name="195018195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195018195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195018195">(Apr 23 2020 at 04:38)</a>:</h4>
<p>I like the idea of parametrising. We need a "characteristic does not divide the order of G" class, and <code>invertible (fintype.card G)</code> seems pretty good.</p>



<a name="195018199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195018199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195018199">(Apr 23 2020 at 04:38)</a>:</h4>
<p>Is there any reasonable definition of <code>has_div</code> for Z[1/2] that does some suitable truncation?</p>



<a name="195018292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195018292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195018292">(Apr 23 2020 at 04:40)</a>:</h4>
<p>I would really like to be able to use <code>1 / 2</code> if possible. <code>rat.cast</code> already does division by zero sometimes if you are in a ring with the wrong characteristic</p>



<a name="195018574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195018574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195018574">(Apr 23 2020 at 04:48)</a>:</h4>
<p>I would propose <code>(a * 2^b) / (c * 2^d)</code> (where a and c are odd) evaluates to <code>2^(b-d) * (a / c)</code> with the division evaluated in Z</p>



<a name="195018593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195018593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195018593">(Apr 23 2020 at 04:49)</a>:</h4>
<p>that should give the correct result in all reasonable cases, returns 0 on division by 0, and is a kind of p-adic approximation otherwise</p>



<a name="195022397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022397">(Apr 23 2020 at 06:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> So what would your definition of <code>invertible a</code> be? If you want to be able to compute with it (which seems useful, say over finite fields, or the rationals), then we need to record data. But that means that over a generic field of characteristic zero, there will be "another way" to express the constant <code>ainv</code>.</p>



<a name="195022402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022402">(Apr 23 2020 at 06:27)</a>:</h4>
<p>Or can that be avoided?</p>



<a name="195022407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022407">(Apr 23 2020 at 06:27)</a>:</h4>
<p>it's just proof relevant <code>is_unit</code></p>



<a name="195022416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022416">(Apr 23 2020 at 06:27)</a>:</h4>
<p>I actually thought this already existed</p>



<a name="195022470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022470">(Apr 23 2020 at 06:28)</a>:</h4>
<p>We have <code>units R</code></p>



<a name="195022481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022481">(Apr 23 2020 at 06:28)</a>:</h4>
<p>But I still don't follow how you want to avoid the extra way of expressing <code>1/a</code>.</p>



<a name="195022492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022492">(Apr 23 2020 at 06:29)</a>:</h4>
<p>well I want to use <code>has_div</code> to write it, although that is probably an "extra way" no matter how you slice it</p>



<a name="195022504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022504">(Apr 23 2020 at 06:29)</a>:</h4>
<p>In general you will not have <code>has_div</code> or <code>has_inv</code> on the ring you are interested in. (Say <code>polynomial (zmod p)</code>)</p>



<a name="195022520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022520">(Apr 23 2020 at 06:29)</a>:</h4>
<p>There is always a way to define it, although it might be noncomputable</p>



<a name="195022570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022570">(Apr 23 2020 at 06:30)</a>:</h4>
<p>But I'm not sure if we want to go noncomputable here.</p>



<a name="195022574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022574">(Apr 23 2020 at 06:30)</a>:</h4>
<p>the main important thing is that the function actually has a unique answer, i.e. no rings where there are two candidates for 1/2</p>



<a name="195022590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022590">(Apr 23 2020 at 06:30)</a>:</h4>
<p>but I think this is impossible in some relatively high generality</p>



<a name="195022606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022606">(Apr 23 2020 at 06:31)</a>:</h4>
<p>that is, <code>a + a = b + b</code> implies <code>a = b</code></p>



<a name="195022672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022672">(Apr 23 2020 at 06:32)</a>:</h4>
<p>If <code>(1/2) * 2 = 1</code> and <code>2 * (1/2) = 1</code>, then <code>(1/2)</code> is unique</p>



<a name="195022680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022680">(Apr 23 2020 at 06:32)</a>:</h4>
<p>yeah, at least in semirings it works</p>



<a name="195022696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022696">(Apr 23 2020 at 06:32)</a>:</h4>
<p>Which is good enough, I guess?</p>



<a name="195022728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022728">(Apr 23 2020 at 06:33)</a>:</h4>
<p>But I think that either you are working in a concrete ring, in which case you can set up <code>1 / 2</code> to refer to this element if it exists, or you are in some general situation and you can posit the existence of such an element using <code>invertible 2</code></p>



<a name="195022781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022781">(Apr 23 2020 at 06:34)</a>:</h4>
<p>maybe even skipping the notation, just <code>u : units R</code> and <code>u = 2</code></p>



<a name="195022804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022804">(Apr 23 2020 at 06:35)</a>:</h4>
<p>Given an instance of <code>invertible 2</code>, how do you want to refer to the element that is the inverse of <code>2</code>?</p>



<a name="195022825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022825">(Apr 23 2020 at 06:35)</a>:</h4>
<p><code>invertible.inv 2</code> presumably</p>



<a name="195022831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022831">(Apr 23 2020 at 06:35)</a>:</h4>
<p>or <code>I.inv</code> where <code>I : invertible 2</code> if it's not a class</p>



<a name="195022864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022864">(Apr 23 2020 at 06:36)</a>:</h4>
<p>And what would the definition of <code>I.inv x</code> be?</p>



<a name="195022875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022875">(Apr 23 2020 at 06:36)</a>:</h4>
<p>pull it out of the struct</p>



<a name="195022893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022893">(Apr 23 2020 at 06:36)</a>:</h4>
<p>Ok, so <code>invertible 2</code> records data? It's not a <code>Prop</code>. Or am I misunderstanding you?</p>



<a name="195022895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022895">(Apr 23 2020 at 06:36)</a>:</h4>
<p>no props</p>



<a name="195022914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022914">(Apr 23 2020 at 06:37)</a>:</h4>
<p><code>is_unit</code> is already around if you want the prop</p>



<a name="195022919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022919">(Apr 23 2020 at 06:37)</a>:</h4>
<p>Yup, certainly</p>



<a name="195022995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195022995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195022995">(Apr 23 2020 at 06:38)</a>:</h4>
<p>I think I would like <code>invertible</code> to be a class, and I think I would like to have notation for <code>invertible.inv</code>.</p>



<a name="195023180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023180">(Apr 23 2020 at 06:42)</a>:</h4>
<p>I can't think of anything good, so perhaps a local notation using your funny 1/2 symbol will suffice</p>



<a name="195023570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023570">(Apr 23 2020 at 06:50)</a>:</h4>
<p>I like <code>⅟</code> <a href="https://en.wiktionary.org/wiki/%E2%85%9F" title="https://en.wiktionary.org/wiki/%E2%85%9F">https://en.wiktionary.org/wiki/%E2%85%9F</a></p>



<a name="195023593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023593">(Apr 23 2020 at 06:51)</a>:</h4>
<p>Admittedly, this seems to depend on your font a bit, but <code>⅟2</code> and <code>⅟n</code> seem to read okish.</p>



<a name="195023620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023620">(Apr 23 2020 at 06:51)</a>:</h4>
<p>It's better in the Zulip "write-your-post" window, then when it's rendered after posting.</p>



<a name="195023683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023683">(Apr 23 2020 at 06:52)</a>:</h4>
<p>Can we prove that <code>1/2</code> is unique?</p>



<a name="195023699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023699">(Apr 23 2020 at 06:53)</a>:</h4>
<p>Depends on your axioms</p>



<a name="195023711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023711">(Apr 23 2020 at 06:53)</a>:</h4>
<p>can we construct a semiring with two <code>1/2</code>s?</p>



<a name="195023774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023774">(Apr 23 2020 at 06:54)</a>:</h4>
<p>What are your axioms on <code>1/2</code>?</p>



<a name="195023778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023778">(Apr 23 2020 at 06:54)</a>:</h4>
<p>2(1/2) = 1</p>



<a name="195023781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023781">(Apr 23 2020 at 06:55)</a>:</h4>
<p>Is it a bi-inverse? Or only one-sided?</p>



<a name="195023788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023788">(Apr 23 2020 at 06:55)</a>:</h4>
<p>oh no</p>



<a name="195023792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023792">(Apr 23 2020 at 06:55)</a>:</h4>
<p>I didn't realized it wasn't commutative</p>



<a name="195023807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023807">(Apr 23 2020 at 06:55)</a>:</h4>
<p>Your semiring? It is always noncommutative. Only rings are commutative.</p>



<a name="195023832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023832">(Apr 23 2020 at 06:55)</a>:</h4>
<p>is there a semiring with left 1/2 but not right 1/2?</p>



<a name="195023876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023876">(Apr 23 2020 at 06:56)</a>:</h4>
<p>I guess Z&lt;X&gt;/(2X-1) or something like that</p>



<a name="195023878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023878">(Apr 23 2020 at 06:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> In a commutative setup <code>coe : units R → R</code> is injective. Lean knows this.</p>



<a name="195023891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023891">(Apr 23 2020 at 06:56)</a>:</h4>
<p>(removed)</p>



<a name="195023905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023905">(Apr 23 2020 at 06:56)</a>:</h4>
<p>Exactly, so I suppose we require that it is a bi-inverse.</p>



<a name="195023917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023917">(Apr 23 2020 at 06:56)</a>:</h4>
<p>do we have R&lt;X&gt;?</p>



<a name="195023932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023932">(Apr 23 2020 at 06:57)</a>:</h4>
<p>Do we want it?</p>



<a name="195023941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195023941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195023941">(Apr 23 2020 at 06:57)</a>:</h4>
<p>I don't even know where to start if not do it completely stupidly (quotient of inductive)</p>



<a name="195024122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024122">(Apr 23 2020 at 06:59)</a>:</h4>
<p>what's the other stupid construction that makes it live one universe higher?</p>



<a name="195024181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024181">(Apr 23 2020 at 07:00)</a>:</h4>
<p>using the universal property Hom(R&lt;X&gt;,S) = S</p>



<a name="195024349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024349">(Apr 23 2020 at 07:02)</a>:</h4>
<p>I think <code>2*x = x+x = x*2</code> holds in any semiring?</p>



<a name="195024370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024370">(Apr 23 2020 at 07:03)</a>:</h4>
<p>oh right</p>



<a name="195024394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024394">(Apr 23 2020 at 07:03)</a>:</h4>
<p>ok that also implies unicity</p>



<a name="195024446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024446">(Apr 23 2020 at 07:04)</a>:</h4>
<p>Hooray! Thanks for that observation <span class="user-mention" data-user-id="130377">@David Wärn</span></p>



<a name="195024779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024779">(Apr 23 2020 at 07:09)</a>:</h4>
<p>yeah, every <code>\u (n : nat)</code> is in the center of the ring</p>



<a name="195024860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024860">(Apr 23 2020 at 07:10)</a>:</h4>
<p>I don't think the mathematicians here care about non-commutative rings</p>



<a name="195024878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024878">(Apr 23 2020 at 07:10)</a>:</h4>
<p>well they need to get over it because they will in 6 months</p>



<a name="195024891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024891">(Apr 23 2020 at 07:10)</a>:</h4>
<p>what's happening in 6 months?</p>



<a name="195024920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024920">(Apr 23 2020 at 07:11)</a>:</h4>
<p>they decide to work on something that needs noncommutative rings</p>



<a name="195024943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195024943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195024943">(Apr 23 2020 at 07:11)</a>:</h4>
<p>and then we have to do a big refactoring project</p>



<a name="195025847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195025847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195025847">(Apr 23 2020 at 07:22)</a>:</h4>
<p>Group rings are coming</p>



<a name="195025979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195025979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195025979">(Apr 23 2020 at 07:24)</a>:</h4>
<p>And if the group is finite (an important special case, even if you're interested in the Langlands philosophy, because Galois groups are a limit of finite groups) then you'll want to be able to say "and assume the order of the group is invertible in the base field"</p>



<a name="195027977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195027977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195027977">(Apr 23 2020 at 07:52)</a>:</h4>
<p>So the consensus until now seems to favour an <code>invertible a</code> typeclass, which is also my preferred option.</p>



<a name="195027986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195027986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195027986">(Apr 23 2020 at 07:52)</a>:</h4>
<p>My suggestion is to decouple the proposition from the notation, i.e. have a <code>has_inv_of a</code> class which provides <code>inv_of a</code> (notation: <code>⅟ a</code>?) and <code>invertible a</code> which asserts the relevant equation(s). Perhaps split it into <code>left_invertible</code> and <code>right_invertible</code>?</p>



<a name="195028007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028007">(Apr 23 2020 at 07:52)</a>:</h4>
<p>I'm not sure we need a notation typeclass for this</p>



<a name="195028029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028029">(Apr 23 2020 at 07:53)</a>:</h4>
<p>I would be happy to attach the notation simply to the lawful <code>invertible a</code> typeclass</p>



<a name="195028065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028065">(Apr 23 2020 at 07:53)</a>:</h4>
<p>I'm thinking that inverses come up in cases where the operation is not <code>*</code>, e.g. for a matrix or for an arrow in a category</p>



<a name="195028117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028117">(Apr 23 2020 at 07:54)</a>:</h4>
<p>I think once you get to <code>left_invertible</code> or things other than <code>*</code>, you should just have a hypothesis</p>



<a name="195028134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028134">(Apr 23 2020 at 07:54)</a>:</h4>
<p>we aren't even abbreviating much at this point</p>



<a name="195028171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195028171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195028171">(Apr 23 2020 at 07:55)</a>:</h4>
<p>For me the main point of a typeclass in this area is to be able to talk about "a field of characteristic not equal to 2 or 3" when the inverses to 2 and 3 are not the focus of the theorem</p>



<a name="195029477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195029477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195029477">(Apr 23 2020 at 08:10)</a>:</h4>
<p>Note that in the basic theory of elliptic curves, "a field of characteristic not equal to 2 or 3" is a very common assumption.</p>



<a name="195029622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195029622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195029622">(Apr 23 2020 at 08:12)</a>:</h4>
<p>Ring of matrices is a non-commutative ring that I care about.</p>



<a name="195029749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195029749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195029749">(Apr 23 2020 at 08:13)</a>:</h4>
<p>I mean, <code>linear_map.End</code>.</p>



<a name="195034212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195034212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195034212">(Apr 23 2020 at 09:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195024860" title="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195024860">said</a>:</p>
<blockquote>
<p>I don't think the mathematicians here care about non-commutative rings</p>
</blockquote>
<p>Kenny... after all this time, you still can't recognize when Kevin keeps repeating some absurd stuff he doesn't really believe in?</p>



<a name="195041833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195041833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195041833">(Apr 23 2020 at 10:24)</a>:</h4>
<p>Any number theorist knows that all rings are commutative...unless expressly stated otherwise.</p>



<a name="195042033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195042033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195042033">(Apr 23 2020 at 10:26)</a>:</h4>
<p>When I lectured basic homological algebra in Algebra IV a few years ago, I didn't want to talk about abelian categories, so I decided to just talk about the category of R-modules for some fixed commutative ring R. It took a while for me to realise that I never used commutativity of R at all! I was actually quite surprised to find out that R-modules were an abelian category even if R was not an abelian monoid :-)</p>



<a name="195046433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195046433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195046433">(Apr 23 2020 at 11:21)</a>:</h4>
<p><a href="https://gist.github.com/Vierkantor/e73209684c16b725e29880de7443c9f2" title="https://gist.github.com/Vierkantor/e73209684c16b725e29880de7443c9f2">I have made a start on an <code>invertible</code> typeclass</a>. One good feature would be to automatically infer <code>invertible (3 : ℚ)</code>. I've tried using <code>invertible (bit0 _)</code> and <code>invertible (bit1 _)</code>, but I can't figure out how to formulate the correct instance for <code>invertible (bit1 a)</code>: we need at least that <code>a ≠ -1/2</code>.</p>



<a name="195047148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195047148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195047148">(Apr 23 2020 at 11:30)</a>:</h4>
<p>Maybe if we had a class that provided the value 1/2...</p>



<a name="195048874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195048874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195048874">(Apr 23 2020 at 11:49)</a>:</h4>
<p>When all you have is a <del>hammer</del> typeclass inference, everything looks like a<del> nail</del>n instance:</p>
<div class="codehilite"><pre><span></span><span class="kn">section</span> <span class="n">numeral</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>

<span class="n">class</span> <span class="n">numeral</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="o">(</span><span class="n">as_nat</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">coe_eq</span> <span class="o">:</span> <span class="err">↑</span><span class="n">as_nat</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">coe_as_nat_eq</span> <span class="o">[</span><span class="n">numeral</span> <span class="n">a</span><span class="o">]</span> <span class="o">:</span> <span class="err">↑</span><span class="o">(</span><span class="n">numeral</span><span class="bp">.</span><span class="n">as_nat</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">numeral</span><span class="bp">.</span><span class="n">coe_eq</span>

<span class="kn">instance</span> <span class="n">numeral_zero</span> <span class="o">:</span> <span class="n">numeral</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span>

<span class="kn">instance</span> <span class="n">numeral_one</span> <span class="o">:</span> <span class="n">numeral</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="mi">1</span><span class="o">,</span> <span class="n">zero_add</span> <span class="mi">1</span><span class="bp">⟩</span>

<span class="kn">instance</span> <span class="n">numeral_bit0</span> <span class="o">[</span><span class="n">numeral</span> <span class="n">a</span><span class="o">]</span> <span class="o">:</span> <span class="n">numeral</span> <span class="o">(</span><span class="n">bit0</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">bit0</span> <span class="o">(</span><span class="n">numeral</span><span class="bp">.</span><span class="n">as_nat</span> <span class="n">a</span><span class="o">),</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">coe_as_nat_eq</span> <span class="n">a</span><span class="o">]</span><span class="bp">⟩</span>

<span class="kn">instance</span> <span class="n">numeral_bit1</span> <span class="o">[</span><span class="n">numeral</span> <span class="n">a</span><span class="o">]</span> <span class="o">:</span> <span class="n">numeral</span> <span class="o">(</span><span class="n">bit1</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">bit1</span> <span class="o">(</span><span class="n">numeral</span><span class="bp">.</span><span class="n">as_nat</span> <span class="n">a</span><span class="o">),</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">coe_as_nat_eq</span> <span class="n">a</span><span class="o">]</span><span class="bp">⟩</span>

<span class="kn">lemma</span> <span class="n">bit1_nonzero</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">char_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">numeral</span> <span class="n">a</span><span class="o">]</span> <span class="o">:</span> <span class="n">bit1</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast_ne_zero</span><span class="bp">.</span><span class="n">mpr</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">bit1_ne_zero</span> <span class="o">(</span><span class="n">numeral</span><span class="bp">.</span><span class="n">as_nat</span> <span class="n">a</span><span class="o">))</span> <span class="o">(</span><span class="n">trans</span> <span class="o">(</span><span class="n">coe_as_nat_eq</span> <span class="o">(</span><span class="n">bit1</span> <span class="n">a</span><span class="o">))</span> <span class="n">h</span><span class="o">)</span>

<span class="kn">end</span> <span class="n">numeral</span>

<span class="kn">instance</span> <span class="n">invertible_bit1_of_char_zero</span> <span class="o">[</span><span class="n">division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">char_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">numeral</span> <span class="n">a</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">invertible</span> <span class="o">(</span><span class="n">bit1</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">invertible_of_nonzero</span> <span class="o">(</span><span class="n">bit1_nonzero</span> <span class="n">a</span><span class="o">)</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="err">⅟</span> <span class="mi">3</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="err">⅟</span> <span class="mi">37</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="err">⅟</span> <span class="mi">256</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span>
</pre></div>



<a name="195049157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049157">(Apr 23 2020 at 11:52)</a>:</h4>
<p>It suffices to have a typeclass for <code>ge_zero</code></p>



<a name="195049206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049206">(Apr 23 2020 at 11:52)</a>:</h4>
<p><code>nonneg</code> is shorter</p>



<a name="195049230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049230">(Apr 23 2020 at 11:53)</a>:</h4>
<p>but actually I think I would rather just have instances for 2 and 3</p>



<a name="195049238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049238">(Apr 23 2020 at 11:53)</a>:</h4>
<p>That type class is <code>[fact (0 ≤ n)]</code>, right?</p>



<a name="195049246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049246">(Apr 23 2020 at 11:53)</a>:</h4>
<p><code>nonneg</code> assumes an order on the ring though</p>



<a name="195049253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049253">(Apr 23 2020 at 11:53)</a>:</h4>
<p>Q has an order fyi</p>



<a name="195049267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049267">(Apr 23 2020 at 11:53)</a>:</h4>
<p>Duh</p>



<a name="195049286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049286">(Apr 23 2020 at 11:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> How about <code>zmod 5</code>?</p>



<a name="195049307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049307">(Apr 23 2020 at 11:54)</a>:</h4>
<p>this isn't true in general... it's true when <code>invertible n</code></p>



<a name="195049405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049405">(Apr 23 2020 at 11:54)</a>:</h4>
<p>what about zmod 5?</p>



<a name="195049465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049465">(Apr 23 2020 at 11:55)</a>:</h4>
<p>What about <code>ℂ</code>?</p>



<a name="195049492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049492">(Apr 23 2020 at 11:55)</a>:</h4>
<p>If you have <code>char_zero</code> then there is no need to play around with invertible assumptions</p>



<a name="195049569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049569">(Apr 23 2020 at 11:56)</a>:</h4>
<p>But for representation theory you probably just want to assume you have an alg closed field where |G| is invertible</p>



<a name="195049608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049608">(Apr 23 2020 at 11:56)</a>:</h4>
<p>and you can do that, with a hypothesis</p>



<a name="195049621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049621">(Apr 23 2020 at 11:56)</a>:</h4>
<p>who cares how it gets inferred</p>



<a name="195049687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049687">(Apr 23 2020 at 11:57)</a>:</h4>
<p>I don't think we should be trying to come up with some fancy typeclass mechanism to prove that 7 is invertible in zmod 41</p>



<a name="195049717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049717">(Apr 23 2020 at 11:57)</a>:</h4>
<p>that's what <code>norm_num</code> is for</p>



<a name="195049904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049904">(Apr 23 2020 at 11:59)</a>:</h4>
<p>Dang, I was just going to propose writing a fancy metaprogram to take the definition of <code>prime</code> and turn it into a pile of type class instances that test primality Prolog-style.</p>



<a name="195049992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195049992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195049992">(Apr 23 2020 at 12:00)</a>:</h4>
<p>this is absolutely possible, and definitely a bad idea</p>



<a name="195050069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195050069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195050069">(Apr 23 2020 at 12:00)</a>:</h4>
<p>I have seen a few examples of these kinds of programs, and they fail surprisingly early because the typeclass depth limit is not calibrated well for them</p>



<a name="195050154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195050154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195050154">(Apr 23 2020 at 12:01)</a>:</h4>
<p>I love the way that this started off as a question about 1/2 and has become a conversation about typeclass depth limit.</p>



<a name="195051634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051634">(Apr 23 2020 at 12:14)</a>:</h4>
<p>Can we make this work?</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_num_basic</span> <span class="o">:=</span>
<span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">norm_num</span> <span class="o">[]</span> <span class="o">(</span><span class="n">interactive</span><span class="bp">.</span><span class="n">loc</span><span class="bp">.</span><span class="n">ns</span> <span class="o">[</span><span class="n">none</span><span class="o">])</span>

<span class="kn">instance</span> <span class="n">invertible_of_nonzero</span> <span class="o">[</span><span class="n">division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">.</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_num_basic</span><span class="o">)</span> <span class="o">:</span> <span class="n">invertible</span> <span class="n">a</span> <span class="o">:=</span>
<span class="bp">⟨</span> <span class="n">a</span><span class="bp">⁻¹</span><span class="o">,</span> <span class="n">inv_mul_cancel</span> <span class="n">h</span><span class="o">,</span> <span class="n">mul_inv_cancel</span> <span class="n">h</span> <span class="bp">⟩</span>

<span class="n">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">invertible</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span>
</pre></div>



<a name="195051677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051677">(Apr 23 2020 at 12:15)</a>:</h4>
<p>auto params in typeclass instances currently don't work, but I think this should be fixed in the C++</p>



<a name="195051705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051705">(Apr 23 2020 at 12:15)</a>:</h4>
<p>there are reasons for this decision but I don't think they are very good</p>



<a name="195051719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051719">(Apr 23 2020 at 12:15)</a>:</h4>
<p>There was a big discussion about invoking tactics from type class search, let me see if I can find it.</p>



<a name="195051834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051834">(Apr 23 2020 at 12:17)</a>:</h4>
<p><a href="#narrow/stream/113488-general/topic/instances.20and.20parameters" title="#narrow/stream/113488-general/topic/instances.20and.20parameters">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instances.20and.20parameters</a> ?</p>



<a name="195051869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051869">(Apr 23 2020 at 12:17)</a>:</h4>
<p>Right, specifically starting at <a href="#narrow/stream/113488-general/topic/instances.20and.20parameters/near/178609338" title="#narrow/stream/113488-general/topic/instances.20and.20parameters/near/178609338">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instances.20and.20parameters/near/178609338</a> (but it's just a few messages down)</p>



<a name="195051883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195051883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195051883">(Apr 23 2020 at 12:17)</a>:</h4>
<p>I no longer recall what the outcome of that discussion was, though</p>



<a name="195052122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052122">(Apr 23 2020 at 12:20)</a>:</h4>
<p>Haven't we been told that in Lean 4 it will definitely not be possible to run tactics from inside typeclass search?</p>



<a name="195052160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052160">(Apr 23 2020 at 12:20)</a>:</h4>
<p>the linked discussion seems to say the opposite</p>



<a name="195052184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052184">(Apr 23 2020 at 12:21)</a>:</h4>
<p>but I think if you follow it (much) farther, thing became murkier?</p>



<a name="195052191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052191">(Apr 23 2020 at 12:21)</a>:</h4>
<p>I don't really remember now though</p>



<a name="195052214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052214">(Apr 23 2020 at 12:21)</a>:</h4>
<p>I'm mostly curious how costly it would be to implement this in lean 3</p>



<a name="195052229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052229">(Apr 23 2020 at 12:21)</a>:</h4>
<p>(costly in terms of development work, not runtime)</p>



<a name="195052291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052291">(Apr 23 2020 at 12:22)</a>:</h4>
<p>I guess the issue was whether you want to be able to backtrack out of tactics that fail</p>



<a name="195052319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052319">(Apr 23 2020 at 12:22)</a>:</h4>
<p>e.g. zmod n being a field only when n is prime</p>



<a name="195052328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052328">(Apr 23 2020 at 12:23)</a>:</h4>
<p>I think that it should be implemented in the most straightforward way: tactics get called synchronously in the middle of the search</p>



<a name="195052402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052402">(Apr 23 2020 at 12:23)</a>:</h4>
<p>this puts some constraints on the tactics to not misbehave too badly but I think this is reasonable for a rarely used feature</p>



<a name="195052559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052559">(Apr 23 2020 at 12:25)</a>:</h4>
<p>Anyways, I don't think this approach helps for this PR</p>



<a name="195052576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052576">(Apr 23 2020 at 12:25)</a>:</h4>
<p>we might also consider an opt in marker on classes to allow auto params, so that most regular instance searches guarantee no tactic calls</p>



<a name="195052757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052757">(Apr 23 2020 at 12:27)</a>:</h4>
<p>For this PR, we just need an instance <code>invertible (2 : Q)</code>, or perhaps <code>[char_zero A] : invertible (2 : A)</code></p>



<a name="195052829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195052829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195052829">(Apr 23 2020 at 12:28)</a>:</h4>
<p>maybe we will get another instance for 3 when people start working with elliptic curves</p>



<a name="195053883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195053883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195053883">(Apr 23 2020 at 12:37)</a>:</h4>
<p>Only if they choose to focus on Weierstrass form...</p>



<a name="195054197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195054197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195054197">(Apr 23 2020 at 12:40)</a>:</h4>
<p>I've updated <a href="https://gist.github.com/Vierkantor/e73209684c16b725e29880de7443c9f2" title="https://gist.github.com/Vierkantor/e73209684c16b725e29880de7443c9f2">the gist</a> to only include the non-controversial parts. Any suggestions before I turn it into a PR?</p>



<a name="195054497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195054497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195054497">(Apr 23 2020 at 12:43)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> The stuff on division rings should maybe be generalised to <code>group_with_zero</code>?</p>



<a name="195062342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195062342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195062342">(Apr 23 2020 at 13:43)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/2504" title="https://github.com/leanprover-community/mathlib/pull/2504">Created PR #2504</a></p>



<a name="195066068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195066068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195066068">(Apr 23 2020 at 14:10)</a>:</h4>
<p>I see in the PR that you explain how to deduce invertibility of some elements (for instance <code>-a</code>) from the invertibility of <code>a</code>, but I think this mightcreate problems down the road. For instance, in a field, <code>-1</code> could be invertible because it is the neg of <code>1</code> which is invertible, but also because it is nonzero and therefore invertible. With a prop, this is never an issue, but with data this will be a problem if the inverses you get following different paths are not defeq. </p>
<p>This is already the case in groups, where you have the two instances</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">invertible_of_group</span> <span class="o">[</span><span class="n">group</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">invertible</span> <span class="n">a</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">a</span><span class="bp">⁻¹</span><span class="o">,</span> <span class="n">inv_mul_self</span> <span class="n">a</span><span class="o">,</span> <span class="n">mul_inv_self</span> <span class="n">a</span><span class="bp">⟩</span>
</pre></div>


<p>and </p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">invertible_one</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">invertible</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span> <span class="mi">1</span><span class="o">,</span> <span class="n">mul_one</span> <span class="bp">_</span><span class="o">,</span> <span class="n">one_mul</span> <span class="bp">_</span> <span class="bp">⟩</span>
</pre></div>


<p>Since <code>1</code> and <code>1⁻¹</code> are not defeq, this gives you two conflicting values for the inverse of <code>1</code>.</p>
<p>I guess the solution here is to <em>not</em> declare all these as instances, only as defs, and let the user activate the ones he needs when necessary. Opinions of type classes experts welcome!</p>



<a name="195066523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195066523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195066523">(Apr 23 2020 at 14:13)</a>:</h4>
<p>I think it will not be a problem, because I think these should <em>not</em> be considered simp normal form expressions, and there should be lemmas rewriting <code>inv 2 = 1 / 2</code> in division rings and so on.</p>



<a name="195067040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067040">(Apr 23 2020 at 14:17)</a>:</h4>
<p>So the only time an <code>inv</code> will appear in a statement is if it is in a general context and that's the only way to obtain the element in question. Of course no one is going to use <code>inv 1</code> directly, it will only appear as <code>inv a</code>, applied in a context with <code>a := 1</code>, and then the simp lemma will trigger and it becomes <code>1</code></p>



<a name="195067385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067385">(Apr 23 2020 at 14:19)</a>:</h4>
<p>What about <code>inv (-4)</code> in <code>ℤ[1/2]</code>? It could appear as <code>- (inv 2) * (inv 2)</code> or <code>(inv 2) * (-inv 2)</code> depending on the chosen path, and I don't expect any reasonable simp normal form here.</p>



<a name="195067473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067473">(Apr 23 2020 at 14:20)</a>:</h4>
<p>It will be <code>- 1/4</code></p>



<a name="195067501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067501">(Apr 23 2020 at 14:20)</a>:</h4>
<p>with division in Z[1/2]</p>



<a name="195067640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067640">(Apr 23 2020 at 14:21)</a>:</h4>
<p><code>inv 2</code> is not the canonical way of referring to 1/2 in Z[1/2]</p>



<a name="195067715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067715">(Apr 23 2020 at 14:21)</a>:</h4>
<p>it would be some constructor, <code>Z_one_half.one_half</code></p>



<a name="195067731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067731">(Apr 23 2020 at 14:21)</a>:</h4>
<p>This only make sense if you can craft a division with nice enough properties, otherwise we should not declare a <code>has_div</code> instance here.</p>



<a name="195067767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067767">(Apr 23 2020 at 14:22)</a>:</h4>
<p>I mentioned the divison on Z[1/2] above</p>



<a name="195067840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067840">(Apr 23 2020 at 14:22)</a>:</h4>
<p>Yes, but I am not sure I was convinced it behaves nicely enough...</p>



<a name="195067844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067844">(Apr 23 2020 at 14:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195018574" title="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195018574">said</a>:</p>
<blockquote>
<p>I would propose <code>(a * 2^b) / (c * 2^d)</code> (where a and c are odd) evaluates to <code>2^(b-d) * (a / c)</code> with the division evaluated in Z</p>
</blockquote>



<a name="195067862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067862">(Apr 23 2020 at 14:22)</a>:</h4>
<p>You could make any ring in which 2 was invertible into a Z[1/2]-algebra and then make all your decisions in Z[1/2]</p>



<a name="195067901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067901">(Apr 23 2020 at 14:22)</a>:</h4>
<p>I don't really care if it returns 37 on bad inputs in this case</p>



<a name="195067930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195067930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195067930">(Apr 23 2020 at 14:23)</a>:</h4>
<p>I would be actively for this decision</p>



<a name="195068062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068062">(Apr 23 2020 at 14:24)</a>:</h4>
<p>I think that the gain of being able to write <code>1/4</code> outweighs the mess of numbers like <code>1/5</code></p>



<a name="195068101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068101">(Apr 23 2020 at 14:24)</a>:</h4>
<p>Btw, the simp lemma in the PR is currently</p>
<div class="codehilite"><pre><span></span><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">inv_of_one</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="err">⅟</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>


<p>and I don't know which instance it uses. It should probably be</p>
<div class="codehilite"><pre><span></span><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">inv_of_one</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">invertible</span> <span class="mi">1</span><span class="o">]</span> <span class="o">:</span> <span class="err">⅟</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="k">begin</span> <span class="bp">...</span> <span class="kn">end</span>
</pre></div>



<a name="195068181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068181">(Apr 23 2020 at 14:25)</a>:</h4>
<p>I don't think it is a question about <code>simp</code>. I mean in the bilinear forms PR, the choice of 1/2 is embedded in further constructions like the discriminant of a quadratic form. If you end up with the discriminant of the same form but with two definitionally different 1/2s, aren't you going to be in a bit of trouble?</p>



<a name="195068198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068198">(Apr 23 2020 at 14:25)</a>:</h4>
<p>It should be <code>{_:invertible 1}</code> if you want to make it agnostic to the instance</p>



<a name="195068255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068255">(Apr 23 2020 at 14:25)</a>:</h4>
<p>Yes, even better</p>



<a name="195068477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068477">(Apr 23 2020 at 14:27)</a>:</h4>
<p>(actually, I know which instance it uses, because only one of them is <code>rfl</code> <span aria-label="mischievous" class="emoji emoji-1f61b" role="img" title="mischievous">:mischievous:</span> )</p>



<a name="195068499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068499">(Apr 23 2020 at 14:27)</a>:</h4>
<p>If I understand correctly the goal of this typeclass, it is not to deduce automatically invertibility, only to provide an inverse to some fixed number, say <code>2</code> or <code>3</code>. Why not remove all these instances and turn them into defs?</p>



<a name="195068550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195068550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195068550">(Apr 23 2020 at 14:27)</a>:</h4>
<p>I agree that this is not something we need a bunch of instances for</p>



<a name="195070058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195070058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195070058">(Apr 23 2020 at 14:37)</a>:</h4>
<p>OK <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> Which <code>instance</code>s should stay that way? Definitely <code>invertible 2</code>, <code>invertible 3</code>. Also <code>invertible 1</code>, <code>invertible -(a)</code>?</p>



<a name="195070265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195070265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195070265">(Apr 23 2020 at 14:38)</a>:</h4>
<p>I'm not sure we will ever need any instances besides <code>invertible 2</code>, <code>invertible 3</code>, and <code>invertible (\u n)</code> under some assumptions</p>



<a name="195070375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195070375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195070375">(Apr 23 2020 at 14:39)</a>:</h4>
<p>so the last one isn't even really an instance</p>



<a name="195070470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195070470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195070470">(Apr 23 2020 at 14:39)</a>:</h4>
<p>It's really a ring structure assumption, like <code>char_zero</code>, so it's fine if it is fairly rigid</p>



<a name="195071732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195071732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195071732">(Apr 23 2020 at 14:47)</a>:</h4>
<p>Too few instances is easier to deal with than too many instances, so I would keep it simple to start</p>



<a name="195072590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195072590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195072590">(Apr 23 2020 at 14:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195018574" title="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195018574">said</a>:</p>
<blockquote>
<p>I would propose <code>(a * 2^b) / (c * 2^d)</code> (where a and c are odd) evaluates to <code>2^(b-d) * (a / c)</code> with the division evaluated in Z</p>
</blockquote>
<p>To play this game in <code>R[1/2]</code>, you need to have some kind of division on <code>R</code>. If you start from a nice and natural example such as <code>R = ℤ[√-5]</code>, I don't think you will be able to cook up such a natural division.</p>



<a name="195073678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195073678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195073678">(Apr 23 2020 at 15:00)</a>:</h4>
<p>Because R isn't a UFD, you have real problems deciding what a quotient and a remainder are (the "remainder" cannot be made to be smaller than the thing you're dividing by, for any reasonable concept of size)</p>



<a name="195073779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195073779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195073779">(Apr 23 2020 at 15:00)</a>:</h4>
<p>Yes, I didn't choose my example completely at random :)</p>



<a name="195076680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076680">(Apr 23 2020 at 15:18)</a>:</h4>
<p>here's a perfectly natural definition, that works on any ring and gives the right division by 0: <code>if h : is_unit x then classical.some h else 0</code></p>



<a name="195076768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076768">(Apr 23 2020 at 15:19)</a>:</h4>
<p>this can be a <code>def</code> for <code> has_div</code> in case you feel like using division notation</p>



<a name="195076840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076840">(Apr 23 2020 at 15:19)</a>:</h4>
<p>Then you get two conflicting notations on the integers.</p>



<a name="195076850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076850">(Apr 23 2020 at 15:19)</a>:</h4>
<p>but in statements you stick to things like <code>inv 2</code> to keep the choices canonical</p>



<a name="195076921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076921">(Apr 23 2020 at 15:20)</a>:</h4>
<p>you wouldn't use that definition on the integers</p>



<a name="195076953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195076953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195076953">(Apr 23 2020 at 15:20)</a>:</h4>
<p>it's not a blanket instance, it's an opt in def</p>



<a name="195077233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195077233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195077233">(Apr 23 2020 at 15:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195076921" title="#narrow/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms/near/195076921">said</a>:</p>
<blockquote>
<p>you wouldn't use that definition on the integers</p>
</blockquote>
<p>Some of us wouldn't use the current <code>/</code> on the integers either ;-)</p>



<a name="195077246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195077246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195077246">(Apr 23 2020 at 15:22)</a>:</h4>
<p>So... shall we merge the PR? Currently there are only instances for <code>2</code> and <code>3</code>.</p>



<a name="195077277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195077277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195077277">(Apr 23 2020 at 15:23)</a>:</h4>
<p>I am fully aware that not all rings have the luxury of nice values when you start dividing by weird things. But that doesn't matter, we are not new to totalized functions</p>



<a name="195169722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%232480%20bilinear%20forms/near/195169722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.232480.20bilinear.20forms.html#195169722">(Apr 24 2020 at 10:25)</a>:</h4>
<p>I've kicked the bilinear forms PR onto the queue.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>