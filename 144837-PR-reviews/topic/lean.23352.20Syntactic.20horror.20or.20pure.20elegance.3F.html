---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html">lean#352 Syntactic horror or pure elegance?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="201728350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201728350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201728350">(Jun 23 2020 at 13:53)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">new_string_literal</span> <span class="o">:=</span> <span class="c">/-</span><span class="cm">&quot;</span>
<span class="cm">## Markdown heading</span>

<span class="cm">String blocks are like comments:</span>
<span class="cm">``lean</span>
<span class="cm">/-- My declaration -/</span>
<span class="cm">def my_declaration : string :=</span>
<span class="cm">/-&quot;</span>
<span class="cm">  They can be nicely nested</span>
<span class="cm">&quot;-/</span>
<span class="cm">``</span>
<span class="cm">&quot;-/</span>
</code></pre></div>



<a name="201728803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201728803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201728803">(Jun 23 2020 at 13:56)</a>:</h4>
<p>What's the first character of the literal? <code>#</code> or newline?</p>



<a name="201728826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201728826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201728826">(Jun 23 2020 at 13:56)</a>:</h4>
<p>and the last?</p>



<a name="201728913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201728913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201728913">(Jun 23 2020 at 13:57)</a>:</h4>
<p>The newline is the first character.  The last two characters are <code> ` </code> and a newline.</p>



<a name="201731202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201731202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201731202">(Jun 23 2020 at 14:14)</a>:</h4>
<p>I'm not convinced by this specific syntax, because my mental lexing algorithm uses <code>/-</code> to always indicate the start of a comment, and the next character in the case of <code>/--</code> or <code>/-!</code> just specify which kind of comment. Turning it into a string literal would cause a bunch more mental lookahead. But I can't find any alternative nestable string literal syntax in a popular language, except perhaps CDATA in XML...</p>



<a name="201731429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201731429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201731429">(Jun 23 2020 at 14:16)</a>:</h4>
<p>What is the expected result for <code>/-" am I a string or a comment? -/</code>?</p>



<a name="201736629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201736629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201736629">(Jun 23 2020 at 14:55)</a>:</h4>
<p>Obviously <code>unknown command `«/-"»` </code>.</p>



<a name="201736883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201736883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201736883">(Jun 23 2020 at 14:57)</a>:</h4>
<p>how about using <code>“</code> and <code>”</code> for nestable strings?</p>



<a name="201736903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201736903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201736903">(Jun 23 2020 at 14:57)</a>:</h4>
<p>Let me explain the motivation behind making the syntax similar to comments.  A big requirement is here that comments and strings can be nested in any alternation.  The comments already had code to support the <code>/- /- -/ -/</code> nesting.  If we introduced a brand-new syntax for string literals, then we would also have to adapt the nesting code and the syntax highlighting.</p>



<a name="201737852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201737852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201737852">(Jun 23 2020 at 15:03)</a>:</h4>
<p>It is also problematic to use the same token for both the begin and the end.  Let's say we choose <code>"""</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="o">{</span> <span class="n">description</span> <span class="o">:=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">How to write documentation:</span>
<span class="s2">`​``lean</span>
<span class="s2">add_tactic_doc {</span>
<span class="s2"> description := &quot;&quot;&quot;</span>
   <span class="n">Description</span> <span class="n">goes</span> <span class="n">here</span><span class="bp">.</span>
 <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">}</span>
<span class="s2">`​``</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">}</span>
</code></pre></div>



<a name="201737951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/201737951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#201737951">(Jun 23 2020 at 15:04)</a>:</h4>
<p>Oh, the Zulip highlighting correctly highlights the issue.</p>



<a name="202077903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202077903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Olson <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202077903">(Jun 26 2020 at 11:21)</a>:</h4>
<p>I haven't seen a programming language with nestable "normal" strings, but a few languages have nestable "raw" strings (which don't interpret escape sequences), by tagging the outermost delimiter with a string that never occurs inside the string. In Rust this looks like:</p>
<div class="codehilite"><pre><span></span><code>let example1 = r#&quot;
  These &quot;quotes&quot; do not cause the end of the string literal, only a quote with a # can.
&quot;#;

let example2 = r#####&quot;
  With more hashes like this, the string can mention &quot;, &quot;#, &quot;##, &quot;###, and &quot;#### without ending.
&quot;#####;
</code></pre></div>


<p>C++ implements the same idea with <code>R"foo( ... )foo"</code> instead of <code>r###" ... "###</code> (arbitrary identifier labels instead of <code>#</code>s).</p>
<p>Your alternative approach seems to be driven by a need these languages didn't have - specifically embedding Lean code in Lean strings, so you can depend on the fact the internal delimiters will be balanced. This is the same reason some languages adopted nestable comments, since you are often putting, say, Lean code in Lean comments.</p>



<a name="202079108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202079108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202079108">(Jun 26 2020 at 11:35)</a>:</h4>
<p>Yes, we already have nestable comments.  And we also use comments for extended documentation.  It seemed a reasonable choice to reuse the comment syntax since <code>/-" "-/</code> will be mostly used by strings containing documentation.</p>



<a name="202079343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202079343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202079343">(Jun 26 2020 at 11:38)</a>:</h4>
<p>There are actually a few other (not so hip) languages that have nestable string syntax:</p>
<ul>
<li>Perl: <code>print q{q{}q{q{}}}</code> prints <code>q{}q{q{}}</code>.  For bonus points you can use any kind of parenthesis after <code>q</code>.  Other kinds of strings have similar prefixes like <code>qq</code> (with escapes), or <code>m</code> (for regexps).</li>
<li>Tcl: <code>puts {{a}}</code>.  Interestingly, Tcl also uses the string syntax for function bodies (because they <em>are</em> strings)</li>
</ul>



<a name="202079514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202079514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Olson <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202079514">(Jun 26 2020 at 11:41)</a>:</h4>
<p>I completely forgot that Perl (and Ruby, which copied it from Perl) had this feature literally, nice.</p>



<a name="202079720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202079720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Olson <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202079720">(Jun 26 2020 at 11:44)</a>:</h4>
<p>Raku (previously Perl 6) which seems to aspire to be the cutest programming language, has <code>Q[...]</code> syntax akin to Perl but also allows the use of Japanese quoting like <code>｢this, which also ｢nests｣ properly｣</code>.</p>



<a name="202079742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/lean%23352%20Syntactic%20horror%20or%20pure%20elegance%3F/near/202079742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Olson <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/lean.23352.20Syntactic.20horror.20or.20pure.20elegance.3F.html#202079742">(Jun 26 2020 at 11:45)</a>:</h4>
<p>Come to think of it, Lean already uses French quotation marks, which could nest, but for identifiers instead of strings.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>