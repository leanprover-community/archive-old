---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html">#1521 rename type variables</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="177649293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649293">(Oct 08 2019 at 19:18)</a>:</h4>
<p>I'd like to work a bit on that PR. How to we coordinate?</p>



<a name="177649316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649316">(Oct 08 2019 at 19:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> are you currently working on it?</p>



<a name="177649324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649324">(Oct 08 2019 at 19:19)</a>:</h4>
<p>Claim a file. I'm done with it for the evening at least.</p>



<a name="177649357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649357">(Oct 08 2019 at 19:19)</a>:</h4>
<p>Is there an ordering?</p>



<a name="177649479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649479">(Oct 08 2019 at 19:20)</a>:</h4>
<p>Uh, I don't think so.</p>



<a name="177649501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649501">(Oct 08 2019 at 19:20)</a>:</h4>
<p>Let's say I'm doing <code>bilinear_form.lean</code></p>



<a name="177649507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649507">(Oct 08 2019 at 19:20)</a>:</h4>
<p>I'll create a task list.</p>



<a name="177649662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649662">(Oct 08 2019 at 19:22)</a>:</h4>
<p>What are the odds we accidentally change something non-cosmetic in this PR?</p>



<a name="177649739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649739">(Oct 08 2019 at 19:23)</a>:</h4>
<p>We should probably write something to check that we don't accidentally mess things up.</p>



<a name="177649752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649752">(Oct 08 2019 at 19:23)</a>:</h4>
<p>But I'm not sure how.</p>



<a name="177649840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649840">(Oct 08 2019 at 19:24)</a>:</h4>
<p>Well, we will check it will build</p>



<a name="177649857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649857">(Oct 08 2019 at 19:24)</a>:</h4>
<p>I assumed the three files that were edited were done.</p>



<a name="177649871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177649871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177649871">(Oct 08 2019 at 19:25)</a>:</h4>
<p>See the list on the PR page</p>



<a name="177650045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650045">(Oct 08 2019 at 19:26)</a>:</h4>
<p>Yeah, they're done.</p>



<a name="177650094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650094">(Oct 08 2019 at 19:27)</a>:</h4>
<p>But I'm worried we'll accidentally specialize a universe level or something that doesn't break the build.</p>



<a name="177650197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650197">(Oct 08 2019 at 19:28)</a>:</h4>
<p>We probably want to update <code>algebra.module</code> too.</p>



<a name="177650236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650236">(Oct 08 2019 at 19:29)</a>:</h4>
<p>Can't you use meta-programming to assert that two statements are the same modulo naming?</p>



<a name="177650270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650270">(Oct 08 2019 at 19:29)</a>:</h4>
<p>We could have a folder  <code>renamed_linear_algebra</code> to access both versions at the same time</p>



<a name="177650436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650436">(Oct 08 2019 at 19:31)</a>:</h4>
<p>Yes, but you need to fix the nameclashes somehow. I'm not sure if putting the whole file in a namespace will work.</p>



<a name="177650470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650470">(Oct 08 2019 at 19:31)</a>:</h4>
<p>True.</p>



<a name="177650615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650615">(Oct 08 2019 at 19:33)</a>:</h4>
<p>What should be the name of another ring? <code>S</code>?</p>



<a name="177650746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650746">(Oct 08 2019 at 19:35)</a>:</h4>
<p>I used <code>M M₂ V V₂ ...</code>. Didn't have more than one ring, but there's an obvious pattern.</p>



<a name="177650847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650847">(Oct 08 2019 at 19:36)</a>:</h4>
<p>Actually it's not really a second ring. The first one is a <code>ring</code> and the second one is <code>comm_ring</code>, but the first variable is still there.</p>



<a name="177650949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177650949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177650949">(Oct 08 2019 at 19:37)</a>:</h4>
<p>Up to you then.</p>



<a name="177651345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177651345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177651345">(Oct 08 2019 at 19:41)</a>:</h4>
<p><code>bilinear_form.lean</code> is done</p>



<a name="177651406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177651406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177651406">(Oct 08 2019 at 19:42)</a>:</h4>
<p>I'll work on determinant</p>



<a name="177651438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177651438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177651438">(Oct 08 2019 at 19:42)</a>:</h4>
<p>It's also done</p>



<a name="177651450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177651450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177651450">(Oct 08 2019 at 19:42)</a>:</h4>
<p>That was actually a rebellious file.</p>



<a name="177651513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177651513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177651513">(Oct 08 2019 at 19:43)</a>:</h4>
<p>I'll move to <code>direct_sum_module</code></p>



<a name="177652385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652385">(Oct 08 2019 at 19:53)</a>:</h4>
<p>I'll start working on <code>dual.lean</code></p>



<a name="177652432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652432">(Oct 08 2019 at 19:53)</a>:</h4>
<p>Lol... it was already written by a mathematician. Next.</p>



<a name="177652493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652493">(Oct 08 2019 at 19:54)</a>:</h4>
<p>I'll start on <code>finite_dimensional.lean</code></p>



<a name="177652576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652576">(Oct 08 2019 at 19:55)</a>:</h4>
<p>Is it ok if fields are called <code>K</code>? Or do we insist on blackboard bold <code>k</code>?</p>



<a name="177652596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652596">(Oct 08 2019 at 19:55)</a>:</h4>
<p>In the algebra directory we are using <code>K</code> a lot</p>



<a name="177652617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652617">(Oct 08 2019 at 19:55)</a>:</h4>
<p>If there are no compact subgroups in sight, I wouldn't mind <code>K</code></p>



<a name="177652699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652699">(Oct 08 2019 at 19:56)</a>:</h4>
<p>Oh, wait, I just noticed I used a different <code>k</code> from Alex.</p>



<a name="177652772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652772">(Oct 08 2019 at 19:57)</a>:</h4>
<p>We should probably pick one and standardize on it if we're going through all this trouble.</p>



<a name="177652933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652933">(Oct 08 2019 at 19:59)</a>:</h4>
<p>But a field extension is called <code>L</code></p>



<a name="177652953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652953">(Oct 08 2019 at 19:59)</a>:</h4>
<p>And <code>L</code> over blackboard bold <code>k</code> looks weird</p>



<a name="177652970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177652970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177652970">(Oct 08 2019 at 19:59)</a>:</h4>
<p>So I think we should allow different things for fields in different parts of the library</p>



<a name="177653087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653087">(Oct 08 2019 at 20:00)</a>:</h4>
<p>I'm currently looking at <code>finsupp_vector_space.lean</code>.</p>



<a name="177653147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653147">(Oct 08 2019 at 20:00)</a>:</h4>
<p>It needs index sets for families of vectors. Do we call those <code>alpha</code>? or <code>iota</code>?</p>



<a name="177653159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653159">(Oct 08 2019 at 20:00)</a>:</h4>
<p><code>iota</code> for index sets.</p>



<a name="177653171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653171">(Oct 08 2019 at 20:00)</a>:</h4>
<p>I don't care what K we use as long as we use the same K.</p>



<a name="177653182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653182">(Oct 08 2019 at 20:01)</a>:</h4>
<p><code>direct_sum_module</code> is done</p>



<a name="177653238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653238">(Oct 08 2019 at 20:01)</a>:</h4>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="double-struck">k</mi></mrow><annotation encoding="application/x-tex">\mathbb{k}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">k</span></span></span></span></span> is used in the calculus library</p>



<a name="177653447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653447">(Oct 08 2019 at 20:03)</a>:</h4>
<p>Yes, and for good reasons</p>



<a name="177653451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177653451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177653451">(Oct 08 2019 at 20:03)</a>:</h4>
<p>But it doesn't scale</p>



<a name="177654684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177654684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177654684">(Oct 08 2019 at 20:16)</a>:</h4>
<p>I meant: I don't think it matters too much to be consistent from <code>linear_algebra</code> to <code>calculus</code></p>



<a name="177654764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177654764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177654764">(Oct 08 2019 at 20:17)</a>:</h4>
<p>And I guess it's not too late to switch in the PR, especially since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="double-struck">k</mi></mrow><annotation encoding="application/x-tex">\mathbb{k}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">k</span></span></span></span></span> is easy to search and replace (after checking there aren't too many <code>k</code> or <code>K</code> lying around)</p>



<a name="177655520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177655520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177655520">(Oct 08 2019 at 20:26)</a>:</h4>
<p>I've done matrix.lean</p>



<a name="177655630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177655630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177655630">(Oct 08 2019 at 20:27)</a>:</h4>
<p>I'll do sesquilinear</p>



<a name="177655710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177655710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177655710">(Oct 08 2019 at 20:28)</a>:</h4>
<p>I'm going to stop for tonight</p>



<a name="177655718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177655718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177655718">(Oct 08 2019 at 20:28)</a>:</h4>
<p>Good luck with the last 3 files</p>



<a name="177655761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177655761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177655761">(Oct 08 2019 at 20:29)</a>:</h4>
<p>Ok, thanks!</p>



<a name="177656503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177656503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177656503">(Oct 08 2019 at 20:37)</a>:</h4>
<p>I've done sesquilinear, moving to tensor product</p>



<a name="177657215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177657215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177657215">(Oct 08 2019 at 20:44)</a>:</h4>
<p>Done, moving to finsupp</p>



<a name="177657395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177657395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177657395">(Oct 08 2019 at 20:47)</a>:</h4>
<p>I changed my kappas to bb k's.</p>



<a name="177657977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177657977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177657977">(Oct 08 2019 at 20:52)</a>:</h4>
<p>In finsupp, do you want to replace alpha with iota?</p>



<a name="177657995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177657995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177657995">(Oct 08 2019 at 20:52)</a>:</h4>
<p>I think it's a different usage, but one could disagree</p>



<a name="177658016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177658016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177658016">(Oct 08 2019 at 20:53)</a>:</h4>
<p>The field extension could be <code>𝕃</code> or <code>𝕝</code> (the latter is not very readable I think).</p>



<a name="177660015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177660015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177660015">(Oct 08 2019 at 21:16)</a>:</h4>
<p>All files in <code>linear_algebra</code> have been edited.</p>



<a name="177730360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730360">(Oct 09 2019 at 16:19)</a>:</h4>
<p>How risk-tolerant are we feeling about merging this? I'm still not sure how to (easily) write a metaprogram that checks all declarations are alpha-equivalent to what they were before.</p>



<a name="177730496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730496">(Oct 09 2019 at 16:20)</a>:</h4>
<p>Chris' PRs are getting dangerously close to here. <a href="https://github.com/leanprover-community/mathlib/issues/1523" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1523">#1523</a> will conflict if we do this renaming in <code>algebra.module</code>, which we eventually should.</p>



<a name="177730569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730569">(Oct 09 2019 at 16:21)</a>:</h4>
<p>Did you try using that branch with the capset repo?</p>



<a name="177730596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730596">(Oct 09 2019 at 16:21)</a>:</h4>
<p>and sensitivity conjecture? As far as I know, this are the only uses of this linear algebra lib</p>



<a name="177730689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730689">(Oct 09 2019 at 16:22)</a>:</h4>
<p>Hmm, no, that's a reasonable test. I'll try that in a bit.</p>



<a name="177730704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177730704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177730704">(Oct 09 2019 at 16:22)</a>:</h4>
<p>Definitely not comprehensive, but it's a start.</p>



<a name="177731325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177731325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177731325">(Oct 09 2019 at 16:31)</a>:</h4>
<p>If you have two version which you really think only differ by alpha renaming then probably their <code>lean --export</code>s should be the same if you ignore the name part of a <code>#NS</code></p>



<a name="177736191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177736191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177736191">(Oct 09 2019 at 17:23)</a>:</h4>
<p>Though I don't know how stable the numbering of items is, maybe it depends on variable names somehow</p>



<a name="177736901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177736901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177736901">(Oct 09 2019 at 17:30)</a>:</h4>
<blockquote>
<p>Chris' PRs are getting dangerously close to here. <a href="https://github.com/leanprover-community/mathlib/issues/1523" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1523">#1523</a> will conflict if we do this renaming in <code>algebra.module</code>, which we eventually should.</p>
</blockquote>
<p>There's no need for it to all be done in one go. Why not merge what's done already, and finish the rest off in some other PR?</p>



<a name="177742834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177742834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177742834">(Oct 09 2019 at 18:34)</a>:</h4>
<blockquote>
<p>How risk-tolerant are we feeling about merging this? I'm still not sure how to (easily) write a metaprogram that checks all declarations are alpha-equivalent to what they were before.</p>
</blockquote>
<p>I'm going to attempt to do this. We think <code>lin_alg_rename</code> is the same as commit 7c560512b849832824493949a29fbf6b6b7ac223 right?</p>



<a name="177745049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177745049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177745049">(Oct 09 2019 at 18:59)</a>:</h4>
<blockquote>
<blockquote>
<p>How risk-tolerant are we feeling about merging this? I'm still not sure how to (easily) write a metaprogram that checks all declarations are alpha-equivalent to what they were before.</p>
</blockquote>
<p>I'm going to attempt to do this. We think <code>lin_alg_rename</code> is the same as commit 7c560512b849832824493949a29fbf6b6b7ac223 right?</p>
</blockquote>
<p>Yeah, that should be right. I'm building the exports right now, but it's slow on my laptop.</p>



<a name="177745561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177745561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177745561">(Oct 09 2019 at 19:05)</a>:</h4>
<p>Heh, one of the exports somehow has 4000 more lines than the other...</p>



<a name="177745680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177745680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177745680">(Oct 09 2019 at 19:06)</a>:</h4>
<p>Either something changed, or it's not an accurate way to compare.</p>



<a name="177745976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177745976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177745976">(Oct 09 2019 at 19:10)</a>:</h4>
<p>Unfortunately if the exports are not the same then it's going to be very hard to tell how they differ</p>



<a name="177746588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177746588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177746588">(Oct 09 2019 at 19:17)</a>:</h4>
<p>Here is my attempt to alpha normalize everything. Does it look reasonable? It's quite slow to run on all of the core library already...</p>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">tactic</span> <span class="n">expr</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">gen_name</span> <span class="o">(</span><span class="n">hint</span> <span class="o">:</span> <span class="n">string</span><span class="o">)</span> <span class="o">:</span> <span class="n">state_t</span> <span class="n">nat</span> <span class="n">tactic</span> <span class="n">name</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">i</span> <span class="err">←</span> <span class="n">get</span><span class="o">,</span>
   <span class="n">put</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span>
   <span class="n">return</span> <span class="o">(</span><span class="n">mk_simple_name</span> <span class="o">(</span><span class="n">hint</span> <span class="bp">++</span> <span class="n">to_string</span> <span class="n">i</span><span class="o">))</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">alpha_normalize_aux</span> <span class="o">:</span> <span class="n">expr</span> <span class="bp">→</span> <span class="n">state_t</span> <span class="n">nat</span> <span class="n">tactic</span> <span class="n">expr</span>
<span class="bp">|</span> <span class="n">e</span><span class="bp">@</span><span class="o">(</span><span class="n">var</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">return</span> <span class="n">e</span>
<span class="bp">|</span> <span class="n">e</span><span class="bp">@</span><span class="o">(</span><span class="n">sort</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">return</span> <span class="n">e</span>
<span class="bp">|</span> <span class="n">e</span><span class="bp">@</span><span class="o">(</span><span class="n">const</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">return</span> <span class="n">e</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mvar</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">state_t</span><span class="bp">.</span><span class="n">lift</span> <span class="o">(</span><span class="n">fail</span> <span class="s2">&quot;Unexpected mvar in type&quot;</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">local_const</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">state_t</span><span class="bp">.</span><span class="n">lift</span> <span class="o">(</span><span class="n">fail</span> <span class="s2">&quot;Unexpected local_const in type&quot;</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">app</span> <span class="n">e₁</span> <span class="n">e₂</span><span class="o">)</span> <span class="o">:=</span> <span class="n">app</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₁</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₂</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">lam</span> <span class="bp">_</span> <span class="n">bi</span> <span class="n">e₁</span> <span class="n">e₂</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">lam</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">gen_name</span> <span class="s2">&quot;x&quot;</span> <span class="bp">&lt;*&gt;</span>
    <span class="n">pure</span> <span class="n">bi</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₁</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₂</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">pi</span> <span class="bp">_</span> <span class="n">bi</span> <span class="n">e₁</span> <span class="n">e₂</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">pi</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">gen_name</span> <span class="s2">&quot;a&quot;</span> <span class="bp">&lt;*&gt;</span>
    <span class="n">pure</span> <span class="n">bi</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₁</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₂</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">elet</span> <span class="bp">_</span> <span class="n">bi</span> <span class="n">e₁</span> <span class="n">e₂</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">elet</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">gen_name</span> <span class="s2">&quot;v&quot;</span> <span class="bp">&lt;*&gt;</span>
    <span class="n">pure</span> <span class="n">bi</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₁</span> <span class="bp">&lt;*&gt;</span> <span class="n">alpha_normalize_aux</span> <span class="n">e₂</span>
<span class="c1">-- I have no idea whether this macro case is reasonable</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">macro</span> <span class="n">m</span> <span class="n">es</span><span class="o">)</span> <span class="o">:=</span> <span class="n">macro</span> <span class="n">m</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">mmap</span> <span class="n">alpha_normalize_aux</span> <span class="n">es</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">alpha_normalize</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">expr</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">expr</span> <span class="o">:=</span>
<span class="n">prod</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="o">((</span><span class="n">alpha_normalize_aux</span> <span class="n">e</span><span class="o">)</span><span class="bp">.</span><span class="n">run</span> <span class="mi">0</span><span class="o">)</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">emit_declaration</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">declaration</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="k">let</span> <span class="n">ls</span> <span class="o">:=</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">range</span> <span class="n">d</span><span class="bp">.</span><span class="n">univ_params</span><span class="bp">.</span><span class="n">length</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">level</span><span class="bp">.</span><span class="n">param</span> <span class="o">(</span><span class="n">mk_simple_name</span> <span class="err">$</span> <span class="s2">&quot;u&quot;</span> <span class="bp">++</span> <span class="n">to_string</span> <span class="n">i</span><span class="o">)),</span>
   <span class="n">t</span> <span class="err">←</span> <span class="n">d</span><span class="bp">.</span><span class="n">instantiate_type_univ_params</span> <span class="n">ls</span><span class="o">,</span>
   <span class="n">t&#39;</span> <span class="err">←</span> <span class="n">alpha_normalize</span> <span class="n">t</span> <span class="bp">&lt;|&gt;</span> <span class="n">fail</span> <span class="o">(</span><span class="s2">&quot;failed on declaration &quot;</span> <span class="bp">++</span> <span class="n">d</span><span class="bp">.</span><span class="n">to_name</span><span class="bp">.</span><span class="n">to_string</span><span class="o">),</span>
   <span class="n">vs</span> <span class="err">←</span> <span class="k">match</span> <span class="n">d</span> <span class="k">with</span>
   <span class="bp">|</span> <span class="o">(</span><span class="n">declaration</span><span class="bp">.</span><span class="n">defn</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">do</span>
       <span class="n">v</span> <span class="err">←</span> <span class="n">d</span><span class="bp">.</span><span class="n">instantiate_value_univ_params</span> <span class="n">ls</span><span class="o">,</span>
       <span class="n">v&#39;</span> <span class="err">←</span> <span class="n">alpha_normalize</span> <span class="n">v</span> <span class="bp">&lt;|&gt;</span> <span class="n">fail</span> <span class="o">(</span><span class="s2">&quot;failed on declaration &quot;</span> <span class="bp">++</span> <span class="n">d</span><span class="bp">.</span><span class="n">to_name</span><span class="bp">.</span><span class="n">to_string</span><span class="o">),</span>
       <span class="n">return</span> <span class="n">v&#39;</span><span class="bp">.</span><span class="n">to_string</span>
   <span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">return</span> <span class="s2">&quot;_&quot;</span>
   <span class="kn">end</span><span class="o">,</span>
   <span class="n">tactic</span><span class="bp">.</span><span class="n">trace</span> <span class="o">(</span><span class="n">d</span><span class="bp">.</span><span class="n">to_name</span><span class="bp">.</span><span class="n">to_string</span> <span class="bp">++</span> <span class="s2">&quot;</span><span class="err">\</span><span class="s2">t&quot;</span> <span class="bp">++</span> <span class="n">t&#39;</span><span class="bp">.</span><span class="n">to_string</span> <span class="bp">++</span> <span class="s2">&quot;</span><span class="err">\</span><span class="s2">t&quot;</span> <span class="bp">++</span> <span class="n">vs</span><span class="o">),</span>
   <span class="n">return</span> <span class="o">()</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">emit_all</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">e</span> <span class="err">←</span> <span class="n">get_env</span><span class="o">,</span>
   <span class="n">e</span><span class="bp">.</span><span class="n">fold</span> <span class="o">(</span><span class="n">return</span> <span class="o">())</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">d</span> <span class="n">m</span><span class="o">,</span> <span class="n">emit_declaration</span> <span class="n">d</span> <span class="bp">&gt;&gt;</span> <span class="n">m</span><span class="o">)</span>

<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">all</span> <span class="n">true</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">unit</span> <span class="o">:=</span> <span class="k">begin</span>
  <span class="n">emit_all</span><span class="o">,</span>
  <span class="n">constructor</span>
<span class="kn">end</span>
</pre></div>



<a name="177746651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177746651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177746651">(Oct 09 2019 at 19:18)</a>:</h4>
<p>oh, actually it only took 43 seconds to run on core</p>



<a name="177746856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177746856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177746856">(Oct 09 2019 at 19:21)</a>:</h4>
<p>The idea is to run this on both mathlibs, then sort and compare the outputs. I guess this only checks the types currently, not the values (for definitions).</p>



<a name="177747735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177747735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177747735">(Oct 09 2019 at 19:31)</a>:</h4>
<p>The sensitivity proof is very slightly broken but not caused by our changes.</p>



<a name="177747904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177747904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177747904">(Oct 09 2019 at 19:33)</a>:</h4>
<p>Incidentally, I just noticed something. Tooltips in VSCode specialize universe levels when you hover over declarations to see the type, but only sometimes. Hover over <code>vector_space.dim</code> in the following and compare.</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">f</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="mi">10</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">vector_space</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span> <span class="k">have</span> <span class="n">vector_space</span><span class="bp">.</span><span class="n">dim</span> <span class="n">ℝ</span> <span class="n">α</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span> <span class="n">trivial</span>
<span class="n">def</span> <span class="n">g</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="mi">10</span><span class="o">}</span>  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">vector_space</span> <span class="n">ℝ</span> <span class="n">α</span><span class="o">]</span> <span class="o">:=</span> <span class="n">vector_space</span><span class="bp">.</span><span class="n">dim</span> <span class="n">ℝ</span> <span class="n">α</span>
</pre></div>



<a name="177748058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748058">(Oct 09 2019 at 19:35)</a>:</h4>
<p>I think that script looks reasonable? The output will be enormous.</p>



<a name="177748122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748122">(Oct 09 2019 at 19:36)</a>:</h4>
<p>I modified my tactic to emit the values of definitions as well.</p>



<a name="177748145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748145">(Oct 09 2019 at 19:36)</a>:</h4>
<p>We really need to PR that sensitivity thing to mathlib's example folder</p>



<a name="177748207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748207">(Oct 09 2019 at 19:37)</a>:</h4>
<p>Yeah, it's been on my todo list for ages but hasn't reached the top.</p>



<a name="177748209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748209">(Oct 09 2019 at 19:37)</a>:</h4>
<p>some of the individual types it outputs are around a megabyte</p>



<a name="177748250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748250">(Oct 09 2019 at 19:37)</a>:</h4>
<blockquote>
<p>some of the individual types it outputs are around a megabyte</p>
</blockquote>
<p>Sounds about right!</p>



<a name="177748305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748305">(Oct 09 2019 at 19:38)</a>:</h4>
<blockquote>
<p>Yeah, it's been on my todo list for ages but hasn't reached the top.</p>
</blockquote>
<p>Same here...</p>



<a name="177748318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748318">(Oct 09 2019 at 19:38)</a>:</h4>
<p>It still takes less than a minute on core, so hopefully it will take less than a day on mathlib?</p>



<a name="177748342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748342">(Oct 09 2019 at 19:38)</a>:</h4>
<p>The breakage in the sensitivity proof was really minor, but one of the breaks I don't understand.</p>



<a name="177748359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748359">(Oct 09 2019 at 19:39)</a>:</h4>
<p>It's easy to fix but I don't know why it happened.</p>



<a name="177748636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177748636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177748636">(Oct 09 2019 at 19:42)</a>:</h4>
<blockquote>
<p>It still takes less than a minute on core, so hopefully it will take less than a day on mathlib?</p>
</blockquote>
<p>And you have to run it twice to compare!</p>



<a name="177750313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177750313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177750313">(Oct 09 2019 at 20:00)</a>:</h4>
<p>Luckily I didn't try to make it process anything in parallel so my laptop can do both runs at once</p>



<a name="177751085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177751085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177751085">(Oct 09 2019 at 20:09)</a>:</h4>
<p>So the script noticed that in <code>sesq_form.to_module</code> the order of the two universe parameters changed</p>



<a name="177751126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177751126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177751126">(Oct 09 2019 at 20:09)</a>:</h4>
<p>which is not that surprising, and almost certainly harmless?</p>



<a name="177751286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177751286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177751286">(Oct 09 2019 at 20:11)</a>:</h4>
<p>Oh, it's not the universe arguments order that changed</p>



<a name="177751394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177751394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177751394">(Oct 09 2019 at 20:12)</a>:</h4>
<p>it's the order of various implicit/type class arguments. It used to be</p>
<div class="codehilite"><pre><span></span>sesq_form.to_module    Pi {a0 : Type.{u0}} [a1 : add_comm_group.{u0} a0] {a2 : Type.{u1}} [a3 : comm_ring.{u1} a2] [a4 : module.{u1 u0} a2 a0 (comm_ring.to_ring.{u1} a2 a3) a1] ...
</pre></div>


<p>and now it's a more logical</p>
<div class="codehilite"><pre><span></span>sesq_form.to_module    Pi {a0 : Type.{u1}} [a1 : comm_ring.{u1} a0] {a2 : Type.{u0}} [a3 : add_comm_group.{u0} a2] [a4 : module.{u1 u0} a0 a2 (comm_ring.to_ring.{u1} a0 a1) a3] ...
</pre></div>



<a name="177751773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177751773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177751773">(Oct 09 2019 at 20:16)</a>:</h4>
<p>Was that the only change that it found?</p>



<a name="177752061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177752061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177752061">(Oct 09 2019 at 20:17)</a>:</h4>
<p>It's currently trying to emit what must be a rather large type</p>



<a name="177752075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177752075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177752075">(Oct 09 2019 at 20:17)</a>:</h4>
<p>Hmm. It is a semantic change, but an improvement. We can take that one.</p>



<a name="177752319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177752319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177752319">(Oct 09 2019 at 20:20)</a>:</h4>
<p>Reid, you're not checking all of mathlib, are you? It's easy enough to only run that on files in the linear_algebra directory.</p>



<a name="177752322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177752322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177752322">(Oct 09 2019 at 20:20)</a>:</h4>
<p>I just noticed that wasn't in the script you posted.</p>



<a name="177753865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177753865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177753865">(Oct 09 2019 at 20:38)</a>:</h4>
<p>Indeed that optimization seems to be worth implementing</p>



<a name="177753895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177753895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177753895">(Oct 09 2019 at 20:38)</a>:</h4>
<p>How can I check whether a string contains another string?</p>



<a name="177754050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177754050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177754050">(Oct 09 2019 at 20:40)</a>:</h4>
<p><code>sanity_check</code> is probably the easiest example of this to follow.</p>



<a name="177754227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177754227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177754227">(Oct 09 2019 at 20:42)</a>:</h4>
<p>oh, I have to use mathlib apparently</p>



<a name="177755536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177755536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177755536">(Oct 09 2019 at 20:57)</a>:</h4>
<p>Update: It's still slow</p>



<a name="177755683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177755683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177755683">(Oct 09 2019 at 20:59)</a>:</h4>
<p>But slow on the 768 declarations in linear algebra instead of the 32098 in mathlib plus whatever's in core.</p>



<a name="177760391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177760391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177760391">(Oct 09 2019 at 22:06)</a>:</h4>
<p>It's apparently been stuck trying to print the type of a single declaration for more than an hour</p>



<a name="177760403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177760403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177760403">(Oct 09 2019 at 22:07)</a>:</h4>
<p>I fear my day estimate was optimistic</p>



<a name="177761576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177761576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177761576">(Oct 09 2019 at 22:25)</a>:</h4>
<div class="codehilite"><pre><span></span>rwbarton@operad:~/math/lean/mathlib$ head -131 after-rename/la.out | tail -1 | wc
      1 57995424 546484410
</pre></div>



<a name="177761799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177761799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177761799">(Oct 09 2019 at 22:29)</a>:</h4>
<p>Okay I ignored autogenerated and internal things and now it takes 12 seconds.</p>



<a name="177762034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177762034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177762034">(Oct 09 2019 at 22:33)</a>:</h4>
<p>I need to meet someone for dinner now, but I can say that there are only 7 changes and the total sizes of the files are equal, which makes me think they are all of the same form where arguments got permuted. Though universe variables accidentally becoming unified would also be consistent with the file size not changing</p>



<a name="177762041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177762041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177762041">(Oct 09 2019 at 22:33)</a>:</h4>
<p>I'll look at these more closely after dinner</p>



<a name="177762110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177762110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177762110">(Oct 09 2019 at 22:34)</a>:</h4>
<p>Or here are the changes if other people want to look <a href="/user_uploads/3121/kEM2dyjQkWBdwFV6FdqHBxBD/out.diff" target="_blank" title="out.diff">out.diff</a></p>



<a name="177776512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177776512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177776512">(Oct 10 2019 at 03:41)</a>:</h4>
<p>Seems like there are actually quite a few changes: <a href="/user_uploads/3121/607wd_t2m-Ul9c0VMxNRlktX/out.word_diff" target="_blank" title="out.word_diff">out.word_diff</a></p>



<a name="177776523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177776523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177776523">(Oct 10 2019 at 03:41)</a>:</h4>
<p>But as far as I can see it is mostly reordering universe variables...</p>



<a name="177776569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177776569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177776569">(Oct 10 2019 at 03:42)</a>:</h4>
<p>But this time its hard to read again, because the names don't have any semantics...</p>



<a name="177776575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177776575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177776575">(Oct 10 2019 at 03:42)</a>:</h4>
<p>Ooh, read that file with <code>less -R out.word_diff</code> to see the colors</p>



<a name="177776658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177776658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177776658">(Oct 10 2019 at 03:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Your tool should probably be preserved in the <code>scripts/</code> directory...</p>



<a name="177790955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177790955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177790955">(Oct 10 2019 at 08:54)</a>:</h4>
<p>Well, there are definitely permuted arguments, which makes it really really hard to see if anything else changed.</p>



<a name="177791434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177791434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177791434">(Oct 10 2019 at 09:01)</a>:</h4>
<p>After squinting at the diff, I'm more confident that this is safe. But still not 100%.</p>



<a name="177791491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177791491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177791491">(Oct 10 2019 at 09:02)</a>:</h4>
<p>Same feeling over here</p>



<a name="177791525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177791525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177791525">(Oct 10 2019 at 09:03)</a>:</h4>
<p>I think I'm confident enough to merge and patch if/when universe issues show up.</p>



<a name="177791558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177791558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177791558">(Oct 10 2019 at 09:03)</a>:</h4>
<p>Not thrilled about the permuted arguments, I wish this had been a purely syntactic change. But I'm not gonna try to fix this.</p>



<a name="177791745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%231521%20rename%20type%20variables/near/177791745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.231521.20rename.20type.20variables.html#177791745">(Oct 10 2019 at 09:06)</a>:</h4>
<p>I'm sorry, I might have been responsible for this.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>