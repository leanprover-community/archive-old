---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html">#6572 crashes leanchecker</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="229213749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229213749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229213749">(Mar 07 2021 at 20:01)</a>:</h4>
<p>Any ideas? <a href="https://github.com/leanprover-community/mathlib/runs/2051731961?check_suite_focus=true#step:8:8">https://github.com/leanprover-community/mathlib/runs/2051731961?check_suite_focus=true#step:8:8</a></p>



<a name="229215347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229215347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229215347">(Mar 07 2021 at 20:25)</a>:</h4>
<p>It looks like <code>ext_exception</code> contains extra error information, but <code>lean_checker</code> doesn't know how to print it</p>



<a name="229229414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229229414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229229414">(Mar 08 2021 at 00:08)</a>:</h4>
<p>FWIW, <code>nanoda_lib</code> was updated recently to fix the issues mentioned in <a href="#narrow/stream/144837-PR-reviews/topic/.236375/near/228434456">the other recent leanchecker bug thread</a>, but it also crashes on this commit: <a href="https://github.com/ammkrn/nanoda_lib/issues/1">https://github.com/ammkrn/nanoda_lib/issues/1</a></p>



<a name="229229557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229229557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229229557">(Mar 08 2021 at 00:11)</a>:</h4>
<p>The <code>nanoda_lib</code> message is <em>ever so slightly</em> more revealing than the leanchecker one, but not by much</p>



<a name="229229585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229229585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229229585">(Mar 08 2021 at 00:11)</a>:</h4>
<p>It's a shame that neither reveal the offending lemma</p>



<a name="229230293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230293">(Mar 08 2021 at 00:21)</a>:</h4>
<p>Running <code>leanchecker</code> on my machine I get an error on a different line of <code>mathlib.txt</code>, but perhaps the export output is non-deterministic, or the error is a memory error that depends on the system it runs on. My hunch is that the error relates to this line:</p>
<p><a href="https://github.com/leanprover-community/mathlib/blob/abb3121f210743a930dea73cd766d988079bdf8b/src/data/mv_polynomial/variables.lean#L478">https://github.com/leanprover-community/mathlib/blob/abb3121f210743a930dea73cd766d988079bdf8b/src/data/mv_polynomial/variables.lean#L478</a></p>



<a name="229230562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230562">(Mar 08 2021 at 00:26)</a>:</h4>
<p>Oh whoops, I didn't pay attention to the line number in <code>leanchecker</code>'s output so I just ran it again. On my machine it says: <code>line 5909651: kernel exception</code>.</p>



<a name="229230633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230633">(Mar 08 2021 at 00:26)</a>:</h4>
<p>Whereas the message in the CI log is: <code>line 5909649: kernel exception</code>.</p>



<a name="229230639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230639">(Mar 08 2021 at 00:26)</a>:</h4>
<p>Mine gives <code>line 5909498</code></p>



<a name="229230668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230668">(Mar 08 2021 at 00:27)</a>:</h4>
<p>Which starts <code>#DEF 48051</code>, and the line starting with <code>48051</code> ends in <code>total_degree_mul</code></p>



<a name="229230758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230758">(Mar 08 2021 at 00:29)</a>:</h4>
<p>It's <code>#DEF 48063</code> for me but the line starting with <code>48063</code> also ends in <code>total_degree_mul</code>.</p>



<a name="229230778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230778">(Mar 08 2021 at 00:29)</a>:</h4>
<p>Perhaps the CI should upload the txt file if that step fails</p>



<a name="229230782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230782">(Mar 08 2021 at 00:29)</a>:</h4>
<p>After gzipping, anyway, since 500MB is on the large sizee</p>



<a name="229230856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229230856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229230856">(Mar 08 2021 at 00:30)</a>:</h4>
<p>I'm trying now with the output of <code>lean --export=mathlib.txt src/data/mv_polynomial/variables.lean</code>, which is the file that lemma appears in</p>



<a name="229231192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229231192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229231192">(Mar 08 2021 at 00:36)</a>:</h4>
<p>It succeeds</p>



<a name="229231308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229231308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229231308">(Mar 08 2021 at 00:37)</a>:</h4>
<p>I guess I can try pushing a version of the PR that doesn't touch the lemma used by total_degree_mul though, and see if that helps</p>



<a name="229231537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229231537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229231537">(Mar 08 2021 at 00:40)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/tree/eric-wieser/monoid_algebra-distrib-2">branch#eric-wieser/monoid_algebra-distrib-2</a> has the modified version, lets see if it helps</p>



<a name="229240330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229240330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229240330">(Mar 08 2021 at 03:01)</a>:</h4>
<p><span class="user-mention" data-user-id="228466">@Chris B</span> reported the following at the <code>nanoda_lib</code> issue:</p>
<blockquote>
<p>Zulip won't let me reply to your thread, it says I'm not subscribed to the stream. The offender is <code>mv_polynomial.total_degree_mul</code>. FWIW Trepplein is also failing, so there seems to be consensus. Trepplein's error message says <code>mv_polynomial.degrees_mul</code>, but that's a local error and not the top level declaration. If leanchecker is failing but the proof isn't throwing an error in Lean proper, my guess is that this is an issue with the exporter.</p>
</blockquote>
<blockquote>
<p>As a short term measure, I added an example executable <code>examples/debug.rs</code> that will run the checker on 1 thread only and print the names of the declarations as they're compiled and checked. You can invoke it with:</p>
</blockquote>
<blockquote>
<p><code>cargo run --release --example debug &lt;path to export file&gt;</code></p>
</blockquote>



<a name="229241757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229241757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229241757">(Mar 08 2021 at 03:22)</a>:</h4>
<p>Test</p>



<a name="229241820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229241820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229241820">(Mar 08 2021 at 03:23)</a>:</h4>
<p>The old nanoda pretty printer was able to reconstruct the types from the export file such that they match the current mathlib master signatures, so that doesn't seem to be an issue. Unfortunately the value level terms are giant tactic proofs, so I can post them if you want to see them, but I'm not sure how much good they'll do.</p>



<a name="229242125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229242125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229242125">(Mar 08 2021 at 03:28)</a>:</h4>
<p><a href="https://gist.github.com/ammkrn/75e5f979ecd0edd859fba3b3c505423c">https://gist.github.com/ammkrn/75e5f979ecd0edd859fba3b3c505423c</a></p>



<a name="229242803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229242803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229242803">(Mar 08 2021 at 03:39)</a>:</h4>
<p>OK, just to make sure I understand the situation, <code>mv_polynomial.total_degree_mul</code> doesn't actually type check according to <code>nanoda_lib</code> and Trepplein. You've checked using <code>nanoda</code> that the exported type agrees with what's in mathlib source, so that suggests there's a bug in Lean causing it to accept this term when it shouldn't?</p>



<a name="229243787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229243787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229243787">(Mar 08 2021 at 03:55)</a>:</h4>
<p>I think the take-away from the pretty printer thing is just that there's not a blatant error in the export file w.r.t. the expected type of the definition, like the exported instructions are faithful to the original lean file's ascribed type. To narrow down the actual error a little bit, there's a call to <code>infer_app</code> where the type of the binder isn't definitionally equal to the inferred type of the argument.</p>
<p>From nanoda_lib, the reduced type of the binder is:<br>
<code>App (Const (has_add, [u_1]), App (App (App (Const (finsupp, [u_1, 0]), Local: {σ : Sort S(u_1)}), Const nat), Const nat.has_zero))</code><br>
and the arg type is:<br>
<code>App (Const (add_monoid, [M(u_1, 0)]), App (App (App (Const (finsupp, [u_1, 0]), Local: {σ : Sort S(u_1)}), Const nat), App (App (Const (add_monoid.to_has_zero, [0]), Const nat), Const nat.add_monoid)))</code></p>
<p>cleaned up:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">binder</span><span class="o">:</span> <span class="o">(</span><span class="n">has_add.</span><span class="o">{[</span><span class="n">u_1</span><span class="o">]}</span> <span class="o">(((</span><span class="n">finsupp.</span><span class="o">{[</span><span class="n">u_1</span><span class="o">,</span> <span class="mi">0</span><span class="o">]}</span> <span class="n">Local</span><span class="o">:</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Sort</span> <span class="n">S</span><span class="o">(</span><span class="n">u_1</span><span class="o">)})</span> <span class="n">nat</span><span class="o">)</span> <span class="n">nat.has_zero</span><span class="o">))</span>
<span class="n">inferred</span> <span class="n">arg</span><span class="o">:</span> <span class="o">(</span><span class="n">add_monoid.</span><span class="o">{[</span><span class="n">M</span><span class="o">(</span><span class="n">u_1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)]}</span> <span class="o">(((</span><span class="n">finsupp.</span><span class="o">{[</span><span class="n">u_1</span><span class="o">,</span> <span class="mi">0</span><span class="o">]}</span> <span class="n">Local</span><span class="o">:</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Sort</span> <span class="n">S</span><span class="o">(</span><span class="n">u_1</span><span class="o">)})</span> <span class="n">nat</span><span class="o">)</span> <span class="o">((</span><span class="n">add_monoid.to_has_zero.</span><span class="o">{[</span><span class="mi">0</span><span class="o">]}</span> <span class="n">nat</span><span class="o">)</span> <span class="n">nat.add_monoid</span><span class="o">)))</span>
</code></pre></div>
<p>The whole trepplein error is displayed as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Exception</span> <span class="k">in</span> <span class="n">thread</span> <span class="s2">"main"</span> <span class="n">java.lang.IllegalArgumentException</span><span class="o">:</span> <span class="n">wrong</span> <span class="n">type</span><span class="o">:</span>  <span class="n">finsupp.add_monoid</span>  <span class="o">:</span>  <span class="n">has_add</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span>
<span class="n">inferred</span> <span class="n">type</span><span class="o">:</span>  <span class="n">add_monoid</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span>
<span class="n">has_add</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span>  <span class="bp">!=</span><span class="kd">def</span>  <span class="n">add_monoid</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span>
<span class="n">stuck</span> <span class="n">on</span><span class="o">:</span>  <span class="n">has_add</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span> <span class="n">add_monoid</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span><span class="o">)</span>
</code></pre></div>



<a name="229246789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229246789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229246789">(Mar 08 2021 at 04:41)</a>:</h4>
<p>That could have been more clear in addressing your question: yes, according to nanoda_lib and trepplein, <code>mv_polynomial.total_degree_mul</code> is failing. According to nanoda_lib it's because of the application issue above. The pretty printer, which uses the export file, was able to reconstruct <code>mv_polynomial.total_degree_mul</code> as you see it in that gist using only the exported instructions. The type matches mathlib, but I haven't looked closely at the value level term.</p>



<a name="229249087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229249087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229249087">(Mar 08 2021 at 05:17)</a>:</h4>
<p>It looks like this is an issue with some constituent definition and not total_degree_mul itself. The value level term given in the export file for total_degree_mul in 5b61f07 (passing) and c8892e4 (failing) are identical.</p>



<a name="229249898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229249898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229249898">(Mar 08 2021 at 05:30)</a>:</h4>
<p>These are all of the consts referenced by total_degree_mul, so probably a good starting point. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="s2">"finsupp"</span><span class="o">,</span> <span class="s2">"comm_semiring.to_semiring"</span><span class="o">,</span> <span class="s2">"finsupp.has_add"</span><span class="o">,</span> <span class="s2">"ordered_semiring.to_ordered_cancel_add_comm_monoid"</span><span class="o">,</span> <span class="s2">"finset.has_mem"</span><span class="o">,</span> <span class="s2">"finset.mem_bUnion"</span><span class="o">,</span> <span class="s2">"finsupp.support"</span><span class="o">,</span> <span class="s2">"add_semigroup.to_has_add"</span><span class="o">,</span> <span class="s2">"nat.add_monoid"</span><span class="o">,</span> <span class="s2">"has_zero.zero"</span><span class="o">,</span> <span class="s2">"finset.le_sup"</span><span class="o">,</span> <span class="s2">"finsupp.sum_add_index"</span><span class="o">,</span> <span class="s2">"mv_polynomial.comm_semiring"</span><span class="o">,</span> <span class="s2">"semiring.to_distrib"</span><span class="o">,</span> <span class="s2">"distrib.to_has_mul"</span><span class="o">,</span> <span class="s2">"finset.has_singleton"</span><span class="o">,</span> <span class="s2">"classical.prop_decidable"</span><span class="o">,</span> <span class="s2">"add_comm_monoid.to_add_monoid"</span><span class="o">,</span> <span class="s2">"Exists.dcases_on"</span><span class="o">,</span> <span class="s2">"finset.bUnion"</span><span class="o">,</span> <span class="s2">"eq.trans"</span><span class="o">,</span> <span class="s2">"ordered_cancel_add_comm_monoid.to_ordered_add_comm_monoid"</span><span class="o">,</span> <span class="s2">"eq.refl"</span><span class="o">,</span> <span class="s2">"funext"</span><span class="o">,</span> <span class="s2">"order_bot.to_partial_order"</span><span class="o">,</span> <span class="s2">"finset.mem_singleton"</span><span class="o">,</span> <span class="s2">"eq.mp"</span><span class="o">,</span> <span class="s2">"preorder.to_has_le"</span><span class="o">,</span> <span class="s2">"has_singleton.singleton"</span><span class="o">,</span> <span class="s2">"nat.has_zero"</span><span class="o">,</span> <span class="s2">"add_le_add"</span><span class="o">,</span> <span class="s2">"eq"</span><span class="o">,</span> <span class="s2">"nat.ordered_semiring"</span><span class="o">,</span> <span class="s2">"finsupp.sum"</span><span class="o">,</span> <span class="s2">"semilattice_sup_bot.to_order_bot"</span><span class="o">,</span> <span class="s2">"has_le.le"</span><span class="o">,</span> <span class="s2">"has_mul.mul"</span><span class="o">,</span> <span class="s2">"nat"</span><span class="o">,</span> <span class="s2">"finsupp.add_monoid"</span><span class="o">,</span> <span class="s2">"eq.rec"</span><span class="o">,</span> <span class="s2">"eq.mpr"</span><span class="o">,</span> <span class="s2">"id"</span><span class="o">,</span> <span class="s2">"mv_polynomial.total_degree"</span><span class="o">,</span> <span class="s2">"semiring.to_monoid_with_zero"</span><span class="o">,</span> <span class="s2">"mv_polynomial"</span><span class="o">,</span> <span class="s2">"nat.semilattice_sup_bot"</span><span class="o">,</span> <span class="s2">"partial_order.to_preorder"</span><span class="o">,</span> <span class="s2">"eq.symm"</span><span class="o">,</span> <span class="s2">"comm_semiring"</span><span class="o">,</span> <span class="s2">"finset"</span><span class="o">,</span> <span class="s2">"finset.sup_le"</span><span class="o">,</span> <span class="s2">"has_mem.mem"</span><span class="o">,</span> <span class="s2">"add_monoid.to_add_semigroup"</span><span class="o">,</span> <span class="s2">"nat.add_comm_monoid"</span><span class="o">,</span> <span class="s2">"monoid_with_zero.to_mul_zero_class"</span><span class="o">,</span> <span class="s2">"nat.has_add"</span><span class="o">,</span> <span class="s2">"Exists"</span><span class="o">,</span> <span class="s2">"propext"</span><span class="o">,</span> <span class="s2">"add_monoid_algebra.support_mul"</span><span class="o">,</span> <span class="s2">"mul_zero_class.to_has_zero"</span><span class="o">,</span> <span class="s2">"add_monoid.to_has_zero"</span><span class="o">,</span> <span class="s2">"has_add.add"</span><span class="o">,</span> <span class="s2">"congr_arg"</span><span class="o">]</span>
</code></pre></div>



<a name="229262753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229262753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229262753">(Mar 08 2021 at 08:21)</a>:</h4>
<p>So, after removing an unrelated and unused definition, the PR seems to be passing</p>



<a name="229265915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229265915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229265915">(Mar 08 2021 at 08:52)</a>:</h4>
<p>Somehow the presence or absence of the unused definition <code>def add_monoid_algebra.to_multiplicative</code> affects whether <code>total_degree_mul</code> is accepted by lean checker, which is some scary action-at-a-distance...</p>



<a name="229272175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229272175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229272175">(Mar 08 2021 at 09:48)</a>:</h4>
<p>This sounds like an interesting bug!  I wouldn't be surprised if this is a bug in the projection macro.  However I'm having trouble reproducing it:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>$ git rev-parse HEAD
c8892e44fe95f8fe8b7892aa83b6ce0466fba8f5
$ lean -E export.txt src/data/mv_polynomial/variables.lean
$ leanchecker export.txt
checked 46571 declarations
$ ~/trepplein/target/universal/stage/bin/trepplein export.txt
-- successfully checked 46571 declarations
</code></pre></div>



<a name="229273208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229273208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229273208">(Mar 08 2021 at 09:58)</a>:</h4>
<p>Right, I've only been able to reproduce it on the full export</p>



<a name="229273235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229273235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229273235">(Mar 08 2021 at 09:58)</a>:</h4>
<p>Even though the failure looks to be within that file</p>



<a name="229273781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229273781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229273781">(Mar 08 2021 at 10:02)</a>:</h4>
<p>The summary so far:</p>
<ul>
<li>Error messages point to <a href="https://leanprover-community.github.io/mathlib_docs/find/mv_polynomial.total_degree_mul">docs#mv_polynomial.total_degree_mul</a></li>
<li>Checking just that file succeeds</li>
<li>Removing <a href="https://leanprover-community.github.io/mathlib_docs/find/add_monoid_algebra.to_multiplicative">docs#add_monoid_algebra.to_multiplicative</a> makes  the whole checker pass, even though nothing uses that definition and it seems to check fine in isolation.</li>
</ul>



<a name="229274104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229274104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229274104">(Mar 08 2021 at 10:05)</a>:</h4>
<p>Slightly smaller reproduction (only 4.8M of text):</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>lean -E export.txt --only-export=mv_polynomial.degrees_mul --rec src/
~/trepplein/target/universal/stage/bin/trepplein export.txt
</code></pre></div>



<a name="229274212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229274212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229274212">(Mar 08 2021 at 10:06)</a>:</h4>
<p>Does that export include the string <code>add_monoid_algebra.to_multiplicative</code> (or its components in an appropriate way)?</p>



<a name="229274481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229274481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229274481">(Mar 08 2021 at 10:08)</a>:</h4>
<p>No.  Interestingly, only trepplein fails on it but not leanchecker.</p>



<a name="229275638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229275638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229275638">(Mar 08 2021 at 10:18)</a>:</h4>
<p>From <span class="user-mention" data-user-id="228466">@Chris B</span>'s comment above, it looks vaguely like the lean typeclass inference is forgetting to emit <code>add_monoid.to_has_add</code>?</p>



<a name="229276564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229276564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229276564">(Mar 08 2021 at 10:26)</a>:</h4>
<p>Ok, I'm just bad at testing.  This fails with both leanchecker and trepplein and with either <code>degrees_mul</code> or <code>total_degree_mul</code>:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>lean -E export.txt --only-export<span class="o">=</span>mv_polynomial.degrees_mul --rec src/
</code></pre></div>
<p>This works:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>lean -E export_small.txt --only-export<span class="o">=</span>mv_polynomial.degrees_mul src/data/mv_polynomial/variables.lean
</code></pre></div>



<a name="229276573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229276573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229276573">(Mar 08 2021 at 10:26)</a>:</h4>
<p>This is the error that leanchecker doesn't print:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">line</span> <span class="mi">210987</span><span class="o">:</span> <span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">add_monoid_algebra.support_mul</span> <span class="n">R</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span> <span class="o">(</span><span class="n">comm_semiring.to_semiring</span> <span class="n">R</span> <span class="n">_inst_1</span><span class="o">)</span> <span class="o">(</span><span class="n">finsupp.add_monoid</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span><span class="o">)</span>
<span class="n">term</span>
  <span class="n">finsupp.add_monoid</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">add_monoid</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="o">(</span><span class="n">add_monoid.to_has_zero</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">has_add</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span>
</code></pre></div>



<a name="229277050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229277050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229277050">(Mar 08 2021 at 10:31)</a>:</h4>
<p>Here's proof that removing the unrelated definition seems to fix things: <a href="https://github.com/leanprover-community/mathlib/pull/6572/commits/2a2134f50eff7443dcec5789a97cc51cfcd0fc43">https://github.com/leanprover-community/mathlib/pull/6572/commits/2a2134f50eff7443dcec5789a97cc51cfcd0fc43</a> (the "run tests" CI is complete and passing, the parent commit is the one that started this thread)</p>



<a name="229277111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229277111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229277111">(Mar 08 2021 at 10:31)</a>:</h4>
<p>Is that definition somehow polluting a cache lean is keeping?</p>



<a name="229279437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229279437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229279437">(Mar 08 2021 at 10:51)</a>:</h4>
<p>This is weird:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">lean</span> <span class="bp">-</span><span class="n">t0</span> <span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">kernel</span> <span class="n">exception</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.comm_ring</span>
<span class="n">unknown</span> <span class="n">declaration</span> <span class="bp">'</span><span class="n">mv_polynomial.vars'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.degrees'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.degrees'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.comm_ring</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.comm_ring'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">algebra.category.CommRing.adjunctions</span>
<span class="n">unknown</span> <span class="n">declaration</span> <span class="bp">'</span><span class="n">mv_polynomial.hom_equiv'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">algebra.category.CommRing.adjunctions</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">CommRing.free._proof_1'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.degrees'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.comm_ring</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.comm_ring'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.degrees'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.comm_ring</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.comm_ring'</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">gebner</span><span class="bp">/</span><span class="n">mathlib_eric</span><span class="bp">-</span><span class="n">wieser</span><span class="bp">/</span><span class="n">monoid_algebra</span><span class="bp">-</span><span class="n">distrib</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">all.lean</span><span class="o">:</span><span class="mi">1379</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="kn">import</span><span class="o">:</span> <span class="n">data.mv_polynomial.variables</span>
<span class="n">invalid</span> <span class="n">object</span> <span class="n">declaration</span><span class="o">,</span> <span class="n">environment</span> <span class="n">already</span> <span class="n">has</span> <span class="n">an</span> <span class="n">object</span> <span class="n">named</span> <span class="bp">'</span><span class="n">mv_polynomial.degrees'</span>
</code></pre></div>



<a name="229280458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280458">(Mar 08 2021 at 10:59)</a>:</h4>
<p>Do you need to re-run <code>get-cache</code>?</p>



<a name="229280470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280470">(Mar 08 2021 at 10:59)</a>:</h4>
<p>And possibly <code>delete-zombies</code>?</p>



<a name="229280648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280648">(Mar 08 2021 at 11:00)</a>:</h4>
<p>The weird part is that <code>lean src/all.lean</code> works.</p>



<a name="229280670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280670">(Mar 08 2021 at 11:00)</a>:</h4>
<p>What is <code>-t0</code>?</p>



<a name="229280689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280689">(Mar 08 2021 at 11:00)</a>:</h4>
<p>"Trust level zero."</p>



<a name="229280732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280732">(Mar 08 2021 at 11:01)</a>:</h4>
<p>In this mode, Lean unfolds all macros and rechecks every definition on import.</p>



<a name="229280887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280887">(Mar 08 2021 at 11:02)</a>:</h4>
<p>Oh, I missed the first error message and was looking at the rest</p>



<a name="229280920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229280920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229280920">(Mar 08 2021 at 11:02)</a>:</h4>
<p>Can you get lean to print the kernel exception info in that message too? Although I assume its what we saw before.</p>



<a name="229282986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229282986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229282986">(Mar 08 2021 at 11:21)</a>:</h4>
<p>If I run <code>lean -E export.txt --only-export=mv_polynomial.degrees_mul --rec src/</code> on the good and bad commits, neither export.txt contains a reference to the changed lemma</p>



<a name="229282997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229282997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229282997">(Mar 08 2021 at 11:21)</a>:</h4>
<p>So there's definitely a stale cache somewhere</p>



<a name="229290313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229290313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229290313">(Mar 08 2021 at 12:27)</a>:</h4>
<p>For what it's worth, the issue was brought on by missing a typeclass assumption in the linked PR; but I think the leanchecker / lean bug is still real, it just isn't in my way after all.</p>



<a name="229291673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229291673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229291673">(Mar 08 2021 at 12:40)</a>:</h4>
<p>This is really weird.  Let's compare the expressions from the small export (where only the variables files is imported) and the full export:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">add_monoid_algebra.support_mul</span> <span class="n">R</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span> <span class="o">(</span><span class="n">comm_semiring.to_semiring</span> <span class="n">R</span> <span class="n">_inst_1</span><span class="o">)</span> <span class="o">(</span><span class="n">finsupp.has_add</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span><span class="o">)</span> <span class="n">p</span> <span class="n">q</span> <span class="n">b</span> <span class="n">hb</span><span class="o">)</span>
<span class="o">(</span><span class="n">add_monoid_algebra.support_mul</span> <span class="n">R</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span> <span class="o">(</span><span class="n">comm_semiring.to_semiring</span> <span class="n">R</span> <span class="n">_inst_1</span><span class="o">)</span> <span class="o">(</span><span class="n">finsupp.add_monoid</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span><span class="o">)</span> <span class="n">p</span> <span class="n">q</span> <span class="n">b</span> <span class="n">hb</span><span class="o">)</span>
</code></pre></div>
<p>In both cases, only the relevant declarations have been exported (the first 99% of the files are identical), so I don't think this is a bug in the exporter.</p>



<a name="229291824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229291824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229291824">(Mar 08 2021 at 12:41)</a>:</h4>
<p>There are lots of other weird differences, such as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">finsupp.has_add</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span>
<span class="n">add_semigroup.to_has_add</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span> <span class="o">(</span><span class="n">add_monoid.to_add_semigroup</span> <span class="o">(</span><span class="n">finsupp</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.has_zero</span><span class="o">)</span> <span class="o">(</span><span class="n">finsupp.add_monoid</span> <span class="n">σ</span> <span class="n">nat</span> <span class="n">nat.add_monoid</span><span class="o">))</span>
</code></pre></div>



<a name="229292622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229292622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229292622">(Mar 08 2021 at 12:49)</a>:</h4>
<p>To rule out the exporter, is the difference visible with <code>#print</code>?</p>



<a name="229293044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293044">(Mar 08 2021 at 12:53)</a>:</h4>
<p>Oh, I think I'm on to something.  Yes, the difference is visible when printing with to_raw_fmt.</p>



<a name="229293401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293401">(Mar 08 2021 at 12:56)</a>:</h4>
<p>Ok, the problem is solved.  This fixes the problem:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>rm src/data/mv_polynomial/variables.olean
lean --make src/data/mv_polynomial/variables.lean
</code></pre></div>
<p>It's just a hash collision in the lean files.  So the stale cache was the olean cache.</p>



<a name="229293436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293436">(Mar 08 2021 at 12:56)</a>:</h4>
<p>If I'm correct, you should be able to revert the fix in this PR and it the error won't come back.</p>



<a name="229293686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293686">(Mar 08 2021 at 12:59)</a>:</h4>
<p>And looking back, the reason why I couldn't reproduce it at first was because I didn't use the cache.</p>



<a name="229293693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293693">(Mar 08 2021 at 12:59)</a>:</h4>
<p>As it happens the fix is an improvement, so I don't actually want to revert it in that PR</p>



<a name="229293716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293716">(Mar 08 2021 at 12:59)</a>:</h4>
<p>But I can push a reversion commit to a different branch if you want me to check</p>



<a name="229293818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293818">(Mar 08 2021 at 13:00)</a>:</h4>
<p>How big are the colliding hashes?</p>



<a name="229293898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229293898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229293898">(Mar 08 2021 at 13:00)</a>:</h4>
<p>32 bit, of course.</p>



<a name="229295163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229295163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229295163">(Mar 08 2021 at 13:11)</a>:</h4>
<p>Ouch. How much work would it be to change the hash to something more reasonable (like perhaps SHA-1, since we trust that for git)</p>



<a name="229296956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229296956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229296956">(Mar 08 2021 at 13:24)</a>:</h4>
<p>Out of curiosity, which hashes exactly had a collision: a per-commit, per-file or per-declaration hash?</p>



<a name="229302360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229302360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229302360">(Mar 08 2021 at 14:00)</a>:</h4>
<p>This is the per-file hash that controls whether Lean needs to recompile a file.</p>



<a name="229303066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229303066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229303066">(Mar 08 2021 at 14:04)</a>:</h4>
<p>PRs that change the hash algorithm are acceptable.  Backwards compatibility is not an issue since we don't have any.  But I'm not sure if it's worth the effort.</p>



<a name="229306045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229306045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229306045">(Mar 08 2021 at 14:22)</a>:</h4>
<p>Does Lean 4 use a better hash?</p>



<a name="229306626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229306626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229306626">(Mar 08 2021 at 14:26)</a>:</h4>
<p>I guess changing the hash algorithm would mean retracing the footsteps of <a href="https://github.com/leanprover-community/lean/issues/140">leanprover-community/lean#140</a>, which looks straighforward if tedious.</p>



<a name="229310262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%236572%20crashes%20leanchecker/near/229310262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.236572.20crashes.20leanchecker.html#229310262">(Mar 08 2021 at 14:49)</a>:</h4>
<p>Lean 4 no longer compiles dependencies, that's one way to outsource the problem.  Now make is used for recompilation, and it uses the mtime (yeah, time to dust off the old <code>touch **/*.olean</code>).</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>