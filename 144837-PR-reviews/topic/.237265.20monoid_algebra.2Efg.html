---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html">#7265 monoid_algebra.fg</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="236678205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236678205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236678205">(Apr 29 2021 at 14:05)</a>:</h4>
<p>Can someone have a look at <a href="https://github.com/leanprover-community/mathlib/issues/7265">#7265</a>? It's from LTE, but it seems to me a reasonable statement to have in mathlib. Thanks!!</p>



<a name="236678418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236678418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236678418">(Apr 29 2021 at 14:06)</a>:</h4>
<p>I was just waiting for a cache to appear so I can try to golf it further. It looks like one is ready now!</p>



<a name="236678493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236678493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236678493">(Apr 29 2021 at 14:07)</a>:</h4>
<p>The statement looks good to me, I just can't help feeling there's an intermediate result that would split the proof in two, either one we already have somewhere else or one we should have</p>



<a name="236694696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236694696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236694696">(Apr 29 2021 at 15:27)</a>:</h4>
<p>Hm, the only mathematically reasonable statement I can extract is that the monoid algebra is a quotient of a polynomial ring in finitely many variables (this is essentially the proof of the result itself).</p>



<a name="236695012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236695012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236695012">(Apr 29 2021 at 15:29)</a>:</h4>
<p>OK, slightly better, it is a quotient of the polynomial ring whose variables are indexed by any spanning set of the monoid</p>



<a name="236695973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236695973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236695973">(Apr 29 2021 at 15:35)</a>:</h4>
<p>Do we have this statement?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">missing</span> <span class="o">{</span><span class="n">M</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">hS</span> <span class="o">:</span> <span class="n">add_submonoid.closure</span> <span class="n">S</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→+</span> <span class="o">(</span><span class="n">S</span> <span class="bp">→₀</span> <span class="n">ℕ</span><span class="o">)),</span> <span class="n">function.left_inverse</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">finsupp.total</span> <span class="n">S</span> <span class="n">M</span> <span class="n">ℕ</span> <span class="n">coe</span><span class="o">)</span> <span class="n">e</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="236695996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236695996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236695996">(Apr 29 2021 at 15:35)</a>:</h4>
<p>(and is it true?)</p>



<a name="236697836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236697836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236697836">(Apr 29 2021 at 15:47)</a>:</h4>
<p>The approach I was exploring was something like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">the_inverse</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→+</span> <span class="o">(</span><span class="n">S</span> <span class="bp">→₀</span> <span class="n">ℕ</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">add_monoid_algebra</span> <span class="n">R</span> <span class="n">M</span> <span class="bp">→ₐ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">mv_polynomial</span> <span class="n">S</span> <span class="n">R</span> <span class="o">:=</span>
<span class="n">add_monoid_algebra.lift</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="bp">$</span>
  <span class="o">⟨</span><span class="bp">λ</span> <span class="n">m</span><span class="o">,</span> <span class="n">mv_polynomial.monomial</span> <span class="o">(</span><span class="n">e</span> <span class="n">m.to_add</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span>
  <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">refl</span> <span class="o">},</span>
  <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">⟩</span>

<span class="kd">lemma</span> <span class="n">aeval_of_right_inverse</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">hS</span> <span class="o">:</span> <span class="n">add_submonoid.closure</span> <span class="n">S</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→+</span> <span class="o">(</span><span class="n">S</span> <span class="bp">→₀</span> <span class="n">ℕ</span><span class="o">))</span> <span class="o">(</span><span class="n">he</span> <span class="o">:</span> <span class="n">function.left_inverse</span> <span class="n">e</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">finsupp.total</span> <span class="n">S</span> <span class="n">M</span> <span class="n">ℕ</span> <span class="n">coe</span><span class="o">)):</span>
  <span class="n">function.right_inverse</span>
    <span class="o">(</span><span class="n">the_inverse</span> <span class="n">R</span> <span class="n">S</span> <span class="n">e</span><span class="o">)</span>
    <span class="bp">⇑</span><span class="o">(</span><span class="n">mv_polynomial.aeval</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">S</span><span class="o">),</span> <span class="o">(</span><span class="n">of</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">multiplicative.of_add</span> <span class="bp">↑</span><span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">_</span> <span class="bp">→ₐ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">function.right_inverse_iff_comp</span><span class="o">,</span> <span class="bp">←</span><span class="n">alg_hom.coe_comp</span><span class="o">,</span> <span class="bp">←</span><span class="n">alg_hom.coe_id</span> <span class="n">R</span><span class="o">],</span>
  <span class="n">congr'</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">ext</span> <span class="o">:</span> <span class="mi">2</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mv_polynomial.aeval_monomial</span><span class="o">,</span> <span class="n">ring_hom.map_one</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">],</span>
  <span class="gr">sorry</span> <span class="c1">-- this looks true, but is probably easier in the multiplicative case</span>
<span class="kd">end</span>
</code></pre></div>



<a name="236697953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236697953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236697953">(Apr 29 2021 at 15:48)</a>:</h4>
<p>It seems something like <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.mem_span_iff_total">docs#finsupp.mem_span_iff_total</a></p>



<a name="236698364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236698364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236698364">(Apr 29 2021 at 15:51)</a>:</h4>
<p>But in general I have the impression that to deal with <code>span</code> and similar stuff is much easier to avoid to name the explicit linear combination. Using some <code>induction</code> is almost always easier</p>



<a name="236698420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236698420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236698420">(Apr 29 2021 at 15:51)</a>:</h4>
<p>But probably less constructive or computable or something else I don't understand (let me just say less explicit).</p>



<a name="236700838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236700838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236700838">(Apr 29 2021 at 16:06)</a>:</h4>
<p>The advantage of obtaining the explicit linear combination is that you can then use <a href="https://leanprover-community.github.io/mathlib_docs/find/add_monoid_algebra.lift">docs#add_monoid_algebra.lift</a> which has all the inductions steps already proved for you</p>



<a name="236700975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236700975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236700975">(Apr 29 2021 at 16:07)</a>:</h4>
<p>But perhaps the glue is too much work at the moment</p>



<a name="236701396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236701396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236701396">(Apr 29 2021 at 16:10)</a>:</h4>
<p>Hmm... I want a map to the monoid algebra, not from it</p>



<a name="236702247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702247">(Apr 29 2021 at 16:16)</a>:</h4>
<p>You already know that map, it's <code>⇑(mv_polynomial.aeval $ λ (s : S), (of R M) (multiplicative.of_add ↑s) : _ →ₐ[R] _)</code></p>



<a name="236702300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702300">(Apr 29 2021 at 16:16)</a>:</h4>
<p>Your current proof obscures it a little by throwing in a ulift at the same time</p>



<a name="236702427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702427">(Apr 29 2021 at 16:17)</a>:</h4>
<p>I would be very happy to throw away the <code>ulift</code>, it is an artifact of <code>finite_type.iff_quotient_mv_polynomial'</code>. If you see how to avoid it I take any suggestion.</p>



<a name="236702583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702583">(Apr 29 2021 at 16:18)</a>:</h4>
<p>But my map is only surjective, we can not build an inverse, the monoid algebra has much more relations then the polynomial ring</p>



<a name="236702621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702621">(Apr 29 2021 at 16:18)</a>:</h4>
<p>You can build a right inverse</p>



<a name="236702742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702742">(Apr 29 2021 at 16:19)</a>:</h4>
<p>Regarding the ulift</p>



<a name="236702783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236702783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236702783">(Apr 29 2021 at 16:19)</a>:</h4>
<p>I think <code>finite_type.iff_quotient_mv_polynomial'</code> is stated poorly</p>



<a name="236703038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236703038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236703038">(Apr 29 2021 at 16:20)</a>:</h4>
<p>You should be able to add a third universe argument to make the problem go away</p>



<a name="236703081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236703081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236703081">(Apr 29 2021 at 16:20)</a>:</h4>
<p>Probably by merging it with the proof in <code>iff_quotient_mv_polynomial''</code></p>



<a name="236705025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236705025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236705025">(Apr 29 2021 at 16:33)</a>:</h4>
<p>I have to go back home, but I really don't know how to work with universes... indeed I wrote <code>iff_quotient_mv_polynomial'</code> and I remember being confused by this universes stuff</p>



<a name="236705961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236705961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236705961">(Apr 29 2021 at 16:39)</a>:</h4>
<p>I'll try to make a PR</p>



<a name="236706039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236706039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236706039">(Apr 29 2021 at 16:40)</a>:</h4>
<p>I guess if <a href="https://github.com/leanprover-community/mathlib/issues/7265">#7265</a> is blocking you, there's no reason to wait for the ulift cleanup first</p>



<a name="236706930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236706930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236706930">(Apr 29 2021 at 16:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg/near/236697836">said</a>:</p>
<blockquote>
<p>The approach I was exploring was something like:</p>
</blockquote>
<p>I updated that message to be sorry-free, but it's missing the <code>missing</code> lemma needed to glue it with <code>finite_type</code>, and needs the <code>rfl</code> lemmas from <a href="https://github.com/leanprover-community/mathlib/issues/7412">#7412</a>.</p>



<a name="236718613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236718613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236718613">(Apr 29 2021 at 18:02)</a>:</h4>
<p>Hm... I am almost sure there no right inverse that it also is an<code>alg_hom</code>. Let me see what happens</p>



<a name="236718793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236718793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236718793">(Apr 29 2021 at 18:03)</a>:</h4>
<p>Ah, I see! The missing lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">missing</span> <span class="o">{</span><span class="n">M</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">hS</span> <span class="o">:</span> <span class="n">add_submonoid.closure</span> <span class="n">S</span> <span class="bp">=</span> <span class="bp">⊤</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→+</span> <span class="o">(</span><span class="n">S</span> <span class="bp">→₀</span> <span class="n">ℕ</span><span class="o">)),</span> <span class="n">function.left_inverse</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">finsupp.total</span> <span class="n">S</span> <span class="n">M</span> <span class="n">ℕ</span> <span class="n">coe</span><span class="o">)</span> <span class="n">e</span>
</code></pre></div>
<p>is  false. We can construct <code>e</code>, but it would not be additive</p>



<a name="236719210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236719210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236719210">(Apr 29 2021 at 18:06)</a>:</h4>
<p><code>e</code> simply builds some coefficients that work to write any <code>m : M</code> as  a linear combination of elements in <code>S</code>, but in general this choice will not agree with addition. And there is now way to solve this if <code>S</code> is not a base (well... something like a base in the monoid world).</p>



<a name="236720375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236720375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236720375">(Apr 29 2021 at 18:14)</a>:</h4>
<p>I had a feeling it might not be additive, but I can't think of an obvious counter-example</p>



<a name="236721725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236721725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236721725">(Apr 29 2021 at 18:23)</a>:</h4>
<p>Just take <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi mathvariant="double-struck">F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M = \mathbb{F}_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> as an additive monoid, and take <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">S=M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>. The "coordinates " of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> are any two numbers <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> even, and the  "coordinates " of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> are two numbers <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(c,d)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span></span></span></span> odd. Now, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 = 1 + 1 = 1 +1 + 1 + 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, so <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>2</mn><mi>d</mi></mrow><annotation encoding="application/x-tex">b =2d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal">d</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>4</mn><mi>d</mi></mrow><annotation encoding="application/x-tex">b =4d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathnormal">d</span></span></span></span>, so  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> that is absurd.</p>



<a name="236722184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236722184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236722184">(Apr 29 2021 at 18:26)</a>:</h4>
<p>The point is that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> generates <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> means that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> is a quotient of the free monoid on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> (this is just a fancy way of rephrasing the definition). An additive <code>e</code> would be a splitting of the quotient map, so <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> would be a direct summand of a free thing, and in particular without torsion.</p>



<a name="236722504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236722504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236722504">(Apr 29 2021 at 18:29)</a>:</h4>
<p>I don't know what is better in Lean, but mathematically I am really against proving the surjectivity providing a right inverse. Indeed the right inverse morally does not exist (in the category we are working in).</p>



<a name="236723078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236723078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236723078">(Apr 29 2021 at 18:33)</a>:</h4>
<p>Thanks for the insight!</p>



<a name="236723700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%237265%20monoid_algebra.fg/near/236723700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.237265.20monoid_algebra.2Efg.html#236723700">(Apr 29 2021 at 18:37)</a>:</h4>
<p>I guess I have some Lean-debts to honor <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>