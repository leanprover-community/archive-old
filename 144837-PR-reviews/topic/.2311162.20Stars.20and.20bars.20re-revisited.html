---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html">#11162 Stars and bars re-revisited</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="288812410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288812410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288812410">(Jul 07 2022 at 14:20)</a>:</h4>
<p>I have a new draft of some of the proofs in <span class="user-mention" data-user-id="511228">@Huỳnh Trần Khanh</span>'s <a href="https://github.com/leanprover-community/mathlib/pull/11162">#11162</a> "Stars and bars".  I've taken a somewhat different approach (roughly <span class="user-mention" data-user-id="306601">@Kyle Miller</span>'s suggestion in <a href="#narrow/stream/113488-general/topic/Stars.20and.20bars.20revisited/near/277167127">this thread</a>), which simplifies the proof.</p>
<p>In <a href="https://github.com/leanprover-community/mathlib/pull/15072">#15072</a> I introduced a recursive definition of <code>multichoose</code> (which is intended as the multisets analogue of <code>choose</code>) and proved that <code>multichoose n k = (n + k - 1).choose k</code>.  Now in <a href="https://github.com/leanprover-community/mathlib/pull/11162">#11162</a> I've proved that <code>card (sym (fin n) k) = multichoose n k</code>, which then allows a simple proof that <code>card (sym α k) = multichoose (card α) k</code> for any fintype <code>α</code> — i.e. that <code>multichoose</code> counts the number of multisets of size <code>k</code> over the finite alphabet <code>α</code>, as intended.  This all goes through much more simply than the original proof that used induction on fintypes via <code>option</code>.  (I've left the original code in for now, for comparison.)</p>



<a name="288812447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288812447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288812447">(Jul 07 2022 at 14:20)</a>:</h4>
<p>This is all still a draft at the moment, so I'm looking for comments and suggestions.  In particular, which of the statements proved here (if any) should be regarded as the formalisation of "stars and bars"?  Presumably, per mathlib's naming convention, none of these lemmas should be <em>called</em> <code>stars_and_bars</code>, but which should have that in its docstring? Is it <code>card (sym α k) = multichoose (card α) k</code>?  Or <code>multichoose n k = (n + k - 1).choose k</code>?  Or yet another statement?  Or, as <span class="user-mention" data-user-id="310045">@Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/Stars.20and.20bars.20revisited/near/277116416">suggests</a>, should we think of "stars and bars" as "a tool for solving combinatorics problems, not a specific problem"?</p>



<a name="288812788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288812788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288812788">(Jul 07 2022 at 14:22)</a>:</h4>
<p>Note that I haven't updated the docstring at the top of <code>data/sym/card</code> since re-writing the proofs, which I'll do once I get some feedback on the above questions.</p>



<a name="288812836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288812836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288812836">(Jul 07 2022 at 14:23)</a>:</h4>
<p>cc/ <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>  and <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span></p>



<a name="288814848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288814848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288814848">(Jul 07 2022 at 14:38)</a>:</h4>
<p>If stars-and-bars is the formula for the cardinality for <code>sym α k</code> (which can be regarded as ways to put <code>k</code> objects into bins indexed by <code>α</code>) then I think this counts. Even if it's not stars-and-bars per se, it's the domain orbits cell of the twelvefold way. (Thanks for your work!)</p>
<p>Maybe what would really count as stars-and-bars is an equivalence between <code>sym (fin n) k</code> and the cardinality-k subsets of <code>fin (n + k - 1)</code> using the stars-and-bars encoding, but I don't think we're obligated to prove anything with this.</p>



<a name="288815177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288815177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288815177">(Jul 07 2022 at 14:40)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> Is <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.powerset_len">docs#finset.powerset_len</a> on <code>finset.univ</code> the best way to get all the cardinality-k subsets of a finite type?</p>



<a name="288815528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288815528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288815528">(Jul 07 2022 at 14:43)</a>:</h4>
<p>Currently, yes. But, because <code>finset α</code> is graded, the <code>k</code>-slice of <code>finset α</code> is exactly what you're looking for.</p>



<a name="288815697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288815697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288815697">(Jul 07 2022 at 14:44)</a>:</h4>
<p>I have this material on a branch. I am in the process of making it PRable (<a href="https://github.com/leanprover-community/mathlib/pull/14977">#14977</a> was part of it).</p>



<a name="288816886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288816886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288816886">(Jul 07 2022 at 14:52)</a>:</h4>
<p>What reference are we using for the meaning of stars and bars here?</p>



<a name="288817061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288817061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288817061">(Jul 07 2022 at 14:54)</a>:</h4>
<p>Wikipedia says:</p>
<blockquote>
<p>In the context of combinatorial mathematics, stars and bars (also called "sticks and stones",[1] "balls and bars",[2] and "dots and dividers"[3]) is <strong>a graphical aid for deriving</strong> certain combinatorial theorems</p>
</blockquote>
<p>Which suggests if anything the name belongs to a tactic</p>



<a name="288817824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288817824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288817824">(Jul 07 2022 at 14:58)</a>:</h4>
<p>(or to a very direct representation of stars and bars, such as the one in my PR, or a subtype of <code>list bool</code>)</p>



<a name="288830820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288830820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288830820">(Jul 07 2022 at 16:29)</a>:</h4>
<p>The way I learned it, stars and bars is a graphical technique, that serves as the mnemonic for the bijection which proves the theorem at hand.</p>



<a name="288830839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288830839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288830839">(Jul 07 2022 at 16:29)</a>:</h4>
<p>I don't have any reference on this unfortunately</p>



<a name="288831029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288831029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288831029">(Jul 07 2022 at 16:31)</a>:</h4>
<p>I find that graphical aid is mostly a mnemonic for the idea that to count the number of ways of putting n indistinguishable objects in k bins, you choose the locations of the k-1 bin dividers. (Violeta beat me to "mnemonic")</p>



<a name="288831075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288831075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288831075">(Jul 07 2022 at 16:31)</a>:</h4>
<p>Usually there aren't actually stars and bars in whatever you're counting</p>



<a name="288832470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288832470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288832470">(Jul 07 2022 at 16:42)</a>:</h4>
<p>(The textbook I chose for my combinatorics class made some odd choices in presentation. For this, they used a generating function and the generalized binomial theorem! They seemed to always prefer algebraic proofs over combinatorial ones... At least it complemented the lectures.)</p>



<a name="288855900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288855900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288855900">(Jul 07 2022 at 19:40)</a>:</h4>
<p>Thanks for your answers everyone.  I think I'd agree that "stars and bars" is a technique rather than a statement, and that it would be nice to have a tactic implementing this technique.  I'll edit the tags and comments in <code>data/nat/choose/basic</code> and <code>data/sym/card</code> accordingly.</p>



<a name="288857400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288857400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288857400">(Jul 07 2022 at 19:54)</a>:</h4>
<p>Anyone have a proposal for what a stars-and-bars tactic would do?</p>



<a name="288869540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288869540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288869540">(Jul 07 2022 at 21:40)</a>:</h4>
<p>a) I have zero idea what a stars and bars tactic would do.<br>
b) I actually don't mind the statement in hand being called stars and bars. That's really the only important result you get out of this bijection, isn't it?</p>



<a name="288888232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288888232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288888232">(Jul 08 2022 at 02:03)</a>:</h4>
<p>A nice result to have would be the <a href="https://leanprover-community.github.io/mathlib_docs/find/finite_dimensional.finrank">docs#finite_dimensional.finrank</a> of <a href="https://leanprover-community.github.io/mathlib_docs/find/mv_polynomial.homogeneous_submodule">docs#mv_polynomial.homogeneous_submodule</a> ... Anyone planning to define Hilbert polynomial?</p>



<a name="288901042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288901042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288901042">(Jul 08 2022 at 05:52)</a>:</h4>
<p>It is on the list of "I might need to do it if it is not yet done by the time I need it". But I think it would depend on <a href="https://github.com/leanprover-community/mathlib/pull/14582">#14582</a>.</p>



<a name="288915318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288915318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288915318">(Jul 08 2022 at 09:05)</a>:</h4>
<p>Ok, I've updated the docstrings in <code>data/sym/card</code> and <code>data/nat/choose/basic</code> in <a href="https://github.com/leanprover-community/mathlib/pull/11162">#11162</a> to explain the "stars and bars" technique.</p>



<a name="288917490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288917490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288917490">(Jul 08 2022 at 09:28)</a>:</h4>
<p>I suppose one of the problems with having a stars and bars tactic is that there are many different problems that can be informally interpreted as "putting <code>k</code> indistinguishable items into <code>n</code> distinguishable boxes", but it may be far from straightforward to translate that informal interpretation into something that Lean could recognise as such and act upon. So potentially more work would go into formalising that interpretation than would be saved by having a tactic.</p>



<a name="288917668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288917668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288917668">(Jul 08 2022 at 09:30)</a>:</h4>
<p>In fact, in many cases it may be easier to just directly prove that the quantity of interest is counted by <code>multichoose</code>.</p>



<a name="288969910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/288969910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#288969910">(Jul 08 2022 at 17:28)</a>:</h4>
<p><span class="user-mention" data-user-id="422543">@Stuart Presnell</span> It seems good to have, so I extracted the equivalence that got cut out into <a href="https://github.com/leanprover-community/mathlib/pull/15192">#15192</a> -- please let me know if we don't need this PR</p>



<a name="289044005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311162%20Stars%20and%20bars%20re-revisited/near/289044005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311162.20Stars.20and.20bars.20re-revisited.html#289044005">(Jul 09 2022 at 14:16)</a>:</h4>
<p>I'm happy for that code to go in separately.  The material that I cut from <a href="https://github.com/leanprover-community/mathlib/pull/11162">#11162</a> was by <span class="user-mention" data-user-id="511228">@Huỳnh Trần Khanh</span>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>