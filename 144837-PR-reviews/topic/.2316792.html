---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2316792.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html">#16792</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="302581057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302581057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302581057">(Oct 06 2022 at 04:21)</a>:</h4>
<p>I'd like to start cleaning up <code>algebra.order.*</code>, making files more modular. I've got a first PR <a href="https://github.com/leanprover-community/mathlib/pull/16792">#16792</a> that is crawling its way through CI. If someone could take a quick look and delegate if appropriate, I'd like to get this off the queue asap to avoid rotting.</p>



<a name="302590827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302590827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302590827">(Oct 06 2022 at 06:40)</a>:</h4>
<p>Oh no please!</p>



<a name="302590886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302590886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302590886">(Oct 06 2022 at 06:41)</a>:</h4>
<p>I have been keeping <a href="https://github.com/leanprover-community/mathlib/pull/16172">#16172</a> afloat for a month and a half now and this will just kill it.</p>



<a name="302590916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302590916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302590916">(Oct 06 2022 at 06:41)</a>:</h4>
<p>It's ready to be merged, but I keep hitting random timeouts.</p>



<a name="302593246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302593246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302593246">(Oct 06 2022 at 07:03)</a>:</h4>
<p>Also I don't like how you separate instances from the typeclass definitions. The problem with this approach is that you end up with structure files that have inflated imports because people will dump in here later theory in the name of it being about the structure. I have been actively working against that.</p>



<a name="302593313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302593313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302593313">(Oct 06 2022 at 07:03)</a>:</h4>
<p>And please shorten <code>.canonically_ordered</code> to <code>.canonical</code>. File names are long enough like that and we already have <code>order</code> earlier <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="302610845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302610845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302610845">(Oct 06 2022 at 09:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/144837-PR-reviews/topic/.2316792/near/302593246">said</a>:</p>
<blockquote>
<p>Also I don't like how you separate instances from the typeclass definitions. The problem with this approach is that you end up with structure files that have inflated imports because people will dump in here later theory in the name of it being about the structure. I have been actively working against that.</p>
</blockquote>
<p>I don't understand this. Isn't the solution just to tell people not to do this?</p>



<a name="302610934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302610934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302610934">(Oct 06 2022 at 09:11)</a>:</h4>
<p>We really have far too much being imported to get to the definition <code>ordered_ring</code>. This is really annoying for porting.</p>



<a name="302611321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302611321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302611321">(Oct 06 2022 at 09:14)</a>:</h4>
<p>If you think <a href="https://github.com/leanprover-community/mathlib/pull/16172">#16172</a> will be in soon, I can wait and rejigger around it.</p>



<a name="302611371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302611371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302611371">(Oct 06 2022 at 09:14)</a>:</h4>
<p>But I'm hoping days not months. :-)</p>



<a name="302612629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302612629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302612629">(Oct 06 2022 at 09:23)</a>:</h4>
<p>What is "far too much" to you? I have a pretty good picture of the import tensions around the algebraic order hierarchy and I am working on releasing some of them but maybe you think of others.</p>



<a name="302612933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302612933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302612933">(Oct 06 2022 at 09:25)</a>:</h4>
<p>In particular I have a PR that's almost ready to define <code>nnrat.cast</code> and this forces me to fix the imports.</p>



<a name="302613256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302613256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302613256">(Oct 06 2022 at 09:27)</a>:</h4>
<p>I suspect you went on a crusade against the finest parts of the algebraic order hierarchy while in fact your life might have been severely affected by files like <a href="https://tqft.net/mathlib/data/set/intervals/unordered">file#data/set/intervals/unordered</a> that needlessly inject a bunch of algebraic files into pure order theory.</p>



<a name="302613768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302613768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302613768">(Oct 06 2022 at 09:30)</a>:</h4>
<p>My point is that I am actively working on this. And this time by "working" I do not mean "I have it in my todo list and will work on it every few weeks" but "I am pushing several commits a day".</p>



<a name="302625250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302625250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302625250">(Oct 06 2022 at 10:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/144837-PR-reviews/topic/.2316792/near/302581057">said</a>:</p>
<blockquote>
<p>I'd like to start cleaning up <code>algebra.order.*</code>, making files more modular. I've got a first PR <a href="https://github.com/leanprover-community/mathlib/pull/16792">#16792</a> that is crawling its way through CI. If someone could take a quick look and delegate if appropriate, I'd like to get this off the queue asap to avoid rotting.</p>
</blockquote>
<p>I think the PR looks good overall so I'll let you and Yaël come to a consensus on what to adapt.</p>



<a name="302626489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302626489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302626489">(Oct 06 2022 at 10:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/144837-PR-reviews/topic/.2316792/near/302593246">said</a>:</p>
<blockquote>
<p>Also I don't like how you separate instances from the typeclass definitions. The problem with this approach is that you end up with structure files that have inflated imports because people will dump in here later theory in the name of it being about the structure. I have been actively working against that.</p>
</blockquote>
<p>I disagree with this. I think in the files I've been working with has doing pretty well separating out instances from their structures in various files: <a href="https://leanprover-community.github.io/mathlib_docs/find/rat.comm_ring">docs#rat.comm_ring</a> vs <a href="https://leanprover-community.github.io/mathlib_docs/find/rat.field">docs#rat.field</a> vs <a href="https://leanprover-community.github.io/mathlib_docs/find/rat.linear_ordered_field">docs#rat.linear_ordered_field</a>. And certainly we should err more on the side of splitting files more rather than joining them together.</p>



<a name="302677077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302677077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302677077">(Oct 06 2022 at 15:19)</a>:</h4>
<p>I am talking about derived instances, not instances on concrete structures. My typîcal example is <a href="https://tqft.net/mathlib/algebra/ring/prod">file#algebra/ring/prod</a>, which contains way more than just the instances, because it grew out of being "the first file where the product of two rings is a ring".</p>



<a name="302677224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302677224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302677224">(Oct 06 2022 at 15:20)</a>:</h4>
<p>Put another way, I'm not complaining that we're splitting the files too much, I'm complaining that we're splitting them wrongly.</p>



<a name="302678268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302678268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302678268">(Oct 06 2022 at 15:24)</a>:</h4>
<p>So what I would much prefer over this PR is we were splitting those files first, then see whether we actually need any more splitting.</p>



<a name="302753263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753263">(Oct 06 2022 at 22:39)</a>:</h4>
<p>Shall we merge <a href="https://github.com/leanprover-community/mathlib/pull/16172">#16172</a>? Has Mario's comment from yesterday been addressed? If so I'd like to get this on the queue so I can have another go.</p>



<a name="302753296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753296">(Oct 06 2022 at 22:39)</a>:</h4>
<p>Oh wait it compiles? <span aria-label="scream" class="emoji emoji-1f631" role="img" title="scream">:scream:</span></p>



<a name="302753395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753395">(Oct 06 2022 at 22:40)</a>:</h4>
<p>It wasn't compiling for the past entire week despite repeated attempts <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="302753455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753455">(Oct 06 2022 at 22:40)</a>:</h4>
<p>Fingers crossed.</p>



<a name="302753544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753544">(Oct 06 2022 at 22:41)</a>:</h4>
<p>What about Mario's comment? Was that addressed?</p>



<a name="302753689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302753689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302753689">(Oct 06 2022 at 22:42)</a>:</h4>
<p>Yes, it was addressed even before Mario's comment. See <a href="#narrow/stream/144837-PR-reviews/topic/.2316172.20and.20.2316189.2C.20ordered.20PRs/near/294916802">here</a>. Mario must have missed the relevant piece of code.</p>



<a name="302760086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302760086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302760086">(Oct 06 2022 at 23:49)</a>:</h4>
<p>to be fair, the PR is not very easy to review right now, there are hundreds of commits and the diffs are huge and mostly useless</p>



<a name="302760129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2316792/near/302760129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2316792.html#302760129">(Oct 06 2022 at 23:49)</a>:</h4>
<p>can this not be broken up into smaller pieces?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>