---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html">#11255 Classification of Hilbert spaces</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="268204454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311255%20Classification%20of%20Hilbert%20spaces/near/268204454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html#268204454">(Jan 16 2022 at 20:14)</a>:</h4>
<p>This PR is ready for review, but fails to pass CI because of a <a href="#narrow/stream/113488-general/topic/Strange.20timeout">weird timeout</a> ... help would be much appreciated!</p>



<a name="268207084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311255%20Classification%20of%20Hilbert%20spaces/near/268207084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html#268207084">(Jan 16 2022 at 21:11)</a>:</h4>
<p>I had a go at it, and I have the impression that the following proof is better accepted:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">lemma</span> <span class="n">has_sum_repr_symm</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">hilbert_basis</span> <span class="n">Î¹</span> <span class="bp">ğ•œ</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">â„“</span><span class="bp">Â²</span><span class="o">(</span><span class="n">Î¹</span><span class="o">,</span> <span class="bp">ğ•œ</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">has_sum</span> <span class="o">(</span><span class="bp">Î»</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">â€¢</span> <span class="n">b</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b.repr.symm</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">suffices</span> <span class="n">H</span> <span class="o">:</span> <span class="o">(</span><span class="bp">Î»</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Î¹</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">â€¢</span> <span class="n">b</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span>
    <span class="o">(</span><span class="bp">Î»</span> <span class="o">(</span><span class="n">b_1</span> <span class="o">:</span> <span class="n">Î¹</span><span class="o">),</span> <span class="o">(</span><span class="n">b.repr.symm.to_continuous_linear_equiv</span><span class="o">)</span> <span class="o">((</span><span class="bp">Î»</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Î¹</span><span class="o">),</span> <span class="n">lp.single</span> <span class="mi">2</span> <span class="n">i</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="n">b_1</span><span class="o">)),</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">H</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">has_sum</span> <span class="o">(</span><span class="bp">Î»</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Î¹</span><span class="o">),</span> <span class="n">lp.single</span> <span class="mi">2</span> <span class="n">i</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">lp.has_sum_single</span> <span class="n">ennreal.two_ne_top</span> <span class="n">f</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="bp">â†‘</span><span class="o">(</span><span class="n">b.repr.symm.to_continuous_linear_equiv</span><span class="o">)</span> <span class="o">:</span> <span class="n">â„“</span><span class="bp">Â²</span><span class="o">(</span><span class="n">Î¹</span><span class="o">,</span> <span class="bp">ğ•œ</span><span class="o">)</span> <span class="bp">â†’</span><span class="n">L</span><span class="o">[</span><span class="bp">ğ•œ</span><span class="o">]</span> <span class="n">E</span><span class="o">)</span><span class="bp">.</span><span class="n">has_sum</span> <span class="n">this</span> <span class="o">},</span>
  <span class="n">ext</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">b.repr.injective</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">lp.single</span> <span class="mi">2</span> <span class="n">i</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span> <span class="bp">*</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">lp.single_smul</span> <span class="mi">2</span> <span class="n">i</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="bp">ğ•œ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">mul_one</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">linear_isometry_equiv.map_smul</span><span class="o">,</span> <span class="n">b.repr_self</span><span class="o">,</span> <span class="bp">â†</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">linear_isometry_equiv.coe_to_continuous_linear_equiv</span><span class="o">],</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">b.repr.apply_symm_apply</span> <span class="o">(</span><span class="n">lp.single</span> <span class="mi">2</span> <span class="n">i</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>(Hard to tell for sure, because the problem seems to be at the kernel level: the profiler says that the original proof and this one are completed within less than 2s, but then the apparent processing time is much longer, so my guess is that the issue is with the kernel being stuck to check some heavy rfl. My modification of the proof above removes one coercion, and so is hopefully slightly lighter).</p>



<a name="268207595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311255%20Classification%20of%20Hilbert%20spaces/near/268207595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html#268207595">(Jan 16 2022 at 21:23)</a>:</h4>
<p>Thank you!  It works for me locally, I will push it and see if it passes CI.</p>



<a name="268207892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311255%20Classification%20of%20Hilbert%20spaces/near/268207892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311255.20Classification.20of.20Hilbert.20spaces.html#268207892">(Jan 16 2022 at 21:28)</a>:</h4>
<p>And indeed, it does!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>