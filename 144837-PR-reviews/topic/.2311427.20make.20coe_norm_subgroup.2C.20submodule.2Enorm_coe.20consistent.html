---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html">#11427 make coe_norm_subgroup, submodule.norm_coe consistent</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="269093678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269093678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269093678">(Jan 24 2022 at 11:47)</a>:</h4>
<p>Any objections to merging this?</p>
<p>Note that there was already a poll <a href="#narrow/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe">here</a></p>



<a name="269093779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269093779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269093779">(Jan 24 2022 at 11:48)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> any thoughts?</p>



<a name="269097502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269097502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269097502">(Jan 24 2022 at 12:25)</a>:</h4>
<p>The only reason why I'm against it is because it is inconsistent with how we do coercion lemmas everywhere else.  If there's a good reason why it should be changed <em>only</em> for norms in submodules, then that's fine.</p>



<a name="269101937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269101937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269101937">(Jan 24 2022 at 13:05)</a>:</h4>
<p>Interesting! Until you wrote this, I thought that we had no such global consistency (and maybe even that it was not possible). Could you give an example of one of the lemmas that go the other way?</p>



<a name="269102161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269102161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269102161">(Jan 24 2022 at 13:07)</a>:</h4>
<p>Gabriel, I think it's more about subtype coercion vs intermediate canonical coercion.</p>



<a name="269102300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269102300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269102300">(Jan 24 2022 at 13:08)</a>:</h4>
<p>Here are a few examples: <a href="https://leanprover-community.github.io/mathlib_docs/find/nreal.coe_nat_cast">docs#nreal.coe_nat_cast</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/subring.coe_nat_cast">docs#subring.coe_nat_cast</a></p>



<a name="269103515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269103515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269103515">(Jan 24 2022 at 13:18)</a>:</h4>
<blockquote>
<p>I thought that we had no such global consistency (and maybe even that it was not possible). Could you give an example of one of the lemmas that go the other way?</p>
</blockquote>
<p>The typical pattern is that norm_cast requires lemmas to be written like <code>f (↑ x) = g x</code> and then we just tag the same lemma as simp.  The example that immediately comes to mind is all kinds of <a href="https://leanprover-community.github.io/mathlib_docs/find/coe_le_coe">docs#coe_le_coe</a>.  Let me see if I can find something that is not a relation.</p>



<a name="269103739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269103739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269103739">(Jan 24 2022 at 13:20)</a>:</h4>
<p>We don't have that many operations that accept different argument types, but always return the same value (so that <code>f (↑ x) = f x</code> type checks).  Norms are one example but I couldn't find many coercion lemmas for them.  Cardinalities are another, and indeed: <a href="https://leanprover-community.github.io/mathlib_docs/find/fintype.card_coe">docs#fintype.card_coe</a> is <code>card (↑ s) = s.card</code> (and marked as simp).</p>



<a name="269104203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269104203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269104203">(Jan 24 2022 at 13:24)</a>:</h4>
<p>This is misleading. The LHS is <a href="https://leanprover-community.github.io/mathlib_docs/find/fintype.card">docs#fintype.card</a> and the RHS is <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.card">docs#finset.card</a>.</p>



<a name="269105093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269105093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269105093">(Jan 24 2022 at 13:32)</a>:</h4>
<p>I don't see how that is misleading (or unrelated).  We don't always simplify fintype.card to finset.card; the reason this lemma is marked simp is because it removes the coercion.  The change in this PR is pretty much exactly the same situation, except with norm instead of card.</p>



<a name="269105232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269105232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269105232">(Jan 24 2022 at 13:33)</a>:</h4>
<p>They are simply not the same function, although one is defined in term of the other.</p>



<a name="269105467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269105467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269105467">(Jan 24 2022 at 13:35)</a>:</h4>
<p>Neither are the two norms?  (Or is it purely because we don't have a has_card class?)</p>



<a name="269105472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269105472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269105472">(Jan 24 2022 at 13:35)</a>:</h4>
<p>And the only reason we don't always simplify <code>fintype.card</code> to <code>finset.univ.card</code> is I think purely cosmetic/practical. It's harder to type <code>(finset.univ : finset α).card</code> than <code>fintype.card α</code>.</p>



<a name="269108937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269108937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269108937">(Jan 24 2022 at 13:58)</a>:</h4>
<p>I actually think the cardinality example is very helpful and it has made me change my vote <a href="#narrow/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe">here</a>!</p>



<a name="269109539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269109539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269109539">(Jan 24 2022 at 14:02)</a>:</h4>
<p>My previous thinking was that the norm on the ambient space induces the norm on the subspace so <code>simp</code> should go in the direction that says this but I now think it's better to have <code>simp</code> remove, rather than insert, coercions. I can imagine having some expression involving norms of elements that happen to belong to a subgroup but where this is incidental to the mathematics; I wouldn't want <code>simp</code> to insert a bunch of coercions.</p>



<a name="269120615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269120615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269120615">(Jan 24 2022 at 15:20)</a>:</h4>
<p>ooh it's a bit like 12 angry men except without the anger</p>



<a name="269255005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269255005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269255005">(Jan 25 2022 at 13:19)</a>:</h4>
<p>Ping for the people who voted <a href="#narrow/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe">in the other thread</a> who haven't participated in this one: <span class="user-mention" data-user-id="310045">@Eric Wieser</span> <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span>:</p>



<a name="269256668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269256668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269256668">(Jan 25 2022 at 13:33)</a>:</h4>
<p>I keep changing my opinion on this one :-). My impression is that there are arguments in both directions, so the final call should be on the majority of uses in mathlib. I see that <a href="https://github.com/leanprover-community/mathlib/pull/11427">#11427</a> makes us fix three simp calls. If the other direction requires less tweaks, it is probably better, if it requires more it is probably worse.</p>



<a name="269257154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/269257154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#269257154">(Jan 25 2022 at 13:37)</a>:</h4>
<p>The other direction required only adding two <code>←</code>s in a rewrite: <a href="https://github.com/leanprover-community/mathlib/commit/a492016b0d240505c8c2736771cdfea4b4ba472b">https://github.com/leanprover-community/mathlib/commit/a492016b0d240505c8c2736771cdfea4b4ba472b</a></p>



<a name="270194896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/270194896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#270194896">(Feb 01 2022 at 11:49)</a>:</h4>
<p>Anyone change their mind yet? :)</p>



<a name="270246666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311427%20make%20coe_norm_subgroup%2C%20submodule.norm_coe%20consistent/near/270246666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311427.20make.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.20consistent.html#270246666">(Feb 01 2022 at 17:03)</a>:</h4>
<p>I guess I'm fine with both now.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>