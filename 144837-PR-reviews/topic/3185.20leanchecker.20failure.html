---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html">3185 leanchecker failure</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202155322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202155322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202155322">(Jun 26 2020 at 23:31)</a>:</h4>
<p>Leanchecker times out in <a href="https://github.com/leanprover-community/mathlib/issues/3185">#3185</a>, and I have no idea how to fix this.</p>



<a name="202155416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202155416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202155416">(Jun 26 2020 at 23:33)</a>:</h4>
<p>I tried to run export&amp;leanchecker for <code>master</code> + changes to <code>complete_lattice</code>, and it worked. So, the problem is in <code>complete_lattice_of_Sup/Inf</code>-based instances. Any ideas how to fix this?</p>



<a name="202159987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202159987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202159987">(Jun 27 2020 at 01:04)</a>:</h4>
<p>Bisection says that the offender is <a href="https://github.com/leanprover-community/mathlib/pull/3185/files#diff-f741d98d7d24ed2ccdae58f7795e25e1R659">this instance</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">:</span> <span class="n">has_Inf</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span><span class="n">m</span><span class="o">,</span> <span class="o">(</span><span class="n">Inf</span> <span class="o">(</span><span class="n">to_outer_measure</span> <span class="err">&#39;&#39;</span> <span class="n">m</span><span class="o">))</span><span class="bp">.</span><span class="n">to_measure</span> <span class="err">$</span> <span class="n">Inf_caratheodory</span><span class="bp">⟩</span>

<span class="kn">lemma</span> <span class="n">Inf_apply</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_measurable</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">Inf</span> <span class="n">m</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">Inf</span> <span class="o">(</span><span class="n">to_outer_measure</span> <span class="err">&#39;&#39;</span> <span class="n">m</span><span class="o">)</span> <span class="n">s</span> <span class="o">:=</span>
<span class="n">to_measure_apply</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">hs</span>

<span class="kn">private</span> <span class="kn">lemma</span> <span class="n">Inf_le</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">μ</span> <span class="err">∈</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">Inf</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">μ</span> <span class="o">:=</span>
<span class="k">have</span> <span class="n">Inf</span> <span class="o">(</span><span class="n">to_outer_measure</span> <span class="err">&#39;&#39;</span> <span class="n">m</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">μ</span><span class="bp">.</span><span class="n">to_outer_measure</span> <span class="o">:=</span> <span class="n">Inf_le</span> <span class="o">(</span><span class="n">mem_image_of_mem</span> <span class="bp">_</span> <span class="n">h</span><span class="o">),</span>
<span class="k">assume</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">Inf_apply</span> <span class="n">hs</span><span class="o">,</span> <span class="err">←</span> <span class="n">to_outer_measure_apply</span><span class="o">]</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">this</span> <span class="n">s</span>

<span class="kn">private</span> <span class="kn">lemma</span> <span class="n">le_Inf</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">μ&#39;</span> <span class="err">∈</span> <span class="n">m</span><span class="o">,</span> <span class="n">μ</span> <span class="bp">≤</span> <span class="n">μ&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="n">μ</span> <span class="bp">≤</span> <span class="n">Inf</span> <span class="n">m</span> <span class="o">:=</span>
<span class="k">have</span> <span class="n">μ</span><span class="bp">.</span><span class="n">to_outer_measure</span> <span class="bp">≤</span> <span class="n">Inf</span> <span class="o">(</span><span class="n">to_outer_measure</span> <span class="err">&#39;&#39;</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">le_Inf</span> <span class="err">$</span> <span class="n">ball_image_of_ball</span> <span class="err">$</span> <span class="k">assume</span> <span class="n">μ</span> <span class="n">hμ</span><span class="o">,</span> <span class="n">to_outer_measure_le</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">h</span> <span class="bp">_</span> <span class="n">hμ</span><span class="o">,</span>
<span class="k">assume</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">Inf_apply</span> <span class="n">hs</span><span class="o">,</span> <span class="err">←</span> <span class="n">to_outer_measure_apply</span><span class="o">]</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">this</span> <span class="n">s</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">order_bot</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">bot</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bot_le</span> <span class="o">:=</span> <span class="k">assume</span> <span class="n">a</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact</span> <span class="n">bot_le</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">order_top</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">top</span> <span class="o">:=</span> <span class="o">(</span><span class="err">⊤</span> <span class="o">:</span> <span class="n">outer_measure</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">to_measure</span> <span class="o">(</span><span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">outer_measure</span><span class="bp">.</span><span class="n">top_caratheodory</span><span class="o">]</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">le_top</span><span class="o">),</span>
  <span class="n">le_top</span> <span class="o">:=</span> <span class="k">assume</span> <span class="n">a</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">cases</span> <span class="n">s</span><span class="bp">.</span><span class="n">eq_empty_or_nonempty</span> <span class="k">with</span> <span class="n">h</span>  <span class="n">h</span><span class="bp">;</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">,</span> <span class="n">to_measure_apply</span> <span class="err">⊤</span> <span class="bp">_</span> <span class="n">hs</span><span class="o">,</span> <span class="n">outer_measure</span><span class="bp">.</span><span class="n">top_apply</span><span class="o">],</span>
  <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span><span class="o">,</span>
  <span class="bp">..</span> <span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">ms</span><span class="o">,</span> <span class="bp">⟨λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">Inf_le</span><span class="o">,</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">le_Inf</span><span class="bp">⟩</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>



<a name="202218227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202218227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202218227">(Jun 28 2020 at 03:51)</a>:</h4>
<p>ping here. Need an expert on the internals of lean/leanchecker. <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> ?</p>



<a name="202220885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202220885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202220885">(Jun 28 2020 at 05:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Have you seen this thread?</p>



<a name="202220960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202220960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202220960">(Jun 28 2020 at 05:31)</a>:</h4>
<p>One thing that strikes me about that instance is that <code>complete_lattice_of_Inf</code> is going to prescribe one kind of inf and <code>measure.order_top</code> is going to give a different one</p>



<a name="202221001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221001">(Jun 28 2020 at 05:32)</a>:</h4>
<p>the clash will appear several times in showing that all the mixed-in fields are coherent</p>



<a name="202221009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221009">(Jun 28 2020 at 05:33)</a>:</h4>
<p>and that involves proving stuff like <code>Inf empty = 0</code> by refl</p>



<a name="202221049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221049">(Jun 28 2020 at 05:34)</a>:</h4>
<p>I'm kind of surprised this is even true, but it must be a lot of unfolding to prove</p>



<a name="202221179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221179">(Jun 28 2020 at 05:39)</a>:</h4>
<p>I was also thinking that, but I don't think that is true. In a <code>complete_lattice</code>, all operations are only proven correct relative to the ordering, and that there are no axioms relating two different operations. So as long as the order is (easily seen to be) definitionally equal, then you can mix and match the other operations however you want.</p>



<a name="202221252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221252">(Jun 28 2020 at 05:41)</a>:</h4>
<p>I'm puzzled as to how there can be an issue like this that only shows up using <code>leanchecker</code>.</p>



<a name="202221403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221403">(Jun 28 2020 at 05:46)</a>:</h4>
<p>the external checkers generally have lower quality heuristics for defeq than lean</p>



<a name="202221486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202221486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202221486">(Jun 28 2020 at 05:47)</a>:</h4>
<p><code>leanchecker</code> actually uses the same kernel as <code>lean</code>, but it is still possible that some information in the environment is not being stored in the export format that is helpful as a defeq hint</p>



<a name="202222181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222181">(Jun 28 2020 at 06:11)</a>:</h4>
<p>I tried with <code>.. partial_order</code> and explicit <code>bot</code>/<code>bot_le</code>, and got the same result.</p>



<a name="202222240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222240">(Jun 28 2020 at 06:12)</a>:</h4>
<p>which theorem exactly does it get stuck on? Is it the instance itself or one of the <code>_proof_n</code> auxiliaries?</p>



<a name="202222343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222343">(Jun 28 2020 at 06:16)</a>:</h4>
<p>For what it's worth, <a href="https://github.com/ammkrn/nanoda"><code>nanoda</code></a> was happy with the <code>mathlib.txt</code> export.</p>
<div class="codehilite"><pre><span></span><code>### Finished checking 86172 items in 185.075931s; to the best of our knowledge, all terms were well-typed! ###
</code></pre></div>



<a name="202222344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222344">(Jun 28 2020 at 06:16)</a>:</h4>
<p>Whoa, this isn't a good sign:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span><span class="o">,</span>
  <span class="bp">..</span> <span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="o">}</span>
</code></pre></div>


<p>times out in lean</p>



<a name="202222349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222349">(Jun 28 2020 at 06:17)</a>:</h4>
<p>PS: I like the hedging in nanoda's output <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="202222463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222463">(Jun 28 2020 at 06:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure/near/202222240">said</a>:</p>
<blockquote>
<p>which theorem exactly does it get stuck on? Is it the instance itself or one of the <code>_proof_n</code> auxiliaries?</p>
</blockquote>
<p>How would one find out what leanchecker gets stuck on?</p>



<a name="202222477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222477">(Jun 28 2020 at 06:21)</a>:</h4>
<p>You could try trimming the export until it doesn't hang</p>



<a name="202222520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222520">(Jun 28 2020 at 06:22)</a>:</h4>
<p>IIUC every prefix of a valid export is also valid</p>



<a name="202222933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202222933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202222933">(Jun 28 2020 at 06:36)</a>:</h4>
<p>I have managed to confirm, using</p>
<div class="codehilite"><pre><span></span><code>lean -E mathlib.txt --only-export<span class="o">=</span>measure_theory.measure.complete_lattice src/measure_theory/measure_space.lean
</code></pre></div>


<p>that the line that causes it to hang is the very last one, the <code>#DEF</code> that defines <code>measure_theory.measure.complete_lattice</code></p>



<a name="202223050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223050">(Jun 28 2020 at 06:41)</a>:</h4>
<p>I did something similar by searching for mentions of <code>7890</code> (which corresponds to <code>measure_theory.measure.complete_lattice</code>) and then manually deleting parts of the txt file. This attachment blows up <code>leanchecker</code>. <a href="/user_uploads/3121/uh5XJlZvYh-q9DQbFsEE8F8a/mathlib_def_7890.txt.zip">mathlib_def_7890.txt.zip</a></p>
<p><strong>edit</strong>: since I'm already attaching a bunch of files to this thread, here's the result of Mario's command above: <a href="user_uploads/3121/AD8MByh4JGovGNSQWvKlyUMr/mathlib_only_export.txt.zip">mathlib_only_export.txt.zip</a></p>



<a name="202223150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223150">(Jun 28 2020 at 06:44)</a>:</h4>
<p><code>leanchecker</code> is happy with everything up to and including <code>measure_theory.measure.complete_lattice._proof_17</code>: <a href="/user_uploads/3121/jc_d2ffxRh6KmZcLdEvjrU_z/mathlib_proof_17b.txt.zip">mathlib_proof_17b.txt.zip</a></p>



<a name="202223165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223165">(Jun 28 2020 at 06:45)</a>:</h4>
<p>I'm not sure if lean does typechecking on expr construction lines; maybe it can't because of de bruijn variables</p>



<a name="202223218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223218">(Jun 28 2020 at 06:47)</a>:</h4>
<p>In case the diff is meaningful:</p>
<div class="codehilite"><pre><span></span><code>764535,764629d764534
&lt; 744689 #EA 524211 699822
&lt; 744690 #EP #BC 186 697985 744689
&lt; 744691 #EP #BI 3 24295 744690
&lt; 744692 #EA 524214 699822
&lt; 744693 #EA 733404 699822
&lt; 744694 #EC 10886 20
&lt; 744695 #EA 744694 2
&lt; 744696 #EA 744695 1
&lt; 744697 #EA 738880 744696
&lt; 744698 #EA 744693 744697
&lt; 744699 #EA 744692 744698
&lt; 744700 #EA 744699 744144
&lt; 744701 #EA 744700 744147
&lt; 744702 #EC 10896 20
&lt; 744703 #EA 744702 2
&lt; 744704 #EA 744703 1
&lt; 744705 #EA 744701 744704
&lt; 744706 #EC 10897 20
&lt; 744707 #EA 744706 2
&lt; 744708 #EA 744707 1
&lt; 744709 #EA 744705 744708
&lt; 744710 #EC 10898 20
&lt; 744711 #EA 744710 2
&lt; 744712 #EA 744711 1
&lt; 744713 #EA 744709 744712
&lt; 744714 #EC 10899 20
&lt; 744715 #EA 744714 2
&lt; 744716 #EA 744715 1
&lt; 744717 #EA 744713 744716
&lt; 744718 #EC 10900 20
&lt; 744719 #EA 744718 2
&lt; 744720 #EA 744719 1
&lt; 744721 #EA 744717 744720
&lt; 744722 #EC 10901 20
&lt; 744723 #EA 744722 2
&lt; 744724 #EA 744723 1
&lt; 744725 #EA 744721 744724
&lt; 744726 #EC 10902 20
&lt; 744727 #EA 744726 2
&lt; 744728 #EA 744727 1
&lt; 744729 #EA 744725 744728
&lt; 744730 #EA 733722 699822
&lt; 744731 #EA 744730 744697
&lt; 744732 #EA 744729 744731
&lt; 744733 #EC 10903 20
&lt; 744734 #EA 744733 2
&lt; 744735 #EA 744734 1
&lt; 744736 #EA 744732 744735
&lt; 744737 #EC 10904 20
&lt; 744738 #EA 744737 2
&lt; 744739 #EA 744738 1
&lt; 744740 #EA 744736 744739
&lt; 744741 #EC 10905 20
&lt; 744742 #EA 744741 2
&lt; 744743 #EA 744742 1
&lt; 744744 #EA 744740 744743
&lt; 744745 #EA 744206 699822
&lt; 744746 #EA 744745 744218
&lt; 744747 #EA 744744 744746
&lt; 744748 #EC 10970 20
&lt; 744749 #EA 744748 2
&lt; 744750 #EA 744749 1
&lt; 744751 #EA 744747 744750
&lt; 744752 #EA 733875 699822
&lt; 744753 #EA 744752 744528
&lt; 744754 #EA 744751 744753
&lt; 744755 #EC 10982 20
&lt; 744756 #EA 744755 2
&lt; 744757 #EA 744756 1
&lt; 744758 #EA 744754 744757
&lt; 744759 #EA 733940 699822
&lt; 744760 #EA 744759 744697
&lt; 744761 #EA 744758 744760
&lt; 744762 #EA 734016 699822
&lt; 744763 #EA 744762 744697
&lt; 744764 #EA 744761 744763
&lt; 744765 #EC 10983 20
&lt; 744766 #EA 744765 2
&lt; 744767 #EA 744766 1
&lt; 744768 #EA 744764 744767
&lt; 744769 #EC 10984 20
&lt; 744770 #EA 744769 2
&lt; 744771 #EA 744770 1
&lt; 744772 #EA 744768 744771
&lt; 744773 #EC 10985 20
&lt; 744774 #EA 744773 2
&lt; 744775 #EA 744774 1
&lt; 744776 #EA 744772 744775
&lt; 744777 #EC 10986 20
&lt; 744778 #EA 744777 2
&lt; 744779 #EA 744778 1
&lt; 744780 #EA 744776 744779
&lt; 744781 #EL #BC 186 697985 744780
&lt; 744782 #EL #BI 3 24295 744781
&lt; #DEF 7890 744691 744782 663
</code></pre></div>



<a name="202223578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223578">(Jun 28 2020 at 06:59)</a>:</h4>
<p>My next tactic has been to rewrite the definition like so:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">axiom</span> <span class="n">not_sorry</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">:</span> <span class="n">α</span>

<span class="kn">theorem</span> <span class="n">complete_lattice&#39;</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">complete_lattice</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">le</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">lt</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_2</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_3</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_4</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_5</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_6</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_7</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@complete_lattice.inf.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--   (@complete_lattice_of_Inf.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.partial_order.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.has_Inf.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.complete_lattice._aux_1.{u_1} α _inst_1)))</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_8.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_9.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_10.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@order_top.top.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--   (@measure_theory.measure.order_top.{u_1} α _inst_1))</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_11.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@order_bot.bot.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--   (@measure_theory.measure.order_bot.{u_1} α _inst_1))</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_12.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@complete_lattice.Sup.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--   (@complete_lattice_of_Inf.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.partial_order.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.has_Inf.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.complete_lattice._aux_1.{u_1} α _inst_1)))</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@complete_lattice.Inf.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--   (@complete_lattice_of_Inf.{u_1} (@measure_theory.measure.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.partial_order.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.has_Inf.{u_1} α _inst_1)</span>
        <span class="c1">--     (@measure_theory.measure.complete_lattice._aux_1.{u_1} α _inst_1)))</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_13.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_14.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_15.{u_1} α _inst_1)</span>
  <span class="n">not_sorry</span> <span class="c1">-- (@measure_theory.measure.complete_lattice._proof_16.{u_1} α _inst_1)</span>
</code></pre></div>


<p>and see how much of the definition I can unsorry before leanchecker chokes</p>



<a name="202223916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223916">(Jun 28 2020 at 07:10)</a>:</h4>
<p><code>proof_13</code> causes the hang</p>



<a name="202223935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223935">(Jun 28 2020 at 07:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_13</span> <span class="o">:</span>
  <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="bp">Π</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="n">α</span><span class="o">],</span> <span class="bp">Π</span> <span class="n">a</span> <span class="o">:</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span> <span class="n">α</span><span class="o">,</span> <span class="n">has_le</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="n">has_bot</span><span class="bp">.</span><span class="n">bot</span><span class="o">)</span> <span class="n">a</span>
</code></pre></div>



<a name="202223976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223976">(Jun 28 2020 at 07:12)</a>:</h4>
<p>all the action is in the implicit args, of course</p>



<a name="202223977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202223977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202223977">(Jun 28 2020 at 07:12)</a>:</h4>
<p>the theorem is massive</p>



<a name="202224030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224030">(Jun 28 2020 at 07:14)</a>:</h4>
<p>actually that doesn't match my proof_13, although I modified the original instance to make pp.all output a bit more bearable</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)),</span> <span class="n">is_glb</span> <span class="n">s</span> <span class="o">(</span><span class="n">Inf</span> <span class="n">s</span><span class="o">),</span>
  <span class="n">abstract</span> <span class="o">{</span><span class="n">exact</span> <span class="bp">λ</span> <span class="n">ms</span><span class="o">,</span> <span class="bp">⟨λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">Inf_le</span><span class="o">,</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">le_Inf</span><span class="bp">⟩</span><span class="o">},</span>
  <span class="n">exact</span>
  <span class="o">{</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span><span class="o">,</span>
    <span class="bp">..</span> <span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="n">this</span> <span class="o">}</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202224034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224034">(Jun 28 2020 at 07:14)</a>:</h4>
<p>For me proof_13 is the one that says <code>∀ (s : set (measure α)) (a : measure α), a ∈ s → a ≤ complete_lattice.Sup s</code></p>



<a name="202224094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224094">(Jun 28 2020 at 07:16)</a>:</h4>
<p>Ah, OK, so it's:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_14</span> <span class="o">:</span>
  <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="bp">Π</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="n">α</span><span class="o">],</span> <span class="bp">Π</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span> <span class="n">α</span><span class="o">),</span> <span class="bp">Π</span> <span class="n">a</span> <span class="o">:</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span> <span class="n">α</span><span class="o">,</span>
  <span class="n">has_mem</span><span class="bp">.</span><span class="n">mem</span> <span class="n">a</span> <span class="n">s</span> <span class="bp">-&gt;</span> <span class="n">has_le</span><span class="bp">.</span><span class="n">le</span> <span class="n">a</span> <span class="o">(</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Sup</span> <span class="n">s</span><span class="o">)</span>
</code></pre></div>



<a name="202224098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224098">(Jun 28 2020 at 07:17)</a>:</h4>
<p>Yes, that one</p>



<a name="202224141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224141">(Jun 28 2020 at 07:18)</a>:</h4>
<p>Here's a self contained hang script:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)),</span> <span class="n">is_glb</span> <span class="n">s</span> <span class="o">(</span><span class="n">Inf</span> <span class="n">s</span><span class="o">),</span>
  <span class="n">abstract</span> <span class="o">{</span><span class="n">exact</span> <span class="bp">λ</span> <span class="n">ms</span><span class="o">,</span> <span class="bp">⟨λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">Inf_le</span><span class="o">,</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">le_Inf</span><span class="bp">⟩</span><span class="o">},</span>
  <span class="n">exact</span>
  <span class="o">{</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span><span class="o">,</span> <span class="bp">..</span> <span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span><span class="o">,</span>
    <span class="bp">..</span> <span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="n">this</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">foo</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">),</span>
    <span class="bp">@</span><span class="n">has_mem</span><span class="bp">.</span><span class="n">mem</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">set</span><span class="bp">.</span><span class="n">has_mem</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
      <span class="n">a</span>
      <span class="n">s</span> <span class="bp">→</span>
    <span class="bp">@</span><span class="n">has_le</span><span class="bp">.</span><span class="n">le</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">preorder</span><span class="bp">.</span><span class="n">to_has_le</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
         <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">to_preorder</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">order_bot</span><span class="bp">.</span><span class="n">to_partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
               <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">to_order_bot</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">le</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">lt</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_2</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_3</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_4</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_5</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_6</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_7</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                           <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_8</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_9</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_10</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">order_top</span><span class="bp">.</span><span class="n">top</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_11</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">order_bot</span><span class="bp">.</span><span class="n">bot</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                        <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
                     <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_12</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))))))</span>
      <span class="n">a</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Sup</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
         <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
         <span class="n">s</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_13</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>lean -E mathlib.txt --only-export<span class="o">=</span>measure_theory.measure.foo src/measure_theory/measure_space.lean
leanchecker mathlib.txt
</code></pre></div>



<a name="202224316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224316">(Jun 28 2020 at 07:24)</a>:</h4>
<p>Given that <code>nanoda</code> was happy with this, is the bug in Lean or in nanoda?</p>



<a name="202224327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224327">(Jun 28 2020 at 07:25)</a>:</h4>
<p>given the lean was also happy, it is probably a bug in leanchecker</p>



<a name="202224711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224711">(Jun 28 2020 at 07:39)</a>:</h4>
<p>Okay, I think I'm homing in on the issue:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">foo</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">has_le</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">preorder</span><span class="bp">.</span><span class="n">to_has_le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">to_preorder</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">order_bot</span><span class="bp">.</span><span class="n">to_partial_order</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">to_order_bot</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">lt</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_2</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_3</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_4</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_5</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_6</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_7</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_8</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_9</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_10</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">order_top</span><span class="bp">.</span><span class="n">top</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_11</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">order_bot</span><span class="bp">.</span><span class="n">bot</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">order_bot</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">proof_12</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))))))</span>
    <span class="bp">=</span>
  <span class="bp">@</span><span class="n">has_le</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">preorder</span><span class="bp">.</span><span class="n">to_has_le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">to_preorder</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">order_bot</span><span class="bp">.</span><span class="n">to_partial_order</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">to_order_bot</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">bounded_lattice</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">lt</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_refl</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_trans</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">lt_iff_le_not_le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_antisymm</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_sup_left</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_sup_right</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup_le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf_le_left</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf_le_right</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">top</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_top</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">bot</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">bot_le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))))))))</span>
  <span class="o">:=</span>
<span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="n">trans</span> <span class="bp">_</span> <span class="bp">_</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
  <span class="bp">_</span> <span class="n">rfl</span> <span class="n">rfl</span>
</code></pre></div>



<a name="202224772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224772">(Jun 28 2020 at 07:41)</a>:</h4>
<p>This proof, by <code>eq.trans rfl rfl</code>, goes through in <code>leanchecker</code>, but the proof using <code>rfl</code> does not</p>



<a name="202224818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224818">(Jun 28 2020 at 07:42)</a>:</h4>
<p>Furthermore, if you attempt to prove the <code>has_le</code> instances equal (by commenting out the <code> @has_le.le (@measure α _inst_1)</code> line on each side) then lean times out</p>



<a name="202224830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202224830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202224830">(Jun 28 2020 at 07:43)</a>:</h4>
<p>In other words, <code>leanchecker</code> used the heuristic that says <code>f x = f y &lt;- x = y</code> and timed out while proving <code>x = y</code></p>



<a name="202225074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202225074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202225074">(Jun 28 2020 at 07:50)</a>:</h4>
<p>Yep, after applying this heuristic 4 times you get to prove <code>bounded_lattice.mk ... = bounded_lattice.mk ...</code> here, which produces exactly the bad subgoal that I was afraid of:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">foo</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">order_top</span><span class="bp">.</span><span class="n">top</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">order_top</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="bp">=</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">top</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">complete_lattice_of_Inf</span> <span class="o">(</span><span class="bp">@</span><span class="n">measure</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">partial_order</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">has_Inf</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">measure</span><span class="bp">.</span><span class="n">complete_lattice</span><span class="bp">._</span><span class="n">aux_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
  <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="202229206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202229206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202229206">(Jun 28 2020 at 09:54)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/issues/364">lean#364</a>, though I suspect <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> may already be on it.</p>



<a name="202236443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202236443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202236443">(Jun 28 2020 at 13:20)</a>:</h4>
<p>I wonder why we hit this with <a href="https://github.com/leanprover-community/mathlib/issues/3185">#3185</a> but not with other <code>complete_lattice_of_Inf</code> instances.</p>



<a name="202236507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202236507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202236507">(Jun 28 2020 at 13:22)</a>:</h4>
<p>as long as the defeq problem is obviously true or obviously false there is no problem</p>



<a name="202236520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202236520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202236520">(Jun 28 2020 at 13:22)</a>:</h4>
<p>it's only when it triggers a lot of unfolding without a conclusive result that it has the bad behavior</p>



<a name="202236540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202236540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202236540">(Jun 28 2020 at 13:23)</a>:</h4>
<p>I'm not entirely sure what specifically there is about the definition that causes the problem, probably it ended up unfolding <code>real</code></p>



<a name="202237171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237171">(Jun 28 2020 at 13:40)</a>:</h4>
<p><del><code>attribute [irreducible] real</code>?</del>  Oh wait, the external typechecker doesn't get this info.</p>



<a name="202237419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237419">(Jun 28 2020 at 13:47)</a>:</h4>
<p>A potential solution is to change <code>real</code> to a 1-field structure.</p>



<a name="202237430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237430">(Jun 28 2020 at 13:47)</a>:</h4>
<p>Does the Lean kernel use <code>irreducible</code> as a hint?</p>



<a name="202237536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237536">(Jun 28 2020 at 13:50)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> Could it be that this is the key difference, why <code>lean</code> works but <code>leanchecker</code> doesn't?</p>



<a name="202237546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237546">(Jun 28 2020 at 13:50)</a>:</h4>
<p>Should we add irreducible markings to the export format?</p>



<a name="202237690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237690">(Jun 28 2020 at 13:54)</a>:</h4>
<p>The Lean type checker doesn't care about irreducible.</p>



<a name="202237701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237701">(Jun 28 2020 at 13:54)</a>:</h4>
<p>I don't think it makes sense to add irreducible to the export format.  We often need to <code>local attribute [semireducible]</code>, and we do not store which declarations require this local reducibility change.</p>



<a name="202237926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237926">(Jun 28 2020 at 14:00)</a>:</h4>
<p>Doesn't the kernel have its own version of reducibility hints?</p>



<a name="202237930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237930">(Jun 28 2020 at 14:00)</a>:</h4>
<p><code>abbreviation</code> hooks into this IIRC</p>



<a name="202237953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202237953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202237953">(Jun 28 2020 at 14:01)</a>:</h4>
<p>What I want to understand is what makes <code>lean</code> act differently from <code>leanchecker</code> in this instance, even though they use the same kernel code</p>



<a name="202238018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202238018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202238018">(Jun 28 2020 at 14:03)</a>:</h4>
<p>Could it be that the decision to unfold the projection in <a href="https://github.com/leanprover-community/lean/issues/364">lean#364</a> is due to some magic in the projection macro?</p>



<a name="202239338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202239338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202239338">(Jun 28 2020 at 14:39)</a>:</h4>
<p>Yes, I think the only difference here is the reducibility hints.  For example most (all?) of the constructions (<code>brec_on</code>, <code>rec_on</code>, <code>cases_on</code>, etc.) are marked as abbreviation.</p>



<a name="202239361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202239361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202239361">(Jun 28 2020 at 14:39)</a>:</h4>
<p>I'm not sure if the projection macros make it into the type checker.  If they do, then that's another difference.</p>



<a name="202245329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/202245329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#202245329">(Jun 28 2020 at 17:11)</a>:</h4>
<p>The problem is in the <code>top</code> field.</p>



<a name="286984610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/3185%20leanchecker%20failure/near/286984610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/3185.20leanchecker.20failure.html#286984610">(Jun 21 2022 at 23:00)</a>:</h4>
<p>Sorry for reviving an ancient thread, but is this fixed? I removed the comment and got the <code>top</code> field working with no issue</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>