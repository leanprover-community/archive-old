---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html">#11332 Euler's product formula for totient function</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="267365380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267365380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267365380">(Jan 09 2022 at 16:27)</a>:</h4>
<p>I've finally PRed a proof of Euler's product formula for the totient function (that I naively thought I'd basically finished two months ago! <a href="#narrow/stream/113489-new-members/topic/Proof.20of.20Euler's.20product.20formula.20for.20totient">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/Proof.20of.20Euler's.20product.20formula.20for.20totient</a>)</p>
<p>I'm not entirely happy with the fact that it's stated as an equation between rationals even though both sides are natural numbers.  Is there a nice way to get around this?</p>



<a name="267365956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267365956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267365956">(Jan 09 2022 at 16:42)</a>:</h4>
<p>Can you  write it with  <code>nat</code> as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">φ</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="bp">∏</span> <span class="n">p</span> <span class="k">in</span> <span class="n">n.factors.to_finset</span><span class="o">,</span> <span class="o">(</span><span class="n">p</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="bp">∏</span> <span class="n">p</span> <span class="k">in</span> <span class="n">n.factors.to_finset</span><span class="o">,</span> <span class="n">p</span><span class="o">)</span>
</code></pre></div>



<a name="267365962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267365962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267365962">(Jan 09 2022 at 16:42)</a>:</h4>
<p>My feeling is that it should stay as an equality of rationals. If someone wants to use it then they will inevitably be using rational division and inverses. I would say that it <em>is</em> an equation between rationals; one side is obviously integral, but the other side is not. I've noticed that my views about this sort of thing are somewhat in the minority here, but for me any equation involving mathematical division or inverses should always be going on in a ring where division and inverses agree with the mathematicians' definitions.</p>
<p>If you really don't like it, just clear denominators, and write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><msub><mo>∏</mo><mrow><mi>p</mi><mo>∣</mo><mi>n</mi></mrow></msub><mi>p</mi><mo>=</mo><mi>n</mi><msub><mo>∏</mo><mrow><mi>p</mi><mo>∣</mo><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)\prod_{p\mid n}p=n\prod_{p\mid n}(p-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.4747em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2247em;vertical-align:-0.4747em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mrel mtight">∣</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, although again my principles would say that this should be a statement about integers, not rationals, because it involves subtraction, and it also looks uglier (to me) and not of the standard form in the textbooks. Perhaps have both?</p>



<a name="267366058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366058">(Jan 09 2022 at 16:45)</a>:</h4>
<p>I'd argue that using naturals is fine here, because the subtraction isn't "real" subtraction, as it never actually truncates</p>



<a name="267366059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366059">(Jan 09 2022 at 16:45)</a>:</h4>
<p>Again I might be in the minority but I think Eric's suggestion stinks because it is using a non-mathematical division; one reason it's bad is that it's a strictly weaker statement (because 5/2=2).</p>



<a name="267366105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366105">(Jan 09 2022 at 16:46)</a>:</h4>
<p>Just because the division happens to be "real division" isn't good enough for me -- similarly I'm unhappy with the subtraction even though it happens to be a "real subtraction".</p>



<a name="267366111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366111">(Jan 09 2022 at 16:46)</a>:</h4>
<p>Yes, cancelling to get <code>φ n * ∏ p in n.factors.to_finset, p = n * ∏ p in n.factors.to_finset, (p - 1)</code> seems like the useful nat statement compared to my division one which I didn't think that carefully about</p>



<a name="267366121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366121">(Jan 09 2022 at 16:46)</a>:</h4>
<p>If you try and use these more artificial statements with bad division and bad subtraction then you put extra onus on the user to justify the assertions that they're not bad when they want to apply the result.</p>



<a name="267366188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366188">(Jan 09 2022 at 16:48)</a>:</h4>
<p>A shorter statement that eliminates the <code>finset</code> noise might be:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">φ</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">n.factors.prod</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n.factors.map</span> <span class="n">nat.pred</span><span class="o">)</span><span class="bp">.</span><span class="n">prod</span>
</code></pre></div>



<a name="267366255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366255">(Jan 09 2022 at 16:50)</a>:</h4>
<p><code>nat.pred</code> <em>grumble</em> I guess it's better than <code>nat.sub</code> though ;-)</p>



<a name="267366595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366595">(Jan 09 2022 at 16:57)</a>:</h4>
<p>Thanks, I'll add another version that's hopefully not too offensive to Kevin's sensibilities :)</p>



<a name="267366674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366674">(Jan 09 2022 at 16:58)</a>:</h4>
<p>Although, thinking a moment longer, would a version written in that form actually be useful at all?</p>



<a name="267366685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267366685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267366685">(Jan 09 2022 at 16:58)</a>:</h4>
<p>Right! The version which is useful is the version you already have in rat.</p>



<a name="267367078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267367078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267367078">(Jan 09 2022 at 17:05)</a>:</h4>
<p>The rational version indeed sounds more useful, but allowing one natural division (as in <code>φ n = n/(n.factors.prod) * (n.factors.map nat.pred).prod</code>) does not look terrible to the untrained eye, assuming there's a lemma saying <code>n.factors.prod</code> divides <code>n</code>.</p>



<a name="267367373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267367373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267367373">(Jan 09 2022 at 17:10)</a>:</h4>
<p>I need to add some stuff on division to <code>data/nat/factorization</code>, so I'll have a lemma there saying that <code>n.factors.prod</code> divides <code>n</code>.  But even given the existence of such a lemma, won't Lean complain about the statement of the theorem?  How in the theorem statement would I draw Lean's attention to the fact that this thing that looks like a fraction is actually a nat?</p>



<a name="267367682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267367682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267367682">(Jan 09 2022 at 17:18)</a>:</h4>
<p>I assume <code>/</code> is truncating division on <code>nat</code>. The lemma would let one convert between the <code>nat</code> division in <code>n/(n.factors.prod)</code>and the rational division (<code>n/(n.factors.prod : ℚ)</code> or however it is written in Lean) if necessary.</p>



<a name="267368851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267368851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267368851">(Jan 09 2022 at 17:44)</a>:</h4>
<p>Ah, of course, I'd somehow forgotten that <code>n / (n.factors.prod)</code> is a nat not a rat, and so the only issue is demonstrating that it's the nat we want it to be, not an unhappily truncated different nat.</p>



<a name="267369938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267369938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267369938">(Jan 09 2022 at 18:08)</a>:</h4>
<p>Just to note that this is a special case of Möbius inversion that <span class="user-mention" data-user-id="127136">@Alex J. Best</span> and I now have in full generality over at <a href="https://github.com/leanprover-community/mathlib/tree/incidence_algebra">branch#incidence_algebra</a>. Sorry, you might have gone through unneeded pain <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<a name="267370409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267370409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267370409">(Jan 09 2022 at 18:20)</a>:</h4>
<p>Is this formula a special case of Mobius inversion? I don't see it tbh. There are many related things that are due to Mobius inversion of course but the product formula seems of a slightly different nature to me</p>



<a name="267370578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267370578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267370578">(Jan 09 2022 at 18:24)</a>:</h4>
<p>I guess it's not that direct.</p>



<a name="267370600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267370600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267370600">(Jan 09 2022 at 18:25)</a>:</h4>
<p>Huh, interesting. I don't know anything about incidence algebras, so I guess I need to learn about them before (or while) you eat all of number theory <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="267370652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267370652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267370652">(Jan 09 2022 at 18:26)</a>:</h4>
<p>Me neither, until a week ago!</p>



<a name="267370751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267370751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267370751">(Jan 09 2022 at 18:29)</a>:</h4>
<p>Have no idea about this part of mathlib but I think that the mobius inversion might give a clean way to prove that phi is multiplicative and this formula should follow straight away?</p>



<a name="267371164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267371164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267371164">(Jan 09 2022 at 18:38)</a>:</h4>
<p>That part may be right (but I'm not sure the proof is "clean") but we already know that totient is multiplicative!</p>



<a name="267371410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267371410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267371410">(Jan 09 2022 at 18:45)</a>:</h4>
<blockquote>
<p>Ah, of course, I'd somehow forgotten that <code>n / (n.factors.prod)</code> is a nat not a rat, and so the only issue is demonstrating that it's the nat we want it to be, not an unhappily truncated different nat.</p>
</blockquote>
<p>It's the truncated one, the product of the factors is usually larger than n and so this gives 0. You need to do the division last, after doing all your multiplication</p>



<a name="267371643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267371643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267371643">(Jan 09 2022 at 18:50)</a>:</h4>
<p>Hold on, am I getting confused?  <code>n.factors</code> is the entire factorisation of <code>n</code> as a list, so <code>factors 12</code> is <code>[2,2,3]</code> and <code>n.factors.prod = n</code>(as proved in <code>prod_factors</code>).</p>



<a name="267371667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267371667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267371667">(Jan 09 2022 at 18:51)</a>:</h4>
<p>So the <code>to_finset</code> step isn't noise, it's essential to get from the list of factors to the set of factors.</p>



<a name="267371933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267371933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267371933">(Jan 09 2022 at 18:57)</a>:</h4>
<p>Ah, yes, you're right. My suggestion must include the <code>to_finset</code> call.</p>



<a name="267376933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267376933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267376933">(Jan 09 2022 at 20:47)</a>:</h4>
<p>I thought <code>factors 12</code> was <code>[2, 3, 4, 6]</code>. Maybe I'm thinking of something else. <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.divisors">docs#nat.divisors</a> instead of <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.factors">docs#nat.factors</a> probably?</p>



<a name="267377157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267377157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267377157">(Jan 09 2022 at 20:52)</a>:</h4>
<p><code>divisors</code> will be all the divisors as a finset, here <code>{1, 2, 3, 4, 6, 12}</code> and <code>factors</code> will be all the prime factors in increasing order.</p>



<a name="267377181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267377181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267377181">(Jan 09 2022 at 20:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="439483">Andrew Yang</span> <a href="#narrow/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function/near/267370751">said</a>:</p>
<blockquote>
<p>Have no idea about this part of mathlib but I think that the mobius inversion might give a clean way to prove that phi is multiplicative and this formula should follow straight away?</p>
</blockquote>
<p>The formula is already done like this, Stuart's recent PRs allow us to evaluate multiplicative functions on prime powers, and the file already shows it's multiplicative</p>



<a name="267383867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/267383867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#267383867">(Jan 09 2022 at 23:38)</a>:</h4>
<p>I’ve just finished a first draft proof of a version that stays within <code>nat</code>, similar to <span class="user-mention" data-user-id="325367">@Mauricio Collares</span>’s suggestion, which I’ll add to the PR tomorrow after some tidying up.</p>



<a name="272039183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/272039183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#272039183">(Feb 15 2022 at 21:15)</a>:</h4>
<p>At long last I think this is ready for review <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="272292733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%2311332%20Euler%27s%20product%20formula%20for%20totient%20function/near/272292733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.2311332.20Euler's.20product.20formula.20for.20totient.20function.html#272292733">(Feb 17 2022 at 17:22)</a>:</h4>
<p>Thanks to <span class="user-mention" data-user-id="306601">@Kyle Miller</span>'s suggestions this lemma has been factored into a few different versions, but now it's not clear what they should each be called.  Could someone take a look and suggest names that fit with mathlib's naming conventions?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>