---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.234684.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html">#4684</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="225486839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225486839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225486839">(Feb 07 2021 at 22:11)</a>:</h4>
<p>Would someone who knows about how Lean processes <code>{ ..X, ..Y }</code> constructions please take a quick look at <a href="https://github.com/leanprover-community/mathlib/issues/4684">#4684</a>? There is a confusing case there where several fields should be picked up by <code>..(by apply_instance : comm_ring ℂ)</code>, but aren't. <span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span> has found a strange work-around. (And the PR itself works around it just by writing the fields again explicitly.)</p>
<p>It is not particularly high priority --- and if the answer is just "this is a quirk in Lean 3 that is not worth addressing" that is just fine!</p>



<a name="225487333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225487333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225487333">(Feb 07 2021 at 22:23)</a>:</h4>
<p>This PR puts an <code>ordered_comm_ring</code> instance on the complex numbers. I just remembered that there was <a href="#narrow/stream/116395-maths/topic/Definition.20of.20ordered.20rings">some discussion a while back</a> about whether we should change our definition of <code>ordered_ring</code> to exclude this sort of thing. (The recent <a href="#narrow/stream/113489-new-members/topic/canonically_ordered.20pathology">"canonically ordered pathology"</a> thread finds a separate issue with <code>ordered_semiring</code>, I think.) I don't think the issues brought up in those threads need to be addressed before this PR gets merged, but I figured I'd point them out here, in case <span class="user-mention" data-user-id="110087">@Scott Morrison</span> had any opinions on these classes.</p>



<a name="225487470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225487470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225487470">(Feb 07 2021 at 22:26)</a>:</h4>
<p>I didn't think that discussion would have ruled this out. Certainly ordered rings should be allowed to use only a partial order --- the fundamental example is the order structure on <code>B(H)</code> (bounded operators on a hilbert space), and in fact this example is a special case of that.</p>
<p>That discussion was about a distinction between positivity and non-negativity. I agree that the change proposed there should be made, and don't think it should affect this PR.</p>



<a name="225487873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225487873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225487873">(Feb 07 2021 at 22:35)</a>:</h4>
<p>Oh, right. Sorry about that, I misremembered.</p>



<a name="225488974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225488974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225488974">(Feb 07 2021 at 23:01)</a>:</h4>
<p>Yes the thread with me and Damiano getting excited is all about what happens if you drop subtraction, so you can't deduce a+c&lt;=b+c -&gt; a&lt;=b from its converse</p>



<a name="225947654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225947654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225947654">(Feb 11 2021 at 04:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/144837-PR-reviews/topic/.234684/near/225486839">said</a>:</p>
<blockquote>
<p>Would someone who knows about how Lean processes <code>{ ..X, ..Y }</code> constructions please take a quick look at <a href="https://github.com/leanprover-community/mathlib/issues/4684">#4684</a>? There is a confusing case there where several fields should be picked up by <code>..(by apply_instance : comm_ring ℂ)</code>, but aren't. <span class="user-mention silent" data-user-id="123965">Bryan Gin-ge Chen</span> has found a strange work-around. (And the PR itself works around it just by writing the fields again explicitly.)</p>
<p>It is not particularly high priority --- and if the answer is just "this is a quirk in Lean 3 that is not worth addressing" that is just fine!</p>
</blockquote>
<p>cc: <span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>



<a name="225951556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225951556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225951556">(Feb 11 2021 at 05:56)</a>:</h4>
<p>wait, what? <code>complex</code> lacks a less equal operator on purpose</p>



<a name="225951962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225951962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225951962">(Feb 11 2021 at 06:05)</a>:</h4>
<p>Well, I'm willing to trust Scott that this one is useful. Do you think the instances should be in a locale?</p>



<a name="225951963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225951963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225951963">(Feb 11 2021 at 06:05)</a>:</h4>
<p>You can use</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">partial_order</span> <span class="n">ℂ</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="n">ℂ</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">comm_semiring</span> <span class="n">ℂ</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">add_cancel_monoid</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>
<p>to solve the issue in the PR. The reason is because <code>comm_ring</code> doesn't actually have <code>zero_add</code> et al as fields, they are derived as lemmas</p>



<a name="225952064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952064">(Feb 11 2021 at 06:07)</a>:</h4>
<p>Is there a reason to prefer that over what I suggested:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">semiring</span> <span class="n">ℂ</span><span class="o">),</span> <span class="c1">-- comm_semiring and even mul_zero_class work too!</span>
  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">add_left_cancel_semigroup</span> <span class="n">ℂ</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="kd">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">add_right_cancel_semigroup</span> <span class="n">ℂ</span><span class="o">),</span>
</code></pre></div>
<p>or just filling in the fields as Scott did?</p>



<a name="225952115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952115">(Feb 11 2021 at 06:08)</a>:</h4>
<p>it's one fewer class</p>



<a name="225952132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952132">(Feb 11 2021 at 06:09)</a>:</h4>
<p>Oh right, yeah, I forgot about the ones at the end.</p>



<a name="225952134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952134">(Feb 11 2021 at 06:09)</a>:</h4>
<p>I assume you still have <code>partial_order</code> and <code>comm_ring</code> in addition to those three</p>



<a name="225952207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952207">(Feb 11 2021 at 06:10)</a>:</h4>
<p>I think it's marginally preferable to use <code>..s</code> instead of rewriting the fields, although I recognize that there are a handful of edge cases where you have to write the fields</p>



<a name="225952296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952296">(Feb 11 2021 at 06:12)</a>:</h4>
<p>Regarding the locale question, I think it should go to a poll; I'm curious about how the mathematicians will react to an order on <code>complex</code>, without knowing in advance what its definition is</p>



<a name="225952669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%234684/near/225952669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.234684.html#225952669">(Feb 11 2021 at 06:20)</a>:</h4>
<p>This topic was moved by <span class="user-mention silent" data-user-id="123965">Bryan Gin-ge Chen</span> to <a class="stream-topic" data-stream-id="113488" href="/#narrow/stream/113488-general/topic/Poll.3A.20partial.20order.20on.20complex.20numbers.20in.20mathlib">#general &gt; Poll: partial order on complex numbers in mathlib</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>