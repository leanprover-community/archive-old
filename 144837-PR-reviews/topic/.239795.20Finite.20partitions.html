---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html">#9795 Finite partitions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="258399905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258399905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258399905">(Oct 20 2021 at 16:36)</a>:</h4>
<p>Eric mentioned that the definition of  <code>finpartition</code> might not have the expected behavior in non atomic lattices. Problem is, I don't know what the expected behavior is, or whether there's even one. Do you expect anything from this definition in the context of non atomic lattices? If so, what? If not, what about we merge this without changing the definition but with verbose TODO about the situation?</p>



<a name="258405599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258405599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258405599">(Oct 20 2021 at 17:09)</a>:</h4>
<p>At any rate I think the meaning would be surprising in your proposed <code>lattice_bot</code> generalization</p>



<a name="258546982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258546982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258546982">(Oct 21 2021 at 13:41)</a>:</h4>
<p>I'm now defining <code>def finset.sup_indep (s : finset α) : Prop := ∀ ⦃a⦄, a ∈ s → disjoint a ((s.erase a).sup id)</code></p>



<a name="258547024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258547024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258547024">(Oct 21 2021 at 13:41)</a>:</h4>
<p>I'll PR that first, then see whether it makes <code>finpartition</code> any worse.</p>



<a name="258547641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258547641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258547641">(Oct 21 2021 at 13:45)</a>:</h4>
<p>Note it at least makes it require <code>decidable_eq α</code></p>



<a name="258557295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258557295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258557295">(Oct 21 2021 at 14:38)</a>:</h4>
<p>Is that different to the primed version of <a href="https://leanprover-community.github.io/mathlib_docs/find/complete_lattice.independent">docs#complete_lattice.independent</a>?</p>



<a name="258557345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258557345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258557345">(Oct 21 2021 at 14:39)</a>:</h4>
<p>Oh, maybe we got rid of that</p>



<a name="258557475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258557475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258557475">(Oct 21 2021 at 14:39)</a>:</h4>
<p>Ah, <a href="https://leanprover-community.github.io/mathlib_docs/find/complete_lattice.set_independent">docs#complete_lattice.set_independent</a></p>



<a name="258570736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258570736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258570736">(Oct 21 2021 at 15:54)</a>:</h4>
<p>It is, because it uses <code>finset</code> and avoids <code>Sup</code></p>



<a name="258570753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258570753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258570753">(Oct 21 2021 at 15:54)</a>:</h4>
<p>But in spirit that's the same</p>



<a name="258570938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258570938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258570938">(Oct 21 2021 at 15:55)</a>:</h4>
<p>I just spent an hour proving the bind operation for my new <code>sup_indep</code>. Very satisfying. I'll probably refactor <a href="https://leanprover-community.github.io/mathlib_docs/find/completelattice.set_independent">docs#completelattice.set_independent</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/completelattice.independent">docs#completelattice.independent</a> into one thing that takes in indexed sets.</p>



<a name="258571028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258571028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258571028">(Oct 21 2021 at 15:56)</a>:</h4>
<p>I think I am now understanding the correct architecture.</p>



<a name="258622146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258622146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258622146">(Oct 21 2021 at 21:44)</a>:</h4>
<p>Actually, your suggestion really does only make a difference in nondistributive non atomic lattices.</p>



<a name="258622692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258622692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258622692">(Oct 21 2021 at 21:48)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span>, long story short: your proposed change to the generalization doesn't change anything so long as we don't have <code>lattice_bot</code> (Yakov is working on that)</p>



<a name="258622999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258622999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258622999">(Oct 21 2021 at 21:51)</a>:</h4>
<p>Under the current <code>distrib_lattice_bot</code> assumption, <code>set.pairwise_disjoint</code> and your proposed <code>finset.sup_indep</code> are strictly equivalent. And the counterexample you brought up on Github is nondistributive.</p>



<a name="258872682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258872682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258872682">(Oct 24 2021 at 10:58)</a>:</h4>
<p>Kind ping</p>



<a name="258947271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258947271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258947271">(Oct 25 2021 at 11:45)</a>:</h4>
<p>I haven't thought about any potential subtleties involved with this. Do we care about computability?</p>



<a name="258947282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258947282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258947282">(Oct 25 2021 at 11:46)</a>:</h4>
<p>The PR looks fine to me.</p>



<a name="258947668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258947668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258947668">(Oct 25 2021 at 11:50)</a>:</h4>
<p>What's the downside in building finite partitions using <a href="https://leanprover-community.github.io/mathlib_docs/find/indexed_partition">docs#indexed_partition</a> and a fintype instance on the index?</p>



<a name="258953925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258953925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258953925">(Oct 25 2021 at 12:52)</a>:</h4>
<p>We're interested into partitons into finsets but <code>indexed_partition</code> is a partition into sets, although it's perfectly possible to generalize.</p>



<a name="258954705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258954705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258954705">(Oct 25 2021 at 12:58)</a>:</h4>
<p>But <code>finite_partition</code> is not a partition <em>into</em> <code>finset</code>s, its a partition into a finite set of not-necessarily-sets</p>



<a name="258954807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258954807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258954807">(Oct 25 2021 at 12:59)</a>:</h4>
<p>Yes, precisely. It allows you to do finite partitions into finsets.</p>



<a name="258954926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258954926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258954926">(Oct 25 2021 at 13:00)</a>:</h4>
<p>If you want me to generalize the "finite partition" part, I can have a think.</p>



<a name="258959869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258959869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258959869">(Oct 25 2021 at 13:38)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span>, the problem with <a href="https://leanprover-community.github.io/mathlib_docs/find/indexed_partition">docs#indexed_partition</a> is that it tries to be constructive. If I were to generalize it from <code>set α</code> to an arbitrary <code>distrib_lattice_bot</code>, then I would have to drop <code>some</code> and <code>index</code>.</p>



<a name="258960351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258960351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258960351">(Oct 25 2021 at 13:41)</a>:</h4>
<p>The problem is more that it's atomic, right, and we don't have any typeclasses relating <code>\mem</code> and <code>\sup</code></p>



<a name="258960425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258960425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258960425">(Oct 25 2021 at 13:42)</a>:</h4>
<p>Yup</p>



<a name="258960579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258960579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258960579">(Oct 25 2021 at 13:43)</a>:</h4>
<p>I think my hesitation here is that <code>fin_partition</code> seems to have quite a different design to all the partition stuff so far, and it's not clear which bits are "we designed the other API wrong" and "we need this special case just because we care about finiteness"</p>



<a name="258960886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258960886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258960886">(Oct 25 2021 at 13:45)</a>:</h4>
<p>I can probably generalize <code>finpartition</code> so that you can talk about infinite partitions reusing some of the design of <code>indexed_partition</code>. The latter should probably be called <code>indexed_set_partition</code> because that's what it is.</p>



<a name="258961384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258961384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258961384">(Oct 25 2021 at 13:48)</a>:</h4>
<p>Another thing that comes to mind, is that if we had <a href="https://github.com/leanprover-community/mathlib/issues/7123">#7123</a> you could likely replace <code>finset.sup</code> with <code>Sup</code></p>



<a name="258962267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258962267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258962267">(Oct 25 2021 at 13:55)</a>:</h4>
<p>Maybe yeah</p>



<a name="258962405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/258962405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#258962405">(Oct 25 2021 at 13:56)</a>:</h4>
<p>Actually, to generalize to an indexed partition, I need <a href="https://github.com/leanprover-community/mathlib/issues/9898">#9898</a>. How handy is it that the PR is already open and reviewed! <span aria-label="innocent" class="emoji emoji-1f607" role="img" title="innocent">:innocent:</span></p>



<a name="261526964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/261526964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#261526964">(Nov 15 2021 at 17:05)</a>:</h4>
<p>Uh, I just noticed that <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sup_indep">docs#finset.sup_indep</a> requires <code>decidable_eq ι</code> while</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- Supremum independence of finite sets. -/</span>
<span class="kd">def</span> <span class="n">sup_indep'</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="bp">∀</span> <span class="o">⦃</span><span class="n">a</span> <span class="n">t</span><span class="o">⦄,</span> <span class="n">t</span> <span class="bp">⊆</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∉</span> <span class="n">t</span> <span class="bp">→</span> <span class="n">disjoint</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">t.sup</span> <span class="n">f</span><span class="o">)</span>
</code></pre></div>
<p>doesn't</p>



<a name="261531140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/261531140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#261531140">(Nov 15 2021 at 17:33)</a>:</h4>
<p>(I just noticed some of the earlier discussion about <a href="https://leanprover-community.github.io/mathlib_docs/find/indexed_partition">docs#indexed_partition</a>.  One problem with it is that it has the wrong extensionality properties due to the <code>some</code> field.  If it were like <code>some : Π (i : ι) → trunc (s i)</code> instead things would be different.)</p>



<a name="261531470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/261531470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#261531470">(Nov 15 2021 at 17:35)</a>:</h4>
<p>(But not completely different, because indexed partitions and partitions are different concepts.)</p>



<a name="270963296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270963296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270963296">(Feb 07 2022 at 11:16)</a>:</h4>
<p>Could this finally be merged? Here's what changed since the last review:</p>
<ul>
<li><code>finset.sup_indep</code> replaced <code>set.pairwise_disjoint</code></li>
<li>Bhavik and I decided to stick to non indexed partitions, because it turns out that we can put a lattice structure on <code>finpartition</code> and that this is relevant to <code>atomise</code>: <code>atomise</code> is the infimum of a bunch of simple partitions. Further, <code>finpartition</code> is a cograded order with grade function <code>P.parts.card - 1</code>. To showcase this, we provided the <code>semilattice_inf</code> instance. The <code>semilattice_sup</code> one is a pain, but can be done.</li>
</ul>



<a name="270963310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270963310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270963310">(Feb 07 2022 at 11:16)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="310045">@Eric Wieser</span></p>



<a name="270964356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270964356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270964356">(Feb 07 2022 at 11:28)</a>:</h4>
<p>If you want to have a look at the indexed version for some reason, it's over at <a href="https://github.com/leanprover-community/mathlib/tree/finpartition_index">branch#finpartition_index</a></p>



<a name="270969554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270969554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270969554">(Feb 07 2022 at 12:20)</a>:</h4>
<p>Did <code>sup_indep.sigma</code> and <code>sup_indep.product</code> from the indexed branch end up merged elsewhere?</p>



<a name="270970150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270970150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270970150">(Feb 07 2022 at 12:26)</a>:</h4>
<p>I think not. Do you want me to add them to that PR?</p>



<a name="270971051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270971051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270971051">(Feb 07 2022 at 12:35)</a>:</h4>
<p>A separate PR would probably make more sense if you're not using them right now. But it would be a shame to lose them</p>



<a name="270971168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270971168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270971168">(Feb 07 2022 at 12:36)</a>:</h4>
<p>A separate PR it is!</p>



<a name="270971745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270971745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270971745">(Feb 07 2022 at 12:41)</a>:</h4>
<p>A question about the definition - what would happen if instead of requiring <code>(not_bot_mem : ⊥ ∉ parts)</code> you required <code>(bot_mem : ⊥ ∈ parts)</code>? That would remove the need for <code>of_erase</code>, and things like <code>inf</code> would have definitionally simpler parts.</p>



<a name="270972120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270972120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270972120">(Feb 07 2022 at 12:44)</a>:</h4>
<p>We had this at some point, but it turns out that it messes stuff later. Do you remember what, <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span>? At least, it means that<br>
<code>(P.bind Q).parts.card = 1 + ∑ A in P.parts.attach, (Q _ A.2).parts.card - 1</code> instead of <code>(P.bind Q).parts.card = ∑ A in P.parts.attach, (Q _ A.2).parts.card</code>.</p>



<a name="270972136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270972136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270972136">(Feb 07 2022 at 12:44)</a>:</h4>
<p>We had this at some point, but it turns out that it messes stuff later. Do you remember what, <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span>? At least, it means that<br>
<code>(P.bind Q).parts.card = 1 + ∑ A in P.parts.attach, (Q _ A.2).parts.card - 1</code> instead of <code>(P.bind Q).parts.card = ∑ A in P.parts.attach, (Q _ A.2).parts.card</code>.</p>



<a name="270972416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270972416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270972416">(Feb 07 2022 at 12:46)</a>:</h4>
<p>I don't entirely remember the specifics but I do remember that we tried this and in combinatorial applications it turned out worse to work with, even though the immediate API like <code>of_erase</code> becomes slightly nicer (though it would need to be replaced by something which inserts empty).</p>



<a name="270973137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270973137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270973137">(Feb 07 2022 at 12:52)</a>:</h4>
<p>A comment in the module summarizing whatever you still remember about that design decision would be great!</p>



<a name="270976209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/270976209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#270976209">(Feb 07 2022 at 13:18)</a>:</h4>
<p>Will do! We're both working on a paper for ITP which (fundamentally) uses this new structure already so it might take a couple of days, but it should be fresh enough :)</p>



<a name="271264554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/271264554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#271264554">(Feb 09 2022 at 11:44)</a>:</h4>
<p>Just added a little batch of new lemmas.</p>



<a name="271589830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/271589830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#271589830">(Feb 11 2022 at 15:10)</a>:</h4>
<p>Ping! I swear this will be a merge by exhaustion.</p>



<a name="271693867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239795%20Finite%20partitions/near/271693867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239795.20Finite.20partitions.html#271693867">(Feb 12 2022 at 15:28)</a>:</h4>
<p>Could <span class="user-mention" data-user-id="306601">@Kyle Miller</span> or <span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span> have a look, maybe?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>