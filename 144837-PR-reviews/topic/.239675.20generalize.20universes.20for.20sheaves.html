---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html">#9675 generalize universes for sheaves</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="257235399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257235399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257235399">(Oct 12 2021 at 16:53)</a>:</h4>
<p>The linter is complaining about some universe levels:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<p>/- Checking 27 declarations (plus 68 automatically generated ones) in the current file with 23 linters -/</p>
<p>/- The <code>check_univs</code> linter reports: -/<br>
/- THE STATEMENTS OF THE FOLLOWING DECLARATIONS HAVE BAD UNIVERSE LEVELS. This usually means that there is a <code>max u v</code> in the declaration where neither <code>u</code> nor <code>v</code> occur by themselves. Solution: Find the type (or type bundled with data) that has this universe argument and provide the universe level explicitly. If this happens in an implicit argument of the declaration, a better solution is to move this argument to a <code>variables</code> command (where the universe level can be kept implicit).<br>
Note: if the linter flags an automatically generated declaration <code>xyz._proof_i</code>, it means that<br>
the universe problem is with <code>xyz</code> itself (even if the linter doesn't flag <code>xyz</code>) -/<br>
#check @category_theory.presheaf.fork_map._proof_1 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.first_map._proof_2 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.first_map._proof_4 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.first_map._proof_1 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.second_map._proof_4 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.second_map._proof_1 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.second_map._proof_2 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf'._proof_4 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf'._proof_3 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf'._proof_5 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_11 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_5 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_10 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_3 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_12 /- universes [u₁, v₁] only occur together. -/<br>
#check @category_theory.presheaf.is_sheaf_for_is_sheaf_for'._proof_4 /- universes [u₁, v₁] only occur together. -/</p>
</div></div>
<p>How should we proceed here?</p>



<a name="257235421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257235421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257235421">(Oct 12 2021 at 16:53)</a>:</h4>
<p>Ping <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span></p>



<a name="257236171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236171">(Oct 12 2021 at 16:58)</a>:</h4>
<p>Is the complaint valid? From a brief read it looks like <code>fork_map</code> does have the universe arguments in different parts, even though they're implicit. Or maybe I'm misunderstanding what the point of this linter is</p>



<a name="257236287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236287">(Oct 12 2021 at 16:59)</a>:</h4>
<p>The universes are declared in the variables for the section as follows:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u₁</span><span class="o">}</span> <span class="o">[</span><span class="n">category.</span><span class="o">{</span><span class="n">v₁</span><span class="o">}</span> <span class="n">C</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u₂</span><span class="o">}</span> <span class="o">[</span><span class="n">category.</span><span class="o">{</span><span class="n">max</span> <span class="n">v₁</span> <span class="n">u₁</span><span class="o">}</span> <span class="n">A</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">J</span> <span class="o">:</span> <span class="n">grothendieck_topology</span> <span class="n">C</span><span class="o">)</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">U</span> <span class="o">:</span> <span class="n">C</span><span class="o">}</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="n">presieve</span> <span class="n">U</span><span class="o">)</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">C</span><span class="bp">ᵒᵖ</span> <span class="bp">⥤</span> <span class="n">A</span><span class="o">)</span>
</code></pre></div>



<a name="257236356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236356">(Oct 12 2021 at 16:59)</a>:</h4>
<p>So yes it seems that they're in different parts -- the <code>v_1</code> is in <code>category.{v_1} C</code> and the <code>u_1</code> is in <code>C : Type u_1</code>.</p>



<a name="257236401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236401">(Oct 12 2021 at 16:59)</a>:</h4>
<p>I don't really know what this linter is supposed to check for...</p>



<a name="257236593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236593">(Oct 12 2021 at 17:00)</a>:</h4>
<p>For reference, the type signature of <code>fork_map</code> is <code>P.obj (op U) ⟶ first_obj R P</code></p>



<a name="257236621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236621">(Oct 12 2021 at 17:00)</a>:</h4>
<p>and <code>first_obj : A</code></p>



<a name="257236981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257236981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257236981">(Oct 12 2021 at 17:03)</a>:</h4>
<p>Maybe it's really only the <code>category_theory.presheaf.fork_map._proof_XX</code> that have the issue? In which case it's not really a problem right?</p>



<a name="257237161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237161">(Oct 12 2021 at 17:04)</a>:</h4>
<p>The linter claims that if it flags <code>_proof_</code> then the definition itself is apparently the problem</p>



<a name="257237215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237215">(Oct 12 2021 at 17:04)</a>:</h4>
<p>I think that's right <span class="user-mention" data-user-id="110032">@Reid Barton</span> :</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">fork_map._proof_1</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">category</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_3</span> <span class="o">:</span> <span class="n">has_products</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_3</span> <span class="n">u_1</span><span class="o">)),</span>
    <span class="n">has_limits_of_shape</span> <span class="o">(</span><span class="n">discrete</span> <span class="n">J</span><span class="o">)</span> <span class="n">A</span>
</code></pre></div>



<a name="257237336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237336">(Oct 12 2021 at 17:05)</a>:</h4>
<p>right, C isn't appearing in this proof for whatever reason</p>



<a name="257237366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237366">(Oct 12 2021 at 17:06)</a>:</h4>
<p>I assume all of these <code>???._proof_??</code> are proofs that <code>A</code> has some sort of limits.</p>



<a name="257237470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237470">(Oct 12 2021 at 17:06)</a>:</h4>
<p>In that case I think the linter note is misleading</p>



<a name="257237508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237508">(Oct 12 2021 at 17:06)</a>:</h4>
<p>I'll just add some <code>nolints</code></p>



<a name="257237626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257237626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257237626">(Oct 12 2021 at 17:07)</a>:</h4>
<p>Agreed, though perhaps whoever made this linter could chime in?</p>



<a name="257238096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257238096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257238096">(Oct 12 2021 at 17:10)</a>:</h4>
<p>Hmm.... another question is where and how the <code>nolint</code>'s should be added.</p>



<a name="257238209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257238209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257238209">(Oct 12 2021 at 17:11)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[nolint check_univs]</span>
<span class="kd">def</span> <span class="n">fork_map</span> <span class="o">:</span> <span class="n">P.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">U</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">first_obj</span> <span class="n">R</span> <span class="n">P</span> <span class="o">:=</span>
</code></pre></div>
<p>and the linter still complains about <code>fork_map._proof_1</code></p>



<a name="257238437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257238437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257238437">(Oct 12 2021 at 17:13)</a>:</h4>
<p>Can you add the attribute specifically to that proof after the definition?</p>



<a name="257238837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257238837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257238837">(Oct 12 2021 at 17:15)</a>:</h4>
<p>Yeah, I can do that</p>



<a name="257239021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257239021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257239021">(Oct 12 2021 at 17:17)</a>:</h4>
<p>It doesn't seem very robust, though</p>



<a name="257239191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257239191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257239191">(Oct 12 2021 at 17:18)</a>:</h4>
<p>Right, I shouldn't ever have to write <code>_proof_??</code></p>



<a name="257239324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257239324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257239324">(Oct 12 2021 at 17:19)</a>:</h4>
<p>Is there a way to turn of a linter for all declarations in a specific section?</p>



<a name="257239568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257239568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257239568">(Oct 12 2021 at 17:20)</a>:</h4>
<p>it should be really be called <code>_proо̆f_??</code></p>



<a name="257239948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257239948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257239948">(Oct 12 2021 at 17:23)</a>:</h4>
<p>I think it would be reasonable to exclude <code>_proof_*</code> from the linter.  (That is, in general.  Add a check to the linter.)</p>



<a name="257240200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257240200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257240200">(Oct 12 2021 at 17:24)</a>:</h4>
<p>The linter should not be disabled for the section, and <code>fork_map</code> shouldn't be <code>nolint</code> either.</p>



<a name="257240988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257240988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257240988">(Oct 12 2021 at 17:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves/near/257237215">said</a>:</p>
<blockquote>
<p>I think that's right <span class="user-mention silent" data-user-id="110032">Reid Barton</span> :</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">fork_map._proof_1</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">category</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_3</span> <span class="o">:</span> <span class="n">has_products</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_3</span> <span class="n">u_1</span><span class="o">)),</span>
    <span class="n">has_limits_of_shape</span> <span class="o">(</span><span class="n">discrete</span> <span class="n">J</span><span class="o">)</span> <span class="n">A</span>
</code></pre></div><br>
</p>
</blockquote>
<p>The reason this is a bad lemma (or would be if it wasn't just an abbreviation to make the definition of <code>fork_map</code> smaller) is the following: if you wrote <code>fork_map._proof_1 J</code> for some <code>J : Type u</code>, then Lean would first instantiate the type with universe metavariables like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">fork_map._proof_1</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">category</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_3</span> <span class="o">:</span> <span class="n">has_products</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="bp">?</span><span class="n">u_3</span> <span class="bp">?</span><span class="n">u_1</span><span class="o">)),</span>
    <span class="n">has_limits_of_shape</span> <span class="o">(</span><span class="n">discrete</span> <span class="n">J</span><span class="o">)</span> <span class="n">A</span>
</code></pre></div>
<p>Then it would make sure that the type of <code>J</code> is defeq to the argument type of <code>fork_map._proof_1</code>.  That is, unify <code>Type u</code> and <code>Type (max ?u_3 ?u_1)</code>.  And this is where it fails, since there is no good canonical solution to make <code>u</code> and <code>max ?u_3 ?u_1</code> equal.  (Some possible assignments would be <code>?u_1 := u, ?u_3 = u</code> or <code>?u_1 := 0, ?u_3 := u</code> or <code>?u_1 := u, ?u_3 := 0</code>).</p>



<a name="257241421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257241421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257241421">(Oct 12 2021 at 17:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> Oh, I understand that.</p>



<a name="257241468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257241468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257241468">(Oct 12 2021 at 17:32)</a>:</h4>
<p>But it's not an issue in this particular case, since, as you say, it's an abbreviation used in the definition of <code>fork_map</code>.</p>



<a name="257241583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257241583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257241583">(Oct 12 2021 at 17:33)</a>:</h4>
<p>And the linter doesn't complain about <code>fork_map</code> itself (as it should be!)</p>



<a name="257241809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257241809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257241809">(Oct 12 2021 at 17:34)</a>:</h4>
<p>It would probably take me too much time to figure out how to modify the linter to ignore declarations named <code>*._proof_*</code>. I think it was <span class="user-mention" data-user-id="111080">@Floris van Doorn</span> who wrote the <code>check_univs</code> linter?</p>



<a name="257244008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244008">(Oct 12 2021 at 17:49)</a>:</h4>
<p>I think that</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gh">diff --git a/src/tactic/lint/misc.lean b/src/tactic/lint/misc.lean</span>
<span class="gh">index e12c37fba9..2f04ca1f2e 100644</span>
<span class="gd">--- a/src/tactic/lint/misc.lean</span>
<span class="gi">+++ b/src/tactic/lint/misc.lean</span>
<span class="gu">@@ -303,6 +303,8 @@ a higher universe level than `α`.</span>
 meta def check_univs (d : declaration) : tactic (option string) := do
   let l := d.type.univ_params_grouped.union d.value.univ_params_grouped,
   let bad := bad_params l,
<span class="gi">+  -- autogenerated subproof declarations can and may contain "bad" universe parameters</span>
<span class="gi">+  if "proof" ∈ d.to_name.to_string.split_on '_' then return none else</span>
   if bad.empty then return none else return $ some $ "universes " ++ to_string bad ++
   " only occur together."
</code></pre></div>
<p>should do it</p>



<a name="257244024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244024">(Oct 12 2021 at 17:49)</a>:</h4>
<p>But this is cargo</p>



<a name="257244189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244189">(Oct 12 2021 at 17:50)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/9676">#9676</a></p>



<a name="257244209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244209">(Oct 12 2021 at 17:50)</a>:</h4>
<p>But what If I make up a theorem called <code>proof_one_is_proof_two</code> with bad universes?</p>



<a name="257244314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244314">(Oct 12 2021 at 17:51)</a>:</h4>
<p>That's a risk</p>



<a name="257244379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244379">(Oct 12 2021 at 17:51)</a>:</h4>
<p>fair enough. I guess the linter won't catch every little thing, but it's a good compromise IMO</p>



<a name="257244520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244520">(Oct 12 2021 at 17:52)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ rg <span class="s2">"^theorem.*proof"</span>
src/logic/basic.lean
<span class="m">689</span>:theorem proof_irrel_heq <span class="o">{</span>p q : Prop<span class="o">}</span> <span class="o">(</span>hp : p<span class="o">)</span> <span class="o">(</span>hq : q<span class="o">)</span> : <span class="nv">hp</span> <span class="o">==</span> hq :<span class="o">=</span>

src/data/erased.lean
<span class="m">42</span>:theorem out_proof <span class="o">{</span>p : Prop<span class="o">}</span> <span class="o">(</span>a : erased p<span class="o">)</span> : p :<span class="o">=</span> out a

archive/imo/imo2006_q3.lean
<span class="m">90</span>:theorem subst_proof₁ <span class="o">(</span>x y z s : ℝ<span class="o">)</span> <span class="o">(</span>hxyz : x + y + <span class="nv">z</span> <span class="o">=</span> <span class="m">0</span><span class="o">)</span> :
<span class="m">111</span>:theorem proof₁ <span class="o">{</span>a b c : ℝ<span class="o">}</span> :
<span class="m">118</span>:theorem proof₂ <span class="o">(</span>M : ℝ<span class="o">)</span>
</code></pre></div>



<a name="257244596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244596">(Oct 12 2021 at 17:53)</a>:</h4>
<p>With <code>lemma</code> there are no occurences</p>



<a name="257244836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244836">(Oct 12 2021 at 17:55)</a>:</h4>
<p>Isn't there some notion of an "internal" declaration, one whose last name part starts with <code>_</code></p>



<a name="257244895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257244895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257244895">(Oct 12 2021 at 17:55)</a>:</h4>
<p>you're not supposed to use those directly, so it doesn't matter if you would have to specify universe levels to do so</p>



<a name="257245088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245088">(Oct 12 2021 at 17:56)</a>:</h4>
<p>Gabriel fixed it to</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="c1">-- autogenerated subproof declarations can and may contain "bad" universe parameters</span>
  <span class="k">if</span> <span class="n">d.to_name.last.starts_with</span> <span class="s2">"_proof_"</span> <span class="k">then</span> <span class="n">return</span> <span class="n">none</span> <span class="k">else</span>
</code></pre></div>
<p>on github</p>



<a name="257245090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245090">(Oct 12 2021 at 17:56)</a>:</h4>
<p>I think we still want the linter for equation lemmas (which have <code>_eqn_1</code> etc.)</p>



<a name="257245163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245163">(Oct 12 2021 at 17:57)</a>:</h4>
<p><code>d.to_name.is_internal</code></p>



<a name="257245225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245225">(Oct 12 2021 at 17:57)</a>:</h4>
<p>hmm, because simp/rw will try to apply them and then get stuck?</p>



<a name="257245276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245276">(Oct 12 2021 at 17:58)</a>:</h4>
<p>Yes!</p>



<a name="257245400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245400">(Oct 12 2021 at 17:58)</a>:</h4>
<p>Not sure if that can actually happen though (if the main declaration already passes the linter).</p>



<a name="257245407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245407">(Oct 12 2021 at 17:58)</a>:</h4>
<p>Is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">meta</span> <span class="kd">def</span> <span class="n">check_univs</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">declaration</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">option</span> <span class="n">string</span><span class="o">)</span> <span class="o">:=</span>
<span class="c1">-- autogenerated subproof declarations can and may contain "bad" universe parameters</span>
<span class="k">if</span> <span class="n">d.to_name.last.starts_with</span> <span class="s2">"_proof_"</span> <span class="k">then</span> <span class="n">return</span> <span class="n">none</span> <span class="k">else</span> <span class="k">do</span>
  <span class="k">let</span> <span class="n">l</span> <span class="o">:=</span> <span class="n">d.type.univ_params_grouped.union</span> <span class="n">d.value.univ_params_grouped</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">bad</span> <span class="o">:=</span> <span class="n">bad_params</span> <span class="n">l</span><span class="o">,</span>
  <span class="k">if</span> <span class="n">bad.empty</span> <span class="k">then</span> <span class="n">return</span> <span class="n">none</span> <span class="k">else</span>
    <span class="n">return</span> <span class="bp">$</span> <span class="n">some</span> <span class="bp">$</span> <span class="s2">"universes "</span> <span class="bp">++</span> <span class="n">to_string</span> <span class="n">bad</span> <span class="bp">++</span> <span class="s2">" only occur together."</span>
</code></pre></div>
<p>better from a performance perspective?</p>



<a name="257245430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245430">(Oct 12 2021 at 17:58)</a>:</h4>
<p>I guess it doesn't matter much, but it moves the check to the start.</p>



<a name="257245464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245464">(Oct 12 2021 at 17:59)</a>:</h4>
<p>Right, it doesn't matter.  It's already fast enough.</p>



<a name="257245482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245482">(Oct 12 2021 at 17:59)</a>:</h4>
<p>Why not just test for <code>d.to_name.is_internal</code> and for <code>_proof_</code>?</p>



<a name="257245662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245662">(Oct 12 2021 at 18:00)</a>:</h4>
<p>That conjunction is equivalent to the current test.</p>



<a name="257245685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245685">(Oct 12 2021 at 18:00)</a>:</h4>
<p>Well, non-internal names shouldn't start with <code>_</code>, so checking for <code>is_internal</code> seems redundant</p>



<a name="257245719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245719">(Oct 12 2021 at 18:00)</a>:</h4>
<p>Ah good point</p>



<a name="257245778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245778">(Oct 12 2021 at 18:00)</a>:</h4>
<p>(<code>name.is_internal</code> is literally defined as "some component starts with an underscore" btw)</p>



<a name="257245942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257245942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257245942">(Oct 12 2021 at 18:01)</a>:</h4>
<p>I'll add <a href="https://github.com/leanprover-community/mathlib/issues/9676">#9676</a> as a dependency to my PR</p>



<a name="257247424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257247424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257247424">(Oct 12 2021 at 18:11)</a>:</h4>
<p>If <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a> passes CI, that's a good test that <a href="https://github.com/leanprover-community/mathlib/issues/9676">#9676</a> does what it intends to do.</p>



<a name="257272841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257272841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257272841">(Oct 12 2021 at 21:11)</a>:</h4>
<p>FYI: Linting passed on <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a> (the dependent issue is the only thing left)</p>



<a name="257349934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257349934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257349934">(Oct 13 2021 at 11:37)</a>:</h4>
<p>Checking the <code>_proof_</code> parts is definitely intentional. <br>
The reason was that the linter found many bad lemmas only because the <code>_proof_i</code> sublemmas were bad: the proof of the main lemma was not bad, because it applies the bad <code>_proof_i</code> lemma to the individual universes.</p>
<p>This example is very troubling though, it means that the lemma itself can be fine, even though it generated bad <code>_proof_i</code> lemmas. Let me investigate if there is a better fix than "turn off the linter for all <code>_proof_i</code> lemmas.</p>



<a name="257352153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257352153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257352153">(Oct 13 2021 at 11:57)</a>:</h4>
<p>Do you have an example of a bad lemma where the linter only detected the badness via a <code>_proof_i</code> lemma?<br>
Also, does it matter at all whether the main declaration is a lemma or a definition?</p>



<a name="257352442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257352442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257352442">(Oct 13 2021 at 11:59)</a>:</h4>
<p>I guess if <code>main._proof_i</code> is bad but ignored, then <code>main</code> will be considered "not bad", since it relies on <code>main._proof_i</code> which is now considered "good" by decree.</p>



<a name="257352645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257352645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257352645">(Oct 13 2021 at 12:01)</a>:</h4>
<p>Sorry, I should read more carefully. This is exactly what Floris also said.</p>



<a name="257352761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257352761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257352761">(Oct 13 2021 at 12:01)</a>:</h4>
<p>I don't understand why the right-hand side of the main declaration matters at all (especially if it is a lemma!). I thought the issue was with Lean inferring universe variables at a use site, and that process should only depend on the type and not the right-hand side.</p>



<a name="257353267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353267">(Oct 13 2021 at 12:05)</a>:</h4>
<p>What about a simple def like <code>def {u v} foo : Type (max u v) := ulift.{v} pempty.{u}</code>? This will trigger the linter if it ignores the RHS</p>



<a name="257353452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353452">(Oct 13 2021 at 12:06)</a>:</h4>
<p>I can imagine examples of lemmas where the proof requires two universes but they only appear together in the statement</p>



<a name="257353646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353646">(Oct 13 2021 at 12:08)</a>:</h4>
<p>Doesn't <code>foo.{u, v}</code> count as "not appearing together"?</p>



<a name="257353719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353719">(Oct 13 2021 at 12:08)</a>:</h4>
<p>here I'm talking about <code>foo</code> itself being flagged</p>



<a name="257353784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353784">(Oct 13 2021 at 12:09)</a>:</h4>
<p>But you were talking about a definition.</p>



<a name="257353785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353785">(Oct 13 2021 at 12:09)</a>:</h4>
<p>every def has distinct universe parameters, by definition</p>



<a name="257353863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257353863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257353863">(Oct 13 2021 at 12:10)</a>:</h4>
<p>If <code>foo</code> was a lemma, it would be a bad lemma and its type should be <code>Type u</code> instead.  (which subsumes the bad version)</p>



<a name="257354016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354016">(Oct 13 2021 at 12:10)</a>:</h4>
<p>FWIW, the original culprit <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.presheaf.fork_map">docs#category_theory.presheaf.fork_map</a> is a definition not a lemma (unless it changed in the PR, which seems unlikely)</p>



<a name="257354025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354025">(Oct 13 2021 at 12:11)</a>:</h4>
<p>(If a statement of a lemma only mentions <code>max u v</code> but not <code>u</code> or <code>v</code> separately, then you can just substitute <code>v := u</code> and get a better version.)</p>



<a name="257354100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354100">(Oct 13 2021 at 12:11)</a>:</h4>
<p>I suppose that's fair. So then the rule is to ignore the RHS for lemmas (or rather, things of <code>Prop</code> type) but not defs?</p>



<a name="257354116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354116">(Oct 13 2021 at 12:12)</a>:</h4>
<blockquote>
<p>The reason was that the linter found many bad lemmas only because the _proof_i sublemmas were bad: the proof of the main lemma was not bad, because it applies the bad _proof_i lemma to the individual universes.</p>
</blockquote>
<p>The <code>_proof_i</code> auxiliary declarations are only generated for definitions, not lemmas.</p>



<a name="257354242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354242">(Oct 13 2021 at 12:12)</a>:</h4>
<p>I'm wondering if there is a way to analyze the <code>_proof_i</code> lemmas as if they were inlined into their parent</p>



<a name="257354300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354300">(Oct 13 2021 at 12:13)</a>:</h4>
<p>so they aren't penalized for using two universes together as long as they are used separately in <code>_proof_j</code> or in the main declaration</p>



<a name="257354467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354467">(Oct 13 2021 at 12:14)</a>:</h4>
<p>They <em>are</em> bad lemmas, but it's okay here because they will only be used in this one place and lean went to the trouble of passing the universe parameters correctly</p>



<a name="257354549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354549">(Oct 13 2021 at 12:15)</a>:</h4>
<p>Yes, I was also thinking of strengthening the linter to not check the values (RHSs) of theorems.</p>



<a name="257354598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354598">(Oct 13 2021 at 12:16)</a>:</h4>
<p>Mario's <code>foo</code> is in a gray area where some uses of <code>foo</code> will be ambiguous (e.g. <code>cardinal.mk foo</code>) while others won't (I guess, hard to come up with a specific example). I'm not quite sure what direction you're arguing, are you saying the linter currently flags it but shouldn't?</p>



<a name="257354751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354751">(Oct 13 2021 at 12:17)</a>:</h4>
<p>But I don't understand how this is an example of what I was asking about, namely a definition that the linter would accept if it ignores the RHS but reject if it looks at the RHS.</p>



<a name="257354765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354765">(Oct 13 2021 at 12:17)</a>:</h4>
<p>I would guess that most uses of <code>foo</code> will need explicit universes, because it has universe variables in the type that don't appear in any arguments</p>



<a name="257354806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354806">(Oct 13 2021 at 12:17)</a>:</h4>
<p>That's true just as well for <code>ordinal</code> and <code>cardinal</code></p>



<a name="257354822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257354822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257354822">(Oct 13 2021 at 12:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves/near/257352153">said</a>:</p>
<blockquote>
<p>Do you have an example of a bad lemma where the linter only detected the badness via a <code>_proof_i</code> lemma?<br>
Also, does it matter at all whether the main declaration is a lemma or a definition?</p>
</blockquote>
<p>See <a href="https://github.com/leanprover-community/mathlib/runs/3332764188">https://github.com/leanprover-community/mathlib/runs/3332764188</a> and <a href="https://github.com/leanprover-community/mathlib/pull/8677">https://github.com/leanprover-community/mathlib/pull/8677</a></p>



<a name="257355037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355037">(Oct 13 2021 at 12:19)</a>:</h4>
<p>I see. From my perspective, the problem is that the linter ever looks at the RHS at all.</p>



<a name="257355081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355081">(Oct 13 2021 at 12:19)</a>:</h4>
<p>Mario's <code>foo</code> is allowed. I think definitions like that are used in mathlib.</p>



<a name="257355109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355109">(Oct 13 2021 at 12:19)</a>:</h4>
<p>If it didn't, then it would have caught the old <code>uniform_space_of_compact_t2</code> as only using universe variables together.</p>



<a name="257355282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355282">(Oct 13 2021 at 12:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="111080">Floris van Doorn</span> <a href="#narrow/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves/near/257355081">said</a>:</p>
<blockquote>
<p>Mario's <code>foo</code> is allowed. I think definitions like that are used in mathlib.</p>
</blockquote>
<p>Hmm are there really? How hard would it be to modify the linter to ignore the RHS and see what it reports?</p>



<a name="257355357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355357">(Oct 13 2021 at 12:21)</a>:</h4>
<p>We can always mark things like Mario's <code>foo</code> with <code>nolint</code> if we want to allow them... overall, I think that would result in something easier to understand</p>



<a name="257355370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355370">(Oct 13 2021 at 12:21)</a>:</h4>
<p>easy, let me do that</p>



<a name="257355539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355539">(Oct 13 2021 at 12:22)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> Is it possible to make the analysis compositional enough to go over multiple definitions at once? For example, you analyze <code>bar._proof_1.{u, v}</code> and see that <code>u</code> and <code>v</code> are only used together. Normally this would be flagged, but since it is a <code>proof_i</code> we instead record this fact and when analyzing <code>bar</code> and get to the application <code>bar._proof_1.{u, v}</code> we pretend it says <code>thing.{max u v}</code> instead, i.e. it counts as a use of u and v together, so as long as <code>u</code> and <code>v</code> are used separately somewhere else we're okay but the call itself is not enough to make them separate</p>



<a name="257355983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257355983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257355983">(Oct 13 2021 at 12:25)</a>:</h4>
<p>I don't think that when folding a function over the environment, I can guarantee that <code>bar._proof_1</code> is visited before <code>bar</code>. But it's definitely possible (though maybe a little tricky) when checking <code>bar</code> to unfold all <code>bar._proof_i</code>'s and just not check the <code>bar._proof_i</code>'s by themselves</p>



<a name="257356202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356202">(Oct 13 2021 at 12:27)</a>:</h4>
<p>Reid's solution is easier though, if it works well enough</p>



<a name="257356350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356350">(Oct 13 2021 at 12:28)</a>:</h4>
<p>Ok, Reid's suggestion has few positives. I don't know which of them are false positives:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- C:\Users\Floris\.elan\toolchains\leanprover-community--lean---3.33.0\lib\lean\library\init\core.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">unification_hint</span> <span class="c">/-</span><span class="cm"> universes [u_1, u_2] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\category_theory\category\Cat.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">category_theory.Cat</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\category_theory\category\Groupoid.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">category_theory.Groupoid</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\category_theory\category\Quiv.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">category_theory.Quiv</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\model_theory\basic.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">first_order.language</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\set_theory\ordinal.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">ordinal.univ</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">cardinal.univ</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>

<span class="c1">-- d:\projects\mathlib2\src\set_theory\zfc.lean</span>
<span class="k">#check</span> <span class="bp">@</span><span class="n">pSet.embed</span> <span class="c">/-</span><span class="cm"> universes [v, u] only occur together. -/</span>
</code></pre></div>



<a name="257356481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356481">(Oct 13 2021 at 12:29)</a>:</h4>
<p>they are all false positives, but it's pretty limited</p>



<a name="257356539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356539">(Oct 13 2021 at 12:29)</a>:</h4>
<p><code>unification_hint</code> is a true positive</p>



<a name="257356629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356629">(Oct 13 2021 at 12:30)</a>:</h4>
<p>not that it matters much</p>



<a name="257356672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356672">(Oct 13 2021 at 12:30)</a>:</h4>
<p><code>first_order.language</code> is also a true positive (and <code>nolint</code> right now)</p>



<a name="257356736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356736">(Oct 13 2021 at 12:31)</a>:</h4>
<p>Now I think I misunderstood the point of the <code>foo</code> example. The idea would be that <code>foo</code> is intended to be used with explicit universe parameters, right? Not that it would only be used in ways where the universe parameters could be inferred.<br>
In that case, maybe it is better anyways to explicitly acknowledge this (using <code>nolint</code>) rather than leaving it up to the linter to guess our intent.</p>



<a name="257356973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257356973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257356973">(Oct 13 2021 at 12:33)</a>:</h4>
<p>The use of two universes in <code>first_order.language</code> is clearly deliberate, but it seems unnecessary</p>



<a name="257357143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257357143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257357143">(Oct 13 2021 at 12:34)</a>:</h4>
<p>All the other examples look like they should be <code>nolint</code>ed explicitly</p>



<a name="257357220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257357220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257357220">(Oct 13 2021 at 12:35)</a>:</h4>
<p>Note that Reid's suggestion doesn't 100% solve the problem: I noticed in the titular PR <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a> that some of the <code>_proof_i</code> declarations actually occur in the type of the definition (this seems to happen for type-class instances, for some reason). So it's still possible to make a definition with a type with bad universes, but if a <code>_proof_i</code> occurs in the type, then it will not be flagged as such because the <code>_proof_i</code> declaration has "separated" all universe variables</p>



<a name="257357392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257357392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257357392">(Oct 13 2021 at 12:36)</a>:</h4>
<p>What happens if we ignore the <code>_proof_i</code> <em>constants</em> in the linter?  (That is, don't count <code>foo._proof_1.{u,v}</code> as separating <code>u</code> and <code>v</code>?)</p>



<a name="257357524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257357524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257357524">(Oct 13 2021 at 12:37)</a>:</h4>
<p>Nice idea! That should work, and be a little easier.</p>



<a name="257357998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257357998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257357998">(Oct 13 2021 at 12:40)</a>:</h4>
<p>Shall I just merge Johan's fix (so that this PR can move forward), and then write my fix on top of that?</p>



<a name="257358842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257358842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257358842">(Oct 13 2021 at 12:48)</a>:</h4>
<p>Won't that cause false positives?</p>



<a name="257358950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257358950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257358950">(Oct 13 2021 at 12:48)</a>:</h4>
<p>It seems that CI passed on <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a>...</p>



<a name="257358958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257358958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257358958">(Oct 13 2021 at 12:48)</a>:</h4>
<p>No, because Johan's fix makes the linter weaker, and then with my fix I'll nolint the false positives</p>



<a name="257359019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257359019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257359019">(Oct 13 2021 at 12:49)</a>:</h4>
<p>(that was a response to Gabriel's suggestion, btw)</p>



<a name="257359251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257359251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257359251">(Oct 13 2021 at 12:50)</a>:</h4>
<p>Ignoring the <code>_proof_i</code> constants is actually closer to the intent of the linter: the unifier probably can't use them to infer the universe levels anyhow due to proof irrelevance.  Either you're using a different proof anyhow, or the unifier just skips the subterm.</p>



<a name="257359454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257359454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257359454">(Oct 13 2021 at 12:52)</a>:</h4>
<p>does that apply more generally to all subterms that are proofs (but not necessarily <code>_proof</code>s)?</p>



<a name="257361467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257361467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257361467">(Oct 13 2021 at 13:06)</a>:</h4>
<p>I would say yes, just like the RHS of lemmas.</p>



<a name="257361965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257361965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257361965">(Oct 13 2021 at 13:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves/near/257245090">said</a>:</p>
<blockquote>
<p>I think we still want the linter for equation lemmas (which have <code>_eqn_1</code> etc.)</p>
</blockquote>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> do you agree we can turn off the new version of the linter on equation lemmas. I think it's impossible for a definition to pass the linter but a corresponding equation lemma to fail the linter?</p>



<a name="257362060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257362060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257362060">(Oct 13 2021 at 13:10)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/9698">#9698</a></p>



<a name="257362215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257362215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257362215">(Oct 13 2021 at 13:11)</a>:</h4>
<p>My guess is it should be fine, but I wouldn't be surprised if there were corner cases (well-founded recursion maybe?).</p>



<a name="257362486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257362486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257362486">(Oct 13 2021 at 13:13)</a>:</h4>
<p>I think <code>_match</code> declarations also fall under "automatically generated", so it won't check equation lemmas there at all.</p>



<a name="257362538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257362538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257362538">(Oct 13 2021 at 13:13)</a>:</h4>
<p>I <em>think</em> in equation lemmas we always have the definition itself on the LHS with all the universes separately, so I expect that equation lemmas always pass.</p>



<a name="257363687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257363687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257363687">(Oct 13 2021 at 13:21)</a>:</h4>
<p>For top-level definitions, yes.  However the auxiliary definitions for the matches are ignored by the linter in the new PR.</p>



<a name="257369196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257369196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257369196">(Oct 13 2021 at 13:56)</a>:</h4>
<p>but that might be desirable: maybe we want to write a match that doesn't use all universe levels</p>



<a name="257369624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257369624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257369624">(Oct 13 2021 at 13:58)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> How would you like to coordinate <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a> and <a href="https://github.com/leanprover-community/mathlib/issues/9698">#9698</a> ? Would you like me to add <a href="https://github.com/leanprover-community/mathlib/issues/9698">#9698</a> as a dependency for <a href="https://github.com/leanprover-community/mathlib/issues/9675">#9675</a> ?</p>



<a name="257369721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257369721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257369721">(Oct 13 2021 at 13:58)</a>:</h4>
<p>I think they're independent of each other, neither one has to be a dependency of the other.</p>



<a name="257369837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257369837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257369837">(Oct 13 2021 at 13:59)</a>:</h4>
<p>You're not expecting additional <code>nolint</code>'s to be necessary?</p>



<a name="257370058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257370058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257370058">(Oct 13 2021 at 14:00)</a>:</h4>
<p>no, the declarations you changed should be accepted by the new linter</p>



<a name="257370105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%239675%20generalize%20universes%20for%20sheaves/near/257370105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.239675.20generalize.20universes.20for.20sheaves.html#257370105">(Oct 13 2021 at 14:00)</a>:</h4>
<p>Great</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>