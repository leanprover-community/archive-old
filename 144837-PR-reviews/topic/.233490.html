---
layout: archive
title: Zulip Chat Archive
permalink: /stream/144837-PR-reviews/topic/.233490.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/index.html">PR reviews</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html">#3490</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="214298693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214298693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214298693">(Oct 23 2020 at 10:57)</a>:</h4>
<p>This PR had been sitting around for a while - it introduces some ugly underscores in a few places, but without it <code>dfinsupp.to_semimodule</code> is useless to me. Can we just tolerate the three underscore warts in exchange for having the more useful generalization?</p>



<a name="214301507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214301507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214301507">(Oct 23 2020 at 11:33)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> you wrote on that PR. What do you think of Eric's reply?</p>



<a name="214301583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214301583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214301583">(Oct 23 2020 at 11:34)</a>:</h4>
<p>My only worry is that the transition that Eric describes might take a lot of time and effort. But I'm not sure how heavy that weighs.</p>



<a name="214693813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214693813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214693813">(Oct 27 2020 at 12:46)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> seems fine with this - does anyone else want to take a look, or can we just put it in?</p>



<a name="214694852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214694852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214694852">(Oct 27 2020 at 12:57)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> <span class="user-mention" data-user-id="310045">@Eric Wieser</span> LGTM</p>



<a name="214705786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214705786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214705786">(Oct 27 2020 at 14:22)</a>:</h4>
<p>So it is understood how to get rid of all those new <code>_</code>s? Can they not be removed in this PR too? Is the point that this is for some reason hard? Why were they not necessary before?</p>



<a name="214715722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214715722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214715722">(Oct 27 2020 at 15:26)</a>:</h4>
<p>I think the type argument <code>G</code> could be inferred from the local <code>add_comm_group G</code> instances. Now that the definition takes <code>add_comm_monoid G</code> instances, the elaborator isn't smart enough to extract G for us</p>



<a name="214715776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214715776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214715776">(Oct 27 2020 at 15:26)</a>:</h4>
<p>At any rate, I don't think we should hold up useful generalization just because of fear of a few underscores</p>



<a name="214715906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214715906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214715906">(Oct 27 2020 at 15:27)</a>:</h4>
<p>I'm very reluctant to put more work into generalizing if the conclusion is "sorry, the net underscore count went up, please generalize even more of the universe"</p>



<a name="214716507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214716507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214716507">(Oct 27 2020 at 15:31)</a>:</h4>
<p><code>dfinsupp.support_smul</code> clearly has too many implicits though</p>



<a name="214716571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214716571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214716571">(Oct 27 2020 at 15:31)</a>:</h4>
<p><code>b</code> and <code>v</code> should be explicit by our standard rule</p>



<a name="214718011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214718011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214718011">(Oct 27 2020 at 15:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/144837-PR-reviews/topic/.233490/near/214715906">said</a>:</p>
<blockquote>
<p>I'm very reluctant to put more work into generalizing if the conclusion is "sorry, the net underscore count went up, please generalize even more of the universe"</p>
</blockquote>
<p>Speaking generally, the problem isn't that the PR increases the number of underscores in mathlib (we have an infinite supply of those), but that it apparently doesn't work any more to just use <code>simp only [smul_apply]</code> where it used to, which is going to cause some poor future user who wants to write something similar to <code>instance : lie_algebra R (⨁ i, L i)</code> to be even more confused than you were when they get an error, because they don't have the context of "oh the implicitness of arguments to <code>smul_apply</code> just changed".</p>



<a name="214724716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214724716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214724716">(Oct 27 2020 at 16:23)</a>:</h4>
<p>So what's accepted as a path forward here? Making the <code>β</code> argument explicit?</p>



<a name="214732952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214732952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214732952">(Oct 27 2020 at 17:17)</a>:</h4>
<p>Put it in anyway, and wait until someone complains about trying to do something similar to <code>instance : lie_algebra R (⨁ i, L i)</code> before worrying?</p>



<a name="214733235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733235">(Oct 27 2020 at 17:19)</a>:</h4>
<p><code>b,v,i</code> should all be explicit in <code>smul_apply</code></p>



<a name="214733506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733506">(Oct 27 2020 at 17:21)</a>:</h4>
<p>The argument being that even if they are explicit <code>rw smul_apply</code> will try to fill them in, so users shouldn't have to care?</p>



<a name="214733577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733577">(Oct 27 2020 at 17:21)</a>:</h4>
<p>In general, I think that we should make more arguments explicit than we typically do.</p>



<a name="214733648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733648">(Oct 27 2020 at 17:22)</a>:</h4>
<p>the standard rule is that anything which can't be inferred by subsequent hypotheses should be explicit</p>



<a name="214733747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733747">(Oct 27 2020 at 17:22)</a>:</h4>
<p>Eg in <code>iff</code> statements, it doesn't hurt to make things more explicit, because you don't need to feed them to <code>rw</code> or <code>simp</code>. But if you want to do <code>have foo := some_lemma_iff</code> then it's great if <code>(a  b c : R)</code> are explicit by default.</p>



<a name="214733833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733833">(Oct 27 2020 at 17:23)</a>:</h4>
<p>the exception rule for iff is that a variable is allowed to be implicit if it would be implicit in both the <code>.mp</code> and <code>.mpr</code> versions of the lemma</p>



<a name="214733917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214733917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214733917">(Oct 27 2020 at 17:24)</a>:</h4>
<p>But even then, I often want to provide the <code>c</code>, and <code>_ : 0 &lt; c</code> should become a new goal.</p>



<a name="214734004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734004">(Oct 27 2020 at 17:24)</a>:</h4>
<p>Now you need to jump through little hoops to make it work</p>



<a name="214734126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734126">(Oct 27 2020 at 17:25)</a>:</h4>
<p>that's true, although the circumstances in which you want to do that are varied and difficult to make simple rules for</p>



<a name="214734306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734306">(Oct 27 2020 at 17:26)</a>:</h4>
<p>But adding an occasional <code>_</code> is cheap. Whereas writing <code>@some_lemma_iff _ _ _ _ _ _ _ _ _ _ a b c _</code> is ugly.</p>



<a name="214734502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734502">(Oct 27 2020 at 17:27)</a>:</h4>
<p>one way would be to say that neither hypotheses nor conclusion are allowed to affect the implicitness, but that seems like it will go way overboard in most situations</p>



<a name="214734574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734574">(Oct 27 2020 at 17:27)</a>:</h4>
<p>i.e. it won't be "an occasional <code>_</code>", it will be in almost every lemma</p>



<a name="214734725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214734725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214734725">(Oct 27 2020 at 17:28)</a>:</h4>
<p>I think a better solution is another implicitness mode (<code>@@@</code>?)</p>



<a name="214737068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214737068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214737068">(Oct 27 2020 at 17:44)</a>:</h4>
<p>I made some arguments explicit in <a href="https://github.com/leanprover-community/mathlib/issues/4803">#4803</a></p>



<a name="214859879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214859879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214859879">(Oct 28 2020 at 16:14)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.has_coe_to_fun/src">src#direct_sum.has_coe_to_fun</a> seems like it was snuck in at the end of the file. Is this actually supposed to be supported? That is, do we want to have <code>x i : M i</code>  where <code>x : ⨁ i, M i</code> to mean the projection, or should this be an explicit function? It seems similar to polynomials in some respects.</p>



<a name="214870996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214870996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214870996">(Oct 28 2020 at 17:30)</a>:</h4>
<p>Hardly snuck in, it's been there for at least two years: <a href="https://github.com/leanprover-community/mathlib/blame/de6a9d419dc190e34a51fc55aff6576dfed8b82f/src/algebra/direct_sum.lean#L159">https://github.com/leanprover-community/mathlib/blame/de6a9d419dc190e34a51fc55aff6576dfed8b82f/src/algebra/direct_sum.lean#L159</a></p>



<a name="214871089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214871089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214871089">(Oct 28 2020 at 17:30)</a>:</h4>
<p>after some investigation, it's actually been there from the beginning</p>



<a name="214871170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214871170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214871170">(Oct 28 2020 at 17:31)</a>:</h4>
<p>Yep, even <a href="https://github.com/leanprover-community/mathlib/commit/89431cf4f01ff0f6b4005f96795a23571258cbf0">https://github.com/leanprover-community/mathlib/commit/89431cf4f01ff0f6b4005f96795a23571258cbf0</a> has it</p>



<a name="214872547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214872547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214872547">(Oct 28 2020 at 17:40)</a>:</h4>
<p>There used to be such a coe for polynomials as well.</p>



<a name="214872600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214872600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214872600">(Oct 28 2020 at 17:41)</a>:</h4>
<p>But I think it was way to confusing. Because that's not the way you want to think of polynomials as functions.</p>



<a name="214948913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214948913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214948913">(Oct 29 2020 at 10:26)</a>:</h4>
<p>Now that almost all the new underscores are gone, any objections to merging it (after fixing merge conflicts)?</p>



<a name="214949074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214949074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214949074">(Oct 29 2020 at 10:29)</a>:</h4>
<p>conflicts resolved, lgtm</p>



<a name="214949617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214949617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214949617">(Oct 29 2020 at 10:35)</a>:</h4>
<p>Thanks for working out the problem was a lack of <code>direct_sum</code> lemmas <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, and the elaborator's inability to unfold <code>dfinsupp</code> into <code>direct_sum</code> without extra help</p>



<a name="214949774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214949774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214949774">(Oct 29 2020 at 10:37)</a>:</h4>
<p>Can I get a <code>bors d+</code> if there are no other comments?</p>



<a name="214949775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214949775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214949775">(Oct 29 2020 at 10:37)</a>:</h4>
<p>well, it's a design question actually. Is one supposed to be a transparent wrapper around the other or not? If you create a non-<code>reducible</code> type alias then it seems that the answer is that it is different, which means when you define a new add and a new coe, you need a new add/coe lemma</p>



<a name="214949942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214949942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214949942">(Oct 29 2020 at 10:39)</a>:</h4>
<p>My opinion is that <code>direct_sum</code> should probably just be an <code>alias</code> / <code>abbreviation</code> - as far as I can tell, there is no part of the <code>direct_sum</code> API that doesn't already have an analogue in <code>finsupp</code>, and should therefore also be part of the <code>dfinsupp</code> API. Once my decaying stack of finsupp PRs crosses the finish line, I'll have a go at adding them to <code>dfinsupp</code> and see what remains</p>



<a name="214950272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214950272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214950272">(Oct 29 2020 at 10:43)</a>:</h4>
<p>I don't think that design question should hold up 3490 though</p>



<a name="214950383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214950383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214950383">(Oct 29 2020 at 10:44)</a>:</h4>
<p><code>direct_sum</code> is a module, <code>finsupp</code> is not</p>



<a name="214950418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214950418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214950418">(Oct 29 2020 at 10:44)</a>:</h4>
<p>(actually it's only a semimodule, even though there is literally a file called <code>direct_sum_module</code>. What's up with that?)</p>



<a name="214950781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214950781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214950781">(Oct 29 2020 at 10:49)</a>:</h4>
<p>Indeed, the design needs a good cleanup. But let's do that in a new PR.</p>



<a name="214951129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214951129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214951129">(Oct 29 2020 at 10:53)</a>:</h4>
<p>finsupp is a module though, <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.semimodule">docs#finsupp.semimodule</a></p>



<a name="214951144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214951144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214951144">(Oct 29 2020 at 10:53)</a>:</h4>
<p>(<code>finsupp</code> has a module instance, <code>dfinsupp</code> has a module <code>def</code> which is not an instance.)</p>



<a name="214951203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214951203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214951203">(Oct 29 2020 at 10:54)</a>:</h4>
<p>(<a href="https://github.com/leanprover-community/mathlib/issues/4801">#4801</a> makes it an instance for consistency with finsupp)</p>



<a name="214965082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214965082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214965082">(Oct 29 2020 at 13:23)</a>:</h4>
<p>CI is green on <a href="https://github.com/leanprover-community/mathlib/issues/3490">#3490</a>. Is anything else needed?</p>



<a name="214965378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%233490/near/214965378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/144837-PR-reviews/topic/.233490.html#214965378">(Oct 29 2020 at 13:25)</a>:</h4>
<p>Thanks!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>