[
    {
        "content": "<p>I had a question about exercise 0037 in the Massot tutorial. The solution is</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">-- A sequence admits at most one limit</span>\n<span class=\"c1\">-- 0037</span>\n<span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l&#39;</span> <span class=\"bp\">→</span> <span class=\"n\">l</span> <span class=\"bp\">=</span> <span class=\"n\">l&#39;</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">eq_of_abs_sub_le_all</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">ε_pos</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N</span> <span class=\"n\">hN</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp&#39;</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N&#39;</span> <span class=\"n\">hN&#39;</span><span class=\"o\">,</span>\n  <span class=\"k\">calc</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"bp\">=</span> <span class=\"bp\">|</span><span class=\"o\">(</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">))</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">apply</span> <span class=\"n\">abs_add</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">abs_sub</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span><span class=\"n\">hN</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">le_max_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">),</span> <span class=\"n\">hN&#39;</span> <span class=\"o\">(</span><span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">le_max_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)]</span>\n<span class=\"kn\">end</span>\n</code></pre></div>\n\n\n<p>I mostly get why this works, but I don't really understand what's happening in the last line here: what's that syntax?</p>\n<p>I think I would better understand a solution along the lines of</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"c1\">-- A sequence admits at most one limit</span>\n<span class=\"c1\">-- 0037</span>\n<span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l&#39;</span> <span class=\"bp\">→</span> <span class=\"n\">l</span> <span class=\"bp\">=</span> <span class=\"n\">l&#39;</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">eq_of_abs_sub_le_all</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">ε_pos</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N</span> <span class=\"n\">hN</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp&#39;</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N&#39;</span> <span class=\"n\">hN&#39;</span><span class=\"o\">,</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span>\n  <span class=\"k\">calc</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"bp\">=</span> <span class=\"bp\">|</span><span class=\"o\">(</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">apply</span> <span class=\"n\">abs_add</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">abs_sub</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"bp\">+</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span> <span class=\"err\">???</span> <span class=\"o\">]</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n<span class=\"kn\">end</span>\n</code></pre></div>\n\n\n<p>but I couldn't get this working: you need to add lemmas that n is bigger than N and N', and I got lost doing this; I'm also not quite sure how to feed those lemmas to linarith or similar. Is the awkwardness of carrying around these extra lemmas why the solution is in that form? Or is that a valid style and I just don't know quite how to do it?</p>",
        "id": 200687680,
        "sender_full_name": "Calvin McPhail-Snyder",
        "timestamp": 1591977221
    },
    {
        "content": "<p>Its not inconvenient at all to have those extra hypothesis imo. Specially because they are just specialized versions of <code>hN</code> and <code>hN'</code>.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l&#39;</span> <span class=\"bp\">→</span> <span class=\"n\">l</span> <span class=\"bp\">=</span> <span class=\"n\">l&#39;</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">eq_of_abs_sub_le_all</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">ε_pos</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N</span> <span class=\"n\">hN</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp&#39;</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N&#39;</span> <span class=\"n\">hN&#39;</span><span class=\"o\">,</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">specialize</span> <span class=\"n\">hN</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">le_max_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">),</span>\n  <span class=\"n\">specialize</span> <span class=\"n\">hN&#39;</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">le_max_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">),</span>\n  <span class=\"k\">calc</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"bp\">=</span> <span class=\"bp\">|</span><span class=\"o\">(</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">((</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">apply</span> <span class=\"n\">abs_add</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">abs_sub</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"bp\">+</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">linarith</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 200690184,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978244
    },
    {
        "content": "<p>You could have also given them directly to <code>linarith</code>:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l&#39;</span> <span class=\"bp\">→</span> <span class=\"n\">l</span> <span class=\"bp\">=</span> <span class=\"n\">l&#39;</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">eq_of_abs_sub_le_all</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">ε_pos</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N</span> <span class=\"n\">hN</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp&#39;</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N&#39;</span> <span class=\"n\">hN&#39;</span><span class=\"o\">,</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span><span class=\"o\">,</span>\n  <span class=\"k\">calc</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"bp\">=</span> <span class=\"bp\">|</span><span class=\"o\">(</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">((</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">apply</span> <span class=\"n\">abs_add</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">abs_sub</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"bp\">+</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span><span class=\"n\">hN</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">le_max_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">),</span> <span class=\"n\">hN&#39;</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">le_max_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)]</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 200690255,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978294
    },
    {
        "content": "<p>You can give extra lemmas for <code>linarith</code> to work with by listing them inside <code>[]</code>.</p>",
        "id": 200690405,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978361
    },
    {
        "content": "<p><code>linarith</code> will then use these extra lemmas as if they were in the context.</p>",
        "id": 200690431,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978379
    },
    {
        "content": "<p>Essentially: <code>have h := ..., linarith</code> is effectively the same as <code>linarith [...]</code>.</p>",
        "id": 200690641,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978503
    },
    {
        "content": "<p>Note that this is the case with multiple tactics. For example, <code>simp</code> by itself it will only simplify a handful of lemmas, however, if you want to to use more you can use <code>simp [lemma_1, lemma_2]</code>.</p>",
        "id": 200691184,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591978766
    },
    {
        "content": "<p>Part of what's going on here is also that <code>linarith</code> is capable of doing a small amount of arithmetic, like knowing that if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>ϵ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">a &lt; \\epsilon / 2</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">ϵ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>&lt;</mo><mi>ϵ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">b &lt; \\epsilon / 2</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">ϵ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span> then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>&lt;</mo><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">a + b &lt; \\epsilon</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">ϵ</span></span></span></span>. So the <code>ring</code> on the last line is not necessary</p>",
        "id": 200694591,
        "sender_full_name": "Patrick Lutz",
        "timestamp": 1591980410
    },
    {
        "content": "<p>Thanks! That clarified things.</p>",
        "id": 200695454,
        "sender_full_name": "Calvin McPhail-Snyder",
        "timestamp": 1591980847
    },
    {
        "content": "<p>Here the underscore syntax is some sort of anonymous function?</p>",
        "id": 200695753,
        "sender_full_name": "Calvin McPhail-Snyder",
        "timestamp": 1591980995
    },
    {
        "content": "<p>Lean will try to figure out what to put <code>_</code>. I could have also been explicit: <code>le_max_left N N'</code>.</p>",
        "id": 200698181,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591982291
    },
    {
        "content": "<p>I find that in some cases its way better to use <code>_</code>, and if you do too I think you will also eventually become frustrated that Lean can't infer even more!</p>",
        "id": 200698257,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591982338
    },
    {
        "content": "<p>A notable example I recently ran into was <code>and_not_self (mk (quotient s) * mk ↥s ≤ mk (quotient s) * mk ↥s)</code>, which (in my context) could be reduced to the much more legible <code>and_not_self _</code></p>",
        "id": 200698457,
        "sender_full_name": "Pedro Minicz",
        "timestamp": 1591982444
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"304545\">@Calvin McPhail-Snyder</span> you can switch between term and tactic mode at any time. I think <code>set</code> can be easier to use than <code>let</code> sometimes. Here is the solution you posted with <code>set</code> instead of <code>let</code>, and your <code>???</code> replaced by some sorrys:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">seq_limit</span> <span class=\"n\">u</span> <span class=\"n\">l&#39;</span> <span class=\"bp\">→</span> <span class=\"n\">l</span> <span class=\"bp\">=</span> <span class=\"n\">l&#39;</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">hyp&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">eq_of_abs_sub_le_all</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">ε_pos</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N</span> <span class=\"n\">hN</span><span class=\"o\">,</span>\n  <span class=\"n\">cases</span> <span class=\"n\">hyp&#39;</span> <span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">)</span> <span class=\"k\">with</span> <span class=\"n\">N&#39;</span> <span class=\"n\">hN&#39;</span><span class=\"o\">,</span>\n  <span class=\"n\">set</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">max</span> <span class=\"n\">N</span> <span class=\"n\">N&#39;</span> <span class=\"k\">with</span> <span class=\"n\">hn</span><span class=\"o\">,</span>\n  <span class=\"k\">calc</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"bp\">=</span> <span class=\"bp\">|</span><span class=\"o\">(</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"o\">)</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">l</span> <span class=\"bp\">-</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">apply</span> <span class=\"n\">abs_add</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"bp\">|</span> <span class=\"bp\">+</span> <span class=\"bp\">|</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l&#39;</span><span class=\"bp\">|</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">abs_sub</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"bp\">+</span> <span class=\"n\">ε</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span><span class=\"n\">hN</span> <span class=\"n\">n</span> <span class=\"k\">begin</span> <span class=\"n\">sorry</span> <span class=\"kn\">end</span><span class=\"o\">,</span> <span class=\"n\">hN&#39;</span> <span class=\"n\">n</span> <span class=\"k\">begin</span> <span class=\"n\">sorry</span> <span class=\"kn\">end</span> <span class=\"o\">]</span>\n            <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">ε</span> <span class=\"o\">:</span> <span class=\"k\">by</span> <span class=\"n\">ring</span>\n<span class=\"kn\">end</span>\n</code></pre></div>\n\n\n<p>You can just fill in those sorrys in tactic mode, they're independent little puzzles. The advantage of <code>set</code> is that the hypothesis <code>n = max N N'</code> has a name now. It's true by definition, but this can be intimidating for beginners.</p>",
        "id": 200701311,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591983846
    },
    {
        "content": "<p>Once you've convinced yourself that <code>exact le_max left _ _</code> solves the first sorry, you can replace <code>begin exact X end</code> with <code>X</code>, and this is what Patrick did.</p>",
        "id": 200701596,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591984004
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Massot.20Exercise.200037/near/200701311\">said</a>:</p>\n<blockquote>\n<p>The advantage of <code>set</code> is that the hypothesis <code>n = max N N'</code> has a name now. It's true by definition, but this can be intimidating for beginners.</p>\n</blockquote>\n<p>One thread I've been slowly trying to pull is to understand why <code>let</code> definitions aren't picked up by <code>linarith</code>.  Mario mentioned it was only recently that a tactic could even see the definition of something, so there's that.  I could see there being some sort of performance penalty, but not in the adding of the equalities to the context: <code>rfl</code> of definitionally equal things should be basically free.  From perusing the code, <code>linarith</code> looks for all inequalities and breaks them up into linear factors (\"atoms\"), and by default it doesn't try too hard to check whether different atoms are the same.</p>\n<p>While I'm somewhat willing to make Lean happy, I'd rather it be the other way around.</p>\n<p>(I thought I read that there was going to be a big change to <code>linarith</code> in the next few weeks, once someone got back, but I can't find it again.)</p>",
        "id": 200710540,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591988255
    },
    {
        "content": "<p>I'm not a computer scientist, but my impression is the following. I don't understand what <code>linarith</code> is doing, but I know for sure that if you just give it straight hypotheses <code>h1 : a &lt; b</code> <code>h2 : b &lt; c</code> <code>h3 : c &lt; 5</code> and then have goal <code>a &lt; 10</code> then <code>linarith</code> <em>just works</em>. And then you start wondering why it can't solve <code>a &lt;= max a b</code> because that's also some trivial linear inequality, right? Or why it can't see through <code>let</code> bindings. So I went through a phase of basically reporting \"bug reports\" of the form \"<code>linarith</code> should do this, right? It's trivial\" and believe you me, the CS community here has <em>bent over backwards</em> to accommodate my requests for tactics to make life easier for mathematicians -- but when it came to requests like this, it was explained to me that what I was doing was basically asking for \"mission creep\". <code>linarith</code> does what it does, and does it well, but it doesn't do things like digging into let bindings or applying le_max_left or abs_le etc -- there is some sort of basic principle of computer science I think, and these requests to start asking for extra functionality are somehow going against this principle.</p>",
        "id": 200711725,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591988836
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">tactic</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">change</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"c1\">-- n = a by definition so `change` works</span>\n  <span class=\"n\">linarith</span> <span class=\"c1\">-- still works</span>\n<span class=\"kn\">end</span>\n</code></pre></div>\n\n\n<p>It does seem to be able to see through let binders. It's stuff like <code>le_max_left</code> and <code>abs_le</code> which it doesn't know.</p>",
        "id": 200712149,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591989063
    },
    {
        "content": "<p>I think I've already accepted <code>linarith</code> not being able to prove  anything like <code>a &lt;= max a b</code>.  I also know that mission creep is exactly \"why can't it just do this one extra thing?\"  But, this is \"in the current context, turn the definitions into equalities as if you had used <code>set</code>.\"</p>",
        "id": 200712174,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591989080
    },
    {
        "content": "<p>It doesn't seem to see things like that if its <code>let n := a + 1</code> rather than just a variable.  I'll have to check again.</p>",
        "id": 200712213,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591989102
    },
    {
        "content": "<p>Can you show me the explicit example where <code>let</code> is failing and <code>set</code> fixes it? linarith is doing great with random simple examples obfuscated by <code>let</code>, for me</p>",
        "id": 200712319,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591989163
    },
    {
        "content": "<p>There are changes to <code>linarith</code> on the cards -- go to the <a href=\"https://github.com/leanprover-community/mathlib\">mathlib github page</a>, click on \"pull requests\" and then search for linarith. You can see the current state of the pull requests and what people are saying about them. Rob Lewis is the guy who wrote it and who was away for a while recently.</p>",
        "id": 200712512,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591989294
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- OK</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- not OK</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">set</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"k\">with</span> <span class=\"n\">eq</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- OK</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 200712853,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591989485
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/240192-Berkeley-Lean.20Seminar/topic/Massot.20Exercise.200037/near/200712512\">said</a>:</p>\n<blockquote>\n<p>There are changes to <code>linarith</code> on the cards -- go to the <a href=\"https://github.com/leanprover-community/mathlib\">mathlib github page</a></p>\n</blockquote>\n<p>Thanks for directing me to the PRs.  I'll keep an eye open, and once it's in maybe I'll try to figure out how to modify <code>linarith</code> to deal with <code>let</code> definitions and see if it causes anything to go wrong.</p>",
        "id": 200713710,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591989783
    },
    {
        "content": "<p>Here are the examples, a bit less contrived:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">change</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">,</span>\n  <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- OK</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"n\">change</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- not OK</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">set</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"k\">with</span> <span class=\"n\">eq</span><span class=\"o\">,</span>\n  <span class=\"n\">change</span> <span class=\"n\">n</span> <span class=\"bp\">≤</span> <span class=\"n\">b</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"n\">linarith</span><span class=\"o\">,</span> <span class=\"c1\">-- OK</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 200714037,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591989982
    },
    {
        "content": "<p>Because I don't understand <code>let</code>, I fear that asking Rob/Mario to make this work is precisely one of these \"just one more thing\" requests. It's not even clear to me that a PR would be welcome. If you understand more about computers than I do then feel free to engage them on the topic over in #maths, they'll happily try and explain the issues to you I'm sure. For all I know it is a reasonable request. Once when this came up Rob wrote <code>set</code> for me, and I've been using <code>set</code> ever since.</p>",
        "id": 200715644,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591990810
    },
    {
        "content": "<p>Thanks for pushing for <code>set</code> -- it's definitely a nice quality of life improvement.</p>\n<p>I think the reason we've been noticing this is because of all the limit proofs in Massot's tutorials.  You frequently need to specialize some limit at some particular epsilon, and before we knew about <code>set</code> we would avoid <code>let</code> definitions altogether because <code>linarith</code> wouldn't be able to fill in the positivity proof:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">set</span> <span class=\"n\">ε</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">l</span><span class=\"o\">)</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"k\">with</span> <span class=\"n\">εeq</span><span class=\"o\">,</span>\n<span class=\"n\">specialize</span> <span class=\"n\">h</span> <span class=\"n\">ε</span> <span class=\"o\">(</span><span class=\"k\">by</span> <span class=\"n\">linarith</span><span class=\"o\">),</span>\n</code></pre></div>",
        "id": 200716803,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1591991438
    },
    {
        "content": "<p>A lot of the enhancements made by Rob and Mario and people Rob has supervised have come from people just trying to do maths in #maths, running into problems, asking for help, and then these people have selflessly made tools for us. We have <code>norm_num</code> because I was whinging that I couldn't solve (4 : real) &lt; 5. Then I started getting undergraduates interested and they ran into problems with algebra, so Mario wrote <code>ring</code>, and then they ran into problems with moving freely from <code>nat</code> to <code>int</code> and so Rob supervised a student to write <code>norm_cast</code>. I have had an extremely positive experience with these CS people. Whenever we run into problems, they try to help us out. This is one of the reasons that I've stuck around -- we run into problems when trying to do mathematics, and they solve them for us. I think one of the reasons it works like this is that writing tactics in Lean is perhaps not too hard to do if you know what you're doing -- or perhaps these people are looking for publications -- who knows. But if you are trying to do mathematics and running into problems, <a class=\"stream\" data-stream-id=\"116395\" href=\"/#narrow/stream/116395-maths\">#maths</a> is the place to go.</p>",
        "id": 200718154,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1591992138
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> I didn't know about <code>set</code> and I think my frustration was caused by trying to use <code>let</code> instead. Thanks!</p>",
        "id": 200724631,
        "sender_full_name": "Calvin McPhail-Snyder",
        "timestamp": 1591996033
    },
    {
        "content": "<p>I think <code>set</code> was written after the tutorials were made right?</p>",
        "id": 200724660,
        "sender_full_name": "Patrick Lutz",
        "timestamp": 1591996066
    },
    {
        "content": "<p>At some point when I was doing the tutorials I kept writing things like <code>have : \\exists N, N \\ge N1 \\and N \\ge N2 := begin use max N1 N2, ....</code> and then doing cases with the resulting statement to get around this issue</p>",
        "id": 200724801,
        "sender_full_name": "Patrick Lutz",
        "timestamp": 1591996156
    },
    {
        "content": "<p>learning about <code>set</code> was pretty nice after that</p>",
        "id": 200724815,
        "sender_full_name": "Patrick Lutz",
        "timestamp": 1591996167
    }
]