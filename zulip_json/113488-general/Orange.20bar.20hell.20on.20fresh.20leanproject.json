[
    {
        "content": "<p>I'm seeing something a bit weird with a new leanproject I just made. Following the instructions under <a href=\"https://leanprover-community.github.io/install/project.html\">\"Creating a Lean Project\"</a> it works fine. But if I change the <code>topology.basic</code> import to <code>data.polynomial.basic</code>, I get orange bar hell. Do I need to run something after <code>leanproject new</code> to get oleans for mathlib?</p>",
        "id": 287600049,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346063
    },
    {
        "content": "<p>You shouldn't need to. What happens if you try <code>lean --make src</code> in the root directory of the project? And were there any errors when you ran <code>leanproject new</code>?</p>",
        "id": 287600238,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656346140
    },
    {
        "content": "<p>No errors when I ran <code>leanproject new</code>. When I run <code>lean --make src</code> I start seeing it compile a bunch of mathlib files.</p>",
        "id": 287600518,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346257
    },
    {
        "content": "<p>What about <code>leanproject get-mathlib-cache</code>? what is the output of that?</p>",
        "id": 287600799,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1656346373
    },
    {
        "content": "<p>If you were unlucky and created your project in a recent 30-minute window, you got a version of mathlib that did not have complete oleans. Perhaps the simplest thing to try is to create a new project first, and then we can try more sophisticated debugging.</p>",
        "id": 287600912,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656346423
    },
    {
        "content": "<p>Ok, I'll start from scratch again</p>",
        "id": 287601015,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346458
    },
    {
        "content": "<p>First thing that happens when I put <code>import data.polynomial.basic</code> in <code>src/test.lean</code> is \"Could not resolve data.polynomia\", which is weird itself, but restarting Lean makes that go away.</p>",
        "id": 287601359,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346608
    },
    {
        "content": "<p>Now I still get an orange bar on <code>import data.polynomial.basic</code>.</p>",
        "id": 287601427,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346645
    },
    {
        "content": "<p>Here's the <code>leanproject new</code> output</p>\n<div class=\"codehilite\" data-code-language=\"Todotxt\"><pre><span></span><code>(base) 12:09:57 risc0-all-files #=# leanproject new lean-prototyping\n&gt; cd lean-prototyping\n&gt; git init -q\n&gt; git checkout -b lean-3.8.0\nSwitched to a new branch 'lean-3.8.0'\nconfiguring lean-prototyping 0.1\nAdding mathlib\nmathlib: cloning https://github.com/leanprover-community/mathlib to _target/deps/mathlib\n&gt; git clone https://github.com/leanprover-community/mathlib _target/deps/mathlib\nCloning into '_target/deps/mathlib'...\nremote: Enumerating objects: 307734, done.\nremote: Counting objects: 100% (402/402), done.\nremote: Compressing objects: 100% (276/276), done.\nremote: Total 307734 (delta 206), reused 271 (delta 126), pack-reused 307332\nReceiving objects: 100% (307734/307734), 161.86 MiB | 35.60 MiB/s, done.\nResolving deltas: 100% (246274/246274), done.\n&gt; git checkout --detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    # in directory _target/deps/mathlib\nHEAD is now at 8c836ac9df Merge branch 'master' of https://github.com/leanprover-community/mathlib\nconfiguring lean-prototyping 0.1\nmathlib: trying to update _target/deps/mathlib to revision 8c836ac9dfa53d6acac4f2a693f2c718f013fe51\n&gt; git checkout --detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    # in directory _target/deps/mathlib\nHEAD is now at 8c836ac9df Merge branch 'master' of https://github.com/leanprover-community/mathlib\nLooking for lean-prototyping oleans for 8c836ac9df\n<span class=\"err\">  </span>locally...\n<span class=\"err\">  </span>Found local lean-prototyping oleans\nLocated matching cache\nApplying cache\n<span class=\"err\">  </span>files extracted: 2498 [00:13, 187.86/s]\n</code></pre></div>",
        "id": 287601557,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346690
    },
    {
        "content": "<p>Still an orange bar after 2 minutes. Trying <code>leanproject get-mathilb-cache</code> ...</p>",
        "id": 287601849,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346819
    },
    {
        "content": "<p>It finds the local cache, but still orange bars the import.</p>",
        "id": 287602031,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346912
    },
    {
        "content": "<p>Your Lean (or the one leanproject is choosing for you) is incredibly old -- <code>3.8.0</code>. I'm pretty sure we've seen this before and making sure you're on some recent version of mathlibtools was the fix.</p>",
        "id": 287602035,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656346913
    },
    {
        "content": "<p>What's <code>leanproject --version</code>?</p>",
        "id": 287602052,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656346921
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span> <span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"mi\">06</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">prototyping</span> <span class=\"bp\">#=#</span> <span class=\"n\">leanproject</span> <span class=\"c1\">--version</span>\n<span class=\"n\">leanproject</span><span class=\"o\">,</span> <span class=\"n\">version</span> <span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 287602130,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656346943
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321696\">Julian Berman</span> <a href=\"#narrow/stream/113488-general/topic/Orange.20bar.20hell.20on.20fresh.20leanproject/near/287602035\">said</a>:</p>\n<blockquote>\n<p>Your Lean (or the one leanproject is choosing for you) is incredibly old -- <code>3.8.0</code>. I'm pretty sure we've seen this before and making sure you're on some recent version of mathlibtools was the fix.</p>\n</blockquote>\n<p>I'm not sure that this is the correct diagnosis. IIRC <code>leanproject</code> prints out junk like this sometimes even when you're doing things right, and you don't end up on 3.8.0.</p>",
        "id": 287602190,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656346970
    },
    {
        "content": "<p>What does <code>elan show</code> say?</p>",
        "id": 287602238,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656346994
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span> <span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"mi\">22</span><span class=\"o\">:</span><span class=\"mi\">12</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">prototyping</span> <span class=\"bp\">#=#</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">installed</span> <span class=\"n\">toolchains</span>\n<span class=\"c1\">--------------------</span>\n\n<span class=\"n\">stable</span> <span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">20</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">21</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">23</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">26</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">27</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">28</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">30</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">31</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">32</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">33</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">34</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">35</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">35</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">8</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">30</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">35</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">37</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">38</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">39</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">39</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">39</span><span class=\"bp\">.</span><span class=\"mi\">2</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">40</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">41</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">42</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">42</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n\n<span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n<span class=\"c1\">----------------</span>\n\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span> <span class=\"o\">(</span><span class=\"n\">overridden</span> <span class=\"kd\">by</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">boltonbailey</span><span class=\"bp\">/</span><span class=\"n\">Desktop</span><span class=\"bp\">/</span><span class=\"n\">risc0</span><span class=\"bp\">-</span><span class=\"n\">all</span><span class=\"bp\">-</span><span class=\"n\">files</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">prototyping</span><span class=\"bp\">/</span><span class=\"n\">leanpkg.toml'</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"n\">bfce34363b0e</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 287602286,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347015
    },
    {
        "content": "<p>The \"could not resolve data.polynomia\" is also normal when you don't have the right oleans; it's the last error before the orange bars kick in and Lean doesn't clear the old error before it starts attempting to import <code>data.polynomial</code>.</p>",
        "id": 287602344,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656347042
    },
    {
        "content": "<p>I think the 3.8.0 thing is a red herring. What happens with <code>leanproject get-mathlib-cache</code>?</p>",
        "id": 287602425,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656347071
    },
    {
        "content": "<p>I ran that before. It finds the local oleans, and when I restart, I still get orange bars.</p>",
        "id": 287602498,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347112
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$ leanproject new fishcake\n&gt; <span class=\"nb\">cd</span> fishcake\n&gt; git init -q\n&gt; git checkout -b lean-3.41.0\nSwitched to a new branch <span class=\"s1\">'lean-3.41.0'</span>\nconfiguring fishcake <span class=\"m\">0</span>.1\nAdding mathlib\n...\nApplying cache\n  files extracted: <span class=\"m\">2498</span> <span class=\"o\">[</span><span class=\"m\">00</span>:04, <span class=\"m\">604</span>.98/s<span class=\"o\">]</span>\n$ <span class=\"nb\">cd</span> fishcake/\n/fishcake$ lean --version\nLean <span class=\"o\">(</span>version <span class=\"m\">3</span>.43.0, commit bfce34363b0e, Release<span class=\"o\">)</span>\n</code></pre></div>\n<p>Note 3.41 v 3.43 and my set-up is fine.</p>",
        "id": 287602701,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656347192
    },
    {
        "content": "<p>What's in <code>/Users/boltonbailey/Desktop/risc0-all-files/lean-prototyping/leanpkg.toml</code></p>",
        "id": 287602733,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656347207
    },
    {
        "content": "<p>I'm trying to find that old thread but IIRC another symptom was <code>leanproject</code> putting the old version in there too</p>",
        "id": 287602766,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656347224
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[package]</span><span class=\"w\"></span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"lean-prototyping\"</span><span class=\"w\"></span>\n<span class=\"n\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"0.1\"</span><span class=\"w\"></span>\n<span class=\"n\">lean_version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"leanprover-community/lean:3.43.0\"</span><span class=\"w\"></span>\n<span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"src\"</span><span class=\"w\"></span>\n\n<span class=\"k\">[dependencies]</span><span class=\"w\"></span>\n<span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"https://github.com/leanprover-community/mathlib\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"8c836ac9dfa53d6acac4f2a693f2c718f013fe51\"</span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 287602779,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347234
    },
    {
        "content": "<p>OK then yeah I'm wrong but I also don't see that revision of mathlib... Ah never mind I do too, and it indeed wants 3.43.0. Hrm.</p>",
        "id": 287602807,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656347252
    },
    {
        "content": "<p>You shouldn't have revision <code>8c836ac9dfa53d6acac4f2a693f2c718f013fe51</code> -- this one was reverted</p>",
        "id": 287603194,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347404
    },
    {
        "content": "<p>Two other ideas until/unless someone has brighter ones is to either <code>rm</code> the olean cache for that commit, maybe it was partially corrupted and you're running into an issue reported elsewhere where the partial cache is still being reused, or otherwise a last resort is to open one of the olean files and see what it says at the start (it should say the version amongst some gibberish) just in case.</p>",
        "id": 287603468,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656347502
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/113488-general/topic/Orange.20bar.20hell.20on.20fresh.20leanproject/near/287603194\">said</a>:</p>\n<blockquote>\n<p>You shouldn't have revision <code>8c836ac9dfa53d6acac4f2a693f2c718f013fe51</code> -- this one was reverted</p>\n</blockquote>\n<p>I see it no?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">Development</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">is</span> <span class=\"n\">a</span> <span class=\"n\">git</span> <span class=\"n\">repository</span> <span class=\"n\">on</span> <span class=\"n\">master</span>\n<span class=\"bp\">⊙</span>  <span class=\"n\">g</span> <span class=\"k\">show</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9dfa53d6acac4f2a693f2c718f013fe51</span>                                                                                  <span class=\"n\">julian</span><span class=\"bp\">@</span><span class=\"n\">Airm</span>\n<span class=\"n\">commit</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9dfa53d6acac4f2a693f2c718f013fe51</span> <span class=\"o\">(</span><span class=\"n\">origin</span><span class=\"bp\">/</span><span class=\"n\">zmod.lift_injective_iff</span><span class=\"o\">,</span> <span class=\"n\">origin</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">43</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"n\">Merge</span><span class=\"o\">:</span> <span class=\"mi\">8535</span><span class=\"n\">ba9ea5</span> <span class=\"mi\">331</span><span class=\"n\">df5a23a</span>\n<span class=\"n\">Author</span><span class=\"o\">:</span> <span class=\"n\">Heather</span> <span class=\"n\">Macbeth</span> <span class=\"bp\">&lt;</span><span class=\"mi\">25316162</span><span class=\"bp\">+</span><span class=\"n\">hrmacbeth</span><span class=\"bp\">@</span><span class=\"n\">users.noreply.github.com</span><span class=\"bp\">&gt;</span>\n<span class=\"n\">Date</span><span class=\"o\">:</span>   <span class=\"n\">Mon</span> <span class=\"n\">Jun</span> <span class=\"mi\">27</span> <span class=\"mi\">11</span><span class=\"o\">:</span><span class=\"mi\">05</span><span class=\"o\">:</span><span class=\"mi\">55</span> <span class=\"mi\">2022</span> <span class=\"bp\">-</span><span class=\"mi\">0400</span>\n\n    <span class=\"n\">Merge</span> <span class=\"n\">branch</span> <span class=\"bp\">'</span><span class=\"n\">master'</span> <span class=\"n\">of</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n</code></pre></div>\n<p>It looks like it's <a href=\"https://github.com/leanprover-community/mathlib/commit/8c836ac9dfa53d6acac4f2a693f2c718f013fe51\">https://github.com/leanprover-community/mathlib/commit/8c836ac9dfa53d6acac4f2a693f2c718f013fe51</a> -- or are you saying Bolton shouldn't be using it anyhow?</p>",
        "id": 287603614,
        "sender_full_name": "Julian Berman",
        "timestamp": 1656347567
    },
    {
        "content": "<p>Try doing <code>leanproject upgrade-mathlib</code> and make sure that the <code>rev</code> becomes <code>05565f4d64c988f5ad3bc97eae5413229c34d01d</code></p>",
        "id": 287603615,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347568
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span> Yes, I'm saying that commit should not be used. It's not in the <code>master</code> history anymore.</p>",
        "id": 287603682,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347606
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"o\">(</span>base<span class=\"o\">)</span> <span class=\"m\">12</span>:33:09 lean-prototyping $ leanproject upgrade-mathl\nib\nmathlib: trying to update _target/deps/mathlib to revision 8c836ac9dfa53d6acac4f2a693f2c718f013fe51\n&gt; git checkout --detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    <span class=\"c1\"># in directory _target/deps/mathlib</span>\nHEAD is now at 8c836ac9df Merge branch <span class=\"s1\">'master'</span> of https://github.com/leanprover-community/mathlib\nremote: Enumerating objects: <span class=\"m\">71</span>, <span class=\"k\">done</span>.\nremote: Counting objects: <span class=\"m\">100</span>% <span class=\"o\">(</span><span class=\"m\">71</span>/71<span class=\"o\">)</span>, <span class=\"k\">done</span>.\nremote: Compressing objects: <span class=\"m\">100</span>% <span class=\"o\">(</span><span class=\"m\">33</span>/33<span class=\"o\">)</span>, <span class=\"k\">done</span>.\nremote: Total <span class=\"m\">71</span> <span class=\"o\">(</span>delta <span class=\"m\">44</span><span class=\"o\">)</span>, reused <span class=\"m\">56</span> <span class=\"o\">(</span>delta <span class=\"m\">38</span><span class=\"o\">)</span>, pack-reused <span class=\"m\">0</span>\nUnpacking objects: <span class=\"m\">100</span>% <span class=\"o\">(</span><span class=\"m\">71</span>/71<span class=\"o\">)</span>, <span class=\"m\">54</span>.71 KiB <span class=\"p\">|</span> <span class=\"m\">636</span>.00 KiB/s, <span class=\"k\">done</span>.\nFrom https://github.com/leanprover-community/mathlib\n   7191e89632..57e7b8004e  RD_condexp_mono         -&gt; origin/RD_condexp_mono\n   ccb29fa8bc..1e61bac1f1  RD_lp_order             -&gt; origin/RD_lp_order\n   ce83742c3a..400492c049  apurva/convex_cone_zero -&gt; origin/apurva/convex_cone_zero\n   f4ee9f84db..ba43919145  jsm28/two_smul_angle_lemmas -&gt; origin/jsm28/two_smul_angle_lemmas\n * <span class=\"o\">[</span>new branch<span class=\"o\">]</span>            limit_cardinal_refactor -&gt; origin/limit_cardinal_refactor\n   331df5a23a..05565f4d64  master                  -&gt; origin/master\n   05565f4d64..68e0160128  staging                 -&gt; origin/staging\nconfiguring lean-prototyping <span class=\"m\">0</span>.1\nmathlib: trying to update _target/deps/mathlib to revision 8c836ac9dfa53d6acac4f2a693f2c718f013fe51\n&gt; git checkout --detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    <span class=\"c1\"># in directory _target/deps/mathlib</span>\nHEAD is now at 8c836ac9df Merge branch <span class=\"s1\">'master'</span> of https://github.com/leanprover-community/mathlib\nLooking <span class=\"k\">for</span> lean-prototyping oleans <span class=\"k\">for</span> 8c836ac9df\n  locally...\n  Found <span class=\"nb\">local</span> lean-prototyping oleans\nLocated matching cache\nApplying cache\n  files extracted: <span class=\"m\">2498</span> <span class=\"o\">[</span><span class=\"m\">00</span>:13, <span class=\"m\">179</span>.07/s<span class=\"o\">]</span>\n</code></pre></div>",
        "id": 287603740,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347637
    },
    {
        "content": "<p>Also, apologies in advance if <code>leanproject upgrade-mathlib</code> doesn't work -- I don't know what it does in this situation.</p>",
        "id": 287603951,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347723
    },
    {
        "content": "<p>Are you working in the freshly created project, or the one you started with at the beginning of the thread?</p>",
        "id": 287603990,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347744
    },
    {
        "content": "<p>Freshly created after you told me to do so.</p>",
        "id": 287604068,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347773
    },
    {
        "content": "<p>Were the bad commits removed before or after? :-)</p>",
        "id": 287604100,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656347789
    },
    {
        "content": "<p>Before, I'm fairly sure.</p>",
        "id": 287604148,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347817
    },
    {
        "content": "<p>It's very puzzling that you'd be on <code>8c836ac9dfa53d6acac4f2a693f2c718f013fe51</code> still, so maybe we turn if off and turn it on again for good measure... (i.e., create a fresh project)</p>",
        "id": 287604284,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656347871
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span> <span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"o\">:</span><span class=\"mi\">17</span> <span class=\"n\">risc0</span><span class=\"bp\">-</span><span class=\"n\">all</span><span class=\"bp\">-</span><span class=\"n\">files</span> <span class=\"bp\">#=#</span> <span class=\"n\">leanproject</span> <span class=\"n\">new</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">cd</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">init</span> <span class=\"bp\">-</span><span class=\"n\">q</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"bp\">-</span><span class=\"n\">b</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">8</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">Switched</span> <span class=\"n\">to</span> <span class=\"n\">a</span> <span class=\"n\">new</span> <span class=\"n\">branch</span> <span class=\"bp\">'</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">8</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">'</span>\n<span class=\"n\">configuring</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">Adding</span> <span class=\"n\">mathlib</span>\n<span class=\"n\">mathlib</span><span class=\"o\">:</span> <span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">to</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"n\">Cloning</span> <span class=\"n\">into</span> <span class=\"bp\">'</span><span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib'...</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Enumerating</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">306972</span><span class=\"o\">,</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Counting</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">660</span><span class=\"bp\">/</span><span class=\"mi\">660</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Compressing</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">335</span><span class=\"bp\">/</span><span class=\"mi\">335</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Total</span> <span class=\"mi\">306972</span> <span class=\"o\">(</span><span class=\"n\">delta</span> <span class=\"mi\">420</span><span class=\"o\">),</span> <span class=\"n\">reused</span> <span class=\"mi\">522</span> <span class=\"o\">(</span><span class=\"n\">delta</span> <span class=\"mi\">325</span><span class=\"o\">),</span> <span class=\"n\">pack</span><span class=\"bp\">-</span><span class=\"n\">reused</span> <span class=\"mi\">306312</span>\n<span class=\"n\">Receiving</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">306972</span><span class=\"bp\">/</span><span class=\"mi\">306972</span><span class=\"o\">),</span> <span class=\"mi\">161</span><span class=\"bp\">.</span><span class=\"mi\">70</span> <span class=\"n\">MiB</span> <span class=\"bp\">|</span> <span class=\"mi\">14</span><span class=\"bp\">.</span><span class=\"mi\">33</span> <span class=\"n\">MiB</span><span class=\"bp\">/</span><span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">done.</span>\n<span class=\"n\">Resolving</span> <span class=\"n\">deltas</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">245617</span><span class=\"bp\">/</span><span class=\"mi\">245617</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"c1\">--detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    # in directory _target/deps/mathlib</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9df</span> <span class=\"n\">Merge</span> <span class=\"n\">branch</span> <span class=\"bp\">'</span><span class=\"n\">master'</span> <span class=\"n\">of</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"n\">configuring</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">mathlib</span><span class=\"o\">:</span> <span class=\"n\">trying</span> <span class=\"n\">to</span> <span class=\"n\">update</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">to</span> <span class=\"n\">revision</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9dfa53d6acac4f2a693f2c718f013fe51</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"c1\">--detach 8c836ac9dfa53d6acac4f2a693f2c718f013fe51    # in directory _target/deps/mathlib</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9df</span> <span class=\"n\">Merge</span> <span class=\"n\">branch</span> <span class=\"bp\">'</span><span class=\"n\">master'</span> <span class=\"n\">of</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"n\">Looking</span> <span class=\"n\">for</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span> <span class=\"n\">oleans</span> <span class=\"n\">for</span> <span class=\"mi\">8</span><span class=\"n\">c836ac9df</span>\n  <span class=\"n\">locally...</span>\n  <span class=\"n\">Found</span> <span class=\"kn\">local</span> <span class=\"n\">yet</span><span class=\"bp\">-</span><span class=\"n\">another</span><span class=\"bp\">-</span><span class=\"n\">fresh</span><span class=\"bp\">-</span><span class=\"n\">start</span> <span class=\"n\">oleans</span>\n<span class=\"n\">Located</span> <span class=\"n\">matching</span> <span class=\"n\">cache</span>\n<span class=\"n\">Applying</span> <span class=\"n\">cache</span>\n  <span class=\"n\">files</span> <span class=\"n\">extracted</span><span class=\"o\">:</span> <span class=\"mi\">2498</span> <span class=\"o\">[</span><span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">15</span><span class=\"o\">,</span> <span class=\"mi\">165</span><span class=\"bp\">.</span><span class=\"mi\">14</span><span class=\"bp\">/</span><span class=\"n\">s</span><span class=\"o\">]</span>\n<span class=\"o\">(</span><span class=\"n\">base</span><span class=\"o\">)</span> <span class=\"mi\">12</span><span class=\"o\">:</span><span class=\"mi\">38</span><span class=\"o\">:</span><span class=\"mi\">56</span> <span class=\"n\">risc0</span><span class=\"bp\">-</span><span class=\"n\">all</span><span class=\"bp\">-</span><span class=\"n\">files</span> <span class=\"bp\">#=#</span>\n</code></pre></div>",
        "id": 287604501,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347951
    },
    {
        "content": "<p>Still <code>8c836ac9dfa53d6acac4f2a693f2c718f013fe51</code></p>",
        "id": 287604527,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1656347964
    },
    {
        "content": "<p>Hmm, I'm getting that too</p>",
        "id": 287604935,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656348154
    },
    {
        "content": "<p>Yes, I can also reproduce (together with orange bar hell). So right now <code>leanproject new</code> is broken.</p>",
        "id": 287605023,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656348197
    },
    {
        "content": "<p>I've reproduced it without <code>leanproject</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$ mkdir foo\n$ <span class=\"nb\">cd</span> foo\n$ leanpkg init foo\n<span class=\"c1\"># now edit the leanpkg.toml file to use lean_version = \"leanprover-community/lean:3.43.0\"</span>\n$ leanpkg configure\n$ leanpkg add leanprover-community/mathlib\n</code></pre></div>\n<p>Then if you look at the <code>leanpkg.toml</code> it has <code>rev = \"8c836ac9dfa53d6acac4f2a693f2c718f013fe51\"</code>.</p>\n<p>If I leave it at <code>lean:3.42.1</code> (the default for me), then it has <code>rev = \"c81c6c91781f12ac7005367a4477dcb2f6be638f\"</code>, which is a commit from 12 days ago. I guess <code>leanpkg</code> knows what version of mathlib to use for each version of lean somehow?</p>",
        "id": 287607534,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1656349312
    },
    {
        "content": "<p>It's because the <code>lean-3.43.0</code> branch is still on that commit</p>",
        "id": 287608053,
        "sender_full_name": "Reid Barton",
        "timestamp": 1656349535
    },
    {
        "content": "<p>gaargh I thought it would be something like that but I checked tags not branches.</p>",
        "id": 287608207,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1656349592
    }
]