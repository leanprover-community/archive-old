[
    {
        "content": "<p>Noob question. </p>\n<p>Since we're writing all these docstrings at the top of <code>.lean</code> files in mathlib in markdown, presumably there's an easy way to see the markdown? What does <code>/-! -/</code> do?</p>",
        "id": 179874075,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1572900103
    },
    {
        "content": "<p>Nothing useful with Lean 3.4.2 -- I think there's something missing from the API that's either fixed or fixable in the community fork. They're docstrings associated with the file instead of a particular declaration, and metaprograms can in principle access them.</p>",
        "id": 179874450,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572900358
    },
    {
        "content": "<p>IIRC in 3.4.2 you can only get the docstring for the current file.</p>",
        "id": 179874510,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572900377
    },
    {
        "content": "<p>It's more of a future-proofing thing. At some point we'll want to generate HTML docs for the library, and having the comments already in markdown will be convenient then.</p>",
        "id": 179874558,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572900415
    },
    {
        "content": "<p>It might actually be a useful VSCode plugin to format and display the module doc for the current file when you press a button.</p>",
        "id": 179874689,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572900491
    },
    {
        "content": "<p>You can see lean 3.4.2's tests <a href=\"https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean\" target=\"_blank\" title=\"https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean\">doc_string3.lean</a> for the extent of the non-community edition support e.g. there are some tactics for printing out the doc_strings.</p>\n<p>I haven't tested if lumpy-leandoc does the right thing for <code>/-! -/</code> yet (edit: it should work)... but it'd be very easy to add something which extracts the .md file to it in addition to the limited html/pdf stuff it currently does.</p>",
        "id": 179909843,
        "sender_full_name": "matt rice",
        "timestamp": 1572941406
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110044\">@Chris Hughes</span>  I fixed up lumpy so it could build mathlib again, <a href=\"https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip\" target=\"_blank\" title=\"https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip\">mathlib-docs.zip</a></p>\n<p>Rob Lewis seems correct in that it's not useful with 3.4.2 in lumpy at least, the <code>/-! -/</code> comments never make it to the output, so <code>/-! -/</code> only shows up when the lean files were built with the community edition.</p>\n<p>The way lumpy treats <code>/-! -/</code> is to include it verbatim, i.e. It doesn't prepend it with the name of the definition to which the doc_string is associated, because it's generally just associated with the section that corresponds to the file.<br>\nHopefully that helps.</p>",
        "id": 179972494,
        "sender_full_name": "matt rice",
        "timestamp": 1572985099
    },
    {
        "content": "<p>That's actually closer to real doc generation than I realized we were.</p>",
        "id": 179973162,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572985535
    },
    {
        "content": "<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>",
        "id": 179973228,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572985567
    },
    {
        "content": "<p>But the core structure is there.</p>",
        "id": 179973242,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572985582
    },
    {
        "content": "<blockquote>\n<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>\n</blockquote>\n<p>In the PDF, that is. The HTML looks better, except it doesn't print the def names? Which do appear in the PDF?</p>",
        "id": 179973394,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572985689
    },
    {
        "content": "<p>Yeah, it's because I was following the html -&gt; tex convention that e.g. &lt;h1&gt; corresponds to \\chapter &lt;h2&gt; \\section etc, and the docs aren't really built with that in mind</p>",
        "id": 179973423,
        "sender_full_name": "matt rice",
        "timestamp": 1572985711
    },
    {
        "content": "<p>Yeah, this was the forseeable problem with creating the doc standards before we could generate docs.</p>",
        "id": 179973712,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572985770
    },
    {
        "content": "<p>Yup, I haven't done a lot of work on the html generation (or in fact looked at it today), it should in theory be easy to add unless i have forgotten why it is missing, I will try and look at it again tomorrow and fix that if I can.</p>",
        "id": 179973891,
        "sender_full_name": "matt rice",
        "timestamp": 1572985884
    },
    {
        "content": "<p>Cool. What are the prospects for linking? Something like this: \"if an identifier appears between backticks, and we've seen a declaration with that name, turn it into a link.\" I'm guessing that's way more work?</p>",
        "id": 179974669,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572986275
    },
    {
        "content": "<p>Something like that, It'll need some thought, as it parses all lean files in parallel currently, so i'll probably have to do a pass over declarations build a table of declarations first before generating links (I'm guessing we want to link across files, which means we also need to mirror the import behavior I suppose)... <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span></p>",
        "id": 179975772,
        "sender_full_name": "matt rice",
        "timestamp": 1572986900
    },
    {
        "content": "<p>With two passes I think you could ignore the import tree. Generate a table the first pass, and note which html file each declaration will live in. Then fill in the info in the second pass. Namespacing means this will be impossible to get exactly right though. There's no way doc strings will be consistent about referring to declarations with full namespaces, and there will be ambiguous cases.</p>",
        "id": 179976376,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572987254
    },
    {
        "content": "<p>yeah, shall see if we can get away with that, anyhow i must get going.</p>",
        "id": 179976846,
        "sender_full_name": "matt rice",
        "timestamp": 1572987519
    },
    {
        "content": "<p>Thanks for looking into this! It would be great to generate HTML docs for the website and this isn't so far off.</p>",
        "id": 179977349,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1572987753
    },
    {
        "content": "<p>Well, i updated it (and the zip file) to add the names of declarations, and a horizontal rule separating the header.</p>\n<p>I think i will look at making TeX rendering optional, because the output isn't ready for consumption and it makes integrating into CI difficult since it needs lots of font stuff compiled in a specific way... With that it'll hopefully be easier to integrate into the website...</p>",
        "id": 180013747,
        "sender_full_name": "matt rice",
        "timestamp": 1573031425
    },
    {
        "content": "<p>Nice! I just checked out a couple of the better documented files. It looks great. <a href=\"https://leanprover-community.github.io/doc_demo/manifold.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/doc_demo/manifold.html\">https://leanprover-community.github.io/doc_demo/manifold.html</a></p>",
        "id": 180015725,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033310
    },
    {
        "content": "<p>What about printing the type of the declaration along with the name?</p>",
        "id": 180015788,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033350
    },
    {
        "content": "<p>Right now it only prints declarations that have docstrings, right? Our doc guidelines don't require them for theorems, since in principle all you need to know about a theorem is its statement. Complicated/big/important theorems should have docstrings anyway, but we probably want more than just those in the doc output.</p>",
        "id": 180015988,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033528
    },
    {
        "content": "<p>Is it overkill to print everything in the html docs? It feels to me like it should describe a \"public\" API, and there are plenty of things in the library that don't need to show up there. But I'm not sure.</p>",
        "id": 180016062,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033589
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"143402\">@matt rice</span> Wow, that looks really good</p>",
        "id": 180016089,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573033626
    },
    {
        "content": "<p>The <code>&lt;div&gt;</code>s containing the declarations should have a class so we can style it better, but that's easy.</p>",
        "id": 180016121,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033668
    },
    {
        "content": "<p>Also we need index pages. Also easy, I hope :)</p>",
        "id": 180016221,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033735
    },
    {
        "content": "<p>Once this is up and running, it gives another argument for a mathlib release schedule. We could update the docs daily. But it would probably be clearer to have fixed versions.</p>",
        "id": 180016492,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573033987
    },
    {
        "content": "<p>I will look at printing the type declaration, it's been on my list of things to do, but I have been scared that it's just going to give me the thing that the type is definitionally equal to, since i'm pulling it out of the bytecode :D</p>\n<p>I don't know anything about html really, i'll try and figure out the div's class, I assume i need to declare some empty style e.g. decl and then give it the class decl?</p>\n<p>I also wish I could style the syntax highlighting rather than hard coded colors, but that is going to take some work.</p>",
        "id": 180016758,
        "sender_full_name": "matt rice",
        "timestamp": 1573034250
    },
    {
        "content": "<p>For the div classes, the easy part is printing <code>&lt;div class=\"decl\"&gt;</code> instead of just <code>&lt;div&gt;</code>. Then someone needs to add a css file that styles them properly, which we probably want to integrate with the rest of the website.</p>",
        "id": 180016968,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573034419
    },
    {
        "content": "<p>I suspect you'll get a presentable type, but I don't know.</p>",
        "id": 180017067,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573034513
    },
    {
        "content": "<p>index should be easy it's already in a big table just need to enumerate the keys of.</p>",
        "id": 180017119,
        "sender_full_name": "matt rice",
        "timestamp": 1573034537
    },
    {
        "content": "<p>Can you use pygments to generate highlighted code?</p>",
        "id": 180017183,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573034624
    },
    {
        "content": "<p>it's currently using <a href=\"https://docs.rs/syntect/3.3.0/syntect/\" target=\"_blank\" title=\"https://docs.rs/syntect/3.3.0/syntect/\">syntect</a> with a conversion of the vscode syntax highlighting, I haven't really compared to how vscode gets highlighted yet to see if that conversion is accurate though.</p>\n<p>Using pygments would be a big change.  Part of the reason i chose syntect is so i can compile the whole thing to web assembly eventually and not shell out to stuff.</p>",
        "id": 180017397,
        "sender_full_name": "matt rice",
        "timestamp": 1573034811
    },
    {
        "content": "<p>Aha... <code>pandoc</code> uses pygments, and so does Zulip. I don't know syntect.</p>",
        "id": 180017547,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573034993
    },
    {
        "content": "<p>For the syntax highlighting, we could at least move the style definition to a separate css file, so the colors are specified once instead of every time code is displayed.</p>",
        "id": 180017786,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035232
    },
    {
        "content": "<p>The Zulip archive lets Zulip do the structuring (with pygments, I think?) and then copies the Zulip CSS to display it.</p>",
        "id": 180017864,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035284
    },
    {
        "content": "<p>I don't know how different the syntect structuring is, presumably it's not compatible. But we should be able to manually match the colors for analogous items.</p>",
        "id": 180018014,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035433
    },
    {
        "content": "<p>Yeah, the problem is the syntax highlighter hard coding the colors, the current solution to this is to hard code the colors for each thing to a specific unique value and then sniff the colors and turn them into the appropriate CSS.  Ideally I would like to just get it to emit CSS directly.</p>",
        "id": 180018089,
        "sender_full_name": "matt rice",
        "timestamp": 1573035496
    },
    {
        "content": "<p>Oh, I see. That's kind of annoying.</p>",
        "id": 180018120,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035540
    },
    {
        "content": "<p>Yeah, there should be a way to do it, but this was easy to add as a placeholder for now.</p>",
        "id": 180018230,
        "sender_full_name": "matt rice",
        "timestamp": 1573035628
    },
    {
        "content": "<p>It's maybe not ideal, but it looks fine as-is. I wouldn't worry about it too much.</p>",
        "id": 180018365,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035746
    },
    {
        "content": "<blockquote>\n<p>Nice! I just checked out a couple of the better documented files. It looks great. <a href=\"https://leanprover-community.github.io/doc_demo/manifold.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/doc_demo/manifold.html\">https://leanprover-community.github.io/doc_demo/manifold.html</a></p>\n</blockquote>\n<p>Updated to apply the default stylesheet. Not bad, hmm?</p>",
        "id": 180018411,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573035820
    },
    {
        "content": "<p>The main thing that had me tearing my hair out with pygments was that each backend has different supported rendering options, like line numbers, and things So like html may support line-numbers and latex ignore them and what not.  Eventually i would like to be able to attach footnotes to lines-numbers and for that I need some fairly custom syntax highlighting anyways.</p>",
        "id": 180018511,
        "sender_full_name": "matt rice",
        "timestamp": 1573035888
    },
    {
        "content": "<p>Speaking of line numbers, does the Lean byte code let you access the line number of a declaration? Linking declarations to their statement on GitHub would be really nice.</p>",
        "id": 180018670,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036032
    },
    {
        "content": "<blockquote>\n<p>Right now it only prints declarations that have docstrings, right? Our doc guidelines don't require them for theorems, since in principle all you need to know about a theorem is its statement. Complicated/big/important theorems should have docstrings anyway, but we probably want more than just those in the doc output.</p>\n</blockquote>\n<p>I think that maybe we should only print things that do have a docstring. Otherwise it becomes close to replicating the source. These pages could be a good intermediate step that extracts the \"juicy\" bits.</p>",
        "id": 180018907,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573036271
    },
    {
        "content": "<p>Then I think we need to raise the percentage of theorems that get documented. The Python docs wouldn't be very helpful if they only told you the juicy parts about manipulating strings.</p>",
        "id": 180019039,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036440
    },
    {
        "content": "<p>In principle the module docs at the top should point to the juicy bits.</p>",
        "id": 180019130,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036486
    },
    {
        "content": "<p>So what is the purpose of these documents over the github source (besides typesetting the markdown)?</p>",
        "id": 180019159,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573036536
    },
    {
        "content": "<p>Omitting declaration bodies gets you pretty far from the source.</p>",
        "id": 180019177,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036559
    },
    {
        "content": "<p>Imagine if the Python docs showed you the implementation of every function.</p>",
        "id": 180019249,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036599
    },
    {
        "content": "<p>Yeah, you can extract line numbers, olean-rs/types.rs PosInfo structure.  We should be able to make links revision-stable as well if we can pull the sha out of git.</p>",
        "id": 180019260,
        "sender_full_name": "matt rice",
        "timestamp": 1573036612
    },
    {
        "content": "<p>But again, I'm not sure that <em>every</em> theorem deserves to show up in the HTML. Maybe we could use a <code>@[nodoc]</code> attribute to make it opt-out instead of opt-in. We should have access to attributes from the byte code, right?</p>",
        "id": 180019513,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573036832
    },
    {
        "content": "<p>I believe so looks like either Modification::UserAttribute or Modification::Attr. let me know what you guys decide, currently I just ignore undocumented things.</p>",
        "id": 180020075,
        "sender_full_name": "matt rice",
        "timestamp": 1573037359
    },
    {
        "content": "<p>Anyhow, going go try and implement some of the things discussed.</p>",
        "id": 180020186,
        "sender_full_name": "matt rice",
        "timestamp": 1573037420
    },
    {
        "content": "<p>Hmm, a tougher one, can you identify when declarations are builtin or user-defined? We have a tactic to do this. But that might not be contained in the byte code.</p>",
        "id": 180020253,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573037476
    },
    {
        "content": "<p>We don't want to include random recursors and aux definitions in the docs.</p>",
        "id": 180020290,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573037508
    },
    {
        "content": "<p>I'm not sure, there has been plenty to do without getting too in depth with the bytecode so far :)</p>",
        "id": 180020408,
        "sender_full_name": "matt rice",
        "timestamp": 1573037576
    },
    {
        "content": "<p>Hah, fair enough!</p>",
        "id": 180020458,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573037612
    },
    {
        "content": "<p>It seems that most (all?) Lean-generated definitions have a name starting with an underscore at some point in the namespace - <code>_main</code>, <code>_sunfold</code>, <code>_eqn_n</code>. In addition, Lean rejects identifiers starting with the underscore, since these are reserved for the system, so it might suffice to just look for those in the name.</p>",
        "id": 180021238,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573038226
    },
    {
        "content": "<p>The things that come along with an inductive type don't. <code>rec_on</code>, <code>no_confusion</code>, etc.</p>",
        "id": 180021490,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573038397
    },
    {
        "content": "<p>Of course, it's easy enough to blacklist those.</p>",
        "id": 180021530,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573038428
    },
    {
        "content": "<p>There is a pretty comprehensive autogenerated definition check in the linter</p>",
        "id": 180021627,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1573038498
    },
    {
        "content": "<p>But if we're extracting things with olean-rs we can't run that check.</p>",
        "id": 180021658,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573038558
    },
    {
        "content": "<p>Maybe the check could be reimplemented.</p>",
        "id": 180021684,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573038583
    },
    {
        "content": "<p>An issue with printing types is that olean files seem to contain them in raw form. Unless I'm missing something, pretty-printing would then require processing all notation and pretty much reimplementing the pretty-printer. As an alternative, we could query the Lean server for types of things from lumpy. This might be quite slow unfortunately.</p>",
        "id": 180124204,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573127304
    },
    {
        "content": "<p>updated the docs again, to include index and the css stuff. <a href=\"https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip\" target=\"_blank\" title=\"https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip\">mathlib-docs.zip</a>, I find the alphabetical order on directory/file mix bothersome, but it functions.</p>",
        "id": 180176504,
        "sender_full_name": "matt rice",
        "timestamp": 1573161141
    },
    {
        "content": "<p>Maybe there's a better approach to this. Instead of extracting info directly from the oleans, should we do a first pass with a Lean metaprogram? That way we can use the existing autogenerated check, pretty-print types, etc.</p>",
        "id": 180239967,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573227001
    },
    {
        "content": "<p>We'd just fold over the environment and for each declaration export the name, type, file location, docstring, and any attributes we want to display. The export can be in whatever format is convenient for the formatter to parse.</p>",
        "id": 180240144,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573227098
    },
    {
        "content": "<p>One thing you can't get from this approach is info about file imports. I guess we'd want to print that at some point.</p>",
        "id": 180240407,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573227250
    },
    {
        "content": "<p>Yes, that is the approach I think we should take. Instead of a metaprogram though, I've hacked on Lean a bit to make it produce the list of declarations in each .lean file, as well as the top-level docstrings for it. Re. file imports, I'm not sure about tactic mode, but they should be obtainable from <code>module_info</code> in the c++.</p>",
        "id": 180240447,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573227285
    },
    {
        "content": "<p>Ah, cool. Does it produce the list at the time the file is compiled, or after the whole build is done? If we want to print attributes, it's important to generate this at the end. If a declaration gets tagged as a simp lemma in a later file than where it's declared, we need to catch that.</p>",
        "id": 180240740,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573227481
    },
    {
        "content": "<p>It produces the list using the environment that exists at the last line of the file being compiled. Note that we cannot know a priori all places where a lemma is tagged as simp, just as we cannot know a priori all instances of a type class. For this reason, I would say that such tags should be documented <em>in the module in which they exist</em> rather than at the point where the to-be-tagged-simp lemma is declared. Same goes for typeclass instances. We could aggregate them after processing all of mathlib and then retroactively add forward-links, but that wouldn't extend to a general notion of package and would be more of a hack.</p>",
        "id": 180333229,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573335940
    },
    {
        "content": "<p>By the way, while for typeclasses this makes perfect sense, the design choice of allowing lemmas to be tagged as <code>simp</code> after they are declared seems to only make sense if a lemma can be locally-simp, i.e. a useful simplification in the context of some theory, but maybe not generally. I'm not sure if this happens in mathlib but it seems plausible.</p>",
        "id": 180333312,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573336067
    },
    {
        "content": "<p>Oh, and because the signature of <code>module_doc_strings : tactic (list (option name × string))</code> is weird, I am considering deleting it and replacing with <code>module_doc_string : string -&gt; string</code>, which returns the module doc string for the module identified by hopefully same scheme as in <code>import</code>, e.g. <code>module_doc_string \".mymod\"</code> should return the doc for <code>./import.lean</code>. The declaration docs are still retrievable by folding over the environment, so no expressivity is lost.</p>",
        "id": 180334499,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573337906
    },
    {
        "content": "<p>I think, in general, we add attributes as soon as they're available. But this isn't always in the file where the declaration is defined: see e.g. the bottom of <code>norm_cast</code>. It intuitively seems useful to document that <code>int.coe_nat_succ</code> is a <code>move_cast</code> lemma. That is indeed some kind of forward reference, but I'm not sure that's a problem for this kind of documentation. It's documenting the library as a whole, forward references aren't necessarily wrong. But it does seem wrong when an attribute is added deep in the file hierarchy. Declaring <code>nat.prime</code> as a class in the p-adics files is an example of this, but there are also other reasons this shouldn't happen and WIP to change it.</p>",
        "id": 180363429,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573392315
    },
    {
        "content": "<p>Besides tactic attributes like <code>move_cast</code>, <code>ext</code>, etc, there aren't many cases where global attributes are added long after the declarations are defined. There are some reducibility level changes I think.</p>",
        "id": 180363484,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573392430
    },
    {
        "content": "<blockquote>\n<p>Oh, and because the signature of <code>module_doc_strings : tactic (list (option name × string))</code> is weird, I am considering deleting it and replacing with <code>module_doc_string : string -&gt; string</code>, which returns the module doc string for the module identified by hopefully same scheme as in <code>import</code>, e.g. <code>module_doc_string \".mymod\"</code> should return the doc for <code>./import.lean</code>. The declaration docs are still retrievable by folding over the environment, so no expressivity is lost.</p>\n</blockquote>\n<p>Coming back to this: what would be best (for me) is a function that returns a list of pairs <code>(file, docs)</code>, where <code>file</code> is a string that identifies a Lean file and <code>docs</code> is the list of module doc strings for that file. (By module doc strings, I mean the file-level ones, not the ones associated with a declaration.)</p>",
        "id": 180435374,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573488131
    },
    {
        "content": "<p>As far as I can tell, there's still no way within Lean to get a module doc string from outside the current file. You're storing it in the oleans now, but it's not accessible by a metaprogram yet, right?</p>",
        "id": 180435480,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573488230
    },
    {
        "content": "<p>I spent a little too long doing this this afternoon, and it's clearly still rough. Here are mathlib docs generated by a combination of metaprogramming and Python: <a href=\"http://robertylewis.com/mathlib_docs/\" target=\"_blank\" title=\"http://robertylewis.com/mathlib_docs/\">http://robertylewis.com/mathlib_docs/</a></p>",
        "id": 180447867,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573497331
    },
    {
        "content": "<p>Essentially, it folds through the environment and writes a json file with the info needed to display. A Python script formats it and tries to link identifiers that it finds in code blocks. Right now, the Python script scrapes module docs from the Lean source files. This will be cleaner if/when they're accessible with a metaprogram.</p>",
        "id": 180448038,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573497464
    },
    {
        "content": "<p>The formatting is modular. If it's better to produce the data from C++ or olean-rs or whatever, that works too.</p>",
        "id": 180448163,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573497580
    },
    {
        "content": "<p>This is completely awesome!</p>",
        "id": 180448381,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1573497762
    },
    {
        "content": "<p>Rob, did you put the code somewhere? How can we help? We definitely need some CSS work.</p>",
        "id": 180458021,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573504794
    },
    {
        "content": "<p>I left the office without pushing it anywhere, but I'll make it available tomorrow. If you want to work on the CSS, you could work on a single file as an example.</p>",
        "id": 180458283,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505013
    },
    {
        "content": "<p>The code is almost certainly not Windows friendly.</p>",
        "id": 180458346,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505055
    },
    {
        "content": "<p>Who cares?</p>",
        "id": 180458359,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573505074
    },
    {
        "content": "<p>And scraping the module docs from source is really ugly. It will be more portable if we can avoid that.</p>",
        "id": 180458362,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505078
    },
    {
        "content": "<p>Well, me when I'm at home working on my laptop...</p>",
        "id": 180458365,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505086
    },
    {
        "content": "<p>You could also try to think of a way to linkify notation. There's not a general solution, since notation can reference more than one declaration, so there's no unique place to link it to. But it looks wrong to have <code>ℕ</code> not be a link.</p>",
        "id": 180458563,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505249
    },
    {
        "content": "<p>The first easy thing to do is to filter out <code>_inst_. : </code>.</p>",
        "id": 180458657,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573505318
    },
    {
        "content": "<p>That's hopeless if we're using a metaprogram to generate the data, but <span class=\"user-mention\" data-user-id=\"128280\">@Wojciech Nawrocki</span> or <span class=\"user-mention\" data-user-id=\"143402\">@matt rice</span> 's approaches might be able to do more.</p>",
        "id": 180458658,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505319
    },
    {
        "content": "<p>We really need Lean to cooperate here</p>",
        "id": 180458660,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573505320
    },
    {
        "content": "<p>Could all of this be easier as an extension of Lean 3.5.c?</p>",
        "id": 180458675,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573505341
    },
    {
        "content": "<p>With small changes to 3.5 I think we could avoid scraping the module docs from the source, at least.</p>",
        "id": 180458785,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505412
    },
    {
        "content": "<p>Even if we don't switch mathlib over to lean 3.5.c, we could still use 3.5.c to generate the docs</p>",
        "id": 180458834,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1573505458
    },
    {
        "content": "<p>Lean 3.5 can already build mathlib, right? So adding stuff that would make documentation easier seems like a very good idea.</p>",
        "id": 180458846,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573505475
    },
    {
        "content": "<p>Yeah, of course. Wojciech has already been working on the module doc API there.</p>",
        "id": 180458923,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573505529
    },
    {
        "content": "<blockquote>\n<p>As far as I can tell, there's still no way within Lean to get a module doc string from outside the current file. You're storing it in the oleans now, but it's not accessible by a metaprogram yet, right?</p>\n</blockquote>\n<p>This is correct. I have a local branch in which they're accessible from C++ - I could add a tactic that exposes this storage.</p>",
        "id": 180459089,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573505698
    },
    {
        "content": "<p>The generated html is not well-formed and lacks classes, so working on CSS is not yet possible (but there is no hurry of course).</p>",
        "id": 180459482,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573506009
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> Just wanted to note that there is a branch on lumpy json-input for trying out Wojciech's approach in lumpy, I haven't got it using any of the additional information accessible yet, but i'll probably migrate to that if it works out.</p>",
        "id": 180459563,
        "sender_full_name": "matt rice",
        "timestamp": 1573506058
    },
    {
        "content": "<p>Another formatting thing that might be nice: instead of printing the name above and the full type below, we could bind variables with the name. So instead of</p>\n<div class=\"codehilite\"><pre><span></span>iff_of_eq\n∀ {a b : Prop}, a = b → (a ↔ b)\n</pre></div>\n\n\n<p>we'd have</p>\n<div class=\"codehilite\"><pre><span></span>iff_of_eq {a b : Prop} (h : a = b)\n(a ↔ b)\n</pre></div>\n\n\n<p>This would take some experimenting to get the formatting right. The identifier needs to stand out.</p>",
        "id": 180459573,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573506065
    },
    {
        "content": "<p>In fact, I also have something that sounds like your JSON generation. <a href=\"/user_uploads/3121/OvxPkFcVrOqwxxzgaeskCnQf/hensel.json\" target=\"_blank\" title=\"hensel.json\">hensel.json</a> is an example. It kind of works but performance is really bad as of now, so I'd like to fix that before PRing to lean 3.5. There is also all the internally-generated noise (<code>_private.1428265847.newton_seq_dist_tendsto'</code>) which I didn't try to do anything about just yet.<br>\n<span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> does this JSON look similar to what you were exporting?<br>\n<span class=\"user-mention\" data-user-id=\"143402\">@matt rice</span> also has a <a href=\"https://github.com/ratmice/lumpy-leandoc/tree/json_input\" target=\"_blank\" title=\"https://github.com/ratmice/lumpy-leandoc/tree/json_input\">branch</a> of lumpy-leandoc which can parse the JSON</p>",
        "id": 180459690,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573506161
    },
    {
        "content": "<p>Yeah, same idea, slightly different structure, but it would be easy to convert.</p>",
        "id": 180459801,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573506271
    },
    {
        "content": "<p>For the internal stuff, there are some meta defs that filter it that we use in the linter.</p>",
        "id": 180459851,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573506347
    },
    {
        "content": "<p>They could probably be replicated in C++.</p>",
        "id": 180459909,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573506382
    },
    {
        "content": "<p>Because I don't know anything about this black magic going on in this thread I've only half been paying attention. But several people have been in touch with me (because of natnumgame) asking me what maths Lean now has, what maths it needs etc. I am currently pouring all my Lean time into constructing a challenging inequality world for nng but once that's done I was thinking of a blog post of the form \"hey, here's what we have now [list of stuff] and here's what we would like [list of other stuff]. I thought I'd mention this here because I was wondering if I could somehow integrate this list into the story somehow, e.g. \"for more about groups, see this link here\". </p>\n<p>Puny initial attempt of \"what we need\" is here: <a href=\"https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt\" target=\"_blank\" title=\"https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt\">https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt</a> (completely unfinished, the result of a number theoretic brain-dump).</p>",
        "id": 180462503,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1573508410
    },
    {
        "content": "<p>Maybe the <a href=\"https://github.com/leanprover-community/mathlib/blob/master/docs/theories.md\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/docs/theories.md\">\"theories\" docs</a> could be updated / reworked as well?</p>",
        "id": 180462841,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1573508693
    },
    {
        "content": "<p>Of course it should be updated. And maybe the we should bring it closer to the Lean file, and put it on the same website, with links to the \"per Lean file webpages\".</p>",
        "id": 180463410,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573509216
    },
    {
        "content": "<p>I'm not sure we should rush to make the html docs public. This kind of thing works better with fixed releases of mathlib. Having it constantly update makes it harder to link to and harder for Google to index.</p>",
        "id": 180463475,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509252
    },
    {
        "content": "<p>That said, it's not a huge deal if we put up a draft version soon-ish.</p>",
        "id": 180463504,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509292
    },
    {
        "content": "<p>A lot of the md files in mathlib would be better converted to html and put on the community webpage.</p>",
        "id": 180463528,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509322
    },
    {
        "content": "<p>Kevin's list would fit there too, if he wants it to be less Kevin and more mathlib.</p>",
        "id": 180463546,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509345
    },
    {
        "content": "<p>I could easily allow lumpy to read .md as well as lean and just do a straight html conversion</p>",
        "id": 180463638,
        "sender_full_name": "matt rice",
        "timestamp": 1573509412
    },
    {
        "content": "<blockquote>\n<p>I could easily allow lumpy to read .md as well as lean and just do a straight html conversion</p>\n</blockquote>\n<p>For static pages (that aren't generated from the library), it's not necessary. We already use Jekyll to generate the site. Stick the right header on the md file and it will fit right in, styled and everything.</p>",
        "id": 180463743,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509505
    },
    {
        "content": "<p>For things like the tactic docs that change a lot, maybe incorporating them into the doc generation would be good.</p>",
        "id": 180463790,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573509540
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/lean/pull/81\" target=\"_blank\" title=\"https://github.com/leanprover-community/lean/pull/81\">81</a> should do what you need.</p>",
        "id": 180471263,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573517960
    },
    {
        "content": "<blockquote>\n<p>Rob, did you put the code somewhere? How can we help? We definitely need some CSS work.</p>\n</blockquote>\n<p><a href=\"https://github.com/robertylewis/doc_gen/\" target=\"_blank\" title=\"https://github.com/robertylewis/doc_gen/\">https://github.com/robertylewis/doc_gen/</a></p>",
        "id": 180503882,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573556294
    },
    {
        "content": "<p>It generates valid html now, and colors declarations based on whether they're theorems, defs, etc.</p>",
        "id": 180503920,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573556344
    },
    {
        "content": "<p>One more update for now. I should stop wasting time on this.</p>",
        "id": 180514776,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573564806
    },
    {
        "content": "<p><a href=\"http://robertylewis.com/mathlib_docs/linear_algebra/basis.html\" target=\"_blank\" title=\"http://robertylewis.com/mathlib_docs/linear_algebra/basis.html\">http://robertylewis.com/mathlib_docs/linear_algebra/basis.html</a></p>",
        "id": 180514824,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573564852
    },
    {
        "content": "<p>It looks like we'll have to be careful now about making sure that module docs and docstrings render well. The second wikipedia URL at the top of <a href=\"http://robertylewis.com/mathlib_docs/ring_theory/maps.html\" target=\"_blank\" title=\"http://robertylewis.com/mathlib_docs/ring_theory/maps.html\">ring_theory/maps</a> has underscores which are interpreted as markdown.</p>",
        "id": 180521855,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1573569225
    },
    {
        "content": "<p>Yeah, there are tons of problems. It's hard to get it correct without seeing the end results. A lot more needs to be enclosed in backticks.</p>",
        "id": 180523235,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573570090
    },
    {
        "content": "<blockquote>\n<p>It looks like we'll have to be careful now about making sure that module docs and docstrings render well. The second wikipedia URL at the top of <a href=\"http://robertylewis.com/mathlib_docs/ring_theory/maps.html\" target=\"_blank\" title=\"http://robertylewis.com/mathlib_docs/ring_theory/maps.html\">ring_theory/maps</a> has underscores which are interpreted as markdown.</p>\n</blockquote>\n<p>I managed to fix this and some mangled lists by passing the right options to the markdown formatter.</p>",
        "id": 180562529,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573593234
    },
    {
        "content": "<p>Unfortunately there doesn't seem to be an option to turn the urls into links.</p>",
        "id": 180562594,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573593253
    },
    {
        "content": "<p>Would it be unreasonnable to write markdown urls in Lean file?</p>",
        "id": 180562655,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573593300
    },
    {
        "content": "<p>That seems totally reasonable.</p>",
        "id": 180562694,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573593332
    },
    {
        "content": "<p>I'm pretty sure there are currently very few of them, and they are very easy to find.</p>",
        "id": 180562713,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573593355
    },
    {
        "content": "<p>So we could easily switch.</p>",
        "id": 180562725,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573593361
    },
    {
        "content": "<p>Yeah. I think we're going to find tons of things that need to be fixed. The mistakes become obvious once you actually parse the markdown.</p>",
        "id": 180563291,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573593681
    },
    {
        "content": "<p>So, I'm reaching a point where I'm kind of happy with the layout/CSS. Comments are welcome. <a href=\"https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html\" target=\"_blank\" title=\"https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html\">https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html</a></p>",
        "id": 180621579,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649427
    },
    {
        "content": "<p>Declaration names link to the corresponding line on GitHub.</p>",
        "id": 180621625,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649462
    },
    {
        "content": "<p>Are you color-blind? I'm asking out of curiosity.</p>",
        "id": 180621646,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649471
    },
    {
        "content": "<p>What? No, it's a random color palette some website gave me.</p>",
        "id": 180621692,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649507
    },
    {
        "content": "<p>We need a web designer.</p>",
        "id": 180621779,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649547
    },
    {
        "content": "<p>The pink does jump out a little too much.</p>",
        "id": 180621781,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649553
    },
    {
        "content": "<p>Yes, the pink in particular.</p>",
        "id": 180621798,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649567
    },
    {
        "content": "<p>And it does feel old too.</p>",
        "id": 180621804,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649576
    },
    {
        "content": "<p>And I think keeping the keywords <code>def</code>, <code>lemma</code> etc. would help.</p>",
        "id": 180621845,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649620
    },
    {
        "content": "<p>I should have first written that the current result is already amazing!</p>",
        "id": 180621911,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649655
    },
    {
        "content": "<p>You're welcome to suggest alternate colors!</p>",
        "id": 180621913,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649657
    },
    {
        "content": "<blockquote>\n<p>And I think keeping the keywords <code>def</code>, <code>lemma</code> etc. would help.</p>\n</blockquote>\n<p>Oh, yeah, I meant to do this. I don't think there's any way to distinguish lemma/theorem, so we'd need to pick one.</p>",
        "id": 180621943,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649683
    },
    {
        "content": "<p>It gets a little complicated with structures and inductives, because those are \"constants\" in the environment. But it should be possible to identify that.</p>",
        "id": 180621996,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649721
    },
    {
        "content": "<p>It would be nice to use LaTeX in module docstrings when not quoting Lean code.</p>",
        "id": 180622057,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649753
    },
    {
        "content": "<p>It's easy enough to support MathJax.</p>",
        "id": 180622158,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649788
    },
    {
        "content": "<p>Is there a link to the GitHub page of the file somewhere? (I know there are links to individual declarations, although they come as a surprise).</p>",
        "id": 180622168,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649798
    },
    {
        "content": "<p>It's kind of a minefield though</p>",
        "id": 180622179,
        "sender_full_name": "matt rice",
        "timestamp": 1573649807
    },
    {
        "content": "<p>We should also think about having a responsive layout, for small screen browsing.</p>",
        "id": 180622222,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649828
    },
    {
        "content": "<blockquote>\n<p>Is there a link to the GitHub page of the file somewhere? (I know there are links to individual declarations, although they come as a surprise).</p>\n</blockquote>\n<p>No, where would you suggest adding it?</p>",
        "id": 180622231,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649834
    },
    {
        "content": "<p>Somewhere at the top probably.</p>",
        "id": 180622283,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649862
    },
    {
        "content": "<p>Maybe even h1 could be a link.</p>",
        "id": 180622312,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649875
    },
    {
        "content": "<p>I've been leaning towards something like dvisvgm in lumpy which can convert pretty much any old tex to svg</p>",
        "id": 180622330,
        "sender_full_name": "matt rice",
        "timestamp": 1573649881
    },
    {
        "content": "<p>What I did for my masters thesis was to basically rip off <a href=\"https://doc.rust-lang.org/std/primitive.i32.html\" target=\"_blank\" title=\"https://doc.rust-lang.org/std/primitive.i32.html\">Rust</a>'s CSS, which gave me a nice basic layout without any effort on my side...</p>",
        "id": 180622371,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1573649883
    },
    {
        "content": "<blockquote>\n<p>It's kind of a minefield though</p>\n</blockquote>\n<p>I don't know much about it. We can add hooks in the markdown processing that capture <code>$$ ... $$</code> blocks. That's as far as I got.</p>",
        "id": 180622424,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649912
    },
    {
        "content": "<p>But I don't want to distract you from <code>polya</code>, I shouldn't be writing those comments, and try to find time to try something on my side.</p>",
        "id": 180622458,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649936
    },
    {
        "content": "<blockquote>\n<p>Maybe even h1 could be a link.</p>\n</blockquote>\n<p>This is slightly tricky actually. The entire top block is the module doc from the Lean file. It's much easier to add things around it than inside it.</p>",
        "id": 180622484,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573649954
    },
    {
        "content": "<p>Sebastian is right, I'm sure we can steal ideas without hiring a web designer.</p>",
        "id": 180622488,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573649958
    },
    {
        "content": "<p>Yeah, I'm not very interested in making major design changes myself. If someone else wants to reformat I'm very happy to let them.</p>",
        "id": 180622720,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573650092
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>It's kind of a minefield though</p>\n</blockquote>\n<p>I don't know much about it. We can add hooks in the markdown processing that capture <code>$$ ... $$</code> blocks. That's as far as I got.</p>\n</blockquote>\n<p>Yeah I think the hard part is that each markdown tool supports variations on a similar syntax, but somehow they all manage to be different<br>\nand there is no standard to be found anywhere. here is a breakdown someone did <a href=\"https://github.com/cben/mathdown/wiki/math-in-markdown#appendix-summary-table\" target=\"_blank\" title=\"https://github.com/cben/mathdown/wiki/math-in-markdown#appendix-summary-table\">mathdown</a></p>",
        "id": 180623060,
        "sender_full_name": "matt rice",
        "timestamp": 1573650277
    },
    {
        "content": "<blockquote>\n<p>Maybe even h1 could be a link.</p>\n</blockquote>\n<p>Oh, most files don't even have an h1 because there's no module doc. I'll add a \"View file source\" link in the navigation panel instead.</p>",
        "id": 180623614,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573650685
    },
    {
        "content": "<blockquote>\n<p>Yeah I think the hard part is that each markdown tool supports variations on a similar syntax, but somehow they all manage to be different</p>\n</blockquote>\n<p>Right now I'm using the markdown2 library for Python which I don't think supports anything. But I can extract the raw text and feed it somewhere else for processing.</p>",
        "id": 180623770,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573650793
    },
    {
        "content": "<p>Again, in principle, I haven't actually looked into it yet.</p>",
        "id": 180623778,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573650802
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>  about your suggestion in <a href=\"https://github.com/leanprover-community/lean/pull/81\" target=\"_blank\" title=\"https://github.com/leanprover-community/lean/pull/81\">81</a>, If we added h2 to those groupings and had links for those too,</p>",
        "id": 180623813,
        "sender_full_name": "matt rice",
        "timestamp": 1573650839
    },
    {
        "content": "<p>And since there's almost no LaTeX in md blocks right now, I don't think it's a priority!</p>",
        "id": 180623864,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573650858
    },
    {
        "content": "<p>With mathjax you only need to make sure LaTeX parts are untouched.</p>",
        "id": 180623867,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573650858
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110596\">Rob Lewis</span>  about your suggestion in <a href=\"https://github.com/leanprover-community/lean/pull/81\" target=\"_blank\" title=\"https://github.com/leanprover-community/lean/pull/81\">81</a>, If we added h2 to those groupings and had links for those too,</p>\n</blockquote>\n<p>Yeah, we could build a TOC and put it after the header block if there are any subsections to link to.</p>",
        "id": 180624085,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573651045
    },
    {
        "content": "<p><em>nod</em> my markdown parser doesn't handle them either (well, it refuses until there is a standard).</p>\n<p>i've been using e.g.</p>\n<div class=\"codehilite\"><pre><span></span>```latex\n```\nand\n```math\n```\n</pre></div>",
        "id": 180624187,
        "sender_full_name": "matt rice",
        "timestamp": 1573651094
    },
    {
        "content": "<p>a bit verbose...</p>",
        "id": 180624223,
        "sender_full_name": "matt rice",
        "timestamp": 1573651123
    },
    {
        "content": "<p>Anyhow, I know Rob's is a lot nicer, but set up a page with the current index generation here: <a href=\"https://lumpy-leandoc.github.io/doc_preview/\" target=\"_blank\" title=\"https://lumpy-leandoc.github.io/doc_preview/\">doc_preview</a></p>",
        "id": 180643521,
        "sender_full_name": "matt rice",
        "timestamp": 1573662071
    },
    {
        "content": "<p>The problem with mathjax/katex is that they both have absolutely zero support for diagrams, so if category theorists wanted to draw something with TikZ, it wouldn't work. Dvisvgm does support that, but requires offline generation of svgs.</p>",
        "id": 180650505,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573666022
    },
    {
        "content": "<p>Alright. Another update, with better support for structures/inductives, printing def/lemma/etc, and a few more tweaks. <a href=\"https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html\" target=\"_blank\" title=\"https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html\">https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html</a></p>",
        "id": 180651818,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573666777
    },
    {
        "content": "<p>The code is now more or less portable. <a href=\"https://github.com/robertylewis/doc_gen\" target=\"_blank\" title=\"https://github.com/robertylewis/doc_gen\">https://github.com/robertylewis/doc_gen</a></p>",
        "id": 180651846,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573666792
    },
    {
        "content": "<p><code>update-mathlib</code> isn't working when I try to do this locally. It says it succeeds, but then Lean wants to compile all of mathlib, even if I touch all the oleans first.</p>",
        "id": 180651985,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573666860
    },
    {
        "content": "<p>So if you try to install it you might need to do a full compile or get the oleans from elsewhere. Or maybe it's an issue on my end.</p>",
        "id": 180652170,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1573666961
    },
    {
        "content": "<blockquote>\n<p>The problem with mathjax/katex is that they both have absolutely zero support for diagrams, so if category theorists wanted to draw something with TikZ, it wouldn't work. Dvisvgm does support that, but requires offline generation of svgs.</p>\n</blockquote>\n<p>Absolutely zero support for diagrams is a little strong, <a href=\"https://github.com/sonoisa/XyJax\" target=\"_blank\" title=\"https://github.com/sonoisa/XyJax\">https://github.com/sonoisa/XyJax</a> does exist for mathjax and I've used it for many years as has the stacks project (<a href=\"https://stacks.math.columbia.edu/tag/0BW7\" target=\"_blank\" title=\"https://stacks.math.columbia.edu/tag/0BW7\">https://stacks.math.columbia.edu/tag/0BW7</a>), it is basically unsupported officially though and  might even be broken with mathjax 3.0.</p>",
        "id": 180655338,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1573669000
    },
    {
        "content": "<p>I don't think we should encourage people to use <code>xypic</code> in 2019. Accepting tikz-cd with server-side rendering seems much wiser.</p>",
        "id": 180667952,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573676663
    },
    {
        "content": "<p>I just found a project to render Tikz in the browser with WebAssembly: <a href=\"https://github.com/kisonecat/tikzjax\" target=\"_blank\" title=\"https://github.com/kisonecat/tikzjax\">https://github.com/kisonecat/tikzjax</a></p>",
        "id": 180668595,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1573677059
    },
    {
        "content": "<p>I'm not encouraging, simply stating the facts that it is possible with client-side js</p>",
        "id": 180669241,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1573677387
    },
    {
        "content": "<p>This tikz project seems very cool though!</p>",
        "id": 180669275,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1573677409
    },
    {
        "content": "<p>Ah sorry, I meant \"out-of-the-box support\". Tikzjax certainly looks interesting, but I would question its stability - reloading a coredump of the entire TeX compiler in the browser sounds a bit crazy.</p>",
        "id": 180675122,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1573680711
    },
    {
        "content": "<p>Server (ie author)-side rendering looks much simpler and faster. You don't want you browser to reflow a commutative diagram anyway.</p>",
        "id": 180675299,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1573680817
    },
    {
        "content": "<p>How many commutative diagrams do we have in the docstrings right now?</p>",
        "id": 180677893,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1573682626
    },
    {
        "content": "<p>Okay, I found a bit more time to work on this. Here's a refresh. Maybe the colors are more to Patrick's taste. <a href=\"https://robertylewis.com/mathlib_docs/\" target=\"_blank\" title=\"https://robertylewis.com/mathlib_docs/\">https://robertylewis.com/mathlib_docs/</a></p>",
        "id": 181202029,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574252658
    },
    {
        "content": "<p>This builds with <span class=\"user-mention\" data-user-id=\"128280\">@Wojciech Nawrocki</span> 's additions to 3.5c, so it can display module docs used to section a file. I don't think we have any of these in mathlib yet, but here's a demo: <a href=\"https://robertylewis.com/mathlib_docs/topology/whoa.html\" target=\"_blank\" title=\"https://robertylewis.com/mathlib_docs/topology/whoa.html\">https://robertylewis.com/mathlib_docs/topology/whoa.html</a></p>",
        "id": 181202207,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574252779
    },
    {
        "content": "<p>The font for theorem statements is a bit large (being used also as the header). Most statements don't fit on one line, and a decent fraction of them seem to have the line break exactly where things get interesting</p>",
        "id": 181202428,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574252950
    },
    {
        "content": "<p>One possibility is to remove all implicit and instance implicit arguments from the main display, and put them in smaller type afterward</p>",
        "id": 181202558,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253032
    },
    {
        "content": "<p>Nice work! Starts to look really good. I agree with Mario's points though.</p>",
        "id": 181202626,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574253086
    },
    {
        "content": "<p>Also, you might try to detect unnamed hypotheses by type so that you can turn more arguments into arrows (especially arguments named <code>a_1</code>, <code>a_2</code> that were arrows to begin with)</p>",
        "id": 181202736,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253177
    },
    {
        "content": "<p>Sure, it's easy enough to change the font sizes. The line breaks will obviously depend on how wide your window is. This can be fiddled with.</p>",
        "id": 181202757,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253211
    },
    {
        "content": "<blockquote>\n<p>One possibility is to remove all implicit and instance implicit arguments from the main display, and put them in smaller type afterward</p>\n</blockquote>\n<p>Not sure exactly what you have in mind with \"put them in smaller type afterward.\" Do you mean state the type twice, once without implicits and once with?</p>",
        "id": 181202824,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253247
    },
    {
        "content": "<blockquote>\n<p>Also, you might try to detect unnamed hypotheses by type so that you can turn more arguments into arrows (especially arguments named <code>a_1</code>, <code>a_2</code> that were arrows to begin with)</p>\n</blockquote>\n<p>What's the robust way to do this? In effect, \"intros until the last named argument.\"</p>",
        "id": 181202932,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253348
    },
    {
        "content": "<p>not sure if it's better to quote just the omitted implicits or the full type. I was thinking something like:</p>\n<ul>\n<li>Line 1 (header): <code>theorem add_monoid.zero_smul (a : β) :</code></li>\n<li>Line 2 (main text): <code>add_monoid.smul 0 a = 0</code></li>\n<li>Line 3 (footnote size): <code>@[simp]</code>; <code>{β : Type u} [add_monoid β]</code></li>\n</ul>",
        "id": 181203059,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253452
    },
    {
        "content": "<p>If you have expr info, you can check whether a variable appears in the body to determine if it can be \"arrowed\"</p>",
        "id": 181203159,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253519
    },
    {
        "content": "<p>there is an expr function for this</p>",
        "id": 181203178,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253536
    },
    {
        "content": "<p><code>expr.is_arrow</code></p>",
        "id": 181203203,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253558
    },
    {
        "content": "<p>which uses <code>expr.has_var</code></p>",
        "id": 181203217,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253582
    },
    {
        "content": "<p>I don't feel strongly about how much lean syntax to use in these displays. I and many others will be used to it, but I would also be happy with something that reimagines the syntax a bit or puts more things in a prose style</p>",
        "id": 181203396,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574253735
    },
    {
        "content": "<blockquote>\n<p>not sure if it's better to quote just the omitted implicits or the full type. I was thinking something like:</p>\n<ul>\n<li>Line 1 (header): <code>theorem add_monoid.zero_smul (a : β) :</code></li>\n<li>Line 2 (main text): <code>add_monoid.smul 0 a = 0</code></li>\n<li>Line 3 (footnote size): <code>@[simp]</code>; <code>{β : Type u} [add_monoid β]</code></li>\n</ul>\n</blockquote>\n<p>Hmm. This hides the information about where the implicits appear in the signature. Usually you don't need to know this but sometimes you do, and it limits how useful the docs are if they don't give it. What about a javascript toggle to flip between \"all variables\" and \"explicit only\"? \"explicit only\" could be the default.</p>",
        "id": 181203502,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253839
    },
    {
        "content": "<p>I hate to suggest more javascript work for me to do, but it would look nice.</p>",
        "id": 181203564,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253862
    },
    {
        "content": "<blockquote>\n<p><code>expr.is_arrow</code></p>\n</blockquote>\n<p>Ah, right. I think I can do this easily.</p>",
        "id": 181203601,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574253905
    },
    {
        "content": "<p>I know that this makes exact implicit order not visible, but I think that's a tolerable tradeoff. We already have methods like <code>#print</code> or hovers for getting this kind of info from a definition, and we're already not sharing some information that might be relevant, like the definition or proof itself</p>",
        "id": 181203766,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574254044
    },
    {
        "content": "<p>If you want to have a JS toggle for this, I wouldn't mind it though</p>",
        "id": 181203852,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574254095
    },
    {
        "content": "<p>For a much harder problem, I would really like to see some proof displays. I have gotten a lot of value out of the metamath web pages that give super detailed proofs of anything you could hope for, and it would be great if lean had anything half as good</p>",
        "id": 181204019,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574254229
    },
    {
        "content": "<p>I think the best kind of proof display we'll have in the near future is the current \"click the declaration name to go to the source on GitHub.\" It doesn't seem helpful to display full proof terms. And adding any sort of interactivity to a displayed proof script seems... challenging.</p>",
        "id": 181204693,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574254813
    },
    {
        "content": "<p>Like I said, it's not an easy problem. I can dream though</p>",
        "id": 181204840,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574254956
    },
    {
        "content": "<p>I actually <em>do</em> want to see full proof terms, just not in the horrible way <code>pp.all</code> does it</p>",
        "id": 181204890,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574255026
    },
    {
        "content": "<p>interactivity opens up a huge number of possibilities here, and the space is certainly not well explored</p>",
        "id": 181204956,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574255072
    },
    {
        "content": "<p>Fair enough. For a really good display I'm not sure even the proof term is enough. My dream interactive browser would note when a proof term was generated by a certain tactic. I agree it's not well explored, but it would take a lot of exploring to get to something really useful.</p>",
        "id": 181205449,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574255479
    },
    {
        "content": "<p>You certainly need the types of subterms. There is probably a way to turn such information into something like an evolving tactic state</p>",
        "id": 181205528,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574255543
    },
    {
        "content": "<p>you are right that recovering provenance data is hard to impossible and also pretty valuable (although not the whole story). I always felt cheated when I went through an isabelle tutorial and everything was <code>by auto</code>. I wasn't any closer to understanding why fact X is true, and the computer didn't know how to communicate why</p>",
        "id": 181205649,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574255667
    },
    {
        "content": "<blockquote>\n<p>Maybe the colors are more to Patrick's taste.</p>\n</blockquote>\n<p>If they're not then you can tell him to fix it up himself ;-) They look fine to me! (but then again I guess you could question my tastes in colours...)</p>",
        "id": 181205776,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1574255765
    },
    {
        "content": "<p>What is doable is to diplay the proof taken from the Lean file, with tactic state as it appears in VScode. This is what is done by format_lean.</p>",
        "id": 181206949,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1574256769
    },
    {
        "content": "<p>that doesn't solve the <code>by auto</code> problem though (or <code>by tidy</code> in our case)</p>",
        "id": 181207064,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574256877
    },
    {
        "content": "<p>Sure, but it would already be a huge improvement.</p>",
        "id": 181207081,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1574256898
    },
    {
        "content": "<p>true</p>",
        "id": 181207106,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1574256925
    },
    {
        "content": "<blockquote>\n<p>you are right that recovering provenance data is hard to impossible and also pretty valuable (although not the whole story). I always felt cheated when I went through an isabelle tutorial and everything was <code>by auto</code>. I wasn't any closer to understanding why fact X is true, and the computer didn't know how to communicate why</p>\n</blockquote>\n<p>The problem is that sometimes the answer to \"why\" is \"by auto,\" and sometimes the answer is what auto did, so you you need the option to see both.</p>",
        "id": 181207240,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574257020
    },
    {
        "content": "<p>This reminds me of Lamport's structured proofs <a href=\"https://lamport.azurewebsites.net/pubs/proof.pdf\" target=\"_blank\" title=\"https://lamport.azurewebsites.net/pubs/proof.pdf\">https://lamport.azurewebsites.net/pubs/proof.pdf</a></p>",
        "id": 181207870,
        "sender_full_name": "Reid Barton",
        "timestamp": 1574257512
    },
    {
        "content": "<p>Okay. It's updated to print implicit arguments below, and to prefer arrows in the type to named arrows when that makes sense. I still have all the data so it won't be hard to create a JS toggle to show the full type. The hardest thing there will be where to put the button.</p>",
        "id": 181214937,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574262214
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110043\">@Gabriel Ebner</span> pointed out a big benefit of making these docs public, even though they're in an early state: they make it much easier to notice doc strings that are missing, wrong, malformed, etc. So I've put them up at an \"official\" location. <a href=\"https://leanprover-community.github.io/mathlib_docs/\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/\">https://leanprover-community.github.io/mathlib_docs/</a></p>",
        "id": 181636998,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574429253
    },
    {
        "content": "<p>I don't know how well the search will work. We need to wait for Google to index the docs before it will work at all.</p>",
        "id": 181637018,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574429279
    },
    {
        "content": "<p>At some point we'll want to regenerate them daily. I think it's probably best to do this as part of the Travis build that updates <code>lean-3.4.2</code>, but maybe it's better to use <span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> 's server?</p>",
        "id": 181637352,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574429568
    },
    {
        "content": "<p>I love that the first doc string I looked at was this one: <a href=\"https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13\">https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13</a></p>",
        "id": 181637353,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1574429574
    },
    {
        "content": "<p>There's, uh, a big range of doc string quality in the library right now...</p>",
        "id": 181637443,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574429653
    },
    {
        "content": "<p>Unfortunately we can't (yet) have a linter for that. The problem is NLP-complete...</p>",
        "id": 181637472,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574429685
    },
    {
        "content": "<p>On the other side of things from <code>is unit</code> are <span class=\"user-mention\" data-user-id=\"110050\">@Sebastien Gouezel</span> 's files. <a href=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html\">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html</a></p>",
        "id": 181637667,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574429859
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> Here's a little comment: consider <a href=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html\">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html</a><br>\nI think the stuff under main definitions is typeset as a list in the source code. Is there some markdownish reason why that didn't happen here?</p>",
        "id": 181638565,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574430511
    },
    {
        "content": "<p>I guess <a href=\"https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36\">https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36</a> is not interpreted as a list by markdown</p>",
        "id": 181638628,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574430561
    },
    {
        "content": "<p>Because it's not actually typeset as a list.</p>",
        "id": 181638632,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430568
    },
    {
        "content": "<p>Each item should start with <code>*</code> or <code>-</code> or something.</p>",
        "id": 181638649,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430590
    },
    {
        "content": "<p>Yes, my mistake, I did not write it using proper markdown (as I was not aware at the time that real markdown would be relevant).</p>",
        "id": 181638716,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1574430617
    },
    {
        "content": "<p>This is why I wanted to publicize the HTML docs. These things are impossible to see in the Lean files, but obvious when you see them in action.</p>",
        "id": 181638740,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430641
    },
    {
        "content": "<p>What is the reason that <code>times_cont_diff_groupoid</code> is hyperlinked in that blob of text, but other names are not?</p>",
        "id": 181638803,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574430681
    },
    {
        "content": "<p>Because that's the full name. The other things have namespaces in front of them.</p>",
        "id": 181638851,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430716
    },
    {
        "content": "<p>Ach so</p>",
        "id": 181638900,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1574430727
    },
    {
        "content": "<p>I don't think there's any way around this, the name resolution would be ambiguous.</p>",
        "id": 181638943,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430752
    },
    {
        "content": "<p>Actually -- in this case that might not be the issue, <code>smooth_manifold_with_corners</code> isn't namespaced.</p>",
        "id": 181639025,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430811
    },
    {
        "content": "<p>Not sure why that's failing to link. I'll look into it soon.</p>",
        "id": 181639110,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1574430866
    },
    {
        "content": "<p>With the power of Observable, I've written <a href=\"https://observablehq.com/@bryangingechen/github-lean-doc-preview\" target=\"_blank\" title=\"https://observablehq.com/@bryangingechen/github-lean-doc-preview\">a tool</a> that renders all the markdown docstrings in a Lean file on GitHub. You can also paste in the URL to a PR (or even just the number of a PR to mathlib) and all the docstrings in the changed Lean files will be displayed. I hope this will be useful for mathlib PR reviewers or contributors who want to check the markdown in their docstrings. </p>\n<p>Note that I'm not able to show the declaration (with the name / type) corresponding to the docstring at the moment. Also, the tool relies on <a href=\"https://github.com/markedjs/marked\" target=\"_blank\" title=\"https://github.com/markedjs/marked\"><code>marked</code></a> so some things may appear slightly different from mathlib_docs, which uses markdown2. Let me know if there's anything I can change to make it easier to use!</p>",
        "id": 181701826,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1574488788
    },
    {
        "content": "<p>Another example: <a href=\"http://isarmathlib.org/\" target=\"_blank\" title=\"http://isarmathlib.org/\">This presentation</a> of Isabelle/ZF theories is quite nice.</p>",
        "id": 182603503,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1575496077
    },
    {
        "content": "<p>The docs are updated, thanks largely to <span class=\"user-mention\" data-user-id=\"110043\">@Gabriel Ebner</span> ! <a href=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html\">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html</a></p>\n<p>New features include prettier styling, collapsible display of implicit arguments, linked notation, and lists of class instances (see the collapsible list at <a href=\"https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module\">https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module</a>).</p>",
        "id": 183642427,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1576584784
    },
    {
        "content": "<p>IMHO, this is absolutely awesome. Clicking around a bit I wonder if it would be worth styling the links to GH source differently from the links to elsewhere in the docs.</p>",
        "id": 183645223,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1576587402
    },
    {
        "content": "<p>Anyway, great work.</p>",
        "id": 183645237,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1576587421
    },
    {
        "content": "<p>An early Christmas present for you all: I've added some of the mathlib doc files (<a href=\"https://github.com/leanprover-community/mathlib/issues/1815\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/issues/1815\">#1815</a>) to the doc display. <a href=\"https://leanprover-community.github.io/mathlib_docs/tactic_writing.html\" target=\"_blank\" title=\"https://leanprover-community.github.io/mathlib_docs/tactic_writing.html\">https://leanprover-community.github.io/mathlib_docs/tactic_writing.html</a></p>",
        "id": 183949030,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1576858263
    },
    {
        "content": "<p>This is work in progress, the menus on the left aren't quite right yet.</p>",
        "id": 183949047,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1576858281
    },
    {
        "content": "<p>And, of course, the doc files themselves need updating.</p>",
        "id": 183949060,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1576858294
    },
    {
        "content": "<p>But there won't be much progress here for the next few weeks, so it's up for now!</p>",
        "id": 183949163,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1576858341
    },
    {
        "content": "<p>This is so cool. Our library is growing up :D</p>",
        "id": 183951803,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1576860274
    },
    {
        "content": "<p>I have a small contribution to mathlib docs website effort. I tried to fix CSS so I can use it on my phone. I modified one sample page and put it at <a href=\"https://www.math.u-psud.fr/~pmassot/test/\" target=\"_blank\" title=\"https://www.math.u-psud.fr/~pmassot/test/\">https://www.math.u-psud.fr/~pmassot/test/</a>. Please test on various screen sizes (but beware that clicking any link will bring you to the current website). <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> you can diff the html and CSS against the current website, changing the documentation generator should be extremely easy. This is minimal modification that, on screens narrower than 1000px, removes the left side bar and collapse the right one with a menu button on a sticky header.</p>",
        "id": 184347341,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1577485845
    },
    {
        "content": "<p>Thanks! I don't have time now, but I'll play around with it. The fixed \"Lean mathlib docs\" header looks a little funny on a wide screen, especially how it pushes the scroll bars and search windows down. It'll take some fiddling.</p>",
        "id": 184348846,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1577488071
    },
    {
        "content": "<p>This is very easy to fix. I just pushed a version which hides that header on wide screens. I guess we could instead give it a different background color, or put more stuff in it.</p>",
        "id": 184352140,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1577494026
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/issues/1927\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/issues/1927\">#1927</a></p>",
        "id": 186924871,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1580329285
    },
    {
        "content": "<p>Patrick, I haven't forgotten about your contribution. But the mobile friendly version still looks off on my non-mobile screens and I haven't found the energy to dive back into the CSS yet.</p>",
        "id": 186924965,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1580329344
    },
    {
        "content": "<p>I hope I'll be able to resume work on this next week (not before Wednesday though). Your recent work should make it easier for me to try things, but it would help to tell me more precisely what \"looks off\".</p>",
        "id": 186935810,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1580337054
    }
]