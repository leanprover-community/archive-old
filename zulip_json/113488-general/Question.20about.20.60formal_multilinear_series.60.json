[
    {
        "content": "<p>In my ongoing saga of merging in a proof that the density of squarefree integers is ζ(2)⁻¹, I was wondering about the best way to approach the <code>formal_multilinear_series</code> API. In particular, I wanted to formalize the fact that a uniform limit of holomorphic functions is holomorphic in a different way than <a href=\"https://github.com/leanprover-community/mathlib/pull/13500\">#13500</a>.</p>\n<p>Specifically, let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>n</mi></msub><mo>:</mo><mi mathvariant=\"double-struck\">C</mi><mo>→</mo><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">f_n : \\mathbb{C} → \\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> be a sequence of functions which are analytic on the disk of radius <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r &gt; 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> centered at <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> and which converge uniformly to some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> on that disk. Then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>n</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>∑</mo><msub><mi>a</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><msup><mi>z</mi><mi>i</mi></msup><mi mathvariant=\"normal\">/</mi><mi>i</mi><mo stretchy=\"false\">!</mo></mrow><annotation encoding=\"application/x-tex\">f_n (z) = \\sum a_{ni} z^i / i!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0747em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ni</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">!</span></span></span></span> for some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><mo>∈</mo><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">a_{ni} \\in \\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ni</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> and all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>z</mi><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">|z| &lt; r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>. Let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>f</mi><mi>n</mi><mi>M</mi></msubsup><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></msubsup><msub><mi>a</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><msup><mi>z</mi><mi>i</mi></msup><mi mathvariant=\"normal\">/</mi><mi>i</mi><mo stretchy=\"false\">!</mo></mrow><annotation encoding=\"application/x-tex\">f_n^M(z) = \\sum_{i=0}^M a_{ni} z^i / i!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2809em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ni</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">!</span></span></span></span> be the partial sums.</p>\n<p>Define <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>n</mi></msub><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>∑</mo><msub><mi>a</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><msup><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">!</mo></mrow><annotation encoding=\"application/x-tex\">F_n (z) = \\sum a_{ni} z^{i+1} / (i + 1)!</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0747em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ni</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8247em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)!</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>n</mi><mi>M</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">F_n^M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0883em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> the partial sums. By the fundamental theorem of calculus and linearity of integration, for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>z</mi><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">|z| &lt; r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> we have <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>n</mi><mi>M</mi></msubsup><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>z</mi><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msubsup><mi>f</mi><mi>n</mi><mi>M</mi></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mi>z</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">F_n^M(z) = z\\int_0^1 f_n^M(tz)dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3648em;vertical-align:-0.3558em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.009em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span>.</p>\n<p>With these definitions in hand, you can apply <a href=\"https://github.com/leanprover-community/mathlib/pull/14090\">#14090</a>, dominated convergence, and the fact that the partial sums of power series converge uniformly on all closed balls within their radius of convergence several times to show that the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>n</mi><mi>M</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">F_n^M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0883em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> converge (necessarily to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>), the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> converge to some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>, thus <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>F</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">F&#x27; = f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> and so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> is holomorphic.</p>\n<p>My difficulty is that I'm finding the <code>formal_multilinear_series</code> API to be very difficult to grok. I was curious if someone could give me a hint toward defining the partial sums <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>F</mi><mi>n</mi><mi>M</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">F_n^M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0883em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> above?</p>",
        "id": 282648891,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1652797853
    },
    {
        "content": "<p>Does looking at the definition of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/exp/src\">src#exp</a> and <a href=\"https://leanprover-community.github.io/mathlib_docs/find/exp_series/src\">src#exp_series</a> help at all?</p>",
        "id": 282649411,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652798073
    },
    {
        "content": "<p>Once you've managed to construct the series object, the partial sums should be <a href=\"https://leanprover-community.github.io/mathlib_docs/find/formal_multilinear_series.partial_sum\">docs#formal_multilinear_series.partial_sum</a></p>",
        "id": 282649490,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652798110
    },
    {
        "content": "<p>I am having a similar experience trying to prove the isolated zeros theorem for analytic functions, that manipulating <code>formal_multilinear_series</code> explicitly (in my case, to extract a <code>(z-z0)^n</code> factor) is a little painful. <a href=\"https://leanprover-community.github.io/mathlib_docs/find/exp_series/src\">src#exp_series</a> is nice, but as far as I can tell the series provided from <code>analytic_at</code> for a function from C to C is not of that form so it does not really help...</p>",
        "id": 282650197,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1652798399
    },
    {
        "content": "<p><code>formal_multilinear_series</code> is specifically designed for functions of several variables. For functions of one variable, one should definitely build a simplified and easier to use API, in the same way that we have <code>fderiv</code> for the general Fréchet derivative, and <code>deriv</code> for the more specific one-dimensional version.</p>",
        "id": 282664238,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1652803538
    },
    {
        "content": "<p>I don't agree that it's for multiple variables, things like <a href=\"https://leanprover-community.github.io/mathlib_docs/find/formal_multilinear_series.sum\">docs#formal_multilinear_series.sum</a> are in terms of a single variable</p>",
        "id": 282701314,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652818778
    },
    {
        "content": "<p>Oh, I guess your point is that using multilinear maps internally is overkill for a ring?</p>",
        "id": 282701473,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652818853
    },
    {
        "content": "<p>Yes but your « single variable » lives in a vector space over K, not in K, so it is indeed multivariable calculus</p>",
        "id": 282702594,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652819460
    },
    {
        "content": "<p>Yes, using multilinear maps over a ring or a field is definitely overkill: you just have one coefficient, so instead of writing <code>p_n (x, ..., x)</code>, you should just use <code>a_n x^n</code>. Of course, we should keep the definition of <code>analytic_at</code> (in the same way that <code>differentiable_at</code> is always expressed in terms of <code>fderiv</code>, whether in one or higher dimension), but we should be able to construct a function from a list of coefficients instead of a list of multilinear maps, for instance.</p>",
        "id": 282741909,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1652852808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"242586\">Vincent Beffara</span> <a href=\"#narrow/stream/113488-general/topic/Question.20about.20.60formal_multilinear_series.60/near/282650197\">said</a>:</p>\n<blockquote>\n<p>I am having a similar experience trying to prove the isolated zeros theorem for analytic functions, that manipulating <code>formal_multilinear_series</code> explicitly (in my case, to extract a <code>(z-z0)^n</code> factor) is a little painful. <a href=\"https://leanprover-community.github.io/mathlib_docs/find/exp_series/src\">src#exp_series</a> is nice, but as far as I can tell the series provided from <code>analytic_at</code> for a function from C to C is not of that form so it does not really help...</p>\n</blockquote>\n<p>Indeed I can imagine this to be a bit painful. The following should help you (maybe some of it is already in mathlib, feel free to PR the rest if you need it).</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">analysis.analytic.basic</span>\n<span class=\"kn\">import</span> <span class=\"n\">ring_theory.power_series.basic</span>\n\n<span class=\"n\">open_locale</span> <span class=\"n\">big_operators</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span> <span class=\"n\">F</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">fintype</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">ι</span><span class=\"o\">]</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">foo₁</span> <span class=\"o\">[</span><span class=\"n\">comm_semiring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_monoid</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">multilinear_map</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ι</span><span class=\"o\">,</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"n\">E</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"bp\">∏</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"bp\">←</span> <span class=\"n\">multilinear_map.map_smul_univ</span><span class=\"o\">,</span>\n  <span class=\"n\">exact</span> <span class=\"n\">congr_arg</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">funext</span> <span class=\"bp\">$</span> <span class=\"bp\">λ</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"kd\">by</span> <span class=\"n\">simp</span><span class=\"o\">)</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">foo₂</span> <span class=\"o\">[</span><span class=\"n\">comm_semiring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">multilinear_map</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ι</span><span class=\"o\">,</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"bp\">∏</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">foo₁</span><span class=\"o\">,</span> <span class=\"n\">smul_eq_mul</span><span class=\"o\">,</span> <span class=\"n\">mul_comm</span><span class=\"o\">]</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">bar₁</span> <span class=\"o\">[</span><span class=\"n\">comm_semiring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_monoid</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">continuous_multilinear_map</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ι</span><span class=\"o\">,</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"n\">E</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"bp\">∏</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">foo₁</span> <span class=\"n\">f.to_multilinear_map</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">bar₂</span> <span class=\"o\">[</span><span class=\"n\">comm_semiring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">continuous_multilinear_map</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ι</span><span class=\"o\">,</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"bp\">∏</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">foo₂</span> <span class=\"n\">f.to_multilinear_map</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">sum₁</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ.sum</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"bp\">∑'</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"n\">n</span> <span class=\"bp\">•</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">formal_multilinear_series.sum</span><span class=\"o\">,</span>\n  <span class=\"n\">congr</span><span class=\"o\">,</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">bar₁</span><span class=\"o\">,</span> <span class=\"n\">fin.prod_const</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">sum₂</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ.sum</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"bp\">∑'</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">formal_multilinear_series.sum</span><span class=\"o\">,</span>\n  <span class=\"n\">congr</span><span class=\"o\">,</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">bar₂</span><span class=\"o\">,</span> <span class=\"n\">fin.prod_const</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">partial_sum₁</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ.partial_sum</span> <span class=\"n\">n</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"bp\">∑</span> <span class=\"n\">k</span> <span class=\"k\">in</span> <span class=\"n\">finset.range</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"n\">k</span> <span class=\"bp\">•</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">k</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">formal_multilinear_series.partial_sum</span><span class=\"o\">,</span>\n  <span class=\"n\">congr</span><span class=\"o\">,</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">bar₁</span><span class=\"o\">,</span> <span class=\"n\">fin.prod_const</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">partial_sum₂</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_const_smul</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ.partial_sum</span> <span class=\"n\">n</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"bp\">∑</span> <span class=\"n\">k</span> <span class=\"k\">in</span> <span class=\"n\">finset.range</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">k</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"n\">k</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">formal_multilinear_series.partial_sum</span><span class=\"o\">,</span>\n  <span class=\"n\">congr</span><span class=\"o\">,</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">bar₂</span><span class=\"o\">,</span> <span class=\"n\">fin.prod_const</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 282765559,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652868252
    },
    {
        "content": "<p>Oh, do we not have <a href=\"https://leanprover-community.github.io/mathlib_docs/find/continuous_multilinear_map.smul_right\">docs#continuous_multilinear_map.smul_right</a> ?</p>",
        "id": 282766815,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652869031
    },
    {
        "content": "<p>What would <code>smul_right</code> be?</p>",
        "id": 282767211,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652869321
    },
    {
        "content": "<p>Ah, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/multilinear_map.smul_right\">docs#multilinear_map.smul_right</a></p>",
        "id": 282767305,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652869368
    },
    {
        "content": "<p>Okay with that you can also add </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">lemma</span> <span class=\"n\">eq_mk_pi_algebra₁</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_mul</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_smul</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ</span> <span class=\"bp\">=</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">continuous_multilinear_map.mk_pi_algebra</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">smul_right</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">continuous_multilinear_map.smul_right_apply</span><span class=\"o\">,</span>\n      <span class=\"n\">continuous_multilinear_map.mk_pi_algebra_apply</span><span class=\"o\">,</span> <span class=\"n\">bar₁</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">eq_mk_pi_algebra₂</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_group</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_add_group</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_continuous_mul</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">φ</span> <span class=\"bp\">=</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"o\">(</span><span class=\"n\">continuous_multilinear_map.mk_pi_algebra</span> <span class=\"bp\">𝕜</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">𝕜</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">ext</span> <span class=\"n\">n</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">continuous_multilinear_map.smul_apply</span><span class=\"o\">,</span>\n      <span class=\"n\">continuous_multilinear_map.mk_pi_algebra_apply</span><span class=\"o\">,</span> <span class=\"n\">bar₂</span><span class=\"o\">,</span> <span class=\"n\">smul_eq_mul</span><span class=\"o\">]</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>Which means you don't have to make a lemma for each definition in the API of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/formal_multilinear_series\">docs#formal_multilinear_series</a> like I did for sum and partial_sum (unfortunately you need a little bit stronger assumptions, but I think it won't be a big deal in practice)</p>",
        "id": 282769170,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652870589
    },
    {
        "content": "<p>But anyway this is just a temporary fix, the good solution would definitely be to have a dedicated API for the one dimensional case</p>",
        "id": 282769329,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652870701
    },
    {
        "content": "<p><del>What's bar₁?</del></p>",
        "id": 282770399,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652871404
    },
    {
        "content": "<p>Also, would the <code>continuous_multilinear_map</code> version of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/multilinear_map.pi_ring_equiv\">docs#multilinear_map.pi_ring_equiv</a> be helpful here?</p>",
        "id": 282770575,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652871485
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> Thanks a lot! I ended up starting something similar (though in a more specific case, like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">coef</span> <span class=\"o\">(</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"n\">ℂ</span> <span class=\"n\">ℂ</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"n\">p</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">to_coef</span> <span class=\"o\">{</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">formal_multilinear_series</span> <span class=\"n\">ℂ</span> <span class=\"n\">ℂ</span> <span class=\"n\">ℂ</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span><span class=\"o\">}</span> <span class=\"o\">:</span>\n  <span class=\"n\">p</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">coef</span> <span class=\"n\">p</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">y</span><span class=\"bp\">^</span><span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>to go back and forth. I'll see what turns out...</p>",
        "id": 282771089,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1652871800
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/Question.20about.20.60formal_multilinear_series.60/near/282770575\">said</a>:</p>\n<blockquote>\n<p>Also, would the <code>continuous_multilinear_map</code> version of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/multilinear_map.pi_ring_equiv\">docs#multilinear_map.pi_ring_equiv</a> be helpful here?</p>\n</blockquote>\n<p>I don't know the exact setup Vincent is working with, but I thnik it would just be a longer way to write <code>f 1</code> in this case, because I can't see how the fact that it's a linear isomorphism would help here</p>",
        "id": 282771231,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652871900
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/pull/14218\">#14218</a> adds <code>continuous_multilinear_map.smul_right</code></p>",
        "id": 282775324,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652874577
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/stream/113488-general/topic/Question.20about.20.60formal_multilinear_series.60/near/282771231\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/Question.20about.20.60formal_multilinear_series.60/near/282770575\">said</a>:</p>\n<blockquote>\n<p>Also, would the <code>continuous_multilinear_map</code> version of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/multilinear_map.pi_ring_equiv\">docs#multilinear_map.pi_ring_equiv</a> be helpful here?</p>\n</blockquote>\n<p>I don't know the exact setup Vincent is working with, but I thnik it would just be a longer way to write <code>f 1</code> in this case, because I can't see how the fact that it's a linear isomorphism would help here</p>\n</blockquote>\n<p>That said it will certainly be useful when setting up the full one-dimensional theory</p>",
        "id": 282775403,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1652874610
    },
    {
        "content": "<p>One thing that I should have done but didn't is generalized <a href=\"https://leanprover-community.github.io/mathlib_docs/find/map_exp\">docs#map_exp</a> to arbitrary single-variable series</p>",
        "id": 282788315,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652880921
    },
    {
        "content": "<p>Hi y'all. Sorry for abandoning this at the time. Some family things came up and I never got around to working on it. However, I've used <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> 's original suggestions and I got very far, until I hit a problem where Lean's not able to figure out what's going on with <code>continuous_multilinear_map</code>'s <code>op_norm</code>? See here: <a href=\"https://gist.github.com/khwilson/42ab431f7c0f8eb397b4cc9f9a787440#file-example-lean-L166\">https://gist.github.com/khwilson/42ab431f7c0f8eb397b4cc9f9a787440#file-example-lean-L166</a></p>",
        "id": 291599280,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659371110
    },
    {
        "content": "<p>Specifically, I end up with this state:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"c\">/-</span><span class=\"cm\"></span>\n<span class=\"cm\">  type mismatch at application</span>\n<span class=\"cm\">    (φ n).unit_le_op_norm</span>\n<span class=\"cm\">  term</span>\n<span class=\"cm\">    φ n</span>\n<span class=\"cm\">  has type</span>\n<span class=\"cm\">    continuous_multilinear_map ℂ (λ (i : fin n), ℂ) ℂ : Type</span>\n<span class=\"cm\">  but is expected to have type</span>\n<span class=\"cm\">    continuous_multilinear_map ?m_1 ?m_3 ?m_4 : Type (max ? ? ?)</span>\n<span class=\"cm\">  state:</span>\n<span class=\"cm\">  φ : formal_multilinear_series ℂ ℂ ℂ,</span>\n<span class=\"cm\">  r : nnreal,</span>\n<span class=\"cm\">  hr : ↑r &lt; φ.radius,</span>\n<span class=\"cm\">  C : ℝ,</span>\n<span class=\"cm\">  hC : C &gt; 0,</span>\n<span class=\"cm\">  hm : ∀ (n : ℕ), ∥φ n∥ * ↑r ^ n ≤ C,</span>\n<span class=\"cm\">  n : ℕ,</span>\n<span class=\"cm\">  hn : ∥pad φ n∥ * ↑r ^ n ≤ C * ↑r,</span>\n<span class=\"cm\">  this : n.succ = n + 1,</span>\n<span class=\"cm\">  this : C = 1 * C</span>\n<span class=\"cm\">  ⊢ ∥(↑n + 1)⁻¹∥ * (∥⇑(φ n) 1∥ * ↑r ^ n) ≤ 1 * C</span>\n<span class=\"cm\">  -/</span>\n</code></pre></div>",
        "id": 291599416,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659371176
    },
    {
        "content": "<p>Any thoughts?</p>",
        "id": 291599483,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659371220
    },
    {
        "content": "<p>I will have a deeper look later, but often that means that you don’t have all the typeclass hypotheses to apply the lemma</p>",
        "id": 291599520,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1659371241
    },
    {
        "content": "<p>This might be the type class inference problem for Π-types. I think I ran into this several months ago with <code>formal_multilinear_series</code>.</p>",
        "id": 291599779,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1659371352
    },
    {
        "content": "<p>Yep that seems plausible</p>",
        "id": 291600016,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1659371429
    },
    {
        "content": "<p>Yeah, <code>∥φ n∥</code> is getting resolved to <code>continuous_multilinear_map.has_op_norm'</code> (note the <code>'</code>)</p>",
        "id": 291600111,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659371469
    },
    {
        "content": "<p>I think I need to get rid of the <code>'</code>, but not exactly sure what yoga is necessary to do so</p>",
        "id": 291600187,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659371518
    },
    {
        "content": "<p>This is definitely the pi type problem</p>",
        "id": 291601325,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659372071
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/continuous_multilinear_map.has_op_norm'\">docs#continuous_multilinear_map.has_op_norm'</a> is defeq to <a href=\"https://leanprover-community.github.io/mathlib_docs/find/continuous_multilinear_map.has_op_norm\">docs#continuous_multilinear_map.has_op_norm</a> from what I remember, but lean really struggles to remember that during typeclass inference</p>",
        "id": 291601409,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659372120
    },
    {
        "content": "<p>Not using dot notation might help you there</p>",
        "id": 291601549,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659372181
    },
    {
        "content": "<p>Is the pi type problem fixed in lean 4?</p>",
        "id": 291601610,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1659372206
    },
    {
        "content": "<p>The another natural fallback is to call the lemma with an <code>@</code> so that all the <code>?m_1</code> metavariables are gone, which if it doesn't solve it will at least give a clearer error</p>",
        "id": 291601700,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659372243
    },
    {
        "content": "<p>Optimistically it's the same as the (fixed) dfinsupp problem you reported ages ago</p>",
        "id": 291601752,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659372272
    },
    {
        "content": "<p>Have <code>have</code> and `convert help you:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"bp\">∥</span> <span class=\"bp\">≤</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span><span class=\"bp\">∥</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">continuous_multilinear_map.unit_le_op_norm</span> <span class=\"n\">_</span> <span class=\"mi\">1</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">refl</span> <span class=\"o\">},</span>\n    <span class=\"o\">{</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"o\">}</span>   <span class=\"o\">},</span> <span class=\"c1\">-- now needs help here</span>\n</code></pre></div>",
        "id": 291601941,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1659372367
    },
    {
        "content": "<p>Oh, well, I can fill that sorry in:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"bp\">∥</span> <span class=\"bp\">≤</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span><span class=\"bp\">∥</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">continuous_multilinear_map.unit_le_op_norm</span> <span class=\"n\">_</span> <span class=\"mi\">1</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">refl</span> <span class=\"o\">},</span>\n    <span class=\"o\">{</span> <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"mi\">1</span><span class=\"o\">),</span> <span class=\"o\">{</span> <span class=\"n\">ext</span><span class=\"o\">,</span> <span class=\"n\">refl</span><span class=\"o\">,</span> <span class=\"n\">refl</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n      <span class=\"n\">rw</span> <span class=\"n\">this</span><span class=\"o\">,</span>\n      <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">has_norm.norm</span><span class=\"o\">],</span>\n      <span class=\"n\">norm_cast</span><span class=\"o\">,</span>\n      <span class=\"n\">rw</span> <span class=\"n\">finset.sup_le_iff</span><span class=\"o\">,</span>\n      <span class=\"n\">intros</span> <span class=\"n\">b</span> <span class=\"n\">hb</span><span class=\"o\">,</span>\n      <span class=\"n\">exact</span> <span class=\"n\">rfl.le</span><span class=\"o\">,</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n</code></pre></div>",
        "id": 291602883,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659372833
    },
    {
        "content": "<p>\"Unwrapping <code>1</code>\" and \"Unwrapping <code>0</code>\" have been themes of this journey</p>",
        "id": 291602975,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659372860
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[simp]</span> <span class=\"kd\">lemma</span> <span class=\"n\">norm_const_zero</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">fintype</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">nonempty</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">normed_add_comm_group</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∥</span><span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"n\">M</span><span class=\"o\">)</span><span class=\"bp\">∥</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">pi_norm_const</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">M</span><span class=\"o\">),</span> <span class=\"n\">rw</span> <span class=\"n\">norm_zero</span><span class=\"o\">,</span> <span class=\"n\">apply_instance</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">@[simp]</span> <span class=\"kd\">lemma</span> <span class=\"n\">norm_const_one</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">fintype</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">nonempty</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">has_one</span> <span class=\"n\">M</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">normed_add_comm_group</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">norm_one_class</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∥</span><span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"n\">M</span><span class=\"o\">)</span><span class=\"bp\">∥</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">pi_norm_const</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">M</span><span class=\"o\">),</span> <span class=\"n\">rw</span> <span class=\"n\">norm_one</span><span class=\"o\">,</span> <span class=\"n\">apply_instance</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">@[simp]</span> <span class=\"kd\">lemma</span> <span class=\"n\">norm_is_empty</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">is_empty</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">normed_add_comm_group</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"n\">M</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∥</span><span class=\"n\">f</span><span class=\"bp\">∥</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"n\">subsingleton.elim</span> <span class=\"n\">f</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">refl</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">antideriv_radius_mono</span> <span class=\"o\">{</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">nnreal</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">hr</span> <span class=\"o\">:</span> <span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">φ.radius</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">pad</span> <span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">radius</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">C</span><span class=\"o\">,</span> <span class=\"n\">hC</span><span class=\"o\">,</span> <span class=\"n\">hm</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">φ.norm_mul_pow_le_of_lt_radius</span> <span class=\"n\">hr</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"n\">formal_multilinear_series.le_radius_of_bound</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">C</span> <span class=\"bp\">*</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">key</span> <span class=\"o\">:</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"bp\">∥</span> <span class=\"bp\">≤</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span><span class=\"bp\">∥</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">continuous_multilinear_map.unit_le_op_norm</span> <span class=\"n\">_</span> <span class=\"mi\">1</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">refl</span> <span class=\"o\">},</span>\n    <span class=\"o\">{</span> <span class=\"n\">casesI</span> <span class=\"n\">is_empty_or_nonempty</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">),</span>\n      <span class=\"gr\">sorry</span> <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">zero_le_one</span><span class=\"o\">,</span>\n        <span class=\"gr\">sorry</span><span class=\"bp\">;</span> <span class=\"n\">exact</span> <span class=\"n\">norm_is_empty</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"c1\">-- this gets upset</span>\n        <span class=\"n\">any_goals</span> <span class=\"o\">{</span> <span class=\"n\">apply_instance</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n      <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">norm_const_one.le</span> <span class=\"o\">}</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n  <span class=\"n\">induction</span> <span class=\"n\">n</span> <span class=\"k\">with</span> <span class=\"n\">n</span> <span class=\"n\">hn</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">pad</span><span class=\"o\">,</span> <span class=\"n\">norm_zero</span><span class=\"o\">,</span> <span class=\"n\">zero_mul</span><span class=\"o\">],</span>\n  <span class=\"n\">refine</span> <span class=\"n\">mul_nonneg</span> <span class=\"n\">hC.lt.le</span> <span class=\"n\">nnreal.zero_le_coe</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"n\">nat.succ_eq_add_one</span><span class=\"o\">,</span>\n  <span class=\"n\">dunfold</span> <span class=\"n\">pad</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"n\">norm_smul</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">continuous_multilinear_map.norm_mk_pi_algebra_fin</span><span class=\"o\">,</span> <span class=\"n\">mul_one</span><span class=\"o\">],</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">pow_add</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"bp\">←</span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span> <span class=\"n\">pow_one</span><span class=\"o\">],</span>\n  <span class=\"n\">refine</span> <span class=\"n\">mul_le_mul</span> <span class=\"n\">_</span> <span class=\"n\">rfl.le</span> <span class=\"n\">nnreal.zero_le_coe</span> <span class=\"n\">hC.lt.le</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">norm_mul</span><span class=\"o\">,</span> <span class=\"n\">mul_assoc</span><span class=\"o\">],</span>\n  <span class=\"c1\">-- refine (hm _).trans' _,</span>\n  <span class=\"c1\">-- have : C = 1 * C, simp,</span>\n  <span class=\"c1\">-- rw this,</span>\n  <span class=\"c1\">-- Something is going horribly wrong with `(φ n).unit_le_op_norm` here</span>\n  <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 291603659,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1659373177
    },
    {
        "content": "<p>Probably the helper lemmas can be weakened in the constraints on <code>M</code></p>",
        "id": 291603697,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1659373197
    },
    {
        "content": "<p>More helper:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[simp]</span> <span class=\"kd\">lemma</span> <span class=\"n\">norm_pi_one_le</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">fintype</span> <span class=\"n\">ι</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_one</span> <span class=\"n\">M</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">normed_add_comm_group</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">norm_one_class</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∥</span><span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"n\">M</span><span class=\"o\">)</span><span class=\"bp\">∥</span> <span class=\"bp\">≤</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">casesI</span> <span class=\"n\">is_empty_or_nonempty</span> <span class=\"n\">ι</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">zero_le_one</span><span class=\"o\">,</span>\n    <span class=\"n\">convert</span> <span class=\"n\">norm_is_empty</span> <span class=\"n\">M</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n    <span class=\"n\">any_goals</span> <span class=\"o\">{</span> <span class=\"n\">apply_instance</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">norm_const_one.le</span> <span class=\"o\">}</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">antideriv_radius_mono</span> <span class=\"o\">{</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">nnreal</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">hr</span> <span class=\"o\">:</span> <span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">φ.radius</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">pad</span> <span class=\"n\">φ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">radius</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">C</span><span class=\"o\">,</span> <span class=\"n\">hC</span><span class=\"o\">,</span> <span class=\"n\">hm</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">φ.norm_mul_pow_le_of_lt_radius</span> <span class=\"n\">hr</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"n\">formal_multilinear_series.le_radius_of_bound</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">C</span> <span class=\"bp\">*</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">key</span> <span class=\"o\">:</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"bp\">∥</span> <span class=\"bp\">≤</span> <span class=\"bp\">∥</span><span class=\"n\">φ</span> <span class=\"n\">n</span><span class=\"bp\">∥</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">convert</span> <span class=\"n\">continuous_multilinear_map.unit_le_op_norm</span> <span class=\"n\">_</span> <span class=\"mi\">1</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">refl</span> <span class=\"o\">},</span>\n    <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">norm_pi_one_le</span> <span class=\"n\">_</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n  <span class=\"n\">induction</span> <span class=\"n\">n</span> <span class=\"k\">with</span> <span class=\"n\">n</span> <span class=\"n\">hn</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">pad</span><span class=\"o\">,</span> <span class=\"n\">norm_zero</span><span class=\"o\">,</span> <span class=\"n\">zero_mul</span><span class=\"o\">],</span>\n  <span class=\"n\">refine</span> <span class=\"n\">mul_nonneg</span> <span class=\"n\">hC.lt.le</span> <span class=\"n\">nnreal.zero_le_coe</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"n\">nat.succ_eq_add_one</span><span class=\"o\">,</span>\n  <span class=\"n\">dunfold</span> <span class=\"n\">pad</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"n\">norm_smul</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">continuous_multilinear_map.norm_mk_pi_algebra_fin</span><span class=\"o\">,</span> <span class=\"n\">mul_one</span><span class=\"o\">],</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">pow_add</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"bp\">←</span><span class=\"n\">mul_assoc</span><span class=\"o\">,</span> <span class=\"n\">pow_one</span><span class=\"o\">],</span>\n  <span class=\"n\">refine</span> <span class=\"n\">mul_le_mul</span> <span class=\"n\">_</span> <span class=\"n\">rfl.le</span> <span class=\"n\">nnreal.zero_le_coe</span> <span class=\"n\">hC.lt.le</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">norm_mul</span><span class=\"o\">,</span> <span class=\"n\">mul_assoc</span><span class=\"o\">],</span>\n  <span class=\"c1\">-- refine (hm _).trans' _,</span>\n  <span class=\"c1\">-- have : C = 1 * C, simp,</span>\n  <span class=\"c1\">-- rw this,</span>\n  <span class=\"c1\">-- Something is going horribly wrong with `(φ n).unit_le_op_norm` here</span>\n  <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 291604763,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1659373651
    },
    {
        "content": "<p><del>Isn't that last lemma just <a href=\"https://leanprover-community.github.io/mathlib_docs/find/pi.norm_one_class\">docs#pi.norm_one_class</a>? Or does that not exist?</del> nevermind, it avoids needing nonemptiness</p>",
        "id": 291606047,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1659374231
    },
    {
        "content": "<p>Here is the thread from when I encountered this problem before, in case it's helpful: <a href=\"#narrow/stream/113488-general/topic/.E2.9C.94.20norm.20on.20continuous_multilinear_map/near/266226728\">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/.E2.9C.94.20norm.20on.20continuous_multilinear_map/near/266226728</a>. And <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> , there you mentioned <a href=\"https://github.com/leanprover/lean4/pull/509\">lean4#509</a>, so I think it's fixed in Lean 4.</p>",
        "id": 291606686,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1659374549
    },
    {
        "content": "<p>Nice. With all this in hand, I actually proved the lemma. Will add all this into the ultimate golfing. Onward to antiderivatives on analytic functions for the moment :-)</p>",
        "id": 291609966,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659376052
    },
    {
        "content": "<p>Well, it needs a lot of cleaning and I still need to clean up a few <code>sorry</code>s, but the proof I was going for is basically here if anyone has any obvious suggestions for golfing (especially all the casts between reals, nnreals, and ennreals): <a href=\"https://github.com/leanprover-community/mathlib/pull/15815/files#diff-67a2ee3fa94c037e80f0346fc77c70e3e64737c3b019e2a174d69143e4a7d72b\">https://github.com/leanprover-community/mathlib/pull/15815/files#diff-67a2ee3fa94c037e80f0346fc77c70e3e64737c3b019e2a174d69143e4a7d72b</a></p>",
        "id": 291720221,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659451957
    },
    {
        "content": "<p>(If you do take  a look, note that _only_ that file is part of this commit. The others are in other PRs awaiting review.)</p>",
        "id": 291720438,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659452044
    },
    {
        "content": "<p>Nice! For the case of holomorphic functions, an alternative strategy is to use the Cauchy integral formula (like in the proof that holomorphic functions are analytic) and the fact that it is preserved under uniform limits:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">lemma</span> <span class=\"n\">weierstrass_1</span> <span class=\"o\">{</span><span class=\"n\">ι</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">ι</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">p.ne_bot</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">hr</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">F</span> <span class=\"o\">:</span> <span class=\"n\">ι</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">F_cont</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">continuous_on</span> <span class=\"o\">(</span><span class=\"n\">F</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span><span class=\"o\">))</span>\n  <span class=\"o\">(</span><span class=\"n\">F_holo</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">differentiable_on</span> <span class=\"n\">ℂ</span> <span class=\"o\">(</span><span class=\"n\">F</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span><span class=\"o\">))</span>\n  <span class=\"o\">(</span><span class=\"n\">F_conv</span> <span class=\"o\">:</span> <span class=\"n\">tendsto_uniformly_on</span> <span class=\"n\">F</span> <span class=\"n\">f</span> <span class=\"n\">p</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span><span class=\"o\">))</span> <span class=\"o\">:</span>\n  <span class=\"n\">differentiable_on</span> <span class=\"n\">ℂ</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">R</span> <span class=\"o\">:=</span> <span class=\"n\">r.to_nnreal</span><span class=\"o\">,</span>\n\n  <span class=\"k\">have</span> <span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ι</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"bp\">∈</span> <span class=\"n\">ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span><span class=\"o\">),</span>\n    <span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">real.pi</span> <span class=\"bp\">*</span> <span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"bp\">∮</span> <span class=\"n\">z</span> <span class=\"k\">in</span> <span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"n\">r</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">w</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">F</span> <span class=\"n\">i</span> <span class=\"n\">z</span> <span class=\"bp\">=</span> <span class=\"n\">F</span> <span class=\"n\">i</span> <span class=\"n\">w</span><span class=\"o\">,</span>\n    <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">rintro</span> <span class=\"n\">n</span> <span class=\"n\">z</span> <span class=\"n\">hz</span><span class=\"o\">,</span>\n      <span class=\"n\">refine</span> <span class=\"n\">two_pi_I_inv_smul_circle_integral_sub_inv_smul_of_differentiable_on_off_countable</span>\n        <span class=\"n\">countable_empty</span> <span class=\"n\">hz</span> <span class=\"o\">(</span><span class=\"n\">F_cont</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"n\">hx</span><span class=\"o\">,</span> <span class=\"n\">_</span><span class=\"o\">),</span>\n      <span class=\"n\">rw</span> <span class=\"n\">diff_empty</span> <span class=\"n\">at</span> <span class=\"n\">hx</span><span class=\"o\">,</span>\n      <span class=\"n\">exact</span> <span class=\"o\">(</span><span class=\"n\">F_holo</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">differentiable_at</span> <span class=\"o\">(</span><span class=\"n\">is_open_ball.mem_nhds</span> <span class=\"n\">hx</span><span class=\"o\">)</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"n\">h2</span> <span class=\"o\">:</span> <span class=\"n\">eq_on</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">w</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">real.pi</span> <span class=\"bp\">*</span> <span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"bp\">∮</span> <span class=\"n\">z</span> <span class=\"k\">in</span> <span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"n\">R</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">w</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">f</span> <span class=\"n\">z</span><span class=\"o\">)</span> <span class=\"n\">f</span>\n      <span class=\"o\">(</span><span class=\"n\">emetric.ball</span> <span class=\"n\">c</span> <span class=\"n\">R</span><span class=\"o\">),</span>\n    <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">rintro</span> <span class=\"n\">w</span> <span class=\"n\">hw</span><span class=\"o\">,</span>\n      <span class=\"n\">replace</span> <span class=\"n\">hw</span> <span class=\"o\">:</span> <span class=\"n\">w</span> <span class=\"bp\">∈</span> <span class=\"n\">ball</span> <span class=\"n\">c</span> <span class=\"n\">r</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"bp\">←</span> <span class=\"n\">emetric_ball</span><span class=\"bp\">;</span> <span class=\"n\">simpa</span> <span class=\"o\">[</span><span class=\"n\">hr.le</span><span class=\"o\">]</span> <span class=\"n\">using</span> <span class=\"n\">hw</span> <span class=\"o\">},</span>\n      <span class=\"k\">have</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">h1</span> <span class=\"n\">n</span> <span class=\"n\">w</span> <span class=\"n\">hw</span><span class=\"o\">,</span>\n      <span class=\"k\">suffices</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">real.pi</span> <span class=\"bp\">*</span> <span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"bp\">∮</span> <span class=\"n\">z</span> <span class=\"k\">in</span> <span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"n\">r</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">w</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">F</span> <span class=\"n\">n</span> <span class=\"n\">z</span><span class=\"o\">)</span>\n        <span class=\"n\">p</span> <span class=\"o\">(</span><span class=\"bp\">𝓝</span> <span class=\"o\">((</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">real.pi</span> <span class=\"bp\">*</span> <span class=\"n\">I</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"bp\">∮</span> <span class=\"n\">z</span> <span class=\"k\">in</span> <span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"n\">R</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">w</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">f</span> <span class=\"n\">z</span><span class=\"o\">)),</span>\n      <span class=\"k\">from</span> <span class=\"n\">tendsto_nhds_unique</span> <span class=\"n\">this</span> <span class=\"o\">((</span><span class=\"n\">tendsto_congr</span> <span class=\"n\">h</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mpr</span>\n        <span class=\"o\">(</span><span class=\"n\">F_conv.tendsto_at</span> <span class=\"o\">(</span><span class=\"n\">ball_subset_closed_ball</span> <span class=\"n\">hw</span><span class=\"o\">))),</span>\n      <span class=\"n\">apply</span> <span class=\"n\">tendsto.const_smul</span><span class=\"o\">,</span>\n      <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">hr.le</span><span class=\"o\">,</span> <span class=\"n\">real.coe_to_nnreal'</span><span class=\"o\">,</span> <span class=\"n\">max_eq_left</span><span class=\"o\">],</span>\n      <span class=\"n\">refine</span> <span class=\"n\">tendsto_uniformly_on.tendsto_circle_integral</span> <span class=\"n\">hr</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n      <span class=\"o\">{</span> <span class=\"n\">intro</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n        <span class=\"n\">refine</span> <span class=\"n\">continuous_on.smul</span> <span class=\"n\">_</span> <span class=\"o\">((</span><span class=\"n\">F_cont</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mono</span> <span class=\"n\">sphere_subset_closed_ball</span><span class=\"o\">),</span>\n        <span class=\"n\">refine</span> <span class=\"n\">continuous_on.inv₀</span> <span class=\"o\">(</span><span class=\"n\">continuous_on_id.sub</span> <span class=\"n\">continuous_on_const</span><span class=\"o\">)</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n        <span class=\"n\">rintro</span> <span class=\"n\">z</span> <span class=\"n\">hz</span> <span class=\"n\">hzw</span><span class=\"o\">,</span>\n        <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"bp\">←</span> <span class=\"n\">sub_eq_zero.mp</span> <span class=\"n\">hzw</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">hw</span><span class=\"o\">,</span>\n        <span class=\"n\">exact</span> <span class=\"n\">set.disjoint_iff.mp</span> <span class=\"n\">sphere_disjoint_ball</span> <span class=\"o\">⟨</span><span class=\"n\">hz</span><span class=\"o\">,</span> <span class=\"n\">hw</span><span class=\"o\">⟩</span> <span class=\"o\">},</span>\n      <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">tendsto_uniformly_on_iff</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"bp\">⊢</span> <span class=\"n\">F_conv</span><span class=\"o\">,</span>\n        <span class=\"n\">rintro</span> <span class=\"n\">ε</span> <span class=\"n\">hε</span><span class=\"o\">,</span>\n        <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">mem_ball</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">hw</span><span class=\"o\">,</span>\n        <span class=\"k\">have</span> <span class=\"n\">hh1</span> <span class=\"o\">:</span> <span class=\"n\">ε</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"bp\">-</span> <span class=\"n\">dist</span> <span class=\"n\">w</span> <span class=\"n\">c</span><span class=\"o\">)</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">mul_pos</span> <span class=\"n\">hε.lt</span> <span class=\"o\">(</span><span class=\"n\">sub_pos.mpr</span> <span class=\"n\">hw</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">gt</span><span class=\"o\">,</span>\n        <span class=\"n\">specialize</span> <span class=\"n\">F_conv</span> <span class=\"o\">(</span><span class=\"n\">ε</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"bp\">-</span> <span class=\"n\">dist</span> <span class=\"n\">w</span> <span class=\"n\">c</span><span class=\"o\">))</span> <span class=\"n\">hh1</span><span class=\"o\">,</span>\n        <span class=\"n\">filter_upwards</span> <span class=\"o\">[</span><span class=\"n\">F_conv</span><span class=\"o\">]</span> <span class=\"k\">with</span> <span class=\"n\">n</span> <span class=\"n\">h</span> <span class=\"n\">z</span> <span class=\"n\">hz</span><span class=\"o\">,</span>\n        <span class=\"n\">specialize</span> <span class=\"n\">h</span> <span class=\"n\">z</span> <span class=\"o\">(</span><span class=\"n\">sphere_subset_closed_ball</span> <span class=\"n\">hz</span><span class=\"o\">),</span>\n        <span class=\"k\">have</span> <span class=\"n\">hh2</span> <span class=\"o\">:</span> <span class=\"n\">r</span> <span class=\"bp\">-</span> <span class=\"n\">dist</span> <span class=\"n\">w</span> <span class=\"n\">c</span> <span class=\"bp\">≤</span> <span class=\"n\">abs</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">w</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n          <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">mem_sphere_iff_norm</span><span class=\"o\">,</span> <span class=\"n\">norm_eq_abs</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">hz</span><span class=\"o\">,</span>\n            <span class=\"n\">simpa</span> <span class=\"o\">[</span><span class=\"n\">hz</span><span class=\"o\">,</span> <span class=\"n\">complex.dist_eq</span><span class=\"o\">]</span> <span class=\"n\">using</span> <span class=\"n\">norm_sub_norm_le</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">c</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"bp\">-</span> <span class=\"n\">c</span><span class=\"o\">)</span> <span class=\"o\">},</span>\n        <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">dist_smul</span><span class=\"o\">],</span>\n        <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">norm_eq_abs</span><span class=\"o\">,</span> <span class=\"n\">complex.abs_inv</span><span class=\"o\">],</span>\n        <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">inv_mul_lt_iff'</span><span class=\"o\">],</span>\n        <span class=\"o\">{</span> <span class=\"n\">apply</span> <span class=\"n\">lt_of_lt_of_le</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n          <span class=\"n\">exact</span> <span class=\"o\">(</span><span class=\"n\">mul_le_mul_left</span> <span class=\"n\">hε.lt</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mpr</span> <span class=\"n\">hh2</span> <span class=\"o\">},</span>\n        <span class=\"o\">{</span> <span class=\"n\">linarith</span> <span class=\"o\">}</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"n\">h3</span> <span class=\"o\">:</span> <span class=\"n\">has_fpower_series_on_ball</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">cauchy_power_series</span> <span class=\"n\">f</span> <span class=\"n\">c</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"n\">c</span> <span class=\"n\">R</span><span class=\"o\">,</span>\n    <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">refine</span> <span class=\"o\">(</span><span class=\"n\">has_fpower_series_on_cauchy_integral</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">simpa</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">congr</span> <span class=\"n\">h2</span><span class=\"o\">,</span>\n      <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">F_conv.continuous_on</span> <span class=\"o\">(</span><span class=\"n\">eventually_of_forall</span> <span class=\"n\">F_cont</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">mono</span> <span class=\"n\">sphere_subset_closed_ball</span><span class=\"o\">,</span>\n      <span class=\"n\">exact</span> <span class=\"n\">continuous_on.circle_integrable</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">simp</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">simpa</span> <span class=\"o\">[</span><span class=\"n\">hr.le</span><span class=\"o\">])</span> <span class=\"o\">},</span>\n  <span class=\"n\">convert</span> <span class=\"bp\">←</span> <span class=\"n\">h3.differentiable_on</span><span class=\"bp\">;</span> <span class=\"n\">exact</span> <span class=\"n\">emetric_ball</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>How much do you think is needed in your approach to show that derivatives also converge locally uniformly?</p>",
        "id": 292189348,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1659723035
    },
    {
        "content": "<p>Oh, that is nice and avoids rehashing the mean value theorem a bunch of times.</p>",
        "id": 292424977,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659975924
    },
    {
        "content": "<p>And, sorry, When you say \"that derivatives also converge locally uniformly,\" I don't quite grok what you mean</p>",
        "id": 292425000,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659975939
    },
    {
        "content": "<p>The one advantage of this method is that a lot of facts carry over to R, though I was mostly intending to just use this for C :-)</p>",
        "id": 292425482,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1659976186
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474023\">Kevin Wilson</span> <a href=\"#narrow/stream/113488-general/topic/Question.20about.20.60formal_multilinear_series.60/near/292425000\">said</a>:</p>\n<blockquote>\n<p>And, sorry, When you say \"that derivatives also converge locally uniformly,\" I don't quite grok what you mean</p>\n</blockquote>\n<p>I mean, if a sequence <code>f n</code> of analytic functions converges locally uniformly to <code>g</code>, then the sequence of derivatives also converges locally uniformly and its limit is the derivative of <code>g</code> (I learned this as \"le théorème de Weierstrass\" but have no clue what the standard name in English would be). It is a direct consequence of the Cauchy representation of the derivative, and can also probably be obtained following your proof; I was wondering which way would be less painful.</p>",
        "id": 292620960,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1660065368
    },
    {
        "content": "<p>Oh I see. Hmm, I think it's doable, but I'm not sure its relative difficulty to the Cauchy representation proof....</p>",
        "id": 292824006,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1660161737
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"474023\">@Kevin Wilson</span>, I was just wondering about the status of your uniform limits code. I would like to move forwards on the locally uniform convergence part of complex analysis, potentially add Hurwitz's theorem and things like that, so if you PR analyticity of locally uniform limits that would be great. I can always PR the Cauchy formula approach, but it will definitely not generalize...</p>",
        "id": 303210834,
        "sender_full_name": "Vincent Beffara",
        "timestamp": 1665387948
    },
    {
        "content": "<p>(cc <span class=\"user-mention\" data-user-id=\"389019\">@Chris Birkbeck</span> and <a href=\"https://github.com/leanprover-community/mathlib/pull/13500\">#13500</a>)</p>",
        "id": 303312741,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1665428886
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"242586\">@Vincent Beffara</span> all the uniform limits things are merged. I’ve not had time to push through the full Morera, but the shell is on GitHub as a WIP</p>",
        "id": 303332118,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1665440109
    },
    {
        "content": "<p>This was the status of where I got to: <a href=\"https://github.com/leanprover-community/mathlib/pull/15815\">https://github.com/leanprover-community/mathlib/pull/15815</a></p>",
        "id": 303332301,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1665440222
    },
    {
        "content": "<p>basically Morera was done but your suggestion for the locally uniform convergence I think may be easier working directly with Cauchy</p>",
        "id": 303332366,
        "sender_full_name": "Kevin Wilson",
        "timestamp": 1665440273
    }
]