[
    {
        "content": "<p>How much work is there towards LU factorization? <span class=\"user-mention\" data-user-id=\"471791\">@Jiale Miao</span>, you did Gram-Schmidt and it's quite similar in spirit I believe.</p>",
        "id": 281606641,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652026673
    },
    {
        "content": "<p>There's no generalization from matrices to linear maps that's useful here, is there?</p>",
        "id": 281606722,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652026787
    },
    {
        "content": "<p>Doesn't upper/lower triangularity somehow translate to something in terms of endomorphisms? Or does it not because it is not preserved under a change of basis?</p>",
        "id": 281606905,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652027026
    },
    {
        "content": "<p>Also, we <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.block_triangular_matrix\">docs#matrix.block_triangular_matrix</a>, but <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.det_of_lower_triangular\">docs#matrix.det_of_lower_triangular</a> is not stated in terms of it <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 281607198,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652027474
    },
    {
        "content": "<p>I would generalize the <code>b</code> argument to <code>block_triangular_matrix</code> to <code>o → α</code> where <code>has_lt α</code>, so that we can state upper triangularity as well.</p>",
        "id": 281607255,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652027538
    },
    {
        "content": "<p>Block triangularity and triangularity probably aren't particularly easy to state with one definition</p>",
        "id": 281607416,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652027800
    },
    {
        "content": "<p>In the same way that <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.diagonal\">docs#matrix.diagonal</a> and <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.block_diagonal\">docs#matrix.block_diagonal</a> and <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.block_diagonal'\">docs#matrix.block_diagonal'</a> are all separate</p>",
        "id": 281607424,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652027822
    },
    {
        "content": "<p>I can define <code>lower_triangular</code> and <code>upper_triangular</code> in terms of my proposed generalized <code>block_triangular</code>, though. They are<br>\n<code>block_triangular M id</code> and <code>block_triangular M to_dual</code> respectively.</p>",
        "id": 281607489,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652027918
    },
    {
        "content": "<p>Your generalization sounds good either way (although maybe restrict it to a linear order)</p>",
        "id": 281607493,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652027942
    },
    {
        "content": "<p>We also seem to be missing the result that <code>block_diagonal</code> is block triangular</p>",
        "id": 281607530,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652027993
    },
    {
        "content": "<p>Do we want <code>lower_triangular</code> and <code>upper_triangular</code> as standalone definitions?</p>",
        "id": 281607531,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652027995
    },
    {
        "content": "<p><del>Defined on <code>fin n</code> only?</del></p>",
        "id": 281607583,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652028009
    },
    {
        "content": "<p>No, on a general order, without more complications.</p>",
        "id": 281607589,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652028026
    },
    {
        "content": "<p>Maybe as <code>abbreviation</code>s</p>",
        "id": 281607605,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652028068
    },
    {
        "content": "<p>Sure, that sounds fine.</p>",
        "id": 281607612,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652028088
    },
    {
        "content": "<p>This gets me thinking. Is there a more general version of LU decomposition for block triangular matrices?</p>",
        "id": 281607625,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652028112
    },
    {
        "content": "<p>Regular LU is surely stronger than any statement you can make about decomposition into block lower and upper matrices. Or am I missing something? The general vocabulary for this is that lower and upper triangular matrices are called Borel subgroupsof GL(n), and block upper/lower triangular matrices are called parabolic subgroups. The general story is very well understood and works for reductive groups.</p>",
        "id": 281608155,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652028897
    },
    {
        "content": "<p>What is \"regular LU\"? I only know what I was lectured last term.</p>",
        "id": 281608433,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652029228
    },
    {
        "content": "<p>Normal LU</p>",
        "id": 281608468,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652029282
    },
    {
        "content": "<p>What statement about LU for block triangular matrices isn't weaker than what you already know in the upper triangular case?</p>",
        "id": 281608483,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652029310
    },
    {
        "content": "<p>For example, can't you get a decomposition of the form<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>I</mi><mi>m</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>I</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>C</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>D</mi></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\begin{pmatrix} I_m &amp; 0 \\\\  A &amp;  I_n \\end{pmatrix}\\begin{pmatrix} B &amp; C \\\\  0 &amp; D \\end{pmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></p>",
        "id": 281608706,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652029659
    },
    {
        "content": "<p>You trade off some nonzero coefficients in <code>U</code> in exchange of zero coefficients in <code>L</code> under the diagonal.</p>",
        "id": 281608756,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652029696
    },
    {
        "content": "<p>Isn't that just regular LU for matrices over the ring of matrices?</p>",
        "id": 281612081,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1652034642
    },
    {
        "content": "<p>we should definitely have the isomorphism between block matrices and matrices of matrices because a lot of theorems about block matrices follow from that equivalence</p>",
        "id": 281612103,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1652034706
    },
    {
        "content": "<p>Yael I guess so, although this is LU plus one line.</p>",
        "id": 281612220,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652034922
    },
    {
        "content": "<p>If you write the decomposition as (lower unipotent) (diag) (Weyl group element) (upper unipotent) then I guess this beats everything</p>",
        "id": 281612277,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652034993
    },
    {
        "content": "<p>Matrices of matrices require <a href=\"https://leanprover-community.github.io/mathlib_docs/find/dmatrix\">docs#dmatrix</a> for the interesting cases</p>",
        "id": 281612703,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652035648
    },
    {
        "content": "<p>And even then, you run into trouble with ⬝ vs *</p>",
        "id": 281612708,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652035672
    },
    {
        "content": "<p>So what should the mathlib version be? I'm in the mood right now.</p>",
        "id": 281613148,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652036378
    },
    {
        "content": "<p>If you consider matrices of matrices, then all blocks are forced to have the same size, I think, but block matrices are more general.</p>",
        "id": 281613209,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1652036412
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/LU.20decomposition/near/281612703\">said</a>:</p>\n<blockquote>\n<p>Matrices of matrices require <a href=\"https://leanprover-community.github.io/mathlib_docs/find/dmatrix\">docs#dmatrix</a> for the interesting cases</p>\n</blockquote>\n<p><span aria-label=\"point of information\" class=\"emoji emoji-261d\" role=\"img\" title=\"point of information\">:point_of_information:</span></p>",
        "id": 281613266,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652036445
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/113488-general/topic/LU.20decomposition/near/281606905\">said</a>:</p>\n<blockquote>\n<p>Doesn't upper/lower triangularity somehow translate to something in terms of endomorphisms? Or does it not because it is not preserved under a change of basis?</p>\n</blockquote>\n<p>I think Kevin referred to something of this flavor, but not fully explicitly from what I saw: upper triangular matrices correspond exactly to those linear maps that leave invariant each of the subspaces in the complete flag associated with the standard basis. So to me it would not be a bad idea to define flags &lt;<a href=\"https://en.wikipedia.org/wiki/Flag_(linear_algebra)\">https://en.wikipedia.org/wiki/Flag_(linear_algebra)</a>&gt; and at least relate triangularity of matrices to them (if not even define triangularity via this) as: the corresponding linear map leaves each of the subspaces of the flag invariant.</p>\n<p>Not requiring the flag to be complete corresponds to block triangular matrices (if I understood correctly what that referred to).</p>\n<p>But my first instinct is that the Borel subgroups of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><msub><mi>L</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">GL_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> should not have anything to do with how triangularity is actually implemented (although both Kevin and Wikipedia mention this), since we definitely want also non-invertible triangular matrices; not only the linear maps that stabilize a flag but also linear maps that merely leave all of its subspaces invariant. (Maybe the Lie algebra <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi mathvariant=\"fraktur\">g</mi><mi mathvariant=\"fraktur\">l</mi></mrow><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathfrak{gl}_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9302em;vertical-align:-0.2388em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathfrak\">gl</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0626em;\"><span style=\"top:-2.4612em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2388em;\"><span></span></span></span></span></span></span></span></span></span> of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><msub><mi>L</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">GL_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is closer, but still does not really seem to help with the implementation.) (EDIT: Ah, perhaps Kevin meant the Lie algebra of the stabilizer subgroup of the flag! Anyways, I think those should be theorems, not a part of hte definition...)</p>\n<p>And I think it would be great if one could handle matrices of matrices conveniently, but others have surely more insight into the feasibility of it.</p>",
        "id": 281622978,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1652051316
    },
    {
        "content": "<p>I am currently trying to generalize <a href=\"https://leanprover-community.github.io/mathlib_docs/find/matrix.det_of_block_triangular_matrix\">docs#matrix.det_of_block_triangular_matrix</a> over at <a href=\"https://github.com/leanprover-community/mathlib/pull/14035\">#14035</a> and it's a pain. This is THE central calculation, so I really don't know what to think of the matrix-free approach, especially because it won't be coordinate-free anyway.</p>",
        "id": 281623069,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652051503
    },
    {
        "content": "<p>A flag of subspaces is indeed specifying something, but not as much as coordinates/basis. And of course the complete flag corresponding to the standard basis is specifying a lot (although still not the normalizations of the basis vectors), but a special case naturally specifies more.</p>\n<p>Anyways, I don't want to weigh in too much, just wanted to be more explicit about what was left a bit implicit before. Eventually there will be results saying that the matrix of a linear map that leaves the subspaces in the flag invariant is upper triangular in a basis that is adapted to the flag, and vice versa.</p>\n<p>And I can easily believe the determinants are causing enough trouble without inviting more...  <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 281623411,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1652052058
    },
    {
        "content": "<p>Something that might become easier with the flag approach is, for example: the composition of upper triangular linear maps is upper triangular.</p>",
        "id": 281623660,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1652052376
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> already introduced flags a little while ago (in the more general context of ordered sets). So I think we can just talk about <code>flag (submodule k V)</code>. Of course there is not linear-algebra-specific API for it yet.</p>",
        "id": 281625884,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1652055872
    },
    {
        "content": "<p>I think there is a slight disparity in the names. An order theory flag is a linear algebra <em>complete</em> flag, and we do not have linear algebra flags (aka <em>partial</em> flags yet). But it's super easy to add them.</p>",
        "id": 281645339,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079095
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/flag\">docs#flag</a></p>",
        "id": 281645483,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652079228
    },
    {
        "content": "<p>Don't we only need _complete_ flags for triangular matrices?</p>",
        "id": 281645573,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652079293
    },
    {
        "content": "<p>I think so, but not for <em>block</em> triangular matrices.</p>",
        "id": 281645590,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079317
    },
    {
        "content": "<p>I love <em>emphasizing</em> everything today.</p>",
        "id": 281645663,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079363
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Flag_(geometry)#Incidence%20geometry\">The relevant sentence on Wikipedia</a> is</p>\n<blockquote>\n<p>In the more abstract setting of incidence geometry, which is a set having a symmetric and reflexive relation called incidence defined on its elements, a flag is a set of elements that are mutually incident.[1] This level of abstraction generalizes both the polyhedral concept given above as well as the related flag concept from linear algebra.</p>\n</blockquote>",
        "id": 281645669,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079371
    },
    {
        "content": "<p>As I understand it, a partial flag is a chain that contains <code>⊥</code> and <code>⊤</code>. What do you think of this as a definition?</p>",
        "id": 281645699,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079418
    },
    {
        "content": "<p>Why do you want to automatically include top and bottom?</p>",
        "id": 281645793,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652079498
    },
    {
        "content": "<p>This is what Wikipedia does, but I agree it's a bit redundant because we can always formally add them to any chain when they exist and it will still be a chain.</p>",
        "id": 281645824,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079552
    },
    {
        "content": "<p>(I genuinely do not know: in \"normal\" maths it is so easy to say \"oh, yes, ignore/include the zero vector space\".)</p>",
        "id": 281645831,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652079570
    },
    {
        "content": "<p>Not including the top/bottom element by default has a priori only one consequence, which is that \"adding them later\" is not injective (because the chain might already contain them). I don't know if this is a bug or a feature.</p>",
        "id": 281646105,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079791
    },
    {
        "content": "<p>But I like the idea that linear algebra flags are just <code>chain (submodule 𝕜 V)</code>.</p>",
        "id": 281646127,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652079822
    },
    {
        "content": "<p>Oh shoot, I didn't actually add <code>chain</code>. Let me do that quick.</p>",
        "id": 281646480,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652080124
    },
    {
        "content": "<p>Chains are very prominent:</p>\n<ul>\n<li>chains of ideals --&gt; Krull dimension,</li>\n<li>chains of non-zero-divisors --&gt; regularity,</li>\n<li>chains of normal subgroups --&gt; Jordan-Hölder filtrations,</li>\n<li>chains of normal subgroups with abelian quotients --&gt; solvability,</li>\n<li>...</li>\n</ul>",
        "id": 281647310,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652080795
    },
    {
        "content": "<p>Don't chains have &lt; not &lt;=? If so then you can't add bot randomly to a chain</p>",
        "id": 281647418,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652080845
    },
    {
        "content": "<p>The chains I'm talking about are sets, not indexed families. Indexed chains are just strictly monotone functions (<a href=\"https://leanprover-community.github.io/mathlib_docs/find/strict_mono\">docs#strict_mono</a>).</p>",
        "id": 281647514,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652080906
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/stream/113488-general/topic/LU.20decomposition/near/281645793\">said</a>:</p>\n<blockquote>\n<p>Why do you want to automatically include top and bottom?</p>\n</blockquote>\n<p>One reason might be the following. If <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mn>0</mn></msub><mo>=</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo><mo>⊊</mo><msub><mi>V</mi><mn>1</mn></msub><mo>⊊</mo><mo>⋯</mo><mo>⊊</mo><msub><mi>V</mi><mi>n</mi></msub><mo>=</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V_0=\\{0\\} \\subsetneq V_1 \\subsetneq \\cdots \\subsetneq V_n = V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel amsrm\">⊊</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel amsrm\">⊊</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel amsrm\">⊊</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>, and a linear map <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mspace></mspace><mspace width=\"0.1111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333em\"/><mi>V</mi><mo>→</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">L \\colon V \\to V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> respects this flag (i.e. <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><msub><mi>V</mi><mi>j</mi></msub><mo>⊂</mo><msub><mi>V</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">L V_j \\subset V_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⊂</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> for each <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>), then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span> induces also endomorphisms in each of the successive quotients <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>j</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>→</mo><msub><mi>V</mi><mi>j</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">V_j / V_{j-1} \\to V_j / V_{j-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> --- these are essentially the \"diagonal blocks\". It seems very natural to include the first quotient <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mn>0</mn></msub><mo>=</mo><msub><mi>V</mi><mn>1</mn></msub><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo><mo>≅</mo><msub><mi>V</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">V_1 / V_0 = V_1 / \\{0\\} \\cong V_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≅</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> and the last one, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>n</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>V</mi><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">V_n/V_{n-1} = V / V_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>, so as to try to capture all information about the diagonal blocks of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>.</p>\n<p>For example a linear map is <em>strictly upper triangular</em> w.r.t. this flag if it respects the flag (each <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">V_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is an invariant subspace) and the mappings it induces <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>j</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>→</mo><msub><mi>V</mi><mi>j</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>V</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">V_j / V_{j-1} \\to V_j / V_{j-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> are all zero.</p>",
        "id": 281651628,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1652083991
    },
    {
        "content": "<p>Sure, I do not object that complete flags, or also simply flags that contain the top and bottom element are special and important.  I was wondering whether it was possibly useful to not require this as part of the definition (and maybe making a further definition of a \"strict\" flag as one containing top and bottom).</p>",
        "id": 281652228,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652084406
    },
    {
        "content": "<p>For instance, I can see wanting to consider a chain of prime ideals in a commutative ring over a field to be also a chain of vector spaces.  Except that the whole space is not a prime ideal and the zero vector space need not be prime, if the ring contains non-zero zero-divisors.</p>\n<p>I think that it might make sense to not force top and bottom to be parts of flags in general.</p>",
        "id": 281652849,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652084816
    },
    {
        "content": "<p>I need something cleared out, however. Do you want flags to be sets or indexed families?</p>",
        "id": 281652931,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652084879
    },
    {
        "content": "<p>I think that most of the times, I've looked at finite flags and was often interested in taking successive quotients.  This makes me think that indexed families might be more appropriate.  However, again, the conversion is not such a big deal in maths, so I may be wrong about this.</p>",
        "id": 281653172,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652085034
    },
    {
        "content": "<p>In fact, I have to think hard about a situation where a \"flag\" was not simply a finite sequence of inclusion of subobjects, where the index set was <code>0, 1,..., n</code>.</p>",
        "id": 281653255,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652085103
    },
    {
        "content": "<p>Okay, so indexed families. In that case, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/flag\">docs#flag</a> won't be terribly useful.</p>",
        "id": 281654496,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652085941
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> you haven't been doing enough infinite dimensional operator theory <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span>. There's a whole theory of nest algebras, which are basically (not selfadjoint) operator algebras with a flag of invariant subspaces. However, the flag need not be finite, nor even countable, nor even well-ordered. There are lots of reasons to not be too restrictive about the index type of a flag.</p>",
        "id": 281655462,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1652086603
    },
    {
        "content": "<p>To be fair, I have seen infinite flags: I <em>love</em> polynomials and I do not usually give a bound to their degree!  So, I will accept <code>nat</code> as an indexing set.  <span aria-label=\"stuck out tongue wink\" class=\"emoji emoji-1f61c\" role=\"img\" title=\"stuck out tongue wink\">:stuck_out_tongue_wink:</span></p>",
        "id": 281655653,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652086738
    },
    {
        "content": "<p>But are you flags still indexed, Jireh?</p>",
        "id": 281655734,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652086800
    },
    {
        "content": "<p>Sometimes it is useful to have an index, yes. Another classic example is a resolution of the identity corresponding to a selfadjoint operator, where you want the index set to be ℝ, or some interval therein.</p>",
        "id": 281656092,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1652087007
    },
    {
        "content": "<p>So basically a flag is a strictly monotone submodule-valued function?</p>",
        "id": 281656196,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652087054
    },
    {
        "content": "<p>yes, that's how I'm familiar with the term.</p>",
        "id": 281656383,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1652087177
    },
    {
        "content": "<p>Me too, although the source of the function is a very tame linearly ordered set for me!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 281656439,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652087222
    },
    {
        "content": "<p>Something like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span> <span class=\"n\">partial_flag</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">preorder</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">semiring</span> <span class=\"bp\">𝕜</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">add_comm_monoid</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">]</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">to_fun</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">submodule</span> <span class=\"bp\">𝕜</span> <span class=\"n\">E</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">strict_mono'</span> <span class=\"o\">:</span> <span class=\"n\">strict_mono</span> <span class=\"n\">to_fun</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 281656903,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652087528
    },
    {
        "content": "<p>I don't know whether it warrants a new definition. Do we ever consider the <em>type</em> of flags?</p>",
        "id": 281656970,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652087580
    },
    {
        "content": "<p>I wouldn't define it now unless someone needs it (I don't currently). Otherwise we'll probably end up needing to redesign various bits of it when the time comes.</p>",
        "id": 281657120,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1652087667
    },
    {
        "content": "<p>In algebraic geometry, the \"set\" of all flags carries the structure of an algebraic variety.  The set of maximal flags is called the <a href=\"https://en.wikipedia.org/wiki/Generalized_flag_variety\">flag variety</a>.  These are very important, but probably to get the design right, there is the need to see where the algebraic geometry library ends up!</p>",
        "id": 281658029,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652088194
    },
    {
        "content": "<p>Oh, <code>flag</code> might be the correct way to model the flag variety, because it's less nice to express that an indexed family doesn't \"skip\" elements (you can say that the range is order connected, I suppose).</p>",
        "id": 281658260,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1652088325
    },
    {
        "content": "<p>If you look at flags that are not necessarily maximal, in the context of the flag variety, you get a (possibly) disconnected space, whose connected components are the ones where you keep track of which subset of <code>{0,1,...,dim V}</code> is the set of dimensions of elements of your flag.</p>",
        "id": 281658637,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652088517
    },
    {
        "content": "<p>Do we have the statement about <a href=\"https://leanprover-community.github.io/mathlib_docs/find/flag\">docs#flag</a> of <code>set_range f</code> where <code>f</code> is <code>strict_mono</code>?</p>",
        "id": 281662111,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1652090640
    }
]