[
    {
        "content": "<p>Hi, </p>\n<p>I'm trying to prove some propositions about complete metric spaces and need to use sequences for them. I can't seem to find any lemmas in topological_space or metric_space to do with sequences, and was wondering if I should be trying to prove my own basic lemmas about sequences or if I missed something. I also wonder if I'm thinking about sequences properly. </p>\n<p>For example,  below I wanted to prove that if Y is a subset of a metric space, and y is an element of the closure of Y, then there exists a sequence in Y converging to y. Am I approaching this correctly? </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">analysis</span><span class=\"bp\">.</span><span class=\"n\">metric_space</span>\n<span class=\"kn\">import</span> <span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">filter</span>\n\n<span class=\"kn\">theorem</span> <span class=\"n\">lim_sequence_of_mem_closure</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">metric_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"err\">∈</span> <span class=\"n\">closure</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n<span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H1</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"err\">∈</span> <span class=\"n\">Y</span><span class=\"o\">),</span> <span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">tendsto</span> <span class=\"n\">f</span> <span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">cofinite</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">a</span><span class=\"o\">)</span>  <span class=\"o\">:=</span> <span class=\"k\">begin</span>\n  <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"n\">mem_closure_iff_nhds</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">H</span><span class=\"o\">,</span>\n  <span class=\"k\">let</span> <span class=\"n\">ball_n</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">ball</span> <span class=\"n\">a</span> <span class=\"o\">((</span><span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"bp\">/</span><span class=\"n\">n</span><span class=\"o\">),</span>\n\n  <span class=\"k\">have</span> <span class=\"n\">H1</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">nonempty</span> <span class=\"o\">{</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">|</span> <span class=\"n\">x</span> <span class=\"err\">∈</span> <span class=\"o\">(</span><span class=\"n\">ball_n</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"err\">∩</span> <span class=\"n\">Y</span><span class=\"o\">},</span>\n    <span class=\"n\">intro</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"n\">apply</span> <span class=\"bp\">@</span><span class=\"n\">nonempty_of_exists</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"n\">true</span><span class=\"o\">),</span>\n    <span class=\"k\">have</span> <span class=\"n\">H2</span> <span class=\"o\">:=</span> <span class=\"n\">this</span> <span class=\"o\">(</span><span class=\"n\">ball_n</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">ball_mem_nhds</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">),</span>\n    <span class=\"k\">have</span> <span class=\"n\">H3</span> <span class=\"o\">:=</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">exists_mem_of_ne_empty</span> <span class=\"n\">H2</span><span class=\"o\">,</span>\n    <span class=\"n\">cases</span> <span class=\"n\">H3</span> <span class=\"k\">with</span> <span class=\"n\">xn</span> <span class=\"n\">Hxn</span><span class=\"o\">,</span>\n    <span class=\"n\">existsi</span> <span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">xn</span><span class=\"o\">,</span> <span class=\"n\">Hxn</span><span class=\"bp\">⟩</span> <span class=\"o\">:</span> <span class=\"err\">↥</span><span class=\"o\">{</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">|</span> <span class=\"n\">x</span> <span class=\"err\">∈</span> <span class=\"n\">ball_n</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"err\">∩</span> <span class=\"n\">Y</span><span class=\"o\">}),</span>\n    <span class=\"n\">trivial</span><span class=\"o\">,</span>\n    <span class=\"n\">sorry</span><span class=\"o\">,</span>\n\n  <span class=\"k\">have</span> <span class=\"n\">sequence</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span> <span class=\"o\">(</span><span class=\"n\">H1</span> <span class=\"n\">n</span><span class=\"o\">),</span>\n  <span class=\"k\">let</span> <span class=\"n\">sequencevals</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">sequence</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">,</span>\n  <span class=\"n\">existsi</span> <span class=\"n\">sequencevals</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">H1</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">sequencevals</span> <span class=\"n\">n</span> <span class=\"err\">∈</span> <span class=\"n\">Y</span><span class=\"o\">,</span>\n    <span class=\"k\">show</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">sequence</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">val</span> <span class=\"err\">∈</span> <span class=\"n\">Y</span><span class=\"o\">,</span>\n    <span class=\"k\">let</span> <span class=\"n\">sequenceprops</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">((</span><span class=\"n\">sequence</span> <span class=\"n\">n</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">property</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"n\">sequenceprops</span><span class=\"o\">,</span>\n  <span class=\"n\">existsi</span> <span class=\"n\">H1</span><span class=\"o\">,</span>\n  <span class=\"n\">sorry</span><span class=\"o\">,</span>\n\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 133532026,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536348555
    },
    {
        "content": "<p>I think we would want to state this over first countable spaces instead of metric spaces. What are you using it for?</p>",
        "id": 133532531,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536349139
    },
    {
        "content": "<p>I want to use it to help me show that a complete subspace Y of a metric space X is closed in X</p>",
        "id": 133533234,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536349991
    },
    {
        "content": "<p>I'm working towards eventually proving Banach's fixed point theorem but am starting with some easier propositions about complete metric spaces</p>",
        "id": 133533304,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536350052
    },
    {
        "content": "<p>I'm pretty sure the first thing is already there</p>",
        "id": 133533540,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536350338
    },
    {
        "content": "<p>but maybe not</p>",
        "id": 133533838,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536350643
    },
    {
        "content": "<blockquote>\n<p>complete subspace Y of a metric space X is closed in X</p>\n</blockquote>\n<p>This has nothing to do with sequences, it generalizes to uniform spaces</p>",
        "id": 133534094,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536350963
    },
    {
        "content": "<p>It's not the same as your statement, but this lemma writes out the definition of complete so that we can say \"a complete subspace Y of X\"</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">lemma</span> <span class=\"n\">compact_of_totally_bounded_complete</span> <span class=\"o\">{</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">ht</span> <span class=\"o\">:</span> <span class=\"n\">totally_bounded</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">hc</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"n\">filter</span> <span class=\"n\">α</span><span class=\"o\">},</span> <span class=\"n\">cauchy</span> <span class=\"n\">f</span> <span class=\"bp\">→</span> <span class=\"n\">f</span> <span class=\"bp\">≤</span> <span class=\"n\">principal</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"bp\">∃</span><span class=\"n\">x</span><span class=\"err\">∈</span><span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"bp\">≤</span> <span class=\"n\">nhds</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">compact</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n</pre></div>",
        "id": 133534290,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536351166
    },
    {
        "content": "<p>This is what I recommend proving:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">variables</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">uniform_space</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"kn\">lemma</span> <span class=\"n\">is_closed_of_complete</span> <span class=\"o\">{</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">hc</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"n\">filter</span> <span class=\"n\">α</span><span class=\"o\">},</span> <span class=\"n\">cauchy</span> <span class=\"n\">f</span> <span class=\"bp\">→</span> <span class=\"n\">f</span> <span class=\"bp\">≤</span> <span class=\"n\">principal</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"bp\">∃</span><span class=\"n\">x</span><span class=\"err\">∈</span><span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"bp\">≤</span> <span class=\"n\">nhds</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">is_closed</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n</pre></div>",
        "id": 133534555,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536351467
    },
    {
        "content": "<p>Okay, I see, I'll try that. Thanks!<br>\nI've still got somewhat of a problem  because I can't see a way around using sequences for the proof of Banach's fixed point theorem, so I will need to eventually find a good way of dealing with them in order to do that. That can be a task for later at this point though.</p>",
        "id": 133534739,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536351673
    },
    {
        "content": "<p>The banach fixed point theorem looks pretty tied to metric spaces. I'm not sure how you could state it for uniform spaces. One possibility is some kind of well ordered filtration of the elements of the uniformity such that the contraction mapping forward maps each entourage to one that is strictly greater in the well order. That is, you have a antitone map <code>o</code> from entourages to ordinals such that if <code>S</code> is an entourage, then <code>o (map F S) &gt; o S</code></p>",
        "id": 133535426,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536352411
    },
    {
        "content": "<p>Are you trying to help him or scare him?</p>",
        "id": 133535501,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536352476
    },
    {
        "content": "<p>...that said, I think you should just try to prove the regular BFP on metric spaces</p>",
        "id": 133535662,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536352676
    },
    {
        "content": "<p>Is your definition of a complete subspace of a uniform space equivalent to asking the induced uniformity is complete?</p>",
        "id": 133535712,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536352703
    },
    {
        "content": "<p>yes</p>",
        "id": 133535843,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536352818
    },
    {
        "content": "<p>it seems so</p>",
        "id": 133535857,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536352840
    },
    {
        "content": "<p>we will probably want a proof of equivalence, but I'm not sure how hard the statement is</p>",
        "id": 133535859,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536352842
    },
    {
        "content": "<p>I guess <code>complete_space s</code> is a Prop so that should work</p>",
        "id": 133535895,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536352892
    },
    {
        "content": "<p>Then again, we have the theorem <code>complete_space s &lt;-&gt; is_closed s</code> so I guess the latter is a simpler way to write it :)</p>",
        "id": 133536009,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536353025
    },
    {
        "content": "<p>For Rohan, I would say that relevant lemmas as <code>cauchy_vmap</code> in <code>uniform_space.lean</code> and <code>is_closed_iff_nhds</code> in <code>topological_space.lean</code></p>",
        "id": 133536079,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536353074
    },
    {
        "content": "<p>What?</p>",
        "id": 133536083,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536353081
    },
    {
        "content": "<p>Which theorem?</p>",
        "id": 133536086,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536353085
    },
    {
        "content": "<p>I mean once Rohan proves it</p>",
        "id": 133536120,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536353098
    },
    {
        "content": "<p>ah ok</p>",
        "id": 133536128,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536353108
    },
    {
        "content": "<p>Thanks so much both of you! I'm going to sleep now but I'll see what I can do on it over the weekend.</p>",
        "id": 133536676,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536353679
    },
    {
        "content": "<p>is it actually true if the uniform spaces are not separated?</p>",
        "id": 133537576,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536354631
    },
    {
        "content": "<p>anyway, my wife calls me, so I'll give you my try. Note that the number of <code>@</code> suggests I'm doing it wrong (looks like I'm fighting the interface):</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">analysis</span><span class=\"bp\">.</span><span class=\"n\">topology</span><span class=\"bp\">.</span><span class=\"n\">topological_space</span>\n<span class=\"kn\">import</span> <span class=\"n\">analysis</span><span class=\"bp\">.</span><span class=\"n\">topology</span><span class=\"bp\">.</span><span class=\"n\">uniform_space</span>\n\n<span class=\"kn\">variables</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"n\">uniform_space</span> <span class=\"n\">X</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">aux</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">vmap</span> <span class=\"o\">(</span><span class=\"bp\">λ</span>  <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">)</span> <span class=\"n\">f</span> <span class=\"bp\">≠</span> <span class=\"err\">⊥</span> <span class=\"bp\">↔</span> <span class=\"n\">f</span> <span class=\"err\">⊓</span> <span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">principal</span> <span class=\"n\">Y</span> <span class=\"bp\">≠</span> <span class=\"err\">⊥</span> <span class=\"o\">:=</span>\n<span class=\"n\">sorry</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">rohan</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"bp\">@</span><span class=\"n\">complete_space</span> <span class=\"n\">Y</span> <span class=\"o\">(</span><span class=\"n\">uniform_space</span><span class=\"bp\">.</span><span class=\"n\">vmap</span> <span class=\"o\">(</span><span class=\"bp\">λ</span>  <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">)</span> <span class=\"n\">u</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">is_closed</span> <span class=\"n\">Y</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">letI</span> <span class=\"o\">:</span> <span class=\"n\">uniform_space</span> <span class=\"n\">Y</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">uniform_space</span><span class=\"bp\">.</span><span class=\"n\">vmap</span> <span class=\"o\">(</span><span class=\"bp\">λ</span>  <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">)</span> <span class=\"n\">u</span><span class=\"o\">),</span>\n  <span class=\"n\">rw</span> <span class=\"n\">is_closed_iff_nhds</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">ne_bot</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">cauchy_vmap</span> <span class=\"n\">Y</span> <span class=\"n\">X</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span>  <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">le_refl</span> <span class=\"bp\">_</span><span class=\"o\">)</span> <span class=\"n\">cauchy_nhds</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"n\">aux</span> <span class=\"n\">at</span> <span class=\"n\">this</span><span class=\"o\">,</span>\n  <span class=\"n\">specialize</span> <span class=\"n\">this</span> <span class=\"n\">ne_bot</span><span class=\"o\">,</span>\n  <span class=\"n\">rcases</span> <span class=\"n\">complete_space</span><span class=\"bp\">.</span><span class=\"n\">complete</span> <span class=\"n\">this</span> <span class=\"k\">with</span> <span class=\"bp\">⟨</span><span class=\"n\">x&#39;</span><span class=\"o\">,</span> <span class=\"n\">H</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">sorry</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 133537768,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536354870
    },
    {
        "content": "<p>I this the aux lemma sounds plausible. The status in the main proof is:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">X</span><span class=\"o\">,</span>\n<span class=\"n\">x&#39;</span> <span class=\"o\">:</span> <span class=\"err\">↥</span><span class=\"n\">Y</span><span class=\"o\">,</span>\n<span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">vmap</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"err\">↥</span><span class=\"n\">Y</span><span class=\"o\">),</span> <span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"n\">nhds</span> <span class=\"n\">x&#39;</span>\n<span class=\"err\">⊢</span> <span class=\"n\">x</span> <span class=\"err\">∈</span> <span class=\"n\">Y</span>\n</pre></div>\n\n\n<p>which looks promising, except maybe if things are not separated</p>",
        "id": 133537887,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536354972
    },
    {
        "content": "<p>The book I looked at on uniform spaces had a lot of Hausdorff assumptions which were not always really required, but rather seemed to be used as a device to ward off evil spirits</p>",
        "id": 133538194,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536355416
    },
    {
        "content": "<p>So Rohan is a mathematics undergraduate and whilst this filter stuff might be a cool way to do it (and I know he's read my filter blog post), I think there is some merit in seeing a proof which is more what mathematics undergraduates are used to. So here are some dumb questions. Is the epsilon-delta definition of a sequence tending to a limit in Lean? I'm assuming the fact that open balls are open and that x is in the closure of Y iff Y intersects every open set containing x. Given all this, it seems to me to be completely feasible to prove the lemma \"the way a mathematician proves it\".</p>",
        "id": 133540912,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536359012
    },
    {
        "content": "<p>There is an epsilon delta definition of continuity in a metric space, but I don't think we've unfolded the definition of a sequence limit</p>",
        "id": 133542300,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536360843
    },
    {
        "content": "<p>The sequence limit is provided via the <code>at_top</code> filter on <code>nat</code></p>",
        "id": 133542312,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536360859
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"120559\">@Rohan Mitta</span> why not write down the mathematics proof you want to work in Lean and then see if you can get it to work. You might want to make some auxiliary definitions. I am still a bit unclear about whether the predicate \"this sequence (i.e. function nat -&gt; X) tends to this limit in the metric space X\" is in Lean. I'm sure there will be some fancy filter version which works for second countable uniform semi-topologies or whatever, but the thing you're thinking about is a common notion in undergraduate mathematics and in my mind that is justifiction enough for it to be its own special predicate. I guess you could define it for topological spaces using open sets, and then prove that for metric spaces it's equivalent to the epsilon delta definition. This all sounds like very reasonable stuff to dump into an M2PM5 directory on the UROP repo (or the topology directory).</p>",
        "id": 133563057,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536401955
    },
    {
        "content": "<p>I don't think we have the epsilon-N description of convergent sequences. For continuous functions we do have the epsilon-delta description, see <code>continuous_of_metric</code> and adjacent theorems.</p>",
        "id": 133563487,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536402983
    },
    {
        "content": "<p>We should definitely have this. I'll need it for teaching.</p>",
        "id": 133563488,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536403014
    },
    {
        "content": "<p>But it should be very easy to define</p>",
        "id": 133563493,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536403027
    },
    {
        "content": "<p>It's lunch time, so I can't golf the second half:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">variables</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">metric_space</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"kn\">open</span> <span class=\"n\">filter</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"n\">u</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"bp\">↔</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">ε</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">},</span> <span class=\"n\">n</span> <span class=\"bp\">≥</span> <span class=\"n\">N</span> <span class=\"bp\">→</span> <span class=\"n\">dist</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"n\">a</span> <span class=\"bp\">&lt;</span> <span class=\"n\">ε</span> <span class=\"o\">:=</span>\n<span class=\"bp\">⟨λ</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"n\">mem_at_top_sets</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"err\">$</span> <span class=\"n\">mem_map</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"err\">$</span> <span class=\"n\">H</span> <span class=\"o\">(</span><span class=\"n\">ball_mem_nhds</span> <span class=\"bp\">_</span> <span class=\"n\">εpos</span><span class=\"o\">),</span>\n <span class=\"bp\">λ</span> <span class=\"n\">H</span> <span class=\"n\">s</span> <span class=\"n\">s_nhd</span><span class=\"o\">,</span>\n  <span class=\"k\">begin</span>\n    <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">mem_map</span><span class=\"o\">,</span> <span class=\"n\">mem_at_top_sets</span><span class=\"o\">],</span>\n    <span class=\"n\">rcases</span> <span class=\"n\">mem_nhds_iff_metric</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">s_nhd</span> <span class=\"k\">with</span> <span class=\"bp\">⟨</span><span class=\"n\">ε</span><span class=\"o\">,</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"n\">sub</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n    <span class=\"n\">rcases</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span> <span class=\"k\">with</span> <span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"n\">H</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n    <span class=\"n\">existsi</span> <span class=\"n\">N</span><span class=\"o\">,</span>\n    <span class=\"n\">intros</span> <span class=\"n\">n</span> <span class=\"n\">nN</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"n\">sub</span> <span class=\"o\">(</span><span class=\"n\">mem_ball</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"err\">$</span> <span class=\"n\">H</span> <span class=\"n\">nN</span><span class=\"o\">)</span>\n  <span class=\"kn\">end</span><span class=\"bp\">⟩</span>\n</pre></div>",
        "id": 133564349,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536405110
    },
    {
        "content": "<p>I'm returning to this thread because I think this should go into mathlib:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">lemma</span> <span class=\"n\">seq_tendsto_iff</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"n\">u</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"bp\">↔</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">ε</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">},</span> <span class=\"n\">n</span> <span class=\"bp\">≥</span> <span class=\"n\">N</span> <span class=\"bp\">→</span> <span class=\"n\">dist</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"n\">a</span> <span class=\"bp\">&lt;</span> <span class=\"n\">ε</span> <span class=\"o\">:=</span>\n<span class=\"bp\">⟨λ</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"n\">mem_at_top_sets</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"err\">$</span> <span class=\"n\">mem_map</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"err\">$</span> <span class=\"n\">H</span> <span class=\"o\">(</span><span class=\"n\">ball_mem_nhds</span> <span class=\"bp\">_</span> <span class=\"n\">εpos</span><span class=\"o\">),</span>\n <span class=\"bp\">λ</span> <span class=\"n\">H</span> <span class=\"n\">s</span> <span class=\"n\">s_nhd</span><span class=\"o\">,</span> <span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">ε</span><span class=\"o\">,</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"n\">sub</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">mem_nhds_iff_metric</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">s_nhd</span> <span class=\"k\">in</span>\n   <span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"n\">H&#39;</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span> <span class=\"k\">in</span> <span class=\"n\">mem_at_top_sets</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span> <span class=\"n\">nN</span><span class=\"o\">,</span>\n   <span class=\"n\">sub</span> <span class=\"err\">$</span> <span class=\"n\">mem_ball</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"err\">$</span> <span class=\"n\">H&#39;</span> <span class=\"n\">nN</span><span class=\"bp\">⟩⟩</span>\n</pre></div>\n\n\n<p>Mario, what do you think?</p>",
        "id": 133621575,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536520570
    },
    {
        "content": "<p>For teaching purposes, we could even define a new abbreviation like <code>seq_tendsto u a</code> for <code>tendsto u at_top (nhds a)</code> but maybe this kind of things does not belong to mathlib</p>",
        "id": 133621588,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536520662
    },
    {
        "content": "<p>You can split that into two parts; first state it for an arbitrary filter and then reduce to the <code>nhds</code> filter</p>",
        "id": 133621628,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536520699
    },
    {
        "content": "<p>Too late: I turned it into term mode, so now it's read-only</p>",
        "id": 133621635,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536520743
    },
    {
        "content": "<p>It cannot be modified anymore</p>",
        "id": 133621640,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536520760
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"kn\">lemma</span> <span class=\"n\">tendsto_nhds_iff</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"n\">β</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"n\">u</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"bp\">↔</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">ε</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">∃</span> <span class=\"n\">s</span> <span class=\"err\">∈</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">sets</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"o\">{</span><span class=\"n\">n</span><span class=\"o\">},</span> <span class=\"n\">n</span> <span class=\"err\">∈</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">dist</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"n\">a</span> <span class=\"bp\">&lt;</span> <span class=\"n\">ε</span> <span class=\"o\">:=</span>\n<span class=\"bp\">⟨λ</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">u</span> <span class=\"bp\">⁻¹</span><span class=\"err\">&#39;</span> <span class=\"n\">ball</span> <span class=\"n\">a</span> <span class=\"n\">ε</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">H</span> <span class=\"err\">$</span> <span class=\"n\">ball_mem_nhds</span> <span class=\"n\">a</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"bp\">⟩⟩</span><span class=\"o\">,</span>\n <span class=\"bp\">λ</span> <span class=\"n\">H</span> <span class=\"n\">s</span> <span class=\"n\">s_nhd</span><span class=\"o\">,</span> <span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">ε</span><span class=\"o\">,</span> <span class=\"n\">εpos</span><span class=\"o\">,</span> <span class=\"n\">sub</span><span class=\"bp\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">mem_nhds_iff_metric</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">s_nhd</span> <span class=\"k\">in</span>\n   <span class=\"k\">let</span> <span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">N_in</span><span class=\"o\">,</span> <span class=\"n\">H&#39;</span><span class=\"bp\">⟩⟩</span> <span class=\"o\">:=</span> <span class=\"n\">H</span> <span class=\"n\">ε</span> <span class=\"n\">εpos</span> <span class=\"k\">in</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">sets_of_superset</span> <span class=\"n\">N_in</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">b</span> <span class=\"n\">b_in</span><span class=\"o\">,</span> <span class=\"n\">sub</span> <span class=\"err\">$</span> <span class=\"n\">H&#39;</span> <span class=\"n\">b_in</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n</pre></div>",
        "id": 133623215,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536524052
    },
    {
        "content": "<p>Obfuscating is so fun</p>",
        "id": 133623218,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536524071
    },
    {
        "content": "<p>I understand how one could get addicted to it</p>",
        "id": 133623220,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536524096
    },
    {
        "content": "<p>you missed a spot - <code>⟨N, ⟨N_in, H'⟩⟩</code> could be <code>⟨N, N_in, H'⟩</code></p>",
        "id": 133623281,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536524243
    },
    {
        "content": "<p>Oh you're right, the reader could infer from my version that N_in and H' go together</p>",
        "id": 133623299,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536524282
    },
    {
        "content": "<p>By the way, if this proof was replaced with <code>by finish</code> I would argue it is even more obfuscatory</p>",
        "id": 133623339,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536524394
    },
    {
        "content": "<blockquote>\n<p>∀ ε &gt; 0, ∃ (N : ℕ), ∀ {n}, n ≥ N → dist (u n) a &lt; ε</p>\n</blockquote>\n<p>Aah, it's just like the old days</p>",
        "id": 133623681,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536525034
    },
    {
        "content": "<p>The things we do for our students...</p>",
        "id": 133623752,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536525142
    },
    {
        "content": "<p>Mario, how would you call</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">lemma</span> <span class=\"n\">t</span> <span class=\"o\">[</span><span class=\"n\">inhabited</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">semilattice_sup</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">{</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">}</span> <span class=\"o\">:</span>\n<span class=\"o\">(</span><span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">s</span> <span class=\"err\">∈</span> <span class=\"o\">(</span><span class=\"n\">at_top</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">α</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sets</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"err\">∈</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">p</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">↔</span>\n<span class=\"o\">(</span><span class=\"bp\">∃</span> <span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"bp\">≥</span> <span class=\"n\">N</span> <span class=\"bp\">→</span> <span class=\"n\">p</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n</pre></div>\n\n\n<p>And do you have a one line long proof? It's meant to be a variation on <code>mem_at_top_sets</code> but deducing it is surprisingly painful here</p>",
        "id": 133624326,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536526317
    },
    {
        "content": "<p>My proof is</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"k\">begin</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">mem_at_top_sets</span><span class=\"o\">,</span> <span class=\"n\">exists_prop</span><span class=\"o\">],</span>\n  <span class=\"n\">split</span> <span class=\"bp\">;</span> <span class=\"n\">intro</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">rcases</span> <span class=\"n\">h</span> <span class=\"k\">with</span> <span class=\"bp\">⟨</span><span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"bp\">⟨⟨</span><span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"n\">h&#39;</span><span class=\"bp\">⟩⟩</span><span class=\"o\">,</span>\n    <span class=\"n\">existsi</span> <span class=\"n\">b</span><span class=\"o\">,</span>\n    <span class=\"n\">intros</span> <span class=\"n\">n</span> <span class=\"n\">nb</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"n\">h&#39;</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"n\">n</span> <span class=\"n\">nb</span><span class=\"o\">)</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">rcases</span> <span class=\"n\">h</span> <span class=\"k\">with</span>  <span class=\"bp\">⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"n\">h&#39;</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n    <span class=\"n\">existsi</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">|</span> <span class=\"n\">a</span> <span class=\"bp\">≥</span> <span class=\"n\">N</span> <span class=\"o\">},</span>\n    <span class=\"n\">exact</span> <span class=\"bp\">⟨⟨</span><span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"bp\">λ</span> <span class=\"bp\">_</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">x</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"n\">h&#39;</span><span class=\"bp\">⟩</span> <span class=\"o\">}</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 133624432,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536526466
    },
    {
        "content": "<p>I don't think there is a one line proof, although both conditions are equivalent to <code>{n | p n} ∈ at_top.sets</code></p>",
        "id": 133624586,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536526781
    },
    {
        "content": "<p>wait, isn't the proof <code>rfl</code>?</p>",
        "id": 133624645,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536526842
    },
    {
        "content": "<p>No</p>",
        "id": 133624657,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536526877
    },
    {
        "content": "<p>I mean</p>\n<div class=\"codehilite\"><pre><span></span>lemma t [inhabited α] [semilattice_sup α] {p : α → Prop} :\n  {n | p n} ∈ at_top.sets ↔ (∃ N : α, ∀ n, n ≥ N → p n) := iff.rfl\n</pre></div>",
        "id": 133624661,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536526921
    },
    {
        "content": "<p>I need to go sleeping but <span class=\"user-mention\" data-user-id=\"120559\">@Rohan Mitta</span> you can use <a href=\"https://gist.github.com/PatrickMassot/1b2d39011855ba43f3bf00c08051ad9e\" target=\"_blank\" title=\"https://gist.github.com/PatrickMassot/1b2d39011855ba43f3bf00c08051ad9e\">https://gist.github.com/PatrickMassot/1b2d39011855ba43f3bf00c08051ad9e</a> if you want to play with sequences in metric spaces. The lemma at bottom bridges the gap between what you see in lectures and mathlib context</p>",
        "id": 133624704,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536526976
    },
    {
        "content": "<p>oh, this is just <code>mem_at_top_sets</code></p>",
        "id": 133624711,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527005
    },
    {
        "content": "<p>yes</p>",
        "id": 133624715,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536527034
    },
    {
        "content": "<p>the last bit you wrote is mem_at_top_sets</p>",
        "id": 133624758,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536527046
    },
    {
        "content": "<p>The question is: how to deduce my <code>t</code> lemma from this</p>",
        "id": 133624763,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536527060
    },
    {
        "content": "<p>The fact <code>(∃ (s : set α) (H : s ∈ F.sets), ∀ n, n ∈ s → p n) ↔ {n | p n} ∈ F.sets</code> is true in any filter</p>",
        "id": 133624764,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527077
    },
    {
        "content": "<p>it's just saying that a filter is upward closed</p>",
        "id": 133624769,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527091
    },
    {
        "content": "<p>frankly I'd avoid it simply because the lhs is needlessly verbose</p>",
        "id": 133624790,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527145
    },
    {
        "content": "<p>just use <code>upward_sets</code> if it looks like the hypotheses of the lhs are about to appear</p>",
        "id": 133624832,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527173
    },
    {
        "content": "<p>See the link above: the goal of this lemma is to allow the last proof to be so short</p>",
        "id": 133624839,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536527205
    },
    {
        "content": "<p>I would state the previous theorem differently:</p>\n<div class=\"codehilite\"><pre><span></span>lemma tendsto_nhds_iff (u : β → α) (f : filter β) (a : α) : tendsto u f (nhds a) ↔\n  ∀ ε &gt; 0, {n | dist (u n) a &lt; ε} ∈ f.sets := sorry\n</pre></div>",
        "id": 133624891,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527306
    },
    {
        "content": "<p>this would be even nicer if we had a quantifier-like notation for <code>{n | p n} ∈ f</code>, but I can live with this</p>",
        "id": 133624907,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536527386
    },
    {
        "content": "<p>Is this true? I can see how to go from an arbitrary sequence in a metric space to a filter, but don't see how it is possible in general to get from an arbitrary filter to a sequence. </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">analysis</span><span class=\"bp\">.</span><span class=\"n\">metric_space</span>\n<span class=\"kn\">import</span> <span class=\"n\">order</span><span class=\"bp\">.</span><span class=\"n\">filter</span>\n<span class=\"n\">noncomputable</span> <span class=\"n\">theory</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">complete_iff_seq_complete</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">metric_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"n\">complete_space</span> <span class=\"n\">α</span> <span class=\"bp\">↔</span> <span class=\"o\">(</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">),</span> <span class=\"n\">cauchy</span> <span class=\"o\">(</span><span class=\"n\">filter</span><span class=\"bp\">.</span><span class=\"n\">map</span> <span class=\"n\">f</span> <span class=\"n\">at_top</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">),</span> <span class=\"n\">tendsto</span> <span class=\"n\">f</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"n\">nhds</span> <span class=\"n\">a</span><span class=\"o\">))</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">split</span><span class=\"o\">,</span> <span class=\"n\">intros</span> <span class=\"n\">H</span> <span class=\"n\">f</span> <span class=\"n\">Hf</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">complete_space</span><span class=\"bp\">.</span><span class=\"n\">complete</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span> <span class=\"n\">H</span> <span class=\"bp\">_</span> <span class=\"n\">Hf</span><span class=\"o\">),</span>\n  <span class=\"n\">sorry</span><span class=\"o\">,</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 133882373,
        "sender_full_name": "Rohan Mitta",
        "timestamp": 1536843608
    },
    {
        "content": "<p>You can get a sequence by for each n taking ε = 1/n and then applying the Cauchy property to the entourage of points at distance less than ε, and picking a point from the set you get out. <code>cauchy_of_metric</code> does some of this work for you</p>",
        "id": 133884917,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536845923
    },
    {
        "content": "<p>I haven't checked but I expect this this defines a Cauchy sequence which you can then use to show the original filter converges.</p>",
        "id": 133885019,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536846009
    }
]