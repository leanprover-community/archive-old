[
    {
        "content": "<p>Installation documentation sounds like a more interesting topic to me. I'm currently installing a fresh Xubuntu in VirtualBox. I'll try to follows the instruction and use the remote install script without adding any step to what is written. Wish me good luck...</p>",
        "id": 164711144,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556806332
    },
    {
        "content": "<p>But I can already see there are too many steps, and install scripts try to be too generic. What about trying to write a single bash file installing everything assuming a Debian-like OS?</p>",
        "id": 164711274,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556806434
    },
    {
        "content": "<p>I think even  <a href=\"https://github.com/leanprover-community/mathlib/blob/master/docs/elan.md\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/docs/elan.md\">https://github.com/leanprover-community/mathlib/blob/master/docs/elan.md</a> is too generic. Every step mixes all OS. Shouldn't we write three separate files?</p>",
        "id": 164711397,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556806521
    },
    {
        "content": "<p>Two of the files are really easy:</p>\n<div class=\"codehilite\"><pre><span></span>1. Install Linux\n2. See the appropriate installation instructions.\n</pre></div>",
        "id": 164711659,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556806699
    },
    {
        "content": "<p>I get a completely random error when using <code>curl https://raw.githubusercontent.com/leanprover-community/mathlib/master/scripts/remote-install-update-mathlib.sh -sSf | sh</code>. It work flawlessly on my actual machine. In the virtual machine I get one <a href=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L28\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L28\">line 28</a>: illegal option <code>-n</code>.</p>",
        "id": 164713704,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808060
    },
    {
        "content": "<p>Try piping through <code>bash</code></p>",
        "id": 164713941,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556808221
    },
    {
        "content": "<p>I tried that</p>",
        "id": 164713950,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808232
    },
    {
        "content": "<p>Then nothing happens (no error, no installation)</p>",
        "id": 164713967,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808242
    },
    {
        "content": "<p>Aha, that is probably because it is asking <del>you</del> <em>redirected</em> <code>stdin</code> a question</p>",
        "id": 164714029,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556808259
    },
    {
        "content": "<p>so <code>curl bla &gt; script.sh; yes | bash ./script.sh</code></p>",
        "id": 164714051,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556808281
    },
    {
        "content": "<p>Does the <code>$PATH</code> happen to be empty on that virtual machine Patrick?</p>",
        "id": 164714480,
        "sender_full_name": "Keeley Hoek",
        "timestamp": 1556808598
    },
    {
        "content": "<p>Keeley, then it would already fail on <code>curl</code></p>",
        "id": 164714637,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556808693
    },
    {
        "content": "<p>Oh but if the path is empty most normal shells check a default path and could find curl</p>",
        "id": 164714696,
        "sender_full_name": "Keeley Hoek",
        "timestamp": 1556808723
    },
    {
        "content": "<p>In this case we don't want to install script to answer the question.</p>",
        "id": 164714710,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808725
    },
    {
        "content": "<p>$PATH is not empty</p>",
        "id": 164714757,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808777
    },
    {
        "content": "<p>The question is coming from the <code>remote-install-update-mathlib.sh</code> script itself</p>",
        "id": 164714803,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808810
    },
    {
        "content": "<p>So</p>\n<div class=\"codehilite\"><pre><span></span>curl the_script &gt; script.sh\n./script.sh\n</pre></div>\n\n\n<p>and let the user answer questions.</p>",
        "id": 164714890,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556808860
    },
    {
        "content": "<p>The weird thing is: I say it works here. But it doesn't ask any question here</p>",
        "id": 164714998,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556808957
    },
    {
        "content": "<p>Oww: the python install downloads 200Mo</p>",
        "id": 164715229,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809106
    },
    {
        "content": "<p>Of course most of it should be already there on a real computer</p>",
        "id": 164715261,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809131
    },
    {
        "content": "<p>Especially on a computer that has Lean and its tools up and running (-;</p>",
        "id": 164715342,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556809193
    },
    {
        "content": "<p>I can confirm that downloading the remote install script first and executing it behaves as intended</p>",
        "id": 164715845,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809557
    },
    {
        "content": "<p>Then there is this annoying <code>requests</code> warning, but I know how to get rid of it</p>",
        "id": 164715912,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809582
    },
    {
        "content": "<p>And then everything works</p>",
        "id": 164715917,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809589
    },
    {
        "content": "<p><code>elan</code> manages to download, launch <em>and</em> ask questions in one line. We need investigations</p>",
        "id": 164715979,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809640
    },
    {
        "content": "<blockquote>\n<p>And then everything works</p>\n</blockquote>\n<p>Including <code>update-mathlib</code> and the git hooks etc...?</p>",
        "id": 164715983,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556809643
    },
    {
        "content": "<p>Including update-mathlib. I don't think git-hooks should be enabled by default</p>",
        "id": 164716013,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809676
    },
    {
        "content": "<p>Why not?</p>",
        "id": 164716237,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556809822
    },
    {
        "content": "<p>Because it makes git slow as hell</p>",
        "id": 164716323,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556809874
    },
    {
        "content": "<p>I thought overall it would save time</p>",
        "id": 164716595,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556810089
    },
    {
        "content": "<p>Maybe I'm using it wrong</p>",
        "id": 164716613,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810103
    },
    {
        "content": "<p>also, someone needs to find time for an obvious bug fix: currently we query GitHub for existence of a nightly <em>before</em> checking the local hard drive</p>",
        "id": 164716691,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810154
    },
    {
        "content": "<p>it's not only a matter of permuting two lines, because we need to figure out the name of the olean archive we are looking for. But it shouldn't be hard</p>",
        "id": 164716799,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810200
    },
    {
        "content": "<p>Yeah, I looked into it a while back. It's hard to fix because the name of the archive is the date, not the sha of the commit. We would need to change this convention which might break the setup of a bunch of people</p>",
        "id": 164716859,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556810249
    },
    {
        "content": "<p>This is what I feared, and the reason why I haven't try yet</p>",
        "id": 164716936,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810286
    },
    {
        "content": "<p>Maybe we could create a file mapping dates to commit sha</p>",
        "id": 164716937,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556810288
    },
    {
        "content": "<p>... or we could have a bunch of symbolic links to the archives and name them after the sha that they correspond to</p>",
        "id": 164716999,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556810350
    },
    {
        "content": "<p>Hey the install question eaten by bash is the same as <a href=\"https://github.com/leanprover-community/mathlib/pull/940\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/pull/940\">https://github.com/leanprover-community/mathlib/pull/940</a></p>",
        "id": 164717217,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810476
    },
    {
        "content": "<p>The more I thought about it, the more it reminded me something</p>",
        "id": 164717248,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556810503
    },
    {
        "content": "<p>Is there any good reason to instruct user to pipe the remote install script through <code>sh</code> instead of <code>bash</code>?</p>",
        "id": 164718853,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556811666
    },
    {
        "content": "<p>Is bash installed on MacOS for instance?</p>",
        "id": 164718863,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556811679
    },
    {
        "content": "<p>They are still stuck with bash 3.4.2 though...</p>",
        "id": 164718875,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556811704
    },
    {
        "content": "<p>Linux has had bash 4 for ages.</p>",
        "id": 164718883,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556811713
    },
    {
        "content": "<p>What about bash read?</p>",
        "id": 164718941,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556811733
    },
    {
        "content": "<p>Do they have it on MacOS?</p>",
        "id": 164718953,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556811741
    },
    {
        "content": "<p>Je ne sais pas</p>",
        "id": 164719001,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556811783
    },
    {
        "content": "<p>I guess Git-bash includes enough of bash for this to work</p>",
        "id": 164719047,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556811823
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110026\">@Simon Hudon</span> I just opened <a href=\"https://github.com/leanprover-community/mathlib/pull/968\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/pull/968\">https://github.com/leanprover-community/mathlib/pull/968</a> about all this</p>",
        "id": 164719359,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812018
    },
    {
        "content": "<p>As soon as this gets merged, I'll ask VirtualBox to jump back in time and try again following instructions on a fresh Ubuntu</p>",
        "id": 164719395,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812052
    },
    {
        "content": "<p>I really think there is no other way to test this. Even Travis includes too much in its default install</p>",
        "id": 164719448,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812082
    },
    {
        "content": "<p>It looks good. Does that affect how you call <code>curl</code> to install it?</p>",
        "id": 164719483,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556812098
    },
    {
        "content": "<p>I think Travis is already better than nothing. I wish we could test it better though. Especially with Windows because I don't have a Windows machine and I don't know when I'll break the setup of Windows users</p>",
        "id": 164719552,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556812187
    },
    {
        "content": "<p>I don't know anything about Windows, but I have an evil plan. Now that I installed VirtualBox, I intend to ask the computer staff here if my university is paying Windows for me anyway (this could very well be the case). If yes then I'm ready to install Windows in virtual box (yes, this is how devoted I am)</p>",
        "id": 164720167,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812679
    },
    {
        "content": "<p>About curl. The way we tell people to use curl does not work. It never worked on systems that don't have python3 with pip already</p>",
        "id": 164720248,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812712
    },
    {
        "content": "<p>With my PR, I believe it works as long as you replace <code>sh</code> by <code>bash</code> at the end of the line</p>",
        "id": 164720272,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812737
    },
    {
        "content": "<p>To be more precise: in <a href=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L28\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L28\">https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L28</a> this is assuming the bash version of <code>read</code> is used. Those option simply don't exist in POSIX</p>",
        "id": 164720320,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812791
    },
    {
        "content": "<p>Patrick, I'm really worried. Maybe you should go see a doctor...</p>",
        "id": 164720326,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812795
    },
    {
        "content": "<p>I should have gone for vacations with my family instead of working all week long</p>",
        "id": 164720409,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812826
    },
    {
        "content": "<p>Aah, on <code>sh</code> vs <code>bash</code>... we should also fix all the shebang lines</p>",
        "id": 164720427,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812849
    },
    {
        "content": "<p>But I'm really tired of people fighting to install Lean/mathlib</p>",
        "id": 164720446,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812862
    },
    {
        "content": "<p>The shebang lines are not used anyway</p>",
        "id": 164720465,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812870
    },
    {
        "content": "<p>if you follow the instructions</p>",
        "id": 164720476,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812875
    },
    {
        "content": "<p>But a user might end up using them...</p>",
        "id": 164720482,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812882
    },
    {
        "content": "<p>So they better be correct</p>",
        "id": 164720493,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812891
    },
    {
        "content": "<p>The instructions never say \"download this, make it executable, execute\"</p>",
        "id": 164720509,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812902
    },
    {
        "content": "<p>But a security-minded user might still do that (after inspecting the file contents with <code>$EDITOR</code>)</p>",
        "id": 164720527,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812915
    },
    {
        "content": "<p>true</p>",
        "id": 164720572,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812923
    },
    {
        "content": "<p>Let me push one more commit then</p>",
        "id": 164720585,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812931
    },
    {
        "content": "<p>They will know how to fix the shebang line... but it would be a nice service to do that for them</p>",
        "id": 164720592,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556812935
    },
    {
        "content": "<p>done</p>",
        "id": 164720649,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556812998
    },
    {
        "content": "<p>Sorry to ask for another commit but can we get the README.md to reflect what you just explained about <code>curl</code>?</p>",
        "id": 164720673,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556813024
    },
    {
        "content": "<p>Ok, I can do that right now, but I intend to revamp this as soon as I'll get confirmation it works on a bare Ubuntu install</p>",
        "id": 164720753,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813059
    },
    {
        "content": "<p>done</p>",
        "id": 164720810,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813108
    },
    {
        "content": "<p>Now wait 1hr for Travis to approve, and you'll know (-;</p>",
        "id": 164720959,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813226
    },
    {
        "content": "<p>Or we can be evil and just hit the \"merge\" button.</p>",
        "id": 164720975,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813238
    },
    {
        "content": "<p>I've already stopped and restored my virtual machine</p>",
        "id": 164721061,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813294
    },
    {
        "content": "<p>I think this will be faster that Travis</p>",
        "id": 164721070,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813301
    },
    {
        "content": "<p>Btw, I just read about <a href=\"https://developers.google.com/season-of-docs\" target=\"_blank\" title=\"https://developers.google.com/season-of-docs\">https://developers.google.com/season-of-docs</a></p>",
        "id": 164721078,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813316
    },
    {
        "content": "<p>Travis just completed checking the first commit (out of 3)</p>",
        "id": 164721088,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813331
    },
    {
        "content": "<p>We're using software by evil microsoft... might as well have it documented by evil google...</p>",
        "id": 164721094,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813336
    },
    {
        "content": "<blockquote>\n<p>Travis just completed checking the first commit (out of 3)</p>\n</blockquote>\n<p>It already gave up on the 2nd</p>",
        "id": 164721124,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813365
    },
    {
        "content": "<p>Why?</p>",
        "id": 164721136,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813378
    },
    {
        "content": "<p>Je ne sais pas</p>",
        "id": 164721200,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556813410
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110026\">@Simon Hudon</span> would you mind merging right now? This way I could test on my virtual machine before leaving my office</p>",
        "id": 164721421,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556813614
    },
    {
        "content": "<p>I guess I'm being overly cautious here. I can replace the branch in the url and pretend it was merged</p>",
        "id": 164722034,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556814111
    },
    {
        "content": "<p>Note: Travis fails the olean-rs stage, nothing to do with my changes...</p>",
        "id": 164722648,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556814564
    },
    {
        "content": "<p>done</p>",
        "id": 164722672,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556814582
    },
    {
        "content": "<p>So weird. I just tried (before the merge) in a fresh Ubuntu, and the script stopped after installing python3 and pip.</p>",
        "id": 164722958,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556814789
    },
    {
        "content": "<p>Everything else worked flawlessly</p>",
        "id": 164723190,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556814928
    },
    {
        "content": "<p>I'm shutting down my VM, restoring, trying again with the official merged version</p>",
        "id": 164723372,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815023
    },
    {
        "content": "<p>same result <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 164723667,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815246
    },
    {
        "content": "<p>What's the instruction after that install?</p>",
        "id": 164723713,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556815278
    },
    {
        "content": "<p>execution should jump to <a href=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57\">https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57</a></p>",
        "id": 164723741,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815308
    },
    {
        "content": "<p>which is a pip3 install</p>",
        "id": 164723748,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815313
    },
    {
        "content": "<p>relauching the script works</p>",
        "id": 164723801,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815331
    },
    {
        "content": "<p>so something's wrong inside the part that is executed when pip is not there</p>",
        "id": 164723817,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815358
    },
    {
        "content": "<p>it almost looks like both lines 31 and 33 are executed</p>",
        "id": 164723866,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815414
    },
    {
        "content": "<p>Can you add a print statement after the <code>fi</code> on line 34?</p>",
        "id": 164724236,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556815683
    },
    {
        "content": "<p>I have no idea what's going on here. But there is a fix. The whole list of instructions starts with: type <code>sudo apt install git curl</code>, so we can add <code>python3</code> and <code>python3-pip</code> to that list</p>",
        "id": 164724267,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815721
    },
    {
        "content": "<p>Ok, I'll try that</p>",
        "id": 164724284,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815745
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 164724417,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556815834
    },
    {
        "content": "<p>Indeed that print is effective</p>",
        "id": 164724494,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815916
    },
    {
        "content": "<p>What if you put it at the end of the whole <code>if ... fi</code>?</p>",
        "id": 164724571,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556815965
    },
    {
        "content": "<p>(after <code>fi</code>)</p>",
        "id": 164724576,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556815974
    },
    {
        "content": "<p>which one?</p>",
        "id": 164724582,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815980
    },
    {
        "content": "<p>54 or 55?</p>",
        "id": 164724599,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556815989
    },
    {
        "content": "<p>I'll try all of them</p>",
        "id": 164724632,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816040
    },
    {
        "content": "<p>yes please</p>",
        "id": 164724703,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816078
    },
    {
        "content": "<p>this is completely crazy</p>",
        "id": 164724773,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816154
    },
    {
        "content": "<p>now apt aborts</p>",
        "id": 164724777,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816161
    },
    {
        "content": "<p>Actually it was strange that it didn't wait for confirmation inside apt when it was half working</p>",
        "id": 164724850,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816200
    },
    {
        "content": "<p>I hope you admire how I resists the temptation to suggests replacing bash with a proper programation language</p>",
        "id": 164724897,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816247
    },
    {
        "content": "<p>Bash is so horrible even Python is better. Go for it if it helps ... except ... aren't you trying to install Python?</p>",
        "id": 164725021,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816342
    },
    {
        "content": "<p>Yes, I'm acutely aware of this time-travel paradox</p>",
        "id": 164725056,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816364
    },
    {
        "content": "<p>I tried something that seemed to work</p>",
        "id": 164725177,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816416
    },
    {
        "content": "<p>Then go for it. Just don't sleep with your grandmother</p>",
        "id": 164725184,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816419
    },
    {
        "content": "<p>What did you do?</p>",
        "id": 164725195,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816426
    },
    {
        "content": "<p>I added the <code>-y</code> to <code>apt-get</code>. We are asking for confirmation right before doing it anyway</p>",
        "id": 164725211,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816446
    },
    {
        "content": "<p>And miraculously it then worked until the end of the install procedure...</p>",
        "id": 164725249,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816474
    },
    {
        "content": "<p>What happens at the end?</p>",
        "id": 164725368,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816541
    },
    {
        "content": "<p>What I call the end is everything starting from line 57</p>",
        "id": 164725416,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816584
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57\">https://github.com/leanprover-community/mathlib/blob/master/scripts/remote-install-update-mathlib.sh#L57</a></p>",
        "id": 164725431,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816591
    },
    {
        "content": "<p>/me shuts down his, VM, restore, rinse, repeat</p>",
        "id": 164725465,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816632
    },
    {
        "content": "<p>setuptools seem to be giving a hard time to <code>pip</code></p>",
        "id": 164725531,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816653
    },
    {
        "content": "<p>bash seems to be giving a hard time to bash</p>",
        "id": 164725557,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816679
    },
    {
        "content": "<p>\"stop hitting yourself! stop hitting yourself!\"</p>",
        "id": 164725627,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556816727
    },
    {
        "content": "<p>PR'ed again</p>",
        "id": 164725949,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556816966
    },
    {
        "content": "<p>An idea for future improvement: maybe update-mathlib should propose to run <code>leanpkg add leancommunity/mathlib</code> if it can't find mathlib in <code>leanpkg.toml</code></p>",
        "id": 164726061,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556817029
    },
    {
        "content": "<p>I'm hungry, I'll leave my office. I did almost nothing than working on mathlib installation for the past three hours</p>",
        "id": 164726136,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556817099
    },
    {
        "content": "<p>That's frustrating</p>",
        "id": 164726223,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556817156
    },
    {
        "content": "<p>Is your PR ready to merge?</p>",
        "id": 164726232,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556817165
    },
    {
        "content": "<p>Yes, I hope so</p>",
        "id": 164726240,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556817171
    },
    {
        "content": "<p>After getting some food I'll work on README.md and elan.md</p>",
        "id": 164726272,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556817197
    },
    {
        "content": "<p>It's frustrating but if it's worth the trouble if the installation indeed becomes easy</p>",
        "id": 164726306,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556817221
    },
    {
        "content": "<p>Indeed</p>",
        "id": 164726400,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556817276
    },
    {
        "content": "<p>Yes absolutely. Even a few weeks ago at Obergurgl it was painful to install mathlib, which was a shame. It would be great if it were really simple by the time of \"Big Proof\" at the end of this month</p>",
        "id": 164727333,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556818071
    },
    {
        "content": "<p>I don't think \"simple\" is a concrete goal. I think it keeps getting simpler. What specifically do you want it to be like by the end of the month?</p>",
        "id": 164727505,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556818198
    },
    {
        "content": "<p>My experience at AITP was: someone handed me a mac and I followed the instructions in the mathlib README. I typed the <code>curl</code> line and it didn't work to install <code>update-mathlib</code>. I piped everything to a file and ran it, and this did work but then <code>update-mathlib</code> didn't work on the version of mathlib we'd just downloaded, so I had to go to my computer, find a commit hash which I knew update-mathlib would work for, git checkout that commit and then do it. It took about 20 minutes in total.</p>\n<p>Whilst I was doing that, someone with some non-standard linux was trying to install it as well, but when they tried update-mathlib they had the wrong python or the wrong pip or something, and ended up having to upgrade their entire system to fix the problem -- it was \"something they'd been meaning to do for months\" but still.</p>",
        "id": 164728037,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556818541
    },
    {
        "content": "<p>\"simple\" has a very concrete meaning on Debian-like systems. It means <code>sudo apt install lean</code>, wait 30 seconds and then use the software. Having a simple installation procedure means getting closer to this definition of simple. I think copy pasting a <code>curl ... | bash</code> is almost good enough</p>",
        "id": 164729955,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556819884
    },
    {
        "content": "<p>We're not there yet</p>",
        "id": 164729974,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556819895
    },
    {
        "content": "<p>People used to Debian are probably spoiled children, but we still want them on board. It's a bit unfortunate that they are the same people that will read \"If you get stuck, please come to the chat room to ask for assistance.\", follow the link, see you need to register on Zulip, and walk away</p>",
        "id": 164730173,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556820003
    },
    {
        "content": "<p>How hard would it be to create a <code>lean-mathlib</code> package for <code>apt-get</code>?</p>",
        "id": 164730541,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556820235
    },
    {
        "content": "<blockquote>\n<p>Whilst I was doing that, someone with some non-standard linux was trying to install it as well, but when they tried update-mathlib they had the wrong python or the wrong pip or something, and ended up having to upgrade their entire system to fix the problem -- it was \"something they'd been meaning to do for months\" but still.</p>\n</blockquote>\n<p>Well... people with non-standard linux are used to hacking their way through intallation instructions. They inflict that upon themselves. (I know this by experience.) I don't think we need to worry about them. They'll be fine (and happy).</p>",
        "id": 164730690,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556820323
    },
    {
        "content": "<p>Yes, the guy with the non-standard linux took far more than 20 minutes to install mathlib but seemed very happy with the situation at all points. The person with the mac was perplexed that it took so long. They also had to install homebrew or brew or whatever that package manager thing is called.</p>",
        "id": 164731601,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556820894
    },
    {
        "content": "<blockquote>\n<p>How hard would it be to create a <code>lean-mathlib</code> package for <code>apt-get</code>?</p>\n</blockquote>\n<p>There are two very different version of that question.</p>\n<ul>\n<li>\n<p>Creating a <code>leanmathlib.deb</code> that we could put on a website and tell people: download that file and <code>sudo dpkg -i lean-mathlib.deb</code>. This is very easy. I've done it for my department, so that computer people could deploy Lean in our teaching computer room</p>\n</li>\n<li>\n<p>Getting <code>lean</code> in the Debian/Ubuntu repositories is much harder. There are quality requirements here. And it starts with: we should get the source code for Lean and the package must be able to build lean from source. And then someone has to promise to maintain it. It looks easy right now, but wait for Lean 4...</p>\n</li>\n</ul>",
        "id": 164731663,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556820947
    },
    {
        "content": "<p>I'm lying a bit about the first version. I didn't handle elan, only a fixed version of Lean with a fixed version of mathlib</p>",
        "id": 164731940,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821086
    },
    {
        "content": "<p>We've talked about this before I think: and someone said that some big company (like MS) might have people who build and maintain such software packages. That could work really well.</p>",
        "id": 164732315,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821355
    },
    {
        "content": "<p>Also... we'd never want to package mathlib. It is <em>way</em> too rolling release</p>",
        "id": 164732377,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821412
    },
    {
        "content": "<p>What I would do is package the scripts for getting it</p>",
        "id": 164732495,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556821471
    },
    {
        "content": "<p>You can still dream of a day where \"all elementary stuff\" will be in mathlib, and most people won't need to update daily</p>",
        "id": 164732526,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821491
    },
    {
        "content": "<p>But I think the future is a bit too uncertain</p>",
        "id": 164732530,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556821492
    },
    {
        "content": "<p>Packaging for Debian wouldn't much sense at this point</p>",
        "id": 164732567,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821517
    },
    {
        "content": "<p>For now I would just focus on providing our own <code>curl bla | bash</code> installer</p>",
        "id": 164732578,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821525
    },
    {
        "content": "<p>yes</p>",
        "id": 164732585,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821532
    },
    {
        "content": "<p>Also, integration with the VScode extension is a big win</p>",
        "id": 164732588,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821538
    },
    {
        "content": "<p>We could extend that...</p>",
        "id": 164732597,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821546
    },
    {
        "content": "<p>Honestly, my plan is the opposite</p>",
        "id": 164732616,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821561
    },
    {
        "content": "<p>Why that?</p>",
        "id": 164732673,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821576
    },
    {
        "content": "<p>I want to include downloading VScode and installing the Lean extension as part of the <code>curl... | bash</code> thing</p>",
        "id": 164732694,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821596
    },
    {
        "content": "<p>You want <code>elan</code> to install VScode (-; <span aria-label=\"stuck out tongue wink\" class=\"emoji emoji-1f61c\" role=\"img\" title=\"stuck out tongue wink\">:stuck_out_tongue_wink:</span></p>",
        "id": 164732697,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821598
    },
    {
        "content": "<p>I think that's reasonable</p>",
        "id": 164732727,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556821623
    },
    {
        "content": "<p>Also, I would include a <code>--emacs</code> option</p>",
        "id": 164732749,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556821635
    },
    {
        "content": "<p>I tried on real students: finding that extension icon you need to click is far more difficult than copy-paste something in a terminal</p>",
        "id": 164732769,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821651
    },
    {
        "content": "<blockquote>\n<p>Also, I would include a <code>--emacs</code> option</p>\n</blockquote>\n<p>There are no options... only different <code>curl bla | bash</code> lines.</p>",
        "id": 164732862,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821695
    },
    {
        "content": "<p>Indeed :P</p>",
        "id": 164732904,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556821721
    },
    {
        "content": "<p>I see half of my students on Tuesday and half on Friday. During the first week I can tell you I spend my Wednesday creating screenshots to distribute to students</p>",
        "id": 164732961,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821762
    },
    {
        "content": "<p>Or maybe a question...</p>\n<div class=\"codehilite\"><pre><span></span>Do you want\n (i)  VScode or\n (ii) (((super-(world-(domination))-editor) Emacs))?\n</pre></div>",
        "id": 164732984,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821786
    },
    {
        "content": "<p>I wouldn't even bother. People who will prefer emacs over VScode can take care of themselves</p>",
        "id": 164733090,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556821832
    },
    {
        "content": "<p>Right... they fall in the same category as \"non-standard Linux\"-users</p>",
        "id": 164733111,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556821856
    },
    {
        "content": "<p>I think we can have an easy path for the emacs user but I wouldn't ask most user what editor they want</p>",
        "id": 164733630,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556822239
    },
    {
        "content": "<p>emacs users can just grab it off MELPA (is there a similar solution for the community fork of lean-mode?)</p>",
        "id": 164739575,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1556826743
    },
    {
        "content": "<p>What is \"it\"? We're talking about installing VScode + elan + update-mathlib... + all dependencies</p>",
        "id": 164739626,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556826785
    },
    {
        "content": "<p>But I agree that emacs users will probably be savvy enough about their system to figure out how to get what they want.</p>",
        "id": 164739734,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556826847
    },
    {
        "content": "<p>And otherwise there is always <code>C-M-Butterfly</code></p>",
        "id": 164739746,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556826869
    },
    {
        "content": "<p>oh, i meant emacs lean-mode</p>",
        "id": 164740151,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1556827174
    },
    {
        "content": "<p>one might have to manually set the path to the lean executable though</p>",
        "id": 164740282,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1556827231
    },
    {
        "content": "<p>It's not on Melpa but it could be. It needs polishing though</p>",
        "id": 164740306,
        "sender_full_name": "Simon Hudon",
        "timestamp": 1556827256
    },
    {
        "content": "<p>I would like a one-liner for ubuntu / debian which installs VS Code and Lean and mathlib and makes a project with mathlib as a dependency and a file in src called test with a proof that 2 + 2 = 4, and all the olean files, and makes <code>update-mathlib</code> work and git too. I don't care about it automatically keeping up to date. But if anyone in Edinburgh says \"so how do I compile this schemes project?\" I can just say \"type this command\"</p>",
        "id": 164740591,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556827442
    },
    {
        "content": "<p>I hope you will have it tomorrow</p>",
        "id": 164741038,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556827727
    },
    {
        "content": "<p>And I'm worried about python and pip</p>",
        "id": 164741544,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556828109
    },
    {
        "content": "<p>We are still talking about Debian/Ubuntu, right?</p>",
        "id": 164741570,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556828135
    },
    {
        "content": "<p>Right</p>",
        "id": 164743631,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556829772
    },
    {
        "content": "<p>But I guess it would be nice if it worked on a Mac too...</p>",
        "id": 164743661,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556829800
    },
    {
        "content": "<p>For a one off installation we could just dump all the mathlib olean files in with the lean files -- but then I think there are issues with timestamps</p>",
        "id": 164743738,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1556829853
    },
    {
        "content": "<p>I'm pretty sure it's also east on a Mac, we only need to find one (this is much easier than finding a Windows, but still non-trivial)</p>",
        "id": 164745855,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556831506
    },
    {
        "content": "<p>If you've already decided to use virtual box, Microsoft offers isos at <a href=\"https://www.microsoft.com/en-gb/software-download/windows10ISO\" target=\"_blank\" title=\"https://www.microsoft.com/en-gb/software-download/windows10ISO\">https://www.microsoft.com/en-gb/software-download/windows10ISO</a></p>",
        "id": 164752851,
        "sender_full_name": "Andrew Ashworth",
        "timestamp": 1556838054
    },
    {
        "content": "<p>You do not need to activate, you'll just get a nag screen</p>",
        "id": 164752890,
        "sender_full_name": "Andrew Ashworth",
        "timestamp": 1556838111
    },
    {
        "content": "<p>Oh, that's crazy! How can this work? Anyway, I've asked my computer team, and there should be an official way for me. They are asking (it's a very unusual request...)</p>",
        "id": 164795720,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556891646
    },
    {
        "content": "<p>I worked on the Debian side. This is crazily time-consuming, I spent more than two extra hours on this, but I now propose <a href=\"https://github.com/leanprover-community/mathlib/pull/974\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/pull/974\">https://github.com/leanprover-community/mathlib/pull/974</a></p>",
        "id": 164796023,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556891841
    },
    {
        "content": "<p>Featuring the one line to rule them all: <a href=\"https://github.com/leanprover-community/mathlib/blob/debian/docs/install_debian.md\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/blob/debian/docs/install_debian.md\">https://github.com/leanprover-community/mathlib/blob/debian/docs/install_debian.md</a></p>",
        "id": 164796062,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556891881
    },
    {
        "content": "<p>I really like the example project that you suggest in your tutorial (-;</p>",
        "id": 164796391,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1556892051
    },
    {
        "content": "<p>It's replacing <code>lean-stacks-project</code> which is currently in the general documentation</p>",
        "id": 164796521,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556892135
    },
    {
        "content": "<p>The last few steps of your instructions can be simplified: you can open the current working directory in VS Code by typing <code>code .</code> instead of <code>code</code>. Would you mind if I edited this into your branch?</p>",
        "id": 164796851,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1556892391
    },
    {
        "content": "<p>I never managed to get <code>code .</code> to behave this way</p>",
        "id": 164796876,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556892429
    },
    {
        "content": "<p>Oh, that's strange. Never mind then.</p>",
        "id": 164796921,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1556892477
    },
    {
        "content": "<p>And I'm not sure we want to hide how to open a folder in VScode. In my teaching experience, that's the most frequent source of confusion for students (far more confusing than type class search or coercions).</p>",
        "id": 164796984,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556892502
    },
    {
        "content": "<p>No matter how often I tell them where to put files and what folder to open, I still have to go around the computer room to fix this</p>",
        "id": 164797008,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556892537
    },
    {
        "content": "<p>(France no longer has a mandatory military year for 18 years old men. So giving a list of instruction to follow without thinking does <em>not</em> work on first year university students)</p>",
        "id": 164797132,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1556892615
    },
    {
        "content": "<p>The install instructions should be updated to reflect the migration of the scripts to <code>mathlib-tools</code> (I was walking someone through the install instructions 5 minutes ago)</p>",
        "id": 165540336,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1557762188
    },
    {
        "content": "<p>PR'd</p>",
        "id": 165540642,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1557762370
    },
    {
        "content": "<p>the URLs inside <code>remote-install-update-mathlib.sh</code> need to be updated too</p>",
        "id": 165541007,
        "sender_full_name": "Jesse Michael Han",
        "timestamp": 1557762609
    },
    {
        "content": "<p>I was complaining about this one hour ago, but needed to go get my children</p>",
        "id": 165545218,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1557765455
    }
]