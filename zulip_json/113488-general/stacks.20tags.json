[
    {
        "content": "<p>Top 35, with labels</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>00DV 119 algebra-lemma-NAK\n01ZM 69 limits-lemma-descend-finite-presentation\n02KH 64 coherent-lemma-flat-base-change-cohomology\n06Z0 61 perfect-lemma-affine-compare-bounded\n03H4 57 spaces-properties-lemma-points-cartesian\n01XB 48 coherent-lemma-quasi-coherent-affine-cohomology-zero\n00NX 47 algebra-lemma-finite-projective\n01UA 46 morphisms-lemma-fppf-open\n0149 41 derived-lemma-representable-homological\n00DS 41 algebra-lemma-silly\n01LC 40 schemes-lemma-push-forward-quasi-coherent\n00E0 40 algebra-lemma-Zariski-topology\n00MB 39 algebra-lemma-completion-flat\n00EU 37 algebra-lemma-minimal-prime-reduced-ring\n01T6 36 morphisms-lemma-finite-type-noetherian\n00XR 36 sites-lemma-when-shriek\n00U2 36 algebra-lemma-etale\n03H6 34 spaces-properties-lemma-quasi-compact-affine-cover\n01W6 34 morphisms-lemma-image-proper-scheme-closed\n00NQ 34 algebra-lemma-regular-ring-CM\n01Z4 33 limits-lemma-descend-opens\n00HN 32 algebra-lemma-characterize-zero-local\n001P 32 categories-lemma-yoneda\n08J5 31 derived-remark-truncation-distinguished-triangle\n01T2 31 morphisms-lemma-locally-finite-type-characterize\n00KW 31 algebra-lemma-one-equation\n07SK 29 spaces-limits-lemma-descend-finite-presentation\n01WM 29 morphisms-lemma-integral-universally-closed\n01U9 29 morphisms-lemma-base-change-flat\n015J 29 derived-lemma-two-ss-complex-functor\n04XB 28 stacks-properties-section-properties-morphisms\n04KF 28 spaces-properties-lemma-describe-etale-local-ring\n01WN 28 morphisms-lemma-finite-proper\n00HL 28 algebra-lemma-flat-tor-zero\n00HI 28 algebra-lemma-flat-base-change\n</code></pre></div>",
        "id": 226943606,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613729563
    },
    {
        "content": "<p>A brief glance, we have <code>NAKayama</code>, <code>yoneda</code>, <code>Zariski-topology</code>. Most of the rest seems quite far away.</p>",
        "id": 226943821,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613729679
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113488-general/topic/https.3A.2F.2Fleanprover-community.2Egithub.2Eio.2Fmathlib_docs.2F/near/226938750\">said</a>:</p>\n<blockquote>\n<p>I think the chance that old tags rot is very small. So the main issue is that new things should get tagged. This will have to be a community effort. But I think it's ok if we do it in bursts.</p>\n</blockquote>\n<p>But like you said there are a lot of stacks tags, and there are a lot of contributors here who don't know the project. How do these bursts work? Read all the stacks tags and remember what's been added to mathlib since the last iteration? Or look at a month of mathlib commits and see which ones might have corresponding tags?</p>",
        "id": 226944487,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613730086
    },
    {
        "content": "<p>Is there any chance of a new stacks tag that corresponds to something already in mathlib?</p>",
        "id": 226944533,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613730122
    },
    {
        "content": "<p>I think the latter chance is very small (but increasing?!)</p>",
        "id": 226945293,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613730597
    },
    {
        "content": "<p>Those bursts would have to be done by the algebraists in our community. Look through <code>ring_theory/</code> and <code>algebraic_geometry/</code> for lemmas that don't have <code>@[stacks]</code> but for which you expect that SP will have a tag for it.</p>",
        "id": 226945439,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613730665
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113488-general/topic/https.3A.2F.2Fleanprover-community.2Egithub.2Eio.2Fmathlib_docs.2F/near/226945293\">said</a>:</p>\n<blockquote>\n<p>I think the latter chance is very small (but increasing?!)</p>\n</blockquote>\n<p>Do old tags ever get split? Like, ABC gets expanded and a lemma becomes DEF? That seems like the more likely way for this to happen.</p>",
        "id": 226945487,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613730713
    },
    {
        "content": "<p>They make a very strong effort to never change the <em>statement</em> of a tag (apart from cosmetic changes).</p>",
        "id": 226945590,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613730766
    },
    {
        "content": "<p>So if there is a split, my guess is that you'll get two new tags, and the old one will be \"deprecated\" (but still point to the old result, but not show up in their most rendering of the website)</p>",
        "id": 226945655,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613730799
    },
    {
        "content": "<p>Right, so if ABC is in mathlib and gets split into DEF and GHI, then DEF and GHI are new tags that are likely in mathlib</p>",
        "id": 226945742,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613730851
    },
    {
        "content": "<p>So you need to track changes on their end as well as ours</p>",
        "id": 226945771,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613730876
    },
    {
        "content": "<p>I think they maintain a list of deprecated tags. So part of a \"burst\" could be to check against that list.</p>",
        "id": 226945853,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613730950
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>#003W,categories-equation-fibred-groupoids-commutes\n#003X,categories-equation-fibred-groupoids-commutes2\n#Taken out as an exact duplicate of 00CR\n#00DU,algebra-lemma-localize-colimit\n#This equation was in a second proof 00EE which we removed\n#00EL,algebra-equation-idempotent-exact-sequence\n#Replaced proof by a new one avoiding this equation\n#013L,derived-equation-new-star\n#013M,derived-equation-star-star\n#013Z,derived-remark-failure\n#014T,derived-section-derived-triangulated\n#014U,derived-definition-derived-triangulated\n#0155,derived-lemma-ses-injective-ses\n# Equations for relations between maps no longer needed because of\n# vastly improve proof of Lemma Tag 01A6\n#01A7,simplicial-equation-cd\n#01A8,simplicial-equation-cs\n# Changed coherent-remark-base-complex into lemma\n# Changed coherent-remark-hypercoverings into lemma\n#The following tag referred to a technical question whose answer is now in the\n#stacks project, namely, it is answered by (the new version of) 01ZH\n#01ZI,limits-remark-question-finite-type-necessary\n# This section got moved to properies.tex\n# This affects tags 01ZU, 01ZV, 01ZW, 01ZX, 01ZY\n</code></pre></div>",
        "id": 226946101,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613731099
    },
    {
        "content": "<p>All the commented out tags are deprecated. <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span> is the first chunk of about 100 such lines that <code>grep</code> found for me in <code>tags/tags</code></p>",
        "id": 226946147,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613731130
    },
    {
        "content": "<p>So I'm not saying \"don't do this,\" just trying to emphasize that this is a sustained maintenance effort that needs someone to lead the charge. Otherwise infrastructure will be built and forgotten and there will be a bunch of incomplete and outdated noise floating around.</p>",
        "id": 226946396,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613731299
    },
    {
        "content": "<p>OK I'll do it.</p>",
        "id": 226946586,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613731422
    },
    {
        "content": "<p>Stacks is becoming a canonical reference for commutative algebra for the young -- even the \"standard\" textbooks like Matsumura and Atiyah-Macdonald seem to be going out of fashion, because Stacks is online and looks beautiful, much better than the dodgy illegal pdfs (sometimes not even OCR'ed) which the UGs have of the classic books.</p>\n<p>For me, moving into commutative algebra is a very natural next step for mathlib. Avigad has always pointed out how Lean is really dominating when it comes to algebra. Isabelle is still way ahead on analysis and of course Coq has the odd order theorem, however the odd order theorem is tons of lemmas about finite groups and some basic undergraduate representation theory, and this does not really add new users. If you look at what is coming out way, it's mathematicians appearing out of nowhere saying things like \"let's do regular rings\" or \"let's do flat modules\". Stacks is a perfect blueprint for this stuff.</p>\n<p>I know the material well enough to even start breaking stuff up into \"mini-projects\", and I can probably be trusted to be diligent enough to make sure that things aren't broken. Disadvantages: I can't do any computer things. But I think that if the buck stops with me then this will be good enough for me to at least take responsibility for problems.</p>",
        "id": 226947012,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613731664
    },
    {
        "content": "<p>Another thing I mentioned when we talked about this a while back. This is a big human-curated formal-informal alignment, the ML people here should be drooling at the idea. It would probably be helpful to have a story for <a href=\"https://stacks.math.columbia.edu/tag/055X\">things that don't align perfectly</a> -- humans can adapt easily enough, maybe machines could use something systematic?</p>",
        "id": 226947061,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613731684
    },
    {
        "content": "<p>I agree that we could try to at least have a bool that tracks whether things \"obviously don't line up perfectly\". But as you point out, since the definition of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N}</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">N</span></span></span></span></span> doesn't line up, that basically means that almost everything that follows is infected by that virus.</p>",
        "id": 226947321,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613731877
    },
    {
        "content": "<p>So that <code>bool</code> should be applied with a bit of human wisdom...</p>",
        "id": 226947339,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613731894
    },
    {
        "content": "<p>One issue which I discovered recently is that when Bhavik was working on sheaves taking values in a general category, he had to cite things like \"Stacks, remark between tag X and tag Y\". For me the natural number thing is right now just noise. I know this sounds weird but actually the natural numbers in some sense do not show up much in this kind of mathematics. I took a good look through stacks when this convention was pointed out a few months back, and most of the uses of naturals just seemed to be as an arbitrary countably infinite index set. One of the few times naturals do show up as as dimensions of schemes, and certainly there are 0-dimensional schemes, so all that will be happening is that Stacks will sometimes say Z_{&gt;=0}. We can translate this, as long as I'm overseeing stuff.</p>",
        "id": 226947347,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613731901
    },
    {
        "content": "<p>I guess we can make PRs to Stacks that add labels to \"remark between tag X and tag Y\", or rewrite that part of stacks to make things slightly more explicit. My guess is that Johan will be happy to receive such PRs.</p>",
        "id": 226947478,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613731984
    },
    {
        "content": "<p>I think we need to talk to Pieter Belmans about this (he's at Bonn, the same place as Scholze, so this is cool).</p>",
        "id": 226947520,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613732002
    },
    {
        "content": "<p>I had rather hoped that this term would be a bit quieter, but preparing my course has taken a lot of my time. It's over in three weeks though.</p>",
        "id": 226947627,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613732049
    },
    {
        "content": "<p>It reminds me: did we settle the crazy <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> issue? I don't care what the Stacks project thinks here, there is now way we can keep the notation and name <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> for something related but different from what the whole universe but the Stacks project calls <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\pi_0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>.</p>",
        "id": 226947777,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1613732153
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span> yes, that got fixed</p>",
        "id": 226948137,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613732350
    },
    {
        "content": "<p>It's now called <code>connected_components</code></p>",
        "id": 226948149,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613732358
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/stacks.20tags/near/226947520\">said</a>:</p>\n<blockquote>\n<p>I think we need to talk to Pieter Belmans about this (he's at Bonn, the same place as Scholze, so this is cool).</p>\n</blockquote>\n<p>I'm now here! And my only interactions with Peter have been when I was in his way to the coffee machine, or he was in my way to the tea kettle, so don't read my association to Bonn in any way :)</p>",
        "id": 226957714,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613738529
    },
    {
        "content": "<p>So we think we have enough commutative algebra and category theory now to start thinking more seriously about integration of mathlib with the stacks project.</p>",
        "id": 226957883,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613738640
    },
    {
        "content": "<p>We've needed to do a bunch of category theory to get the definition of a condensed abelian group, and people followed the stacks project to do some of this; also commutative algebra is slowly but surely appearing (e.g. we have lots of facts about Jacobson rings and the NSS, with more in the pipeline) so maybe it's time to think about how to actually do this.</p>",
        "id": 226958007,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613738722
    },
    {
        "content": "<p>Right now at our end we are considering adding a stacks project attribute which we can attach to definitions and lemmas, pointing people to the corresponding stacks project tag.</p>",
        "id": 226958168,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613738797
    },
    {
        "content": "<p>and documentation tools could use the attribute to generate a dictionary <code>json</code> or such</p>",
        "id": 226958334,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613738866
    },
    {
        "content": "<p>One issue that showed up is <a href=\"https://github.com/leanprover-community/mathlib/blob/e2a6e3f6e92e37000cbb5976f6845e64353fdb7d/src/category_theory/sites/sheaf.lean#L112\">this</a>, a reference to a diagram <a href=\"https://stacks.math.columbia.edu/tag/00VL\">here</a> which didn't have a tag.</p>",
        "id": 226958502,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613738958
    },
    {
        "content": "<p>it's really easy to assign a new tag to a useful equation which currently does not have one, and we should be able to convince Johan of this</p>",
        "id": 226958550,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613738998
    },
    {
        "content": "<p>If we are going to start doing something at our end, I guess it would be good to know whether you think it might be useful at your end, or at least usable if you want to use it in some way. I guess the dictionary could e.g. relate stacks tags to links to the mathlib API. Is there any particular thing which you want want to see or hope to see or whatever?</p>",
        "id": 226958942,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613739218
    },
    {
        "content": "<p>that's not so much a question for me per se, but more for Johan: I don't know what kind of mathlib integration he foresees</p>",
        "id": 226959132,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739325
    },
    {
        "content": "<p>when I say Johan, I mean not this Johan, but the other Johan</p>",
        "id": 226959143,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739338
    },
    {
        "content": "<p>but I think having a visual clue about which tags have been formalised, and having a link to the mathlib documentation, seems like a good thing that I hope I can convince the other Johan of</p>",
        "id": 226959273,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739418
    },
    {
        "content": "<p>I don't quite know what the analogue of a tag is in mathlib, but having a uniform way of saying \"this thing here corresponds to tag 0000\" should be enough to allow for scraping the source code, and then we can set up a dictionary from that</p>",
        "id": 226959475,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739565
    },
    {
        "content": "<p>The easy (from our end at least) kind of \"integration\" is just cross referencing. For various reasons it seems simpler to store the correspondences on the mathlib side, and then it's very simple to generate a map from mathlib declarations (or files, or locations in the docs) to stacks tags.</p>",
        "id": 226959567,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613739617
    },
    {
        "content": "<p>Yes, that's exactly what those attributes will do. Although it will quite likely be a many-to-one dictionary. With 5 mathlib declarations working together to get one Stacks tag.</p>",
        "id": 226959593,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613739638
    },
    {
        "content": "<p>I don't know if the correspondences are one-to-one or many-to-many or what.</p>",
        "id": 226959604,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613739646
    },
    {
        "content": "<p>For example \"The following are equivalent\" are typically broken into pieces in mathlib.</p>",
        "id": 226959619,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1613739657
    },
    {
        "content": "<p>yes, exactly, I think mathlib is the more unstable thing, and the arity of the correspondence is I guess the major thing to understand</p>",
        "id": 226959629,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739665
    },
    {
        "content": "<p>so the Stacks project website (or some overlay, or some separate website) could do several things:</p>\n<ul>\n<li>show that there is some kind of relationship between tags and mathlib code, without a serious commitment</li>\n<li>really commit to showing certain results</li>\n</ul>",
        "id": 226960119,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613739931
    },
    {
        "content": "<p>We have a reasonable API right now for getting a \"display version\" of a theorem statement. See <a href=\"https://leanprover-community.github.io/100.html\">https://leanprover-community.github.io/100.html</a> , that's generated from <a href=\"https://github.com/leanprover-community/mathlib/blob/master/docs/100.yaml\">https://github.com/leanprover-community/mathlib/blob/master/docs/100.yaml</a></p>",
        "id": 226960298,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613740030
    },
    {
        "content": "<p>So if you wanted to really display the formal statements (on the main website or another, whatever), it's easy to set up.</p>",
        "id": 226960364,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613740080
    },
    {
        "content": "<p>here (or rather on some place like <a href=\"https://leanprover-community.github.io/mathlib_docs/ring_theory/nullstellensatz.html\">https://leanprover-community.github.io/mathlib_docs/ring_theory/nullstellensatz.html</a>) you could easily add a link to the Stacks project website I guess, based on some decoration of the code, that is one thing</p>",
        "id": 226960609,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740223
    },
    {
        "content": "<p>I don't know whether Johan wants to display anything more than just a link on the Stacks project website</p>",
        "id": 226960649,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740251
    },
    {
        "content": "<p>Right, we would definitely do that and it's pretty trivial to set up.</p>",
        "id": 226960912,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613740413
    },
    {
        "content": "<p>one issue from the Stacks project POV is synchronisation: how and when will the website update, when updates to mathlib happen</p>",
        "id": 226960918,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740419
    },
    {
        "content": "<p>but I guess with some continuous integration magic (that you seem to have set up anyway) you can create say a JSON file with the up-to-date information, and that can be read by the Stacks project infrastructure</p>",
        "id": 226961012,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740485
    },
    {
        "content": "<p>so I'm imagining a single file giving a tag and then a file + line number + method name, and that would be the first thing for mathlib integration in the Stacks project website</p>",
        "id": 226961215,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740607
    },
    {
        "content": "<p>in the table of contents (see e.g. <a href=\"https://stacks.math.columbia.edu/tag/073W\">https://stacks.math.columbia.edu/tag/073W</a> and expand) we can add an icon, indicating that there is a mathlib implementation (see the indication of a slogan on tag 074W)<br>\non the page of a tag (see e.g. <a href=\"https://stacks.math.columbia.edu/tag/074W\">https://stacks.math.columbia.edu/tag/074W</a>) we can have the precise link to mathlib</p>",
        "id": 226961439,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613740732
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"390767\">Pieter Belmans</span> <a href=\"#narrow/stream/113488-general/topic/stacks.20tags/near/226961215\">said</a>:</p>\n<blockquote>\n<p>so I'm imagining a single file giving a tag and then a file + line number + method name, and that would be the first thing for mathlib integration in the Stacks project website</p>\n</blockquote>\n<p>Probably a list of files + line numbers + declaration names, but yeah! How often do you see the Stacks project infrastructure retrieving the database from our end?</p>",
        "id": 226961652,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613740850
    },
    {
        "content": "<p>right now we are loading and caching an RSS file for the blog posts and GitHub commits once every hour or day</p>",
        "id": 226961974,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613741006
    },
    {
        "content": "<p>I can check the precise caching settings, but I'd imagine something similar here: hitting it for every request is nonsense :)</p>",
        "id": 226962013,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613741038
    },
    {
        "content": "<p>RSS cache is cleared once per hour</p>",
        "id": 226962233,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613741162
    },
    {
        "content": "<p>If the name of a tagged declaration in mathlib changes, links to the mathlib docs will break until you resync. But I guess this won't happen too often? We can handle declarations that move to a new file but keep the same name.</p>",
        "id": 226962733,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613741419
    },
    {
        "content": "<p>Links to the source code on github can point to a specific commit, so those can be stable.</p>",
        "id": 226962786,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613741449
    },
    {
        "content": "<p>but any such change would trigger a rebuild of that particular file (i.e. the dictionary file), no?</p>",
        "id": 226962825,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613741474
    },
    {
        "content": "<p>Right, but links will be broken until you pull the new dictionary.</p>",
        "id": 226963004,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613741562
    },
    {
        "content": "<p>It's a rare event and the broken links won't last long so I'm not too worried about it.</p>",
        "id": 226963073,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613741599
    },
    {
        "content": "<p>we'd only cache that for an hour or so, so I don't worry about those things being out of sync; the Stacks project is popular, but not _that_ popular that there'd be many confused people</p>",
        "id": 226963080,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613741603
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> is the mathlib-stacks correspondence many-to-one or many-to-many?</p>",
        "id": 226965619,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613742905
    },
    {
        "content": "<p>And is it necessary to have tags in module docs? Or only declarations?</p>",
        "id": 226965666,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613742940
    },
    {
        "content": "<p>If it's only declarations, I think it's probably better to use an <code>@[stacks \"ABC\"]</code> attribute to avoid making up and parsing new markdown syntax.</p>",
        "id": 226965823,
        "sender_full_name": "Rob Lewis",
        "timestamp": 1613743020
    },
    {
        "content": "<p>Sorry, I'm about to start a meeting. We could force it to be one-to-one but this would probably be a bad idea. One of the lemmas we formalised when doing schemes was a lemma about basic ring theory which had 22 parts (which became 22 lemmas in our project) and then said \"...\" afterwards!</p>",
        "id": 226966278,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613743222
    },
    {
        "content": "<p>On the other hand I am struggling to think of one definition or theorem in mathlib which could genuinely be tagged with more than one tag.</p>",
        "id": 226966372,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613743265
    },
    {
        "content": "<p>I think we will end up mentioning Stacks tags in module docs and docstrings even if we have the attributes, so we should have some convention for those citations too.</p>",
        "id": 226970086,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1613744902
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/stacks.20tags/near/226966372\">said</a>:</p>\n<blockquote>\n<p>On the other hand I am struggling to think of one definition or theorem in mathlib which could genuinely be tagged with more than one tag.</p>\n</blockquote>\n<p>The closest which comes to mind for me is <a href=\"https://github.com/leanprover-community/mathlib/pull/5927/files#diff-b339408bea66dd365a33cbd939875712dd819b5adf71f314691da2f2ab210a43R221\">this lemma</a>, which is a generalisation of both <a href=\"https://stacks.math.columbia.edu/tag/0073\">https://stacks.math.columbia.edu/tag/0073</a> and <a href=\"https://stacks.math.columbia.edu/tag/00YR\">https://stacks.math.columbia.edu/tag/00YR</a> (a), in particular the former talks about sheaves on a space taking values in a nice concrete category, and the latter talks about sheaves on a site taking values in the same nice concrete category but with an extra assumption on it; whereas the Lean version talks about sheaves on a site taking values in a concrete category without the extra assumption</p>",
        "id": 226972313,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1613745828
    },
    {
        "content": "<p>So should the generalization get its own stacks tag?</p>",
        "id": 226973204,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1613746216
    },
    {
        "content": "<p>I don't think it makes sense to modify the Stacks project in such a way, based on a quickly developing formalisation project<br>\nit makes sense to take certain cues (e.g. to make referencing easier, adding tags for equations and informal discussions), but anything beyond that you will have a very hard time convincing Johan of</p>",
        "id": 226973525,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613746366
    },
    {
        "content": "<p>Yeah, I think for the sake of exposition the way Stacks does it right now is sensible - <a href=\"https://stacks.math.columbia.edu/tag/0073\">https://stacks.math.columbia.edu/tag/0073</a> is in the context of talking about sheaves on a space, and the part of <a href=\"https://stacks.math.columbia.edu/tag/00YR\">https://stacks.math.columbia.edu/tag/00YR</a> which is relevant is the first part in a series of six statements, where only the first doesn't need the extra assumption</p>",
        "id": 226974471,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1613746799
    },
    {
        "content": "<p>I certainly agree that asking de Jong to change any of the exposition would be a very bad idea. \"Can you please split this lemma into two because of some formaliser people\" means having to go through everywhere where the lemma is used and understanding the mathematics again and then deciding how to rephrase stuff. I think that we have the flexibility to write our own library so that the correspondence is a simple one-tag-to-many-defs/theorems.</p>",
        "id": 226976752,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613747691
    },
    {
        "content": "<p><a href=\"https://stacks.math.columbia.edu/tag/00E0\">Here is tag 00E0</a> -- this should definitely not be one lemma in Lean!</p>",
        "id": 226977088,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613747807
    },
    {
        "content": "<p>Kenny proved all 17 statements though in our preliminary formalisation of the definition of a scheme.</p>",
        "id": 226977180,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613747847
    },
    {
        "content": "<p>some of the issues you encounter here, such as this monstrosity lemma with 17 parts, are only happening at the beginning of the Stacks project: the stuff that an algebraic geometer likes to get away with in order to get cracking with the geometry</p>",
        "id": 226977455,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613747963
    },
    {
        "content": "<p>(I have no idea how Stacks-aware people are, if I'm stating too many obvious things in my desire to explain the Stacks project, please tell!)</p>",
        "id": 226977501,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613747987
    },
    {
        "content": "<p>there are people here ranging from professional algebraic geometers to people doing post-docs in computer science topics who know a lot about mathlib documentation but have probably never even been to the stacks project website and don't know any alg geom at all, so feel free to say obvious-to-some-people things.</p>",
        "id": 226978841,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613748515
    },
    {
        "content": "<p>Would it make sense to prove lemmas in mathlib style, and, once a literal stacks statement can be proved, simply add that result in?  In the 17 example above, after the 17 lemmas, prove another one that is simply the conjunction of the previous 17?  This way, we can keep a 1-1 correspondence to something stable...</p>",
        "id": 227024216,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1613766892
    },
    {
        "content": "<p>This is another possibility but, just as the stacks people will not want to change their 1 lemma into 17 lemmas because of the mathlib people, I don't think that the mathlib people will want a conjunction of 17 lemmas just because of the stacks people. Both communities are right now extremely successful in their own ways and one reason I believe for this is the extremely high level of attention which everything gets -- as you will know if you ever tried to PR one lemma and had about 5 people suggesting alternative proofs, putting it in a different namespace, a different file, adding three more lemmas, and actually perhaps completely refactoring something else so your lemma would not be necessary. I think it's best to not try and change either side of things and instead just do the best we can to show that they are doing related things.</p>",
        "id": 227024855,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613767193
    },
    {
        "content": "<p>An alternative approach is to start a new repo stacks-in-lean which does have these horrendous conjunctions in and has mathlib as a dependency, but for me this seems to be a far more painful solution -- it will need constant maintenance, for example, and in practice if someone wants to see a lemma which really _is_ directly in mathlib (and of course this sort of thing will happen a lot) they don't really want to be sent to some random other repo with mathlib as a dependency.</p>\n<p>My gut feeling is that actually one should be liberal here. If there is a tag X in stacks which is mathematically trivially covered by e.g. the union of three lemmas in mathlib then those lemmas should get given the <code>@[stacks X]</code> attribute and also probably docstrings saying what they do in a way which a mathematician would understand.</p>",
        "id": 227025365,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613767440
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span> I can envisage the following situation: stacks tag X proves lemma L assuming some ultimately superfluous extra hypothesis, and then using lemma L it proves in tag X' the correct lemma L' without the superfluous hypotheses. Mathlib uses a totally different approach so doesn't need to go via L. Nobody wants to see L in mathlib because there is no point. So now we want to tag our lemma L' with both stacks tag X and X', and perhaps explain in a comment or docstring why tag X leads to a proof which is strictly stronger than what is stated in X. </p>\n<p>Also it is kind of clear that not all tags need to be formalised in mathlib. There might be useless intermediate lemmas proved in Stacks which are never used again other than in the proof of a bigger theorem, and the mathlib proof of the bigger theorem is different and doesn't go via the lemma. So a naive \"we're not done until all the tags are formalised\" approach is not right. </p>\n<p>For me the main aim is not getting an AI to learn stacks via mathlib, and my impression is that AI stuff is happy to be sloppy anyway (cf Szegedy's comment that he doesn't care at all that the naturals start at 1 in stacks and 0 in Lean because it's all heuristics anyway). For me the aim is to see if this helps with search in stacks, which to be honest I find very poor. Example : <a href=\"https://stacks.math.columbia.edu/search?query=affine+scheme\">where is the definition of an affine scheme?</a> . But maybe this is a lousy example because affine schemes are probably everywhere in stacks.</p>",
        "id": 227026587,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613767983
    },
    {
        "content": "<p>Kevin, I agree.  I think that being liberal in the referencing is perfectly ok and in fact, desirable.  If a mathlib statement proves a commutative algebra assuming comm_semiring, while the one in stacks is about a comm_ring, I think that it is more than fair that they get the same tag!</p>",
        "id": 227029668,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1613769336
    },
    {
        "content": "<p>In fact, should we call these... \"stags\"?</p>",
        "id": 227029779,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1613769379
    },
    {
        "content": "<p>It sounds like we came to the conclusion that it is pretty close to a many(mathlib)-to-one(stacks), relationship, but possibly with some exceptions.</p>",
        "id": 227065088,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1613795195
    },
    {
        "content": "<p>I remember in the elementary category theory stuff finding quite a few cases of misalignments, often when mathlib proved \"the main part\" of a stacks tag but omitted some minor point.</p>",
        "id": 227065123,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1613795259
    },
    {
        "content": "<p>I'd propose that we be open to including these as cross references. Ideally on the mathlib side there will be a link back to the stacks tag along with a note \"we don't do part e\" or similar.</p>",
        "id": 227065199,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1613795332
    },
    {
        "content": "<p>After the current doc-gen PR is merged, I'm planning to collect all the Stacks tag URLs / other tag-like patterns in docstrings and display those in a special section of the references page.</p>\n<p>As I said above, even if we have attributes, we'll still be mentioning Stacks tags in the docstrings, so this effort should be complementary to whatever we decide for the stacks attribute.</p>",
        "id": 227065440,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1613795628
    },
    {
        "content": "<p>Why not something like <code>@[stacks \"01AB\" \"part (a,b,c)\"]</code> if we really want to keep track of sub-tag tracking in a machine readable way, and</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"sd\">/-- Foos the bar. Stacks project 01AB, part (a,b,c) -/</span>\n<span class=\"kd\">@[stacks \"01AB\"]</span>\n<span class=\"kd\">def</span> <span class=\"bp\">...</span>\n</code></pre></div>\n<p>otherwise</p>",
        "id": 227065525,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1613795702
    },
    {
        "content": "<p>In line with this stream, I updated one of my files to add an explicit reference to the Stacks Project.  This is another one of those cases where I proved a part of the statement, but not the whole lemma.</p>\n<p>PR <a href=\"https://github.com/leanprover-community/mathlib/issues/6322\">#6322</a></p>",
        "id": 227068625,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1613799286
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span>  to find the definition of an affine scheme using the search, it is but a small thing to search for 'affine scheme definition' and limit yourself to statements (see <a href=\"https://stacks.math.columbia.edu/search?query=affine+scheme+definition&amp;radius=statements\">https://stacks.math.columbia.edu/search?query=affine+scheme+definition&amp;radius=statements</a>): the name of the LaTeX environment is also being used in the plaintext search, and now the first result is indeed the definition of an affine scheme :)</p>",
        "id": 227069442,
        "sender_full_name": "Pieter Belmans",
        "timestamp": 1613800344
    },
    {
        "content": "<p>I think that we still need to do some thinking about exactly what data we want to be collecting here. Right now I like Mario's suggestion. I also think that perhaps I was hasty yesterday saying \"who cares about the machine learning people, let's just try and make killer search for theorems\". I need to spend some time looking at all the examples we have, also also things we don't have but which I would see as minor success stories (e.g. proving some standard theorem about schemes which all alg geometers know, even if it's a standard basic one) and trying to imagine what the mathlib version would actually look like. So my gut feeling right now is just to start off with some detailed notes about what the actual correspondence between the two databases looks like. I am unlikely to find the time to do this before teaching finishes, which is in just under three weeks. <span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> I think you might have already tried something like this. Is there even some branch, which perhaps was already mentioned?</p>",
        "id": 227091702,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613827568
    },
    {
        "content": "<p>A bit of a tangential thought: it might be interesting to generate a list of stacks tags that are not formalized, while all the tags they depend on are formalized</p>",
        "id": 227091998,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1613827939
    },
    {
        "content": "<p>Yes, the \"boundary\" of what is done. One could imagine Patrick's flowchart tool thing being helpful here.</p>",
        "id": 227092395,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1613828456
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113488-general/topic/stacks.20tags/near/227091702\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110087\">Scott Morrison</span> I think you might have already tried something like this. Is there even some branch, which perhaps was already mentioned?</p>\n</blockquote>\n<p>All the actual tagging done in the <a href=\"https://github.com/leanprover-community/mathlib/tree/stacks\">branch#stacks</a> using <code>@[stacks 01AB]</code> has since been incorporated into mathlib using full URLs in doc-strings.</p>\n<p>What that branch does still have it a script that scrapes all those doc-strings and produces a yaml file, ready for consumption by the stacks build process.</p>",
        "id": 227106665,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1613843451
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/blob/stacks/scripts/stacks_tags.lean\">scripts/stacks_tags.lean</a> and <a href=\"https://github.com/leanprover-community/mathlib/blob/stacks/src/meta/stacks.lean\">meta/stacks.lean</a> get data from the stacks attribute, not the doc strings, right?</p>",
        "id": 227106897,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1613843665
    }
]