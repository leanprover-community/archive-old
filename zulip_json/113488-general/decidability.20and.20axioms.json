[
    {
        "content": "<p>Dear All,</p>\n<p>in the recent PR <a href=\"https://github.com/leanprover-community/mathlib/pull/14095\">#14095</a>, it was suggested to add a <code>decidable_eq</code> assumption and remove <code>classical</code> from the proof.  I am happy with this, but I now wonder what is the gain with this.  For instance, the <code>axiom</code>s used are the same:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.polynomial.degree.lemmas</span>\n\n<span class=\"n\">open_locale</span> <span class=\"n\">polynomial</span>\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">semiring</span> <span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">nat_degree_monomial_eq</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">r0</span> <span class=\"o\">:</span> <span class=\"n\">r</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">monomial</span> <span class=\"n\">i</span> <span class=\"n\">r</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">nat_degree</span> <span class=\"bp\">=</span> <span class=\"n\">i</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">nat_degree_monomial</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"o\">(</span><span class=\"n\">if_neg</span> <span class=\"n\">r0</span><span class=\"o\">)</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">nat_degree_monomial_eq_class</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">r0</span> <span class=\"o\">:</span> <span class=\"n\">r</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">monomial</span> <span class=\"n\">i</span> <span class=\"n\">r</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">nat_degree</span> <span class=\"bp\">=</span> <span class=\"n\">i</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"n\">classical</span><span class=\"bp\">;</span> <span class=\"n\">exact</span> <span class=\"n\">eq.trans</span> <span class=\"o\">(</span><span class=\"n\">nat_degree_monomial</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">if_neg</span> <span class=\"n\">r0</span><span class=\"o\">)</span>\n\n<span class=\"k\">#print</span> <span class=\"kd\">axioms</span> <span class=\"n\">nat_degree_monomial_eq</span>\n<span class=\"k\">#print</span> <span class=\"kd\">axioms</span> <span class=\"n\">nat_degree_monomial_eq_class</span>\n<span class=\"c\">/-</span><span class=\"cm\">  both give</span>\n<span class=\"cm\">quot.sound</span>\n<span class=\"cm\">propext</span>\n<span class=\"cm\">classical.choice</span>\n<span class=\"cm\">-/</span>\n<span class=\"bp\">-/</span>\n</code></pre></div>\n<p>Is there an advantage to the extra <code>decidable_eq R</code> assumption?</p>",
        "id": 282065954,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652339008
    },
    {
        "content": "<p>Nevermind, the linter just complained:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> The `decidable_classical` linter reports: -/</span>\n<span class=\"c\">/-</span><span class=\"cm\"> USES OF `decidable` SHOULD BE REPLACED WITH `classical` IN THE PROOF. -/</span>\n<span class=\"c1\">-- data/polynomial/degree/definitions.lean</span>\n<span class=\"k\">#check</span> <span class=\"bp\">@</span><span class=\"n\">polynomial.nat_degree_monomial_eq</span> <span class=\"c\">/-</span><span class=\"cm\"> The following `decidable` hypotheses should be replaced with</span>\n<span class=\"cm\">                      `classical` in the proof. argument 3: [_inst_2 : decidable_eq R] -/</span>\n<span class=\"n\">Error</span><span class=\"o\">:</span> <span class=\"n\">polynomial.nat_degree_monomial_eq</span> <span class=\"bp\">-</span> <span class=\"n\">The</span> <span class=\"n\">following</span> <span class=\"bp\">`</span><span class=\"n\">decidable</span><span class=\"bp\">`</span> <span class=\"n\">hypotheses</span> <span class=\"n\">should</span> <span class=\"n\">be</span> <span class=\"n\">replaced</span> <span class=\"k\">with</span>\n                      <span class=\"bp\">`</span><span class=\"n\">classical</span><span class=\"bp\">`</span> <span class=\"k\">in</span> <span class=\"n\">the</span> <span class=\"n\">proof.</span> <span class=\"n\">argument</span> <span class=\"mi\">3</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"n\">_inst_2</span> <span class=\"o\">:</span> <span class=\"n\">decidable_eq</span> <span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"n\">Error</span><span class=\"o\">:</span> <span class=\"n\">Process</span> <span class=\"n\">completed</span> <span class=\"k\">with</span> <span class=\"n\">exit</span> <span class=\"n\">code</span> <span class=\"mi\">1</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 282066438,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652339387
    },
    {
        "content": "<p><code>decidable_eq R</code> is useful if you need it in the statement (I mean, it's better than <code>open_locale classical</code>).</p>",
        "id": 282066690,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1652339552
    },
    {
        "content": "<p>Yes, and the statement of <code>nat_degree_monomial</code> involves an <code>ite</code>, hence assumes it.  I removed <code>decidable_eq R</code> from my PR, and reverted to the original form of the lemma!</p>",
        "id": 282066900,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1652339705
    }
]