[
    {
        "content": "<p>i got another formalization pull request out. <a href=\"https://github.com/leanprover-community/mathlib/pull/4450\">https://github.com/leanprover-community/mathlib/pull/4450</a><br>\nit's interesting, i feel like i spend more effort on formalizing the parts that are \"trivial\" to a human mathematician, rather than the parts that are \"difficult\" to a human mathematician.</p>",
        "id": 212352661,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601929839
    },
    {
        "content": "<p>Did <a href=\"#narrow/stream/113489-new-members/topic/simplifying.20nat.2Edigits/near/212152395\"><code>norm_digits</code></a> get PR'd? If not it probably should be --- someone other that Mario can make the PR.</p>",
        "id": 212362405,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1601935524
    },
    {
        "content": "<p>i dont feel great about PRing in a big blob of code i dont understand. but i would love for someone else to</p>",
        "id": 212362703,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601935766
    },
    {
        "content": "<p>actually, <span class=\"user-mention\" data-user-id=\"266440\">@Shing Tak Lam</span> commented on the other pull request with a one-liner with <code>rw</code> that does the same thing as <code>digit_recursion</code></p>",
        "id": 212362854,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601935869
    },
    {
        "content": "<p>so... maybe there already <em>is</em> a way to do it in the existing library, it is just a complicated one</p>",
        "id": 212362867,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601935886
    },
    {
        "content": "<blockquote>\n<p>it's interesting, i feel like i spend more effort on formalizing the parts that are \"trivial\" to a human mathematician, rather than the parts that are \"difficult\" to a human mathematician.</p>\n</blockquote>\n<p>Do you have a feeling more tactics would help? (e.g. things like <code>interval_cases</code>)</p>",
        "id": 212363325,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1601936208
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212362854\">said</a>:</p>\n<blockquote>\n<p>actually, <span class=\"user-mention silent\" data-user-id=\"266440\">Shing Tak Lam</span> commented on the other pull request with a one-liner with <code>rw</code> that does the same thing as <code>digit_recursion</code></p>\n</blockquote>\n<p>Yes, but something like <code>digit_recursion</code> should still be in the library imo. I think <code>digits_aux</code> should really be treated as an implementation detail and the users should really only need <code>digits</code>.</p>",
        "id": 212363364,
        "sender_full_name": "Shing Tak Lam",
        "timestamp": 1601936237
    },
    {
        "content": "<p>that makes sense - i ended up not being able to figure out how to use the digits aux stuff, and so i just wrote digits_helper because that was the form i wished the lemmas were in</p>",
        "id": 212363490,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601936312
    },
    {
        "content": "<p>also because i was sick of proving 10 &gt; 2 so many times</p>",
        "id": 212363506,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601936323
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Scott Morrison</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212363325\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>it's interesting, i feel like i spend more effort on formalizing the parts that are \"trivial\" to a human mathematician, rather than the parts that are \"difficult\" to a human mathematician.</p>\n</blockquote>\n<p>Do you have a feeling more tactics would help? (e.g. things like <code>interval_cases</code>)</p>\n</blockquote>\n<p>I wish there were fewer tactics, that worked in more situations. Tactics like <code>linarith</code>, <code>simp</code>, <code>ring</code>, <code>library_search</code>, <code>norm_num</code>, <code>nlinarith</code> are all convenient at times, but when I pick between them I don't feel like I'm doing advanced mathematics, I feel like that process could be automated. Perhaps the core of the library just needs to be 10x faster and more along these lines will be possible.</p>",
        "id": 212446236,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601998809
    },
    {
        "content": "<p>that sounds like you are describing <code>tidy</code></p>",
        "id": 212447140,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1601999247
    },
    {
        "content": "<p>i wasn't even aware of <code>tidy</code>! i guess that goes back to the problem of, there are so many different tactics available, just becoming aware of all relevant tactics and understanding what they do is most of the effort</p>",
        "id": 212448388,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1601999794
    },
    {
        "content": "<p><code>tidy</code> is a kitchen sink tactic written by Scott when he got fed up with exactly what you are describing</p>",
        "id": 212449676,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602000382
    },
    {
        "content": "<p>it will call <code>simp</code> and <code>ring</code> and <code>linarith</code> and all the others</p>",
        "id": 212449742,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602000413
    },
    {
        "content": "<p>It's also somehow just really painful to do things with <em>actual numbers</em> in Lean.  I usually just give up, so I think it's great that you are pushing through to get us some examples of these terrible, painful proofs.  Hopefully specific examples will provide the data needed for new lemmas and more automation!</p>",
        "id": 212452226,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602001544
    },
    {
        "content": "<p>Kevin have you gone through the problem sheets from Lean for the Curious Mathematician? These were specifically designed to show people how to do lots of different kinds of mathematics in Lean. There are accompanying videos which talk you through the sheets.</p>",
        "id": 212452497,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1602001666
    },
    {
        "content": "<p>Here's a problem with <em>actual numbers</em> which I put on a real analysis problem set a few weeks ago.  Easy on paper; most of my students did it without difficulty.  I tried to do it in Lean but abandoned the effort when it became clear how ugly a complete solution would look.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">converges_to</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span> <span class=\"bp\">∀</span> <span class=\"n\">ε</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">∃</span> <span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"bp\">≥</span> <span class=\"n\">M</span><span class=\"o\">,</span> <span class=\"bp\">|</span><span class=\"n\">x</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">a</span><span class=\"bp\">|</span> <span class=\"bp\">&lt;</span> <span class=\"n\">ε</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">converges_to</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"mi\">7</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span>\n</code></pre></div>",
        "id": 212453173,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602002014
    },
    {
        "content": "<p>yeah, similarly that huge thread about why <code>linarith</code> couldn't prove <code>123456 &lt; 1000000</code></p>",
        "id": 212454217,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602002599
    },
    {
        "content": "<p>your <code>converges_to</code> example is interesting... it feels like you'd want a ton of helper lemmas</p>",
        "id": 212454494,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602002753
    },
    {
        "content": "<p>but yeah i'd have to look through 100's of existing lemmas. so far i have only looked at the trivial arithmetic type lemmas, trying to prove things like <code>(39 * c + 24) % 39 = 24</code></p>",
        "id": 212454758,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602002892
    },
    {
        "content": "<p>It depends what you mean by helper lemmas.  I specifically wanted the students to prove it using \"by hand\" epsilon-delta analysis, rather than by invoking theorems about limits of addition, division, etc.  So I wanted a Lean proof that did this, too.</p>",
        "id": 212454793,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602002925
    },
    {
        "content": "<p>i see. but you end up with something like, you have two fractions of polynomials and you want to prove the inequality and it's just super cumbersome</p>",
        "id": 212454848,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602002964
    },
    {
        "content": "<p>Yeah, it was terrible.  Here's where I was when I abandoned ship <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span> </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">local</span> <span class=\"kd\">notation</span> <span class=\"bp\">`|`</span><span class=\"n\">x</span><span class=\"bp\">`|`</span> <span class=\"o\">:=</span> <span class=\"n\">abs</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">converges_to</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"mi\">7</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">hε</span><span class=\"o\">,</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">M</span><span class=\"o\">,</span> <span class=\"n\">hM</span><span class=\"o\">⟩</span> <span class=\"o\">:</span> <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"bp\">↑</span><span class=\"n\">M</span> <span class=\"bp\">&gt;</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">exists_nat_gt</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">use</span> <span class=\"n\">M</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">n</span> <span class=\"n\">hn</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"mi\">1</span> <span class=\"bp\">&lt;</span> <span class=\"bp\">↑</span><span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">M</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">norm_cast</span><span class=\"o\">,</span>\n      <span class=\"n\">assumption</span> <span class=\"o\">},</span>\n    <span class=\"n\">linarith</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_denom</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"bp\">≥</span> <span class=\"mi\">6</span> <span class=\"bp\">*</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"k\">have</span> <span class=\"n\">h_max_right</span> <span class=\"o\">:</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"mi\">1</span> <span class=\"bp\">≥</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">le_max_right</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"c1\">--(1 / (41 * ε)) 1,</span>\n    <span class=\"n\">linarith</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_denom_nonzero</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">linarith</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_7</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">linarith</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">/</span> <span class=\"mi\">7</span> <span class=\"bp\">=</span> <span class=\"mi\">7</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">field_simp</span> <span class=\"o\">[</span><span class=\"n\">h_denom_nonzero</span><span class=\"o\">,</span> <span class=\"n\">h_7</span><span class=\"o\">],</span>\n    <span class=\"n\">ring</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_denom_abs</span> <span class=\"o\">:</span> <span class=\"n\">abs</span> <span class=\"o\">((</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">abs_of_nonneg</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">linarith</span><span class=\"o\">),</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_7_abs</span> <span class=\"o\">:</span> <span class=\"n\">abs</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">7</span> <span class=\"o\">:=</span> <span class=\"n\">abs_of_nonneg</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">linarith</span><span class=\"o\">),</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">abs_mul</span><span class=\"o\">,</span> <span class=\"n\">abs_inv</span><span class=\"o\">,</span> <span class=\"bp\">*</span><span class=\"o\">],</span>\n  <span class=\"k\">suffices</span> <span class=\"o\">:</span> <span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"mi\">7</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"bp\">↑</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">),</span>\n  <span class=\"o\">{</span> <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">7</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">norm_num</span><span class=\"o\">,</span>\n    <span class=\"n\">sorry</span> <span class=\"o\">},</span>\n  <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">h_7</span><span class=\"o\">],</span>\n  <span class=\"k\">have</span> <span class=\"n\">h_max_left</span> <span class=\"o\">:</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"mi\">1</span> <span class=\"bp\">≥</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"o\">:=</span> <span class=\"n\">le_max_left</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"bp\">≤</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">linarith</span><span class=\"o\">,</span>\n  <span class=\"n\">sorry</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 212454896,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602003000
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> <code>tidy</code> doesn't work on <code>(39 * c + 24) % 39 = 24</code> by the way. also, if I solve something using <code>tidy</code>, can I see what lemmas it used?</p>",
        "id": 212454941,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003004
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212454941\">said</a>:</p>\n<blockquote>\n<p>also, if I solve something using <code>tidy</code>, can I see what lemmas it used?</p>\n</blockquote>\n<p><code>tidy?</code></p>",
        "id": 212455109,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602003110
    },
    {
        "content": "<p>see previously in this thread, where mario was saying i should try using <code>tidy</code></p>",
        "id": 212455470,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003279
    },
    {
        "content": "<p>No, I mean actually type <code>tidy?</code> to query <code>tidy</code>!  See <a href=\"https://leanprover-community.github.io/mathlib_docs/find/tactic.tidy\">docs#tactic.tidy</a>.</p>",
        "id": 212455666,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602003386
    },
    {
        "content": "<p>hmm, i can't cut and paste your code, because it doesn't recognize the <code>|</code></p>",
        "id": 212455685,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003400
    },
    {
        "content": "<p>oh, i see. lol</p>",
        "id": 212455702,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003408
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212455685\">said</a>:</p>\n<blockquote>\n<p>hmm, i can't cut and paste your code, because it doesn't recognize the <code>|</code></p>\n</blockquote>\n<p>I'll edit above to include the missing notation def, sorry!</p>",
        "id": 212455760,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602003446
    },
    {
        "content": "<p>is a normal <code>|</code> supposed to be absolute value? or do you have to to <code>\\|</code></p>",
        "id": 212455804,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003476
    },
    {
        "content": "<p>oh just <code>abs</code></p>",
        "id": 212455936,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003525
    },
    {
        "content": "<p>ok</p>",
        "id": 212455940,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003527
    },
    {
        "content": "<p>yeah i tried doing this differently and ran into trouble quickly. intuitively i would just be like, any big number should work, pick some random polynomial in (1/epsilon). but actually you need to map between nats and reals, and you need to handle the somewhat stupid case where epsilon is less than 1.</p>",
        "id": 212456556,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003821
    },
    {
        "content": "<p>Yep, all this.  Also fractions are hard.  Every time the denominator changes slightly you need a certificate that the new denominator is nonzero.</p>",
        "id": 212456694,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602003895
    },
    {
        "content": "<p>something like Mathematica will solve this, right?</p>",
        "id": 212456759,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003937
    },
    {
        "content": "<p>it won't output a certificate, but it is probably only making valid steps, so it would be theoretically possible to do so</p>",
        "id": 212456833,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602003970
    },
    {
        "content": "<p>I think Lean would solve it fairly fast, too, if I allowed myself to use, say, the whole <a href=\"https://leanprover-community.github.io/mathlib_docs/find/asymptotics.is_O\">docs#asymptotics.is_O</a> library.</p>",
        "id": 212456917,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602004026
    },
    {
        "content": "<p>But since the write-out-a-bunch-of-explicit-inequalities proof is human-trivial, I wish it were Lean-trivial too.</p>",
        "id": 212457049,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602004086
    },
    {
        "content": "<p>And I mentioned it here because it reminded me of similar struggles I've seen in a couple of your IMO formalizations.</p>",
        "id": 212457084,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602004113
    },
    {
        "content": "<p>yeah - that seems like a subproblem of the IMO challenge in a sense. if the \"IMO grand challenge\" is for an AI to solve IMO problems, consider a similar \"IMO Trivial Challenge\" where the question is, can the AI automatically solve everything that a human mathematician considers trivial</p>",
        "id": 212457118,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602004133
    },
    {
        "content": "<p>what fraction of formalizing an IMO problem is formalizing part that a human would consider trivial? looking at the formalizations so far it's maybe... 80%?</p>",
        "id": 212457159,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602004161
    },
    {
        "content": "<p>so if an AI strategy ends up being something like a tree search, perhaps 80% of the work trawling through this tree is actually handling the \"trivial\" parts</p>",
        "id": 212457191,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602004184
    },
    {
        "content": "<p>a related question is training data - it's gonna be pretty hard to get enough training data for modern AI solutions for IMO problems, but it seems much more possible to generate a supply of trivial math problems, that are not currently trivially solvable for some Lean tactic...</p>",
        "id": 212457395,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602004294
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> Well I won't pretend it was easy, but I managed to prove your theorem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">converges_to</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"mi\">7</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">intros</span> <span class=\"n\">ε</span> <span class=\"n\">hε</span><span class=\"o\">,</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">M</span><span class=\"o\">,</span> <span class=\"n\">hM</span><span class=\"o\">⟩</span> <span class=\"o\">:</span> <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"bp\">↑</span><span class=\"n\">M</span> <span class=\"bp\">&gt;</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"o\">(</span><span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">ε</span><span class=\"o\">))</span> <span class=\"mi\">1</span> <span class=\"o\">:=</span> <span class=\"n\">exists_nat_gt</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">use</span> <span class=\"n\">M</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">n</span> <span class=\"n\">hn</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"n\">hmn</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">M</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"o\">{</span> <span class=\"n\">norm_cast</span><span class=\"o\">,</span> <span class=\"n\">assumption</span> <span class=\"o\">},</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">hn1</span><span class=\"o\">,</span> <span class=\"n\">hn2</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">max_lt_iff.1</span> <span class=\"o\">(</span><span class=\"n\">lt_of_lt_of_le</span> <span class=\"n\">hM</span> <span class=\"n\">hmn</span><span class=\"o\">),</span>\n  <span class=\"n\">replace</span> <span class=\"n\">hn1</span> <span class=\"o\">:</span> <span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"n\">ε</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">41</span> <span class=\"bp\">*</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">div_lt_iff'</span> <span class=\"n\">hε</span><span class=\"o\">],</span>\n    <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">div_lt_iff'</span> <span class=\"o\">(</span><span class=\"n\">mul_pos</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">41</span><span class=\"o\">)</span> <span class=\"n\">hε</span><span class=\"o\">)]</span> <span class=\"n\">at</span> <span class=\"n\">hn1</span><span class=\"o\">,</span>\n    <span class=\"n\">simpa</span> <span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"o\">,</span> <span class=\"n\">mul_assoc</span><span class=\"o\">]</span> <span class=\"n\">using</span> <span class=\"n\">hn1</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">),</span> <span class=\"o\">{</span> <span class=\"n\">linarith</span> <span class=\"o\">},</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">div_sub_div</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">ne_of_gt</span> <span class=\"n\">this</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">7</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span><span class=\"o\">)],</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">mul_pos</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num</span><span class=\"o\">)</span> <span class=\"n\">this</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">mul_comm</span><span class=\"o\">,</span> <span class=\"n\">sub_sub_cancel</span><span class=\"o\">],</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">abs_of_pos</span> <span class=\"o\">(</span><span class=\"n\">inv_pos.2</span> <span class=\"n\">this</span><span class=\"o\">),</span> <span class=\"bp\">←</span> <span class=\"n\">one_div</span><span class=\"o\">,</span> <span class=\"n\">div_lt_iff</span> <span class=\"n\">this</span><span class=\"o\">,</span> <span class=\"bp\">←</span> <span class=\"n\">div_lt_iff'</span> <span class=\"n\">hε</span><span class=\"o\">],</span>\n  <span class=\"n\">refine</span> <span class=\"n\">lt_of_lt_of_le</span> <span class=\"n\">hn1</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">linarith</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 212460663,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006011
    },
    {
        "content": "<p>Congratulations!</p>",
        "id": 212460724,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602006056
    },
    {
        "content": "<p>I think the \"right way\" to prove this though is a way to reason about asymptotics</p>",
        "id": 212460728,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006059
    },
    {
        "content": "<p>rather than doing silly epsilon delta stuff</p>",
        "id": 212460754,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006073
    },
    {
        "content": "<p>Well, yes.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212456917\">said</a>:</p>\n<blockquote>\n<p>I think Lean would solve it fairly fast, too, if I allowed myself to use, say, the whole <a href=\"https://leanprover-community.github.io/mathlib_docs/find/asymptotics.is_O\">docs#asymptotics.is_O</a> library.</p>\n</blockquote>",
        "id": 212460794,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602006098
    },
    {
        "content": "<p>But it would be nice if both ways are possible.  Sometimes one needs to reason about inequalities among rational functions, without there being any asymptotics involved.</p>",
        "id": 212460905,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602006150
    },
    {
        "content": "<p>Your point about pain around nonzero divisors is well taken. The <code>field_simps</code> tactic helps a lot with this general problem but it's still not easy</p>",
        "id": 212461086,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006258
    },
    {
        "content": "<p>The proof I gave above is I think a lot more \"manual\" than the one you did, with more explicit rewrite chains</p>",
        "id": 212461173,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006314
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212460905\">said</a>:</p>\n<blockquote>\n<p>But it would be nice if both ways are possible.  Sometimes one needs to reason about inequalities among rational functions, without there being any asymptotics involved.</p>\n</blockquote>\n<p>Here's a landmark paper from my own field that happens to require this kind of reasoning<br>\n<a href=\"https://arxiv.org/abs/0705.0710\">https://arxiv.org/abs/0705.0710</a><br>\n(as one tiny human-trivial section in an article otherwise filled with difficult things)</p>",
        "id": 212461177,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602006317
    },
    {
        "content": "<p>a lot of the nonzero stuff might be easier if the ability to prove trivial statements was a little better. e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">tidy</span>\n</code></pre></div>\n\n<p>that doesn't work but I can imagine a world where it works.</p>",
        "id": 212461452,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006452
    },
    {
        "content": "<p>Heh, it amuses me to think that the hard part in the definition of the calabi functional on page 5 is the division</p>",
        "id": 212461467,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006458
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238605\">@Kevin Lacker</span> that statement is false</p>",
        "id": 212461581,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006497
    },
    {
        "content": "<p>really? it is not working for me right now</p>",
        "id": 212461617,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006512
    },
    {
        "content": "<p>which is one of many reasons why this is hard</p>",
        "id": 212461623,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006514
    },
    {
        "content": "<p>no, your theorem is false</p>",
        "id": 212461639,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006528
    },
    {
        "content": "<p>oh, because 0 - 1 is 0 in lean world</p>",
        "id": 212461656,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006538
    },
    {
        "content": "<p>ha</p>",
        "id": 212461660,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006539
    },
    {
        "content": "<p><code>example (n : ℕ) (h : n &gt; 0) : 7 * n - 1 ≠ 0 := by tidy</code> then</p>",
        "id": 212461693,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006559
    },
    {
        "content": "<p><code>linarith</code> should be able to get that</p>",
        "id": 212461715,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006571
    },
    {
        "content": "<p>maybe not because you are still using nat subtraction</p>",
        "id": 212461735,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006585
    },
    {
        "content": "<p>it does not</p>",
        "id": 212461739,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006586
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">7</span> <span class=\"bp\">*</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span> <span class=\"o\">:</span> <span class=\"n\">ℤ</span><span class=\"o\">)</span> <span class=\"bp\">≠</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">linarith</span>\n</code></pre></div>\n\n<p>works</p>",
        "id": 212461849,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006634
    },
    {
        "content": "<p>re: the hard part of the calabi function being division, it's like playing chess. the computer can easily play chess way better than any human, even those who studied for years. but to actually pick up a chess piece and put it down on a different square, that's hard, basically cutting edge robotics, although a 5-year-old has no trouble.</p>",
        "id": 212461934,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006685
    },
    {
        "content": "<p>I guess this version is true even without the hypothesis but that becomes more of a divisibility proof than a linear arithmetic</p>",
        "id": 212461979,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006713
    },
    {
        "content": "<p>It's definitely true that formalization takes the easy things and the hard things and completely turns them on their head</p>",
        "id": 212462079,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006755
    },
    {
        "content": "<p>here's another thing that would be nice to be trivial: <code>example (n : ℕ) : n * n ≠ 3 := by tidy</code></p>",
        "id": 212462113,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602006774
    },
    {
        "content": "<p>that could conceivably be <code>dec_trivial</code></p>",
        "id": 212462161,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006798
    },
    {
        "content": "<p>but you need a decision procedure tailored for squares</p>",
        "id": 212462201,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006819
    },
    {
        "content": "<p>the hard part is selecting the right tool for the job</p>",
        "id": 212462268,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602006843
    },
    {
        "content": "<p>i thought this might be easier but it still doesn't tidy: <code>example (n : ℕ) : (n * n) % 4 ≠ 3 := by tidy</code> i mean i have no idea what tidy is doing under the hood, so i dont blame it per se. that just makes it clearer to a human that you can do it by cases</p>",
        "id": 212462633,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602007034
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212454941\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <code>tidy</code> doesn't work on <code>(39 * c + 24) % 39 = 24</code> by the way. also, if I solve something using <code>tidy</code>, can I see what lemmas it used?</p>\n</blockquote>\n<p>The proof of <code>(39 * c + 24) % 39 = 24</code> should be two steps: apply the theorem <code>a &lt; b -&gt; (b * c + a) % b = a</code>, and then <code>norm_num</code></p>",
        "id": 212462671,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007059
    },
    {
        "content": "<p>I should remark that I'm not the <code>tidy</code> maintainer, and I would never want to be because any tactic that puts itself in a \"solve every goal\" situation is setting its users up for disappointment</p>",
        "id": 212462867,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007137
    },
    {
        "content": "<p><code>tidy</code> literally does what I said: it applies <code>simp</code> and <code>linarith</code> and all the other tools in the box</p>",
        "id": 212463107,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007220
    },
    {
        "content": "<p>right, i just don't know what all the tools in the box are</p>",
        "id": 212463143,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602007237
    },
    {
        "content": "<p>well, now you know that none of them solves this without advice</p>",
        "id": 212463217,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007276
    },
    {
        "content": "<p>There are some fancy tactics but most are fairly predictable, and none do magic</p>",
        "id": 212463387,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007350
    },
    {
        "content": "<p>Case bashing is a thing you can do but it's not done automatically because it's expensive</p>",
        "id": 212463446,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007388
    },
    {
        "content": "<p>for example, you could phrase your square theorem as something about <code>(n : zmod 4) * n != 3</code> which I think you can prove by <code>dec_trivial</code></p>",
        "id": 212463526,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602007433
    },
    {
        "content": "<p>Mario, while we're on this subject, can you cast an eye over Kevin's PR <a href=\"https://github.com/leanprover-community/mathlib/issues/4366\">#4366</a> to check whether the case-bashing is done with maximal efficiency?</p>",
        "id": 212463712,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1602007517
    },
    {
        "content": "<p>Hm, well if you ask me (and you did), I think it would be better to state the search thusly:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">search_upto</span> <span class=\"o\">(</span><span class=\"n\">c</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">c</span> <span class=\"bp\">*</span> <span class=\"mi\">11</span> <span class=\"bp\">∧</span> <span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">m</span> <span class=\"bp\">&lt;</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">problem_predicate</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">solution_predicate</span> <span class=\"n\">m</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">search_upto_start</span> <span class=\"o\">:</span> <span class=\"n\">search_upto</span> <span class=\"mi\">9</span> <span class=\"mi\">99</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">rfl</span><span class=\"o\">,</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span> <span class=\"n\">h</span> <span class=\"n\">p</span><span class=\"o\">,</span> <span class=\"kd\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span><span class=\"n\">ge_100</span> <span class=\"n\">p</span><span class=\"o\">]⟩</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">search_upto_step</span> <span class=\"o\">{</span><span class=\"n\">c</span> <span class=\"n\">n</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">search_upto</span> <span class=\"n\">c</span> <span class=\"n\">n</span><span class=\"o\">)</span>\n  <span class=\"o\">{</span><span class=\"n\">c'</span> <span class=\"n\">n'</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">ec</span> <span class=\"o\">:</span> <span class=\"n\">c</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">=</span> <span class=\"n\">c'</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">en</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">11</span> <span class=\"bp\">=</span> <span class=\"n\">n'</span><span class=\"o\">)</span>\n  <span class=\"o\">{</span><span class=\"n\">l</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">el</span> <span class=\"o\">:</span> <span class=\"n\">nat.digits</span> <span class=\"mi\">10</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">l</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H'</span> <span class=\"o\">:</span> <span class=\"n\">c</span> <span class=\"bp\">=</span> <span class=\"n\">sum_of_squares</span> <span class=\"n\">l</span> <span class=\"bp\">→</span> <span class=\"n\">c</span> <span class=\"bp\">=</span> <span class=\"mi\">50</span> <span class=\"bp\">∨</span> <span class=\"n\">c</span> <span class=\"bp\">=</span> <span class=\"mi\">73</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">search_upto</span> <span class=\"n\">c'</span> <span class=\"n\">n'</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">subst</span> <span class=\"n\">ec</span><span class=\"o\">,</span> <span class=\"n\">subst</span> <span class=\"n\">en</span><span class=\"o\">,</span> <span class=\"n\">subst</span> <span class=\"n\">el</span><span class=\"o\">,</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">rfl</span><span class=\"o\">,</span> <span class=\"n\">H</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">H</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"o\">⟨</span><span class=\"kd\">by</span> <span class=\"n\">ring</span><span class=\"o\">,</span> <span class=\"bp\">λ</span> <span class=\"n\">m</span> <span class=\"n\">l</span> <span class=\"n\">p</span><span class=\"o\">,</span> <span class=\"n\">_</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">h₁</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"n\">m</span><span class=\"o\">,</span> <span class=\"n\">rfl</span><span class=\"o\">⟩,</span> <span class=\"n\">h₂</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">id</span> <span class=\"n\">p</span><span class=\"o\">,</span>\n  <span class=\"n\">by_cases</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"mi\">11</span> <span class=\"bp\">*</span> <span class=\"n\">m</span> <span class=\"bp\">&lt;</span> <span class=\"n\">c</span> <span class=\"bp\">*</span> <span class=\"mi\">11</span><span class=\"o\">,</span> <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">H</span> <span class=\"n\">_</span> <span class=\"n\">h</span> <span class=\"n\">p</span> <span class=\"o\">},</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"n\">m</span> <span class=\"bp\">=</span> <span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"o\">{</span><span class=\"n\">linarith</span><span class=\"o\">},</span> <span class=\"n\">subst</span> <span class=\"n\">m</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">nat.mul_div_cancel_left</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num</span> <span class=\"o\">:</span> <span class=\"mi\">11</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">),</span> <span class=\"n\">mul_comm</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">h₂</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"o\">(</span><span class=\"n\">H'</span> <span class=\"n\">h₂</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">imp</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"bp\">;</span> <span class=\"o\">{</span><span class=\"n\">rintro</span> <span class=\"n\">rfl</span><span class=\"o\">,</span> <span class=\"n\">norm_num</span><span class=\"o\">}</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">search_upto_end</span> <span class=\"o\">{</span><span class=\"n\">c</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">search_upto</span> <span class=\"n\">c</span> <span class=\"mi\">1001</span><span class=\"o\">)</span>\n  <span class=\"o\">{</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">ppn</span> <span class=\"o\">:</span> <span class=\"n\">problem_predicate</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">solution_predicate</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"n\">H.2</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">linarith</span> <span class=\"o\">[</span><span class=\"n\">lt_1000</span> <span class=\"n\">ppn</span><span class=\"o\">])</span> <span class=\"n\">ppn</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"></span>\n<span class=\"cm\">Now we just need to combine the results from the `search` lemmas.</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">right_direction</span> <span class=\"o\">{</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">problem_predicate</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">solution_predicate</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"n\">search_upto_start</span><span class=\"o\">,</span>\n  <span class=\"n\">iterate</span> <span class=\"mi\">82</span> <span class=\"o\">{</span>\n    <span class=\"n\">replace</span> <span class=\"o\">:=</span> <span class=\"n\">search_upto_step</span> <span class=\"n\">this</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num1</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_num1</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">)</span>\n      <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">norm_digits</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">)</span> <span class=\"n\">dec_trivial</span> <span class=\"o\">},</span>\n  <span class=\"n\">exact</span> <span class=\"n\">search_upto_end</span> <span class=\"n\">this</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n\n<p>I can add this to the PR but it depends on the <code>norm_digits</code> tactic in the other PR</p>",
        "id": 212470289,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602010803
    },
    {
        "content": "<p>I dream of the day when we can prove the CFSG like this</p>",
        "id": 212470383,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602010848
    },
    {
        "content": "<p>Actually, contrary to what has been said above, <code>tidy</code> doesn't try <code>linarith</code> at all.</p>",
        "id": 212491013,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021328
    },
    {
        "content": "<p><code>tidy</code> mostly uses <code>split</code>, <code>ext</code>, <code>intros</code>, <code>dsimp</code>, <code>simp</code>, <code>assumption</code>, <code>solve_by_elim</code>.</p>",
        "id": 212491120,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021374
    },
    {
        "content": "<p>That is, it is mostly a \"take things apart, simplify, try to put things back together\" tactic.</p>",
        "id": 212491151,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021398
    },
    {
        "content": "<p>(oh, and <code>auto_cases</code>, which tries to uses <code>cases</code> without doing case splits)</p>",
        "id": 212491205,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021445
    },
    {
        "content": "<p>This actual list is at <a href=\"https://github.com/leanprover-community/mathlib/blob/master/src/tactic/tidy.lean#L41\">https://github.com/leanprover-community/mathlib/blob/master/src/tactic/tidy.lean#L41</a></p>",
        "id": 212491212,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021455
    },
    {
        "content": "<p>A different tactic which is more of a \"kitchen sink\" is <code>hint</code>, which just tries a bunch of tactics and reports which ones make progress.</p>",
        "id": 212491237,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021480
    },
    {
        "content": "<p>Unfortunately the best way to see which tactics <code>hint</code> will try out is to grep for <code>add_hint_tactic</code> in the sources, as it is hooked up nonlocally.</p>",
        "id": 212491371,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021558
    },
    {
        "content": "<p>Fortunately, on the other hand, it's therefore easy to add new tactics to its repertoire.</p>",
        "id": 212491404,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1602021582
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212457191\">said</a>:</p>\n<blockquote>\n<p>so if an AI strategy ends up being something like a tree search, perhaps 80% of the work trawling through this tree is actually handling the \"trivial\" parts</p>\n</blockquote>\n<p>I think a lot of the new AI systems for ITP (TacticToe, DeepHOL, ProverBot9001, Tactician, GPT-f, etc.) are getting better at filling in these routine steps, but I agree that better evaluation and/or datasets would help.  For example, GPT-f was improved by adding in some routine calculations into the train set. Also we need to understand what types of problems these systems excel at and where the gaps are.</p>\n<p>I'm not necessarily saying that GPT-f style systems are the way to go with the IMO grand challenge, and I don't want to derail the work on careful formalization and dissection of IMO problems to say just throw a 100-billion parameter black box at anything.  But at the same time, systems like Tactician have should a lot of promise without a lot of computational cost, so they could become one tool of many in the tool belt.)</p>",
        "id": 212495006,
        "sender_full_name": "Jason Rute",
        "timestamp": 1602024077
    },
    {
        "content": "<p>yeah, I thought GPT-f in particular was just a little too simple to be useful yet - it seems like the problems it is capable of solving are still a smaller set than some of the more complicated tactics, like <code>ring</code></p>",
        "id": 212495856,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602024732
    },
    {
        "content": "<p>i feel like the architecture is not ideal - the GPT structure isn't really doing a tree search type thing. but i'm not sure</p>",
        "id": 212495897,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602024789
    },
    {
        "content": "<p>the largest model is still not solving most of the 9-digit division problems</p>",
        "id": 212495990,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602024870
    },
    {
        "content": "<p>so, is it going to be able to be extended to be something that's like, one step beyond <code>norm_num</code> or <code>nlinarith</code>, that could reduce <code>n * n = 3</code> to <code>false</code>? it seems like more parameters won't get there with the GPT-f architecture</p>",
        "id": 212496104,
        "sender_full_name": "Kevin Lacker",
        "timestamp": 1602024984
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212496104\">said</a>:</p>\n<blockquote>\n<p>so, is it going to be able to be extended to be something that's like, one step beyond <code>norm_num</code> or <code>nlinarith</code>, that could reduce <code>n * n = 3</code> to <code>false</code>? it seems like more parameters won't get there with the GPT-f architecture</p>\n</blockquote>\n<p>GPT-f (along with the other systems I've mentioned) definitely does tree search.</p>",
        "id": 212499104,
        "sender_full_name": "Jason Rute",
        "timestamp": 1602027400
    },
    {
        "content": "<p>Also, GPT-f is unique in that it is for MetaMath which doesn't have tactics, but that has nothing to do with the design of GPT-f.  For example, DeepHOL or Tactician both guide tactics, including tactics like <code>ring</code> and <code>nlinarith</code> when it makes sense.  The problem is that if you add a new tactic, they need to be retrained.  They don't currently have the full power of hierarchical reinforcement learning or program synthesis where one can build up high-level actions from low-level actions.</p>",
        "id": 212499368,
        "sender_full_name": "Jason Rute",
        "timestamp": 1602027668
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"238605\">Kevin Lacker</span> <a href=\"#narrow/stream/208328-IMO-grand-challenge/topic/1962.20problem.201/near/212457159\">said</a>:</p>\n<blockquote>\n<p>what fraction of formalizing an IMO problem is formalizing part that a human would consider trivial? looking at the formalizations so far it's maybe... 80%?</p>\n</blockquote>\n<p>About 95% of formalizing one (easier-than-IMO) geometry problem was teaching mathlib enough geometry for that one problem, but quite likely 80% of what went in mathlib there was also human-trivial, so that doesn't contradict your point. My formalization of the combinatorics problem from the same paper ended up taking 3000 lines of Lean, almost all concerned with trivialities.</p>",
        "id": 212506293,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1602034513
    },
    {
        "content": "<p>Yeah, I think there are two distinct categories of trivial there that should be teased apart. There is (1) library building, and then (2) rote application of theorems to the problem context (and then (3) actual interesting mathematics). It is fairly common for (1) to make up the majority of any given formalization project, with numbers ranging from 60% to 90% for a new area. For a well established area it might get as low as 10% but I don't think I've ever seen a formalization project actually be completely served by whatever library existed at the outset</p>",
        "id": 212506584,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602034824
    },
    {
        "content": "<p>everyone builds a <code>for_mathlib</code> file</p>",
        "id": 212506604,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602034857
    },
    {
        "content": "<p>But once you have actually finished the proof, you can refactor it to improve the backing library and take that down to 0%, and then you can see the proof as it would be if the library was already prepared for it. This is when the question of how much triviality becomes more interesting</p>",
        "id": 212506682,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1602034963
    },
    {
        "content": "<p>I've yet to formalize an olympiad problem without finding <em>something</em> to add to mathlib proper, and elementary algebra and number theory are areas that are pretty well-covered in mathlib. (Having formalized an olympiad paper with one problem in each area, I might well now prefer problems that show up gaps in mathlib over those that more routinely use mainly existing lemmas. But both kinds are useful when hoping to learn where we could do with better automation, or to provide training material for AIs.)</p>",
        "id": 212506984,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1602035308
    }
]