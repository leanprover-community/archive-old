[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/Defining.20a.20table.20type/near/262670589\">said</a>:</p>\n<blockquote>\n<p>Probably not, but you are welcome to try</p>\n</blockquote>\n<p>I'm trying to translate logical clause expressed in First Order Logic into Z3 (Python version). For example, the logical clause may look like this:<br>\n<code>exists l.(language(l) &amp; exists n.(name(n) &amp; :op1(n,\"English\") &amp; :name(l,n)))</code><br>\nwhich corresponds to the expression in natural language \"language is English\". <br>\nThe idea is to be able to translate it into some form of axiom which can be understood by an Automated Theorem Prover such as Z3. And then reuse it for further inference. For example, I can extract knowledge from the axioms if I construct the right query (code in Z3) for it... </p>\n<p>I was initially thinking about using Lean for this, but it looks more like an \"interactive theorem prover\" (which required human in the middle) rather than \"automated theorem prover\" which can automate logical proofs.</p>\n<p>So the ultimate goal is to create a system capable of accumulating formal knowledge and perform some sort of reasoning with it.</p>",
        "id": 262674936,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637826643
    },
    {
        "content": "<p>Are you the person who asked <a href=\"https://stackoverflow.com/questions/70090927/how-can-i-convert-logical-clause-to-lean\">https://stackoverflow.com/questions/70090927/how-can-i-convert-logical-clause-to-lean</a>? What's going on with this clause?</p>",
        "id": 262675097,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1637826783
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Scott Morrison</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/262675097\">said</a>:</p>\n<blockquote>\n<p>Are you the person who asked <a href=\"https://stackoverflow.com/questions/70090927/how-can-i-convert-logical-clause-to-lean\">https://stackoverflow.com/questions/70090927/how-can-i-convert-logical-clause-to-lean</a>? What's going on with this clause?</p>\n</blockquote>\n<p>yes, I asked that question in StackOverflow as well. The guy who answered it then recommended looking towards Z3 (and recommended asking on this forum as well) So here I am :)</p>",
        "id": 262675188,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637826885
    },
    {
        "content": "<p>could you help <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a> this problem for us? What are you actually trying to do that resulted in investigating how to render that clause in Z3 / lean?</p>",
        "id": 262675303,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637826988
    },
    {
        "content": "<blockquote>\n<p>So the ultimate goal is to create a system capable of accumulating formal knowledge and perform some sort of reasoning with it.</p>\n</blockquote>\n<p>What sort of knowledge, and what sort of reasoning? Could you show a not-entirely-trivial example where the automation is value added?</p>",
        "id": 262675464,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637827150
    },
    {
        "content": "<p>I struggle to think of any interesting questions to ask about the clause \"language is english\" that doesn't already restate the answer in the question</p>",
        "id": 262675493,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637827195
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/262675464\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>So the ultimate goal is to create a system capable of accumulating formal knowledge and perform some sort of reasoning with it.</p>\n</blockquote>\n<p>What sort of knowledge, and what sort of reasoning? Could you show a not-entirely-trivial example where the automation is value added?</p>\n</blockquote>\n<p>We can start with answering \"surface questions\" like \"&lt;unknown&gt; is English\" or \"language is &lt;unknown&gt;\" which can find answers from the context of the existing axioms. Then we can try to answer the Yes/No questions like \"Is English a language?\". Then we can possibly extend it to other types of reasoning, involving many axioms at the same time.</p>",
        "id": 262676280,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637827815
    },
    {
        "content": "<p>The idea is to be able to create a knowledge base which would not only store knowledge but also have a means to reason with it. I tried using Knowledge Graphs for it. But KGs usually don’t have built-in mechanisms for inference. I can retrieve data using SPARLQ queries, for example. But then the problem is how translate natural language question into SPARQL formal query… you have to use some heuristics or machine learning methods to find the correct answer space (best matching sub-graph) and infer the answer from it. But even that approach may not be able to answer questions which require reasoning and logical inference. They can mainly answer the so called “surface questions” where the answers are readily available in the context.  So I looked at automated theorem provers. They look like a perfect solution for that task. They store knowledge as “axioms”. They can build further knowledge based on the existing axioms or add new ones. And, unlike KG heuristic search with \"fuzzy\" results, their answers can be mathematically (logically) sound. So it looks like the way to go…</p>",
        "id": 262676499,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637828025
    },
    {
        "content": "<p>In that case, I think the single clause <code>is(language, english)</code> would do fine for encoding this in an ATP. You might also consider Prolog for answering those forward/backward questions like <code>&lt;unknown&gt; is English</code></p>",
        "id": 262676852,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637828300
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/262676852\">said</a>:</p>\n<blockquote>\n<p>In that case, I think the single clause <code>is(language, english)</code> would do fine for encoding this in an ATP. You might also consider Prolog for answering those forward/backward questions like <code>&lt;unknown&gt; is English</code></p>\n</blockquote>\n<p>can you help me translate the whole thing into Z3 ? I mean the axiom itself and the possible query.</p>",
        "id": 262677399,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637828735
    },
    {
        "content": "<p>It depends on the interface you are working with, but maybe <a href=\"https://colab.research.google.com/github/philzook58/z3_tutorial/blob/master/Z3%20Tutorial.ipynb\">https://colab.research.google.com/github/philzook58/z3_tutorial/blob/master/Z3%20Tutorial.ipynb</a> will help?</p>",
        "id": 262677621,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637828888
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/262677621\">said</a>:</p>\n<blockquote>\n<p>It depends on the interface you are working with, but maybe <a href=\"https://colab.research.google.com/github/philzook58/z3_tutorial/blob/master/Z3%20Tutorial.ipynb\">https://colab.research.google.com/github/philzook58/z3_tutorial/blob/master/Z3%20Tutorial.ipynb</a> will help?</p>\n</blockquote>\n<p>Thanks, I read it through already. But I'm stuck with translation of the axiom. In standard Z3 syntaxis it would look like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">declare</span><span class=\"bp\">-</span><span class=\"n\">const</span> <span class=\"n\">name</span> <span class=\"o\">(</span><span class=\"n\">String</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">declare</span><span class=\"bp\">-</span><span class=\"n\">const</span> <span class=\"n\">language</span> <span class=\"o\">(</span><span class=\"n\">String</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">assert</span> <span class=\"o\">(</span><span class=\"n\">exists</span> <span class=\"o\">((</span><span class=\"n\">l</span> <span class=\"n\">language</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">and</span> <span class=\"o\">(</span><span class=\"n\">language</span> <span class=\"n\">l</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">exists</span> <span class=\"o\">((</span><span class=\"n\">n</span> <span class=\"n\">name</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">and</span> <span class=\"o\">(</span><span class=\"n\">name</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">(:</span><span class=\"n\">op1</span> <span class=\"n\">n</span> <span class=\"s2\">\"English\"</span><span class=\"o\">)</span> <span class=\"o\">(:</span><span class=\"n\">name</span> <span class=\"n\">l</span> <span class=\"n\">n</span><span class=\"o\">))))))</span>\n</code></pre></div>\n<p>But in Python implementation I try this code, for example:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span> <span class=\"nn\">z3</span> <span class=\"kn\">import</span> <span class=\"o\">*</span>\n\n<span class=\"n\">Object</span> <span class=\"o\">=</span> <span class=\"n\">DeclareSort</span><span class=\"p\">(</span><span class=\"s1\">'Object'</span><span class=\"p\">)</span>\n<span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'name'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">language</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'language'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">op1</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'op1'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">l</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'l'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'n'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">Solver</span><span class=\"p\">()</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">ForAll</span><span class=\"p\">(</span><span class=\"n\">l</span><span class=\"p\">,</span> <span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">language</span><span class=\"p\">(</span><span class=\"n\">l</span><span class=\"p\">),</span> <span class=\"n\">Exists</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">),</span> <span class=\"n\">op1</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">,</span> <span class=\"s2\">\"English\"</span><span class=\"p\">),</span> <span class=\"n\">name</span><span class=\"p\">(</span><span class=\"n\">l</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"p\">))))))</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">())</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">())</span>\n</code></pre></div>\n<p>but it gives an error</p>",
        "id": 262678495,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1637829483
    },
    {
        "content": "<ol>\n<li>You used <code>ForAll</code> instead of <code>Exists</code>, that looks suspicious</li>\n<li>I don't think you need that axiom / it doesn't say what you want. I don't use python/z3 so I'm projecting syntax but I guess it would be something like:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">Object</span> <span class=\"o\">=</span> <span class=\"n\">DeclareSort</span><span class=\"p\">(</span><span class=\"s1\">'Object'</span><span class=\"p\">)</span>\n<span class=\"n\">language</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'language'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">english</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'English'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">Solver</span><span class=\"p\">()</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">language</span><span class=\"p\">(</span><span class=\"n\">english</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">())</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">())</span>\n</code></pre></div>",
        "id": 262678934,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1637829779
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/262678934\">said</a>:</p>\n<blockquote>\n<ol>\n<li>You used <code>ForAll</code> instead of <code>Exists</code>, that looks suspicious</li>\n<li>I don't think you need that axiom / it doesn't say what you want. I don't use python/z3 so I'm projecting syntax but I guess it would be something like:</li>\n</ol>\n<p><div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">Object</span> <span class=\"o\">=</span> <span class=\"n\">DeclareSort</span><span class=\"p\">(</span><span class=\"s1\">'Object'</span><span class=\"p\">)</span>\n<span class=\"n\">language</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'language'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">english</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'English'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">Solver</span><span class=\"p\">()</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">language</span><span class=\"p\">(</span><span class=\"n\">english</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">())</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">())</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I played more with Z3, and it looks like I can make it answer boolean questions. See example code below:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span> <span class=\"nn\">z3</span> <span class=\"kn\">import</span> <span class=\"o\">*</span>\n\n<span class=\"n\">Object</span> <span class=\"o\">=</span> <span class=\"n\">DeclareSort</span><span class=\"p\">(</span><span class=\"s1\">'Object'</span><span class=\"p\">)</span>\n<span class=\"n\">Languages</span> <span class=\"o\">=</span> <span class=\"n\">DeclareSort</span><span class=\"p\">(</span><span class=\"s1\">'Languages'</span><span class=\"p\">)</span>\n\n<span class=\"n\">Human</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Human'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Mortal</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Mortal'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">socrates</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'socrates'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">pavel</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'pavel'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">Something</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Something'</span><span class=\"p\">,</span>  <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">Whiskers</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Whiskers'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Tail</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Tail'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Cat</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Cat'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">Language</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Language'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">english</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'English'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">)</span>\n<span class=\"n\">french</span><span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'French'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">)</span>\n<span class=\"n\">Name</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Name'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"c1\"># free variables used in forall must be declared Const in python</span>\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'x'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'y'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">)</span>\n\n<span class=\"n\">axioms</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">Whiskers</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Tail</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Not</span><span class=\"p\">(</span><span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">y</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Language</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">),</span> <span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">))))</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">Solver</span><span class=\"p\">()</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">axioms</span><span class=\"p\">)</span>\n\n<span class=\"n\">assumptions</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">socrates</span><span class=\"p\">),</span>\n    <span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">pavel</span><span class=\"p\">),</span>\n    <span class=\"c1\">#Cat(pavel) # &lt;- this assumption makes model unsat because cat(x) is not human(x)</span>\n    <span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">english</span><span class=\"p\">),</span>\n    <span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">french</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"k\">if</span> <span class=\"n\">unsat</span> <span class=\"o\">==</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">(</span><span class=\"n\">assumptions</span><span class=\"p\">):</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">'UNSAT: </span><span class=\"si\">{</span><span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">unsat_core</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s1\">'SAT:</span><span class=\"se\">\\n</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n    <span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n    <span class=\"c1\">#print(m)</span>\n    <span class=\"c1\">#print(m.eval(Cat(english))) &lt;- error \"sort mismatch\"</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">eval</span><span class=\"p\">(</span><span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">socrates</span><span class=\"p\">)))</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">eval</span><span class=\"p\">(</span><span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">socrates</span><span class=\"p\">),</span><span class=\"n\">Tail</span><span class=\"p\">(</span><span class=\"n\">socrates</span><span class=\"p\">))))</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">eval</span><span class=\"p\">(</span><span class=\"n\">Tail</span><span class=\"p\">(</span><span class=\"n\">socrates</span><span class=\"p\">)))</span>\n    <span class=\"c1\">#print(m.eval(Tail(french))) &lt;- error \"sort mismatch\"</span>\n</code></pre></div>\n<p>The above code has several axioms and assumptions. Then it generates a model which can be evaluated. So far so good. But how can I make it answer \"Wh-questions\"?  For example, \"what languages do you know?\" or \"how many languages is there?\"</p>",
        "id": 263100794,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638246569
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459811\">@Pavel Kulko</span> I think you need some actual data types for this to work, since <code>socrates</code>, <code>pavel</code>, <code>english</code>, and <code>french</code> are actually variables (it's just called a <code>Const</code>).  To enumerate answers, you can do <code>s.check</code> in a loop, and each time you add in an additional assumption that the variable doesn't equal the value you just got.  Here's answering all the mortals in the model:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span> <span class=\"nn\">z3</span> <span class=\"kn\">import</span> <span class=\"o\">*</span>\n\n<span class=\"n\">Object_</span> <span class=\"o\">=</span> <span class=\"n\">Datatype</span><span class=\"p\">(</span><span class=\"s1\">'Object'</span><span class=\"p\">)</span>\n<span class=\"n\">Object_</span><span class=\"o\">.</span><span class=\"n\">declare</span><span class=\"p\">(</span><span class=\"s2\">\"socrates\"</span><span class=\"p\">)</span>\n<span class=\"n\">Object_</span><span class=\"o\">.</span><span class=\"n\">declare</span><span class=\"p\">(</span><span class=\"s2\">\"pavel\"</span><span class=\"p\">)</span>\n<span class=\"n\">Object</span> <span class=\"o\">=</span> <span class=\"n\">Object_</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">()</span>\n\n<span class=\"n\">Languages_</span> <span class=\"o\">=</span> <span class=\"n\">Datatype</span><span class=\"p\">(</span><span class=\"s1\">'Languages'</span><span class=\"p\">)</span>\n<span class=\"n\">Languages_</span><span class=\"o\">.</span><span class=\"n\">declare</span><span class=\"p\">(</span><span class=\"s2\">\"English\"</span><span class=\"p\">)</span>\n<span class=\"n\">Languages_</span><span class=\"o\">.</span><span class=\"n\">declare</span><span class=\"p\">(</span><span class=\"s2\">\"French\"</span><span class=\"p\">)</span>\n<span class=\"n\">Languages</span> <span class=\"o\">=</span> <span class=\"n\">Languages_</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">()</span>\n\n<span class=\"n\">Human</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Human'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Mortal</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Mortal'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">Something</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Something'</span><span class=\"p\">,</span>  <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">Whiskers</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Whiskers'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Tail</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Tail'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Cat</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Cat'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"n\">Language</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Language'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n<span class=\"n\">Name</span> <span class=\"o\">=</span> <span class=\"n\">Function</span><span class=\"p\">(</span><span class=\"s1\">'Name'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">,</span> <span class=\"n\">BoolSort</span><span class=\"p\">())</span>\n\n<span class=\"c1\"># free variables used in forall must be declared Const in python</span>\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'x'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'y'</span><span class=\"p\">,</span> <span class=\"n\">Languages</span><span class=\"p\">)</span>\n\n<span class=\"n\">axioms</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">Whiskers</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Tail</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Not</span><span class=\"p\">(</span><span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">x</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">),</span> <span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">))),</span>\n    <span class=\"n\">ForAll</span><span class=\"p\">([</span><span class=\"n\">y</span><span class=\"p\">],</span><span class=\"n\">Implies</span><span class=\"p\">(</span><span class=\"n\">Language</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">),</span> <span class=\"n\">And</span><span class=\"p\">(</span><span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">))))</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">Solver</span><span class=\"p\">()</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">axioms</span><span class=\"p\">)</span>\n\n<span class=\"n\">assumptions</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">Object</span><span class=\"o\">.</span><span class=\"n\">socrates</span><span class=\"p\">),</span>\n    <span class=\"n\">Human</span><span class=\"p\">(</span><span class=\"n\">Object</span><span class=\"o\">.</span><span class=\"n\">pavel</span><span class=\"p\">),</span>\n    <span class=\"c1\">#Cat(Object.pavel), # &lt;- this assumption makes model unsat because cat(x) is not human(x)</span>\n    <span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">Languages</span><span class=\"o\">.</span><span class=\"n\">English</span><span class=\"p\">),</span>\n    <span class=\"n\">Name</span><span class=\"p\">(</span><span class=\"n\">Languages</span><span class=\"o\">.</span><span class=\"n\">French</span><span class=\"p\">)</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">push</span><span class=\"p\">()</span>\n\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">assumptions</span><span class=\"p\">)</span>\n\n<span class=\"n\">v</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'v'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">Mortal</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">))</span>\n\n<span class=\"k\">while</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"n\">sat</span><span class=\"p\">:</span>\n    <span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"v = </span><span class=\"si\">%s</span><span class=\"s2\">\"</span> <span class=\"o\">%</span> <span class=\"n\">m</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">])</span>\n    <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">v</span> <span class=\"o\">!=</span> <span class=\"n\">m</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">])</span>\n\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">pop</span><span class=\"p\">()</span>\n</code></pre></div>",
        "id": 263104284,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1638251342
    },
    {
        "content": "<p>That works nicely! Thank you <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Now that we are able to answer simple Wh-queries, what about more complex ones? Can we return a clause, for example?  Lets say I want to ask \"what does cat have?\" And it should return \"And(Whiskers(x), Tail(x))\". Can we do that?</p>",
        "id": 263120852,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638265627
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459811\">@Pavel Kulko</span> That query sounds very ambiguous. Why is it not returning <code>[Whiskers(x), Tail(x), Not(Human(x)), Mortal(x)]</code>?</p>",
        "id": 263225147,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638315846
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263225147\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459811\">Pavel Kulko</span> That query sounds very ambiguous. Why is it not returning <code>[Whiskers(x), Tail(x), Not(Human(x)), Mortal(x)]</code>?</p>\n</blockquote>\n<p>Well, the code below returns constant \"v = socrates\". But how can I make it return some clause? </p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">v</span> <span class=\"o\">=</span> <span class=\"n\">Const</span><span class=\"p\">(</span><span class=\"s1\">'v'</span><span class=\"p\">,</span> <span class=\"n\">Object</span><span class=\"p\">)</span>\n<span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">Cat</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">))</span>\n\n<span class=\"k\">while</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">check</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"n\">sat</span><span class=\"p\">:</span>\n    <span class=\"n\">m</span> <span class=\"o\">=</span> <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">model</span><span class=\"p\">()</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">\"v = </span><span class=\"si\">%s</span><span class=\"s2\">\"</span> <span class=\"o\">%</span> <span class=\"n\">m</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">])</span>\n    <span class=\"n\">s</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">v</span> <span class=\"o\">!=</span> <span class=\"n\">m</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">])</span>\n</code></pre></div>",
        "id": 263231008,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638319845
    },
    {
        "content": "<p>what clause?</p>",
        "id": 263233398,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638321863
    },
    {
        "content": "<p>the question isn't uniquely determined; there are an infinite number of clauses that are true about anything satisfying <code>Cat(x)</code></p>",
        "id": 263233447,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638321916
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263233447\">said</a>:</p>\n<blockquote>\n<p>the question isn't uniquely determined; there are an infinite number of clauses that are true about anything satisfying <code>Cat(x)</code></p>\n</blockquote>\n<p>In this case we should only return the clause (or part of it) which was provided in the axioms.. or maybe I should formulate the question differently. Currently I can extract all the satisfying predicates from the model based on the appearance of the variable \"socrates\" in the else_value(): [Whiskers(x), Cat(x), Tail(x), Mortal(x)].</p>",
        "id": 263235299,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638323679
    },
    {
        "content": "<p>If you have a list of candidate formulas, you can see which ones are derivable from <code>Cat(x)</code> by seeing if <code>Cat(x) =&gt; P</code> is derivable</p>",
        "id": 263236640,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638325007
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263236640\">said</a>:</p>\n<blockquote>\n<p>If you have a list of candidate formulas, you can see which ones are derivable from <code>Cat(x)</code> by seeing if <code>Cat(x) =&gt; P</code> is derivable</p>\n</blockquote>\n<p>yes, that could work. I'm just trying different query now. For example <code>s.add(Implies(Tail(v),Human(v)))</code> will return constant \"pavel\". But what I'm trying to ask with this clause is \"does the human have tail?\" Is the clause formulated correctly?</p>",
        "id": 263237428,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638325944
    },
    {
        "content": "<p>You need a quantifier. Do you mean to ask whether <em>any</em> human has a tail or <em>all</em>?</p>",
        "id": 263237706,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638326224
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263237706\">said</a>:</p>\n<blockquote>\n<p>You need a quantifier. Do you mean to ask whether <em>any</em> human has a tail or <em>all</em>?</p>\n</blockquote>\n<p>Thanks. Indeed, this query works <code>s.add(ForAll([v],Implies(Tail(v),Human(v))))</code></p>",
        "id": 263238044,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638326639
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459811\">Pavel Kulko</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263238044\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263237706\">said</a>:</p>\n<blockquote>\n<p>You need a quantifier. Do you mean to ask whether <em>any</em> human has a tail or <em>all</em>?</p>\n</blockquote>\n<p>Thanks. Indeed, this query works <code>s.add(ForAll([v],Implies(Tail(v),Human(v))))</code></p>\n</blockquote>\n<p>what if I want to ask \"is pavel mortal\"? How can I encode it?</p>",
        "id": 263240798,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638329939
    },
    {
        "content": "<p>add <code>Mortal(pavel)</code> and see if it is unsat, and similarly for <code>!Mortal(pavel)</code>:</p>\n<ul>\n<li>If adding <code>Mortal(pavel)</code> makes it unsat, then pavel is immortal</li>\n<li>If adding <code>!Mortal(pavel)</code> makes it unsat, then pavel is mortal</li>\n<li>If neither makes it unsat, then the given axioms are not enough to determine whether pavel is mortal or not</li>\n</ul>",
        "id": 263241013,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638330190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459811\">Pavel Kulko</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263240798\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459811\">Pavel Kulko</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263238044\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/questions.20about.20the.20Z3.20theorem.20prover/near/263237706\">said</a>:</p>\n<blockquote>\n<p>You need a quantifier. Do you mean to ask whether <em>any</em> human has a tail or <em>all</em>?</p>\n</blockquote>\n<p>Thanks. Indeed, this query works <code>s.add(ForAll([v],Implies(Tail(v),Human(v))))</code></p>\n</blockquote>\n<p>what if I want to ask \"is pavel mortal\"? How can I encode it?</p>\n</blockquote>\n<p>Would it be enough to just add <code>s.add(Mortal(Object.pavel))</code> and then check if the solver returns \"sat\" ? So that would mean true. Otherwise, if it returns \"unsat\" then it is either False or Unknown?</p>",
        "id": 263241019,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638330210
    },
    {
        "content": "<p>Not quite. Notice that I said to look for \"unsat\", not \"sat\". If adding <code>Mortal(pavel)</code> returns \"sat\" that doesn't mean that pavel is mortal, it means that we cannot exclude the possibility that pavel is mortal</p>",
        "id": 263241109,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638330306
    },
    {
        "content": "<p>to prove that pavel is mortal we instead want to add <code>!Mortal(pavel)</code> and get a contradiction</p>",
        "id": 263241128,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638330335
    },
    {
        "content": "<p>ah ok, and to check if the answer is Unknown we just need to run it two times, once with the original query and the second time with the negated query. If both original and negated query return \"sat\" then the answer is unknown. is that correct?</p>",
        "id": 263241542,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638330848
    },
    {
        "content": "<p>yes, although it's more like \"independent\" than \"unknown\". \"Unknown\" would be if you got at least one \"Unknown\" response to those queries, which means the sat solver couldn't prove or disprove the assertion within the time limit</p>",
        "id": 263241909,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638331237
    },
    {
        "content": "<p>How can I answer the question \"who is pavel\"? That is, given the constant (Object.pavel), I want to find all the predicates where this constant can be applied.</p>",
        "id": 263385210,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638411025
    },
    {
        "content": "<p>currently I'm solving that problem by evaluating all the predicates known by the model. </p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"k\">for</span> <span class=\"n\">decl</span> <span class=\"ow\">in</span> <span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">decls</span><span class=\"p\">():</span>\n                <span class=\"n\">interp</span> <span class=\"o\">=</span> <span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">get_interp</span><span class=\"p\">(</span><span class=\"n\">decl</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">interp</span><span class=\"p\">,</span> <span class=\"n\">FuncInterp</span><span class=\"p\">):</span>\n                    <span class=\"k\">try</span><span class=\"p\">:</span>\n                        <span class=\"c1\">#check if predicate can be evaluated with the constant argument</span>\n                        <span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">eval</span><span class=\"p\">(</span><span class=\"n\">decl</span><span class=\"p\">(</span><span class=\"n\">const</span><span class=\"p\">))</span>\n                        <span class=\"n\">predicates</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">decl</span><span class=\"p\">)</span>\n                        <span class=\"n\">is_sat</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n                    <span class=\"k\">except</span><span class=\"p\">:</span>\n                        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">'</span><span class=\"si\">{</span><span class=\"n\">decl</span><span class=\"si\">}</span><span class=\"s1\"> != </span><span class=\"si\">{</span><span class=\"n\">const</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>But is this the only way? It doesn't seem to be very efficient.</p>",
        "id": 263390799,
        "sender_full_name": "Pavel Kulko",
        "timestamp": 1638417936
    },
    {
        "content": "<p>It sounds like you just want a list of all predicates which have an argument of type <code>Object</code>. I don't know if Z3's object representation is optimized for that, but probably if you can get all the decls you can ask what their types are and whether one of them is <code>Object</code></p>",
        "id": 263393862,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1638421961
    },
    {
        "content": "<p>Is there some way to figure out what z3 does for a specific SMT instance?</p>\n<p>I have a set of problems that vary in size, and I tried to find solutions for them using z3. In my tests, I noticed that z3 is absurdly fast for smaller problems but then hits a brick wall at some point. For problem sizes 2 to 11, it takes about 40ms to 50ms to find a solution, but for size 12 it doesn't find anything within an hour.</p>\n<p>What I <em>think</em> is happening is that z3 has multiple strategies for solving these SMT instances and it chooses the wrong one for those problems with size 12 and above. So is there a way for me to tell what strategy it's using for a given SMT instance? If so, is there a way for me to force it to use a strategy I know to be effective?</p>",
        "id": 313791380,
        "sender_full_name": "Aaron Bies",
        "timestamp": 1670150997
    },
    {
        "content": "<p>Just an FYI, this isn't a forum for Z3 questions</p>",
        "id": 313791460,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670151033
    },
    {
        "content": "<p>Do you know of a forum for z3? I tried looking for one, but didn't find anything</p>",
        "id": 313791507,
        "sender_full_name": "Aaron Bies",
        "timestamp": 1670151068
    },
    {
        "content": "<p>There is <a href=\"https://github.com/Z3Prover/z3/discussions\">https://github.com/Z3Prover/z3/discussions</a>, no idea whether that is the best place for it but I'm sure asking there will find a better place if there is one</p>",
        "id": 313791651,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1670151144
    },
    {
        "content": "<p>Alright, I'll repost my question there</p>",
        "id": 313791908,
        "sender_full_name": "Aaron Bies",
        "timestamp": 1670151310
    }
]