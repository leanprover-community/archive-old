[
    {
        "content": "<p>I just spent a few hours defining the golden ratio and proving Binet formula for the Fibonacci sequence. Is this already in mathlib ? If not, should I PR it ?</p>",
        "id": 206712029,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597247258
    },
    {
        "content": "<p>Btw, <code>ring_exp</code> is awesome</p>",
        "id": 206712081,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597247280
    },
    {
        "content": "<p>I don't think we have this yet and I think it is worth PRing.</p>",
        "id": 206712720,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1597247541
    },
    {
        "content": "<p>This is a codewars kata <a href=\"https://www.codewars.com/kata/5d2b89d4b90c0a001f4a6456/lean\">https://www.codewars.com/kata/5d2b89d4b90c0a001f4a6456/lean</a> but I don't think that should stop us from having Binet in mathlib (however some peoples solutions on there which you can check out if you submit your solution might have cool methods worth considering), which proof did you do?</p>",
        "id": 206713046,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1597247684
    },
    {
        "content": "<p>Oh I didn't know about this. My proof is based on this predicate : </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">satisfy_fib_rec</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>\n\n\n<p>which is stable under weighted sum (is this the right way to say that ?)</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">lemma</span> <span class=\"n\">satisfy_fib_rec_linear</span> <span class=\"o\">{</span><span class=\"n\">u</span> <span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">hu</span> <span class=\"o\">:</span> <span class=\"n\">satisfy_fib_rec</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">hv</span> <span class=\"o\">:</span> <span class=\"n\">satisfy_fib_rec</span> <span class=\"n\">v</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">satisfy_fib_rec</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">a</span> <span class=\"bp\">*</span> <span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"n\">b</span> <span class=\"bp\">*</span> <span class=\"n\">v</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"n\">sorry</span>\n</code></pre></div>\n\n\n<p>I also prove by induction that a sequence <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u_0 = 0</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u_1 = 1</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> which satisfies the above predicate is equal to the Fibonacci sequence :</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">lemma</span> <span class=\"n\">eq_fib_of_satisfy_fib_rec</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h₀</span> <span class=\"o\">:</span> <span class=\"n\">u</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h₁</span> <span class=\"o\">:</span> <span class=\"n\">u</span> <span class=\"mi\">1</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hₙ</span> <span class=\"o\">:</span> <span class=\"n\">satisfy_fib_rec</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"n\">fib</span> <span class=\"o\">:=</span>\n<span class=\"n\">sorry</span>\n</code></pre></div>\n\n\n<p>Then I just have to show that <code>λ n, (φ^n)</code> and <code>λ n, ((-φ⁻¹)^n)</code> satisfy this predicate, and what is left is just computation</p>",
        "id": 206715251,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597248614
    },
    {
        "content": "<p>I had a look to all answers. Mine was clearly not the shortest (but I wasn't really trying to make it short). Although maybe some of what I've proved about <code>satisfy_fib_rec</code> could be useful for studying e.g Lucas Number, I think I won't use it in a PR, there are much better proofs. <span class=\"user-mention\" data-user-id=\"235229\">@Alexey Solovyev</span> <span class=\"user-mention\" data-user-id=\"125393\">@Junyan Xu</span> do you mind if I use parts of your solutions to this kata for making the mathlib proof ?</p>",
        "id": 206738469,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597260002
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> You may use any part of my solution for the mathlib proof. In general, all Codewars solutions are licensed under the FreeBSD 2-Clause License (<a href=\"https://www.codewars.com/about/terms-of-service\">https://www.codewars.com/about/terms-of-service</a>).</p>",
        "id": 206739452,
        "sender_full_name": "Alexey Solovyev",
        "timestamp": 1597260564
    },
    {
        "content": "<p>Yeah that would be my suggestion too it would be cool to do something a bit more general. Like Lucas numbers too or any length 2 linear recurrence, but I didnt want to hold up your PR!</p>",
        "id": 206740433,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1597261063
    },
    {
        "content": "<p>Well, there's no hurry and that's not really complicated maths, I can definitely work on it if you think it's worth to have in mathlib</p>",
        "id": 206741012,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597261351
    },
    {
        "content": "<p>Having the version for any linear recurrence would be a great end goal, I think its definitely worth to have that in mathlib eventually. I.e. the solution of any <a href=\"https://en.wikipedia.org/wiki/Constant-recursive_sequence\">https://en.wikipedia.org/wiki/Constant-recursive_sequence</a>  like in theorem 1 of this random pdf <a href=\"https://www.math.kth.se/math/GRU/2012.2013/SF1610/CINTE/mastertheorem.pdf\">https://www.math.kth.se/math/GRU/2012.2013/SF1610/CINTE/mastertheorem.pdf</a> . The case where the roots have multiplicity one is an important special case. These sorts of recurrences really do come up in modern number theory anyway <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 206742248,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1597261996
    },
    {
        "content": "<p>Glad you like my proof, and you are welcome to use it! Not sure about mathlib contribution policies but you may mention my github handle @alreadydone where appropriate.<br>\n<span class=\"user-mention silent\" data-user-id=\"268315\">Anatole Dedecker</span> <a href=\"#narrow/stream/113489-new-members/topic/Binet.20Formula/near/206738469\">said</a>:</p>\n<blockquote>\n<p>I had a look to all answers. Mine was clearly not the shortest (but I wasn't really trying to make it short). Although maybe some of what I've proved about <code>satisfy_fib_rec</code> could be useful for studying e.g Lucas Number, I think I won't use it in a PR, there are much better proofs. <span class=\"user-mention silent\" data-user-id=\"235229\">Alexey Solovyev</span> <span class=\"user-mention silent\" data-user-id=\"125393\">Junyan Xu</span> do you mind if I use parts of your solutions to this kata for making the mathlib proof ?</p>\n</blockquote>",
        "id": 206746297,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1597263726
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127136\">Alex J. Best</span> <a href=\"#narrow/stream/113489-new-members/topic/Binet.20Formula/near/206742248\">said</a>:</p>\n<blockquote>\n<p>Having the version for any linear recurrence would be a great end goal, I think its definitely worth to have that in mathlib eventually. I.e. the solution of any <a href=\"https://en.wikipedia.org/wiki/Constant-recursive_sequence\">https://en.wikipedia.org/wiki/Constant-recursive_sequence</a>  like in theorem 1 of this random pdf <a href=\"https://www.math.kth.se/math/GRU/2012.2013/SF1610/CINTE/mastertheorem.pdf\">https://www.math.kth.se/math/GRU/2012.2013/SF1610/CINTE/mastertheorem.pdf</a> . The case where the roots have multiplicity one is an important special case. These sorts of recurrences really do come up in modern number theory anyway :)</p>\n</blockquote>\n<p>Ok so I started working on this, and after a long time of hesitations I've settled down on the following definitions. Before I continue, could you tell me if they look usable ? (Same question about the statement of <code>target</code> theorem`)</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data</span><span class=\"bp\">.</span><span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">ring_division</span>\n<span class=\"kn\">import</span> <span class=\"n\">linear_algebra</span><span class=\"bp\">.</span><span class=\"n\">dimension</span>\n<span class=\"kn\">import</span> <span class=\"n\">algebra</span><span class=\"bp\">.</span><span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">big_operators</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">finset</span>\n\n<span class=\"n\">open_locale</span> <span class=\"n\">big_operators</span>\n\n<span class=\"n\">noncomputable</span> <span class=\"n\">theory</span>\n\n<span class=\"kn\">structure</span> <span class=\"n\">linear_recurrence</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">field</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">order</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">coeffs</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variables</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">field</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">linear_recurrence</span>\n\n<span class=\"kn\">variables</span> <span class=\"o\">(</span><span class=\"n\">E</span> <span class=\"o\">:</span> <span class=\"n\">linear_recurrence</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"n\">def</span> <span class=\"n\">is_solution</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"err\">∑</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">coeffs</span> <span class=\"n\">i</span> <span class=\"bp\">*</span> <span class=\"n\">u</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"n\">i</span><span class=\"o\">))</span>\n\n<span class=\"n\">def</span> <span class=\"n\">mk_sol</span> <span class=\"o\">(</span><span class=\"n\">init</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"k\">if</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">&lt;</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"k\">then</span> <span class=\"n\">init</span> <span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"bp\">⟩</span> <span class=\"k\">else</span>\n  <span class=\"err\">∑</span> <span class=\"n\">k</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">,</span> <span class=\"k\">have</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">+</span> <span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"bp\">&lt;</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">;</span> <span class=\"n\">omega</span><span class=\"o\">,</span>\n    <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">coeffs</span> <span class=\"n\">k</span> <span class=\"bp\">*</span> <span class=\"n\">mk_sol</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">+</span> <span class=\"n\">k</span><span class=\"o\">)</span>\n\n<span class=\"n\">def</span> <span class=\"n\">is_sol_mk_sol</span> <span class=\"o\">(</span><span class=\"n\">init</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"o\">(</span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">mk_sol</span> <span class=\"n\">init</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n  <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">mk_sol</span><span class=\"bp\">;</span> <span class=\"n\">simp</span>\n\n<span class=\"n\">def</span> <span class=\"n\">mk_sol_eq_init</span> <span class=\"o\">(</span><span class=\"n\">init</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">,</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">mk_sol</span> <span class=\"n\">init</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">init</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n  <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">mk_sol</span><span class=\"bp\">;</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">fin</span><span class=\"bp\">.</span><span class=\"n\">coe_eq_val</span><span class=\"o\">,</span> <span class=\"n\">n</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">eq_mk_of_is_sol_of_eq_init</span> <span class=\"o\">{</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">init</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">heq</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">init</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">mk_sol</span> <span class=\"n\">init</span> <span class=\"n\">n</span>\n<span class=\"bp\">|</span> <span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"k\">if</span> <span class=\"n\">h&#39;</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">&lt;</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span>\n  <span class=\"k\">then</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">mk_sol</span><span class=\"bp\">;</span> <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">h&#39;</span><span class=\"o\">,</span> <span class=\"n\">dif_pos</span><span class=\"o\">]</span><span class=\"bp\">;</span> <span class=\"n\">exact_mod_cast</span> <span class=\"n\">heq</span> <span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">h&#39;</span><span class=\"bp\">⟩</span>\n  <span class=\"k\">else</span> <span class=\"k\">begin</span>\n    <span class=\"n\">rw</span> <span class=\"n\">mk_sol</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"err\">←</span> <span class=\"n\">nat</span><span class=\"bp\">.</span><span class=\"n\">sub_add_cancel</span> <span class=\"o\">(</span><span class=\"n\">le_of_not_lt</span> <span class=\"n\">h&#39;</span><span class=\"o\">),</span>\n    <span class=\"n\">rw</span> <span class=\"n\">h</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">-</span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">),</span>\n    <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">h&#39;</span><span class=\"o\">],</span>\n    <span class=\"n\">congr&#39;</span><span class=\"o\">,</span>\n    <span class=\"n\">ext</span> <span class=\"n\">k</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"k\">have</span> <span class=\"n\">wf</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"bp\">-</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">+</span> <span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"bp\">&lt;</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"k\">have</span> <span class=\"o\">:=</span> <span class=\"n\">k</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">;</span> <span class=\"n\">omega</span><span class=\"o\">,</span>\n      <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"n\">eq_mk_of_is_sol_of_eq_init</span>\n  <span class=\"kn\">end</span>\n\n<span class=\"n\">def</span> <span class=\"n\">sol_space</span> <span class=\"o\">:</span> <span class=\"n\">subspace</span> <span class=\"n\">α</span> <span class=\"o\">(</span><span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">carrier</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">u</span> <span class=\"bp\">|</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"n\">u</span><span class=\"o\">},</span>\n  <span class=\"n\">zero_mem&#39;</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">simp</span><span class=\"o\">,</span>\n  <span class=\"n\">add_mem&#39;</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span> <span class=\"n\">v</span> <span class=\"n\">hu</span> <span class=\"n\">hv</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">mul_add</span><span class=\"o\">,</span> <span class=\"n\">sum_add_distrib</span><span class=\"o\">,</span> <span class=\"n\">hu</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">hv</span> <span class=\"n\">n</span><span class=\"o\">],</span>\n  <span class=\"n\">smul_mem&#39;</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">u</span> <span class=\"n\">hu</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">hu</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">mul_sum</span><span class=\"o\">]</span><span class=\"bp\">;</span> <span class=\"n\">congr&#39;</span><span class=\"bp\">;</span> <span class=\"n\">ext</span><span class=\"bp\">;</span> <span class=\"n\">ac_refl</span> <span class=\"o\">}</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">is_sol_iff_mem_sol_space</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"n\">u</span> <span class=\"bp\">↔</span> <span class=\"n\">u</span> <span class=\"err\">∈</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">sol_space</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">refl</span>\n\n<span class=\"n\">def</span> <span class=\"n\">sol_space_linear_equiv_init_space</span> <span class=\"o\">:</span>\n  <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">sol_space</span> <span class=\"err\">≃ₗ</span><span class=\"o\">[</span><span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">to_fun</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n  <span class=\"n\">map_add&#39;</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span> <span class=\"n\">v</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">ext</span><span class=\"bp\">;</span> <span class=\"n\">simp</span><span class=\"bp\">;</span> <span class=\"n\">norm_cast</span><span class=\"o\">,</span>\n  <span class=\"n\">map_smul&#39;</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">ext</span><span class=\"bp\">;</span> <span class=\"n\">simp</span><span class=\"o\">,</span>\n  <span class=\"n\">inv_fun</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">mk_sol</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_sol_mk_sol</span> <span class=\"n\">u</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">left_inv</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">ext</span> <span class=\"n\">n</span><span class=\"bp\">;</span> <span class=\"n\">symmetry</span><span class=\"bp\">;</span> <span class=\"n\">apply</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">eq_mk_of_is_sol_of_eq_init</span> <span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">;</span> <span class=\"n\">intros</span> <span class=\"n\">k</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">right_inv</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">function</span><span class=\"bp\">.</span><span class=\"n\">funext_iff</span><span class=\"bp\">.</span><span class=\"n\">mpr</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">mk_sol_eq_init</span> <span class=\"n\">u</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">}</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">sol_space_dim</span> <span class=\"o\">:</span>\n  <span class=\"n\">vector_space</span><span class=\"bp\">.</span><span class=\"n\">dim</span> <span class=\"n\">α</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">sol_space</span> <span class=\"bp\">=</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"o\">:=</span>\n<span class=\"bp\">@</span><span class=\"n\">dim_fin_fun</span> <span class=\"n\">α</span> <span class=\"bp\">_</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"bp\">▸</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">sol_space_linear_equiv_init_space</span><span class=\"bp\">.</span><span class=\"n\">dim_eq</span>\n\n<span class=\"n\">def</span> <span class=\"n\">char_poly</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n  <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">monomial</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span> <span class=\"mi\">1</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"err\">∑</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">,</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">monomial</span> <span class=\"n\">i</span> <span class=\"o\">(</span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">coeffs</span> <span class=\"n\">i</span><span class=\"o\">))</span>\n\n<span class=\"bp\">#</span><span class=\"kn\">check</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval₂_finset_sum</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">geom_sol_iff_root_char_poly</span> <span class=\"o\">(</span><span class=\"n\">q</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">q</span><span class=\"bp\">^</span><span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">↔</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">char_poly</span><span class=\"bp\">.</span><span class=\"n\">is_root</span> <span class=\"n\">q</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">char_poly</span><span class=\"o\">,</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">is_root</span><span class=\"bp\">.</span><span class=\"n\">def</span><span class=\"o\">,</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"kn\">eval</span><span class=\"o\">],</span>\n  <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval₂_finset_sum</span><span class=\"o\">,</span> <span class=\"n\">one_mul</span><span class=\"o\">,</span>\n              <span class=\"n\">ring_hom</span><span class=\"bp\">.</span><span class=\"n\">id_apply</span><span class=\"o\">,</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval₂_monomial</span><span class=\"o\">,</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">eval₂_sub</span><span class=\"o\">],</span>\n  <span class=\"n\">split</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">intro</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">specialize</span> <span class=\"n\">h</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n    <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">zero_add</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">rwa</span> <span class=\"err\">←</span> <span class=\"n\">sub_eq_zero_iff_eq</span> <span class=\"n\">at</span> <span class=\"n\">h</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">h</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"n\">rw</span> <span class=\"n\">sub_eq_zero_iff_eq</span> <span class=\"n\">at</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">pow_add</span><span class=\"o\">],</span>\n    <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">mul_sum</span><span class=\"o\">],</span>\n    <span class=\"n\">congr</span><span class=\"o\">,</span>\n    <span class=\"n\">ext</span><span class=\"o\">,</span>\n    <span class=\"n\">ring</span> <span class=\"o\">}</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">theorem</span> <span class=\"n\">target</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"err\">∑</span> <span class=\"n\">x</span> <span class=\"k\">in</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">char_poly</span><span class=\"bp\">.</span><span class=\"n\">roots</span><span class=\"o\">,</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">char_poly</span><span class=\"bp\">.</span><span class=\"n\">root_multiplicity</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">order</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">is_solution</span> <span class=\"n\">u</span> <span class=\"bp\">↔</span>\n    <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">polynomial</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n      <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">degree</span> <span class=\"bp\">&lt;</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">char_poly</span><span class=\"bp\">.</span><span class=\"n\">root_multiplicity</span> <span class=\"n\">x</span><span class=\"o\">),</span>\n    <span class=\"n\">u</span> <span class=\"bp\">=</span> <span class=\"bp\">λ</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"err\">∑</span> <span class=\"n\">x</span> <span class=\"k\">in</span> <span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">char_poly</span><span class=\"bp\">.</span><span class=\"n\">roots</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"kn\">eval</span> <span class=\"n\">n</span> <span class=\"bp\">*</span> <span class=\"n\">x</span><span class=\"bp\">^</span><span class=\"n\">n</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span>\n\n<span class=\"kn\">end</span> <span class=\"n\">linear_recurrence</span>\n</code></pre></div>",
        "id": 207021768,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597497718
    },
    {
        "content": "<p><code>field \\a</code> should be something like <code>comm_semiring \\a</code>. I don't see any subtraction or division in alpha here.</p>",
        "id": 207022706,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499235
    },
    {
        "content": "<p>But this looks like a great set-up in general. Did you try using it to make sure it's usable for e.g. Binet?</p>",
        "id": 207022763,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499323
    },
    {
        "content": "<p>Well yes but then I can't define the vector space of solutions</p>",
        "id": 207022767,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597499334
    },
    {
        "content": "<p>sure you can, it's the semimodule of solutions</p>",
        "id": 207022771,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499346
    },
    {
        "content": "<p>the axioms for a vector space don't mention subtraction or division either</p>",
        "id": 207022779,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499369
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/Binet.20Formula/near/207022771\">said</a>:</p>\n<blockquote>\n<p>sure you can, it's the semimodule of solutions</p>\n</blockquote>\n<p>What about dimensions ? I don't see them defined for anything else than a vector_space</p>",
        "id": 207022783,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597499381
    },
    {
        "content": "<p>only free semimodules have dimensions</p>",
        "id": 207022788,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499394
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/Binet.20Formula/near/207022763\">said</a>:</p>\n<blockquote>\n<p>But this looks like a great set-up in general. Did you try using it to make sure it's usable for e.g. Binet?</p>\n</blockquote>\n<p>Oh I should try this indeed</p>",
        "id": 207022833,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597499411
    },
    {
        "content": "<p>but <code>fin E.order → α</code> is free</p>",
        "id": 207022834,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499411
    },
    {
        "content": "<p>So now an interesting question is the following:</p>",
        "id": 207022860,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499491
    },
    {
        "content": "<p>Say that the auxiliary polynomial (a monic polynomial with coefficients in alpha) is a product of linear factors (X-a1)(X-a2)...(X-an). When is (1,a1,a1^2,...,a1^{n-1}),(1,a2,a2^2,...,a2^{n-1}),...,(1,an,an^2,...an^{n-1}) a basis? And here you need a field.</p>",
        "id": 207022925,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499576
    },
    {
        "content": "<p>Because even for the integers if you consider X^2-1, i.e. a_{n+2}=a_n, then the roots are +-1, so the power sequences are (1,1,1,...) and (1,-1,1,-1,...), and you cannot find a Z-linear combination of these which makes (1,0,1,0,...) because you can't divide by 2.</p>",
        "id": 207022980,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499645
    },
    {
        "content": "<p>So I suggest that all the beginning stuff is done for semirings (you probably don't even need commutative if you say which order you are summing things in, but perhaps this is going too far), but if you want to try to prove the \"first main theorem of recurrence relations\", which is that if the aux poly has distinct roots in the ground ring then (1,a1,a1^2,...),(1,a2,a2^2,...) etc form a basis, then you should do this for a field.</p>",
        "id": 207023048,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499766
    },
    {
        "content": "<p>Yep that looks good, I'll do this !</p>",
        "id": 207023066,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597499814
    },
    {
        "content": "<p>And then there are more fundamental theorems, for example with repeated roots there is some other solution, something like (0,1<em>a,2</em>a^2,3*a^3), and these give a basis, and probably you can also say something when the roots are not in the ground field too -- but actually I think that these more general theorems should be proved another way.</p>",
        "id": 207023080,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597499853
    },
    {
        "content": "<p>Let's stick to fields for this more subtle stuff. Then the vector space of solutions is n-dimensional because of the linear equiv you defined. There is also an operator sending (s0,s1,s2,s3,...) to (s1,s2,s3,...), and the point of the (1,a,a^2,a^3,...) solutions is that they are eigenvectors for this operator. The aux poly is the char poly of this operator. So actually you should prove the (1,a,a^2,..) stuff is a basis by deducing it from the general statement that an endomorphism of a fdvs (evdf) whose char poly has distinct linear factors has a basis of eigenvectors.</p>",
        "id": 207023206,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597500016
    },
    {
        "content": "<p>and the more general stuff comes from theorems like Jordan decomposition.</p>",
        "id": 207023212,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597500028
    },
    {
        "content": "<p>Hmmm I have read about this approach, but I thought we didn't have eigen stuff in mathlib <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 207025082,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597503294
    },
    {
        "content": "<p>Yes but it's not far away. I guess what I'm saying is that the natural thing to do is to wait until these theorems are in mathlib</p>",
        "id": 207025493,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597503938
    },
    {
        "content": "<p>Oh okay. So should I PR the infrastructure and then wait a bit before proving my target lemma ?</p>",
        "id": 207025560,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597504045
    },
    {
        "content": "<p>Btw is there a name for the \"shift n consecutive terms\" operator ?</p>",
        "id": 207025697,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597504245
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/Binet.20Formula/near/207022788\">said</a>:</p>\n<blockquote>\n<p>only free semimodules have dimensions</p>\n</blockquote>\n<p>I a free semimodule's dimension defined in mathlib ? I'm struggling to find it</p>",
        "id": 207025803,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1597504438
    },
    {
        "content": "<p>I'm not sure that it will be there. You are proving that it's isomorphic to <code>fin n -&gt; alpha</code> which is all you need.</p>",
        "id": 207025990,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1597504725
    }
]