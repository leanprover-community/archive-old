[
    {
        "content": "<p>Dear All,</p>\n<p>every once in a while, I am confronted with Lean accepting and working with functions that I thought would not have to exist.  Here is a simple example</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">shift1</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"bp\">ℕ</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"o\">,</span> <span class=\"n\">i</span><span class=\"bp\">-</span><span class=\"mi\">1</span>\n<span class=\"bp\">#</span><span class=\"kn\">eval</span> <span class=\"n\">shift1</span> <span class=\"mi\">0</span>  <span class=\"c1\">--- 0</span>\n<span class=\"bp\">#</span><span class=\"kn\">eval</span> <span class=\"n\">shift1</span> <span class=\"mi\">1</span>  <span class=\"c1\">--- 0</span>\n<span class=\"bp\">#</span><span class=\"kn\">eval</span> <span class=\"n\">shift1</span> <span class=\"mi\">0</span> <span class=\"bp\">-</span> <span class=\"n\">shift1</span> <span class=\"mi\">1</span>  <span class=\"c1\">--- 0</span>\n</code></pre></div>\n\n\n<p>I gather than Lean considers \"negative natural numbers\" as equal to <code>0</code>.  I always feel a little worried by this.</p>\n<ol>\n<li>Why does Lean not ask me to prove that the codomain of <code>shift1</code> is <code>ℕ</code>?</li>\n<li>Assuming that Lean is being lazy about it, why does Lean not complain when I apply <code>shift1</code> at <code>0</code>?</li>\n<li>Does this not cause consistency issues with proof checking?</li>\n</ol>",
        "id": 208789516,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599032540
    },
    {
        "content": "<p>When you use <code>-</code> and the domain is natural numbers, you get the function <code>nat.sub : nat -&gt; nat -&gt; nat</code>, which is truncated subtraction</p>",
        "id": 208789737,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032703
    },
    {
        "content": "<p>there is no inference of alternatives, and this can sometimes cause surprises, but there is no consistency concern, it's just a weird function</p>",
        "id": 208789778,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032737
    },
    {
        "content": "<p>As Mario says, 1+2 might be cleared up if you inspect the definition of natural number subtraction in Lean. <a href=\"https://xenaproject.wordpress.com/2020/07/05/division-by-zero-in-type-theory-a-faq/\">This blog post of <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span></a> is related too.</p>",
        "id": 208789808,
        "sender_full_name": "Bryan Gin-ge Chen",
        "timestamp": 1599032758
    },
    {
        "content": "<p>If you want \"proper subtraction\", you should write <code>(a - b : int)</code> (even if <code>a</code> and <code>b</code> have type <code>nat</code>). Then it will infer <code>int.sub</code> instead (which is sensible) and coerce <code>a</code> and <code>b</code> to integers</p>",
        "id": 208789936,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032842
    },
    {
        "content": "<p>Of course, if you do this lean will complain about the type you have given <code>shift1</code></p>",
        "id": 208789971,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032880
    },
    {
        "content": "<p>Ok, so you are saying that what Lean checks is correct, but it is on me to check that I am not using <code>-</code> where I should not?</p>",
        "id": 208790035,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599032904
    },
    {
        "content": "<p>well, if you wanted truncated subtraction then it might be the right thing</p>",
        "id": 208790065,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032938
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> You cannot <em>prove</em> that a function (or any term, for that matter) has a certain type. It has only one type, Lean can try to check it for you, but from a proving point of view, it's inaccesible.</p>",
        "id": 208790076,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599032944
    },
    {
        "content": "<p>Yes, just like it's on you to put parentheses in the right places!</p>",
        "id": 208790080,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1599032946
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208789936\">said</a>:</p>\n<blockquote>\n<p>If you want \"proper subtraction\", you should write <code>(a - b : int)</code> (even if <code>a</code> and <code>b</code> have type <code>nat</code>). Then it will infer <code>int.sub</code> instead (which is sensible) and coerce <code>a</code> and <code>b</code> to integers</p>\n</blockquote>\n<p>I see, so, to be safe, I should be using \"integer subtraction\" and prove that I land in the naturals in my applications</p>",
        "id": 208790086,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599032953
    },
    {
        "content": "<p>but usually yes, you should just always use it when you have a hypothesis saying it is sensible</p>",
        "id": 208790092,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599032956
    },
    {
        "content": "<p>So if you write <code>def shift1 : ℕ → ℕ :=</code> then what ever comes afterwards must be a function that has a well-defined <code>nat</code> value when you stick in <code>0</code>.</p>",
        "id": 208790138,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599032996
    },
    {
        "content": "<p>You could also define <code>shift1 : pnat -&gt; nat</code>... and then you cannot evaluate it on <code>0</code>, but only on terms of type <code>pnat</code>, which consist of <code>nat</code> + a proof of positivity.</p>",
        "id": 208790224,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033043
    },
    {
        "content": "<p>In practice however, it is easier to use the <code>shift1</code> that you defined.</p>",
        "id": 208790239,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033056
    },
    {
        "content": "<p>(It's called <code>nat.pred</code> btw)</p>",
        "id": 208790254,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033068
    },
    {
        "content": "<p>And then put the possitivity assumptions in the theorems that you want to prove.</p>",
        "id": 208790260,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033072
    },
    {
        "content": "<p>Ok, these answers clarified my doubts and confirmed my fears!  I am glad to hear that Lean is acting consistently, I am less happy about having to now check that when I use <code>-</code> is really should make sure that <code>-</code> is the function that I think it is!</p>",
        "id": 208790279,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033090
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208790254\">said</a>:</p>\n<blockquote>\n<p>(It's called <code>nat.pred</code> btw)</p>\n</blockquote>\n<p>But that one has syntactic issues... because <code>i - 1</code> looks a lot better.</p>",
        "id": 208790283,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033096
    },
    {
        "content": "<p>it is <code>nat.pred</code> up to equality</p>",
        "id": 208790320,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033121
    },
    {
        "content": "<p>Kevin will tell you to just avoid ever using <code>-</code> on naturals</p>",
        "id": 208790386,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033159
    },
    {
        "content": "<p>But you can't avoid using <code>1/x</code> on the rationals...</p>",
        "id": 208790407,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033178
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208790279\">said</a>:</p>\n<blockquote>\n<p>Ok, these answers clarified my doubts and confirmed my fears!  I am glad to hear that Lean is acting consistently, I am less happy about having to now check that when I use <code>-</code> is really should make sure that <code>-</code> is the function that I think it is!</p>\n</blockquote>\n<p>There will be a theorem that says that it is the function you think it is for all sensible inputs.</p>",
        "id": 208790445,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033210
    },
    {
        "content": "<p>If you prove a good selection of theorems about your definitions, you will very likely notice if you have missed a hypothesis</p>",
        "id": 208790456,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033224
    },
    {
        "content": "<p>So, just to make it completely explicit: <code>a-b</code> in Lean means what I would write on a board as <code>max 0 (a-b)</code><br>\nLean takes care of checking that with this definition, everything follows</p>",
        "id": 208790464,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033230
    },
    {
        "content": "<p><code>1/0 = 0</code>, but for all nonzero <code>x</code>, we have a theorem that says <code>x * (1/x) = 1</code></p>",
        "id": 208790471,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033239
    },
    {
        "content": "<p>Alright, my doubts have dissolved, my fears have crystallized!</p>",
        "id": 208790547,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033286
    },
    {
        "content": "<p>thank you!</p>",
        "id": 208790550,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033291
    },
    {
        "content": "<p>similarly, we have a theorem that says <code>a-b</code> means what you would write on a board as <code>a-b</code> whenever it could possibly land in the type you have ascribed to it</p>",
        "id": 208790551,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033292
    },
    {
        "content": "<p>Of course <code>def shift1' : int -&gt; int := \\lam i, i - 1</code> is <em>mathematically pure</em></p>",
        "id": 208790570,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033314
    },
    {
        "content": "<p>otherwise it yields \"garbage\"and we quietly ignore that case</p>",
        "id": 208790585,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033324
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> Have you ever tried <code>#eval 7.3/2.5</code>?</p>",
        "id": 208790673,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033373
    },
    {
        "content": "<p>ouch</p>",
        "id": 208790687,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033385
    },
    {
        "content": "<p>Right, except that if I am trying to shift the coefficients of a polynomial, then I am assigning the constant term to lots of coefficients that should be getting a coefficient of 0</p>",
        "id": 208790701,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033399
    },
    {
        "content": "<p>shouldn't the coefficient map be going the other direction?</p>",
        "id": 208790742,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033447
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208790673\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> Have you ever tried <code>#eval 7.3/2.5</code>?</p>\n</blockquote>\n<p>are you trying to discourage me from using Lean?!?!  Ahahaha</p>",
        "id": 208790748,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033453
    },
    {
        "content": "<p>What exactly are you trying to do? Can you write down the function in maths <code>$$ \\latex here $$</code></p>",
        "id": 208790756,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033461
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> Is it <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>a</mi><mi>i</mi></msub><msup><mi>X</mi><mi>i</mi></msup><mo>↦</mo><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>a</mi><mi>i</mi></msub><msup><mi>X</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\sum_i a_i X^i \\mapsto \\sum_i a_i X^{i-1}</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:1.124374em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16195399999999993em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">↦</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.124374em;vertical-align:-0.29971000000000003em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16195399999999993em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>, or what kind of map do you want?</p>",
        "id": 208790856,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033545
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208790742\">said</a>:</p>\n<blockquote>\n<p>shouldn't the coefficient map be going the other direction?</p>\n</blockquote>\n<p>In my mind, I have a polynomial <code>f</code> and I want to write is as <code>x^N*g</code>, where <code>g</code> is not divisible by <code>x</code>.  For this, I shift coefficients by <code>N</code>...</p>",
        "id": 208790875,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033570
    },
    {
        "content": "<p>What's happening with the coefficients below <code>N</code>?</p>",
        "id": 208790964,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033617
    },
    {
        "content": "<p>the polynomial <code>f</code> has coefficients below <code>N</code> equal to 0...</p>",
        "id": 208791010,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033651
    },
    {
        "content": "<p>In that situation you can define <code>g(i) = f(i+N)</code></p>",
        "id": 208791032,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033671
    },
    {
        "content": "<p>I wish <code>multiplicity</code> would be easier to use... but I'm scared of sending you in that direction. It is what should be used here.</p>",
        "id": 208791035,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033673
    },
    {
        "content": "<p>where <code>()</code> is coeff</p>",
        "id": 208791040,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033678
    },
    {
        "content": "<p>but in order to construct the <code>support</code> for <code>g</code> i need to do the opposite shift, no?</p>",
        "id": 208791126,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033727
    },
    {
        "content": "<p>I don't think you should construct the polynomial by hand.</p>",
        "id": 208791140,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791140\">said</a>:</p>\n<blockquote>\n<p>I don't think you should construct the polynomial by hand.</p>\n</blockquote>\n<p>Ok, but I know of no other way...</p>",
        "id": 208791154,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033768
    },
    {
        "content": "<p>You could say <code>N</code> is the largest integer such that there exists <code>g</code> such that <code>f = x^N*g</code></p>",
        "id": 208791188,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033793
    },
    {
        "content": "<p>(to be clear, in this specific case, I do not think that there is a problem with using Lean's <code>-</code>, but the proof checker in my mind was having some difficult times reconciling the two notions!)</p>",
        "id": 208791223,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033830
    },
    {
        "content": "<p><code>\\lam poly, \\sum i in range (nat_degree poly), coeff i poly * X ^ (i - N)</code> is one definition... but I don't think it's the best.</p>",
        "id": 208791225,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033834
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791188\">said</a>:</p>\n<blockquote>\n<p>You could say <code>N</code> is the largest integer such that there exists <code>g</code> such that <code>f = x^N*g</code></p>\n</blockquote>\n<p>This is <code>multiplicity</code></p>",
        "id": 208791280,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033853
    },
    {
        "content": "<p>indeed</p>",
        "id": 208791294,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033862
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> Do you already have a proof that your poly is nonzero?</p>",
        "id": 208791301,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033868
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791301\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> Do you already have a proof that your poly is nonzero?</p>\n</blockquote>\n<p>yes</p>",
        "id": 208791320,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033879
    },
    {
        "content": "<p>you could try using <code>N = multiplicity x f</code></p>",
        "id": 208791338,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033900
    },
    {
        "content": "<p>Great... then <code>multiplicity</code> might not be too bad.</p>",
        "id": 208791339,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599033900
    },
    {
        "content": "<p>(roughly)</p>",
        "id": 208791357,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033909
    },
    {
        "content": "<p>I will look up <code>multiplicity</code>, then!</p>",
        "id": 208791367,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033920
    },
    {
        "content": "<p>(and use it carefully: I am fed up of <code>finsets</code>)</p>",
        "id": 208791384,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033935
    },
    {
        "content": "<p>oh, enats are even more fun! <span aria-label=\"smiling devil\" class=\"emoji emoji-1f608\" role=\"img\" title=\"smiling devil\">:smiling_devil:</span></p>",
        "id": 208791407,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599033962
    },
    {
        "content": "<p>i had to write a lemma to show that a bounded subset of the naturals is a <code>finset</code> and i do not want to think about <code>finset</code>s again, if possible!</p>",
        "id": 208791493,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599033990
    },
    {
        "content": "<p>it's a subset of <code>fin.range n</code></p>",
        "id": 208791526,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599034006
    },
    {
        "content": "<p>enats?!  I am not sure that I want to know what those are</p>",
        "id": 208791542,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034018
    },
    {
        "content": "<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi><mo>∪</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{N} \\cup \\infty</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">N</span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span></p>",
        "id": 208791563,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034032
    },
    {
        "content": "<p>\"extended\" natural numbers</p>",
        "id": 208791571,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1599034036
    },
    {
        "content": "<p>you will be getting acquainted with them because that's the type of <code>multiplicity</code></p>",
        "id": 208791614,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1599034063
    },
    {
        "content": "<p>oooh no!  at least, I also produced many lemmas proving that a polynomial is non-zero, so hopefully I can steer away from enats!  for <code>finsets</code> the bad guy was <code>nonempty</code>...</p>",
        "id": 208791718,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034118
    },
    {
        "content": "<p>it looks like the \"good\" non-zero saves you from the evil of enats and nonempty</p>",
        "id": 208791762,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034166
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> I was going to be using <code>multiplicity</code> in about an hour on the Discord.</p>",
        "id": 208791764,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034168
    },
    {
        "content": "<p>I want to define the valuation on a discrete valuation ring</p>",
        "id": 208791785,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034187
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">let</span> <span class=\"n\">N</span> <span class=\"o\">:=</span> <span class=\"n\">enat</span><span class=\"bp\">.</span><span class=\"n\">get</span> <span class=\"o\">(</span><span class=\"n\">multiplicity</span> <span class=\"n\">X</span> <span class=\"n\">f</span><span class=\"o\">)</span> <span class=\"bp\">_</span>\n<span class=\"k\">obtain</span> <span class=\"err\">\\</span><span class=\"bp\">&lt;</span><span class=\"n\">g</span><span class=\"o\">,</span> <span class=\"n\">hg</span><span class=\"err\">\\</span><span class=\"bp\">&gt;</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"bp\">^</span> <span class=\"n\">N</span> <span class=\"err\">\\</span><span class=\"bp\">|</span> <span class=\"n\">f</span> <span class=\"o\">:=</span> <span class=\"n\">pow_multiplicity_dvd</span> <span class=\"bp\">_</span><span class=\"o\">,</span>\n</code></pre></div>",
        "id": 208791873,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791764\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> I was going to be using <code>multiplicity</code> in about an hour on the Discord.</p>\n</blockquote>\n<p>I see!  I will try to work with it a little first and if I am still having problems, I will come to discord.  i feel a little awkward on the discord: I am listening in on the conversation, but not able to talk.  I feel like I am eavesdropping...</p>",
        "id": 208791911,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034241
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791785\">said</a>:</p>\n<blockquote>\n<p>I want to define the valuation on a discrete valuation ring</p>\n</blockquote>\n<p>Where will it take values?</p>",
        "id": 208791931,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034258
    },
    {
        "content": "<p>You should buy an external mic on amazon or whatever</p>",
        "id": 208791937,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034262
    },
    {
        "content": "<p><code>with_zero (multiplicative \\Z)</code></p>",
        "id": 208791954,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034272
    },
    {
        "content": "<p>Note that <code>(factors x).card</code> is also very useful. See the dvr.lean file</p>",
        "id": 208791960,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034277
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791937\">said</a>:</p>\n<blockquote>\n<p>You should buy an external mic on amazon or whatever</p>\n</blockquote>\n<p>Yes, I am going to, I just have not gotten around to doing it, yet</p>",
        "id": 208791980,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034291
    },
    {
        "content": "<p>I've used it as a \"pseudo\" valuation already</p>",
        "id": 208791990,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034299
    },
    {
        "content": "<p>The issue with DVRs will be proving v(xy)=v(x)v(y).</p>",
        "id": 208792216,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034447
    },
    {
        "content": "<p>Ok, I have made a note of all the commands that you suggested wrt multiplicities and also made a mental note that <code>-</code> in Lean is not the <code>-</code> in my mind, at least when it comes to the naturals!</p>\n<p>I feel kind of strange that in my mind, <code>shift1</code> does not compile as a function from nat to nat, while for Lean it does, although now I understand the reason behind it!</p>",
        "id": 208792264,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034498
    },
    {
        "content": "<p>To find \"all of the commands for multiplicity\" you should #check the definition, right click to find it in the source code, and then read the statements of the theorems that come immediately after the definition.</p>",
        "id": 208792377,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599034571
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> But like I said... <code>multiplicity</code> API needs quite a bit of love</p>",
        "id": 208792398,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599034602
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208792398\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> But like I said... <code>multiplicity</code> API needs quite a bit of love</p>\n</blockquote>\n<p>that is ok: i feel like I have not really taken advantage of the existing API's of almost all the definitions that I have been using so far...</p>",
        "id": 208792464,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034659
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208792377\">said</a>:</p>\n<blockquote>\n<p>To find \"all of the commands for multiplicity\" you should #check the definition, right click to find it in the source code, and then read the statements of the theorems that come immediately after the definition.</p>\n</blockquote>\n<p>I know that you mentioned this many times and I am making progress with this!</p>\n<ol>\n<li>I am getting better at reading Lean code, so I can actually understand the statements (although the proof escape me, usually, but, by proof irrelevance, I can work with the one in my head and I am happy!)</li>\n<li>I am starting to realize that files are not so long, so \"reading the <em>whole</em> file\" is actually not a daunting task!</li>\n<li>I am also understanding how to convert these statement into commands that I can use.</li>\n</ol>\n<p>Probably, these 3 points above are clear to everyone else, but I am trying to internalize them, albeit slowly!</p>",
        "id": 208792774,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599034841
    },
    {
        "content": "<p>For me this was a key point. I remember thinking \"I need to use finite sets, so I should carefully read all of data.finset so I should probably also read all of data.multiset\" and these files are (or were -- maybe now they have been split up a bit) gigantic, and the proofs were incomprehensible. I thought I was in trouble! I tried to work through some of the early proofs but they were in term mode and I found it extremely difficult.</p>\n<p>I later on realised that I was doing the wrong thing. The key things to do are: (1) isolate the key definitions in the file (which nowadays should be easy because they should be in the module documentation at the top of the file) and (2) for each definition which you want to use, get to know its interface by reading the statements of the theorems proved about it; often some of the important ones are proved in the code directly after the definition is made. <em>Don't worry about the proofs</em>. Just figure out what you can do with the definition. Then you can use it in your own work.</p>",
        "id": 208793922,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599035635
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791225\">said</a>:</p>\n<blockquote>\n<p><code>\\lam poly, \\sum i in range (nat_degree poly), coeff i poly * X ^ (i - N)</code> is one definition... but I don't think it's the best.</p>\n</blockquote>\n<p>Johan, when you write <code>\\sum</code>, I imagine that you are telling Lean that you want to sum over the set.  What is the syntax?  I am using </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">λ</span> <span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span> <span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"err\">∑</span> <span class=\"o\">(</span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">range</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span><span class=\"o\">)),</span> <span class=\"n\">coeff</span> <span class=\"n\">i</span> <span class=\"n\">p</span> <span class=\"bp\">*</span> <span class=\"n\">X</span> <span class=\"bp\">^</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span> <span class=\"bp\">-</span> <span class=\"n\">i</span><span class=\"o\">))</span>\n</code></pre></div>\n\n\n<p>and Lean does not like it...</p>",
        "id": 208794737,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036148
    },
    {
        "content": "<p>it's <code>∑ i in range (nat_degree p)</code> not <code>∑ ( i in range (nat_degree p))</code></p>",
        "id": 208794794,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036181
    },
    {
        "content": "<p>the <code>in</code> is part of the syntax</p>",
        "id": 208794800,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036184
    },
    {
        "content": "<p>btw this is <code>polynomial.derivative</code></p>",
        "id": 208794825,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036199
    },
    {
        "content": "<p>so you can just look at how they do it</p>",
        "id": 208794842,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036210
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/polynomial.derivative/src\">src#polynomial.derivative</a></p>",
        "id": 208794847,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036213
    },
    {
        "content": "<p>nvm this isn't the derivative</p>",
        "id": 208794983,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036291
    },
    {
        "content": "<p>with </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">λ</span> <span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span> <span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"err\">∑</span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">range</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span><span class=\"o\">)</span> <span class=\"o\">,</span> <span class=\"n\">coeff</span> <span class=\"n\">i</span> <span class=\"n\">p</span> <span class=\"bp\">*</span> <span class=\"n\">X</span> <span class=\"bp\">^</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span> <span class=\"bp\">-</span> <span class=\"n\">i</span><span class=\"o\">))</span>\n</code></pre></div>\n\n\n<p>I still get an <code>unexpected token</code> and a red underlined \\Sigma</p>",
        "id": 208794987,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036296
    },
    {
        "content": "<p>you need to <code>open_locale big_operators</code> at the top of the file after the imports</p>",
        "id": 208795017,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036311
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208794983\">said</a>:</p>\n<blockquote>\n<p>nvm this isn't the derivative</p>\n</blockquote>\n<p>That is ok, they probably do something similar to what I want: I will take a look!</p>",
        "id": 208795032,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036322
    },
    {
        "content": "<p>you'll find that \"Lean does not like it\" doesn't tell much</p>",
        "id": 208795037,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036325
    },
    {
        "content": "<p>it's like people saying that some code \"doesn't work\"</p>",
        "id": 208795049,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036334
    },
    {
        "content": "<p>including the error would be more efficient</p>",
        "id": 208795143,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036371
    },
    {
        "content": "<p>Now \"Lean does not like range\"!  Wow  Progress!!</p>",
        "id": 208795183,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208795143\">said</a>:</p>\n<blockquote>\n<p>including the error would be more efficient</p>\n</blockquote>\n<p>The error was <code>unexpected token</code>, though...</p>",
        "id": 208795225,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036420
    },
    {
        "content": "<p>yes, and that's more helpful than \"Lean doesn't like it\"</p>",
        "id": 208795373,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036490
    },
    {
        "content": "<p>so Lean doesn't like <code>range</code> because it's <code>finset.range</code>, so you either type the full name or <code>open finset</code></p>",
        "id": 208795411,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036517
    },
    {
        "content": "<p>yes, I added the <code>finset</code>.  Still...</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">type</span> <span class=\"n\">mismatch</span> <span class=\"n\">at</span> <span class=\"n\">application</span>\n  <span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">coeff</span>\n<span class=\"n\">term</span>\n  <span class=\"n\">p</span>\n<span class=\"n\">has</span> <span class=\"n\">type</span>\n  <span class=\"n\">polynomial</span> <span class=\"n\">R</span>\n<span class=\"n\">but</span> <span class=\"n\">is</span> <span class=\"n\">expected</span> <span class=\"n\">to</span> <span class=\"k\">have</span> <span class=\"n\">type</span>\n  <span class=\"n\">polynomial</span> <span class=\"o\">(</span><span class=\"n\">polynomial</span> <span class=\"n\">R</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 208795462,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036564
    },
    {
        "content": "<p>(<code>coeff</code> is underlined)</p>",
        "id": 208795481,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036578
    },
    {
        "content": "<p>Lean sees <code>coeff i p * X ^ (nat_degree p - i))</code> and knows that <code>X ^ (nat_degree p - i)) : polynomial R</code></p>",
        "id": 208795746,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036728
    },
    {
        "content": "<p>so Lean expects <code>coeff i p : polynomial R</code> as well</p>",
        "id": 208795759,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036735
    },
    {
        "content": "<p>so Lean expects <code>p : polynomial (polynomial R)</code></p>",
        "id": 208795778,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036744
    },
    {
        "content": "<p>because you need <code>C (coeff i p)</code> instead of <code>coeff i p</code></p>",
        "id": 208795788,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1599036757
    },
    {
        "content": "<p>Ok, I added a C, indeed!  Thanks!</p>",
        "id": 208795795,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036762
    },
    {
        "content": "<p>(also, the i and the p are flipped, but I got as far!)</p>",
        "id": 208795813,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599036778
    },
    {
        "content": "<p>Sorry for not testing the code...</p>",
        "id": 208796073,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599036955
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208796073\">said</a>:</p>\n<blockquote>\n<p>Sorry for not testing the code...</p>\n</blockquote>\n<p>No problem: it is more helpful when I also have to do some work to understand how to use it!</p>",
        "id": 208796207,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599037036
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208791225\">said</a>:</p>\n<blockquote>\n<p><code>\\lam poly, \\sum i in range (nat_degree poly), coeff i poly * X ^ (i - N)</code> is one definition... but I don't think it's the best.</p>\n</blockquote>\n<p>Dear Johan,</p>\n<p>as I am making progress in unwrapping the definitions, I think that the range should be <code>nat_degree p + 1</code>, rather than <code>nat_degree p</code>, if I understand correctly.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">lemma</span> <span class=\"n\">larger_range</span> <span class=\"o\">{</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">{</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"bp\">=</span> <span class=\"err\">∑</span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">finset</span><span class=\"bp\">.</span><span class=\"n\">range</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">f</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">C</span> <span class=\"o\">(</span><span class=\"n\">coeff</span> <span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">))</span> <span class=\"bp\">*</span> <span class=\"n\">X</span> <span class=\"bp\">^</span><span class=\"n\">i</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n    <span class=\"n\">exact</span> <span class=\"n\">as_sum</span> <span class=\"n\">f</span><span class=\"o\">,</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 208808316,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599045065
    },
    {
        "content": "<p>There was no point proving that lemma; it is best if you delete it and just use <code>as_sum</code>. The more functions there are, the more the chances are that Lean will get confused.</p>",
        "id": 208813343,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1599048376
    },
    {
        "content": "<p>I agree, although I would like to use the \"reversal of coefficients\", which I am not sure is already defined:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">noncomputable</span> <span class=\"n\">def</span> <span class=\"n\">at_infty</span> <span class=\"o\">{</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">comm_ring</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span> <span class=\"bp\">→</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">polynomial</span> <span class=\"n\">R</span> <span class=\"o\">,</span> <span class=\"err\">∑</span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">finset</span><span class=\"bp\">.</span><span class=\"n\">range</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">C</span> <span class=\"o\">(</span><span class=\"n\">coeff</span> <span class=\"n\">p</span> <span class=\"n\">i</span><span class=\"o\">))</span> <span class=\"bp\">*</span> <span class=\"n\">X</span> <span class=\"bp\">^</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">p</span> <span class=\"bp\">-</span> <span class=\"n\">i</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 208813597,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599048544
    },
    {
        "content": "<p>(and now I am struggling to prove that the coefficients satisfy the identity </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">coeff</span> <span class=\"n\">f</span> <span class=\"n\">a</span> <span class=\"bp\">=</span> <span class=\"n\">coeff</span> <span class=\"o\">(</span><span class=\"n\">at_infty</span> <span class=\"n\">f</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">nat_degree</span> <span class=\"n\">f</span> <span class=\"bp\">-</span> <span class=\"n\">a</span><span class=\"o\">)</span>\n</code></pre></div>\n\n\n<p>)</p>",
        "id": 208813724,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599048613
    },
    {
        "content": "<p>This operation was actually discussed <a href=\"#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200078636\">here</a> but I don't know whether a PR was ever made</p>",
        "id": 208814485,
        "sender_full_name": "Reid Barton",
        "timestamp": 1599049060
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/negative.20natural.20numbers/near/208814485\">said</a>:</p>\n<blockquote>\n<p>This operation was actually discussed <a href=\"#narrow/stream/116395-maths/topic/reversing.20the.20coefficients/near/200078636\">here</a> but I don't know whether a PR was ever made</p>\n</blockquote>\n<p>Thank you!  I tried</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"kn\">check</span> <span class=\"n\">polynomial</span><span class=\"bp\">.</span><span class=\"n\">reverse</span>\n</code></pre></div>\n\n\n<p>but there is not hit, unfortunately.</p>",
        "id": 208814930,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1599049287
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> oops, you are right about the <code>nat.degree f + 1</code></p>",
        "id": 208818642,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1599051338
    }
]