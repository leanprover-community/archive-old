[
    {
        "content": "<p>Hi,<br>\nWhat does \"missing 'noncomputable' modifier, definition 'circle.makenew' depends on 'real.division_ring'Lean\" mean?<br>\nHere is what I was trying to do:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">structure</span> <span class=\"n\">point</span> <span class=\"o\">:=</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"bp\">\\</span><span class=\"n\">real</span><span class=\"o\">)</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span>\n  <span class=\"o\">(</span><span class=\"n\">center</span><span class=\"o\">:</span> <span class=\"n\">point</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">radius</span><span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">circle.makenew</span> <span class=\"o\">(</span><span class=\"n\">d</span> <span class=\"n\">e</span> <span class=\"n\">f</span><span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">):</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span>\n    <span class=\"n\">circle.mk</span>  <span class=\"o\">(</span><span class=\"n\">point.mk</span> <span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">d</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">e</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">real.sqrt</span> <span class=\"o\">(((</span><span class=\"n\">d</span><span class=\"bp\">*</span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">+</span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">*</span><span class=\"n\">e</span><span class=\"o\">))</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"bp\">-</span><span class=\"n\">f</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Thank you.</p>",
        "id": 310854563,
        "sender_full_name": "learnreal",
        "timestamp": 1668787321
    },
    {
        "content": "<p>Add <code>noncomputable</code> before the <code>def</code>. Or add <code>noncomputable theory</code> to the top of your file.</p>",
        "id": 310854912,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668787409
    },
    {
        "content": "<p>Because you can't really do computations with real numbers, and Lean is complaining about that.</p>",
        "id": 310855000,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668787433
    },
    {
        "content": "<p>Thank you. This got rid of error. But, how can I make it computable? For example, this is what I was trying:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">c2</span><span class=\"o\">:</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span> <span class=\"n\">circle.makenew</span> <span class=\"mi\">10</span> <span class=\"mi\">10</span> <span class=\"mi\">1</span>\n<span class=\"k\">#eval</span> <span class=\"n\">c2.radius</span>\n</code></pre></div>\n<p>I expect that to be 7. Instead it says \"code generation failed, VM does not have code for 'c2'\"</p>",
        "id": 310855794,
        "sender_full_name": "learnreal",
        "timestamp": 1668787667
    },
    {
        "content": "<p>And \"computation\" here specifically means \"computing with <code>#eval</code> or its equivalents.\" There are other sorts of computations you can do with lean, like using <code>simp</code> or <code>norm_num</code></p>",
        "id": 310855946,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668787697
    },
    {
        "content": "<p>You can't <code>#eval</code> real numbers at all since they're defined in a very <code>#eval</code>-incomputable way</p>",
        "id": 310856118,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668787746
    },
    {
        "content": "<p>I guess <code>norm_num</code> doesn't know about how to compute square roots of real numbers that have a nicely represented square, but here's an example of how you might evaluate things in another way:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.real.basic</span>\n<span class=\"kn\">import</span> <span class=\"n\">data.real.sqrt</span>\n<span class=\"kn\">import</span> <span class=\"n\">tactic</span>\n\n<span class=\"kd\">noncomputable theory</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">point</span> <span class=\"o\">:=</span>\n  <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span>\n  <span class=\"o\">(</span><span class=\"n\">center</span><span class=\"o\">:</span> <span class=\"n\">point</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">radius</span><span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">circle.makenew</span> <span class=\"o\">(</span><span class=\"n\">d</span> <span class=\"n\">e</span> <span class=\"n\">f</span><span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">):</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span>\n    <span class=\"n\">circle.mk</span>  <span class=\"o\">(</span><span class=\"n\">point.mk</span> <span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">d</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"n\">e</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">real.sqrt</span> <span class=\"o\">(((</span><span class=\"n\">d</span><span class=\"bp\">*</span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"bp\">+</span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">*</span><span class=\"n\">e</span><span class=\"o\">))</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"o\">)</span><span class=\"bp\">-</span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">c2</span><span class=\"o\">:</span> <span class=\"n\">circle</span> <span class=\"o\">:=</span> <span class=\"n\">circle.makenew</span> <span class=\"mi\">10</span> <span class=\"mi\">10</span> <span class=\"mi\">1</span>\n\n<span class=\"bp\">#</span><span class=\"n\">norm_num</span> <span class=\"o\">[</span><span class=\"n\">c2</span><span class=\"o\">,</span> <span class=\"n\">circle.makenew</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">c2.radius</span>\n<span class=\"c1\">-- real.sqrt 200 / real.sqrt 4 - 1</span>\n</code></pre></div>",
        "id": 310856707,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668787920
    },
    {
        "content": "<p>The square brackets after <code>#norm_num</code> are a way to tell it which definitions it should expand in the process of evaluation. It's not the best, but with some more work one can make it so you don't need to do that.</p>",
        "id": 310856886,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668787958
    },
    {
        "content": "<p>Great. Thank you :)</p>\n<p>This works for me (for now).</p>",
        "id": 310862929,
        "sender_full_name": "learnreal",
        "timestamp": 1668789662
    },
    {
        "content": "<p>So, QQ - if I really want computations then I should interface with some other language like c/c++?</p>",
        "id": 310863012,
        "sender_full_name": "learnreal",
        "timestamp": 1668789695
    },
    {
        "content": "<p>Not necessarily. Lean also has <code>Float</code>.</p>",
        "id": 310863178,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668789747
    },
    {
        "content": "<p>The question is: do you want to mix proofs and computations?</p>",
        "id": 310863226,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668789760
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/113489-new-members/topic/Error.3A.20missing.20'noncomputable'.20modifier/near/310863226\">said</a>:</p>\n<blockquote>\n<p>The question is: do you want to mix proofs and computations?</p>\n</blockquote>\n<p>Understood. I really don't want to mix. Just asking what is the way out - if deep into my code I get stuck with some computation.</p>",
        "id": 310863497,
        "sender_full_name": "learnreal",
        "timestamp": 1668789840
    },
    {
        "content": "<p>If you don't care about proofs, don't use <code>ℝ</code>. It's a type designed for proving things about real numbers.</p>",
        "id": 310863713,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668789898
    },
    {
        "content": "<p>Got it. Thanks a lot.</p>",
        "id": 310863768,
        "sender_full_name": "learnreal",
        "timestamp": 1668789922
    },
    {
        "content": "<p>It's a shame that mathlib is set up that way, because there are computable/constructible notions of real number that one can also prove things about.</p>",
        "id": 310900744,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668798022
    },
    {
        "content": "<p>We made a decision very early on to be classical pretty much throughout mathlib, because (amongst other things) we were trying to do something new (constructivism is rampant in ITP work and essentially nonexistent in mathematics departments); we were also trying to attract classical mathematicians to the project.</p>",
        "id": 310901077,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1668798122
    },
    {
        "content": "<p>I know.  I'm just saying, it's a shame.  (-:</p>",
        "id": 310902066,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668798438
    },
    {
        "content": "<p>It ought to be possible to develop real numbers constructively insofar as that is easy and then make classical assumptions only when needed.</p>",
        "id": 310902239,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668798509
    },
    {
        "content": "<p>A motivated person could develop their own constructive real numbers and then show they're classically isomorphic to mathlib's -- is there any reason for mathlib's real numbers to be constructive?</p>",
        "id": 310902993,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668798814
    },
    {
        "content": "<p>Would constructive real numbers mean you could get sensible output for <code>#eval r</code> with <code>r : real</code>? (I think not, but correct me if I'm wrong)</p>",
        "id": 310903134,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668798847
    },
    {
        "content": "<p>I don't see why not, as long as your <code>r</code> is built out of constructive operations.</p>",
        "id": 310904338,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668799284
    },
    {
        "content": "<p>Then someone like the OP in this thread would get the behavior they're expecting.</p>",
        "id": 310904394,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668799308
    },
    {
        "content": "<p>Some operations on real numbers can already be <code>eval</code>ed:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">2</span>\n<span class=\"kd\">def</span> <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">3</span>\n<span class=\"k\">#eval</span> <span class=\"n\">x</span> <span class=\"bp\">+</span> <span class=\"n\">y</span>\n</code></pre></div>\n<p>yields <code>real.of_cauchy (sorry /- 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, ... -/)</code> which is a little weird-looking but does tell you what the answer is.</p>",
        "id": 310905984,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668799868
    },
    {
        "content": "<blockquote>\n<p>Would constructive real numbers mean you could get sensible output for <code>#eval r</code> with <code>r : real</code>? (I think not, but correct me if I'm wrong)</p>\n</blockquote>\n<p>In theory, <code>#eval</code> can already give a sensible output for <code>r : ℝ</code>, but it would be very inefficient. Each real number can be evaluated to the first <code>n</code> decimal places (for some fixed <code>n</code>), each digit can be determined by running a Lean instance for every possible string checking whether that string represents a Lean proof of the statement <em>\"The k-th digit is 0\"</em> (resp. 1). Although, for some real numbers (such as Chaitin's constant), the algorithm won't terminate.</p>",
        "id": 310906227,
        "sender_full_name": "Patrick Johnson",
        "timestamp": 1668799951
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"381187\">@Mike Shulman</span> <a href=\"#narrow/stream/113489-new-members/topic/Error.3A.20missing.20'noncomputable'.20modifier/near/310905984\">said</a>:</p>\n<blockquote>\n<p>Some operations on real numbers can already be <code>eval</code>ed:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">2</span>\n<span class=\"kd\">def</span> <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">3</span>\n<span class=\"k\">#eval</span> <span class=\"n\">x</span> <span class=\"bp\">+</span> <span class=\"n\">y</span>\n</code></pre></div>\n<p>yields <code>real.of_cauchy (sorry /- 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, ... -/)</code> which is a little weird-looking but does tell you what the answer is.</p>\n</blockquote>\n<p>Ah, but actually the value was 6 all along! It just took a while to converge.</p>\n<p>Mathlib reals are not really computable at all. They contain zero bits of extractable information; even the information here can only be obtained by cheating (using unsafe functions that go outside the theory and break the quotient wrapper), at which point we may as well use a tool that looks at the fact that you added 2 and 3 directly and gives a much more sensible answer:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.real.basic</span>\n<span class=\"kd\">def</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">2</span>\n<span class=\"kd\">def</span> <span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">3</span>\n<span class=\"bp\">#</span><span class=\"n\">norm_num</span> <span class=\"o\">[</span><span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">y</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">+</span> <span class=\"n\">y</span> <span class=\"c1\">-- 5</span>\n</code></pre></div>",
        "id": 310908013,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668800628
    },
    {
        "content": "<p>It's also true constructively <em>inside</em> the theory that you can't extract any bits from a real number, but for a different reason (continuity).  But normalization isn't an operation inside the theory.  So if you normalize a real number defined in the empty context, you should get something that's an injection into the quotient of some concrete Cauchy sequence, and you can look (externally) at that Cauchy sequence and get information about the real number.  I assumed that the <code>5, 5, 5, 5, ...</code> in the display was arising from a computation of this sort.</p>",
        "id": 310909722,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668801273
    },
    {
        "content": "<p>Constructively one also generally works with Cauchy sequences having a fixed convergence rate, in which case seeing <code>5, 5, 5, 5, 5, 5, 5, 5, 5, 5, ...</code> would (at least for a sensible choice of convergence rate) at least tell you that the answer isn't <code>6</code>.</p>",
        "id": 310909895,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668801355
    },
    {
        "content": "<p>yes, I'm talking about the latter issue. You could implement constructive reals in mathlib, but what we have currently isn't that</p>",
        "id": 310910710,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668801623
    },
    {
        "content": "<p>but also, the operation you did wasn't normalization, that's <code>#reduce</code> and it scales atrociously. I very much doubt it terminates on your example in a reasonable time frame</p>",
        "id": 310911275,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668801795
    },
    {
        "content": "<p>No, it doesn't, I've tried.  But I thought <code>#eval</code> was something like normalization of closed terms using a fast external algorithm.</p>",
        "id": 310912632,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668802345
    },
    {
        "content": "<p>no, it's more like compilation to byte code and then interpretation</p>",
        "id": 310912762,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668802415
    },
    {
        "content": "<p>the consistency of that mapping is actually still an open question, although I suspect it to have reasonable properties and I have no counterexamples</p>",
        "id": 310912857,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668802444
    },
    {
        "content": "<p>the hard part being that it blows right through <code>eq.rec</code> applications, leading to ill typed terms which nevertheless compute reasonably</p>",
        "id": 310912956,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668802493
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"381187\">@Mike Shulman</span> What do you think of the <code>#norm_num [x, y] : x + y</code> that Mario wrote above?</p>",
        "id": 310975038,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668844350
    },
    {
        "content": "<p>Is that close enough to being \"computable\"?</p>",
        "id": 310975050,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668844363
    },
    {
        "content": "<p>(Note that that's the <em>only</em> method of those discussed so far that would actually be effective in giving you a proof that <code>2 + 3 = 5</code> over the reals. Evaluation outside the theory isn't helpful if you can't reflect it back to prove more things.)</p>",
        "id": 310975187,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668844486
    },
    {
        "content": "<p>It's hard to know what I think of it since I don't know what it's doing.  It looks like it doesn't evaluate square roots?  Is it doing more than just applying ring/field axioms?</p>",
        "id": 310975402,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1668844649
    },
    {
        "content": "<p>It is a system for \"numeric normalizations\". A user can register extensions, for example for fast primality proofs, or the recently added module for computing Jacobi symbols.</p>",
        "id": 310976254,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668845231
    },
    {
        "content": "<p>In a similar manner, someone can extend it with a square-root algorithm for (some?) reals.</p>",
        "id": 310976302,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668845258
    },
    {
        "content": "<p>A reasonable extension for square roots might for example work out expressions in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">[</mo><msqrt><msub><mi>p</mi><mn>1</mn></msub></msqrt><mo separator=\"true\">,</mo><msqrt><msub><mi>p</mi><mn>2</mn></msub></msqrt><mo separator=\"true\">,</mo><mo>…</mo><mtext> </mtext><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}[\\sqrt{p_1},\\sqrt{p_2},\\dots]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0869em;vertical-align:-0.3369em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">[</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7031em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6631em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3369em;\"><span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7031em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6631em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3369em;\"><span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mclose\">]</span></span></span></span> where the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">p_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> are detected ad-hoc from the expression. So you would get exact answers like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msqrt><mrow><mn>4</mn><mo>+</mo><msup><mn>2</mn><mn>2</mn></msup></mrow></msqrt><mo>+</mo><msqrt><mn>10</mn></msqrt><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>=</mo><mn>18</mn><mo>+</mo><mn>8</mn><msqrt><mn>5</mn></msqrt></mrow><annotation encoding=\"application/x-tex\">(\\sqrt{4 + 2^2} + \\sqrt{10})^2=18+8\\sqrt{5}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1634em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9134em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.8734em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1266em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1572em;vertical-align:-0.25em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">10</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">18</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1328em;\"></span><span class=\"mord\">8</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">5</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span></span></span></span> instead of an approximation (or an infinite sequence of approximations which in theory evaluates to something useful but in practice is left unreduced)</p>",
        "id": 310980562,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668848074
    },
    {
        "content": "<p>In other words, <code>norm_num</code> is a lot closer to a CAS than a calculator</p>",
        "id": 310980606,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1668848105
    },
    {
        "content": "<p>Does mathlib have a computable type for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">[</mo><mrow><msqrt><mi>n</mi></msqrt><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">∀</mi><mi>n</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">square_free</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mo>∏</mo><mi>n</mi><mo separator=\"true\">,</mo><msubsup><mi>X</mi><mi>n</mi><mn>2</mn></msubsup><mo>−</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}[{\\sqrt{n} | ∀ n, \\operatorname{square\\_free} n}] / (∏ n, X_n^2- n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1241em;vertical-align:-0.31em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span><span class=\"mord\">∣∀</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">square_free</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span><span class=\"mclose\">]</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.453em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>?</p>",
        "id": 310982403,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668849043
    },
    {
        "content": "<p>Do you mean <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Q</mi></mrow><annotation encoding=\"application/x-tex\">ℚ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord amsrm\">Q</span></span></span></span> adjoint the square root of all square free integers?</p>",
        "id": 310983740,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668849755
    },
    {
        "content": "<p>You might even go for something like <a href=\"https://en.wikipedia.org/wiki/Quadratically_closed_field#Quadratic_closure\">https://en.wikipedia.org/wiki/Quadratically_closed_field#Quadratic_closure</a></p>",
        "id": 310983808,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1668849794
    },
    {
        "content": "<p>Oh, I guess I mean the square root of all square-free naturals</p>",
        "id": 311005771,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668859115
    },
    {
        "content": "<p><del>But yes, I think a computable <code>quadratic_closure</code> is what I'm asking for</del></p>",
        "id": 311005846,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668859144
    },
    {
        "content": "<p>No, I think I want something weaker; the quadratic closure contains terms of the form <code>sqrt(1 + sqrt(q))</code>, right?</p>",
        "id": 311006263,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668859312
    },
    {
        "content": "<p>It contains all square roots of everything; there isn't a <code>sqrt</code> function though because most elements don't have a canonical square root (edit: I guess it's possible to define a \"random\" one though...)</p>",
        "id": 311008481,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1668860296
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/Error.3A.20missing.20'noncomputable'.20modifier/near/310912956\">said</a>:</p>\n<blockquote>\n<p>the hard part being that it blows right through <code>eq.rec</code> applications, leading to ill typed terms which nevertheless compute reasonably</p>\n</blockquote>\n<p>This reminds me of classical realizability (cf. Sect 3.1.2.1 <a href=\"https://www.irif.fr/~emiquey/these/Chapitre3.pdf\">here</a>).</p>",
        "id": 311009457,
        "sender_full_name": "Pedro Sánchez Terraf",
        "timestamp": 1668860758
    },
    {
        "content": "<p>Does mathlib have an algebraic numbers type?</p>",
        "id": 311190754,
        "sender_full_name": "Bolton Bailey",
        "timestamp": 1668982742
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/integral_closure\">docs#integral_closure</a><code> ℚ ℂ</code> or <a href=\"https://leanprover-community.github.io/mathlib_docs/find/algebraic_closure\">docs#algebraic_closure</a><code> ℚ</code>?</p>",
        "id": 311191920,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1668983735
    },
    {
        "content": "<p>Yeah, but neither is computable, which seems like the main appeal in the first place</p>",
        "id": 311192640,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668984366
    },
    {
        "content": "<p>THere's an obvious implementation with finsupp but... that wouldn't be computable either</p>",
        "id": 311192656,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668984382
    },
    {
        "content": "<p>The Langlands philosophy is all about representations of the automorphism group of the algebraic numbers and computability is definitely not the main appeal there :-)</p>",
        "id": 311194966,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1668986586
    },
    {
        "content": "<p>The context of my statement is an unstated claim that If we had a computable representation of these things then it would be easier to teach <code>norm_num</code> to normalize them</p>",
        "id": 311197331,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668988732
    },
    {
        "content": "<p>As I understand it, right now most of what <code>norm_num</code> does is construct <code>ℚ</code> representations of the numeric terms, compute with them in the vm to normalize them, and then construct proofs that the normalized version is equivalent</p>",
        "id": 311197351,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668988766
    },
    {
        "content": "<p>The moment you allow roots of polynomials you face the issue that polynomials have more than one root. For example you don't know <code>sqrt(a^2*b)=a*sqrt(b)</code>etc</p>",
        "id": 311228252,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1669015834
    },
    {
        "content": "<p>We could add the real closed field of algebraic numbers in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>. That's a pretty computable field. Although the decidable equality isn't very fast, I think.</p>",
        "id": 311228463,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1669015941
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/Error.3A.20missing.20'noncomputable'.20modifier/near/310980606\">said</a>:</p>\n<blockquote>\n<p>In other words, <code>norm_num</code> is a lot closer to a CAS than a calculator</p>\n</blockquote>\n<p>I see, and I also see the point that when proving things about the real numbers one generally wants something more like a CAS.  In principle I think some of this could also be incorporated into definitional equality also, but in any case it is useful to have both.</p>\n<p>The description of <code>norm_num</code> sounds a lot like a version of <code>simp</code> specialized to numbers.  How are they different?</p>",
        "id": 311443966,
        "sender_full_name": "Mike Shulman",
        "timestamp": 1669055911
    },
    {
        "content": "<p>They aren't so different. If <code>simp</code> had \"simp-procs\" we could potentially do <code>norm_num</code> transparently with it. <code>norm_num</code> also takes simp lemmas and uses <code>simp</code> as the main driver to rewrite inside terms. The main difference is that <code>norm_num</code> recognizes certain kinds of expressions (like <code>prime 37</code>) and uses customized numerical calculation methods on them rather than just blindly applying rewrite rules (of which there wouldn't be any in this case because primality is not a neatly recursive definition over the structure of the term).</p>",
        "id": 311465119,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1669060902
    },
    {
        "content": "<p>Mario, is my characterization that \"having a computable representation of integral closures would make dealing with real.sqrt in norm_num easier\" plausible?</p>",
        "id": 311466760,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1669061499
    },
    {
        "content": "<p>I think the foremost issue is to find some subset of expressions which have good theoretical properties (e.g. closure under interesting operations) and a normal form</p>",
        "id": 311470049,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1669062900
    },
    {
        "content": "<p>TBH I haven't looked into this very much. When you just adjoin one chosen square root, things are easy but when you have multiple it gets a lot harder and I'm not sure you have a compatible set of normal forms</p>",
        "id": 311470271,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1669062973
    },
    {
        "content": "<p>Maybe roots of unity can help? They form a \"canonical basis\" that generates a field that contains a lot of interesting algebraic numbers.</p>",
        "id": 311471141,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1669063322
    },
    {
        "content": "<p>Notice that Mathematica has <a href=\"https://reference.wolfram.com/language/ref/Root.html\"><code>Root[{f1,f2,…},{k1,k2,…}]</code></a> that could specify any finite extension of Q via iterated simple extensions; see also <a href=\"https://reference.wolfram.com/language/ref/AlgebraicNumber.html\">https://reference.wolfram.com/language/ref/AlgebraicNumber.html</a></p>",
        "id": 311472347,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1669063631
    }
]