[
    {
        "content": "<p><code>mathlib</code> has this definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[reducible]</span> <span class=\"kd\">def</span> <span class=\"n\">coprime</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span> <span class=\"n\">gcd</span> <span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span>\n</code></pre></div>\n<p>I have a goal state which is</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">h6</span> <span class=\"o\">:</span> <span class=\"n\">a.num.nat_abs.coprime</span> <span class=\"n\">a.denom</span><span class=\"o\">,</span>\n</code></pre></div>\n<p>I want to expand this definition into the <code>gcd</code> in the <code>coprime</code> definition.  I find myself writing a use-once lemma:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">lemma</span> <span class=\"n\">expand_coprime</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coprime</span> <span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">gcd</span> <span class=\"n\">m</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">exact</span> <span class=\"o\">(</span><span class=\"n\">rfl.congr</span> <span class=\"n\">rfl</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>I can then apply this lemma to expand <code>h6</code> into the <code>gcd</code> form of the underlying definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>    <span class=\"k\">have</span> <span class=\"n\">h8</span> <span class=\"o\">:=</span> <span class=\"n\">expand_coprime</span> <span class=\"n\">a.num.nat_abs</span> <span class=\"n\">a.denom</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">h9</span> <span class=\"o\">:=</span> <span class=\"n\">h8</span> <span class=\"n\">h6</span><span class=\"o\">,</span>\n</code></pre></div>\n<p>giving</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">h8</span><span class=\"o\">:</span> <span class=\"n\">a.num.nat_abs.coprime</span> <span class=\"n\">a.denom</span> <span class=\"bp\">→</span> <span class=\"n\">a.num.nat_abs.gcd</span> <span class=\"n\">a.denom</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span>\n<span class=\"n\">h9</span><span class=\"o\">:</span> <span class=\"n\">a.num.nat_abs.gcd</span> <span class=\"n\">a.denom</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span>\n</code></pre></div>\n<p>Is there a way to expand a given definition, without having to declare a lemma?</p>",
        "id": 222228803,
        "sender_full_name": "Lars Ericson",
        "timestamp": 1610295026
    },
    {
        "content": "<p>you can just do <code>unfold coprime at h6</code></p>",
        "id": 222228879,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1610295173
    },
    {
        "content": "<p>Or use <a href=\"https://leanprover-community.github.io/mathlib_docs/find/nat.coprime.gcd_eq_one\">docs#nat.coprime.gcd_eq_one</a></p>",
        "id": 222235998,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1610305873
    }
]