[
    {
        "content": "<p>Hi, when trying to build Lean4 from source I always get the same error: <code>/usr/bin/ld: cannot find -lleancpp</code> <br>\nDo you know how to fix this?</p>",
        "id": 232729029,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617269978
    },
    {
        "content": "<p>Can you share how you're compiling it and the full output</p>",
        "id": 232747344,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617279827
    },
    {
        "content": "<p>Yes, here it is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">aurelien</span><span class=\"bp\">@</span><span class=\"n\">pavilion15</span><span class=\"o\">:</span><span class=\"bp\">~/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">$</span> <span class=\"n\">make</span>\n<span class=\"o\">[</span>  <span class=\"mi\">6</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Performing</span> <span class=\"n\">build</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage0'</span>\n<span class=\"o\">[</span>  <span class=\"mi\">0</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">initialize</span>\n<span class=\"o\">[</span>  <span class=\"mi\">5</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">runtime</span>\n<span class=\"o\">[</span>  <span class=\"mi\">9</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">util</span>\n<span class=\"o\">[</span> <span class=\"mi\">13</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">kernel</span>\n<span class=\"o\">[</span> <span class=\"mi\">17</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">library</span>\n<span class=\"o\">[</span> <span class=\"mi\">18</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">constructions</span>\n<span class=\"o\">[</span> <span class=\"mi\">23</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">compiler</span>\n<span class=\"o\">[</span> <span class=\"mi\">23</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">leancpp</span>\n<span class=\"o\">[</span> <span class=\"mi\">27</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">leanruntime</span>\n<span class=\"o\">[</span> <span class=\"mi\">80</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">Lean</span>\n<span class=\"o\">[</span> <span class=\"mi\">84</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">Std</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">Init</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">shell</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">lean</span>\n<span class=\"o\">[</span> <span class=\"mi\">12</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">install</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage0'</span>\n<span class=\"o\">[</span> <span class=\"mi\">18</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Completed</span> <span class=\"bp\">'</span><span class=\"n\">stage0'</span>\n<span class=\"o\">[</span> <span class=\"mi\">50</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">stage0</span>\n<span class=\"o\">[</span> <span class=\"mi\">56</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Performing</span> <span class=\"n\">configure</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"c1\">-- No build type selected, default to Release</span>\n<span class=\"c1\">-- 64-bit machine detected</span>\n<span class=\"c1\">-- Using compressed object headers and only 32-bits for reference counter, this feature assume the OS only uses memory addresses &lt; 2^48</span>\n<span class=\"n\">CMake</span> <span class=\"n\">Warning</span> <span class=\"n\">at</span> <span class=\"n\">CMakeLists.txt</span><span class=\"o\">:</span><span class=\"mi\">295</span> <span class=\"o\">(</span><span class=\"n\">message</span><span class=\"o\">):</span>\n  <span class=\"n\">Failed</span> <span class=\"n\">to</span> <span class=\"n\">find</span> <span class=\"n\">ccache</span><span class=\"o\">,</span> <span class=\"n\">prepare</span> <span class=\"n\">for</span> <span class=\"n\">longer</span> <span class=\"n\">and</span> <span class=\"n\">redundant</span> <span class=\"n\">builds...</span>\n\n\n<span class=\"c1\">-- git commit sha1: 478dc9b05fd2d0c4a441bce552025cb0f70d15c5</span>\n<span class=\"c1\">-- Configuring done</span>\n<span class=\"c1\">-- Generating done</span>\n<span class=\"c1\">-- Build files have been written to: /home/aurelien/Documents/VU/mathport/lean4/build/release/stage1</span>\n<span class=\"o\">[</span> <span class=\"mi\">62</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Performing</span> <span class=\"n\">build</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Linking</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">leanpkg</span>\n<span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">ld</span><span class=\"o\">:</span> <span class=\"n\">cannot</span> <span class=\"n\">find</span> <span class=\"bp\">-</span><span class=\"n\">lleancpp</span>\n<span class=\"n\">collect2</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">ld</span> <span class=\"n\">returned</span> <span class=\"mi\">1</span> <span class=\"n\">exit</span> <span class=\"n\">status</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">7</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/../</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean.mk</span><span class=\"o\">:</span><span class=\"mi\">82</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">leanpkg</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">stdlib.make</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"o\">:</span> <span class=\"n\">stdlib</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib.dir</span><span class=\"bp\">/</span><span class=\"n\">build.make</span><span class=\"o\">:</span><span class=\"mi\">57</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">334</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib.dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">163</span><span class=\"o\">:</span> <span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">stage1.dir</span><span class=\"bp\">/</span><span class=\"n\">build.make</span><span class=\"o\">:</span><span class=\"mi\">113</span><span class=\"o\">:</span> <span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"kd\">prefix</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"n\">stamp</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"n\">build</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">218</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">stage1.dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">130</span><span class=\"o\">:</span> <span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n</code></pre></div>",
        "id": 232747800,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617280050
    },
    {
        "content": "<p>I've had to re-figure-out how to compile lean4 a few times the past month or so (though I'm not a C ecosystem expert by any means). <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> may be the best person to chime in (and hopefully doesn't mind the ping). But I'm reasonably sure from your output that what's gone wrong there has already happened before that point -- so I think you should blow away that directory, run cmake again, and run make and show that full output if you can. I'm recompiling myself at the minute to see what I do, but it's some combination of just manually setting LIBRARY_PATH and friends, mostly to do with me being on macOS though.</p>",
        "id": 232750920,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617281627
    },
    {
        "content": "<p>Yeah so my compilation just succeeded. For reference, what I had to do (which is probably nonidiomatic but at least works, and the other macOS trick for me is to ensure I'm in an arm64 terminal and not a rosetta'd one) is:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">Development</span><span class=\"bp\">/</span><span class=\"n\">lean4</span> <span class=\"n\">is</span> <span class=\"n\">a</span> <span class=\"n\">git</span> <span class=\"n\">repository</span> <span class=\"n\">on</span> <span class=\"n\">master</span>\n<span class=\"bp\">⊙</span>  <span class=\"n\">trash</span> <span class=\"n\">build</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">mkdir</span> <span class=\"bp\">-</span><span class=\"n\">p</span> <span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">cd</span> <span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">cmake</span> <span class=\"bp\">-</span><span class=\"n\">DCMAKE_PREFIX_PATH</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">homebrew</span><span class=\"bp\">/</span> <span class=\"bp\">-</span><span class=\"n\">DCMAKE_INSTALL_PREFIX</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">nightly</span><span class=\"bp\">/</span> <span class=\"bp\">-</span><span class=\"n\">DCMAKE_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">homebrew</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"bp\">../..</span> <span class=\"bp\">&amp;&amp;</span> <span class=\"n\">make</span> <span class=\"n\">LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">homebrew</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">Library</span><span class=\"bp\">/</span><span class=\"n\">Developer</span><span class=\"bp\">/</span><span class=\"n\">CommandLineTools</span><span class=\"bp\">/</span><span class=\"n\">SDKs</span><span class=\"bp\">/</span><span class=\"n\">MacOSX11.1.sdk</span><span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">C_INCLUDE_PATH</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">homebrew</span><span class=\"bp\">/</span><span class=\"kn\">include</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">Library</span><span class=\"bp\">/</span><span class=\"n\">Developer</span><span class=\"bp\">/</span><span class=\"n\">CommandLineTools</span><span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"kn\">include</span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">++/</span><span class=\"n\">v1</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">Library</span><span class=\"bp\">/</span><span class=\"n\">Developer</span><span class=\"bp\">/</span><span class=\"n\">CommandLineTools</span><span class=\"bp\">/</span><span class=\"n\">SDKs</span><span class=\"bp\">/</span><span class=\"n\">MacOSX.sdk</span><span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"kn\">include</span> <span class=\"n\">CPP_INCLUDE_PATH</span><span class=\"bp\">=/</span><span class=\"n\">opt</span><span class=\"bp\">/</span><span class=\"n\">homebrew</span><span class=\"bp\">/</span><span class=\"kn\">include</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">Library</span><span class=\"bp\">/</span><span class=\"n\">Developer</span><span class=\"bp\">/</span><span class=\"n\">CommandLineTools</span><span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"kn\">include</span><span class=\"bp\">/</span><span class=\"n\">c</span><span class=\"bp\">++/</span><span class=\"n\">v1</span><span class=\"o\">:</span><span class=\"bp\">/</span><span class=\"n\">Library</span><span class=\"bp\">/</span><span class=\"n\">Developer</span><span class=\"bp\">/</span><span class=\"n\">CommandLine</span> <span class=\"bp\">-</span><span class=\"n\">j4</span>\n</code></pre></div>\n<p>If you share the full command and output from a fresh build directory it may help. Also just in case you're unaware there are nightly builds you can just use at <a href=\"https://github.com/leanprover/lean4-nightly/releases\">https://github.com/leanprover/lean4-nightly/releases</a> -- I also should have asked what OS and architecture you're on a long time ago :D</p>",
        "id": 232754116,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617282952
    },
    {
        "content": "<p>Thank you for the help!<br>\nSo I'm working with Ubuntu 20.04, on a x86_64 architecture if that is what you are asking for.<br>\nThe nightly build works perfectly, but I am trying to use the <code>mathport</code> tool and I need to build Lean according to the instructions...</p>",
        "id": 232765421,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617287253
    },
    {
        "content": "<p>I have tried building it from scratch again and get stuck with the same error <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span><br>\nThe output is too long to be included but here is what I think are the relevant parts of it:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">[</span> <span class=\"mi\">43</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">install</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage0'</span>\n<span class=\"o\">[</span> <span class=\"mi\">50</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Completed</span> <span class=\"bp\">'</span><span class=\"n\">stage0'</span>\n<span class=\"o\">[</span> <span class=\"mi\">50</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">stage0</span>\n<span class=\"n\">Scanning</span> <span class=\"n\">dependencies</span> <span class=\"n\">of</span> <span class=\"n\">target</span> <span class=\"n\">stage1</span>\n<span class=\"o\">[</span> <span class=\"mi\">56</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Creating</span> <span class=\"n\">directories</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"o\">[</span> <span class=\"mi\">62</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">download</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"o\">[</span> <span class=\"mi\">68</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">patch</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"o\">[</span> <span class=\"mi\">75</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">update</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"o\">[</span> <span class=\"mi\">81</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Performing</span> <span class=\"n\">configure</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"c1\">-- The CXX compiler identification is GNU 9.3.0</span>\n<span class=\"c1\">-- The C compiler identification is GNU 9.3.0</span>\n<span class=\"c1\">-- Check for working CXX compiler: /usr/bin/c++</span>\n<span class=\"c1\">-- Check for working CXX compiler: /usr/bin/c++ -- works</span>\n<span class=\"c1\">-- Detecting CXX compiler ABI info</span>\n<span class=\"c1\">-- Detecting CXX compiler ABI info - done</span>\n<span class=\"c1\">-- Detecting CXX compile features</span>\n<span class=\"c1\">-- Detecting CXX compile features - done</span>\n<span class=\"c1\">-- Check for working C compiler: /usr/bin/cc</span>\n<span class=\"c1\">-- Check for working C compiler: /usr/bin/cc -- works</span>\n<span class=\"c1\">-- Detecting C compiler ABI info</span>\n<span class=\"c1\">-- Detecting C compiler ABI info - done</span>\n<span class=\"c1\">-- Detecting C compile features</span>\n<span class=\"c1\">-- Detecting C compile features - done</span>\n<span class=\"c1\">-- No build type selected, default to Release</span>\n<span class=\"c1\">-- 64-bit machine detected</span>\n<span class=\"c1\">-- Using compressed object headers and only 32-bits for reference counter, this feature assume the OS only uses memory addresses &lt; 2^48</span>\n<span class=\"c1\">-- Found GMP: /usr/include/x86_64-linux-gnu (Required is at least version \"5.0.5\")</span>\n<span class=\"n\">CMake</span> <span class=\"n\">Warning</span> <span class=\"n\">at</span> <span class=\"n\">CMakeLists.txt</span><span class=\"o\">:</span><span class=\"mi\">295</span> <span class=\"o\">(</span><span class=\"n\">message</span><span class=\"o\">):</span>\n  <span class=\"n\">Failed</span> <span class=\"n\">to</span> <span class=\"n\">find</span> <span class=\"n\">ccache</span><span class=\"o\">,</span> <span class=\"n\">prepare</span> <span class=\"n\">for</span> <span class=\"n\">longer</span> <span class=\"n\">and</span> <span class=\"n\">redundant</span> <span class=\"n\">builds...</span>\n\n\n<span class=\"c1\">-- Found PythonInterp: /usr/bin/python3.8 (found version \"3.8.5\")</span>\n<span class=\"c1\">-- git commit sha1: 478dc9b05fd2d0c4a441bce552025cb0f70d15c5</span>\n<span class=\"c1\">-- Configuring done</span>\n<span class=\"c1\">-- Generating done</span>\n<span class=\"c1\">-- Build files have been written to: /home/aurelien/Documents/VU/mathport/lean4/build/release/stage1</span>\n<span class=\"o\">[</span> <span class=\"mi\">87</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Performing</span> <span class=\"n\">build</span> <span class=\"n\">step</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">stage1'</span>\n<span class=\"n\">Scanning</span> <span class=\"n\">dependencies</span> <span class=\"n\">of</span> <span class=\"n\">target</span> <span class=\"n\">make_stdlib</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Prelude.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Notation.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Notation.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">SizeOf.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Init</span><span class=\"bp\">/</span><span class=\"n\">Core.lean</span>\n\n\n<span class=\"bp\">...</span>\n\n\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Toml.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Manifest.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Manifest.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Proc.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Proc.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Resolve.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Resolve.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">LeanVersion.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg</span><span class=\"bp\">/</span><span class=\"n\">Toml.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"n\">Leanpkg.lean</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Building</span> <span class=\"bp\">../</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">temp</span><span class=\"bp\">/</span><span class=\"n\">Leanpkg.c</span>\n<span class=\"o\">[</span>    <span class=\"o\">]</span> <span class=\"n\">Linking</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">leanpkg</span>\n<span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">ld</span><span class=\"o\">:</span> <span class=\"n\">cannot</span> <span class=\"n\">find</span> <span class=\"bp\">-</span><span class=\"n\">lleancpp</span>\n<span class=\"n\">collect2</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">ld</span> <span class=\"n\">returned</span> <span class=\"mi\">1</span> <span class=\"n\">exit</span> <span class=\"n\">status</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">7</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/../</span><span class=\"n\">share</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean.mk</span><span class=\"o\">:</span><span class=\"mi\">82</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">leanpkg</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">1</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">6</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">aurelien</span><span class=\"bp\">/</span><span class=\"n\">Documents</span><span class=\"bp\">/</span><span class=\"n\">VU</span><span class=\"bp\">/</span><span class=\"n\">mathport</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">/</span><span class=\"n\">stdlib.make</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"o\">:</span> <span class=\"n\">stdlib</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">5</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib.dir</span><span class=\"bp\">/</span><span class=\"n\">build.make</span><span class=\"o\">:</span><span class=\"mi\">57</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">4</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">334</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">make_stdlib.dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">3</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">163</span><span class=\"o\">:</span> <span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">stage1.dir</span><span class=\"bp\">/</span><span class=\"n\">build.make</span><span class=\"o\">:</span><span class=\"mi\">113</span><span class=\"o\">:</span> <span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"kd\">prefix</span><span class=\"bp\">/</span><span class=\"n\">src</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"n\">stamp</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">-</span><span class=\"n\">build</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">]:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">Makefile2</span><span class=\"o\">:</span><span class=\"mi\">218</span><span class=\"o\">:</span> <span class=\"n\">CMakeFiles</span><span class=\"bp\">/</span><span class=\"n\">stage1.dir</span><span class=\"bp\">/</span><span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"bp\">***</span> <span class=\"o\">[</span><span class=\"n\">Makefile</span><span class=\"o\">:</span><span class=\"mi\">130</span><span class=\"o\">:</span> <span class=\"n\">all</span><span class=\"o\">]</span> <span class=\"n\">Error</span> <span class=\"mi\">2</span>\n</code></pre></div>",
        "id": 232766317,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617287555
    },
    {
        "content": "<p>I think zulip elided that paste -- maybe a <a href=\"https://gist.github.com/\">https://gist.github.com/</a></p>",
        "id": 232769348,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617288581
    },
    {
        "content": "<p>And yeah ubuntu + x86_64 was what I was asking, thanks!</p>",
        "id": 232769380,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617288591
    },
    {
        "content": "<p>I've seen this error before, but it has always been solved by removing the build directory. Not sure what could go wrong otherwise.</p>",
        "id": 232772648,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617289708
    },
    {
        "content": "<p><a href=\"https://gist.github.com/AurelienSaue/c73da70938ce0604f828f4815d362eef\">https://gist.github.com/AurelienSaue/c73da70938ce0604f828f4815d362eef</a></p>",
        "id": 232775177,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617290379
    },
    {
        "content": "<p>I think I found the mistake. It was probably hidden for other people when they use <code>-j</code> for building</p>",
        "id": 232776780,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617290972
    },
    {
        "content": "<p>The fix is not trivial, so please use an appropriate <code>-j</code> or call <code>make -C stage1 leancpp</code> first</p>",
        "id": 232777208,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617291130
    },
    {
        "content": "<p>Ok, I went with the trivial fix after all since the should be no downsides in practice <a href=\"https://github.com/leanprover/lean4/pull/373\">https://github.com/leanprover/lean4/pull/373</a></p>",
        "id": 232781504,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617292746
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span>  How can/should I help on the mac+M1+homebrew side (lemme know if it's better to ask that elsewhere)? Presumably the ideal is that just running <code>cmake+make</code> should work on this setup same as others given it'll be the common one eventually, but I get a series of errors if I don't manually point things at the right places like in my example. Obviously understandable if it's not a priority at the minute</p>",
        "id": 232782709,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617293180
    },
    {
        "content": "<p>In particular I think nightlys for darwin used to be universal somehow? But now they aren't, they're x86_64 only, and won't run on arm (because they expect an x86_64 libgmp present, which users with native-only homebrew installs won't have)</p>",
        "id": 232782836,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617293240
    },
    {
        "content": "<p>I wouldn't know how to turn C++ code universal</p>",
        "id": 232783070,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617293328
    },
    {
        "content": "<p>I also don't know what the correct way to automatically set up those paths is</p>",
        "id": 232783207,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617293385
    },
    {
        "content": "<p>OK -- if I figure anything small out I presume a PR is welcome?</p>",
        "id": 232783341,
        "sender_full_name": "Julian Berman",
        "timestamp": 1617293428
    },
    {
        "content": "<p>sure!</p>",
        "id": 232784556,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1617293914
    },
    {
        "content": "<p>Just to let you know, it worked with the help of a <code>-j</code>. Thank you very much!</p>",
        "id": 232784826,
        "sender_full_name": "Aurélien Saue",
        "timestamp": 1617294043
    }
]