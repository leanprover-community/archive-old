[
    {
        "content": "<p>Hi everyone! I'm trying to adapt this proof </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[to_additive]</span>\n<span class=\"kd\">lemma</span> <span class=\"n\">coinduced_continuous</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">β</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">cont</span> <span class=\"n\">t</span> <span class=\"o\">(</span><span class=\"n\">coinduced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"n\">f</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">continuous_iff_coinduced_le</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"n\">le_Inf</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">rintros</span> <span class=\"n\">_</span> <span class=\"o\">⟨</span><span class=\"n\">t'</span><span class=\"o\">,</span> <span class=\"n\">ht'</span><span class=\"o\">,</span> <span class=\"n\">rfl</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">exact</span> <span class=\"n\">ht'</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>from <a href=\"http://topology.algebra.group\">topology.algebra.group</a>, to prove the corresponding lemma for induced topologies. That is, for a function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><mi>G</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">f : G \\to X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span> from a topological group to a topological space, we define <code>induced f</code> to be the coarsest group topology on G that is finer than the topology induced by f. In Lean, we define </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">induced</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">G</span> <span class=\"bp\">→</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"o\">:=</span>\n<span class=\"n\">Sup</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"bp\">|</span>  <span class=\"n\">a.to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)}</span>\n</code></pre></div>\n<p>The lemma I'm trying to prove is then</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">lemma</span> <span class=\"n\">induced_continuous</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">G</span> <span class=\"bp\">→</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">cont</span> <span class=\"o\">(</span><span class=\"n\">induced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"n\">t</span> <span class=\"n\">f</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Now, the proof of coinduced_continuous begins with </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">rw</span> <span class=\"n\">continuous_iff_coinduced_le</span>\n</code></pre></div>\n<p>so I begin my proof with </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">rw</span> <span class=\"n\">continuous_iff_le_induced</span>\n</code></pre></div>\n<p>and this gives me a goal  of the form </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">induced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span>\n</code></pre></div>\n<p>The second line of the proof of coinduced_continuous is <code>refine le_Inf _</code>. I don't understand exactly what the refine tactic does, but I think I understand roughly what it is doing in this case. That is, we need to show that </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">topological_space.coinduced</span> <span class=\"n\">f</span> <span class=\"n\">t</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">coinduced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span>\n</code></pre></div>\n<p>and the right hand side is the infinum of the set of group topologies coarser than the coinduced topology. Therefore, the theorem le_Inf tells us that it suffices to check that <code>topological_space.coinduced f t</code> is finer than every such group topology, and <code>refine le_Inf _,</code> makes that our goal. </p>\n<p>By almost exactly the same reasoning, I am trying to use <code>refine Sup_le _</code> to change the goal </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">induced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span>\n</code></pre></div>\n<p>However, when I try to do this, I get the error </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">invalid</span> <span class=\"n\">type</span> <span class=\"n\">ascription</span><span class=\"o\">,</span> <span class=\"n\">term</span> <span class=\"n\">has</span> <span class=\"n\">type</span>\n  <span class=\"n\">Sup</span> <span class=\"bp\">?</span><span class=\"n\">m_3</span> <span class=\"bp\">≤</span> <span class=\"bp\">?</span><span class=\"n\">m_4</span>\n<span class=\"n\">but</span> <span class=\"n\">is</span> <span class=\"n\">expected</span> <span class=\"n\">to</span> <span class=\"k\">have</span> <span class=\"n\">type</span>\n  <span class=\"o\">(</span><span class=\"n\">induced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span>\n</code></pre></div>\n<p>I don't understand why the tactic works in one case an not the other. They look exactly the same to me (modulo swapping Sup with Inf and greater with less). Any help would be much appreciated.</p>",
        "id": 264773962,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639431771
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"460212\">@Sebastian Monnet</span> First, can you try to present your future questions to include a minimal working example, <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> ?  It took me some time to construct one from your question:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">topology.algebra.group</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">induced</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">G</span> <span class=\"bp\">→</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"o\">:=</span>\n<span class=\"n\">Sup</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"bp\">|</span>  <span class=\"n\">a.to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)}</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">induced_continuous</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">G</span> <span class=\"bp\">→</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">@</span><span class=\"n\">continuous</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">induced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"n\">t</span> <span class=\"n\">f</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">continuous_iff_le_induced</span><span class=\"o\">,</span>\n\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 264775710,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639432642
    },
    {
        "content": "<p>I believe the error here is that <code>topological_space.induced f t</code> is not of type <code>group_topology G</code>, it's of type <code>topological_space G</code>.</p>",
        "id": 264775822,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639432683
    },
    {
        "content": "<p>Maybe something like this will work (if in fact it's true):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">continuous_iff_le_induced</span><span class=\"o\">,</span>\n  <span class=\"n\">convert</span> <span class=\"bp\">@</span><span class=\"n\">Sup_le</span> <span class=\"o\">(</span><span class=\"n\">topological_space</span> <span class=\"n\">G</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">group_topology.to_topological_space</span> <span class=\"bp\">''</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"bp\">|</span>  <span class=\"n\">a.to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)})</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 264776593,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639432940
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> Sorry about the lack of minimal working example - I will include one next time. Thank you for your answer. I agree that it seems like the type inconsistency is the problem, since <code>induced f</code> is the supremum of a set of type <code>group_topology G</code>, and we are trying to compare topological spaces. In light of this, though, I can't understand why the second line of the proof  of <code>coinduced_continuous</code> works. Shouldn't that fail for exactly the same reason?</p>",
        "id": 264777616,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639433391
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"460212\">@Sebastian Monnet</span> At a guess, it may be because <a href=\"https://leanprover-community.github.io/mathlib_docs/find/group_topology.complete_lattice\">docs#group_topology.complete_lattice</a>, the complete lattice structure on <code>group_topology G</code>, has been constructed using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/complete_lattice_of_complete_semilattice_Inf\">docs#complete_lattice_of_complete_semilattice_Inf</a>, which according to its docstring has bad definitional properties for the <code>Sup</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">Any `complete_semilattice_Inf` is in fact a `complete_lattice`.</span>\n\n<span class=\"sd\">Note that this construction has bad definitional properties:</span>\n<span class=\"sd\">see the doc-string on `complete_lattice_of_Inf`.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kd\">def</span> <span class=\"n\">complete_lattice_of_complete_semilattice_Inf</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">complete_semilattice_Inf</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"n\">complete_lattice</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"n\">complete_lattice_of_Inf</span> <span class=\"n\">α</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">is_glb_Inf</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 264787431,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639439171
    },
    {
        "content": "<p>In particular, this would account for the asymmetry in the behaviour of <code>Sup</code> and <code>Inf</code> for this complete lattice.</p>",
        "id": 264787466,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639439205
    },
    {
        "content": "<p>It seems that the construction is due to <span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span>, in <a href=\"https://github.com/leanprover-community/mathlib/pull/10531\">#10531</a>, so we could ask her about the design decision and whether it would be sensible to rewrite the complete lattice instance so it constructs the <code>Sup</code> directly.</p>",
        "id": 264787637,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1639439326
    },
    {
        "content": "<p>There should be a Galois insertion between group topologies and topologies. I think the lattice structure would be better behaved if it was defined via such a Galois connection.</p>",
        "id": 264788223,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1639439757
    },
    {
        "content": "<p>I think that only produces nice equalities if you implement <code>galois_insertion.choice</code> by hand</p>",
        "id": 264826637,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1639471678
    },
    {
        "content": "<p>The default implementation doesn't make very nice equalities either</p>",
        "id": 264826702,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1639471697
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264776593\">said</a>:</p>\n<blockquote>\n<p>Maybe something like this will work (if in fact it's true):</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">continuous_iff_le_induced</span><span class=\"o\">,</span>\n  <span class=\"n\">convert</span> <span class=\"bp\">@</span><span class=\"n\">Sup_le</span> <span class=\"o\">(</span><span class=\"n\">topological_space</span> <span class=\"n\">G</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">group_topology.to_topological_space</span> <span class=\"bp\">''</span> <span class=\"o\">{</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"bp\">|</span>  <span class=\"n\">a.to_topological_space</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)})</span> <span class=\"o\">(</span><span class=\"n\">topological_space.induced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n\n<span class=\"kd\">end</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I don't think this is true; taking the <code>Sup</code> as topological spaces might not give you the correct topology.<br>\nThe problem is that the intersection of two group topologies <code>t</code> and <code>t'</code> is not always a group topology; one defines the <code>sup</code> of <code>t</code> and <code>t'</code> as the finest group topology contained in their intersection. Would it help to make this field (and <code>Sup</code>) explicit in the definition of this complete lattice?</p>",
        "id": 264826731,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639471715
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> okay, thank you!</p>",
        "id": 264841912,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639480528
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> you've helped me out of holes like this before -- do you know a trick here? The maths: if G is a group then there's a lattice of topologies on G (well-known) and a sublattice of topologies which happen to make G into a topological group. Maria proved the sublattice has all Sups and Infs, and Infs can be computed in the larger lattice (but Sups cannot; we have explicit counterexamples). How do we get a Galois insertion or coinsertion and does it help?</p>",
        "id": 264842211,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1639480729
    },
    {
        "content": "<p>Edit: I guess the point is that the infinum is computed in the larger lattice. Is that why my attempt to dualise your proof didn't work?</p>\n<p><span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> would you mind explaining how the second line of your proof works? We have <code>le_Inf : (∀b∈s, a ≤ b) → a ≤ Inf s</code>, where <code>α</code> is a complete semilattice, <code>s : set α</code>, and <code>a : α</code>. Your proof seems to take <code>a</code> to be <code>topological_space.coinduced f t</code> and <code>s</code> to be the set of topological spaces underlying group topologies coarser than <code>a</code>.  My problem is that <code>a</code> is a topology, not a group topology, but the infinum in the definition of <code>coinduced f</code> is taken in the complete lattice of group topologies, so I don't understand how we can apply the theorem. </p>\n<p>It seems to me conceivable that the infinum of group topologies greater than or equal to <code>topological_space.coinduced f t</code> is not itself greater than or equal to <code>topological_space.coinduced f t</code>. I am convinced that this is not the case, but only because I've worked through the maths myself - I don't understand why Lean is happy with this step. </p>\n<p>Not sure if I need to include a mwe with this sort of question, but here is one just in case:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">tactic</span>\n<span class=\"kn\">import</span> <span class=\"n\">topology.algebra.group</span>\n<span class=\"kn\">import</span> <span class=\"n\">data.set.basic</span>\n\n<span class=\"kn\">local</span> <span class=\"kd\">notation</span> <span class=\"bp\">`</span><span class=\"n\">cont</span><span class=\"bp\">`</span> <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">continuous</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n\n\n<span class=\"sd\">/-- If f : X → G is a function from a topolgoical space to a group, then `coinduced f` is the finest group topology on G such that f is continuous.-/</span>\n<span class=\"kd\">def</span> <span class=\"n\">coinduced</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"n\">G</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"bp\">→</span> <span class=\"n\">G</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"o\">:=</span>\n<span class=\"n\">Inf</span> <span class=\"o\">{</span><span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">group_topology</span> <span class=\"n\">G</span> <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">topological_space.coinduced</span> <span class=\"n\">f</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"n\">b.to_topological_space</span><span class=\"o\">}</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">coinduced_continuous</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"n\">G</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"bp\">→</span> <span class=\"n\">G</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">cont</span> <span class=\"n\">t</span> <span class=\"o\">(</span><span class=\"n\">coinduced</span> <span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"n\">f</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">rw</span> <span class=\"n\">continuous_iff_coinduced_le</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"n\">le_Inf</span> <span class=\"n\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">rintros</span> <span class=\"n\">_</span> <span class=\"o\">⟨</span><span class=\"n\">t'</span><span class=\"o\">,</span> <span class=\"n\">ht'</span><span class=\"o\">,</span> <span class=\"n\">rfl</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">exact</span> <span class=\"n\">ht'</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 264859123,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639489666
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264842211\">said</a>:</p>\n<blockquote>\n<p>Maria proved the sublattice has all Sups and Infs, and Infs can be computed in the larger lattice (but Sups cannot; we have explicit counterexamples).</p>\n</blockquote>\n<p>It might be worth adding a comment somewhere (maybe on <code>instance [group γ] : complete_semilattice_Inf (group_topology γ)</code> that explicitly says that sups cannot be computed in the original lattice, since it wasn't very clear to me one way or another; I guess the formation of the product topology doesn't play well with sups?</p>",
        "id": 264878622,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639497445
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"460212\">@Sebastian Monnet</span> Not only can the Inf be computed in the larger lattice, if you look at<br>\n<a href=\"https://github.com/leanprover-community/mathlib/blob/1367c19b1b5d53ec699e4003f7aaa40a8099a643/src/topology/algebra/group.lean#L860-L862\">https://github.com/leanprover-community/mathlib/blob/1367c19b1b5d53ec699e4003f7aaa40a8099a643/src/topology/algebra/group.lean#L860-L862</a><br>\nyou will see that it is actually defined that way (and then one has to check that it really is an infimum).</p>",
        "id": 264878884,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639497533
    },
    {
        "content": "<p>So I think the conclusion is that the lemma you were originally trying to prove is actually false, because <code>X</code> could be <code>G</code> with one of these topologies that is a sup of group topologies but isn't a group topology.</p>",
        "id": 264879595,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639497730
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"460212\">@Sebastian Monnet</span> , the <code>coinduced</code> version works because in that case <code>Inf(...).to_topological_spaces</code> is equal to the <code>Inf</code> as topological spaces by definition. That is,</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">topology.algebra.group</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">group_topology</span> <span class=\"n\">G</span><span class=\"o\">))</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">Inf</span> <span class=\"n\">S</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"bp\">=</span> <span class=\"n\">Inf</span> <span class=\"o\">(</span><span class=\"n\">group_topology.to_topological_space</span> <span class=\"bp\">''</span> <span class=\"n\">S</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n</code></pre></div>\n<p>But this isn't true for the <code>Sup</code>.</p>",
        "id": 264883453,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639499132
    },
    {
        "content": "<p>María Inés showed me a counterexample to the sup thing. I don't remember the details but if memory served the counterexample was $A=\\R^2$ as an additive abelian group in the usual way, and with the two topologies being maybe the order topology coming from the two total orders <code>lex</code> and <code>lex \\circ swap</code>.</p>",
        "id": 264884008,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1639499350
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264878622\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264842211\">said</a>:</p>\n<blockquote>\n<p>Maria proved the sublattice has all Sups and Infs, and Infs can be computed in the larger lattice (but Sups cannot; we have explicit counterexamples).</p>\n</blockquote>\n<p>It might be worth adding a comment somewhere (maybe on <code>instance [group γ] : complete_semilattice_Inf (group_topology γ)</code> that explicitly says that sups cannot be computed in the original lattice, since it wasn't very clear to me one way or another; I guess the formation of the product topology doesn't play well with sups?</p>\n</blockquote>\n<p>I was trying to say this with the comment <code>The supremum of two group topologies s and t is the infimum of the family of all group topologies contained in the intersection of s and t.</code> But I would be very happy to change this to a clearer comment.</p>",
        "id": 264884278,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639499459
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> do you remember the details of the counterexample? I think it's an interesting one.</p>",
        "id": 264884326,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1639499478
    },
    {
        "content": "<p>I wonder if there is some kind of universal object lurking</p>",
        "id": 264884410,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1639499508
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"406490\">María Inés de Frutos Fernández</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264884278\">said</a>:</p>\n<blockquote>\n<p>I was trying to say this with the comment <code>The supremum of two group topologies s and t is the infimum of the family of all group topologies contained in the intersection of s and t.</code> But I would be very happy to change this to a clearer comment.</p>\n</blockquote>\n<p>Right but this doesn't explicitly tell the reader that it sometimes <em>isn't</em> equal to the sup of underlying topologies--maybe you just didn't know or didn't care.</p>",
        "id": 264885008,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639499726
    },
    {
        "content": "<p>Yes, it's what you're describing - consider $R^2$ with the two lexicographical orders (which define two group topologies on $R^2$), and then look at a \"Maltese cross\" (say centered at 0)  in the intersection topology. This is open, but it doesn't contain <code>U + U</code> for any open neighborhood of 0.</p>",
        "id": 264885125,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639499765
    },
    {
        "content": "<p><code>In general, it may not be equal to the supremum of s and t as topologies.</code>--or something like that</p>",
        "id": 264885159,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639499777
    },
    {
        "content": "<p>I'll see if I can find the reference for this counterexample and post it here.</p>",
        "id": 264885315,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639499827
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264885159\">said</a>:</p>\n<blockquote>\n<p><code>In general, it may not be equal to the supremum of s and t as topologies.</code>--or something like that</p>\n</blockquote>\n<p>I see your point, I should have made this more explicit.</p>",
        "id": 264885661,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639499949
    },
    {
        "content": "<p><code>Note that it may be coarser than the supremum of s and t as topologies</code>?</p>",
        "id": 264885849,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639500023
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"406490\">María Inés de Frutos Fernández</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264885315\">said</a>:</p>\n<blockquote>\n<p>I'll see if I can find the reference for this counterexample and post it here.</p>\n</blockquote>\n<p>See page 166 of Pierre Samuel's \"Ultrafilters and compactification of uniform spaces\":<br>\n<a href=\"https://www.ams.org/journals/tran/1948-064-01/S0002-9947-1948-0025717-6/S0002-9947-1948-0025717-6.pdf\">https://www.ams.org/journals/tran/1948-064-01/S0002-9947-1948-0025717-6/S0002-9947-1948-0025717-6.pdf</a></p>",
        "id": 264896044,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639503675
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110032\">Reid Barton</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264879595\">said</a>:</p>\n<blockquote>\n<p>So I think the conclusion is that the lemma you were originally trying to prove is actually false, because <code>X</code> could be <code>G</code> with one of these topologies that is a sup of group topologies but isn't a group topology.</p>\n</blockquote>\n<p>Would you mind explaining why you think the original lemma is false? It seems to me that taking such an X just means that the supremum does not equal X. I don't think that prevents the supremum from being in the set.</p>",
        "id": 264900091,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639505079
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"406490\">María Inés de Frutos Fernández</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264883453\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"460212\">Sebastian Monnet</span> , the <code>coinduced</code> version works because in that case <code>Inf(...).to_topological_spaces</code> is equal to the <code>Inf</code> as topological spaces by definition. That is,</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">topology.algebra.group</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">{</span><span class=\"n\">G</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">group_topology</span> <span class=\"n\">G</span><span class=\"o\">))</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">Inf</span> <span class=\"n\">S</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_topological_space</span> <span class=\"bp\">=</span> <span class=\"n\">Inf</span> <span class=\"o\">(</span><span class=\"n\">group_topology.to_topological_space</span> <span class=\"bp\">''</span> <span class=\"n\">S</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n</code></pre></div>\n<p>But this isn't true for the <code>Sup</code>.</p>\n</blockquote>\n<p>I added this <code>example</code> as a lemma in <a href=\"https://github.com/leanprover-community/mathlib/pull/10792\">#10792</a></p>",
        "id": 264903438,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1639506650
    },
    {
        "content": "<p>There's a complete lattice of topologies on <code>G</code>, and a subset of those that are the group topologies which apparently is closed under infs but not sups. That means there is a \"(group topology)-ification\" operation L which takes a topology T to the inf of all the group topologies bigger than T. In general we have T &lt;= L(T) and the fixed points of L are the group topologies. We can compute sups in group topologies by computing sups of the underlying topologies and then applying L. In particular the sup in group topologies is always bigger than the sup of underlying topologies.</p>\n<p>Now consider your lemma <code>induced_continuous</code> in the case <code>X = G</code> and <code>f = id</code>, and suppose <code>t</code> is a non-group topology which is a sup of two group topologies, say <code>t1</code> and <code>t2</code>. Then the <code>induced</code> group topology is bigger than both <code>t1</code> and <code>t2</code>, so it has to be at least the sup in group topologies of <code>t1</code> and <code>t2</code>, which is strictly bigger than <code>t</code> (otherwise <code>t</code> would be a group topology). And then the inequality <code>(induced id).to_topological_space &lt;= t</code> doesn't hold, so <code>f</code> is not continuous.</p>",
        "id": 264904073,
        "sender_full_name": "Reid Barton",
        "timestamp": 1639506924
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110032\">@Reid Barton</span> <br>\nThank you, I'm convinced!</p>",
        "id": 264905536,
        "sender_full_name": "Sebastian Monnet",
        "timestamp": 1639507398
    },
    {
        "content": "<p>Wait, when <code>( induced id).to_topological_space</code> is finer than <code>t</code>, then id : (G, (induced id).to_topological_space) \\to (G,  t). is continuous (since there are more open sets on the left).</p>",
        "id": 264906370,
        "sender_full_name": "María Inés de Frutos Fernández",
        "timestamp": 1639507686
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113489-new-members/topic/Trying.20to.20prove.20a.20lemma.20about.20group.20topologies/near/264903438\">said</a>:</p>\n<blockquote>\n<p>I added this <code>example</code> as a lemma in <a href=\"https://github.com/leanprover-community/mathlib/pull/10792\">#10792</a></p>\n</blockquote>\n<p>and was sniped into also added the corresponding lemmas for inf, top, and bot...</p>",
        "id": 264920784,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1639513844
    }
]