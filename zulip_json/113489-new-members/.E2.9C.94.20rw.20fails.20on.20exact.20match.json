[
    {
        "content": "<p>I'm having some trouble with <code>rw</code> and I'm going to paste my full proof state to illustrate.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">rewrite</span> <span class=\"n\">tactic</span> <span class=\"n\">failed</span><span class=\"o\">,</span> <span class=\"n\">did</span> <span class=\"n\">not</span> <span class=\"n\">find</span> <span class=\"kd\">instance</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">pattern</span> <span class=\"k\">in</span> <span class=\"n\">the</span> <span class=\"n\">target</span> <span class=\"n\">expression</span>\n  <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">k</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"bp\">∧</span> <span class=\"n\">s</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span>\n<span class=\"n\">state</span><span class=\"o\">:</span>\n<span class=\"n\">M_states</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span>\n<span class=\"n\">hM_states</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">M_states</span><span class=\"o\">,</span>\n<span class=\"n\">γ</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">,</span>\n<span class=\"n\">hγ</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">γ</span> <span class=\"bp\">∧</span> <span class=\"n\">γ</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n<span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span><span class=\"o\">,</span>\n<span class=\"n\">hv</span> <span class=\"o\">:</span> <span class=\"n\">is_value_func</span> <span class=\"n\">v</span> <span class=\"n\">M_states</span> <span class=\"mi\">2</span> <span class=\"n\">hM_states</span> <span class=\"n\">two_pos</span> <span class=\"n\">γ</span> <span class=\"n\">hγ</span> <span class=\"n\">π₁</span> <span class=\"o\">(</span><span class=\"n\">pd</span> <span class=\"n\">M_states</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">pr</span> <span class=\"n\">M_states</span><span class=\"o\">),</span>\n<span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span>\n<span class=\"n\">hv2</span> <span class=\"o\">:</span>\n  <span class=\"n\">v</span> <span class=\"n\">s</span> <span class=\"bp\">=</span>\n    <span class=\"bp\">∑</span> <span class=\"o\">(</span><span class=\"n\">s'</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"k\">in</span>\n      <span class=\"n\">finset.range</span> <span class=\"n\">M_states</span><span class=\"o\">,</span>\n      <span class=\"n\">pd</span> <span class=\"n\">M_states</span> <span class=\"mi\">0</span> <span class=\"n\">s</span> <span class=\"n\">s'</span> <span class=\"bp\">*</span> <span class=\"bp\">∑'</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">pr</span> <span class=\"n\">M_states</span> <span class=\"mi\">0</span> <span class=\"n\">s</span> <span class=\"n\">r</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">+</span> <span class=\"n\">γ</span> <span class=\"bp\">*</span> <span class=\"n\">v</span> <span class=\"n\">s'</span><span class=\"o\">),</span>\n<span class=\"n\">k</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span>\n<span class=\"n\">hk</span> <span class=\"o\">:</span> <span class=\"n\">k</span> <span class=\"bp\">≠</span> <span class=\"n\">min</span> <span class=\"o\">(</span><span class=\"n\">M_states</span> <span class=\"bp\">-</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">),</span>\n<span class=\"n\">hasdf2</span> <span class=\"o\">:</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">k</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"bp\">∧</span> <span class=\"n\">s</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span>\n<span class=\"bp\">⊢</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">M_states</span> <span class=\"bp\">∧</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"n\">M_states</span><span class=\"o\">)</span> <span class=\"mi\">1</span>\n        <span class=\"o\">(</span><span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">k</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span> <span class=\"bp\">∧</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"bp\">∧</span> <span class=\"mi\">0</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">k</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span> <span class=\"bp\">∧</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">k</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"bp\">∧</span> <span class=\"n\">s</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span><span class=\"o\">)))</span> <span class=\"bp\">*</span>\n      <span class=\"bp\">∑'</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">pr</span> <span class=\"n\">M_states</span> <span class=\"mi\">0</span> <span class=\"n\">s</span> <span class=\"n\">r</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"bp\">↑</span><span class=\"n\">r</span> <span class=\"bp\">+</span> <span class=\"n\">γ</span> <span class=\"bp\">*</span> <span class=\"n\">v</span> <span class=\"n\">k</span><span class=\"o\">)</span> <span class=\"bp\">=</span>\n    <span class=\"mi\">0</span>\n</code></pre></div>\n<p>I expected <code>rw hasdf2</code> to replace <code>ite (k = 0 ∧ s + 1 = 0) 1 0</code> with 0, but it fails. Why is that and how can I fix it? Ultimately I want to show that goal is true but there doesn't seem to be a way to do it besides working backwards through the <code>ite</code> chain (which isn't working either at the moment).</p>",
        "id": 311160344,
        "sender_full_name": "King Crawford",
        "timestamp": 1668962295
    },
    {
        "content": "<p>Are you sure all of the <code>0</code>s and <code>1</code>s involved are of the correct types? That would be the simplest explanation for why it wouldn't work.</p>",
        "id": 311160611,
        "sender_full_name": "Reid Barton",
        "timestamp": 1668962452
    },
    {
        "content": "<p>That was the problem. Thanks!</p>",
        "id": 311160754,
        "sender_full_name": "King Crawford",
        "timestamp": 1668962534
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"528143\">King Crawford</span> has marked this topic as resolved.</p>",
        "id": 311161017,
        "sender_full_name": "Notification Bot",
        "timestamp": 1668962675
    }
]