[
    {
        "content": "<p>Did I set this up right? I'm having some trouble proving it.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c1\">-- Types and Programming Languages Kindle Edition by Benjamin C. Pierce (Author) Format: Kindle Edition</span>\n<span class=\"c1\">-- Theorem 3.3.4</span>\n\n<span class=\"kd\">inductive</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n  <span class=\"bp\">|</span> <span class=\"n\">true</span>\n  <span class=\"bp\">|</span> <span class=\"n\">false</span>\n  <span class=\"bp\">|</span> <span class=\"n\">zero</span>\n  <span class=\"bp\">|</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t2</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n\n\n<span class=\"kd\">def</span> <span class=\"n\">size</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">nat</span>\n  <span class=\"bp\">|</span> <span class=\"n\">term.true</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"n\">term.false</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"n\">term.zero</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">term.succ</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">term.pred</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">term.iszero</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">term.ite</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t2</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n\n\n<span class=\"c1\">-- principle of complete mathematical induction</span>\n<span class=\"kd\">axiom</span> <span class=\"n\">PCI</span> <span class=\"o\">:</span>\n<span class=\"k\">forall</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">-&gt;</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span>\n<span class=\"k\">forall</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n\n\n<span class=\"c1\">-- induction on size</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">IOS</span> <span class=\"o\">:</span>\n<span class=\"k\">forall</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span>\n<span class=\"k\">forall</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n<span class=\"n\">intros</span> <span class=\"n\">P</span><span class=\"o\">,</span>\n<span class=\"k\">let</span> <span class=\"n\">Q</span> <span class=\"o\">:=</span> <span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"k\">forall</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">,</span>\n<span class=\"k\">have</span> <span class=\"n\">s1</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">Q</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">Q</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"k\">forall</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">Q</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">PCI</span> <span class=\"n\">Q</span><span class=\"o\">,</span>\n<span class=\"gr\">sorry</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 253182932,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631580920
    },
    {
        "content": "<p>here's a more leanified version, and a good start on the problem. I removed the definition <code>Q</code> because it obscures more than it helps in this proof.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c1\">-- principle of complete mathematical induction</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"n\">nat.strong_induction_on</span> <span class=\"n\">n</span> <span class=\"n\">H</span>\n\n<span class=\"c1\">-- induction on size</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">IOS</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">refine</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">t</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n  <span class=\"n\">dsimp</span> <span class=\"n\">only</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">m</span> <span class=\"n\">ih</span> <span class=\"n\">s</span> <span class=\"n\">e</span><span class=\"o\">,</span>\n  <span class=\"gr\">sorry</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 253184410,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631582243
    },
    {
        "content": "<p>What is the <code>refine</code> tactic doing?</p>",
        "id": 253185243,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631583023
    },
    {
        "content": "<p>It is like <code>exact</code>, but you can leave some holes using <code>_</code>. If Lean can't figure out what to put in place of those <code>_</code>, it doesn't throw an error, but creates a new goal instead.</p>",
        "id": 253185651,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1631583402
    },
    {
        "content": "<p>So is everything after PCI in that line, the hypotheses to PCI?</p>",
        "id": 253185789,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631583562
    },
    {
        "content": "<p>yup</p>",
        "id": 253185986,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1631583730
    },
    {
        "content": "<p>Where do the <code>t</code> and the <code>rfl</code> line up?</p>",
        "id": 253186556,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631584337
    },
    {
        "content": "<p><code>PCI</code> has three arguments, but the result is <code>P n</code>, and since in this case we substituted <code>λ (n : nat), ∀ s : term, size s = n → P s</code> for <code>P</code>, the result after substituting the first three arguments is <code>∀ s : term, size s = ?n → P s</code> and we have space to add two more arguments</p>",
        "id": 253186884,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631584708
    },
    {
        "content": "<p>here's a more broken down version of the first line:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">),</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">size</span> <span class=\"n\">t</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n    <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t</span><span class=\"o\">),</span>\n  <span class=\"n\">refine</span> <span class=\"n\">this</span> <span class=\"n\">t</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n</code></pre></div>",
        "id": 253187072,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631584854
    },
    {
        "content": "<p>I see. Thank you.</p>",
        "id": 253187213,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631584959
    },
    {
        "content": "<p>Thank you!</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c1\">-- induction on size</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">IOS</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">refine</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">t</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n  <span class=\"n\">dsimp</span> <span class=\"n\">only</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">m</span> <span class=\"n\">ih</span> <span class=\"n\">s</span> <span class=\"n\">e</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">H</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">r</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"o\">(</span><span class=\"n\">ih</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">r</span><span class=\"o\">)),</span>\n  <span class=\"n\">rw</span> <span class=\"bp\">&lt;-</span> <span class=\"n\">e</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">refl</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 253188121,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631585958
    },
    {
        "content": "<p>Good job. Now, the cheating way:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">theorem</span> <span class=\"n\">IOS</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">measure_wf</span> <span class=\"n\">size</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">induction</span> <span class=\"n\">t</span> <span class=\"n\">H</span>\n</code></pre></div>",
        "id": 253190318,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631588236
    },
    {
        "content": "<p>(There are even more cheating ways when you notice that <code>size</code> is the same as <code>term.sizeof</code>, and indeed this particular theorem is applied automatically by lean when you write functions by well founded recursion using the equation compiler.)</p>",
        "id": 253190427,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631588336
    },
    {
        "content": "<p>here's a golfy proof more similar to yours:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">theorem</span> <span class=\"n\">IOS</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">refine</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"n\">t</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n  <span class=\"n\">rintro</span> <span class=\"n\">m</span> <span class=\"n\">ih</span> <span class=\"n\">s</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n  <span class=\"n\">refine</span> <span class=\"n\">H</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">r</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">ih</span> <span class=\"n\">_</span> <span class=\"n\">h</span> <span class=\"n\">r</span> <span class=\"n\">rfl</span><span class=\"o\">),</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 253190875,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631588692
    },
    {
        "content": "<p>The book defines structural induction as:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">If</span><span class=\"o\">,</span> <span class=\"n\">for</span> <span class=\"n\">each</span> <span class=\"n\">term</span> <span class=\"n\">s</span><span class=\"o\">,</span>\n<span class=\"n\">given</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"n\">for</span> <span class=\"n\">all</span> <span class=\"n\">immediate</span> <span class=\"n\">subterms</span> <span class=\"n\">r</span> <span class=\"n\">of</span> <span class=\"n\">s</span> <span class=\"n\">we</span> <span class=\"n\">can</span> <span class=\"k\">show</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">),</span>\n<span class=\"k\">then</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">holds</span> <span class=\"n\">for</span> <span class=\"n\">all</span> <span class=\"n\">s.</span>\n</code></pre></div>\n<p>How does one formalize this and show that it follows from weak mathematical induction? Do I define a function <code>is_immediate_subterm : term -&gt; term -&gt; Prop</code> and then:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">forall</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">is_immediate_subterm</span> <span class=\"n\">r</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span>\n<span class=\"k\">forall</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">t</span>\n</code></pre></div>\n<p>Also, I'm not sure how to go about defining a function <code>f : term -&gt; nat</code> such that <code>f s = (f r) + 1 iff (is_immediate_subterm r s)</code> to use to show that it follows from weak mathematical induction, if that is what I need to do.</p>",
        "id": 253875476,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631978809
    },
    {
        "content": "<p>There might be an even more primitive way of doing this in mathlib, but in core this is done with <a href=\"https://github.com/leanprover-community/lean/blob/master/library/init/wf.lean\">acc</a> and its recursor, then <code>measure_wf</code>, and <code>sizeof_measure_wf</code>, which are other helper functions/lemmas in that file. <code>sizeof</code> is automatically generated for inductives, I think the general rule is just that <code>forall a, sizeof(ctor(a)) = sizeof(a) + 1</code>.</p>",
        "id": 253875977,
        "sender_full_name": "Chris B",
        "timestamp": 1631979426
    },
    {
        "content": "<p>Actually it looks like sizeof is defined manually for some primitives, like list and option.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">protected</span> <span class=\"kd\">def</span> <span class=\"n\">option.sizeof</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">has_sizeof</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">nat</span>\n<span class=\"bp\">|</span> <span class=\"n\">none</span>     <span class=\"o\">:=</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">some</span> <span class=\"n\">a</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span> <span class=\"bp\">+</span> <span class=\"n\">sizeof</span> <span class=\"n\">a</span>\n\n<span class=\"kn\">protected</span> <span class=\"kd\">def</span> <span class=\"n\">list.sizeof</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">has_sizeof</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">nat</span>\n<span class=\"bp\">|</span> <span class=\"n\">list.nil</span>        <span class=\"o\">:=</span> <span class=\"mi\">1</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">list.cons</span> <span class=\"n\">a</span> <span class=\"n\">l</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span> <span class=\"bp\">+</span> <span class=\"n\">sizeof</span> <span class=\"n\">a</span> <span class=\"bp\">+</span> <span class=\"n\">list.sizeof</span> <span class=\"n\">l</span>\n</code></pre></div>",
        "id": 253876094,
        "sender_full_name": "Chris B",
        "timestamp": 1631979545
    },
    {
        "content": "<p>That's just because they are needed during bootstrapping. They would normally be created automatically but the sizeof framework isn't yet set up when those inductives are introduced.</p>",
        "id": 253876669,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631980167
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"139442\">Patrick Thomas</span> <a href=\"#narrow/stream/113489-new-members/topic/Types.20and.20Programming.20Languages/near/253875476\">said</a>:</p>\n<blockquote>\n<p>The book defines structural induction as:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">If</span><span class=\"o\">,</span> <span class=\"n\">for</span> <span class=\"n\">each</span> <span class=\"n\">term</span> <span class=\"n\">s</span><span class=\"o\">,</span>\n<span class=\"n\">given</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"n\">for</span> <span class=\"n\">all</span> <span class=\"n\">immediate</span> <span class=\"n\">subterms</span> <span class=\"n\">r</span> <span class=\"n\">of</span> <span class=\"n\">s</span> <span class=\"n\">we</span> <span class=\"n\">can</span> <span class=\"k\">show</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">),</span>\n<span class=\"k\">then</span> <span class=\"n\">P</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">holds</span> <span class=\"n\">for</span> <span class=\"n\">all</span> <span class=\"n\">s.</span>\n</code></pre></div>\n<p>How does one formalize this and show that it follows from weak mathematical induction?</p>\n</blockquote>\n<p>In lean, this is the wrong way around. Structural induction is <em>primitive</em>; it is true by the axioms associated to each inductive type. Weak induction on nat is a special case of structural induction, as is induction on <code>acc</code> which yields well founded recursion, which proves strong induction using <code>sizeof</code>.</p>",
        "id": 253876857,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631980350
    },
    {
        "content": "<p>The shape of each structural induction theorem looks a little different since it depends on how the inductive is defined. Try <code>#print term.rec</code> to see what it looks like for <code>term</code>.</p>",
        "id": 253876971,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631980482
    },
    {
        "content": "<p>Can it still be proven this way around?</p>",
        "id": 253877572,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631981082
    },
    {
        "content": "<p>The easiest way to prove a theorem using <code>is_immediate_subterm</code> is to define it as an inductive family and then prove it using <code>term.rec</code></p>",
        "id": 253878082,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631981611
    },
    {
        "content": "<p>I guess I'm trying to do the exercise in the book, to prove that it follows from weak mathematical induction, similar to the earlier proof using size.</p>",
        "id": 253878287,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631981816
    },
    {
        "content": "<p>It's not possible to do this from weak nat recursion directly, because one term can have two immediate subterm of different heights. For example <code>ite true (succ zero) zero</code> yields the relations:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">ite</span> <span class=\"n\">true</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n<span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">ite</span> <span class=\"n\">true</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">zero</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n<span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">succ</span> <span class=\"n\">zero</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">zero</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span>\n</code></pre></div>\n<p>which are clearly unsolvable. The easy way to derive this using PCI is to just use strong recursion on terms and use that \"immediate subterm\" implies sizeof strict inequality.</p>",
        "id": 253878313,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631981852
    },
    {
        "content": "<p>I'm sorry, what does strong recursion on terms mean?<br>\nDo you mean, define the function <code>is_immediate_subterm: term -&gt; term -&gt; Prop</code>, then prove <code>forall r, s : term, is_immediate_subterm r s -&gt; size r &lt; size s</code>. Then proceed as in the earlier proof?</p>",
        "id": 253878929,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631982538
    },
    {
        "content": "<p>Like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">constant</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">size</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"n\">ℕ</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">subterm_size</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- principle of complete mathematical induction</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"n\">nat.strong_induction_on</span> <span class=\"n\">n</span> <span class=\"n\">H</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">SI</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">P</span> <span class=\"n\">t</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">refine</span> <span class=\"n\">PCI</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">),</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"bp\">=</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">t</span> <span class=\"n\">rfl</span><span class=\"o\">,</span>\n  <span class=\"n\">dsimp</span> <span class=\"n\">only</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">m</span> <span class=\"n\">ih</span> <span class=\"n\">s</span> <span class=\"n\">e</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"n\">H</span><span class=\"o\">,</span>\n  <span class=\"n\">intros</span> <span class=\"n\">r</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"o\">(</span><span class=\"n\">ih</span> <span class=\"o\">(</span><span class=\"n\">size</span> <span class=\"n\">r</span><span class=\"o\">)),</span>\n  <span class=\"n\">rw</span> <span class=\"bp\">&lt;-</span> <span class=\"n\">e</span><span class=\"o\">,</span>\n  <span class=\"n\">apply</span> <span class=\"o\">(</span><span class=\"n\">subterm_size</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"n\">a</span><span class=\"o\">),</span>\n  <span class=\"n\">refl</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 253880822,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631984636
    },
    {
        "content": "<p>Thank you. I thought it was more complicated and was heading in the wrong direction.</p>",
        "id": 253881484,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631985326
    },
    {
        "content": "<p>You can actually just apply the previous theorem instead of replaying it</p>",
        "id": 253881702,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1631985594
    },
    {
        "content": "<p>Yeah, that probably would have been simpler :)</p>",
        "id": 253881774,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1631985640
    },
    {
        "content": "<p>3.2.1 Definition [Terms, Inductively]: The set of terms is the smallest set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> such that</p>\n<ol>\n<li>{true, false, 0} <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⊆</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\subseteq T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>;</li>\n<li>if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>∈</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t_{1} \\in T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, then {succ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, pred <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, iszero <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>} <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⊆</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\subseteq T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>;</li>\n<li>if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>∈</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t_{1} \\in T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub><mo>∈</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t_{2} \\in T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub><mo>∈</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">t_{3} \\in T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, then if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> else <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∈</mo><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">\\in T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>.</li>\n</ol>\n<p>I think the equivalent of Definition 3.2.1 in Lean is</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">inductive</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n  <span class=\"bp\">|</span> <span class=\"n\">true</span>\n  <span class=\"bp\">|</span> <span class=\"n\">false</span>\n  <span class=\"bp\">|</span> <span class=\"n\">zero</span>\n  <span class=\"bp\">|</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t2</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>In a similar manner, Is there an equivalent of Definition 3.2.3 in Lean? By equivalent I mean as a translation from set theory to type theory, not the fact that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> are the same set.</p>\n<p>3.2.3 Definition [Terms, Concretely]: For each natural number <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>, define a set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> as follows:<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi mathvariant=\"normal\">∅</mi></mrow><annotation encoding=\"application/x-tex\">S_{0} = \\empty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.80556em;vertical-align:-0.05556em;\"></span><span class=\"mord\">∅</span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">S_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> = {true, false, 0} <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∪</mo></mrow><annotation encoding=\"application/x-tex\">\\cup</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.55556em;vertical-align:0em;\"></span><span class=\"mord\">∪</span></span></span></span> {succ <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, pred <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, iszero <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>t</mi><mn>1</mn></msub><mo>∈</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_{1} | t_{1} \\in S_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>} <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∪</mo></mrow><annotation encoding=\"application/x-tex\">\\cup</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.55556em;vertical-align:0em;\"></span><span class=\"mord\">∪</span></span></span></span> {if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> then <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> else <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">t_{3} </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76508em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>| <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mn>3</mn></msub><mo>∈</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_{1}, t_{2}, t_{3} \\in S_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.80952em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>}.<br>\nFinally, let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>=</mo><mo>⋃</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">S = \\bigcup S_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.00001em;vertical-align:-0.25001em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">⋃</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>.</p>",
        "id": 254792764,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632530228
    },
    {
        "content": "<p>Maybe the Lean definition I gave goes with definition 3.2.3 and the question is about an equivalent Lean definition for 3.2.1? I'm not certain.</p>",
        "id": 254793413,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632530753
    },
    {
        "content": "<p>The Lean translation looks good. Definition 3.2.3 is a standard way in set theory to justify Definition 3.2.1, which is not complete as it stands (because a priori there might not be any set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> with this property). You could try to imitate Definition 3.2.3 in Lean, but it would be awkward and it's probably more sensible to just accept that the basic building blocks of type theory are different from in set theory.</p>",
        "id": 254794545,
        "sender_full_name": "Reid Barton",
        "timestamp": 1632531730
    },
    {
        "content": "<p>I see. Thank you!</p>",
        "id": 254794927,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632532126
    },
    {
        "content": "<p>Something like this perhaps?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.set</span>\n<span class=\"kn\">open</span> <span class=\"n\">set</span>\n\n\n<span class=\"c1\">-- Terms, Inductively</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">T</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_1</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"s2\">\"true\"</span><span class=\"o\">,</span> <span class=\"s2\">\"false\"</span><span class=\"o\">,</span> <span class=\"s2\">\"zero\"</span><span class=\"o\">}</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span>\n<span class=\"kd\">def</span> <span class=\"n\">rule_2</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"k\">forall</span> <span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">,</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"o\">{</span><span class=\"s2\">\"succ\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">,</span> <span class=\"s2\">\"pred\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">,</span> <span class=\"s2\">\"iszero\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">}</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span>\n<span class=\"kd\">def</span> <span class=\"n\">rule_3</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"k\">forall</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">,</span> <span class=\"s2\">\"ite\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span> <span class=\"bp\">++</span> <span class=\"n\">t2</span> <span class=\"bp\">++</span> <span class=\"n\">t3</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">holds</span> <span class=\"o\">:</span> <span class=\"n\">rule_1</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_2</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_3</span> <span class=\"n\">T</span>\n<span class=\"kd\">constant</span> <span class=\"n\">smallest</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">,</span> <span class=\"n\">rule_1</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">rule_2</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">rule_3</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span>\n\n\n<span class=\"c1\">-- Terms, Concretely</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">set</span> <span class=\"n\">string</span>\n  <span class=\"bp\">|</span> <span class=\"n\">nat.zero</span> <span class=\"o\">:=</span> <span class=\"bp\">∅</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">nat.succ</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n      <span class=\"o\">{</span><span class=\"s2\">\"true\"</span><span class=\"o\">,</span> <span class=\"s2\">\"false\"</span><span class=\"o\">,</span> <span class=\"s2\">\"zero\"</span><span class=\"o\">}</span>\n      <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"s2\">\"succ\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"s2\">\"pred\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"s2\">\"iszero\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">}</span>\n      <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"s2\">\"ite\"</span> <span class=\"bp\">++</span> <span class=\"n\">t1</span> <span class=\"bp\">++</span> <span class=\"n\">t2</span> <span class=\"bp\">++</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"bp\">∈</span> <span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"bp\">⋃</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">T</span> <span class=\"bp\">=</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 254795175,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632532338
    },
    {
        "content": "<p>It seems you've forgotten spaces between terms. Also, <code>holds</code> seems odd (maybe you meant conjunctions?), and rather than introducing <code>smallest</code> and <code>T</code> as constants, you can prove that <code>S</code> is smallest as a theorem, replacing the <code>example</code>.</p>\n<p>One downside with strings is that to be able to use them as terms you have to go through the effort of parsing them.</p>",
        "id": 254797761,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1632534849
    },
    {
        "content": "<p>What would be a good alternative to strings?</p>",
        "id": 254797981,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632535061
    },
    {
        "content": "<p>Yes, you are right, I should have defined <code>holds</code> with conjunctions.</p>",
        "id": 254798357,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632535328
    },
    {
        "content": "<p>One option is to add enough parenthesis so parsing is easy (though you still would want to parse). It can also be nice to add some functions to make sure you generate the correct syntax.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.set</span>\n<span class=\"kn\">open</span> <span class=\"n\">set</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">pre_term</span>\n<span class=\"kd\">def</span> <span class=\"n\">true</span> <span class=\"o\">:=</span> <span class=\"s2\">\"true\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">false</span> <span class=\"o\">:=</span> <span class=\"s2\">\"false\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">zero</span> <span class=\"o\">:=</span> <span class=\"s2\">\"zero\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"s2\">\"(succ \"</span> <span class=\"bp\">++</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"s2\">\")\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"s2\">\"(pred \"</span> <span class=\"bp\">++</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"s2\">\")\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"s2\">\"(iszero \"</span> <span class=\"bp\">++</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"s2\">\")\"</span>\n<span class=\"kd\">def</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span> <span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"s2\">\"(ite \"</span> <span class=\"bp\">++</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"s2\">\" \"</span> <span class=\"bp\">++</span> <span class=\"n\">t</span> <span class=\"bp\">++</span> <span class=\"s2\">\" \"</span> <span class=\"bp\">++</span> <span class=\"n\">u</span> <span class=\"bp\">++</span> <span class=\"s2\">\")\"</span>\n<span class=\"kd\">end</span> <span class=\"n\">pre_term</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_1</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">pre_term.true</span><span class=\"o\">,</span> <span class=\"n\">pre_term.false</span><span class=\"o\">,</span> <span class=\"n\">pre_term.zero</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_2</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span> <span class=\"o\">:=</span>\n<span class=\"o\">{(</span><span class=\"n\">pre_term.succ</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.pred</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.iszero</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_3</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span> <span class=\"o\">:=</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.ite</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">set</span> <span class=\"n\">string</span>\n  <span class=\"bp\">|</span> <span class=\"n\">nat.zero</span> <span class=\"o\">:=</span> <span class=\"bp\">∅</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">nat.succ</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rule_1</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">∪</span> <span class=\"n\">rule_2</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">∪</span> <span class=\"n\">rule_3</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"bp\">⋃</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">holds</span> <span class=\"o\">:</span> <span class=\"n\">rule_1</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"bp\">∧</span> <span class=\"n\">rule_2</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"bp\">∧</span> <span class=\"n\">rule_3</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">smallest</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">T</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">string</span><span class=\"o\">),</span> <span class=\"n\">rule_1</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_2</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_3</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 254798509,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1632535453
    },
    {
        "content": "<p>And then you could go on to create the subtype of those strings that are in <code>S</code> and make all the constructors:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"o\">:=</span> <span class=\"n\">S</span> <span class=\"c1\">-- this is the set coerced to a type</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">term</span>\n<span class=\"kd\">def</span> <span class=\"n\">true</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">pre_term.true</span><span class=\"o\">,</span> <span class=\"kd\">begin</span> <span class=\"n\">use</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">),</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">f</span><span class=\"o\">,</span> <span class=\"n\">rule_1</span><span class=\"o\">],</span> <span class=\"n\">use</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">refl</span><span class=\"o\">,</span> <span class=\"kd\">end</span><span class=\"o\">⟩</span> <span class=\"c1\">-- (not a very pretty proof)</span>\n<span class=\"kd\">def</span> <span class=\"n\">false</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">zero</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">end</span> <span class=\"n\">term</span>\n</code></pre></div>",
        "id": 254798672,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1632535601
    },
    {
        "content": "<p>Cool. Thank you!</p>",
        "id": 254799070,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632536002
    },
    {
        "content": "<p>This is another setup that I'd expect to be somewhat easier to parse (and by \"parse\" I mean writing the recursor). It uses lists of symbols:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.set</span>\n<span class=\"kn\">open</span> <span class=\"n\">set</span>\n\n<span class=\"kd\">inductive</span> <span class=\"n\">symb</span>\n<span class=\"bp\">|</span> <span class=\"n\">true</span> <span class=\"bp\">|</span> <span class=\"n\">false</span> <span class=\"bp\">|</span> <span class=\"n\">zero</span> <span class=\"bp\">|</span> <span class=\"n\">succ</span> <span class=\"bp\">|</span> <span class=\"n\">pred</span> <span class=\"bp\">|</span> <span class=\"n\">iszero</span> <span class=\"bp\">|</span> <span class=\"n\">ite</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">pre_term</span>\n<span class=\"kd\">def</span> <span class=\"n\">true</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.true</span><span class=\"o\">]</span>\n<span class=\"kd\">def</span> <span class=\"n\">false</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.false</span><span class=\"o\">]</span>\n<span class=\"kd\">def</span> <span class=\"n\">zero</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.zero</span><span class=\"o\">]</span>\n<span class=\"kd\">def</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.succ</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"n\">s</span>\n<span class=\"kd\">def</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.pred</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"n\">s</span>\n<span class=\"kd\">def</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.iszero</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"n\">s</span>\n<span class=\"kd\">def</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span> <span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">[</span><span class=\"n\">symb.ite</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"n\">s</span> <span class=\"bp\">++</span> <span class=\"n\">t</span> <span class=\"bp\">++</span> <span class=\"n\">u</span>\n<span class=\"kd\">end</span> <span class=\"n\">pre_term</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_1</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">pre_term.true</span><span class=\"o\">,</span> <span class=\"n\">pre_term.false</span><span class=\"o\">,</span> <span class=\"n\">pre_term.zero</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_2</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{(</span><span class=\"n\">pre_term.succ</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.pred</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span> <span class=\"bp\">∪</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.iszero</span> <span class=\"n\">t1</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rule_3</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">{(</span><span class=\"n\">pre_term.ite</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"bp\">|</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">nat.zero</span> <span class=\"o\">:=</span> <span class=\"bp\">∅</span>\n  <span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">nat.succ</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">rule_1</span> <span class=\"bp\">∪</span> <span class=\"n\">rule_2</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">∪</span> <span class=\"n\">rule_3</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"bp\">⋃</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">holds</span> <span class=\"o\">:</span> <span class=\"n\">rule_1</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"bp\">∧</span> <span class=\"n\">rule_2</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"bp\">∧</span> <span class=\"n\">rule_3</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">S</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">smallest</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">T</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">list</span> <span class=\"n\">symb</span><span class=\"o\">)),</span> <span class=\"n\">rule_1</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_2</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">rule_3</span> <span class=\"n\">T</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"bp\">→</span> <span class=\"n\">S</span> <span class=\"bp\">⊆</span> <span class=\"n\">T</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"o\">:=</span> <span class=\"n\">S</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">term</span>\n<span class=\"kd\">def</span> <span class=\"n\">true</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">pre_term.true</span><span class=\"o\">,</span> <span class=\"kd\">begin</span> <span class=\"n\">use</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span><span class=\"o\">),</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">f</span><span class=\"o\">,</span> <span class=\"n\">rule_1</span><span class=\"o\">],</span> <span class=\"n\">use</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">refl</span><span class=\"o\">,</span> <span class=\"kd\">end</span><span class=\"o\">⟩</span>\n<span class=\"kd\">def</span> <span class=\"n\">false</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">zero</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">def</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">end</span> <span class=\"n\">term</span>\n</code></pre></div>",
        "id": 254799383,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1632536298
    },
    {
        "content": "<p>Nice!</p>",
        "id": 254799667,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632536618
    },
    {
        "content": "<p>Going back to the discussion on induction; in set theory, the principle of mathematical induction follows from the well ordering principle, and is equivalent to complete mathematical induction. In addition, we have just shown that structural induction follows from complete mathematical induction. Do all forms of induction in set theory then follow from the well ordering principle? What about induction on inductively defined propositions? Can I formalize and show this in Lean?</p>",
        "id": 254943607,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632673812
    },
    {
        "content": "<p>I'm not sure how to formalize the well ordering principle in Lean, or what a generic formalization of induction on inductively defined propositions would look like, in a vein similar to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"k\">forall</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">-&gt;</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"k\">forall</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span>\n<span class=\"k\">forall</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n</code></pre></div>",
        "id": 254943746,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632673940
    },
    {
        "content": "<p>That is, I think we have that all of these are equivalent:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c1\">-- Principle of Mathematical Induction</span>\n<span class=\"kd\">def</span> <span class=\"n\">PMI</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"n\">P</span> <span class=\"mi\">0</span> <span class=\"bp\">∧</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">))</span> <span class=\"bp\">→</span>\n<span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n\n\n<span class=\"c1\">-- Principle of Induction from a Starting Point</span>\n<span class=\"kd\">def</span> <span class=\"n\">SP</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span>\n<span class=\"n\">P</span> <span class=\"n\">m</span> <span class=\"bp\">∧</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">≥</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">P</span> <span class=\"n\">i</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)))</span> <span class=\"bp\">→</span>\n<span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">n</span> <span class=\"bp\">≥</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n\n\n<span class=\"c1\">-- Principle of Complete Induction</span>\n<span class=\"kd\">def</span> <span class=\"n\">PCI</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">i</span> <span class=\"bp\">&lt;</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"bp\">→</span>\n<span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n\n\n<span class=\"c1\">-- Structural induction</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"kd\">constant</span> <span class=\"n\">size</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">ℕ</span>\n<span class=\"kd\">constant</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"n\">term</span> <span class=\"bp\">-&gt;</span> <span class=\"kt\">Prop</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">subterm_size</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">size</span> <span class=\"n\">r</span> <span class=\"bp\">&lt;</span> <span class=\"n\">size</span> <span class=\"n\">s</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">SI</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">is_immediate_subterm</span> <span class=\"n\">r</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">r</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">s</span><span class=\"o\">)</span> <span class=\"bp\">-&gt;</span>\n<span class=\"bp\">∀</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">t</span>\n</code></pre></div>\n<p>How do we formalize the well ordering principle to show that they all follow from it, and also give a similar formal definition of induction over an inductively defined proposition and show that it follows as well.</p>",
        "id": 254944801,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632674978
    },
    {
        "content": "<p>Proving that <code>PMI</code> follows from well-ordering is as interesting as showing <code>true</code> follows from it, because PMI is true by definition of <code>nat.rec</code></p>",
        "id": 254945847,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632675898
    },
    {
        "content": "<p>If you want to prove the recursor of nat (<code>PMI</code>) follows from something more fundamental, then you can't use the built-in definition of <code>nat</code> or any similar inductive definition of nat because such a definition introduces <code>PMI</code> as an \"axiom\".</p>",
        "id": 254945975,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632676022
    },
    {
        "content": "<p>I guess I'm not sure how to define <code>nat</code> in Lean in set theoretical terms, and figured I just wouldn't use that fact.</p>",
        "id": 254946238,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632676254
    },
    {
        "content": "<p>But I would be interested in seeing it in Lean in set theoretical terms.</p>",
        "id": 254946264,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632676294
    },
    {
        "content": "<p>Or just how to add in induction on inductively defined propositions with it as it is.</p>",
        "id": 254946670,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632676679
    },
    {
        "content": "<p>Something like?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">namespace</span> <span class=\"n\">hidden</span>\n\n<span class=\"kd\">constant</span> <span class=\"n\">nat</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"kd\">constant</span> <span class=\"n\">le</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n<span class=\"kd\">constant</span> <span class=\"n\">lt</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">WOP</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"bp\">∃</span> <span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">t</span> <span class=\"bp\">∈</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"bp\">∃</span> <span class=\"n\">u</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">u</span> <span class=\"bp\">∈</span> <span class=\"n\">s</span> <span class=\"bp\">∧</span> <span class=\"bp\">∀</span> <span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">v</span> <span class=\"bp\">∈</span> <span class=\"n\">s</span> <span class=\"bp\">→</span> <span class=\"n\">le</span> <span class=\"n\">u</span> <span class=\"n\">v</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">PCI</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">nat</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">,</span>\n<span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">lt</span> <span class=\"n\">i</span> <span class=\"n\">m</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">P</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"bp\">→</span>\n<span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">nat</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">n</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">WOP</span> <span class=\"bp\">→</span> <span class=\"n\">PCI</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">end</span> <span class=\"n\">hidden</span>\n</code></pre></div>",
        "id": 254947657,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632677568
    },
    {
        "content": "<p>That looks unprovable because you have nothing saying how <code>lt</code> and <code>le</code> interact.</p>",
        "id": 254952297,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632681747
    },
    {
        "content": "<p>I was just throwing it together leaving them to be defined.</p>",
        "id": 254954441,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632683635
    },
    {
        "content": "<p>The question I am most interested in, is how to similarly formalize and show (if it holds true) that induction on inductively defined propositions is related to mathematical induction.</p>",
        "id": 254954578,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632683759
    },
    {
        "content": "<p>For example, what is the form of the induction principle on <code>step</code> and can it be related to the principle of mathematical induction:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">inductive</span> <span class=\"n\">term</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n  <span class=\"bp\">|</span> <span class=\"n\">true</span>\n  <span class=\"bp\">|</span> <span class=\"n\">false</span>\n  <span class=\"bp\">|</span> <span class=\"n\">zero</span>\n  <span class=\"bp\">|</span> <span class=\"n\">succ</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">pred</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">iszero</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"n\">ite</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t2</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- step x y means that (x, y) is in the evaluation relation</span>\n<span class=\"kd\">inductive</span> <span class=\"n\">step</span> <span class=\"o\">:</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"n\">term</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n  <span class=\"bp\">|</span> <span class=\"n\">e_if_true</span> <span class=\"o\">(</span><span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n    <span class=\"n\">step</span> <span class=\"o\">(</span><span class=\"n\">term.ite</span> <span class=\"n\">term.true</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"n\">t2</span>\n  <span class=\"bp\">|</span> <span class=\"n\">e_if_false</span> <span class=\"o\">(</span><span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n    <span class=\"n\">step</span> <span class=\"o\">(</span><span class=\"n\">term.ite</span> <span class=\"n\">term.false</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"n\">t3</span>\n  <span class=\"bp\">|</span> <span class=\"n\">e_if</span> <span class=\"o\">(</span><span class=\"n\">t1</span> <span class=\"n\">t1'</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span> <span class=\"o\">:</span> <span class=\"n\">term</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n    <span class=\"n\">step</span> <span class=\"n\">t1</span> <span class=\"n\">t1'</span> <span class=\"bp\">→</span> <span class=\"n\">step</span> <span class=\"o\">(</span><span class=\"n\">term.ite</span> <span class=\"n\">t1</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">term.ite</span> <span class=\"n\">t1'</span> <span class=\"n\">t2</span> <span class=\"n\">t3</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 254955488,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632684578
    },
    {
        "content": "<p>You can ask lean for the \"form of induction principle on <code>step</code>\" with <code>#check @step.rec</code></p>",
        "id": 254959076,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632687677
    },
    {
        "content": "<p>Can that induction principle be shown to follow from one of the others?</p>",
        "id": 254959306,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632687887
    },
    {
        "content": "<p>If it can be shown, you can't write the proof in lean itself while keeping that definition of <code>step</code>.</p>",
        "id": 254959439,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632688017
    },
    {
        "content": "<p>You'd need to formalize the rules of inductive types in lean itself, and describe <code>step</code> in <em>that</em> language in order to use Lean to show what you're asking.</p>",
        "id": 254959558,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632688114
    },
    {
        "content": "<p>I am guessing that there is an axiom in Lean that all of the various forms of induction in Lean follow from?</p>",
        "id": 254959864,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632688388
    },
    {
        "content": "<p>Every time you use the keyword <code>inductive</code> or <code>structure</code> or <code>class</code> you are essentially introducing a new recursor \"axiom\" (but not <code>axiom</code>) into lean</p>",
        "id": 254962525,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632690794
    },
    {
        "content": "<p>What ensures that they are permissible?</p>",
        "id": 254962745,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632690972
    },
    {
        "content": "<p>The rules that dictate what is and is not a valid (non-<code>meta</code>)<code>inductive</code> type ensure they are permissible. Lean itself does not provide a proof that they are permissible, that's the foundation you as the user are putting your trust upon.</p>",
        "id": 254963140,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632691379
    },
    {
        "content": "<p>I would expect the paper on lean itself to provide ample references to how exactly that foundation is justified mathematically; but I think those were already linked in your other thread?</p>",
        "id": 254963312,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1632691551
    },
    {
        "content": "<p>I see.</p>",
        "id": 254963700,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1632691927
    }
]