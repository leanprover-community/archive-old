[
    {
        "content": "<p>Got it! Thank you so much <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> . </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">tactic</span>\n<span class=\"kn\">import</span> <span class=\"n\">data.real.basic</span>\n<span class=\"kn\">open</span> <span class=\"n\">classical</span> <span class=\"n\">set</span> <span class=\"n\">function</span>\n\n<span class=\"kn\">section</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">}</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"> Defininig Complete Relations -/</span>\n<span class=\"kd\">def</span> <span class=\"n\">complete</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"bp\">∨</span> <span class=\"n\">R</span> <span class=\"n\">y</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rtransitive</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"bp\">∀</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">z</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"bp\">∧</span>  <span class=\"n\">R</span> <span class=\"n\">y</span> <span class=\"n\">z</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">z</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">rational</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span> <span class=\"n\">rtransitive</span> <span class=\"n\">R</span> <span class=\"bp\">∧</span> <span class=\"n\">complete</span> <span class=\"n\">R</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">compGe</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)(</span><span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">):</span> <span class=\"n\">a</span> <span class=\"bp\">≥</span> <span class=\"n\">b</span> <span class=\"bp\">∨</span> <span class=\"n\">b</span> <span class=\"bp\">≥</span> <span class=\"n\">a</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n<span class=\"n\">by_contra</span><span class=\"o\">,</span>\n<span class=\"n\">push_neg</span> <span class=\"n\">at</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n<span class=\"n\">cases</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n<span class=\"n\">linarith</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">represents</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"bp\">∃</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">x</span> <span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">≥</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">↔</span> <span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">complete</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n<span class=\"n\">intro</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n<span class=\"n\">cases</span> <span class=\"n\">h</span> <span class=\"k\">with</span> <span class=\"n\">f</span> <span class=\"n\">rep</span><span class=\"o\">,</span>\n<span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">complete</span><span class=\"o\">],</span>\n<span class=\"n\">intro</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"n\">intro</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n<span class=\"k\">have</span> <span class=\"n\">repxy</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">≥</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">↔</span> <span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">rep</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n<span class=\"k\">have</span> <span class=\"n\">repyx</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">≥</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">↔</span> <span class=\"n\">R</span> <span class=\"n\">y</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">rep</span> <span class=\"n\">y</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"n\">cases</span> <span class=\"n\">repxy</span> <span class=\"k\">with</span> <span class=\"n\">fxfyRxy</span> <span class=\"n\">Rxyfxfy</span><span class=\"o\">,</span>\n<span class=\"n\">cases</span> <span class=\"n\">repyx</span> <span class=\"k\">with</span> <span class=\"n\">fyfxRyx</span> <span class=\"n\">Ryxfyfx</span><span class=\"o\">,</span>\n<span class=\"k\">let</span> <span class=\"n\">a</span> <span class=\"o\">:=</span> <span class=\"n\">f</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n<span class=\"k\">let</span> <span class=\"n\">b</span> <span class=\"o\">:=</span> <span class=\"n\">f</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n<span class=\"k\">have</span> <span class=\"n\">compF</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">≥</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">∨</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">≥</span> <span class=\"n\">f</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">compGe</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"o\">,</span>\n<span class=\"n\">tauto</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 282006884,
        "sender_full_name": "Greg Leo",
        "timestamp": 1652293029
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"498890\">Greg Leo</span> has marked this topic as resolved.</p>",
        "id": 282008710,
        "sender_full_name": "Notification Bot",
        "timestamp": 1652293831
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"498890\">@Greg Leo</span> here's some golfing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">theorem</span> <span class=\"n\">compGe</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)(</span><span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">):</span> <span class=\"n\">a</span> <span class=\"bp\">≥</span> <span class=\"n\">b</span> <span class=\"bp\">∨</span> <span class=\"n\">b</span> <span class=\"bp\">≥</span> <span class=\"n\">a</span> <span class=\"o\">:=</span>\n<span class=\"n\">le_total</span> <span class=\"n\">b</span> <span class=\"n\">a</span> <span class=\"c1\">-- we have this already, but you shoudn't be using ≥ anyway;</span>\n<span class=\"c1\">-- we stick to ≤ in mathlib so as to halve the number of lemmas we need about inequalities!</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">represents</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"bp\">∃</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">x</span> <span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">≤</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">↔</span> <span class=\"n\">R</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"n\">complete</span> <span class=\"n\">R</span> <span class=\"o\">:=</span> <span class=\"c1\">-- ≤ not ≥</span>\n<span class=\"kd\">begin</span>\n  <span class=\"c1\">-- indent two spaces</span>\n  <span class=\"n\">rintro</span> <span class=\"o\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span> <span class=\"n\">rep</span><span class=\"o\">⟩,</span> <span class=\"c1\">-- intro and cases at the same time</span>\n  <span class=\"c1\">--rw [complete], -- don't need this because it's definitional</span>\n  <span class=\"n\">intros</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"c1\">-- can put these on the line above to make it even shorter</span>\n  <span class=\"c1\">-- have repxy : f y ≤ f x ↔ R x y, from rep x y, -- don't need to name it</span>\n<span class=\"c1\">-- have repyx : f y ≥ f x ↔ R y x, from rep y x, -- don't need to name it</span>\n  <span class=\"n\">rcases</span> <span class=\"n\">rep</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"k\">with</span> <span class=\"o\">⟨</span><span class=\"n\">fxfyRxy</span><span class=\"o\">,</span> <span class=\"n\">Rxyfxfy</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">rcases</span> <span class=\"n\">rep</span> <span class=\"n\">y</span> <span class=\"n\">x</span> <span class=\"k\">with</span> <span class=\"o\">⟨</span><span class=\"n\">fyfxRyx</span><span class=\"o\">,</span> <span class=\"n\">Ryxfyfx</span><span class=\"o\">⟩,</span>\n  <span class=\"c1\">-- let a := f x, -- don't need to name it</span>\n  <span class=\"c1\">-- let b := f y, -- don't need to name it</span>\n  <span class=\"k\">have</span> <span class=\"n\">compF</span> <span class=\"o\">:</span> <span class=\"n\">f</span> <span class=\"n\">y</span> <span class=\"bp\">≤</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">∨</span> <span class=\"n\">f</span> <span class=\"n\">x</span> <span class=\"bp\">≤</span> <span class=\"n\">f</span> <span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"n\">le_total</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"c1\">-- Lean can figure out the inputs</span>\n  <span class=\"n\">tauto</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 282009762,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652294289
    },
    {
        "content": "<p>Excellent. That helps a lot. Is there some similar thing for transitivity of \\leq?</p>",
        "id": 282010311,
        "sender_full_name": "Greg Leo",
        "timestamp": 1652294551
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/le_trans\">docs#le_trans</a></p>",
        "id": 282010361,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652294576
    },
    {
        "content": "<p>and there might also be <a href=\"https://leanprover-community.github.io/mathlib_docs/find/has_le.le.trans\">docs#has_le.le.trans</a> so you can use dot notation.</p>",
        "id": 282010398,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1652294601
    }
]