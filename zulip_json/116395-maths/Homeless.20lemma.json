[
    {
        "content": "<p>I believe I need to use the following lemma:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">order.lattice</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">monotone_nat_action_iff</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">semilattice_sup</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">h_zero</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"mi\">0</span> <span class=\"n\">a</span> <span class=\"bp\">=</span> <span class=\"n\">a</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">h_add</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">n₁</span> <span class=\"bp\">+</span> <span class=\"n\">n₂</span><span class=\"o\">)</span> <span class=\"n\">a</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"n\">a</span><span class=\"o\">))</span>\n  <span class=\"o\">(</span><span class=\"n\">h_mono</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">monotone</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a</span><span class=\"o\">))</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">n₁</span> <span class=\"bp\">+</span> <span class=\"n\">n₂</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"bp\">↔</span>\n  <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">split</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">h</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">conv_rhs</span> <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"bp\">←</span> <span class=\"n\">h_zero</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"o\">},</span> <span class=\"n\">exact</span> <span class=\"n\">h</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">h</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"k\">have</span> <span class=\"n\">h'</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">induction</span> <span class=\"n\">n</span> <span class=\"k\">with</span> <span class=\"n\">n</span> <span class=\"n\">ih</span><span class=\"bp\">;</span> <span class=\"n\">intros</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span>\n      <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h_zero</span><span class=\"o\">,</span> <span class=\"n\">h_zero</span><span class=\"o\">],</span> <span class=\"o\">},</span>\n      <span class=\"o\">{</span> <span class=\"k\">calc</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">h_add</span> <span class=\"n\">n</span> <span class=\"mi\">1</span> <span class=\"n\">_</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"o\">((</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">h_mono</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">)</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"n\">a₁</span><span class=\"o\">))</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span> <span class=\"o\">:</span> <span class=\"n\">ih</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">h_add</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"o\">},</span> <span class=\"o\">},</span>\n    <span class=\"k\">calc</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">n₁</span> <span class=\"bp\">+</span> <span class=\"n\">n₂</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">h_add</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"o\">(</span><span class=\"n\">a₂</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₁</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">sup_comm</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"o\">((</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">h_mono</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">h'</span> <span class=\"n\">n₂</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">)</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">sup_comm</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n₂</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">h'</span> <span class=\"n\">n₁</span> <span class=\"n\">a₁</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>but I'm not sure:</p>\n<ul>\n<li>where it should live,</li>\n<li>what it should be called,</li>\n<li>whether I'm stating it in appropriate generality.</li>\n</ul>\n<p>I'd be grateful for any comments!</p>",
        "id": 223298273,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611091895
    },
    {
        "content": "<p>Would it make sense to make this literally, rather than just morally, a result about an action of <code>ℕ</code> on <code>α</code>? There is a theory of monoid action, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/mul_action\">docs#mul_action</a>.  Seemingly only in the multiplicative case, should we add the additive case?</p>",
        "id": 223298765,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611092142
    },
    {
        "content": "<p>I have also wondered lately whether we need a fancier theory, to deal with actions which are \"category-respecting\":  actions on orders which are monotone, actions on topological spaces which are continuous, actions on manifolds which are smooth.</p>",
        "id": 223298931,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611092211
    },
    {
        "content": "<p>Absolutely agreed on using <code>mul_action</code>, great point.</p>",
        "id": 223299119,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611092303
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/Homeless.20lemma/near/223298931\">said</a>:</p>\n<blockquote>\n<p>I have also wondered lately whether we need a fancier theory, to deal with actions which are \"category-respecting\":  actions on orders which are monotone, actions on topological spaces which are continuous, actions on manifolds which are smooth.</p>\n</blockquote>\n<p>One way to do that here would be to write down the monoid instance on the type of monotone self-maps of <code>α</code>, and phrase your lemma as a result about a homomorphism of <code>ℕ</code> into that monoid.</p>",
        "id": 223299134,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611092312
    },
    {
        "content": "<p>Also a nice idea, though I have to pick between this approach and <code>mul_action</code> then I guess.</p>",
        "id": 223299267,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611092396
    },
    {
        "content": "<p>I thought I'd leave the decision to someone else! :)</p>",
        "id": 223299347,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611092419
    },
    {
        "content": "<p>I'm pretty much done for the day so I'll mull it for a day or so. Currently leaning toward <code>mul_action</code>.</p>",
        "id": 223299416,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611092478
    },
    {
        "content": "<p>I'd also like it if there was a helpful generalisation of <code>ℕ</code> though it's not clear to me that there is (at least a helpful one).</p>",
        "id": 223299545,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611092524
    },
    {
        "content": "<p>Incidentally the mysterious <code>f</code> in my case is <code>lie_algebra.derived_series_of_ideal</code> cf <a href=\"https://github.com/leanprover-community/mathlib/pull/5815\">https://github.com/leanprover-community/mathlib/pull/5815</a></p>",
        "id": 223300088,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611092765
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/Homeless.20lemma/near/223298931\">said</a>:</p>\n<blockquote>\n<p>I have also wondered lately whether we need a fancier theory, to deal with actions which are \"category-respecting\":  actions on orders which are monotone, actions on topological spaces which are continuous, actions on manifolds which are smooth.</p>\n</blockquote>\n<p>This is possible to do since <code>End X</code> has a monoid instance (where <code>X</code> is a term of some type with a category instance). A monoid action of <code>M</code> on <code>X</code> compatible with the category structure is then a morphism of monoids <code>M \\to End X</code>.</p>",
        "id": 223327434,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611112606
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/category_theory.End\">docs#category_theory.End</a></p>",
        "id": 223327449,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611112623
    },
    {
        "content": "<p>I tried to play with this once before ( I was trying to do some Tannakian sort of stuff in lean)... IIRC I found it somewhat cumbersome. But maybe it's worth another shot.</p>",
        "id": 223327548,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611112733
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span>  one can also do this \"by hand\":  construct the group/monoid instance on the monotone self-maps of an order, the self-homeomorphisms of a topological space, the diffeomorphism group of a manifold, and then define an action to be a homomorphism into this group/monoid.  Is there any reason to do this construction \"by category theory\"?  (Sorry for the naive question!)</p>",
        "id": 223327641,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611112818
    },
    {
        "content": "<p>I'll sketch some code...</p>",
        "id": 223327656,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611112840
    },
    {
        "content": "<p>1 sec</p>",
        "id": 223327657,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611112842
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">algebra</span>\n<span class=\"kn\">import</span> <span class=\"n\">category_theory.endomorphism</span>\n<span class=\"kn\">import</span> <span class=\"n\">category_theory.concrete_category</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">category_theory</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">monoid</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">{</span><span class=\"n\">C</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">category</span> <span class=\"n\">C</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">concrete_category</span> <span class=\"n\">C</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"n\">C</span><span class=\"o\">)</span>\n\n<span class=\"kd\">class</span> <span class=\"n\">mul_action'</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">act</span> <span class=\"o\">:</span> <span class=\"n\">M</span> <span class=\"bp\">→*</span> <span class=\"n\">End</span> <span class=\"n\">X</span><span class=\"o\">)</span>\n\n<span class=\"kd\">instance</span> <span class=\"n\">bar</span> <span class=\"o\">:</span> <span class=\"n\">has_coe_to_sort</span> <span class=\"n\">C</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">,</span><span class=\"bp\">λ</span> <span class=\"n\">Y</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">forget</span> <span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">obj</span> <span class=\"n\">Y</span><span class=\"o\">⟩</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">M</span> <span class=\"n\">X</span><span class=\"o\">}</span>\n\n<span class=\"kd\">@[simp]</span>\n<span class=\"kd\">def</span> <span class=\"n\">foo</span> <span class=\"o\">[</span><span class=\"n\">mul_action'</span> <span class=\"n\">M</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">m</span> <span class=\"o\">:</span> <span class=\"n\">M</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">X</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">X</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">forget</span> <span class=\"n\">C</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span> <span class=\"o\">(</span><span class=\"n\">mul_action'.act</span> <span class=\"n\">m</span><span class=\"o\">)</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">instance</span> <span class=\"n\">baz</span> <span class=\"o\">[</span><span class=\"n\">mul_action'</span> <span class=\"n\">M</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">M</span> <span class=\"n\">X</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"n\">foo</span><span class=\"o\">,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"kd\">by</span> <span class=\"n\">simp</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">tidy</span> <span class=\"o\">}</span>\n</code></pre></div>",
        "id": 223328116,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113334
    },
    {
        "content": "<p>So now you can define an action on a monoid on an object in any concrete category (such as <code>Top</code>, <code>Type*</code>, etc.) which is compatible with the underlying structure.</p>",
        "id": 223328156,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113395
    },
    {
        "content": "<p>I don't know if this can be made to be useful enough so that the \"standard\" actions, like the action on a topological space by continuous maps, a manifold by diffeomorphisms, etc., don't need to be individually written by hand.</p>",
        "id": 223328234,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113452
    },
    {
        "content": "<p>I think this is more subtle, though.  Back in 10 mins, but what about Lie group actions on manifolds?  Action needs to be smooth in the \"group\" co-ordinate too.</p>",
        "id": 223328267,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611113505
    },
    {
        "content": "<p>Oh, I see....</p>",
        "id": 223328276,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113522
    },
    {
        "content": "<p>Sorry, I misunderstood the question.</p>",
        "id": 223328317,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113531
    },
    {
        "content": "<p>In this case we need to use monoid objects internal to a cateogry.</p>",
        "id": 223328325,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113545
    },
    {
        "content": "<p>This exists <del>docs#category_theory.monoidal.Mon_</del> and it should be doable...</p>",
        "id": 223328371,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113608
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/category_theory/monoidal/Mon_.html#Mon_\">https://leanprover-community.github.io/mathlib_docs/category_theory/monoidal/Mon_.html#Mon_</a></p>",
        "id": 223328394,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113636
    },
    {
        "content": "<p>One can use this:<br>\n<a href=\"https://leanprover-community.github.io/mathlib_docs/category_theory/monoidal/Mod.html#Mod\">https://leanprover-community.github.io/mathlib_docs/category_theory/monoidal/Mod.html#Mod</a></p>",
        "id": 223328581,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611113844
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> I am glad to hear that people have found a suitable theory for this.  Can you explain the terminology?  Is a Lie group a monoid object in the category of smooth manifolds?</p>",
        "id": 223329512,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611114886
    },
    {
        "content": "<p>A Lie monoid (is that a thing?) is a monoid object in the category of manifolds. A Lie group is a group object in the category of manifolds.</p>",
        "id": 223329605,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611115049
    },
    {
        "content": "<p>etc.</p>",
        "id": 223329606,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611115050
    },
    {
        "content": "<p>Mathlib does <a href=\"https://leanprover-community.github.io/mathlib_docs/geometry/manifold/algebra/monoid.html\">have</a> Lie monoids, although there was <a href=\"https://github.com/leanprover-community/mathlib/pull/3641#issuecomment-671575032\">some debate</a></p>",
        "id": 223329913,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611115404
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/116395-maths/topic/Homeless.20lemma/near/223329605\">said</a>:</p>\n<blockquote>\n<p>A Lie group is a group object in the category of manifolds.</p>\n</blockquote>\n<p>So one still has to prove this fact, right?</p>",
        "id": 223329992,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611115522
    },
    {
        "content": "<p>And the idea is that then one gets access to a family of general theorems about structure-preserving group actions?</p>",
        "id": 223330011,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611115550
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/Homeless.20lemma/near/223329992\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/116395-maths/topic/Homeless.20lemma/near/223329605\">said</a>:</p>\n<blockquote>\n<p>A Lie group is a group object in the category of manifolds.</p>\n</blockquote>\n<p>So one still has to prove this fact, right?</p>\n</blockquote>\n<p>This is \"the definition\" :)</p>",
        "id": 223330073,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611115608
    },
    {
        "content": "<p>Well, we have another definition <a href=\"https://leanprover-community.github.io/mathlib_docs/find/lie_group\">docs#lie_group</a>, and need some glue between them :)</p>",
        "id": 223330158,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611115717
    },
    {
        "content": "<p>Do we have \"the category of manifolds\" in mathlib?</p>",
        "id": 223330181,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611115752
    },
    {
        "content": "<p><a href=\"https://en.wikipedia.org/wiki/Lord_Kitchener_Wants_You\">https://en.wikipedia.org/wiki/Lord_Kitchener_Wants_You</a></p>",
        "id": 223330257,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611115826
    },
    {
        "content": "<p><span aria-label=\"expressionless\" class=\"emoji emoji-1f611\" role=\"img\" title=\"expressionless\">:expressionless:</span></p>",
        "id": 223330287,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611115882
    },
    {
        "content": "<p>If this is a serious proposal, then a good test case would be to redefine <a href=\"https://leanprover-community.github.io/mathlib_docs/find/topological_group\">docs#topological_group</a> as a group object in the category of topological spaces.</p>",
        "id": 223330757,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611116413
    },
    {
        "content": "<p>Yeah, this should be easier.</p>",
        "id": 223330769,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611116437
    },
    {
        "content": "<p>Has anything like this been done in mathlib before?  That is, to make a \"real-life\" definition by invoking category theory?</p>",
        "id": 223330792,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611116494
    },
    {
        "content": "<p>I would be very curious to know whether something \"practical\" like Floris' construction of Haar measure is unaffected by switching to a category-theoretic definition of topological group.</p>",
        "id": 223330892,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611116632
    },
    {
        "content": "<p>I can't think of an example. But it's usually not as good as a \"standard\" definition, because of universe issues.</p>",
        "id": 223330938,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611116651
    },
    {
        "content": "<p>I see.  This is a <strong>very</strong> naive question, but if it can't be used for such things, then what is the purpose of the category theory library?</p>",
        "id": 223331029,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611116765
    },
    {
        "content": "<p>Is it to provide a sanity check that the definitions (given the concrete way) are correct?</p>",
        "id": 223331052,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611116793
    },
    {
        "content": "<p>Oh, it can certainly be used. Here's an example of what I mean. <br>\nSuppose I want to define monoids. I can define the objects themselves as a type with extra data, etc., or I can define them as monoid objects in the category <code>Type u</code> for a fixed universe u. Now when I go to define morphisms of monoids, I can define them as functions satsifying assumptions in the first case, or I can define them as morphisms in the category <code>Type u</code> which satisfy some conditions in terms of commuting diagrams. The difference is that with the first example, I can define morphisms of monoids whose underlying type has different universes, while in the second case you can only have the two monoids coming from the same universe since the thing which underlies a morphism of monoids is a morphism in the category <code>Type u</code> itself.</p>\n<p>Long story short -- if you don't care about universes, then either approach is fine.</p>",
        "id": 223331259,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611117064
    },
    {
        "content": "<p>But given that mathlib philosophy is to care about universes, we can never use the category theory approach, right?</p>",
        "id": 223331336,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1611117144
    },
    {
        "content": "<p>I haven't work on the flat module project for a while. But when I was thinking about it recently, I realized that I wanted an induction principle for the <code>category</code> of <code>R</code>-modules, and that would probably simplify my proofs drastically.</p>",
        "id": 223331444,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1611117258
    },
    {
        "content": "<p>It is true that there would be some universe restrictions, but those can be dealt with in a separate part of the proof.</p>",
        "id": 223331452,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1611117281
    },
    {
        "content": "<p>Basically, use <code>ulift</code> to put everything in 1 universe, and then apply some machinery from category theory.</p>",
        "id": 223331472,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1611117300
    },
    {
        "content": "<p>Not optimal, but ey! <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 223331484,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1611117315
    },
    {
        "content": "<p>:) This stuff isn't a problem in Coq right? They have cumulative universes?</p>",
        "id": 223331502,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1611117337
    },
    {
        "content": "<p>When Amelia was working on tensor algebras she observed that the construction using quotients was quite universe-flexible, but when she made a second construction using sigma types she had to put the ring and the module into the same universe. I tried using <code>ulift</code> to get around this but when I found that lean didn't seem to know that if R was a ring then <code>ulift R</code> was too, I told her that I wouldn't be at all bothered if R and M were in the same universe, because I've spent 30 years of my life thinking that there _was_ only one universe and it didn't stop me doing the p-adic Langlands program</p>",
        "id": 223340600,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1611128777
    },
    {
        "content": "<p>Heather asks (and Mario has also raised this issue several times) what the point of the category theory library is if it enables us to do stuff but only under some universe restrictions. One might conversely ask what the point of more than one universe is, given that mathematicians like Heather probably will never need them to do anything she's interested in.</p>",
        "id": 223340696,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1611128900
    },
    {
        "content": "<p>I'd actually love to find a good excuse to use the category theory library but for what it's worth in the case of the lemma at the top of this thread I think I'm going to go with something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">order.preorder_hom</span>\n<span class=\"kn\">import</span> <span class=\"n\">logic.function.iterate</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">semilattice_sup</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">function</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">preorder_hom.iterate_sup_le_sup_iff</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→ₘ</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span> <span class=\"bp\">+</span> <span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"bp\">↔</span>\n  <span class=\"o\">(</span><span class=\"bp\">∀</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"n\">split</span><span class=\"bp\">;</span> <span class=\"n\">intros</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">h</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"k\">have</span> <span class=\"n\">h'</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span> <span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">intros</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">induction</span> <span class=\"n\">n</span> <span class=\"k\">with</span> <span class=\"n\">n</span> <span class=\"n\">ih</span><span class=\"bp\">;</span> <span class=\"n\">intros</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">,</span>\n      <span class=\"o\">{</span> <span class=\"n\">refl</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n      <span class=\"o\">{</span> <span class=\"k\">calc</span> <span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)))</span> <span class=\"o\">:</span> <span class=\"n\">iterate_succ_apply</span> <span class=\"n\">f</span> <span class=\"n\">n</span> <span class=\"n\">_</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span> <span class=\"o\">((</span><span class=\"n\">f</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">f.monotone.iterate</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"n\">a₁</span> <span class=\"n\">a₂</span><span class=\"o\">)</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">a₁</span><span class=\"o\">))</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span> <span class=\"o\">:</span> <span class=\"n\">ih</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n                             <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">]</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"bp\">←</span> <span class=\"n\">iterate_succ_apply</span><span class=\"o\">,</span> <span class=\"o\">},</span> <span class=\"o\">},</span>\n    <span class=\"k\">calc</span> <span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span> <span class=\"bp\">+</span> <span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₂</span><span class=\"o\">)))</span> <span class=\"o\">:</span> <span class=\"n\">iterate_add_apply</span> <span class=\"n\">f</span> <span class=\"n\">n₁</span> <span class=\"n\">n₂</span> <span class=\"n\">_</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₂</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₁</span><span class=\"o\">)))</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">sup_comm</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"o\">((</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"n\">a₁</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">f.monotone.iterate</span> <span class=\"n\">n₁</span> <span class=\"o\">(</span><span class=\"n\">h'</span> <span class=\"n\">n₂</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">)</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">a₁</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"n\">a₂</span><span class=\"o\">)))</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">sup_comm</span>\n                           <span class=\"bp\">...</span> <span class=\"bp\">≤</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₁</span><span class=\"o\">]</span> <span class=\"n\">a₁</span><span class=\"o\">)</span> <span class=\"bp\">⊔</span> <span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">^</span><span class=\"o\">[</span><span class=\"n\">n₂</span><span class=\"o\">]</span> <span class=\"n\">a₂</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">h'</span> <span class=\"n\">n₁</span> <span class=\"n\">a₁</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"o\">},</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 223360124,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1611141213
    }
]