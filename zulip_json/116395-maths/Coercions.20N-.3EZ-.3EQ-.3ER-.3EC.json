[
    {
        "content": "<p>My students want to move freely between these five basic objects, sometimes because they have made poor design decisions but sometimes for genuine reasons. I figured I'd try to get to the bottom of why they were having problems.</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">data</span><span class=\"bp\">.</span><span class=\"n\">complex</span><span class=\"bp\">.</span><span class=\"n\">basic</span>\n\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_NZ</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">ℤ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_NQ</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℕ</span> <span class=\"n\">ℚ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_NR</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℕ</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_NC</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℕ</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_ZQ</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℤ</span> <span class=\"n\">ℚ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_ZR</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℤ</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_ZC</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"bp\">ℤ</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"c1\">-- definition has_coe_QR : has_coe ℚ ℝ := by apply_instance -- fails</span>\n<span class=\"n\">noncomputable</span> <span class=\"kn\">definition</span> <span class=\"n\">has_coe_QR</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"n\">ℚ</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"c1\">-- definition has_coe_QC : has_coe ℚ ℂ := by apply_instance -- fails</span>\n<span class=\"n\">noncomputable</span> <span class=\"kn\">definition</span> <span class=\"n\">has_coe_QC</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"n\">ℚ</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n<span class=\"kn\">definition</span> <span class=\"n\">has_coe_RC</span> <span class=\"o\">:</span> <span class=\"n\">has_coe</span> <span class=\"n\">ℝ</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span>\n\n<span class=\"kn\">definition</span> <span class=\"n\">coe_NZ</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"bp\">ℤ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_NZ</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_NQ</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℚ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_NQ</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_NR</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_NR</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_NC</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_NC</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_ZQ</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span> <span class=\"bp\">→</span> <span class=\"n\">ℚ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_ZQ</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_ZR</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_ZR</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_ZC</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_ZC</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"n\">noncomputable</span> <span class=\"kn\">definition</span> <span class=\"n\">coe_QR</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span> <span class=\"bp\">→</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_QR</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"n\">noncomputable</span> <span class=\"kn\">definition</span> <span class=\"n\">coe_QC</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_QC</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n<span class=\"kn\">definition</span> <span class=\"n\">coe_RC</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"bp\">→</span> <span class=\"n\">ℂ</span> <span class=\"o\">:=</span> <span class=\"n\">has_coe_RC</span><span class=\"bp\">.</span><span class=\"n\">coe</span>\n\n<span class=\"c1\">-- The ten theorems below are what I would like to access easily in Lean.</span>\n<span class=\"c1\">-- I don&#39;t know what to call them; the current names are just placeholders.</span>\n\n<span class=\"c1\">-- N to Z is never a problem</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">NZQ</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_ZQ</span> <span class=\"o\">(</span><span class=\"n\">coe_NZ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NQ</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">NZR</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_ZR</span> <span class=\"o\">(</span><span class=\"n\">coe_NZ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NR</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">NZC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_ZC</span> <span class=\"o\">(</span><span class=\"n\">coe_NZ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">rfl</span>\n\n<span class=\"c1\">-- the problems start now</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">ZQR</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_QR</span> <span class=\"o\">(</span><span class=\"n\">coe_ZQ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_ZR</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span> <span class=\"c1\">-- simp fails</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">QRC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_RC</span> <span class=\"o\">(</span><span class=\"n\">coe_QR</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_QC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span> <span class=\"c1\">-- simp fails</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">ZRC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_RC</span> <span class=\"o\">(</span><span class=\"n\">coe_ZR</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_ZC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">sorry</span> <span class=\"c1\">-- simp fails</span>\n\n<span class=\"kn\">theorem</span> <span class=\"n\">NQR</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_QR</span> <span class=\"o\">(</span><span class=\"n\">coe_NQ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NR</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"err\">←</span><span class=\"n\">NZQ</span><span class=\"o\">,</span><span class=\"n\">ZQR</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">NZR</span><span class=\"o\">]</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">ZQC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_QC</span> <span class=\"o\">(</span><span class=\"n\">coe_ZQ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_ZC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"err\">←</span><span class=\"n\">QRC</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">ZRC</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">ZQR</span><span class=\"o\">]</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">NQC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_QC</span> <span class=\"o\">(</span><span class=\"n\">coe_NQ</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"err\">←</span><span class=\"n\">NZC</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">NZQ</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">ZQC</span><span class=\"o\">]</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">NRC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℕ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">coe_RC</span> <span class=\"o\">(</span><span class=\"n\">coe_NR</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">coe_NC</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"err\">←</span><span class=\"n\">NQC</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">QRC</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">NQR</span><span class=\"o\">]</span>\n\n<span class=\"c1\">-- cool stuff my stuents constantly want to be able to do</span>\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"o\">((</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">ZQR</span> <span class=\"n\">x</span>\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"k\">let</span> <span class=\"o\">(</span><span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"err\">↑</span><span class=\"n\">x</span> <span class=\"k\">in</span> <span class=\"k\">let</span> <span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"err\">↑</span><span class=\"n\">y</span> <span class=\"k\">in</span> <span class=\"n\">z</span> <span class=\"bp\">=</span> <span class=\"err\">↑</span><span class=\"n\">x</span> <span class=\"o\">:=</span> <span class=\"n\">ZQR</span> <span class=\"n\">x</span>\n</pre></div>\n\n\n<p>Q1) Is there a good reason for the noncomputable coercions being noncomputable? </p>\n<p>Q2) How do I prove the sorried coercion theorems?</p>\n<p>Q3) What are the correct names for these theorems that enable me to cancel <code>↑↑</code> in these specific cases?</p>",
        "id": 130849802,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533314510
    },
    {
        "content": "<p>You need to use the right syntax, then everything works out of the box <span class=\"emoji emoji-263a\" title=\"smile\">:smile:</span> </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">theorem</span> <span class=\"n\">ZQR</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"o\">((</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">QRC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"o\">((</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">ZRC</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"o\">((</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℂ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span>\n</pre></div>",
        "id": 130850810,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1533315942
    },
    {
        "content": "<p>You can use <code>set_option trace.simplify.rewrite true</code> to find the corresponding lemmas.</p>",
        "id": 130850898,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1533316050
    },
    {
        "content": "<p>Oh many thanks Gabriel! I think I can take it from here</p>",
        "id": 130851433,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533316793
    },
    {
        "content": "<p>Q - &gt; R is noncomputable, I'm guessing because it's defined to any field using division and the integer coercion and division is noncomputable on the reals. There is a computable function Q-&gt;R, the constant sequence, but that would be less general than the current Q coercion, and computable reals are useless anyway.</p>",
        "id": 130852441,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1533318115
    },
    {
        "content": "<p>\"computable reals are useless anyway\" -- maybe to you. But to a beginner, I think</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span>\n<span class=\"c\">/-</span><span class=\"cm\"></span>\n<span class=\"cm\">definition &#39;x&#39; is noncomputable, it depends on &#39;real.division_ring&#39;</span>\n<span class=\"cm\">-/</span>\n</pre></div>\n\n\n<p>is very confusing. What's so noncomputable about 1/2?</p>",
        "id": 130882150,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533370738
    },
    {
        "content": "<p>I hear they have a computable division by positive numbers</p>",
        "id": 130882160,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1533370773
    },
    {
        "content": "<p>there is a manual coercion from Q if you really care about defining 1/2 computably, but the point is that it's not the object but the way it is defined that makes it noncomputable</p>",
        "id": 130882206,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533370831
    },
    {
        "content": "<p>The default coercion from nat to int isn't the generic one from nat to any semiring, it's the constructor, and my understanding was that this decision was made for efficiency reasons.</p>",
        "id": 130882208,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533370841
    },
    {
        "content": "<p>Is there a similar argument saying that the default coercion from Q to R should be the one that's staring you in the face rather than the generic one?</p>",
        "id": 130882217,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533370865
    },
    {
        "content": "<p>i.e. the constant series</p>",
        "id": 130882218,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533370883
    },
    {
        "content": "<p>These are implementation issues I guess, which I of course know nothing about in practice</p>",
        "id": 130882221,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533370916
    },
    {
        "content": "<p>Short answer yes</p>",
        "id": 130882261,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533370962
    },
    {
        "content": "<p>But this road leads to the same confusion as why <code>int.coe_nat_*</code> and <code>nat.cast_*</code> have parallel but apparently identical statements</p>",
        "id": 130882268,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371006
    },
    {
        "content": "<p>look ma, no <code>noncomputable</code></p>\n<div class=\"codehilite\"><pre><span></span>import data.real.basic\ndef one_half : ℝ := real.of_rat (1/2)\ntheorem one_half_eq : one_half = 1/2 := by simp [one_half]\n</pre></div>",
        "id": 130882313,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371097
    },
    {
        "content": "<blockquote>\n<p>But this road leads to the same confusion as why <code>int.coe_nat_*</code> and <code>nat.cast_*</code> have parallel but apparently identical statements</p>\n</blockquote>\n<p>Right. And as you know I've been thinking about this recently (I'm trying to write some undergraduate example sheets which look like maths but are actually not hard to do in Lean for a beginner). A decision was made to not use the generic coercion, this then causes some issues like <code>int.coe_nat...</code> v <code>nat.cast...</code>, these are solved by the devs, the right simp lemmas are proved, people like me learn (in my case, yesterday) that if you use <code>\\u</code> then everything should be fine, and then we move on. The devs could do the same for Q -&gt; R, right? Chris seems to think there's no point because who cares about computable reals, but I'm suggesting that there might be a point which has something to do with efficiency somehow.</p>",
        "id": 130882432,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371338
    },
    {
        "content": "<blockquote>\n<p>this decision was made for efficiency reasons</p>\n</blockquote>\n<p>Actually it's the opposite. Efficiency would dictate using <code>real.of_rat</code> because it has the more natural implementation, and is exponentially faster if you actually run it. The decision was made for uniformity of the library - in the lean 2 library we had all 10 coercions N-&gt;Z-&gt;Q-&gt;R-&gt;C and 10 sets of lemmas about them (plus some extras for the 15 ways to combine them), while the <code>nat.cast</code> approach requires only 4 coercions and sets of lemmas</p>",
        "id": 130882438,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371347
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">one_half</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"n\">real</span><span class=\"bp\">.</span><span class=\"n\">of_rat</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">one_half_eq</span> <span class=\"o\">:</span> <span class=\"n\">one_half</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">one_half</span><span class=\"o\">]</span>\n\n<span class=\"n\">noncomputable</span> <span class=\"n\">def</span> <span class=\"n\">real_half</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span> <span class=\"o\">:=</span> <span class=\"mi\">1</span> <span class=\"bp\">/</span> <span class=\"mi\">2</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">:</span> <span class=\"n\">one_half</span> <span class=\"bp\">=</span> <span class=\"n\">real_half</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span> <span class=\"o\">[</span><span class=\"n\">one_half</span><span class=\"o\">]</span> <span class=\"c1\">-- fails</span>\n</pre></div>\n\n\n<p>aargh. Lean why u hate me</p>",
        "id": 130882490,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371478
    },
    {
        "content": "<p>If you work with reals and don't want to be surprised by <code>noncomputable</code> markings, just put <code>noncomputable theory</code> at the top. It's not worth the digression for newbies</p>",
        "id": 130882491,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371504
    },
    {
        "content": "<p>Oh that's a good idea.</p>",
        "id": 130882497,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371521
    },
    {
        "content": "<p>you have to unfold both</p>",
        "id": 130882536,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371527
    },
    {
        "content": "<blockquote>\n<p>you have to unfold both</p>\n</blockquote>\n<p>I know that <code>rw</code> won't unfold. <code>simp</code> is the same? If I had to simplify something, I think I'd be tempted to start unfolding right at the start.</p>",
        "id": 130882544,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371610
    },
    {
        "content": "<p>again, you should remember gabriel's advice from yesterday: <code>simp</code> cares about how you write things, so if you hide something behind a definition you can break some <code>simp</code> proofs</p>",
        "id": 130882591,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371647
    },
    {
        "content": "<p>yes exactly.</p>",
        "id": 130882594,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371662
    },
    {
        "content": "<p><code>simp</code> will only unfold things you tell it to</p>",
        "id": 130882595,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371671
    },
    {
        "content": "<p>I feel like I really understand how to use <code>rw</code> now but I'm still getting the hang of <code>simp</code>. There is an art to all these things.</p>",
        "id": 130882598,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371685
    },
    {
        "content": "<p>I don't want to work with reals at all, it's just that the 250 people in front of me in October are all familiar with them (at some level -- at some other level they don't have a clue what they are, and don't have a clue that they don't know, but I don't mean that; I mean they're not scared of them). So it's very natural to use them whenever I want a random big set. They show up on the first example sheet. I've been looking back at my work from last October when I was working on my own example sheets. It took me 150 lines of code to prove that 1/2 : real wasn't an integer :-)</p>",
        "id": 130882643,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371803
    },
    {
        "content": "<p>I honestly think you can use <code>Q</code> for all those types of theorems and have a much better day</p>",
        "id": 130882651,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371858
    },
    {
        "content": "<p>I honestly believe you.</p>",
        "id": 130882653,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371873
    },
    {
        "content": "<p>I had a principle back then -- \"don't change the example sheets; that would be a compromise\"</p>",
        "id": 130882693,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371887
    },
    {
        "content": "<p>just say \"there are some complications with using reals so we'll use Q for now\" at the start of class and come back to it when you are ready (or not at all)</p>",
        "id": 130882697,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533371902
    },
    {
        "content": "<p><a href=\"https://github.com/kbuzzard/xena/blob/master/M1F/2016-17/example_sheets/exsht1.pdf\" target=\"_blank\" title=\"https://github.com/kbuzzard/xena/blob/master/M1F/2016-17/example_sheets/exsht1.pdf\">https://github.com/kbuzzard/xena/blob/master/M1F/2016-17/example_sheets/exsht1.pdf</a></p>",
        "id": 130882704,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371931
    },
    {
        "content": "<p>Sheet 1 Q6 -- I was told \"this is not possible in Lean because your sets are stupid\"</p>",
        "id": 130882712,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371964
    },
    {
        "content": "<p>I had to start compromising pretty quickly</p>",
        "id": 130882713,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533371979
    },
    {
        "content": "<p>Heh - I could show you how to define that using inductive types</p>",
        "id": 130882758,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372025
    },
    {
        "content": "<p>or trees</p>",
        "id": 130882761,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372051
    },
    {
        "content": "<p><a href=\"https://github.com/kbuzzard/xena/blob/2bf7737bc0fbcd3943ddadfb513bd19c1eea14a3/xenalib/half_not_an_integer.lean#L116\" target=\"_blank\" title=\"https://github.com/kbuzzard/xena/blob/2bf7737bc0fbcd3943ddadfb513bd19c1eea14a3/xenalib/half_not_an_integer.lean#L116\">https://github.com/kbuzzard/xena/blob/2bf7737bc0fbcd3943ddadfb513bd19c1eea14a3/xenalib/half_not_an_integer.lean#L116</a></p>",
        "id": 130882762,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372057
    },
    {
        "content": "<p>triumphant proof that 1/2 wasn't an integer, so I could do Q7 part (i)</p>",
        "id": 130882768,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372069
    },
    {
        "content": "<p>Kind of amazing that I didn't give up there and then</p>",
        "id": 130882769,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372085
    },
    {
        "content": "<p>to do example sheet 2 I had to write my own square root function</p>",
        "id": 130882772,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372101
    },
    {
        "content": "<p>it occurs to me that it is really easy to prove that over Q</p>",
        "id": 130882815,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372133
    },
    {
        "content": "<p>since 1/2 has denom 2 and integers have denom 1</p>",
        "id": 130882816,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372143
    },
    {
        "content": "<p>right</p>",
        "id": 130882817,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372154
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">data</span><span class=\"bp\">.</span><span class=\"n\">real</span><span class=\"bp\">.</span><span class=\"n\">basic</span> <span class=\"n\">tactic</span><span class=\"bp\">.</span><span class=\"n\">interactive</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">rational_half_not_an_integer</span> <span class=\"o\">:</span> <span class=\"bp\">¬</span> <span class=\"bp\">∃</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"err\">↑</span><span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"c1\">-- proof by contradiction</span>\n  <span class=\"n\">rintros</span> <span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"n\">Hn</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"c1\">-- n is an integer, Hn the proof that 1/2 = n</span>\n  <span class=\"c1\">-- goal is &quot;false&quot;</span>\n  <span class=\"k\">have</span> <span class=\"n\">H</span> <span class=\"o\">:=</span> <span class=\"n\">rat</span><span class=\"bp\">.</span><span class=\"n\">coe_int_denom</span> <span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"c1\">-- H says denominator of n is 1</span>\n  <span class=\"n\">rw</span> <span class=\"err\">←</span><span class=\"n\">Hn</span> <span class=\"n\">at</span> <span class=\"n\">H</span><span class=\"o\">,</span> <span class=\"c1\">-- H now says denominator of 1/2 is 1...</span>\n  <span class=\"n\">revert</span> <span class=\"n\">H</span><span class=\"o\">,</span><span class=\"n\">exact</span> <span class=\"n\">dec_trivial</span> <span class=\"c1\">-- ...but denominator of 1/2 isn&#39;t 1.</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">real_half_not_an_integer</span> <span class=\"o\">:</span> <span class=\"bp\">¬</span> <span class=\"bp\">∃</span> <span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"bp\">ℤ</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"err\">↑</span><span class=\"n\">n</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">rintro</span> <span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"n\">Hn</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"c1\">-- n is an integer, Hn the proof that it&#39;s 1/2</span>\n  <span class=\"n\">apply</span> <span class=\"n\">rational_half_not_an_integer</span><span class=\"o\">,</span>\n  <span class=\"n\">existsi</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n  <span class=\"c1\">-- now our hypothesis is that 1/2 = n as reals, and we want to</span>\n  <span class=\"c1\">-- deduce 1/2 = n as rationals!</span>\n  <span class=\"c1\">-- This is possible by some messing around with coercionc</span>\n  <span class=\"c1\">-- from integers to rationals to reals.</span>\n  <span class=\"n\">rw</span> <span class=\"err\">←</span><span class=\"bp\">@</span><span class=\"n\">rat</span><span class=\"bp\">.</span><span class=\"n\">cast_inj</span> <span class=\"n\">ℝ</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">,</span>\n  <span class=\"n\">rw</span> <span class=\"o\">(</span><span class=\"k\">show</span> <span class=\"o\">((</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℚ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">),</span> <span class=\"k\">by</span> <span class=\"n\">simp</span><span class=\"o\">),</span>\n  <span class=\"n\">rw</span> <span class=\"err\">←</span><span class=\"n\">Hn</span><span class=\"o\">,</span>\n  <span class=\"n\">simp</span>\n<span class=\"kn\">end</span>\n</pre></div>",
        "id": 130882821,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372176
    },
    {
        "content": "<p>Current version of 2018 proof</p>",
        "id": 130882823,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372182
    },
    {
        "content": "<p>no having to define my own floor function in sight!</p>",
        "id": 130882828,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372196
    },
    {
        "content": "<p>and a lot less than 150 lines too</p>",
        "id": 130882830,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372224
    },
    {
        "content": "<p>and Gabriel's proof right there at the end</p>",
        "id": 130882831,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372240
    },
    {
        "content": "<p>There is a name for that lemma</p>",
        "id": 130882870,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372262
    },
    {
        "content": "<p>you don't have to <code>show by simp</code></p>",
        "id": 130882872,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372271
    },
    {
        "content": "<p>yes, I even looked it up</p>",
        "id": 130882873,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372283
    },
    {
        "content": "<p>as Gabriel suggested</p>",
        "id": 130882875,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372296
    },
    {
        "content": "<p>in fact did you know that whenever you use simp, you can actually replace it with lemmas which have names?</p>",
        "id": 130882881,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372318
    },
    {
        "content": "<p>;-)</p>",
        "id": 130882883,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372325
    },
    {
        "content": "<p>the advantage of <code>simp</code> is when there are a lot of lemmas, applied in complicated positions</p>",
        "id": 130882894,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372360
    },
    {
        "content": "<p>I am sort-of confused by this. I never know whether to write <code>assumption</code> or <code>exact H27</code>...</p>",
        "id": 130882934,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372365
    },
    {
        "content": "<p>when the theorem name is shorter than the statement I prefer <code>rw</code></p>",
        "id": 130882938,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372382
    },
    {
        "content": "<p>...and I never know whether to write <code>simp</code> or to write <code>simp</code> and then look what it did and write that instead.</p>",
        "id": 130882939,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372385
    },
    {
        "content": "<p>Hmm, so maybe the answer is \"it depends\"</p>",
        "id": 130882952,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372434
    },
    {
        "content": "<p>I prefer <code>exact H27</code> over <code>assumption</code>, indeed I rarely use <code>assumption</code> because it is longer, less descriptive, and possibly time consuming if it normalizes an irrelevant hypothesis</p>",
        "id": 130882959,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372471
    },
    {
        "content": "<p>This code above has a rather strange role to play. My current idea is to present the example sheet questions and at the top have a list of lemmas which the students might find helpful. This is example sheet 1 so I'll probably get a lot of people trying it; many will have given up by sheet 2. My plan as I say was to list useful lemmas at the top which they will need, and then hopefully they can prove all the parts of Q7 with rewrites and exact. One of the lemmas I was going to offer them was the proof that 1/2 wasn't an integer, because they need it for Q7(i). But I was going to say \"don't worry about these lemmas, just assume them, however anyone interested in what is going on here might want to take a look at them\". So I was thinking that the code above would only be seen by people who were interested in what Lean was doing but knew nothing about Lean at all; hence the comments everywhere and the decision to use simp instead of a lemma with a to-them-incomprehensible name</p>",
        "id": 130883098,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372647
    },
    {
        "content": "<p>My goal was to stick with R but to give them the lemmas they need and then to see how well they did.</p>",
        "id": 130883113,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372691
    },
    {
        "content": "<p>I was going to get my xena undergrads to test out the problems in Sept and report back.</p>",
        "id": 130883158,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372727
    },
    {
        "content": "<p>example of <code>assumption</code> going wrong:</p>\n<div class=\"codehilite\"><pre><span></span>example {p : Prop} (h1 : if 10^4 = 10^4 then true else true)\n  (hp : p) : p := by assumption\n</pre></div>",
        "id": 130883160,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372730
    },
    {
        "content": "<p>I will happily never use <code>assumption</code> again.</p>",
        "id": 130883165,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372748
    },
    {
        "content": "<p>except for those funny cases when you prove lots of cases at once after a semicolon</p>",
        "id": 130883168,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372766
    },
    {
        "content": "<p>a somewhat nicer form of <code>assumption</code> which you may not know is the french quotes <code>‹p›</code></p>",
        "id": 130883179,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372790
    },
    {
        "content": "<p>Whenever I see people using that I always figure that they should be doing something else</p>",
        "id": 130883183,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372810
    },
    {
        "content": "<p>I have started using the french quotes to refer to instances that I don't want to name, when I need to refer to them directly for some reason</p>",
        "id": 130883240,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372879
    },
    {
        "content": "<p>Actually I think that's not assumption going wrong</p>",
        "id": 130883243,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372889
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"kn\">example</span> <span class=\"o\">{</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"k\">if</span> <span class=\"mi\">10</span><span class=\"err\">^</span><span class=\"mi\">4</span> <span class=\"bp\">=</span> <span class=\"mi\">10</span><span class=\"err\">^</span><span class=\"mi\">4</span> <span class=\"k\">then</span> <span class=\"n\">true</span> <span class=\"k\">else</span> <span class=\"n\">true</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hp</span> <span class=\"o\">:</span> <span class=\"n\">p</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">p</span> <span class=\"o\">:=</span>\n  <span class=\"k\">begin</span>\n\n  <span class=\"kn\">end</span>\n</pre></div>",
        "id": 130883255,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372904
    },
    {
        "content": "<p>already times out</p>",
        "id": 130883259,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372906
    },
    {
        "content": "<p>but I do believe you</p>",
        "id": 130883261,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1533372912
    },
    {
        "content": "<p>That is a recently discovered mystery for me</p>",
        "id": 130883269,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533372959
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> Do you know what preprocessing is done on the context before a <code>begin end</code> block and why? This also came up with the person who was trying to pattern match on a beta redex in the goal only to find it was already reduced before the tactic got to it</p>",
        "id": 130883340,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533373054
    },
    {
        "content": "<p>this is a better example</p>\n<div class=\"codehilite\"><pre><span></span>example {n : ℕ} (h1 : (if 10^4 = 10^4 then 1 else 1) = 1)\n  (hp : n = 1) : n = 1 := by assumption\n</pre></div>",
        "id": 130883470,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533373269
    },
    {
        "content": "<p>in the original example the timeout is because <code>h1</code> has a type which is not obviously even a type, so it has to do the expensive evaluation to find out if it is a type</p>",
        "id": 130883516,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533373331
    },
    {
        "content": "<p>Wow, even this times out</p>\n<div class=\"codehilite\"><pre><span></span>def q : Prop := if 10^4 = 10^4 then true else true\nexample (h : q) : q := h\n</pre></div>",
        "id": 130883597,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533373526
    },
    {
        "content": "<p>but <code>example : q → q := id</code> is okay</p>",
        "id": 130883599,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533373548
    },
    {
        "content": "<p>Here is an example of an interesting partial reduction:</p>\n<div class=\"codehilite\"><pre><span></span>example : (λ x, x ∧ x) ((λ x, x) true) :=\nby tactic.target &gt;&gt;= tactic.trace\n-- (λ (x : Prop), x) true ∧ (λ (x : Prop), x) true\n</pre></div>\n\n\n<p>It looks like the goal has whnf applied first</p>",
        "id": 130883891,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533374110
    },
    {
        "content": "<p>I wouldn't even know where to start looking for the whnf</p>",
        "id": 130898994,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1533405871
    },
    {
        "content": "<p>My guess is that it is making sure it is a sort first</p>",
        "id": 130899271,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1533406533
    }
]