[
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">generate</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span><span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">sets</span> <span class=\"o\">:=</span> <span class=\"o\">{</span> <span class=\"n\">A</span> <span class=\"bp\">|</span> <span class=\"bp\">∃</span> <span class=\"n\">t</span> <span class=\"err\">⊆</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"err\">⋂₀</span> <span class=\"n\">t</span> <span class=\"err\">⊆</span> <span class=\"n\">A</span> <span class=\"o\">},</span>\n  <span class=\"n\">univ</span> <span class=\"o\">:=</span> <span class=\"bp\">⟨</span><span class=\"err\">∅</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">empty_subset</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"bp\">@</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_empty</span> <span class=\"n\">α</span> <span class=\"bp\">▸</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">refl</span> <span class=\"bp\">_⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">up</span>   <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"bp\">⟩</span> <span class=\"n\">y</span> <span class=\"n\">H2</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"n\">ht2</span> <span class=\"n\">H2</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">down</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"bp\">⟩</span> <span class=\"n\">y</span> <span class=\"bp\">⟨</span><span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">hu1</span><span class=\"o\">,</span> <span class=\"n\">hu2</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">x</span> <span class=\"err\">∩</span> <span class=\"n\">y</span><span class=\"o\">,</span>\n      <span class=\"bp\">⟨</span><span class=\"n\">t</span> <span class=\"err\">∪</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">union_subset</span> <span class=\"n\">ht1</span> <span class=\"n\">hu1</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_union</span> <span class=\"n\">t</span> <span class=\"n\">u</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"bp\">▸</span>\n        <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset_inter</span>\n          <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)</span> <span class=\"n\">ht2</span><span class=\"o\">)</span>\n          <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)</span> <span class=\"n\">hu2</span><span class=\"o\">)</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n    <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_⟩</span> <span class=\"o\">}</span>\n</pre></div>",
        "id": 125807430,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524891008
    },
    {
        "content": "<p>in mathlib it's done by taking the infimum of the principal filters lol</p>",
        "id": 125807435,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524891025
    },
    {
        "content": "<p>aha, that's the wrong definition</p>",
        "id": 125807555,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524891356
    },
    {
        "content": "<p>Those mathlib-style definitions are actually quite convenient because you can immediately use them with lemmas like <code>vmap_infi</code>, <code>vmap_principal</code>, etc.</p>",
        "id": 125807596,
        "sender_full_name": "Reid Barton",
        "timestamp": 1524891372
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"c\">/-</span><span class=\"cm\">- The filter generated by a set of sets. -/</span>\n<span class=\"n\">def</span> <span class=\"n\">generate</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span><span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">sets</span>  <span class=\"o\">:=</span> <span class=\"o\">{</span> <span class=\"n\">A</span> <span class=\"bp\">|</span> <span class=\"bp\">∃</span> <span class=\"n\">t</span> <span class=\"err\">⊆</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">finite</span> <span class=\"n\">t</span> <span class=\"bp\">∧</span> <span class=\"err\">⋂₀</span> <span class=\"n\">t</span> <span class=\"err\">⊆</span> <span class=\"n\">A</span> <span class=\"o\">},</span>\n  <span class=\"n\">univ</span>  <span class=\"o\">:=</span> <span class=\"bp\">⟨</span><span class=\"err\">∅</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">empty_subset</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">finite_empty</span><span class=\"o\">,</span> <span class=\"bp\">@</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_empty</span> <span class=\"n\">α</span> <span class=\"bp\">▸</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">refl</span> <span class=\"bp\">_⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">up</span>    <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"o\">,</span> <span class=\"n\">ht3</span><span class=\"bp\">⟩</span> <span class=\"n\">y</span> <span class=\"n\">H2</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"n\">ht3</span> <span class=\"n\">H2</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n  <span class=\"n\">inter</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"o\">,</span> <span class=\"n\">ht3</span><span class=\"bp\">⟩</span> <span class=\"n\">y</span> <span class=\"bp\">⟨</span><span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">hu1</span><span class=\"o\">,</span> <span class=\"n\">hu2</span><span class=\"o\">,</span> <span class=\"n\">hu3</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n    <span class=\"bp\">⟨</span><span class=\"n\">t</span> <span class=\"err\">∪</span> <span class=\"n\">u</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">union_subset</span> <span class=\"n\">ht1</span> <span class=\"n\">hu1</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">finite_union</span> <span class=\"n\">ht2</span> <span class=\"n\">hu2</span><span class=\"o\">,</span>\n    <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_union</span> <span class=\"n\">t</span> <span class=\"n\">u</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"bp\">▸</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset_inter</span>\n      <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_left</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)</span> <span class=\"n\">ht3</span><span class=\"o\">)</span>\n      <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">trans</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">inter_subset_right</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)</span> <span class=\"n\">hu3</span><span class=\"o\">)</span><span class=\"bp\">⟩</span> <span class=\"o\">}</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">- The filter generated contains the original sets. -/</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">generate</span><span class=\"bp\">.</span><span class=\"n\">subset</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span><span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">))</span> <span class=\"o\">:</span> <span class=\"n\">s</span> <span class=\"err\">⊆</span> <span class=\"o\">(</span><span class=\"n\">generate</span> <span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sets</span> <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">A</span> <span class=\"n\">HA</span><span class=\"o\">,</span> <span class=\"bp\">⟨</span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">},</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">singleton_subset_iff</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">HA</span><span class=\"o\">,</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">finite_singleton</span> <span class=\"n\">A</span><span class=\"o\">,</span>\n  <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_singleton</span> <span class=\"n\">A</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"bp\">▸</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">refl</span> <span class=\"n\">A</span><span class=\"bp\">⟩</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">- The filter generated is the smallest filter containing the original sets. -/</span>\n<span class=\"kn\">theorem</span> <span class=\"n\">generate</span><span class=\"bp\">.</span><span class=\"n\">min</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span><span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">))</span> <span class=\"o\">{</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">s</span> <span class=\"err\">⊆</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">sets</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">generate</span> <span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">sets</span> <span class=\"err\">⊆</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">sets</span> <span class=\"o\">:=</span>\n<span class=\"bp\">λ</span> <span class=\"n\">A</span> <span class=\"bp\">⟨</span><span class=\"n\">t</span><span class=\"o\">,</span> <span class=\"n\">ht1</span><span class=\"o\">,</span> <span class=\"n\">ht2</span><span class=\"o\">,</span> <span class=\"n\">ht3</span><span class=\"bp\">⟩</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">finite</span><span class=\"bp\">.</span><span class=\"n\">induction_on</span> <span class=\"n\">ht2</span>\n  <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">A</span> <span class=\"bp\">_</span> <span class=\"n\">HA</span><span class=\"o\">,</span> <span class=\"k\">have</span> <span class=\"n\">H1</span> <span class=\"o\">:</span> <span class=\"n\">A</span> <span class=\"bp\">=</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"o\">,</span>\n    <span class=\"k\">from</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">eq_univ_of_univ_subset</span> <span class=\"err\">$</span> <span class=\"bp\">@</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_empty</span> <span class=\"n\">α</span> <span class=\"bp\">▸</span> <span class=\"n\">HA</span><span class=\"o\">,</span>\n    <span class=\"n\">H1</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"bp\">▸</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"n\">t</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span> <span class=\"n\">ih</span> <span class=\"n\">A</span> <span class=\"n\">ht1</span> <span class=\"n\">ht3</span><span class=\"o\">,</span> <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">up</span> <span class=\"o\">(</span><span class=\"err\">⋂₀</span> <span class=\"n\">insert</span> <span class=\"n\">B</span> <span class=\"n\">t</span><span class=\"o\">)</span>\n    <span class=\"o\">((</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">sInter_insert</span> <span class=\"n\">B</span> <span class=\"n\">t</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"bp\">▸</span>\n      <span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">inter</span> <span class=\"n\">B</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"err\">$</span> <span class=\"n\">ht1</span> <span class=\"err\">$</span> <span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">mem_insert</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">)</span>\n      <span class=\"o\">(</span><span class=\"err\">⋂₀</span> <span class=\"n\">t</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">ih</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">insert_subset</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">ht1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"o\">(</span><span class=\"n\">set</span><span class=\"bp\">.</span><span class=\"n\">subset</span><span class=\"bp\">.</span><span class=\"n\">refl</span> <span class=\"bp\">_</span><span class=\"o\">)))</span> <span class=\"bp\">_</span> <span class=\"n\">ht3</span><span class=\"o\">))</span> <span class=\"n\">A</span> <span class=\"n\">ht1</span> <span class=\"n\">ht3</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">- The filter generated by one element. -/</span>\n<span class=\"n\">def</span> <span class=\"n\">principal</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"n\">generate</span> <span class=\"o\">{</span><span class=\"n\">s</span><span class=\"o\">}</span>\n</pre></div>",
        "id": 125808108,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524892671
    },
    {
        "content": "<p>that's the right definition</p>",
        "id": 125808120,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524892682
    },
    {
        "content": "<p>and I learnt how to use <code>set.finite.induction_on</code> :P</p>",
        "id": 125808148,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524892694
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> do you think that's enough interface?</p>",
        "id": 125808157,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1524892779
    }
]