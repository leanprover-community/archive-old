[
    {
        "content": "<p>I was taking a look at <a href=\"https://leanprover-community.github.io/mathlib_docs/find/bilin_form\">docs#bilin_form</a>, and it seems like it's a mistake for it to be generalized to noncommutative rings. It gives the axioms that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>r</mi><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mi>r</mi><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>r</mi><mi>n</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle rm,n\\rangle=r\\langle m,n\\rangle=\\langle m,rn\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>∈</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">r\\in R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo>∈</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">m,n\\in M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>, but if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> is a noncommutative division ring this implies the bilinear form is constant-0! (Argument: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>s</mi><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mi>s</mi><mi>r</mi><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">rs\\langle m,n\\rangle = sr\\langle m,n\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">rs</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">sr</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span></span></span></span>, so the commutator ideal annihilates the image of the bilinear form.)</p>",
        "id": 310642305,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701192
    },
    {
        "content": "<p>The \"right\" definition I think comes from hom-tensor adjunction <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow><mi>hom</mi><mo>⁡</mo></mrow><mi>R</mi></msub><mo stretchy=\"false\">(</mo><mi>M</mi><mo separator=\"true\">,</mo><msub><mrow><mi>hom</mi><mo>⁡</mo></mrow><mi>R</mi></msub><mo stretchy=\"false\">(</mo><mi>M</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>≈</mo><msub><mrow><mi>hom</mi><mo>⁡</mo></mrow><mi>R</mi></msub><mo stretchy=\"false\">(</mo><mi>M</mi><msub><mo>⊗</mo><mi>R</mi></msub><mi>M</mi><mo separator=\"true\">,</mo><mi>R</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hom_R(M,\\hom_R(M,R))\\approx \\hom_R(M\\otimes_R M,R)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">hom</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop\">hom</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">hom</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">⊗</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">)</span></span></span></span>, but this requires that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> be an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>-bimodule to be defined. The consequence of this is that in the noncommutative setting, you want <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>m</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>r</mi><mi>n</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle mr,n\\rangle = \\langle m,rn\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span></span></span></span> (it's \"balanced\").</p>",
        "id": 310642368,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701211
    },
    {
        "content": "<p>One place that noncommutativity gives <code>bilin_form</code> issues is in <a href=\"https://leanprover-community.github.io/mathlib_docs/find/bilin_form.to_lin\">docs#bilin_form.to_lin</a>, which gives a bilinear form as a map <code>M →ₗ[R₂] M →ₗ[R] R</code> when the ring <code>R</code> is an algebra over a commutative semiring <code>R₂</code>, where one would expect it to be <code>R</code>-linear the whole way through. (One interpretation of this is that <code>M</code> is being treated as an <code>(R,R₂)</code>-bimodule with both rings acting on the left.)</p>",
        "id": 310642429,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701228
    },
    {
        "content": "<p>The easy right thing to do would be to specialize the file to commutative semirings, making it be a specialization of sequilinear forms from <code>linear_algebra/sesquilinear_form</code>.</p>",
        "id": 310642467,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701236
    },
    {
        "content": "<p>A less easy right thing would be to correctly generalize <code>bilin_form</code> to bimodules. I'm not really wanting to do this, though, since I'm not sure where this would be used. Even representation theory of groups wouldn't use it, since the bilinear forms that appear for a representation of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo stretchy=\"false\">[</mo><mi>G</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">k[G]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">G</span><span class=\"mclose\">]</span></span></span></span> are <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>-linear, not <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo stretchy=\"false\">[</mo><mi>G</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">k[G]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">G</span><span class=\"mclose\">]</span></span></span></span> linear, but with an additional axiom (that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>r</mi><mi>m</mi><mo separator=\"true\">,</mo><mi>r</mi><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mi>ϵ</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle rm,rn\\rangle = \\epsilon(r)\\langle m, n\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span></span></span></span>, with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>:</mo><mi>k</mi><mo stretchy=\"false\">[</mo><mi>G</mi><mo stretchy=\"false\">]</mo><mo>→</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon : k[G] \\to k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">G</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> the augmentation homomorphism, a.k.a. the counit for the hopf algebra structure; this implies the usual <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>g</mi><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">⟩</mo><mo>=</mo><mo stretchy=\"false\">⟨</mo><mi>m</mi><mo separator=\"true\">,</mo><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>n</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle gm,n\\rangle = \\langle m,g^{-1}n\\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">⟩</span></span></span></span> we know and love).</p>",
        "id": 310642510,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701249
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/116395-maths/topic/.60bilinear_form.60/near/310642467\">said</a>:</p>\n<blockquote>\n<p>The easy right thing to do would be to specialize the file to commutative semirings, making it be a specialization of sequilinear forms from <code>linear_algebra/sesquilinear_form</code>.</p>\n</blockquote>\n<p>This is what I'm leaning towards doing on my quest to check off \"orthogonality\" from the undergrad list. The idea would be that I'd generalize what I can for sesquilinear forms, and then <code>linear_algebra/bilinear_form</code> would have whatever is left.</p>\n<p>Does this sound reasonable?</p>",
        "id": 310643461,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668701516
    },
    {
        "content": "<p>I think there is already a refactor in progress to eliminate <code>bilinear_form</code> in favor of bi-linear maps</p>",
        "id": 310670542,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668709297
    },
    {
        "content": "<p>(I made a similar remark before <a href=\"#narrow/stream/116395-maths/topic/Bounded.20bilinear.20forms/near/262110756\">here</a>)</p>",
        "id": 310671158,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668709499
    },
    {
        "content": "<p>I guess even <code>M →ₗ[Rᵐᵒᵖ] M →ₗ[R] R</code> is wrong for the non-commutative case</p>",
        "id": 310671849,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668709726
    },
    {
        "content": "<p>Do you know who might be doing this refactor? Maybe it's <span class=\"user-mention\" data-user-id=\"311453\">@Frédéric Dupuis</span>?</p>",
        "id": 310672288,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668709829
    },
    {
        "content": "<p>Regarding allowing <code>M ⊗[R] M</code> for a bimodule with <code>R</code> non-commutative, I spent a lot of effort on <a href=\"https://github.com/leanprover-community/mathlib/pull/10716\">#10716</a> to make that not come at the expense of <code>A ⊗[R] A</code> being painful when <code>A</code> is an algebra; but that PR might have rotted too much to make it before mathlib4 freezes it</p>",
        "id": 310672422,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668709879
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"412682\">@Moritz Doll</span> was pushing ahead with it in the past</p>",
        "id": 310672485,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668709900
    },
    {
        "content": "<p>The problem right now with <code>R</code>-module structure on <code>M →ₗ[R] R</code> is that it's a left action, so it needs <code>R</code> to be commutative; it's more natural having a right action, where <code>(f r) x = (f x) r</code>.  If you're one of those people who like writing homomorphism application on the right (since then <code>(a x) f = a (x f)</code> for <code>a : R</code>, <code>x : M</code>, and <code>f : M -&gt; R</code>) then the right action looks like <code>x (f r) = (x f) r</code>, i.e., it's something that satisfies a kind of associativity.</p>",
        "id": 310673925,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668710393
    },
    {
        "content": "<p>I think I agree with <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/Bounded.20bilinear.20forms/near/262187974\">in that thread</a> that we should be able to work directly with semilinear forms (<code>M₁ →ₛₗ[I₁] M₂ →ₛₗ[I₂] R</code>) and bilinear forms (<code>M₁ →ₗ[R] M₂ →ₗ[R] R</code>) without needing extra definitions.</p>\n<p>Maybe it would be nice having an abbreviation for <code>M₁ →ₗ[R] M₂ →ₗ[R] R</code> like <code>bilin_form R M₁ M₂</code> just to keep the expression simpler for both humans and Lean.</p>",
        "id": 310675731,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668710980
    },
    {
        "content": "<p><del>I don't understand your parens; did you mean <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">f(xr) = f(x)r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>?</del></p>",
        "id": 310719778,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668727970
    },
    {
        "content": "<p>If so, that's <code>f : M →ₗ [Rᵐᵒᵖ] M</code></p>",
        "id": 310719888,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668728038
    },
    {
        "content": "<blockquote>\n<p>Maybe it would be nice having an abbreviation ....</p>\n</blockquote>\n<p>I said exactly that in the previous thread :)</p>",
        "id": 310720028,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668728105
    },
    {
        "content": "<p>So to clarify my earlier comment; <code>f : M →ₗ[Rᵐᵒᵖ] M →ₗ[R] R</code> means</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">m1</span> <span class=\"bp\">&lt;•</span> <span class=\"n\">r1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">r2</span> <span class=\"bp\">•&gt;</span> <span class=\"n\">m2</span><span class=\"o\">)</span> <span class=\"bp\">=</span>\n<span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">m1</span> <span class=\"bp\">&lt;•</span> <span class=\"n\">r1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">r2</span> <span class=\"bp\">•&gt;</span> <span class=\"n\">m2</span><span class=\"o\">)</span> <span class=\"bp\">=</span>\n<span class=\"n\">f</span> <span class=\"n\">m1</span> <span class=\"o\">(</span><span class=\"n\">r2</span> <span class=\"bp\">•&gt;</span> <span class=\"n\">m2</span><span class=\"o\">)</span> <span class=\"bp\">&lt;•</span> <span class=\"n\">r1</span> <span class=\"bp\">=</span>\n<span class=\"n\">r2</span> <span class=\"bp\">•&gt;</span> <span class=\"n\">f</span> <span class=\"n\">m1</span> <span class=\"n\">m2</span> <span class=\"bp\">&lt;•</span> <span class=\"n\">r1</span> <span class=\"bp\">=</span>\n</code></pre></div>",
        "id": 310720795,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668728532
    },
    {
        "content": "<p>But if you don't want anything stronger than <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>r</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(xr,y) = f(x,ry)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ry</span><span class=\"mclose\">)</span></span></span></span> (i.e no pulling r outside of f) then I think semilinear maps won't help here however you parametrize them</p>",
        "id": 310721693,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668728864
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306601\">Kyle Miller</span> <a href=\"#narrow/stream/116395-maths/topic/.60bilinear_form.60/near/310675731\">said</a>:</p>\n<blockquote>\n<p>I think I agree with <span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/Bounded.20bilinear.20forms/near/262187974\">in that thread</a> that we should be able to work directly with semilinear forms (<code>M₁ →ₛₗ[I₁] M₂ →ₛₗ[I₂] R</code>) and bilinear forms (<code>M₁ →ₗ[R] M₂ →ₗ[R] R</code>) without needing extra definitions.</p>\n</blockquote>\n<p>yes, this is what I was doing. We have all the things from <code>bilinear_form</code> and <code>matrix.bilinear_form</code> ported to <code>M₁ →ₗ[R] M₂ →ₗ[R] R</code> (and generalized where it was easy enough), but there are still dependencies on <code>bilinear_form</code>, so we cannot delete it at the moment.</p>",
        "id": 310722017,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668728948
    },
    {
        "content": "<p>Yes, basically <code>bilin_form</code> is deprecated, and we should really get around to porting the code that depends on it to <code>M₁ →ₗ[R] M₂ →ₗ[R] R</code>.</p>",
        "id": 310728019,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1668731409
    },
    {
        "content": "<p>I know and I feel bad for not doing it, but it is really just tedious work..</p>",
        "id": 310728163,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668731468
    },
    {
        "content": "<p>Yeah -- that's why I haven't done it either :-)</p>",
        "id": 310728856,
        "sender_full_name": "Frédéric Dupuis",
        "timestamp": 1668731934
    },
    {
        "content": "<p>Then get an undergraduate to help!</p>",
        "id": 310761189,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1668755975
    },
    {
        "content": "<p>I have no teaching duties, so I don't know the undergrads. and I am afraid that any undergrad would never ever want to use Lean again if they started doing that</p>",
        "id": 310761481,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668756146
    },
    {
        "content": "<p>and didn't you complain that this was done too much in informal maths? <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 310761787,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668756361
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"412682\">@Moritz Doll</span> If you want help with this, doing tedious work to check things off from the undergrad list is part of my job description right now. Is there a branch with partial work somewhere? Is the first step dealing with everything that depends on <code>bilin_form</code>?</p>",
        "id": 310783048,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668765553
    },
    {
        "content": "<p>Let me just mention that this currying strategy won't work forever: in general topological vector spaces, <code>E →L[R] F →L[R] G</code>does <em>not</em> correspond to continuous bilinear maps. Of course that doesn't mean we should keep the distinction in the algebraic case, but it is something to keep in mind.</p>",
        "id": 310784021,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1668765859
    },
    {
        "content": "<p>I've made a roadmap here <a href=\"https://github.com/leanprover-community/mathlib/pull/15907\">#15907</a>. The quadratic forms are probably the most annoying part of it. I have started it here <a href=\"https://github.com/leanprover-community/mathlib/pull/17599\">#17599</a> I have no idea how awful it is to merge it with a recent <code>master</code>.</p>",
        "id": 310786122,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668766616
    },
    {
        "content": "<p>Do you mind if I start working on <a href=\"https://github.com/leanprover-community/mathlib/pull/17599\">#17599</a>?</p>",
        "id": 310789060,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668767617
    },
    {
        "content": "<p>of course not, I would be really happy to see if that stuff gets done.</p>",
        "id": 310796989,
        "sender_full_name": "Moritz Doll",
        "timestamp": 1668770408
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"412682\">Moritz Doll</span> <a href=\"#narrow/stream/116395-maths/topic/.60bilinear_form.60/near/310761481\">said</a>:</p>\n<blockquote>\n<p>I have no teaching duties, so I don't know the undergrads. and I am afraid that any undergrad would never ever want to use Lean again if they started doing that</p>\n</blockquote>\n<p>It may be hard to teach undergraduates. Some of graduate students in our university, majored in math and using Lean, even don't know what's an abelian group.</p>",
        "id": 310856241,
        "sender_full_name": "Meow",
        "timestamp": 1668787785
    },
    {
        "content": "<p>I've got almost halfway through <code>linear_algebra/quadratic_form/basic</code> and have pushed changes so far to <a href=\"https://github.com/leanprover-community/mathlib/pull/17599\">#17599</a></p>\n<p>The next thing is changing scalars:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">_root_.linear_map.comp_quadratic_form</span> <span class=\"o\">{</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n  <span class=\"o\">[</span><span class=\"n\">comm_semiring</span> <span class=\"n\">S</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">algebra</span> <span class=\"n\">S</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">module</span> <span class=\"n\">S</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">is_scalar_tower</span> <span class=\"n\">S</span> <span class=\"n\">R</span> <span class=\"n\">M</span><span class=\"o\">]</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">R</span> <span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">S</span><span class=\"o\">]</span> <span class=\"n\">S</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">quadratic_form</span> <span class=\"n\">R</span> <span class=\"n\">M</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">quadratic_form</span> <span class=\"n\">S</span> <span class=\"n\">M</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">to_fun</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"n\">x</span><span class=\"o\">),</span>\n  <span class=\"n\">to_fun_smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">b</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">Q.map_smul_of_tower</span> <span class=\"n\">b</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">f.map_smul</span><span class=\"o\">,</span> <span class=\"n\">smul_eq_mul</span><span class=\"o\">],</span>\n  <span class=\"n\">exists_companion'</span> <span class=\"o\">:=</span> <span class=\"kd\">begin</span>\n    <span class=\"n\">obtain</span> <span class=\"o\">⟨</span><span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">Q.exists_companion</span><span class=\"o\">,</span>\n    <span class=\"gr\">sorry</span>\n    <span class=\"c1\">--⟨f.comp_bilin_form B, λ x y, by simp_rw [h, f.map_add, linear_map.comp_bilin_form_apply]⟩</span>\n  <span class=\"kd\">end</span> <span class=\"o\">}</span>\n</code></pre></div>",
        "id": 310912647,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668802355
    },
    {
        "content": "<p>I'm not sure if it's missing from <code>linear_map/bilinear_map</code> or if I just haven't found it (or just don't have the right instance arguments), but what I'm looking for is a way to compose a <code>M →ₗ[R] M →ₗ[R] R</code> with a <code>R →ₗ[S] S</code> to get a <code>M →ₗ[S] M →ₗ[S] S</code>.</p>",
        "id": 310912978,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668802504
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/linear_algebra/bilinear_map.html#linear_map.compr%E2%82%82\"><code>linear_map.compr₂</code></a> would do it if both rings were the same.</p>",
        "id": 310913609,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1668802787
    },
    {
        "content": "<p>Looks like you need a two-argument version of restrict_scalars</p>",
        "id": 310933621,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1668810505
    }
]