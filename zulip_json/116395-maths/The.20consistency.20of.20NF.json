[
    {
        "content": "<p>I have recently been having a discussion with Randall Holmes (Boise State University) about his amazing proof of the consistency of Quine's New Foundations (NF) system for axiomatic set theory. This proof resolves a major question in logic that has been open since the 1930s. There is a little problem, however. Holmes's proof is so intricate that it has run into the same problem that Hales (and Ferguson) encountered with the (pre-Flyspeck) proof of the Kepler conjecture. Namely, the experts have taken a serious look, and believe that it is probably correct, but have not been able to understand the proof thoroughly enough to vouch for its correctness. Holmes has responded by trying to rewrite the proof in a simpler and more understandable manner, but his multiple rewrites have generated a new problem: Experts don't want to invest a lot of time studying a proof that is not stable and that might change from under their feet at any time. Even though Holmes announced the proof back in 2010, it has not yet been accepted for publication. I believe that the main obstacle is the difficulty of finding a referee who is willing to sign off on the paper.</p>\n<p>Holmes is proficient with proof assistants, so it might seem that the doubts about the correctness of his argument could be circumvented with a formal proof. A few years ago, I asked him exactly this question, and he said that he was seriously considering a formalization, but that the practical difficulties were formidable. We left it at that. In the meantime, of course, proof assistant technology has been steadily improving, and the community of users has been steadily growing. Recently, I raised the question with Holmes again, and suggested that Lean might be a good choice. Coincidentally, he had been thinking exactly the same thing. I have encouraged him to join this forum and share his thoughts in more detail.</p>\n<p>Originally, I was hoping that some people in the Lean community might be willing to help Holmes with his formalization efforts. After all, it seems that this is precisely the sort of difficulty that proof assistants ought to be able to help with, so a success story would presumably be good press for formal theorem proving in general. (I can already picture the Quanta magazine article in my mind's eye.) However, I have been cautioned that there aren't many people in the Lean community with an interest in logic. More generally, mathematical logic seems to be a \"low status\" area of mathematics, and the consistency of NF might seem totally uninteresting to the average \"mathematician in the street.\" So maybe there will be no takers. However, I figured that it couldn't hurt to ask, so that is why I am here. As I said, I am hoping that Holmes himself will chime in soon with further thoughts.</p>",
        "id": 271669288,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644640930
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478409\">@Timothy Chow</span> I understand that the proofs are long and complicated, but can you say a bit more about how long? Is there a PDF somewhere?</p>",
        "id": 271674760,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644650069
    },
    {
        "content": "<p>I found <a href=\"https://randall-holmes.github.io/Nfproof/newattempt.pdf\">https://randall-holmes.github.io/Nfproof/newattempt.pdf</a> , which is... 45 pages?</p>",
        "id": 271675377,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1644650908
    },
    {
        "content": "<p>Just looking at the length of the paper, I would guess it could be formalized in about 6 months. However, are there any prerequisites?</p>",
        "id": 271679975,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1644658299
    },
    {
        "content": "<p>Yael are you in any position to make this estimate? If I gave you the Taylor-Wiles paper which proved Fermat's Last Theorem that's just some stupid lemma in algebra and it's about 30 pages. How long do you think that would take?</p>",
        "id": 271680173,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644658577
    },
    {
        "content": "<p>Yeah, that's why I said \"Just looking at the length of the paper\" <span aria-label=\"stuck out tongue\" class=\"emoji emoji-1f61b\" role=\"img\" title=\"stuck out tongue\">:stuck_out_tongue:</span></p>",
        "id": 271680200,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1644658638
    },
    {
        "content": "<p>And the other question is where are you going to find the person/people to do it?</p>",
        "id": 271680208,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644658645
    },
    {
        "content": "<p>I think that right now that's a big part of the problem unless some logicians come out of the woodwork. Patrick. Johan and I spent a year of our lives doing perfectoid and it attracted perfectoid people, but I suspect that starting will be the hard part. Of course the best possible solution is that Holmes works on it themselves -- that's what Hales did to get himself out of the mess he found himself in.</p>",
        "id": 271680337,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644658820
    },
    {
        "content": "<p>Holmes will find plenty of support from the community here, but big formalision projects like LTE need leaders.</p>",
        "id": 271680376,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644658917
    },
    {
        "content": "<p>btw I found this when looking for potential summer project supervisors.</p>\n<blockquote>\n<p>There is a plan to get some money together for a Ph.D. studentship to do a formal verification of Holmes' proof of Con(NF). It's only at the design stage as yet, but if you are suitably qualified it would do you no harm to tell me about yourself. </p>\n</blockquote>\n<p><a href=\"https://www.dpmms.cam.ac.uk/~tf/\">https://www.dpmms.cam.ac.uk/~tf/</a></p>",
        "id": 271683397,
        "sender_full_name": "Shing Tak Lam",
        "timestamp": 1644663832
    },
    {
        "content": "<p>The leader would have to be Holmes himself. I don't think he knows Lean but he has experience with other proof assistants, and I think he's willing to put in the effort. As for Shing Tak Lam's comment, yes, I have been in touch with Thomas Forster, and while he is not going to participate in the formalization himself, he has said that he is eager to help in other ways. For example, he is organizing an NF meeting in Cambridge some time in May/June (exact date TBD), and he said, \"If there is a head of steam behind these Lean ideas (``The Lean Green Mean Machine proves Con(NF)!!'') then we can have part of the meeting devoted to it. The programme is entirely up for grabs at this stage.\" (By the way, Kevin, Thomas says hi.)</p>",
        "id": 271684983,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644666419
    },
    {
        "content": "<p>In terms of prerequisites, the good news is that (from a human point of view at least) there doesn't seem to be a huge amount of background material being relied on. However, if there isn't much support in Lean for logic and set theory, then what seems to a human to be modest prerequisites could of course be a tremendous amount of work. The primary difficulty for a human seems to be the intricacy of the new constructions, and the fact that there were some bugs in the earlier versions.</p>",
        "id": 271685644,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644667358
    },
    {
        "content": "<p>Independence of CH was done in Lean. So I guess that will cover some prerequisites. But this is very far from my home turf, so I really can't estimate the effort that is needed.</p>",
        "id": 271686654,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644668962
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/116395-maths/topic/The.20consistency.20of.20NF/near/271675377\">said</a>:</p>\n<blockquote>\n<p>I found <a href=\"https://randall-holmes.github.io/Nfproof/newattempt.pdf\">https://randall-holmes.github.io/Nfproof/newattempt.pdf</a> , which is... 45 pages?</p>\n</blockquote>\n<p>Reading the version notes and introduction make it very clear why nobody would trust this. So formalizing the proof would be a really really nice and useful achievement (assuming there are people who are interested in this result, but I trust Timothy here).</p>",
        "id": 271686660,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1644668982
    },
    {
        "content": "<p>Johan, I think the issue is that independence of CH never went to mathlib, so presumably the code is not super easy to reuse.</p>",
        "id": 271686719,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1644669020
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478409\">@Timothy Chow</span> Is there any way a lay person like me can get a feeling for what the impact of Con(NF) is for the \"working mathematician\" who is doing geometry or PDE's or number theory?</p>",
        "id": 271686721,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644669026
    },
    {
        "content": "<p>If NF disproves choice, I guess NF and ZF aren't really on speaking terms, are they?</p>",
        "id": 271686743,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644669063
    },
    {
        "content": "<p>Experience shows that it's extremely difficult to make accurate estimates about how long a formalision effort will take until a blueprint is written. The blueprint is a fully fleshed out explanation of the proof with no external references and everything brought down to stuff mathlib has already. A random throwaway comment in a paper which is unnoticed by a quick read-through can lead to a big rabbit hole or road block. An example is an application of Gordan's Lemma in the Scholze project. It's applied in the paper with the remark that it's a \"standard fact\". It's just some dumb assertion about monoids -- how hard can it be? The two proofs we found -- one used graded rings and one used results about convexity. I thought I'd try knocking off the graded ring proof but we didn't have graded rings at the time and it was hard to get these things right; a month later I still had no proof (and we might have even still been working on the definition). Bhavik Mehta then tried the convexity proof which turned out to be feasible given what we had already. This process ended up taking about two months, and it was one line in the paper.</p>",
        "id": 271686749,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644669087
    },
    {
        "content": "<p>Johan, we don't really need any impact for the working mathematician for this to be an interesting formalization challenge. We only need it to be interesting to a non-trivial amount of specialists in logic and set theory.</p>",
        "id": 271686753,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1644669102
    },
    {
        "content": "<p>Agreed, but I'm just curious</p>",
        "id": 271686800,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644669139
    },
    {
        "content": "<p>If NF disproves choice then you already have your answer.</p>",
        "id": 271686805,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1644669156
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/The.20consistency.20of.20NF/near/271686749\">said</a>:</p>\n<blockquote>\n<p>Experience shows that it's extremely difficult to make accurate estimates about how long a formalision effort will take until a blueprint is written. The blueprint is a fully fleshed out explanation of the proof with no external references and everything brought down to stuff mathlib has already. A random throwaway comment in a paper which is unnoticed by a quick read-through can lead to a big rabbit hole or road block. An example is an application of Gordan's Lemma in the Scholze project. It's applied in the paper with the remark that it's a \"standard fact\". It's just some dumb assertion about monoids -- how hard can it be? The two proofs we found -- one used graded rings and one used results about convexity. I thought I'd try knocking off the graded ring proof but we didn't have graded rings at the time and it was hard to get these things right; a month later I still had no proof (and we might have even still been working on the definition). Bhavik Mehta then tried the convexity proof which turned out to be feasible given what we had already. This process ended up taking about two months, and it was one line in the paper.</p>\n</blockquote>\n<p>I remember this process quite well <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span></p>",
        "id": 271686815,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1644669176
    },
    {
        "content": "<p>The fact that the CH stuff didn't make it into mathlib is another serious issue. My MSc project student Joseph Hua needed some results on model theory for his thesis but already the stuff in the CH repo had rotted quite badly, and when Joseph tried to use an old version of mathlib in order to be able to use it there was then of course a bunch of stuff in mathlib master which he couldn't get to (in particular Chris Hughes' work on the classification of algebraically closed fields, which was also crucial for Joseph). This presented us with a genuine problem until <span class=\"user-mention\" data-user-id=\"308899\">@Yakov Pechersky</span> out of the blue bumped the model theory part of the CH repo to compile with mathlib master thus enabling Joseph's project to get off the ground and saving the project. Yakov I am still extremely grateful for this!</p>",
        "id": 271687050,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644669540
    },
    {
        "content": "<p>Kevin and Johan, remember you still have homework to do to put perfectoid spaces into mathlib. Almost all the topology parts went in.</p>",
        "id": 271687118,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1644669630
    },
    {
        "content": "<p>When I've finished my course at the end of March I will be completely free and will have 100% of my time available for this job Patrick</p>",
        "id": 271687222,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644669836
    },
    {
        "content": "<p>More seriously the topology parts were essential for Maria, who is now beginning to PR her work to mathlib</p>",
        "id": 271687290,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644669923
    },
    {
        "content": "<p>Bringing stuff to mathlib is the kind of dirty work I could do. What's the current status of bringing Flyspeck to mathlib? I saw <code>model_theory</code> got quite a lot of new files recently.</p>",
        "id": 271690406,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1644674638
    },
    {
        "content": "<p>There are plenty of projects out there with <code>to_mathlib</code> folders :-) (perfectoid, CH, FLT-regular, Scholze)</p>",
        "id": 271690693,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644675060
    },
    {
        "content": "<p>Still waiting to know from <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span>  what's happening with <code>nnrat</code>.</p>",
        "id": 271690753,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1644675141
    },
    {
        "content": "<p>The consistency of NF would have zero practical impact on the mathematician doing PDEs or number theory, just as the consistency (or inconsistency, for that matter!) of ZF would have zero practical impact. A major motivation for NF was to take a different approach (from ZF) to avoiding the classical paradoxes. The underlying philosophy behind ZF is that the fundamental cause of the paradoxes is the lack of well-foundedness, and that if you just build the cumulative hierarchy from the ground up, then all will be well. NF, which was introduced by Quine, instead takes its cue from (Quine's) type theory. Impredicativity, or self-reference if you will, is avoided by restricting statements to \"talking about\" entities of lower type. The trouble with this brand of type theory is that all those subscripts are unworkable in practice for doing mathematics. To circumvent that, Quine introduced the concept of \"stratification.\" This is a rather technical concept and I won't go into it here; the Stanford Encyclopedia of Philosophy article on NF provides a good introduction if you want to delve further. In any case, the point is that the motivation for NF is primarily philosophical rather than practical. In fact, some (including Holmes) would argue that any philosophical concerns that would be addressed by a consistency proof of NF have already been addressed by the (known) consistency proof of the variant of NF known as NFU. (But there are important differences between NF and NFU; for example, the standard proofs that NF implies the axiom of infinity and refutes the full axiom of choice don't carry over to NFU.) So arguably the main interest of Con(NF) is really that it is a natural problem that has defied solution for a long time, indicating that we don't understand some basic concepts (sets, types) as well as one might think.</p>\n<p>As for the axiom of choice, the fact that NF disproves full AC doesn't mean that \"NF and ZF aren't on speaking terms.\" I believe that NF is not known to disprove weaker forms of AC such as DC (the axiom of dependent choice), which covers most uses of choice that you need in practice.</p>",
        "id": 271691160,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644675759
    },
    {
        "content": "<p>Thank you very much for that explanation!</p>",
        "id": 271694487,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1644680422
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/116395-maths/topic/The.20consistency.20of.20NF/near/271690406\">said</a>:</p>\n<blockquote>\n<p>Bringing stuff to mathlib is the kind of dirty work I could do. What's the current status of bringing Flyspeck to mathlib? I saw <code>model_theory</code> got quite a lot of new files recently.</p>\n</blockquote>\n<p>I've been putting those files in <code>model_theory</code>- there's quite a bit of stuff now, but nowhere near all of Flypitch (and a decent amount is kind of orthogonal to what they did in Flypitch). I know very, very little about NF, and less about this proof, but I think we could have the general model-theoretic foundations required within a few months if there was actual interest.</p>",
        "id": 271696333,
        "sender_full_name": "Aaron Anderson",
        "timestamp": 1644683023
    },
    {
        "content": "<p>However, I imagine that that's not really the hard part, as the hard part is probably more to do with the underlying set theory/infinite combinatorics, and/or totally unique things to this proof.</p>",
        "id": 271696665,
        "sender_full_name": "Aaron Anderson",
        "timestamp": 1644683460
    },
    {
        "content": "<p>I asked Thomas Forster if he had anything to add to what I said about NF. He says that when people ask if NF and ZF are in conflict, he points out that NF has a concept of a well-founded set, and there is nothing to suggest that NF proves anything about well-founded sets that contradicts anything in ZF. Quote: \"It is a long-standing conjecture in NF studies that every model of ZF (Zermelo, or KP even) has an end-extension with the same well-founded sets that is a model of NFD.\"</p>",
        "id": 271696890,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644683788
    },
    {
        "content": "<p>I read this paper when it came out and was very excited to finally see the resolution of the NF consistency question, and I think that lean would be a great setting to formalize this proof. I could be missing something like Kevin's example of the throwaway comment in LTE, but this kind of logic is fairly self contained and it looks significantly easier than LTE. I would estimate closer to 1 month if you have at least one experienced formalizer and one person who knows the mathematics and can elaborate on skipped steps.</p>",
        "id": 271712883,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644704726
    },
    {
        "content": "<p>I would volunteer myself but I definitely don't have the time to take on a project of this size right now. But I'm happy to help on the edges</p>",
        "id": 271712963,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644704833
    },
    {
        "content": "<p>Holmes' proof is a gigantic Fraenkel-Mostowski construction.   It could be that a good start (a dry run) would be for someone to do a Lean proof of a simple FM proof.  For example the original one that shows that the class of sets hereditarily of finite support does not obey AC for pairs. I am guessing that this would be comparatively straightforward.   Any difficulties that do in fact show up would certainly show themselves in the Lean execution of Holmes' proof.   So i would expect the exercise to be either easy or reassuring, or possibly both.   With any luck i might persuade two of our local Leanies in Cambridge to tackle it for a summer project.</p>",
        "id": 271749497,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1644763748
    },
    {
        "content": "<p>Hello Tom! Yeah there's a lean club in Cambridge, it meets on Wednesdays. <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> will know the details</p>",
        "id": 271751028,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644766015
    },
    {
        "content": "<p>For those who know about the existing model theory code in Lean, do you think that any of it will help with the Fraenkel-Mostowski construction that Thomas Forster is suggesting? F-M constructions per se don't show up in the proof of the independence of CH, but there could still be something useful in flypitch. What about really basic stuff such as support for cardinals and ordinals?</p>",
        "id": 271758451,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644776619
    },
    {
        "content": "<p>Please note that I am here.  I am not proficient in Lean:  but I do write proof assistants myself, and I have experience using my own, and I think I can learn Lean.  I have looked over it in the past.  My proof is large, badly written (I have on good authority) and requires prerequisites in model theory (standard stuff) and set theory.  It is an FM construction and does not involve forcing.</p>\n<p>The proof comes in a number of different versions.  It presents serious difficulties of exposition.  There is no need to think about stratification:  the formalization need not handle NF directly at all, but merely construct a model of an auxiliary theory called \"tangled type theory\".  No one doubts that consistency of tangled type theory, or alternatively the existence of something called a \"tangled web of cardinals\" in ZF or probably even Mac Lane set theory without choice, implies Con(NF).  That can be written in a few pages, and everyone able to read it believes it:  it is a variation on Jensen's proof of Con(NFU).  What is monstrous is the FM construction of these tangled things.</p>",
        "id": 271758575,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644776802
    },
    {
        "content": "<p>The NF meeting at which these matters <em>might</em> be discussed will take place in Cambridge some time after Randall Holmes arrives in Cambridge soon after 15/v and before i leave at the start of July.   Recruitment will be word-of-mouth</p>",
        "id": 271758792,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1644777164
    },
    {
        "content": "<p>Welcome, Randall! I wonder if some of the more experienced folks around here can suggest what first steps he should take?</p>",
        "id": 271758807,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644777228
    },
    {
        "content": "<p>Not that it would be at all a bad idea to prove  Con(NFU) following Jensen, which would give a model to do the entire proof of Con(NF).</p>",
        "id": 271758862,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644777329
    },
    {
        "content": "<p>I have a good formal idea of what formal steps to take, but local conditions of course I do not know. </p>\n<ol>\n<li>\n<p>I need to target exactly what to prove.  This might for example be Con(TTT) rather than Con(NF).  this then conditions:</p>\n</li>\n<li>\n<p>Determine what the prerequisites are and what might already exist.  Certainly work on FM methods is needed.</p>\n</li>\n</ol>\n<p>I am leaving out</p>\n<ol start=\"0\">\n<li>Learn basics of Lean.  I can do this ;-)</li>\n</ol>",
        "id": 271759009,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644777513
    },
    {
        "content": "<p>I suspect that a good preliminary step would be to spell out the \"standard stuff\" from model theory and set theory that is going to be needed. Kevin's cautionary LTE tale about the one-line throwaway comment (regarding a standard fact that took two months to prove) strongly suggests that it is important to be explicit about these \"standard\" prerequisites, especially since it sounds like they might not already be in Lean.</p>",
        "id": 271759038,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644777602
    },
    {
        "content": "<p>It is worth remarking that my proof (assuming validity) settles that the mathematics of familiar structures is the same in NF as in ZF (mod the fact that ZF contains much stronger assumptions about large cardinals);  certainly DC is consistent with NF, and so is well orderability of the continuum, or any familiar small mathematical structure.  It is NOT evident from previous work that NF is consistent with DC or the continuum being well ordered;  though certainly most NFistes believe that.</p>",
        "id": 271759298,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644777952
    },
    {
        "content": "<p>On a side note, the posted versions on my web page may not be up to date at the moment.  I have spent the last few months working on two different new drafts in parallel, trying to deal with the problems in the exposition.</p>",
        "id": 271759538,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644778242
    },
    {
        "content": "<p>The part linking Con(NF) to existence of a tangled web of cardinals or to tangled type theory is absolutely solid and indeed doesnt strictly need to be formalized (though it would be no bad thing to do so).  It is a retread of Jensen's proof of Con(NFU).  But the construction of models of either of those things is hard, and hard to follow because what is being done is complicated and unfamiliar.</p>",
        "id": 271759685,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644778421
    },
    {
        "content": "<p>and for those without experience with this branch of mathematics, verifying Jensen's proof of Con(NFU) and adapting it to show that the consistency of tangled type theory or the existence of a tangled web of cardinals implies Con(NF) would </p>\n<p>a.  be a substantial amount of work and </p>\n<p>b.  have no bearing on and provide no assistance with the really needed consistency proof of tangled type theory or a tangled web of cardinals, which would be conducted in ordinary set theory of some flavor (and yes, with choice in the background, though it would be factored out by an FM construction), oh and </p>\n<p>c.  be a Very Good Thing in itself.</p>",
        "id": 271759837,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644778659
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> are you able to state in lean the main theorems in this paper (the tangled type theory assertion and the consistency of NF)? Or at least sketch what you would envisage the assertion looking like (the \"shape\")? One could imagine starting a new lean project called con-nf or con_nf or whatever, and put a file in <code>src/</code> containing a statement of the main theorem. This would be a way to begin to understand what the actual job will entail. By the way lean does have a theory of cardinals and ordinals (thanks to Mario), and <span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hernández</span> has been proving theorems about them, there's occasionally discussions of her work on the Discord.</p>",
        "id": 271764463,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644785016
    },
    {
        "content": "<p>I will say that it is much easier to formulate the goal as \"prove the existence of a tangled web of cardinals\" or even \"construct a model of NF\" rather than \"prove Con(NF)\", because this last statement involves a bunch of proof theory that is only marginally involved since we want to immediately defer to the model theoretic perspective by constructing a model, after which point we don't need formal syntax anymore</p>",
        "id": 271766425,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644787636
    },
    {
        "content": "<p>From what Randall says it sounds like that last step is not questionable, so it would be suitable to be deferred after the main part of the proof (like we did for LTE)</p>",
        "id": 271766497,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644787746
    },
    {
        "content": "<p>Replying to Kevin,  I have to learn Lean first ;-)  I know what kind of thing it is, but  I don't know the details.  Mod that, I  should probably be able to state what has to proved, in the course of which I would have to describe intermediate concepts which have to be developed if they do not exist.</p>\n<p>There are steps.  My guess is that formulating the statement \"There is a model of tangled type theory\" would be <em>relatively</em> easy (and reveal requirements).  This definition will involve some formal syntax, unfortunately.</p>\n<p>Formulating the description of the structure which I claim is a model of tangled type theory would be harder and longer, and probably reveal more requirements.</p>\n<p>Formulating the proof that the structure described in part 2 really is a witness to the statement in part 1 will be horrible.</p>",
        "id": 271766839,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644788262
    },
    {
        "content": "<p>Replying to Mario, Constructing a model of NF would not be easier.  I precisely do not directly construct or describe a model of NF, though one can tell from the proof various things about what one would be like.  The relative consistency proof Con(TTT) -&gt; Con(NF) handles all of that.</p>",
        "id": 271766976,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644788443
    },
    {
        "content": "<p>I do very concretely describe and verify a model of Con(TTT) in that version of the proof.</p>",
        "id": 271767006,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644788506
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478605\">@Randall Holmes</span> How do the statements  \"There is a model of tangled type theory\" and \"there is a tangled web of cardinals\" compare?</p>",
        "id": 271767681,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644789560
    },
    {
        "content": "<p>They are closely related.  One is an assertion about cardinal arithmetic in ZF (or Zermelo or Mac Lane set theory) which is inconsistent with choice.  One is the assertion of a model of a certain very strange type theory.  Both involve the ability to say that a sentence is true in a structure, unfortunately:  formal syntax will be involved.   The model of type theory in the TTT approach is described as a structure in an ambient ordinary set theory (with choice);  the proof of existence of a tangled web is carried out by FM methods starting in a model of ordinary set theory with choice.  The difference between the two approaches is a style difference: the tangled web approach is the one I took initially and is friendlier to state;  but I think the technicalities may be easier in the TTT approach.  Both approaches were evidently possible from the time of my 1995 paper.  FM methods are also implicit in the TTT approach.<br>\nI dont recommend reading my 1995 paper;  read the preamble to the current paper.</p>\n<p>One of my Tasks if we are to do this is to prune the stuff presented on my web page at the moment, and just give two papers, one for each approach.</p>",
        "id": 271767999,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644789899
    },
    {
        "content": "<blockquote>\n<p>One is an assertion about cardinal arithmetic in ZF (or Zermelo or Mac Lane set theory) which is inconsistent with choice.</p>\n</blockquote>\n<p>Hm, that's too bad, if you mean the tangled web here. I was hoping this one could be written directly in lean without further embedding</p>",
        "id": 271768096,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790053
    },
    {
        "content": "<p>Ill be concrete:  one has to be able to talk about what sentences are satisfied in the natural model of the simple typed theory of sets with the base type of a given cardinality.</p>",
        "id": 271768168,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790125
    },
    {
        "content": "<p>Is \"the natural model of the simple typed theory of sets\" defined explicitly in the paper?</p>",
        "id": 271768182,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790165
    },
    {
        "content": "<p>that sounds like a good place to start</p>",
        "id": 271768186,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790177
    },
    {
        "content": "<p>Yes.  That is easy:  it is the natural model whose types are the base type and its iterated power sets, with the membership and equality of the ambient set theory inherited.  One has to deal in one of a couple of ways with the fact that the iterated power sets might overlap, but that is an imagined horror.  And of course that is the power set of an FM model.</p>",
        "id": 271768254,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790273
    },
    {
        "content": "<p>how many times iterated? I guess we have axiom of replacement here so that any set has cardinality less than the ordinals?</p>",
        "id": 271768438,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790539
    },
    {
        "content": "<p>a finite number of times in each instance, actually.</p>",
        "id": 271768498,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790575
    },
    {
        "content": "<p>But one needs to be able to handle any finite number of types, so being able to talk about the model of omega types might be useful.</p>",
        "id": 271768549,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790673
    },
    {
        "content": "<p>hm, I could use a precise description then since I can't quite picture it</p>",
        "id": 271768550,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790674
    },
    {
        "content": "<p>If you just take all the finite powersets of the base type you will get a model in which the ordinals are omega, right?</p>",
        "id": 271768620,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790745
    },
    {
        "content": "<p>The von Neumann definition of ordinals is wrong in this context.  Think of Scott ordinals.</p>",
        "id": 271768686,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790817
    },
    {
        "content": "<p>If you want to talk about what ordinals can be represented, in V_omega*2 the ordinals certainly dont stop at omega.  But the von Neumann definition is not the right one.</p>",
        "id": 271768725,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790915
    },
    {
        "content": "<p>But you can use von Neumann ordinals in your metatheory to your heart's content, I hasten to add.</p>",
        "id": 271768780,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644790958
    },
    {
        "content": "<p>well I'm mostly just looking for a precise description that can be leanified. Is it something like this:</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub><mo>=</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">M_0=A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant=\"script\">P</mi><mo stretchy=\"false\">(</mo><msub><mi>M</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">M_{n+1}=\\mathcal{P}(M_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mo>⋃</mo><mrow><mi>n</mi><mo>&lt;</mo><mi>ω</mi></mrow></msub><msub><mi>M</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">M=\\bigcup_{n&lt;\\omega}M_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0771em;vertical-align:-0.3271em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">⋃</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0777em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mrel mtight\">&lt;</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3271em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>",
        "id": 271768781,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644790958
    },
    {
        "content": "<p>Im getting to that.  Its roughly like that but with technical refinements.   M_0 is a set of atoms. (we might as well use ZFA since we are doing FM constructions anyway) of the cardinal kappa of interest</p>\n<p>M_n+1 is the power set of M_n, with the empty set replaced by an atom emptyset_n+1, these being different with different indices</p>\n<p>The modifications ensure that the types do not overlap, which avoids technical issues</p>\n<p>Then it is straightforward that the first order theory of the model is entirely determined by the cardinality of the base set</p>",
        "id": 271768916,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791127
    },
    {
        "content": "<p>and then part of the description of the tangled web of cardinals involves facts about sentences satisfied by this model for cardinals in the web</p>",
        "id": 271769003,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791264
    },
    {
        "content": "<p>types not overlapping is actually the easy case in type theory</p>",
        "id": 271769009,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791275
    },
    {
        "content": "<p>Of course, and that is why I want to get to it</p>",
        "id": 271769054,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791295
    },
    {
        "content": "<p>So you want something like this:</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub><mo>=</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">M_0=A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>M</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi mathvariant=\"script\">P</mi><mo stretchy=\"false\">(</mo><msub><mi>M</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">M_{n+1}=\\mathcal{P}(M_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi mathvariant=\"normal\">Σ</mi><mrow><mi>n</mi><mo>&lt;</mo><mi>ω</mi></mrow></msub><msub><mi>M</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">M=\\Sigma_{n&lt;\\omega}M_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8607em;vertical-align:-0.1774em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2274em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mrel mtight\">&lt;</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">ω</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1774em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n</ul>",
        "id": 271769068,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791338
    },
    {
        "content": "<p>Notice that is really M_kappa,n -- the model has a parameter kappa, the cardinality of the base type.  Which is not an ordinal, it is a Scott cardinal, in a context where choice wont hold.</p>",
        "id": 271769085,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791377
    },
    {
        "content": "<p>Yes, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> is a parameter to the construction, it's your type of atoms</p>",
        "id": 271769132,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791404
    },
    {
        "content": "<p>and its cardinality is presumably important here</p>",
        "id": 271769141,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791415
    },
    {
        "content": "<p>M_n+1 = P(M_n) - {emptyset) + {emptyset_n+1}</p>",
        "id": 271769152,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791430
    },
    {
        "content": "<p>it isnt a type of atoms, its a set of atoms in a background untyped theory</p>",
        "id": 271769165,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791463
    },
    {
        "content": "<p>and |A| is the real parameter of interest</p>",
        "id": 271769170,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791477
    },
    {
        "content": "<p>You don't need to swap out empty sets with the construction I just mentioned, because they are disjointified by the construction of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span></p>",
        "id": 271769217,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791523
    },
    {
        "content": "<p>the sigma there means disjoint union</p>",
        "id": 271769229,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791535
    },
    {
        "content": "<p>That is all in the tangled web approach</p>",
        "id": 271769236,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791541
    },
    {
        "content": "<p>or one way of doing it</p>",
        "id": 271769244,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791557
    },
    {
        "content": "<p>Oh I see, of course.  But Im working in an ambient untyped theory in that approach.   I would have to think about what things would look like in a typed metatheory.</p>",
        "id": 271769337,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791670
    },
    {
        "content": "<p>It might be perfectly adaptable to that environment, but I havent thought of it that way.</p>",
        "id": 271769378,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791732
    },
    {
        "content": "<p>Right, that's going to be part of the formalization since you're working in lean. It usually isn't a huge difference, but sometimes you can avoid some awkwardness of ZF style constructions</p>",
        "id": 271769387,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791749
    },
    {
        "content": "<p>in particular, disjoint union is more natural than union in type theory</p>",
        "id": 271769429,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791776
    },
    {
        "content": "<p>so I would avoid plain union unless it's required by the construction</p>",
        "id": 271769434,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791792
    },
    {
        "content": "<p>I know this very well.  I just havent thought of what the proof would look like in that metatheory.</p>",
        "id": 271769440,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791805
    },
    {
        "content": "<p>It might be very nice.</p>",
        "id": 271769450,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791825
    },
    {
        "content": "<p>Still horrible, but it might be managed just fine in that framework.</p>",
        "id": 271769466,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791859
    },
    {
        "content": "<p>You mention that the metatheory needs a set of atoms (you have ZFA as the metatheory). This seems odd to me - don't you need to constrain the atoms in some way? Otherwise you could just say at the end of the construction that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> was empty after all and it was really a construction in ZF</p>",
        "id": 271769520,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791901
    },
    {
        "content": "<p>In lean, I think that will probably just be a type parameter to the entire construction</p>",
        "id": 271769524,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791926
    },
    {
        "content": "<p>No, the set of atoms has to be large.  This is specified.  Then one applies permutations to it.</p>",
        "id": 271769529,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791933
    },
    {
        "content": "<p>are there any constraints other than cardinality? You used named empty-set atoms in the construction</p>",
        "id": 271769546,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644791978
    },
    {
        "content": "<p>It has structure, probably many types of atoms in a formalization in that metatheory.  Types of atoms indexed by finite sets of ordinals taken from a limit ordinal lambda</p>",
        "id": 271769548,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644791987
    },
    {
        "content": "<p>The named empty sets were just a gadget to make the types disjoint</p>",
        "id": 271769593,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792019
    },
    {
        "content": "<p>gotcha</p>",
        "id": 271769595,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792025
    },
    {
        "content": "<p>How do you access the structure on the atoms in the construction? I.e. how do you use this \"finite sets of ordinals taken from a limit ordinal\"</p>",
        "id": 271769619,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792112
    },
    {
        "content": "<p>The types of atoms are all in the metatheory of the same size, a strong limit cardinal mu.  They would be indexed by nonempty finite subsets of a limit ordinal lambda.  The construction absolutely would not work if the sets of atoms were empty.</p>",
        "id": 271769656,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792126
    },
    {
        "content": "<p>I'm wondering if some other indexing mechanism is viable, for example <code>list V</code> where <code>V</code> is a type with cardinality mu</p>",
        "id": 271769688,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792196
    },
    {
        "content": "<p>That is complicated.  It is described in the paper, of course.  And I must stop this fascinating conversation for the present and write some class notes for an undergraduate class :-(  You have put a bee in my bonnet.</p>",
        "id": 271769694,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792218
    },
    {
        "content": "<p>Can you point me to where in the paper this is addressed? You don't have to cover it here of course, I'm looking for pointers</p>",
        "id": 271769747,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792254
    },
    {
        "content": "<p>Before you can talk about how the structure could be modified, you have to know what is going to be done with it.  That is...tangled<br>\nThe indexing by finite subsets of a limit ordinal is natural to the application.</p>",
        "id": 271769754,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792273
    },
    {
        "content": "<p>that's fair. It's also possible to use finite sets for indexing here, but there might be some trivial optimizations possible in the new metatheory</p>",
        "id": 271769794,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792341
    },
    {
        "content": "<p>Look at the definition of a tangled web of cardinals.  and the proof that if there is one, NF is consistent.  But I also want to point you to the right version of the paper.  Let's continue this later.  In the interim, I might purge the various drafts there and put up the exact ones I would want participants in this conversation to look at.</p>",
        "id": 271769850,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792383
    },
    {
        "content": "<p>That definition and proof are stable in any version of the paper, though.</p>",
        "id": 271769862,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792406
    },
    {
        "content": "<p>and solid.  They are unfamiliar to most people, but anyone who knows Jensen's proof has accepted this after a few questions.</p>",
        "id": 271769877,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1644792448
    },
    {
        "content": "<p>I'll be looking at <a href=\"https://randall-holmes.github.io/Nfproof/newattempt.pdf\">https://randall-holmes.github.io/Nfproof/newattempt.pdf</a> until you suggest otherwise</p>",
        "id": 271770001,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644792615
    },
    {
        "content": "<p>Question: what is the powerset of an atom in ZFA? It seems like a naive reading of <code>{x | x ⊆ S}</code> and <code>x ⊆ y ↔ ∀ z, z ∈ x → z ∈ y</code> would have every atom being a subset of every other atom, and therefore every powerset contains every atom, but this seems bad. Should <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">{</mo><mi>a</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">{\\mathcal P}(a) = \\{a\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">}</span></span></span></span>? <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∅</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">{\\mathcal P}(a) = \\{\\emptyset, a\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">∅</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">}</span></span></span></span>? <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∅</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">{\\mathcal P}(a) = \\{\\emptyset\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">∅</span><span class=\"mclose\">}</span></span></span></span>?</p>",
        "id": 271789554,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644821262
    },
    {
        "content": "<p>Certainly an atom should not be a subset of an atom because an atom is not a set. The standard approach is to make axioms empty, so P(a) = {{}}. <a href=\"https://ncatlab.org/nlab/show/ZFA\">https://ncatlab.org/nlab/show/ZFA</a></p>\n<p>By the way, I might be jumping the gun a bit, but I propose naming this project \"Conifer.\" Like \"Flyspeck,\" it's a quasi-acronym (for Con(NF)).</p>",
        "id": 271800988,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644830347
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478409\">@Timothy Chow</span> My point is that <em>since</em> atoms are empty, they are subsets of the empty set: they satisfy <code>∀ z, z ∈ a → z ∈ ∅</code> vacuously. So either the definition of the powerset or the definition of subset has to be modified somehow if we want to not accidentally pick up all the atoms in every powerset.</p>",
        "id": 271802483,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644831231
    },
    {
        "content": "<p>Here's a first shot at the main definitions of the paper: <a href=\"https://gist.github.com/digama0/1e3cf75427b0caffdac566d01a2e2bcb\">https://gist.github.com/digama0/1e3cf75427b0caffdac566d01a2e2bcb</a></p>\n<ul>\n<li>ZFA, normal filters, (hereditarily) symmetric, symmetric powerset</li>\n<li>Parameters of the construction</li>\n<li>Extended type indexes</li>\n<li>clans, atoms, litters, near litters, local cardinality</li>\n<li>strict dominance</li>\n<li>support order</li>\n<li>the groups <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>G</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">G_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></li>\n<li>The normal filter used in the construction</li>\n<li>The <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\tau(A)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span> function</li>\n<li>The properties of a tangled web</li>\n</ul>\n<p>The paper seems to be written in a very nonlinear style. In the last few parts we incur a dependency on the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Π</mi><mi>A</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Pi_A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">Π</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> function, which seems not to be defined until somewhere in the depths of the paper; there appears to be a giant recursion on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> involved, but the lack of explicit theorem statements makes it difficult to follow what is actually being proved in some parts. So the definition of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span> I think currently has a spurious dependency on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Π</mi></mrow><annotation encoding=\"application/x-tex\">\\Pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Π</span></span></span></span>.</p>",
        "id": 271803295,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644831761
    },
    {
        "content": "<p>I have no experience with Lean so I'm probably talking nonsense here, but ZFA, like the systems in Simpson's book, is two-sorted. Atoms and sets are two different sorts of things. I'm not even sure why you need to define P(a) where a is an atom; I figured it was out of convenience, like it's convenient to define 0/0 = 0.</p>",
        "id": 271819857,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644842163
    },
    {
        "content": "<p>If there's a formula in the paper that seems to be picking up atoms when it shouldn't, there's presumably an implicit restriction to sets somewhere.</p>",
        "id": 271821925,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644843400
    },
    {
        "content": "<p>One thing you can do is expand the language with a name for the empty set.</p>",
        "id": 271861477,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1644860510
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478605\">@Randall Holmes</span> Could you explain what's going on in the definition of a strong support order? I'm having trouble type checking it.</p>\n<blockquote>\n<ol start=\"2\">\n<li>If <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_β</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is a near-litter belonging to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>n</mi><mo stretchy=\"false\">[</mo><mi>B</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">clan[B]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">an</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">]</span></span></span></span> with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> strictly downward<br>\nextending <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>, then either the parent of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_β</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is an atom and either equal<br>\nto <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>γ</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_γ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> for some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi><mo>&lt;</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">γ &lt; β</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span> or not an element of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> at all, or there is a subset<br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">β</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span> such that the restriction of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>&lt;</mo><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">&lt;_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mrel\"><span class=\"mrel\">&lt;</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> is a <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>-strong support for<br>\nthe parent of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_β</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>.</li>\n</ol>\n</blockquote>\n<p>In the second part of the clause, we know that the parent of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span> is in the second case, that is, a subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"script\">P</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>c</mi><mi>l</mi><mi>a</mi><mi>n</mi><mo stretchy=\"false\">[</mo><mi>B</mi><mo>∪</mo><mo stretchy=\"false\">{</mo><mi>α</mi><mo stretchy=\"false\">}</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">{\\mathcal P}^*(clan[B\\cup\\{\\alpha\\}])</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.08222em;\">P</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">an</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">}])</span></span></span></span> for some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span> with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo>∪</mo><mo stretchy=\"false\">{</mo><mi>α</mi><mo stretchy=\"false\">}</mo><mo>≪</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B\\cup\\{\\alpha\\}\\ll B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≪</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>. We also know <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span> is some ordinal less than the order type of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>&lt;</mo><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">&lt;_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mrel\"><span class=\"mrel\">&lt;</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> is a subset of an ordinal. So it seems strange to be restricting <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>&lt;</mo><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">&lt;_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mrel\"><span class=\"mrel\">&lt;</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>, given that the domain of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>&lt;</mo><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">&lt;_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mrel\"><span class=\"mrel\">&lt;</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is a collection of atoms and near-litters, not ordinals.</p>\n<p>Also, this definition seems to involve a recursion, since there is a reference to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>-strong supports in the definition of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>-strong supports. What is the well founded relation we are recursing along (I'm guessing <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≪</mo></mrow><annotation encoding=\"application/x-tex\">\\ll</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">≪</span></span></span></span>), and how much of the definition actually needs this recursion? Is this definition monotonic w.r.t extension or subsetting the domain?</p>",
        "id": 271919162,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644892665
    },
    {
        "content": "<p>Here is a version that works without any direct reference to ZFA. This also includes the complete recursive definition of the <code>parent_map</code>, so I think the final theorem is now the correct statement. I'm hoping someone like <span class=\"user-mention\" data-user-id=\"478605\">@Randall Holmes</span> or <span class=\"user-mention\" data-user-id=\"478567\">@Thomas Forster</span> can learn enough lean to pick this up and do the proofs, though; I'm not in a position to spend a month on this.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">set_theory.cofinality</span>\n<span class=\"kn\">import</span> <span class=\"n\">order.symm_diff</span>\n<span class=\"kn\">import</span> <span class=\"n\">group_theory.group_action.basic</span>\n\n<span class=\"kd\">noncomputable theory</span>\n<span class=\"n\">open_locale</span> <span class=\"n\">cardinal</span> <span class=\"n\">classical</span>\n\n<span class=\"kd\">universes</span> <span class=\"n\">u</span> <span class=\"n\">v</span>\n\n<span class=\"kn\">local</span> <span class=\"kn\">attribute</span> <span class=\"o\">[</span><span class=\"kd\">instance</span><span class=\"o\">]</span>\n<span class=\"kd\">def</span> <span class=\"n\">mul_action.set</span> <span class=\"o\">{</span><span class=\"n\">G</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">G</span><span class=\"o\">]</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">G</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">G</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">S</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">''</span> <span class=\"n\">S</span><span class=\"o\">,</span> <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kn\">section</span>\n<span class=\"kd\">variables</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">group</span> <span class=\"n\">X</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">X</span> <span class=\"n\">A</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">G</span> <span class=\"o\">:</span> <span class=\"n\">subgroup</span> <span class=\"n\">X</span><span class=\"o\">)</span>\n<span class=\"kd\">structure</span> <span class=\"n\">normal_filter</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"bp\">Γ</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">subgroup</span> <span class=\"n\">X</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">is_perm</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">),</span> <span class=\"n\">K</span> <span class=\"bp\">≤</span> <span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">atoms</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">mul_action.stabilizer</span> <span class=\"n\">X</span> <span class=\"n\">a</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">upward</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">H</span> <span class=\"n\">K</span><span class=\"o\">,</span> <span class=\"n\">H</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span> <span class=\"bp\">→</span> <span class=\"n\">H</span> <span class=\"bp\">≤</span> <span class=\"n\">K</span> <span class=\"bp\">→</span> <span class=\"n\">K</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">inter</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">H</span> <span class=\"n\">K</span><span class=\"o\">,</span> <span class=\"n\">H</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span> <span class=\"bp\">→</span> <span class=\"n\">K</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span> <span class=\"bp\">→</span> <span class=\"n\">H</span> <span class=\"bp\">⊓</span> <span class=\"n\">K</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">conj</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">∈</span> <span class=\"n\">G</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">subgroup</span> <span class=\"n\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">map</span> <span class=\"o\">(</span><span class=\"n\">mul_aut.conj</span> <span class=\"n\">π</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_monoid_hom</span> <span class=\"bp\">∈</span> <span class=\"bp\">Γ</span><span class=\"o\">)</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"n\">G</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">F</span> <span class=\"o\">:</span> <span class=\"n\">normal_filter</span> <span class=\"n\">A</span> <span class=\"n\">G</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">normal_filter.symm</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">X</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"n\">mul_action.stabilizer</span> <span class=\"n\">X</span> <span class=\"n\">x</span> <span class=\"bp\">∈</span> <span class=\"n\">F.</span><span class=\"bp\">Γ</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">normal_filter.set</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">X</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span> <span class=\"o\">:=</span> <span class=\"o\">{</span> <span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span> <span class=\"bp\">//</span> <span class=\"n\">F.symm</span> <span class=\"n\">s</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">X</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">X</span> <span class=\"o\">(</span><span class=\"n\">F.set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"n\">S</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"n\">x</span> <span class=\"bp\">•</span> <span class=\"n\">S.1</span><span class=\"o\">,</span> <span class=\"gr\">sorry</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kn\">namespace</span> <span class=\"n\">con_nf</span>\n\n<span class=\"kd\">class</span> <span class=\"n\">params</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"bp\">Λ</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">Λ</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"bp\">Λ</span> <span class=\"bp\">→</span> <span class=\"bp\">Λ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"bp\">Λ</span><span class=\"n\">wf</span> <span class=\"o\">:</span> <span class=\"n\">is_well_order</span> <span class=\"bp\">Λ</span> <span class=\"bp\">Λ</span><span class=\"n\">r</span><span class=\"o\">]</span>\n<span class=\"o\">(</span><span class=\"n\">h</span><span class=\"bp\">Λ</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">ordinal.type</span> <span class=\"bp\">Λ</span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">is_limit</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">κ</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">hκ</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">κ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">is_regular</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">μ</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">μr</span> <span class=\"o\">:</span> <span class=\"n\">μ</span> <span class=\"bp\">→</span> <span class=\"n\">μ</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">μwf</span> <span class=\"o\">:</span> <span class=\"n\">is_well_order</span> <span class=\"n\">μ</span> <span class=\"n\">μr</span><span class=\"o\">]</span>\n<span class=\"o\">(</span><span class=\"n\">μ_ord</span> <span class=\"o\">:</span> <span class=\"n\">ordinal.type</span> <span class=\"n\">μr</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">μ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ord</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">μ_limit</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">μ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">is_strong_limit</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">μ_cof</span> <span class=\"o\">:</span> <span class=\"n\">max</span> <span class=\"o\">(</span><span class=\"bp\">#Λ</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">κ</span><span class=\"o\">)</span> <span class=\"bp\">&lt;</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">μ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ord.cof</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">δ</span> <span class=\"o\">:</span> <span class=\"bp\">Λ</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">hδ</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">ordinal.typein</span> <span class=\"bp\">Λ</span><span class=\"n\">r</span> <span class=\"n\">δ</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">is_limit</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">params</span>\n\n<span class=\"kd\">variable</span> <span class=\"o\">[</span><span class=\"n\">params.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}]</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">small</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"bp\">#</span><span class=\"n\">x</span> <span class=\"bp\">&lt;</span> <span class=\"bp\">#</span><span class=\"n\">κ</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">is_well_order</span> <span class=\"bp\">Λ</span> <span class=\"bp\">Λ</span><span class=\"n\">r</span> <span class=\"o\">:=</span> <span class=\"bp\">Λ</span><span class=\"n\">wf</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">linear_order</span> <span class=\"bp\">Λ</span> <span class=\"o\">:=</span> <span class=\"n\">linear_order_of_STO'</span> <span class=\"bp\">Λ</span><span class=\"n\">r</span>\n\n<span class=\"c1\">-- extended type index</span>\n<span class=\"kd\">def</span> <span class=\"n\">xti</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">finset</span> <span class=\"bp\">Λ</span> <span class=\"bp\">//</span> <span class=\"n\">s.nonempty</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">xti.min</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">Λ</span> <span class=\"o\">:=</span> <span class=\"n\">s.1.min'</span> <span class=\"n\">s.2</span>\n<span class=\"kd\">def</span> <span class=\"n\">xti.max</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">Λ</span> <span class=\"o\">:=</span> <span class=\"n\">s.1.max'</span> <span class=\"n\">s.2</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">xti.drop</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"k\">if</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">_</span> <span class=\"k\">then</span> <span class=\"n\">some</span> <span class=\"o\">⟨</span><span class=\"n\">s.1.erase</span> <span class=\"n\">s.min</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">⟩</span> <span class=\"k\">else</span> <span class=\"n\">none</span>\n<span class=\"kd\">def</span> <span class=\"n\">xti.drop_max</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">option</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"k\">if</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">_</span> <span class=\"k\">then</span> <span class=\"n\">some</span> <span class=\"o\">⟨</span><span class=\"n\">s.1.erase</span> <span class=\"n\">s.max</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">⟩</span> <span class=\"k\">else</span> <span class=\"n\">none</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_singleton</span> <span class=\"bp\">Λ</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"o\">⟨{</span><span class=\"n\">x</span><span class=\"o\">},</span> <span class=\"n\">finset.singleton_nonempty</span> <span class=\"n\">_</span><span class=\"o\">⟩⟩</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_insert</span> <span class=\"bp\">Λ</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"bp\">λ</span> <span class=\"n\">x</span> <span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"n\">insert</span> <span class=\"n\">x</span> <span class=\"n\">s.1</span><span class=\"o\">,</span> <span class=\"n\">finset.insert_nonempty</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">⟩⟩</span>\n\n<span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">xti.dropn</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"n\">option</span> <span class=\"n\">xti</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span> <span class=\"n\">some</span> <span class=\"n\">s</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">xti.dropn</span> <span class=\"n\">n</span> <span class=\"bp\">&gt;&gt;=</span> <span class=\"n\">xti.drop</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">sdom</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n<span class=\"bp\">|</span> <span class=\"n\">A</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">A.max</span> <span class=\"bp\">&lt;</span> <span class=\"n\">B.max</span> <span class=\"bp\">∨</span> <span class=\"n\">A.max</span> <span class=\"bp\">=</span> <span class=\"n\">B.max</span> <span class=\"bp\">∧</span>\n  <span class=\"bp\">∃</span> <span class=\"n\">A'</span> <span class=\"bp\">∈</span> <span class=\"n\">A.drop_max</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">B'</span> <span class=\"bp\">∈</span> <span class=\"n\">B.drop_max</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"o\">(</span><span class=\"n\">A'</span><span class=\"o\">:</span><span class=\"n\">xti</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"n\">card</span> <span class=\"bp\">&lt;</span> <span class=\"n\">A.1.card</span><span class=\"o\">,</span> <span class=\"k\">from</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n    <span class=\"n\">sdom</span> <span class=\"n\">A'</span> <span class=\"n\">B'</span>\n<span class=\"n\">using_well_founded</span> <span class=\"o\">{</span><span class=\"n\">rel_tac</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">_</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"bp\">`</span><span class=\"o\">[</span><span class=\"n\">exact</span> <span class=\"o\">⟨</span><span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">measure_wf</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">A.1.card</span><span class=\"o\">)⟩]}</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_lt</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">sdom</span><span class=\"o\">⟩</span>\n<span class=\"kd\">instance</span> <span class=\"n\">xti.is_well_order</span> <span class=\"o\">:</span> <span class=\"n\">is_well_order</span> <span class=\"n\">xti</span> <span class=\"o\">(</span><span class=\"bp\">&lt;</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_well_founded</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">xti.is_well_order.wf</span><span class=\"o\">⟩</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_le</span> <span class=\"n\">xti</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"bp\">λ</span> <span class=\"n\">A</span> <span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">A</span> <span class=\"bp\">&lt;</span> <span class=\"n\">B</span> <span class=\"bp\">∨</span> <span class=\"n\">A</span> <span class=\"bp\">=</span> <span class=\"n\">B</span><span class=\"o\">⟩</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">clan</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">μ</span> <span class=\"bp\">×</span> <span class=\"n\">κ</span>\n<span class=\"kd\">def</span> <span class=\"n\">atoms</span> <span class=\"o\">:=</span> <span class=\"bp\">Σ</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">clan</span> <span class=\"n\">A</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">litter</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">μ</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">p</span> <span class=\"bp\">|</span> <span class=\"n\">p.1</span> <span class=\"bp\">=</span> <span class=\"n\">x</span><span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">litter.is_near</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">μ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">small</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"bp\">Δ</span> <span class=\"n\">litter</span> <span class=\"n\">A</span> <span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">local_cards</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span> <span class=\"o\">:=</span> <span class=\"n\">μ</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">clan_perm</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">ρ</span> <span class=\"o\">:</span> <span class=\"n\">equiv.perm</span> <span class=\"o\">(</span><span class=\"n\">local_cards</span> <span class=\"n\">A</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"o\">:</span> <span class=\"n\">equiv.perm</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">near</span> <span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">litter.is_near</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">''</span> <span class=\"n\">litter</span> <span class=\"n\">A</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">ρ</span> <span class=\"n\">x</span><span class=\"o\">))</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">group</span> <span class=\"o\">(</span><span class=\"n\">clan_perm</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"o\">(</span><span class=\"n\">clan_perm</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">local_cards</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span><span class=\"o\">,</span> <span class=\"n\">π.ρ</span><span class=\"o\">,</span> <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"o\">(</span><span class=\"n\">clan_perm</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span><span class=\"o\">,</span> <span class=\"n\">π.π</span><span class=\"o\">,</span> <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">near_litter</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"bp\">Σ'</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">))</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">litter.is_near</span> <span class=\"n\">N</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">near_litter.is_litter</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">near_litter</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">N.1</span> <span class=\"bp\">=</span> <span class=\"n\">litter</span> <span class=\"n\">A</span> <span class=\"n\">N.2.1</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"o\">(</span><span class=\"n\">clan_perm</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">near_litter</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">N</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">N.1</span><span class=\"o\">,</span> <span class=\"n\">π.ρ</span> <span class=\"n\">N.2.1</span><span class=\"o\">,</span> <span class=\"gr\">sorry</span><span class=\"o\">⟩,</span> <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">clans_perm</span> <span class=\"o\">:=</span> <span class=\"bp\">Π</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">clan_perm</span> <span class=\"n\">A</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">group</span> <span class=\"n\">clans_perm</span> <span class=\"o\">:=</span> <span class=\"n\">pi.group</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"o\">(</span><span class=\"n\">clan_perm</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"n\">A</span> <span class=\"bp\">•</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">one_smul</span> <span class=\"n\">_</span> <span class=\"n\">a</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">ρ</span> <span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"n\">mul_smul</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">ρ</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"n\">c</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">β</span><span class=\"o\">]</span> <span class=\"o\">:</span>\n  <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">≃</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">e</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">e</span> <span class=\"o\">(</span><span class=\"n\">π</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">a</span><span class=\"o\">),</span> <span class=\"bp\">λ</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"n\">π</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">•</span> <span class=\"n\">e.symm</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">b</span><span class=\"o\">),</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span> <span class=\"gr\">sorry</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">atoms</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"o\">⟨</span><span class=\"n\">a.1</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"n\">a.1</span> <span class=\"bp\">•</span> <span class=\"n\">a.2</span><span class=\"o\">⟩,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">local_card</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">near_litter</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span> <span class=\"o\">:=</span> <span class=\"n\">N.2.1</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">parent_set</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"bp\">Σ'</span> <span class=\"n\">A'</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">A.drop</span> <span class=\"bp\">=</span> <span class=\"n\">some</span> <span class=\"n\">A'</span><span class=\"o\">),</span> <span class=\"n\">clan</span> <span class=\"n\">A'</span><span class=\"o\">)</span> <span class=\"bp\">⊕</span>\n<span class=\"o\">(</span><span class=\"bp\">Σ'</span> <span class=\"n\">a</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">insert</span> <span class=\"n\">a</span> <span class=\"n\">A</span> <span class=\"bp\">&lt;</span> <span class=\"n\">A</span><span class=\"o\">),</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"o\">(</span><span class=\"n\">insert</span> <span class=\"n\">a</span> <span class=\"n\">A</span><span class=\"o\">))))</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">parent_set</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">match</span> <span class=\"n\">x</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"n\">sum.inl</span> <span class=\"o\">⟨</span><span class=\"n\">A'</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">c</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">sum.inl</span> <span class=\"o\">⟨</span><span class=\"n\">A'</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">c</span><span class=\"o\">⟩</span>\n  <span class=\"bp\">|</span> <span class=\"n\">sum.inr</span> <span class=\"o\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">s</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">sum.inr</span> <span class=\"o\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">s</span><span class=\"o\">⟩</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">support_el</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"bp\">Σ</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"bp\">Σ'</span> <span class=\"n\">_</span> <span class=\"o\">:</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">clan</span> <span class=\"n\">A</span> <span class=\"bp\">⊕</span> <span class=\"n\">near_litter</span> <span class=\"n\">A</span>\n<span class=\"kd\">def</span> <span class=\"n\">support_el.inl</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">c</span> <span class=\"o\">:</span> <span class=\"n\">clan</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">support_el</span> <span class=\"n\">Q</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inl</span> <span class=\"n\">c</span><span class=\"o\">⟩</span>\n<span class=\"kd\">def</span> <span class=\"n\">support_el.inr</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">near_litter</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">support_el</span> <span class=\"n\">Q</span> <span class=\"o\">:=</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inr</span> <span class=\"n\">N</span><span class=\"o\">⟩</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">support_el.below</span> <span class=\"o\">{</span><span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">support_el</span> <span class=\"n\">Q</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n<span class=\"bp\">|</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inl</span> <span class=\"n\">c</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">μr</span> <span class=\"n\">c.1</span> <span class=\"n\">x</span>\n<span class=\"bp\">|</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inr</span> <span class=\"n\">N</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">N.is_litter</span> <span class=\"bp\">∧</span> <span class=\"n\">μr</span> <span class=\"n\">N.2.1</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">{</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">support_el</span> <span class=\"n\">Q</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">smul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">π</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">match</span> <span class=\"n\">x</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inl</span> <span class=\"n\">c</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">support_el.inl</span> <span class=\"n\">_</span> <span class=\"n\">h</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">c</span><span class=\"o\">)</span>\n  <span class=\"bp\">|</span> <span class=\"o\">⟨</span><span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">sum.inr</span> <span class=\"n\">N</span><span class=\"o\">⟩</span> <span class=\"o\">:=</span> <span class=\"n\">support_el.inr</span> <span class=\"n\">_</span> <span class=\"n\">h</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">N</span><span class=\"o\">)</span>\n  <span class=\"kd\">end</span><span class=\"o\">,</span>\n  <span class=\"n\">one_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_smul</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">support_order</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"o\">(</span><span class=\"n\">support_el</span> <span class=\"n\">Q</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"n\">small</span> <span class=\"o\">:</span> <span class=\"n\">small</span> <span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">disj</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"n\">h</span> <span class=\"n\">M</span> <span class=\"n\">N</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">@</span><span class=\"n\">support_el.inr</span> <span class=\"n\">_</span> <span class=\"n\">Q</span> <span class=\"n\">A</span> <span class=\"n\">h</span> <span class=\"n\">M</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">support_el.inr</span> <span class=\"n\">_</span> <span class=\"n\">h</span> <span class=\"n\">N</span> <span class=\"bp\">∈</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">M</span> <span class=\"bp\">≠</span> <span class=\"n\">N</span> <span class=\"bp\">→</span> <span class=\"n\">disjoint</span> <span class=\"n\">M.1</span> <span class=\"n\">N.1</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"n\">S</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">wo</span> <span class=\"o\">:</span> <span class=\"n\">is_well_order</span> <span class=\"n\">S</span> <span class=\"n\">r</span><span class=\"o\">)</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">P</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">PI</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">P</span> <span class=\"n\">B</span> <span class=\"bp\">→</span> <span class=\"n\">local_cards</span> <span class=\"n\">B</span> <span class=\"bp\">→</span> <span class=\"n\">parent_set</span> <span class=\"n\">B</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">allowable'</span> <span class=\"o\">:</span> <span class=\"n\">subgroup</span> <span class=\"n\">clans_perm</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">carrier</span> <span class=\"o\">:=</span> <span class=\"o\">{</span> <span class=\"n\">π</span> <span class=\"bp\">|</span> <span class=\"bp\">∀</span> <span class=\"n\">B</span> <span class=\"n\">h</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">PI</span> <span class=\"n\">B</span> <span class=\"n\">h</span> <span class=\"o\">(</span><span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">π</span> <span class=\"bp\">•</span> <span class=\"n\">PI</span> <span class=\"n\">B</span> <span class=\"n\">h</span> <span class=\"n\">x</span> <span class=\"o\">},</span>\n  <span class=\"n\">one_mem'</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_mem'</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">inv_mem'</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">supported'</span> <span class=\"o\">{</span><span class=\"n\">Q</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">support_order</span> <span class=\"n\">Q</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">subgroup</span> <span class=\"n\">clans_perm</span> <span class=\"o\">:=</span>\n<span class=\"n\">allowable'</span> <span class=\"n\">PI</span> <span class=\"bp\">⊓</span> <span class=\"bp\">⨅</span> <span class=\"n\">a</span> <span class=\"bp\">∈</span> <span class=\"n\">S.S</span><span class=\"o\">,</span> <span class=\"n\">mul_action.stabilizer</span> <span class=\"n\">_</span> <span class=\"n\">a</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">has_support'</span> <span class=\"o\">{</span><span class=\"n\">Q</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">support_order</span> <span class=\"n\">Q</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"n\">supported'</span> <span class=\"n\">PI</span> <span class=\"n\">S</span> <span class=\"bp\">≤</span> <span class=\"n\">mul_action.stabilizer</span> <span class=\"n\">clans_perm</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">support_filter'</span> <span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">normal_filter</span> <span class=\"n\">atoms</span> <span class=\"o\">(</span><span class=\"n\">allowable'</span> <span class=\"n\">PI</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"bp\">Γ</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">K</span> <span class=\"bp\">|</span> <span class=\"bp\">∃</span> <span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">support_order</span> <span class=\"n\">Q</span><span class=\"o\">,</span> <span class=\"n\">supported'</span> <span class=\"n\">PI</span> <span class=\"n\">S</span> <span class=\"bp\">≤</span> <span class=\"n\">K</span><span class=\"o\">},</span>\n  <span class=\"n\">is_perm</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">atoms</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">upward</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">inter</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">conj</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">parent_set.symm'</span> <span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">sum.inl</span> <span class=\"o\">⟨</span><span class=\"n\">A'</span><span class=\"o\">,</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">c</span><span class=\"o\">⟩)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">support_filter'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"n\">c</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">sum.inr</span> <span class=\"o\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">x</span><span class=\"o\">⟩)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">support_filter'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"n\">x</span> <span class=\"bp\">∧</span> <span class=\"bp\">∀</span> <span class=\"n\">s</span> <span class=\"bp\">∈</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"o\">(</span><span class=\"n\">support_filter'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span> <span class=\"n\">s</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">parent_range'</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span> <span class=\"bp\">|</span> <span class=\"n\">x.symm'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span><span class=\"o\">}</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">parent_range'_card</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">#</span><span class=\"o\">(</span><span class=\"n\">parent_range'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"bp\">#</span><span class=\"n\">μ</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">structure</span> <span class=\"n\">good_bij'</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">inj</span> <span class=\"o\">:</span> <span class=\"n\">function.injective</span> <span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">range</span> <span class=\"o\">:</span> <span class=\"n\">set.range</span> <span class=\"n\">f</span> <span class=\"bp\">=</span> <span class=\"n\">parent_range'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">below</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∃</span> <span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">support_order</span> <span class=\"n\">Q</span><span class=\"o\">,</span> <span class=\"n\">has_support'</span> <span class=\"n\">PI</span> <span class=\"n\">S</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"bp\">∧</span>\n    <span class=\"bp\">∀</span> <span class=\"n\">c</span> <span class=\"o\">:</span> <span class=\"n\">support_el</span> <span class=\"n\">Q</span><span class=\"o\">,</span> <span class=\"n\">c</span> <span class=\"bp\">∈</span> <span class=\"n\">S.S</span> <span class=\"bp\">→</span> <span class=\"n\">c.below</span> <span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">exists_bij'</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">∃</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span><span class=\"o\">,</span> <span class=\"n\">good_bij'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span> <span class=\"n\">f</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">the_bij</span> <span class=\"o\">(</span><span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">classical.some</span> <span class=\"o\">(</span><span class=\"n\">exists_bij'</span> <span class=\"n\">PI</span> <span class=\"n\">Q</span> <span class=\"n\">A</span><span class=\"o\">)</span>\n\n<span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">parent_map</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span><span class=\"o\">),</span> <span class=\"n\">local_cards</span> <span class=\"n\">A</span> <span class=\"bp\">→</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span>\n<span class=\"bp\">|</span> <span class=\"n\">A</span> <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">the_bij</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">B</span> <span class=\"bp\">&lt;</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"n\">hB</span><span class=\"o\">,</span> <span class=\"n\">parent_map</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span><span class=\"o\">,</span> <span class=\"n\">B</span> <span class=\"bp\">≤</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"n\">A</span>\n<span class=\"n\">using_well_founded</span> <span class=\"o\">{</span><span class=\"n\">dec_tac</span> <span class=\"o\">:=</span> <span class=\"bp\">`</span><span class=\"o\">[</span><span class=\"n\">assumption</span><span class=\"o\">]}</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">allowable</span> <span class=\"o\">:</span> <span class=\"n\">subgroup</span> <span class=\"n\">clans_perm</span> <span class=\"o\">:=</span> <span class=\"n\">allowable'</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"o\">(</span><span class=\"n\">_</span> <span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">),</span> <span class=\"n\">parent_map</span> <span class=\"n\">B</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">support_filter</span> <span class=\"o\">:</span> <span class=\"n\">normal_filter</span> <span class=\"n\">atoms</span> <span class=\"n\">allowable</span> <span class=\"o\">:=</span>\n<span class=\"n\">support_filter'</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"o\">(</span><span class=\"n\">_</span> <span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">),</span> <span class=\"n\">parent_map</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">true</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">parent_set.symm</span> <span class=\"o\">{</span><span class=\"n\">A</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">parent_set</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">s.symm'</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"o\">(</span><span class=\"n\">_</span> <span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">),</span> <span class=\"n\">parent_map</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">true</span><span class=\"o\">)</span>\n<span class=\"kd\">def</span> <span class=\"n\">parent_range</span> <span class=\"o\">:=</span> <span class=\"n\">parent_range'</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">B</span> <span class=\"o\">(</span><span class=\"n\">_</span> <span class=\"o\">:</span> <span class=\"n\">true</span><span class=\"o\">),</span> <span class=\"n\">parent_map</span> <span class=\"n\">B</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"bp\">λ</span> <span class=\"n\">_</span><span class=\"o\">,</span> <span class=\"n\">true</span><span class=\"o\">)</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">parent_range_card</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">#</span><span class=\"o\">(</span><span class=\"n\">parent_range</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"bp\">#</span><span class=\"n\">μ</span> <span class=\"o\">:=</span> <span class=\"n\">parent_range'_card</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">symm</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">support_filter.symm</span> <span class=\"n\">x</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">sset</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:=</span> <span class=\"n\">support_filter.set</span> <span class=\"n\">α</span>\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">sset</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">by</span> <span class=\"n\">unfold</span> <span class=\"n\">sset</span><span class=\"bp\">;</span> <span class=\"n\">apply_instance</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">sset_n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span> <span class=\"bp\">→</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">],</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"n\">α</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"n\">α</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"n\">sset_n</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"kd\">by</span> <span class=\"n\">exactI</span> <span class=\"n\">sset</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kd\">noncomputable</span> <span class=\"kd\">instance</span> <span class=\"n\">mul_action.sset_n</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∀</span> <span class=\"n\">n</span> <span class=\"n\">α</span> <span class=\"o\">[</span><span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"n\">α</span><span class=\"o\">],</span> <span class=\"kd\">by</span> <span class=\"n\">exactI</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">sset_n</span> <span class=\"n\">n</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"n\">α</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"n\">h</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"n\">α</span> <span class=\"n\">h</span> <span class=\"o\">:=</span> <span class=\"n\">mul_action.sset_n</span> <span class=\"n\">n</span> <span class=\"n\">_</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">xti_below</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti</span> <span class=\"bp\">//</span> <span class=\"n\">A</span> <span class=\"bp\">&lt;</span> <span class=\"o\">{</span><span class=\"n\">δ</span><span class=\"o\">}}</span>\n<span class=\"kd\">def</span> <span class=\"n\">τ</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"o\">:</span> <span class=\"n\">xti_below</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">sset_n</span> <span class=\"mi\">2</span> <span class=\"o\">(</span><span class=\"n\">clan</span> <span class=\"o\">(</span><span class=\"n\">insert</span> <span class=\"n\">δ</span> <span class=\"n\">A.1</span><span class=\"o\">))</span>\n<span class=\"kd\">instance</span> <span class=\"o\">(</span><span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">mul_action</span> <span class=\"n\">clans_perm</span> <span class=\"o\">(</span><span class=\"n\">τ</span> <span class=\"n\">A</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span> <span class=\"n\">unfold</span> <span class=\"n\">τ</span><span class=\"bp\">;</span> <span class=\"n\">apply_instance</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">τ_power</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"n\">A'</span> <span class=\"o\">:</span> <span class=\"n\">xti_below</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">A.1.drop</span> <span class=\"bp\">=</span> <span class=\"n\">some</span> <span class=\"n\">A'.1</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">∃</span> <span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">τ</span> <span class=\"n\">A</span> <span class=\"bp\">≃</span> <span class=\"n\">sset</span> <span class=\"o\">(</span><span class=\"n\">τ</span> <span class=\"n\">A'</span><span class=\"o\">),</span> <span class=\"n\">symm</span> <span class=\"n\">f</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">theorem</span> <span class=\"n\">τ_elementary</span> <span class=\"o\">(</span><span class=\"n\">A</span> <span class=\"n\">A'</span> <span class=\"n\">B</span> <span class=\"n\">B'</span> <span class=\"o\">:</span> <span class=\"n\">xti_below</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hA</span> <span class=\"o\">:</span> <span class=\"n\">A.1.dropn</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">some</span> <span class=\"n\">A'.1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">hB</span> <span class=\"o\">:</span> <span class=\"n\">B.1.dropn</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">some</span> <span class=\"n\">B'.1</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">A.1.1</span> <span class=\"bp\">\\</span> <span class=\"n\">A'.1.1</span> <span class=\"bp\">=</span> <span class=\"n\">B.1.1</span> <span class=\"bp\">\\</span> <span class=\"n\">B'.1.1</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">sset_n</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">τ</span> <span class=\"n\">A'</span><span class=\"o\">)</span> <span class=\"bp\">≃</span> <span class=\"n\">sset_n</span> <span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">τ</span> <span class=\"n\">B'</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"gr\">sorry</span>\n\n<span class=\"kd\">end</span> <span class=\"n\">con_nf</span>\n</code></pre></div>",
        "id": 271940213,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1644913521
    },
    {
        "content": "<p>Wow!</p>",
        "id": 271943453,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1644915401
    },
    {
        "content": "<p>A power unbeknowst to us mortals...</p>",
        "id": 271943549,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1644915463
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"478567\">@Thomas Forster</span> if you like the computer puzzle game analogy, Mario has now \"made the level\" (this sort of stuff needs a lot of expertise) and then the next step is to \"solve the level\", which can be attempted by someone whose lean expertise is far lower -- for example a maths PhD student in this area with no prior lean experience can learn enough about the basics of lean to try and fill in some of those sorries with tactic proofs. Once they're all filled in, you're done. Some of them will no doubt be straightforward.</p>",
        "id": 271947065,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1644917229
    },
    {
        "content": "<p>That makes it sound as if i cld make myself useful.  Randall is going to be here from mid-may for a good long while (a month or so) so perhaps we could confer with the local Leanies?  The major drawback with that is that this is smack in the middle of the time when they should be steeling themselves for exams...</p>",
        "id": 271948607,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1644918126
    },
    {
        "content": "<p>Hope I used <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> correctly. I was searching for what <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span> meant and found this:<br>\n<a href=\"https://leanprover-community.github.io/archive/stream/113488-general/topic/octopus.20emoji.html\">https://leanprover-community.github.io/archive/stream/113488-general/topic/octopus.20emoji.html</a></p>",
        "id": 271973536,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1644931939
    },
    {
        "content": "<p>I can only answer briefly right now.  All of these are comments for Mario.</p>\n<p>There is a notion of set and there is only one empty set.  A is a subset of B means, A is a set and B is a set and every element of A is an element of B.   (Anything with an element is a set, and there is only one empty set).</p>\n<p>So atoms have no subsets.  The power set of an object is the collection of its subsets, so if one must ask what the power set of an atom is,<br>\nthe answer is, either it is undefined or it is the empty set.  The question should not come up.</p>\n<p>I cant evaluate definitions until I understand the Lean formalism, and at the moment I am buried in teaching and administration.  Ill try to get to it soon!</p>\n<p>The paper is written in a highly  nonlinear style because there is a really horrible recursion involved.  The dependence of tau on Pi is certainly not spurious.</p>",
        "id": 272261863,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1645106069
    },
    {
        "content": "<p>Mario, did you figure out the definition of strong support order?  </p>\n<p>I will add, there is another generation of versions of the paper.  I think this one is going to be pretty impenetrable.</p>\n<p>One comment which is useful is that Pi_A isn't <em>defined</em>:  these maps are <em>chosen</em> at each step of the construction  based on cardinality facts which have to be verified (that various sets which are constructed as one recurses along &lt;&lt; are in fact all of the same size mu).</p>\n<p>I will try to (1) post newer versions soonish (within weeks) if I think they are ready to be presented as targets.  (2)  Try to read this version itself again and see if I can give explicit answers to questions Mario raises.  (3) try to read what Mario has done and see if I agree!  For all of these, the time target is within weeks: I am taking time away from getting to the university to print out exams I am giving today which I will be marking over the weekend, I am behind on writing my own contribution to my annual personnel evaluation and I have bunches of other things I should have done a month ago.</p>\n<p>Sorry that my writing here is unlovely;  I dont understand the bells and whistles of this medium.</p>",
        "id": 272264617,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1645107250
    },
    {
        "content": "<p>Ill try to look in here again soonish.  Mario, feel free to email me questions if you have more.</p>",
        "id": 272265073,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1645107435
    },
    {
        "content": "<p>I have just posted a more recent document, a construction of a model of tangled type theory, on my web page.  A more recent document taking the same approach as the one Mario is using (and I think meeting his requirements better) will appear, but isn't accessible to me as I tyoe;  it is on my old laptop and I don't seem to have copied if over.</p>\n<p>The document just posted has a considerably more linear style.  But what it describes is awful.</p>",
        "id": 272303562,
        "sender_full_name": "Randall Holmes",
        "timestamp": 1645122914
    },
    {
        "content": "<p>I need some guidance from this community.  I have the possibility of the university funding one or possibly two students over the summer to do some preparatory work on this project.  But of course i have to prepare a proposal!  I have no idea what do say, having no experience in these matters.  I would be very glad of some advice on what to put in such a proposal.  Specifically the funders say that if they are to fund two students for a collaboration the proposal has to have a Good Story about what form the collaboration would take.   HELP!!</p>",
        "id": 273415770,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1645983607
    },
    {
        "content": "<p>Hi, Thomas! I think it is safe to say that if you have good students that are willing to learn to use Lean and work on the project, they will have plenty of support from this community. You have already seen that they can get answers on Zulip around the clock. Students are always welcome here in Pittsburgh. There's a workshop at ICERM this summer: <a href=\"https://icerm.brown.edu/topical_workshops/tw-22-lean/\">https://icerm.brown.edu/topical_workshops/tw-22-lean/</a>. And Kevin Buzzard and all our friends in London are just a stone's throw away.</p>",
        "id": 273416272,
        "sender_full_name": "Jeremy Avigad",
        "timestamp": 1645984264
    },
    {
        "content": "<p>So i just put them in a room with comfy chairs and a supply of coffee/tea, plus access to LEAN support and Randall and just let them get on with it?  The fact that i, Thomas Forster, have no idea how to set about it doesn't really matter...?  I'm not sure that my students can get funding to come to your workshop, nice tho' that would be.</p>",
        "id": 273602918,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1646122282
    },
    {
        "content": "<p>This kind of approach can work. They will have two kinds of questions -- maths ones and lean ones, and the community here can help with the lean ones and you can help with the maths ones. To give a related example, Scholze challenged the community to prove a theorem of himself and Clausen, and then stayed around to help us with maths questions and the community just translated the work</p>",
        "id": 273605178,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1646123692
    },
    {
        "content": "<p>Thanks, Kevin.  I've got some funding for this project so i'll just go ahead, trusting them to Do The Right Thing.  Randall is coming to Cambridge for a month or so from mid-may and it will be wonderful to have him here.  Sadly, the timing is not ideal, given that my students have exams during that time, but we'll manage.  I suspect there will be very little for me to do, since there are people who understand LEAN better than i do, and Randall understands his proof better than i do!   But at least i know how to make a decent pot of tea, so i won't be completely useless.</p>",
        "id": 273687683,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1646159219
    },
    {
        "content": "<p>Thomas, maybe what you need for a proposal are \"deliverables\"? The fact that the Lean community recognizes the importance of building up libraries should be helpful to you. At minimum, your students should be able to improve the general library support in Lean for model theory and set theory. This should be a lasting contribution even in the worst case that Randall's argument turns out to be wrong. (I'm not sure what story to tell about Lean 3 versus Lean 4 libraries; maybe someone who knows what they're talking about can chime in here.) Also, since Mario Carneiro has \"made the game\" so to speak, there are measurable milestones; your students can flesh out the sorrys one by one.</p>",
        "id": 274306354,
        "sender_full_name": "Timothy Chow",
        "timestamp": 1646574030
    },
    {
        "content": "<p>I wouldn't worry too much about the library building being in lean 3 (I do recommend sticking to lean 3 for this project) even though lean 4 is on the horizon. Everything will get mostly-automatically ported in the end, so a new lean 3 library development will definitely contribute to an eventual corresponding lean 4 library, and even if we weren't trying to port everything, \"second system\" formalizations are always a lot easier than the first one, even if we're talking about a fully manual port from something significantly different like Coq/Mizar/Metamath, because at least half of the work is spent on trying to say something in a fully precise way and the other half is expressing that precision in a specific formal language.</p>",
        "id": 274307447,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1646575286
    },
    {
        "content": "<p>I'm thinking that it could be good to verify a basic Fraenkel-Mostowski construction.  I'm guessing that that hasn't been done in LEAN?  It would be a useful stage 0 rehearsal for Randall's proof (which is the mother of all F-M constructions) and might be a good idea on its own account..(?)</p>",
        "id": 274377250,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1646651775
    },
    {
        "content": "<p>Note that in the proof sketch I give above, most of the F-M stuff has been boiled away. Instead we just have <code>normal_filter</code> and a bunch of stuff about group actions, both of which are not particularly specific to the proof</p>",
        "id": 274441942,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1646679987
    },
    {
        "content": "<p>I thought there would be an actual F-M construction because it is stated like that in the original proof, and v1 actually does have a permutation model and an action on the universe, but it is more natural in type theory to have actions on each of the sets (reinterpreted as types) rather than encoding everything in set theory first, and once you make this shift then the statement becomes much simpler</p>",
        "id": 274442287,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1646680152
    },
    {
        "content": "<p>One thing that has struck me ever since I tried reading the proof is that it feels very much like the Cole–Mitchell–Osius–(Hayashi?) construction of something like a model of BZA from a category of equivariant sheaves on a Boolean algebra. The complexity in describing a ZFA forcing model looks to my eyes like it arises from a factorisation of the process ZF(A) ~&gt; its category of sets ~&gt; category of sheaves ~&gt; model of ZFA. </p>\n<p><span class=\"user-mention\" data-user-id=\"478605\">@Randall Holmes</span> have you talked to any category or topos theory people? <span class=\"user-mention\" data-user-id=\"478567\">@Thomas Forster</span>  I do wonder what Peter Johnstone might make of the construction...</p>",
        "id": 274500135,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1646719094
    },
    {
        "content": "<p>This is all news to me, and i would like to chase it up.     Can you tell me more?  I could ask PTJ about it but i am in contact with the other senior categorist at Cambridge, namely Martin Hyland - who is definitely following developments re Holmes' proof.  He hasn't mentioned this stuff to me.  I shall show him your message...</p>",
        "id": 274504548,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1646723769
    },
    {
        "content": "<p>It seems that the parallel with Cole-Mitchell-Osius is not helpful.</p>",
        "id": 274528102,
        "sender_full_name": "Thomas Forster",
        "timestamp": 1646738808
    },
    {
        "content": "<p>OK, good to know. It just seemed rather reminiscent, and there's still a rather 'structural' feel to the construction that seems foreign from the point of view of more traditional set theory (i.e. ZF(C)/ZFA)</p>",
        "id": 274775348,
        "sender_full_name": "David Michael Roberts",
        "timestamp": 1646873406
    }
]