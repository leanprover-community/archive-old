[
    {
        "content": "<p>I was trying to play a bit with <span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> ' definition and I have a basic question about <code>comm_group_with_zero</code>: it seems to me that the \"extended integers\" <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi><mo>∪</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}\\cup\\{\\infty\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">∞</span><span class=\"mclose\">}</span></span></span></span> are a <code>comm_group_with_zero</code> when declaring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi><mo>⋅</mo><mi>a</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mi mathvariant=\"normal\">∞</mi><mo>=</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty \\cdot a=a\\cdot \\infty=\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord\">∞</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span> for every <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>:</mo><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">a : \\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span>. Then why can't we define the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>-adic valuation as taking values here rather than in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span> with the declaration <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">v(0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> (as it is now in <a href=\"https://leanprover-community.github.io/mathlib_docs/number_theory/padics/padic_numbers.html#padic.valuation\">https://leanprover-community.github.io/mathlib_docs/number_theory/padics/padic_numbers.html#padic.valuation</a> )?</p>",
        "id": 250113525,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629464140
    },
    {
        "content": "<p>That would break the fact that the units of the valuation are the elements with valuation zero (if you're using the additive notation for the value group).</p>",
        "id": 250113836,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629464309
    },
    {
        "content": "<p>It's not a <code>comm_group_with_zero</code> because what happens to <code>0</code>? It doesn't have an inverse.</p>",
        "id": 250113856,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629464325
    },
    {
        "content": "<p>Unless you mean that <code>0</code> is the <code>zero</code> and the inverse of <code>infty</code> is <code>infty</code></p>",
        "id": 250113904,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629464351
    },
    {
        "content": "<p>I think he means linear_ordered_add_comm_group_with_infinity</p>",
        "id": 250113949,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629464390
    },
    {
        "content": "<p>Which might not exist?</p>",
        "id": 250113964,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629464399
    },
    {
        "content": "<p>It's <code>with_top</code></p>",
        "id": 250114096,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629464443
    },
    {
        "content": "<p>There's <a href=\"https://leanprover-community.github.io/mathlib_docs/find/linear_ordered_add_comm_monoid_with_top\">docs#linear_ordered_add_comm_monoid_with_top</a>, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/linear_ordered_add_comm_group_with_top\">docs#linear_ordered_add_comm_group_with_top</a></p>",
        "id": 250114148,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629464486
    },
    {
        "content": "<p>Yes, I mean a <code>lin_ord_ab_group_with_inf</code>, and I might have a look at that <code>with_top</code> instead.</p>",
        "id": 250114286,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629464562
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/113488-general/topic/Ostrowski.20theorems.20formalized.20in.20Lean.203/near/250113836\">said</a>:</p>\n<blockquote>\n<p>That would break the fact that the units of the valuation are the elements with valuation zero (if you're using the additive notation for the value group).</p>\n</blockquote>\n<p>I am sorry, but I don't understand why.</p>",
        "id": 250114327,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629464589
    },
    {
        "content": "<p>Because zero is not a unit?</p>",
        "id": 250114639,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629464762
    },
    {
        "content": "<p>Maybe I misunderstood the question?</p>",
        "id": 250114947,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629464913
    },
    {
        "content": "<p>Ok, I try to explain myself better: if we add to the additive group <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68889em;vertical-align:0em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span> the element <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span> and we call it <code>zero</code> (so the one of the group is <code>0 : int</code> and the zero of the group is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span>), don't we get a <code>comm_group_with_zero</code> when declaring that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span> absorbs everything (additively)?</p>",
        "id": 250115082,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629464994
    },
    {
        "content": "<p>Now <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Q</mi><mi>p</mi></msub><mo>→</mo><mover accent=\"true\"><mi mathvariant=\"double-struck\">Z</mi><mo>ˉ</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}_p\\rightarrow\\bar{\\mathbb{Z}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8256699999999999em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8256699999999999em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbb\">Z</span></span><span style=\"top:-3.25789em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.16666em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span></span></span> and I don't see problems with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>:</mo><msub><mi mathvariant=\"double-struck\">Q</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">0 : \\mathbb{Q}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> which is the only guy sent to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span>.</p>",
        "id": 250115270,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629465097
    },
    {
        "content": "<p>Oh, but that's already what's been done... So what's the issue?</p>",
        "id": 250115456,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629465192
    },
    {
        "content": "<p>Just that it's not defeq to Z?</p>",
        "id": 250115485,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629465206
    },
    {
        "content": "<p>I'll move this thread to the maths stream where it belongs...</p>",
        "id": 250115534,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629465237
    },
    {
        "content": "<p>No, well, my \"issue\" is that here <a href=\"https://leanprover-community.github.io/mathlib_docs/number_theory/padics/padic_numbers.html#padic.valuation\">https://leanprover-community.github.io/mathlib_docs/number_theory/padics/padic_numbers.html#padic.valuation</a> the p-adic valuations sends <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span>, not to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord\">∞</span></span></span></span>.</p>",
        "id": 250115620,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629465266
    },
    {
        "content": "<p>It's not a <code>comm_group_with_zero</code> because there are no multiplicative inverses. Do you mean <code>add_comm_group...</code>?</p>",
        "id": 250115649,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629465288
    },
    {
        "content": "<p>Ah, sure, thanks.</p>",
        "id": 250115692,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629465314
    },
    {
        "content": "<p>And there is no <code>add_comm_group_with_*</code> because <code>add_comm_group</code> already has zero, and no one has made the <code>with_blah</code> version for it.</p>",
        "id": 250115791,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1629465363
    },
    {
        "content": "<p>Great, I see. I though the difference was just a matter of notation.</p>",
        "id": 250115823,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629465366
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/113488-general/topic/Ostrowski.20theorems.20formalized.20in.20Lean.203/near/250115534\">said</a>:</p>\n<blockquote>\n<p>I'll move this thread to the maths stream where it belongs...</p>\n</blockquote>\n<p>I can't seem to move the messages... how does this work again?</p>",
        "id": 250116279,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629465614
    },
    {
        "content": "<p>You simply wait for someone else to do it.</p>",
        "id": 250116559,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1629465766
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span>  At any rate, I was just trying to add another possible definition to your file, and I got stuck when trying to prove that in my definition the p-adic integers are a valuation ring. Should I <code>push</code> to your branch or create another one?</p>",
        "id": 250116868,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629465941
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/116395-maths/topic/Ostrowski.20theorems.20formalized.20in.20Lean.203/near/250077506\">said</a>:</p>\n<blockquote>\n<p>That definition (assuming you are talking about (2) above) and the corresponding valuation <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mspace></mspace><mspace width=\"0.1111111111111111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333333333333333em\"/><mi mathvariant=\"script\">O</mi><mo>→</mo><mi mathvariant=\"normal\">Γ</mi></mrow><annotation encoding=\"application/x-tex\">v \\colon \\mathcal O \\to \\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111111111111111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333333333333333em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Γ</span></span></span></span> are already in the perfectoid project. Not sure how much of this \"canonical valuation\" has made it to mathlib.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> IIRC the perfectoid project doesn't have a definition of a valuation ring...</p>",
        "id": 250117083,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466066
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> feel free to push to my branch, but I think the better way to approach this is to prove that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Z</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> is a DVR, and prove that DVRs (in the sense of mathlib) are valuation rings.</p>",
        "id": 250117287,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466179
    },
    {
        "content": "<p>Presumably the fact that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">Z</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> is a DVR is already in mathlib?</p>",
        "id": 250117342,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466203
    },
    {
        "content": "<p>OK, I will need to go but I'll push, at any rate. We might discuss this further, perhaps, if you want.</p>",
        "id": 250117419,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466240
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> what's happenning with this code you pushed?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span> <span class=\"n\">valuation_ring'</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">K</span><span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">integral_domain</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">field</span> <span class=\"n\">K</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">algebra</span> <span class=\"n\">R</span> <span class=\"n\">K</span><span class=\"o\">]</span>\n  <span class=\"o\">[</span><span class=\"n\">is_fraction_ring</span> <span class=\"n\">R</span> <span class=\"n\">K</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"n\">valuation</span> <span class=\"n\">K</span> <span class=\"bp\">Γ₀</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">int_cond</span> <span class=\"o\">:</span> <span class=\"n\">R</span> <span class=\"bp\">=</span> <span class=\"o\">{</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">K</span> <span class=\"bp\">|</span> <span class=\"n\">v</span> <span class=\"n\">x</span> <span class=\"bp\">≥</span> <span class=\"mi\">0</span><span class=\"o\">})</span>\n</code></pre></div>",
        "id": 250117840,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466461
    },
    {
        "content": "<p>Does this even compile?</p>",
        "id": 250117871,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466479
    },
    {
        "content": "<p>It does</p>",
        "id": 250117885,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466490
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243562\">@Adam Topaz</span> Right, the pftd project defines <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Γ</mi></mrow><annotation encoding=\"application/x-tex\">\\Gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">Γ</span></span></span></span> and the canonical valuation for an arbitrary starting valuation. But still I think a lot of stuff can be reused. Building the quotient <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">O</mi><mi mathvariant=\"normal\">/</mi><msup><mi mathvariant=\"script\">O</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathcal O/\\mathcal O^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.688696em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span> and the canonical valuation will still be the same.</p>",
        "id": 250117906,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1629466505
    },
    {
        "content": "<p>How? <code>R</code> is a type and <code>{ x : K | ... }</code> is a set.</p>",
        "id": 250117912,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466509
    },
    {
        "content": "<p>Yes, this looked very strange to me.</p>",
        "id": 250117933,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466520
    },
    {
        "content": "<p>(One more note: the mathlib valuations are written multiplicatively so it should really be <code>{x : K | v x \\le 1 }</code>.)</p>",
        "id": 250117993,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466545
    },
    {
        "content": "<p>Oh, this is certainly correct</p>",
        "id": 250118072,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466569
    },
    {
        "content": "<p>At any rate I will modify it tomorrow, also trying to understand how it possibly compiles.</p>",
        "id": 250118142,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466608
    },
    {
        "content": "<p>My point was that when playing with extending valuations for ramified extensions, a bit of flexibility might have been useful rather than having \"the canonical one\", that's all.</p>",
        "id": 250118403,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629466744
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> I think the main issue that won't be covered by the code from the perfectoid project is the order on the value group. It seems that you start with a valuation, and construct the order on the \"canonical\" value group by embedding it in the original value group, using the ordering from the value group of the given valuation. In this case, we don't start with a valuation so we have to construct the order from scratch using the axioms of a valuation ring.</p>",
        "id": 250118464,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466787
    },
    {
        "content": "<p>(By the way, the reason <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> 's code above compiles is because lean coerces the set to a type, then asks for an equality of types, so this is not a good definition)</p>",
        "id": 250118969,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629466990
    },
    {
        "content": "<p>Perhaps what we should do is define a gadget consisting of the following data: A commutative ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>, a prime ideal <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"fraktur\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathfrak{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.71302em;vertical-align:-0.18906em;\"></span><span class=\"mord mathfrak\">p</span></span></span></span>, and a valuation ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> which is a localization of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"fraktur\">p</mi></mrow><annotation encoding=\"application/x-tex\">A/\\mathfrak{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord\">/</span><span class=\"mord mathfrak\">p</span></span></span></span>. This way you can associate such a gadget to any valuation, and conversely associate a valuation to any gadget.</p>",
        "id": 250120941,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1629467986
    },
    {
        "content": "<p>At any rate I wanted to improve that part of code, so it will certainly be changed. But thanks for the check!</p>",
        "id": 250129457,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1629471754
    }
]