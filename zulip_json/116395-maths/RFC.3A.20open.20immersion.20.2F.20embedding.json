[
    {
        "content": "<p>I've asked here several times about whether Lean has open immersions a.k.a open embeddings a.k.a. injections X -&gt; Y of topological spaces which are isomorphic to the inclusion of an open subset. I don't think we do, and I feel confident enough nowadays to be able to PR them myself. I attempted to make a start and immediately ran into questions of (a) name (b) bundle/unbundle (c) notation. Does anyone have any comments on the below code?</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"n\">topology</span><span class=\"bp\">.</span><span class=\"n\">order</span>\n\n<span class=\"c1\">-- An open immersion is a continuous injection of topological spaces which is also an open map.</span>\n<span class=\"c1\">-- Or is it called open embedding?</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">function</span> <span class=\"n\">set</span>\n\n<span class=\"kn\">structure</span> <span class=\"n\">open_immersion</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">topological_space</span> <span class=\"n\">β</span><span class=\"o\">]</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">to_fun</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">cts</span> <span class=\"o\">:</span> <span class=\"n\">continuous</span> <span class=\"n\">to_fun</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">inj</span> <span class=\"o\">:</span> <span class=\"n\">injective</span> <span class=\"n\">to_fun</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">is_open</span> <span class=\"o\">:</span> <span class=\"bp\">_</span><span class=\"n\">root_</span><span class=\"bp\">.</span><span class=\"n\">is_open</span> <span class=\"o\">(</span><span class=\"n\">range</span> <span class=\"n\">to_fun</span><span class=\"o\">))</span>\n\n<span class=\"n\">def</span> <span class=\"n\">is_open_immersion</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"o\">[</span><span class=\"n\">tα</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">tβ</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">β</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"n\">function</span><span class=\"bp\">.</span><span class=\"n\">injective</span> <span class=\"n\">f</span> <span class=\"bp\">∧</span> <span class=\"n\">tα</span> <span class=\"bp\">=</span> <span class=\"n\">tβ</span><span class=\"bp\">.</span><span class=\"n\">induced</span> <span class=\"n\">f</span> <span class=\"bp\">∧</span> <span class=\"bp\">_</span><span class=\"n\">root_</span><span class=\"bp\">.</span><span class=\"n\">is_open</span> <span class=\"o\">(</span><span class=\"n\">range</span> <span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">infixr</span> <span class=\"bp\">`</span> <span class=\"err\">↪₀</span> <span class=\"bp\">`</span><span class=\"o\">:</span><span class=\"mi\">25</span> <span class=\"o\">:=</span> <span class=\"n\">open_immersion</span>\n</pre></div>\n\n\n<p>I think algebraic geometers call them open immersions, and differential geometers call them open embeddings (what do I know, I'm a number theorist). I see from <code>topology/maps.lean</code> that we have things like</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">def</span> <span class=\"n\">embedding</span> <span class=\"o\">[</span><span class=\"n\">tα</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">tβ</span> <span class=\"o\">:</span> <span class=\"n\">topological_space</span> <span class=\"n\">β</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Prop</span> <span class=\"o\">:=</span>\n<span class=\"n\">function</span><span class=\"bp\">.</span><span class=\"n\">injective</span> <span class=\"n\">f</span> <span class=\"bp\">∧</span> <span class=\"n\">tα</span> <span class=\"bp\">=</span> <span class=\"n\">tβ</span><span class=\"bp\">.</span><span class=\"n\">induced</span> <span class=\"n\">f</span>\n</pre></div>\n\n\n<p>but that might have been written before we came round to a \"bundle morphisms\" philosophy.</p>\n<div class=\"codehilite\"><pre><span></span>\n</pre></div>",
        "id": 168666556,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1561108329
    },
    {
        "content": "<p><a href=\"https://mathoverflow.net/questions/48527/why-open-immersion-rather-than-open-embedding\" target=\"_blank\" title=\"https://mathoverflow.net/questions/48527/why-open-immersion-rather-than-open-embedding\">https://mathoverflow.net/questions/48527/why-open-immersion-rather-than-open-embedding</a> for example, to see a debate about the naming issue.</p>",
        "id": 168666656,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1561108450
    },
    {
        "content": "<p>I think we should leave topological functions unbundled for now. Unlike linear maps, it's not like open immersions have a nice algebraic structure of their own</p>",
        "id": 168666863,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1561108757
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/issues/1059\" target=\"_blank\" title=\"https://github.com/leanprover-community/mathlib/issues/1059\">#1059</a> adds open embeddings but now I remember it got caught up in some minor issue.</p>",
        "id": 168667962,
        "sender_full_name": "Reid Barton",
        "timestamp": 1561110128
    },
    {
        "content": "<p>As to the bundled/unbundled question, the vague opinion I have formed over time is the following: if a property is the essential feature of an object, it should be bundled. If it is some additional property that might be satisfied by some of the objects you want to play with, but not all of them, then it should be unbundled. In some situations, both make sense, and then I am happy to have both.</p>\n<p>Examples: </p>\n<ul>\n<li>the derivative of a map is a linear map by essence, so it should be bundled (using <code>linear_map</code>). </li>\n<li>The composition of two linear maps is well defined, and it turns out that the left-composition (or right-composition) by a fixed linear map is a linear operation on the space of linear maps. But that's not the essence of  what I want to do, I really want to think of it as composition. Here, unbundled is better (using <code>is_linear_map</code>).</li>\n</ul>",
        "id": 168669531,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1561111936
    }
]