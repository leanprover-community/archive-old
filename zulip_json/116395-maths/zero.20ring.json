[
    {
        "content": "<p>I'm working with polynomials and the zero ring is constantly a special case. There is a class <code>nonzero_comm_ring</code> extending comm_ring with the proposition that <code>0 \\ne 1</code>, and several of Chris' results on polynomials need this as a hypothesis (for example the fact that degree of <code>X</code> is 1, and every corollary of this). Of course everything is true (and trivial) for the zero ring, but often the proofs need to be separate because of this. Because of the constructor for <code>nonzero_comm_ring</code> I am coming around to the idea to be splitting on <code>(0 : R) = 1</code> for lemmas which are true in the case R=0 but where the proof in the non-zero case is far from working for the zero ring.</p>\n<p>So I now find myself wanting to prove things such as \"if R is a ring and 0 = 1 then R is a fintype\". I don't really know how to make that an instance, and I am not sure whether it should be an instance. On the other hand if I made a new class <code>zero_ring</code> then in some sense my life would be easier. Having said that, making a class for such a silly edge case seems a bit ridiculous. Should I just stick to proving lemmas rather than making this a class? I am slightly concerned that really I should be working with <code>zero_semiring</code> or something.</p>\n<p>Another issue is that if I put <code>0 = 1 -&gt; fintype R</code> into <code>ring.lean</code> then I have to add an import to <code>ring.lean</code> and I have this vague worry that I don't really know \"which comes first\" out of rings and fintypes.</p>",
        "id": 133613106,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536504964
    },
    {
        "content": "<blockquote>\n<p>\"if R is a ring and 0 = 1 then R is a fintype\"</p>\n</blockquote>\n<p>Is this a real example, including the <code>fintype</code> part?</p>",
        "id": 133613814,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536505888
    },
    {
        "content": "<p>Your <code>zero_ring</code> could be \"lifted\" all the way up to <code>is_singleton</code>, except we don't have it.</p>",
        "id": 133613889,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536505952
    },
    {
        "content": "<p>Rings definitely come before <code>fintype</code>. A more useful instance would perhaps be <code>0 = 1 -&gt; subsingleton R</code></p>",
        "id": 133613892,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1536505958
    },
    {
        "content": "<p>You can also use <code>subsingleton</code> in this case, yeah</p>",
        "id": 133613899,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536505975
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"kn\">lemma</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">zero_of_zero_eq_one</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">ring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h01</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">a</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span>\n<span class=\"k\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"err\">←</span><span class=\"n\">one_mul</span> <span class=\"n\">a</span><span class=\"o\">,</span><span class=\"err\">←</span><span class=\"n\">h01</span><span class=\"o\">,</span><span class=\"n\">zero_mul</span><span class=\"o\">]</span>\n\n<span class=\"n\">noncomputable</span> <span class=\"kn\">definition</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">fintype_of_zero_eq_one</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">ring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h01</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">fintype</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"o\">{</span>\n  <span class=\"n\">elems</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">},</span>\n  <span class=\"n\">complete</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">begin</span>\n    <span class=\"n\">suffices</span><span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">simpa</span><span class=\"o\">,</span>\n    <span class=\"n\">exact</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">zero_of_zero_eq_one</span> <span class=\"n\">h01</span> <span class=\"n\">x</span><span class=\"o\">,</span>\n  <span class=\"kn\">end</span>\n<span class=\"o\">}</span>\n\n<span class=\"kn\">theorem</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">is_noetherian_of_zero_eq_one</span> <span class=\"o\">{</span><span class=\"n\">R</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">ring</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h01</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_noetherian_ring</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"bp\">@</span><span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">is_noetherian_of_fintype</span> <span class=\"n\">R</span> <span class=\"n\">R</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span> <span class=\"err\">$</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">fintype_of_zero_eq_one</span> <span class=\"n\">h01</span>\n</pre></div>",
        "id": 133613915,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536506015
    },
    {
        "content": "<p>Aha I see. I was wondering how you were using the <code>fintype</code>, but this makes sense.</p>",
        "id": 133613971,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536506047
    },
    {
        "content": "<p>I am trying to prove the Hilbert basis theorem for the zero ring :-)</p>",
        "id": 133613973,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536506055
    },
    {
        "content": "<p>I've proved that if a module is a fintype then it's Noetherian so I figured I'd use that.</p>",
        "id": 133614007,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536506128
    },
    {
        "content": "<p>So you could use case analysis on whether R is a subsingleton, and show that if it isn't then <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>0</mn><mo>≠</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">0 \\ne 1</annotation></semantics></math></span><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"strut\" style=\"height:0.716em;\"></span><span class=\"strut bottom\" style=\"height:0.9309999999999999em;vertical-align:-0.215em;\"></span><span class=\"base\"><span class=\"mord mathrm\">0</span><span class=\"mrel\">≠</span><span class=\"mord mathrm\">1</span></span></span></span>.<br>\nThen also make an instance that says that if R is a subsingleton then so is R[X].</p>",
        "id": 133614049,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536506167
    },
    {
        "content": "<p>Or write a lemma <code>∀ R, subsingleton R ∨ ((0 : R) ≠ 1)</code></p>",
        "id": 133614079,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536506274
    },
    {
        "content": "<p>I see. You're suggesting that I use what we currently have in the type class system by using a different class to convey what I'm trying to say, rather than making a new class. Thanks!</p>",
        "id": 133614109,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536506283
    },
    {
        "content": "<p>Well, I would actually prefer that you make a new class but that it should be called <code>is_singleton</code> :)</p>",
        "id": 133614126,
        "sender_full_name": "Reid Barton",
        "timestamp": 1536506316
    },
    {
        "content": "<p>Hmm. <code>subsingleton</code> is a Prop. Does this mean that type class inference won't get me from it to <code>fintype</code>?</p>",
        "id": 133614395,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536506762
    },
    {
        "content": "<p>Not computably.</p>",
        "id": 133614443,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1536506809
    },
    {
        "content": "<p>It will for rings though</p>",
        "id": 133614459,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1536506827
    },
    {
        "content": "<p>Proof now looks like</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">theorem</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">is_noetherian_of_zero_eq_one</span> <span class=\"o\">{</span><span class=\"n\">R</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">ring</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h01</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_noetherian_ring</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"k\">by</span> <span class=\"n\">haveI</span> <span class=\"o\">:=</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">h01</span><span class=\"bp\">;</span> <span class=\"n\">exact</span> <span class=\"n\">ring</span><span class=\"bp\">.</span><span class=\"n\">is_noetherian_of_fintype</span> <span class=\"n\">R</span> <span class=\"n\">R</span>\n</pre></div>",
        "id": 133615195,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536507705
    },
    {
        "content": "<p>I read that Kevin fights the zero ring. But what's the point of allowing this ring? Why don't we defined a ring with the assumption that 0 and 1 are different? Is it a trick in order to totalize certain constructions? Or is it needed from a categorical point of view (I guess it's a terminal object)?</p>",
        "id": 133793917,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536753263
    },
    {
        "content": "<p>I've never thought this through carefully, but I think it is indeed useful from a categorical point of view.</p>",
        "id": 133793951,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1536753332
    },
    {
        "content": "<p>Funnily enough in my undergraduate ring theory course the lecturer made 0 not= 1 an axiom, and it caused them all sorts of problems. Whenever they formed a quotient ring R / I I would put my hand up and point out that they needed to assume that I was not R (which was not a natural thing to do on many occasions). On the other hand I was only an undergraduate and just assumed that this was an axiom of rings. It was only when I learnt algebraic geometry that I found out that it wasn't. Assuming 0 isn't 1 is a disastrous idea. In a separated scheme, the intersection of two affines is affine -- this sort of thing is used all the time. It would not be true if the empty scheme were not affine.</p>",
        "id": 133794730,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1536754444
    },
    {
        "content": "<p>The quotient case is one of the examples I had in mind when I wrote \"totalizing construction\". The same probably happens with localization</p>",
        "id": 133794785,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536754514
    },
    {
        "content": "<blockquote>\n<p>and i̶t̶  Kevin caused them all sorts of problems</p>\n</blockquote>",
        "id": 133794890,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1536754643
    },
    {
        "content": "<p>of course, Kevin's behavior there is exactly what lean would do to you if you tried to formalize it</p>",
        "id": 133812772,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1536772222
    },
    {
        "content": "<p>Where do I find the zero ring? I want to offer it promotion to topological ring. Patrick, did you already do this?</p>\n<p>If it was already there, what was the algorithm I should have used to find it? </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"c1\">-- desperation imports</span>\n<span class=\"kn\">import</span> <span class=\"n\">tactic</span><span class=\"bp\">.</span><span class=\"n\">linarith</span>\n\n<span class=\"kn\">import</span> <span class=\"n\">topology</span><span class=\"bp\">.</span><span class=\"n\">metric_space</span><span class=\"bp\">.</span><span class=\"n\">gromov_hausdorff</span>\n\n<span class=\"kn\">instance</span> <span class=\"o\">:</span> <span class=\"n\">comm_ring</span> <span class=\"n\">unit</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">apply_instance</span> <span class=\"c1\">-- fails</span>\n</pre></div>",
        "id": 170586361,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562798972
    },
    {
        "content": "<p>I really want \"import all of mathlib\" here.</p>",
        "id": 170586397,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562799002
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"kn\">instance</span> <span class=\"o\">:</span> <span class=\"n\">comm_ring</span> <span class=\"n\">unit</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">add</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">,</span> <span class=\"o\">(),</span>\n  <span class=\"n\">add_assoc</span> <span class=\"o\">:=</span> <span class=\"k\">by</span> <span class=\"n\">simp</span><span class=\"o\">,</span>\n  <span class=\"n\">zero</span> <span class=\"o\">:=</span> <span class=\"o\">(),</span>\n  <span class=\"n\">zero_add</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">x</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">add_zero</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">x</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">neg</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"bp\">_</span><span class=\"o\">,</span> <span class=\"o\">(),</span>\n  <span class=\"n\">add_left_neg</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">x</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">add_comm</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">b</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">mul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"bp\">_</span> <span class=\"bp\">_</span><span class=\"o\">,</span> <span class=\"o\">(),</span>\n  <span class=\"n\">mul_assoc</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">b</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">c</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">one</span> <span class=\"o\">:=</span> <span class=\"o\">(),</span>\n  <span class=\"n\">one_mul</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_one</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">left_distrib</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">b</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">c</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">right_distrib</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">b</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">c</span><span class=\"bp\">;</span> <span class=\"n\">refl</span><span class=\"o\">,</span>\n  <span class=\"n\">mul_comm</span> <span class=\"o\">:=</span> <span class=\"bp\">λ</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"k\">by</span> <span class=\"n\">cases</span> <span class=\"n\">a</span><span class=\"bp\">;</span> <span class=\"n\">cases</span> <span class=\"n\">b</span><span class=\"bp\">;</span> <span class=\"n\">refl</span> <span class=\"o\">}</span>\n</pre></div>",
        "id": 170587997,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562800303
    },
    {
        "content": "<p>I wrote that algorithmically.</p>",
        "id": 170588049,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562800329
    },
    {
        "content": "<p>I'm about to put a topology on this ring pretty algorithmically as well and then prove it's a topological ring in an equally trivial way. What is the automation that does all this for me?</p>",
        "id": 170588092,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562800386
    },
    {
        "content": "<p>I thought I remembered it from somewhere. <code>algebra.punit_instances</code></p>",
        "id": 170588686,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562800975
    },
    {
        "content": "<p><code>topological_ring unit</code> missing?</p>",
        "id": 170588820,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562801125
    },
    {
        "content": "<p>My goal is now</p>\n<div class=\"codehilite\"><pre><span></span>⊢ topological_space.lattice.complete_lattice = tmp_complete_lattice\n</pre></div>\n\n\n<p>That's some officially-sanctioned mathlib name is it?</p>\n<p>A little earlier:</p>\n<div class=\"codehilite\"><pre><span></span>invalid type ascription, term has type\n  @topological_ring unit (@uniform_space.to_topological_space unit unit.uniform_space)\n    (@comm_ring.to_ring unit punit.comm_ring)\nbut is expected to have type\n  @topological_ring unit ⊤ (@comm_ring.to_ring unit punit.comm_ring)\nstate:\nU : topological_space.opens empty\n⊢ topological_ring unit\n</pre></div>",
        "id": 170590649,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562803154
    },
    {
        "content": "<p>got it, i'd made a diamond</p>",
        "id": 170590796,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562803276
    },
    {
        "content": "<p><code>  valuation := by rintro ⟨⟩,</code> -- thanks <span class=\"user-mention\" data-user-id=\"110596\">@Rob Lewis</span>  ;-)</p>",
        "id": 170590991,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1562803505
    },
    {
        "content": "<p>I thought the zero ring was added to <code>pi_instances</code></p>",
        "id": 170594504,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1562808306
    },
    {
        "content": "<p>(which should be renamed btw)</p>",
        "id": 170594507,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1562808314
    },
    {
        "content": "<p>No it's all in the file <code>punit_instances</code>. But <code>topological_ring</code> is probably missing.</p>",
        "id": 170600845,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1562819200
    },
    {
        "content": "<p>I would like to use the fact that if a normed ring is stupid (by which I mean that <code>0 = 1</code>), then all subsets are open.  Here is what I have:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">analysis</span><span class=\"bp\">.</span><span class=\"n\">normed_space</span><span class=\"bp\">.</span><span class=\"n\">basic</span>\n<span class=\"kn\">variables</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span> <span class=\"n\">test</span> <span class=\"o\">[</span><span class=\"n\">semiring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">to_inhabited</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">},</span>\n  <span class=\"n\">uniq</span>         <span class=\"o\">:=</span> <span class=\"n\">eq_zero_of_zero_eq_one</span> <span class=\"n\">α</span> <span class=\"n\">h</span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span> <span class=\"n\">test2</span> <span class=\"o\">[</span><span class=\"n\">normed_ring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">discrete_topology</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"bp\">@</span><span class=\"n\">subsingleton</span><span class=\"bp\">.</span><span class=\"n\">discrete_topology</span> <span class=\"n\">α</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">unique</span><span class=\"bp\">.</span><span class=\"n\">subsingleton</span> <span class=\"n\">α</span> <span class=\"o\">(</span><span class=\"n\">test</span> <span class=\"n\">h</span><span class=\"o\">))</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">[</span><span class=\"n\">normed_ring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_open</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n<span class=\"bp\">@</span><span class=\"n\">is_open_discrete</span> <span class=\"n\">α</span> <span class=\"bp\">_</span> <span class=\"o\">(</span><span class=\"n\">test2</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"n\">s</span>\n</code></pre></div>\n\n\n<p>Can this be cleaned up (for example, to avoid all the <code>@</code>s)?  What should the instances <code>test</code> and <code>test2</code> be called, and in what files do they belong?  (I was surprised that <code>test</code> did not already exist; is there a reason for this?)</p>",
        "id": 202200698,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593285196
    },
    {
        "content": "<p>Did you see <a href=\"https://leanprover-community.github.io/mathlib_docs/find/subsingleton_of_zero_eq_one\">docs#subsingleton_of_zero_eq_one</a> , it might cut test out of your proof?</p>",
        "id": 202200956,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1593285534
    },
    {
        "content": "<p>Aha, thank you!</p>",
        "id": 202200986,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593285582
    },
    {
        "content": "<p>Is there a reason that there is no <code>unique_of_zero_eq_one</code>?</p>",
        "id": 202201039,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593285614
    },
    {
        "content": "<p>For <code>test2</code>, I would replace <code>h</code> with <code>[unique \\a]</code></p>",
        "id": 202201040,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285618
    },
    {
        "content": "<p>Johan, I am doing a proof by cases on <code>0 = 1</code></p>",
        "id": 202201056,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593285645
    },
    {
        "content": "<p>I want the proof of this to be that if 0=1 then the underlying topological space is isomorphic to <code>punit</code> and hence all sets are open by <code>transfer</code> because it's true for punit by <code>dec_trivial</code>. <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> is that the way to do it?</p>",
        "id": 202201061,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1593285652
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> I think that <code>test</code> and co cannot be instances, because typeclass search can't figure out <code>0 = 1</code>.</p>",
        "id": 202201063,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285653
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/zero.20ring/near/202201039\">said</a>:</p>\n<blockquote>\n<p>Is there a reason that there is no <code>unique_of_zero_eq_one</code>?</p>\n</blockquote>\n<p>I don't know, it seems to me there should be.</p>",
        "id": 202201065,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1593285654
    },
    {
        "content": "<p>If <code>0 = 1</code>, I get <code>[unique α]</code> and access to one set of theorems; if <code>0 ≠ 1</code>, I get <code>[nonzero α]</code> and another set of theorems</p>",
        "id": 202201090,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593285720
    },
    {
        "content": "<p>Yup, I agree</p>",
        "id": 202201137,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285735
    },
    {
        "content": "<p>But you can't get <code>unique \\a</code> without writing something (as in, tc search won't figure it out for you).</p>",
        "id": 202201145,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285760
    },
    {
        "content": "<p>If you use <code>[fact (0 = 1)]</code> then it can work</p>",
        "id": 202201149,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285771
    },
    {
        "content": "<p>But then... how will you get <code>fact (0 = 1)</code> in you hypotheses?</p>",
        "id": 202201161,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285795
    },
    {
        "content": "<p>It will still require writing a line. So I'm not sure if it's worth it.</p>",
        "id": 202201167,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285808
    },
    {
        "content": "<p><code>haveI</code> right?</p>",
        "id": 202201175,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1593285821
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> I think <code>test2</code> shouldn't be necessary.</p>",
        "id": 202201223,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285860
    },
    {
        "content": "<p>Just <code>letI : unique \\a := test _</code> in your proof.</p>",
        "id": 202201226,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285881
    },
    {
        "content": "<p>The rest will be done by tc</p>",
        "id": 202201231,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593285889
    },
    {
        "content": "<p>Sorry, had to step away for a sec</p>",
        "id": 202201482,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593286299
    },
    {
        "content": "<p>To summarize the suggestions of all three of you, I can get the result I need from</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">example</span> <span class=\"o\">[</span><span class=\"n\">normed_ring</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">is_open</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">letI</span> <span class=\"o\">:</span> <span class=\"n\">subsingleton</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">α</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n  <span class=\"n\">exact</span> <span class=\"n\">is_open_discrete</span> <span class=\"n\">s</span><span class=\"o\">,</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 202201619,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593286489
    },
    {
        "content": "<p>Remaining questions:  Is there a way to do <code>letI</code> in term mode?  And, must I be a good citizen and add <code>unique_of_zero_eq_one</code>?</p>",
        "id": 202201635,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593286545
    },
    {
        "content": "<p>I think we want something like this:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">ring_theory</span><span class=\"bp\">.</span><span class=\"n\">noetherian</span>\n\n<span class=\"kn\">variables</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">semiring</span> <span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span> <span class=\"n\">subsingleton_or_nonzero</span> <span class=\"o\">:</span> <span class=\"n\">subsingleton</span> <span class=\"n\">R</span> <span class=\"bp\">∨</span> <span class=\"n\">nonzero</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">classical</span><span class=\"o\">,</span>\n  <span class=\"n\">by_cases</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">left</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">right</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"bp\">⟨</span><span class=\"n\">h</span><span class=\"bp\">⟩</span> <span class=\"o\">}</span>\n<span class=\"kn\">end</span>\n\n<span class=\"c1\">-- use like this</span>\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">true</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">rcases</span> <span class=\"n\">subsingleton_or_nonzero</span> <span class=\"n\">R</span> <span class=\"k\">with</span> <span class=\"bp\">_</span><span class=\"n\">i</span><span class=\"bp\">|_</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">resetI</span><span class=\"o\">,</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 202202187,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287286
    },
    {
        "content": "<p>I'll build another one that uses <code>unique</code></p>",
        "id": 202202198,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287301
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">unique_of_zero_eq_one</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"n\">uniq</span> <span class=\"o\">:=</span>\n  <span class=\"k\">begin</span>\n    <span class=\"n\">haveI</span> <span class=\"o\">:=</span> <span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">intro</span> <span class=\"n\">r</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"n\">subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span> <span class=\"n\">r</span> <span class=\"bp\">_</span>\n  <span class=\"kn\">end</span> <span class=\"o\">}</span>\n\n<span class=\"kn\">inductive</span> <span class=\"n\">data_xor</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"n\">Sort</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"n\">Sort</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">left</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">X</span><span class=\"o\">)</span>  <span class=\"o\">:</span> <span class=\"n\">data_xor</span>\n<span class=\"bp\">|</span> <span class=\"n\">right</span> <span class=\"o\">(</span><span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">data_xor</span>\n\n<span class=\"n\">noncomputable</span> <span class=\"n\">def</span> <span class=\"n\">unique_or_nonzero</span> <span class=\"o\">:</span> <span class=\"n\">data_xor</span> <span class=\"o\">(</span><span class=\"n\">unique</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">nonzero</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">classical</span><span class=\"o\">,</span>\n  <span class=\"n\">by_cases</span> <span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">data_xor</span><span class=\"bp\">.</span><span class=\"n\">left</span> <span class=\"o\">(</span><span class=\"n\">unique_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span><span class=\"o\">)</span> <span class=\"o\">},</span>\n  <span class=\"o\">{</span> <span class=\"n\">exact</span> <span class=\"n\">data_xor</span><span class=\"bp\">.</span><span class=\"n\">right</span> <span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"o\">)</span> <span class=\"o\">}</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span> <span class=\"o\">(</span><span class=\"n\">r</span> <span class=\"o\">:</span> <span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">true</span> <span class=\"o\">:=</span>\n<span class=\"k\">begin</span>\n  <span class=\"n\">rcases</span> <span class=\"n\">unique_or_nonzero</span> <span class=\"n\">R</span> <span class=\"k\">with</span> <span class=\"bp\">_</span><span class=\"n\">i</span><span class=\"bp\">|_</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">resetI</span><span class=\"o\">,</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 202202448,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287646
    },
    {
        "content": "<p>Yes, these look great!</p>",
        "id": 202202454,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593287661
    },
    {
        "content": "<p>I think this is how you generally want to split cases, and this way it's a one liner.<br>\nThe <code>resetI</code> is important though! Because it adds the result or <code>rcases</code> to the type class cache.</p>",
        "id": 202202458,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287692
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> Feel free to incorporate this into a PR</p>",
        "id": 202202463,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287710
    },
    {
        "content": "<p>If nobody else does it, I'll do it next week.</p>",
        "id": 202202468,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287722
    },
    {
        "content": "<p>Note that <code>unique</code> is data. We have to choose a default element, and I choose <code>0</code>.</p>",
        "id": 202202519,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287790
    },
    {
        "content": "<p>So <code>1</code> is only provably equal to <code>default R</code>, not defeq.</p>",
        "id": 202202521,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593287805
    },
    {
        "content": "<p>OK, thanks a lot.  I have a nearly-ready PR it can go in, but if \"nearly-ready\" is not \"ready\" by Monday, I'll pass back to you.</p>",
        "id": 202202522,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593287806
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/116395-maths/topic/zero.20ring/near/202202448\">said</a>:</p>\n<blockquote>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">unique_of_zero_eq_one</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"n\">uniq</span> <span class=\"o\">:=</span>\n  <span class=\"k\">begin</span>\n    <span class=\"n\">haveI</span> <span class=\"o\">:=</span> <span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">intro</span> <span class=\"n\">r</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"n\">subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span> <span class=\"n\">r</span> <span class=\"bp\">_</span>\n  <span class=\"kn\">end</span> <span class=\"o\">}</span>\n</code></pre></div>\n\n\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> , is there a reason you did this instead of </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">unique_of_zero_eq_one</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"n\">uniq</span>    <span class=\"o\">:=</span> <span class=\"n\">eq_zero_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span> <span class=\"o\">}</span>\n</code></pre></div>",
        "id": 202203546,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593289454
    },
    {
        "content": "<p>And one more question:  what file should </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">inductive</span> <span class=\"n\">data_xor</span> <span class=\"o\">(</span><span class=\"n\">X</span> <span class=\"o\">:</span> <span class=\"n\">Sort</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Y</span> <span class=\"o\">:</span> <span class=\"n\">Sort</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"n\">left</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">X</span><span class=\"o\">)</span>  <span class=\"o\">:</span> <span class=\"n\">data_xor</span>\n<span class=\"bp\">|</span> <span class=\"n\">right</span> <span class=\"o\">(</span><span class=\"n\">y</span> <span class=\"o\">:</span> <span class=\"n\">Y</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">data_xor</span>\n</code></pre></div>\n\n\n<p>go in?</p>",
        "id": 202204600,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593291357
    },
    {
        "content": "<p>that's the <code>sum</code>type?</p>",
        "id": 202204652,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1593291406
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110064\">@Kenny Lau</span> , can you elaborate?  If I naively replace all uses of <code>data_xor</code> with <code>sum</code> in Johan's example<br>\n<code>noncomputable def unique_or_nonzero : data_xor (unique R) (nonzero R)</code>, I get the following error:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">type</span> <span class=\"n\">mismatch</span> <span class=\"n\">at</span> <span class=\"n\">application</span>\n  <span class=\"n\">unique</span> <span class=\"n\">α</span> <span class=\"err\">⊕</span> <span class=\"n\">nonzero</span> <span class=\"n\">α</span>\n<span class=\"n\">term</span>\n  <span class=\"n\">nonzero</span> <span class=\"n\">α</span>\n<span class=\"n\">has</span> <span class=\"n\">type</span>\n  <span class=\"kt\">Prop</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"n\">but</span> <span class=\"n\">is</span> <span class=\"n\">expected</span> <span class=\"n\">to</span> <span class=\"k\">have</span> <span class=\"n\">type</span>\n  <span class=\"kt\">Type</span> <span class=\"err\">?</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"o\">(</span><span class=\"err\">?</span><span class=\"bp\">+</span><span class=\"mi\">1</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 202204739,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593291597
    },
    {
        "content": "<p>hmm, how about <code>psum</code> (if it exists)?</p>",
        "id": 202204869,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1593291751
    },
    {
        "content": "<p>Seems to work, thanks!  What's a <code>psum</code>?</p>",
        "id": 202204950,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593291895
    },
    {
        "content": "<p>I think <code>p</code> just means universere <strong>p</strong>olymorphic</p>",
        "id": 202205226,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1593292341
    },
    {
        "content": "<p>I interpreted the <code>p</code> in <code>psum</code> as \"proposition\", since <code>sum : Type u → Type v → Type (max u v)</code> and <code>psum : Sort u → Sort v → Sort (max 1 u v)</code> are both universe polymorphic, but only <code>psum</code> accepts <code>Prop</code> components (because <code>Sort u</code> is like saying \"<code>Prop</code> or any <code>Type</code> level\").</p>",
        "id": 202216618,
        "sender_full_name": "Scott Olson",
        "timestamp": 1593312957
    },
    {
        "content": "<p>A bunch of the core types come in threes, like <code>or</code>/<code>sum</code>/<code>psum</code>, <code>and</code>/<code>prod</code>/<code>pprod</code>, and <code>Exists</code>/<code>sigma</code>/<code>psigma</code>.</p>",
        "id": 202216722,
        "sender_full_name": "Scott Olson",
        "timestamp": 1593313159
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/116395-maths/topic/zero.20ring/near/202203546\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/116395-maths/topic/zero.20ring/near/202202448\">said</a>:</p>\n<blockquote>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">unique_of_zero_eq_one</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"n\">uniq</span> <span class=\"o\">:=</span>\n  <span class=\"k\">begin</span>\n    <span class=\"n\">haveI</span> <span class=\"o\">:=</span> <span class=\"n\">subsingleton_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span><span class=\"o\">,</span>\n    <span class=\"n\">intro</span> <span class=\"n\">r</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"n\">subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span> <span class=\"n\">r</span> <span class=\"bp\">_</span>\n  <span class=\"kn\">end</span> <span class=\"o\">}</span>\n</code></pre></div>\n\n\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> , is there a reason you did this instead of </p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">def</span> <span class=\"n\">unique_of_zero_eq_one</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">R</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">unique</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">{</span> <span class=\"n\">default</span> <span class=\"o\">:=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"n\">uniq</span>    <span class=\"o\">:=</span> <span class=\"n\">eq_zero_of_zero_eq_one</span> <span class=\"n\">R</span> <span class=\"n\">h</span> <span class=\"o\">}</span>\n</code></pre></div>\n\n\n</blockquote>\n<p>Yes, but the reason is silly: I didn't think of using <code>eq_zero_of_zero_eq_one</code>... So, it's just a stupid mistake on my side.</p>",
        "id": 202218673,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593317378
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> <code>psum</code> is better. I didn't know about it.</p>",
        "id": 202218715,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1593317437
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/issues/3210\">#3210</a></p>",
        "id": 202234291,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1593346639
    }
]