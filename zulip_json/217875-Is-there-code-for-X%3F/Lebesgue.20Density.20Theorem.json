[
    {
        "content": "<p>Jason, Bhavik and I are proving that order-connected sets are measurable. For this we need the Lebesgue Density Theorem. Is it somewhere in mathlib?</p>",
        "id": 290112070,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1658243021
    },
    {
        "content": "<p>Ahah! It looks like it is <a href=\"https://leanprover-community.github.io/mathlib_docs/find/vitali_family.ae_tendsto_measure_inter_div_of_measurable_set\">docs#vitali_family.ae_tendsto_measure_inter_div_of_measurable_set</a></p>",
        "id": 290112252,
        "sender_full_name": "YaÃ«l Dillies",
        "timestamp": 1658243076
    },
    {
        "content": "<p>Also Yael found out we also have <a href=\"https://leanprover-community.github.io/mathlib_docs/find/set.ord_connected.measurable_set\">docs#set.ord_connected.measurable_set</a> already!</p>",
        "id": 290119526,
        "sender_full_name": "Jason KY.",
        "timestamp": 1658245899
    },
    {
        "content": "<p>I need a version of the Lebesgue Density Theorem with a sequence of balls whose centres are not fixed.</p>\n<p>A month or so ago I cobbled together the following which is sufficient for my purposes (in my application <code>Î±</code> is just the circle):</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">measure_theory.covering.vitali</span>\n<span class=\"kn\">import</span> <span class=\"n\">measure_theory.covering.differentiation</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">set</span> <span class=\"n\">filter</span> <span class=\"n\">function</span> <span class=\"n\">metric</span> <span class=\"n\">measure_theory</span> <span class=\"n\">measure_theory.measure_space</span>\n<span class=\"n\">open_locale</span> <span class=\"n\">nnreal</span> <span class=\"n\">ennreal</span> <span class=\"n\">topological_space</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">Î±</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">measurable_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">Î¼</span> <span class=\"o\">:</span> <span class=\"n\">measure</span> <span class=\"n\">Î±</span><span class=\"o\">)</span>\n<span class=\"kd\">variables</span> <span class=\"o\">[</span><span class=\"n\">metric_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">proper_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">borel_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">is_locally_finite_measure</span> <span class=\"n\">Î¼</span><span class=\"o\">]</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">closed_ball.ae_tendsto_measure_inter_div</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span> <span class=\"bp\">â†’</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hfd</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">),</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"k\">in</span> <span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"bp\">*</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">t</span><span class=\"bp\">^</span><span class=\"n\">d</span> <span class=\"bp\">*</span> <span class=\"n\">f</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hfÎ¼</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"k\">in</span> <span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"n\">x</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">Î±</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">âˆ€áµ</span> <span class=\"n\">x</span> <span class=\"bp\">âˆ‚</span><span class=\"n\">Î¼.restrict</span> <span class=\"n\">S</span><span class=\"o\">,</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"o\">:</span> <span class=\"n\">â„•</span> <span class=\"bp\">â†’</span> <span class=\"n\">Î±</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"o\">:</span> <span class=\"n\">â„•</span> <span class=\"bp\">â†’</span> <span class=\"n\">â„</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚€</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"n\">Î´</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">))</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚‚</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)),</span>\n    <span class=\"n\">tendsto</span> <span class=\"o\">(</span><span class=\"bp\">Î»</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"bp\">âˆ©</span> <span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">))</span> <span class=\"bp\">/</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)))</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"bp\">ğ“</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"gr\">sorry</span> <span class=\"c1\">-- I have a (horrible) proof of this.</span>\n</code></pre></div>\n<p>but I would like to get the statement set down in the appropriate generality and I am not happy with the above.</p>\n<p>At first I thought that the assumptions of <a href=\"https://leanprover-community.github.io/mathlib_docs/find/besicovitch.ae_tendsto_measure_inter_div\">docs#besicovitch.ae_tendsto_measure_inter_div</a> might be sufficient but now I am not so sure. I know nothing of Besicovitch theory!</p>\n<p>Can some measure theorist point me in the right direction?</p>",
        "id": 299026311,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1663265967
    },
    {
        "content": "<p>The right assumption is probably to assume that the ratio of measures <code>mu (B(x, 2 r)) / mu (B (x, r))</code> is uniformly bounded. (More precisely, it is enough to assume that there exists C such that, for all <code>x</code>, for all small enough <code>r</code>, then <code>mu (B(x, 2r)) â‰¤ C * mu (B(x, r))</code>).</p>\n<p>I don't know how your proof looks, but to me it looks like all the math is already in <code>ae_tendsto_measure_inter_div</code>, and that you just need a little bit of glue to apply it in your context. Here is a possible skeleton:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">measure_theory.covering.vitali</span>\n<span class=\"kn\">import</span> <span class=\"n\">measure_theory.covering.differentiation</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">set</span> <span class=\"n\">filter</span> <span class=\"n\">function</span> <span class=\"n\">metric</span> <span class=\"n\">measure_theory</span> <span class=\"n\">measure_theory.measure_space</span>\n<span class=\"n\">open_locale</span> <span class=\"n\">nnreal</span> <span class=\"n\">ennreal</span> <span class=\"n\">topological_space</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">Î±</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">measurable_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">{</span><span class=\"n\">Î¼</span> <span class=\"o\">:</span> <span class=\"n\">measure</span> <span class=\"n\">Î±</span><span class=\"o\">}</span>\n<span class=\"kd\">variables</span> <span class=\"o\">[</span><span class=\"n\">metric_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">proper_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">borel_space</span> <span class=\"n\">Î±</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">is_locally_finite_measure</span> <span class=\"n\">Î¼</span><span class=\"o\">]</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">vitali_family.tendsto_filter_at</span> <span class=\"o\">(</span><span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"n\">vitali_family</span> <span class=\"n\">Î¼</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">Î²</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">l</span> <span class=\"o\">:</span> <span class=\"n\">filter</span> <span class=\"n\">Î²</span><span class=\"o\">}</span>\n  <span class=\"o\">{</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">Î²</span> <span class=\"bp\">â†’</span> <span class=\"n\">set</span> <span class=\"n\">Î±</span><span class=\"o\">}</span> <span class=\"o\">{</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">Î±</span><span class=\"o\">}</span>\n  <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">l</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">v.sets_at</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H'</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"bp\">&gt;</span> <span class=\"o\">(</span><span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"o\">)),</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">l</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span> <span class=\"bp\">âŠ†</span> <span class=\"n\">closed_ball</span> <span class=\"n\">x</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"n\">tendsto</span> <span class=\"n\">f</span> <span class=\"n\">l</span> <span class=\"o\">(</span><span class=\"n\">v.filter_at</span> <span class=\"n\">x</span><span class=\"o\">)</span>  <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"k\">assume</span> <span class=\"n\">s</span> <span class=\"n\">hs</span><span class=\"o\">,</span>\n  <span class=\"n\">change</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"n\">i</span> <span class=\"k\">in</span> <span class=\"n\">l</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"n\">i</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">s</span><span class=\"o\">,</span>\n  <span class=\"n\">obtain</span> <span class=\"o\">âŸ¨</span><span class=\"n\">Îµ</span><span class=\"o\">,</span> <span class=\"n\">Îµpos</span><span class=\"o\">,</span> <span class=\"n\">hÎµ</span><span class=\"o\">âŸ©</span> <span class=\"o\">:</span> <span class=\"bp\">âˆƒ</span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"n\">Îµ</span> <span class=\"bp\">&gt;</span> <span class=\"mi\">0</span><span class=\"o\">),</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">Î±</span><span class=\"o\">),</span>\n    <span class=\"n\">a</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">v.sets_at</span> <span class=\"n\">x</span> <span class=\"bp\">â†’</span> <span class=\"n\">a</span> <span class=\"bp\">âŠ†</span> <span class=\"n\">closed_ball</span> <span class=\"n\">x</span> <span class=\"n\">Îµ</span> <span class=\"bp\">â†’</span> <span class=\"n\">a</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">s</span> <span class=\"o\">:=</span>\n      <span class=\"o\">(</span><span class=\"n\">vitali_family.mem_filter_at_iff</span> <span class=\"n\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">hs</span><span class=\"o\">,</span>\n  <span class=\"n\">filter_upwards</span> <span class=\"o\">[</span><span class=\"n\">H</span><span class=\"o\">,</span> <span class=\"n\">H'</span> <span class=\"n\">Îµ</span> <span class=\"n\">Îµpos</span><span class=\"o\">]</span> <span class=\"k\">with</span> <span class=\"n\">i</span> <span class=\"n\">hi</span> <span class=\"n\">h'i</span> <span class=\"n\">using</span> <span class=\"n\">hÎµ</span> <span class=\"n\">_</span> <span class=\"n\">hi</span> <span class=\"n\">h'i</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">closed_ball.ae_tendsto_measure_inter_div</span>\n  <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span> <span class=\"bp\">â†’</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hfd</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">),</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"k\">in</span> <span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">f</span> <span class=\"o\">(</span><span class=\"n\">t</span> <span class=\"bp\">*</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">t</span><span class=\"bp\">^</span><span class=\"n\">d</span> <span class=\"bp\">*</span> <span class=\"n\">f</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">hfÎ¼</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€á¶ </span> <span class=\"o\">(</span><span class=\"n\">Îµ</span> <span class=\"o\">:</span> <span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"o\">)</span> <span class=\"k\">in</span> <span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">x</span><span class=\"o\">,</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"n\">x</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">f</span> <span class=\"n\">Îµ</span><span class=\"o\">)</span>\n  <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">Î±</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"bp\">âˆ€áµ</span> <span class=\"n\">x</span> <span class=\"bp\">âˆ‚</span><span class=\"n\">Î¼.restrict</span> <span class=\"n\">S</span><span class=\"o\">,</span> <span class=\"bp\">âˆ€</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"o\">:</span> <span class=\"n\">â„•</span> <span class=\"bp\">â†’</span> <span class=\"n\">Î±</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"o\">:</span> <span class=\"n\">â„•</span> <span class=\"bp\">â†’</span> <span class=\"n\">â„</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚€</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"n\">Î´</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"bp\">ğ“</span> <span class=\"mi\">0</span><span class=\"o\">))</span>\n    <span class=\"o\">(</span><span class=\"n\">hÎ´â‚‚</span> <span class=\"o\">:</span> <span class=\"bp\">âˆ€</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"n\">x</span> <span class=\"bp\">âˆˆ</span> <span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)),</span>\n    <span class=\"n\">tendsto</span> <span class=\"o\">(</span><span class=\"bp\">Î»</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">S</span> <span class=\"bp\">âˆ©</span> <span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">))</span> <span class=\"bp\">/</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">)))</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"bp\">ğ“</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">v</span> <span class=\"o\">:</span> <span class=\"n\">vitali_family</span> <span class=\"n\">Î¼</span> <span class=\"o\">:=</span> <span class=\"n\">vitali.vitali_family</span> <span class=\"n\">Î¼</span> <span class=\"o\">(</span><span class=\"mi\">6</span><span class=\"bp\">^</span><span class=\"n\">d</span><span class=\"o\">)</span> <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n  <span class=\"n\">filter_upwards</span> <span class=\"o\">[</span><span class=\"n\">v.ae_tendsto_measure_inter_div</span> <span class=\"n\">S</span><span class=\"o\">]</span> <span class=\"k\">with</span> <span class=\"n\">x</span> <span class=\"n\">hx</span><span class=\"o\">,</span>\n  <span class=\"k\">assume</span> <span class=\"n\">w</span> <span class=\"n\">Î´</span> <span class=\"n\">Î´pos</span> <span class=\"n\">Î´lim</span> <span class=\"n\">xmem</span><span class=\"o\">,</span>\n  <span class=\"k\">have</span> <span class=\"o\">:</span> <span class=\"n\">tendsto</span> <span class=\"o\">(</span><span class=\"bp\">Î»</span> <span class=\"n\">j</span><span class=\"o\">,</span> <span class=\"n\">closed_ball</span> <span class=\"o\">(</span><span class=\"n\">w</span> <span class=\"n\">j</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">Î´</span> <span class=\"n\">j</span><span class=\"o\">))</span> <span class=\"n\">at_top</span> <span class=\"o\">(</span><span class=\"n\">v.filter_at</span> <span class=\"n\">x</span><span class=\"o\">),</span>\n  <span class=\"o\">{</span> <span class=\"n\">apply</span> <span class=\"n\">v.tendsto_filter_at</span><span class=\"o\">,</span>\n    <span class=\"o\">{</span> <span class=\"n\">simp</span> <span class=\"n\">only</span> <span class=\"o\">[</span><span class=\"n\">v</span><span class=\"o\">,</span> <span class=\"n\">vitali.vitali_family</span><span class=\"o\">,</span> <span class=\"n\">mem_set_of_eq</span><span class=\"o\">,</span> <span class=\"n\">mem_closed_ball</span><span class=\"o\">],</span>\n      <span class=\"gr\">sorry</span> <span class=\"o\">},</span>\n    <span class=\"o\">{</span> <span class=\"gr\">sorry</span> <span class=\"o\">}</span> <span class=\"o\">},</span>\n  <span class=\"n\">exact</span> <span class=\"n\">hx.comp</span> <span class=\"n\">this</span><span class=\"o\">,</span>\n<span class=\"kd\">end</span>\n</code></pre></div>\n<p>(the lemma <code>vitali_family.tendsto_filter_at</code> is clearly missing in the current API, and it should probably be formulated as an iff).</p>",
        "id": 299102046,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1663311529
    },
    {
        "content": "<p>Thank you very much <span class=\"user-mention\" data-user-id=\"110050\">@Sebastien Gouezel</span> If I'm lucky I'll have time to take this up this afternoon (but it might not be till next week). I'll report back when I do!</p>",
        "id": 299112824,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1663316573
    },
    {
        "content": "<p>I have <em>finally</em> returned to this and created a PR: <a href=\"https://github.com/leanprover-community/mathlib/pull/16762\">#16762</a></p>",
        "id": 301945851,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1664723776
    }
]