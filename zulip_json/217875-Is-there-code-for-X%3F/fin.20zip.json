[
    {
        "content": "<p>Does something like this already exist in mathlib that I did not see?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">fin_zip</span>\n    <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n    <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n    <span class=\"o\">(</span><span class=\"n\">σ</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">Π</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"o\">:=</span> <span class=\"n\">σ</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"n\">xs</span> <span class=\"n\">ys</span> <span class=\"o\">:=</span>\n    <span class=\"n\">function.update</span>\n        <span class=\"o\">(</span><span class=\"n\">fin_zip</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">xs</span> <span class=\"n\">i</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">ys</span> <span class=\"n\">i</span><span class=\"o\">)))</span>\n        <span class=\"o\">(</span><span class=\"n\">xs</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">ys</span> <span class=\"n\">n</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 299687209,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663652931
    },
    {
        "content": "<p>I'd guess not.</p>",
        "id": 299691253,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1663655809
    },
    {
        "content": "<p>It's supposed to be a <code>function.update</code> at a finite number of points. Is there a simpler way to define it?</p>",
        "id": 299693091,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663657001
    },
    {
        "content": "<p>The pair of tuples seems an inconvenient way to provide the data. Why not just a <code>list (\\a \\times \\b)</code>? (Which you would then <code>fold</code> over.)</p>",
        "id": 299693461,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1663657193
    },
    {
        "content": "<p>Yeah, that might work. I assumed I needed tuples because I needed them in other places in the project, but they might not be necessary here.</p>",
        "id": 299694313,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663657638
    },
    {
        "content": "<p>Like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">function.update_list</span>\n    <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n    <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n    <span class=\"o\">(</span><span class=\"n\">σ</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">pairs</span> <span class=\"o\">:</span> <span class=\"n\">list</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">×</span> <span class=\"n\">β</span><span class=\"o\">))</span> <span class=\"o\">:</span>\n    <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n    <span class=\"n\">list.foldl</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">σ'</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">p</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">×</span> <span class=\"n\">β</span><span class=\"o\">),</span> <span class=\"n\">function.update</span> <span class=\"n\">σ'</span> <span class=\"n\">p.fst</span> <span class=\"n\">p.snd</span><span class=\"o\">)</span> <span class=\"n\">σ</span> <span class=\"n\">pairs</span>\n\n<span class=\"k\">#eval</span> <span class=\"o\">(</span><span class=\"n\">function.update_list</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">[(</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"mi\">1</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"mi\">10</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"mi\">2</span><span class=\"o\">)])</span> <span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 299700082,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663660479
    },
    {
        "content": "<p>I think I still need one that takes tuples after all though.</p>",
        "id": 299700361,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663660623
    },
    {
        "content": "<p>You can call that function with <a href=\"https://leanprover-community.github.io/mathlib_docs/find/list.of_fn\">docs#list.of_fn</a> if you have two tuples</p>",
        "id": 299701184,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1663661023
    },
    {
        "content": "<p>Yeah, I guess. I was trying to make it as direct as possible because I need to deal with it in proofs.</p>",
        "id": 299702667,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663661675
    },
    {
        "content": "<p>I might do that though. Thank you.</p>",
        "id": 299702977,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663661809
    },
    {
        "content": "<p>Is there a good way to deal with the coercions here?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">function.update_fin</span>\n    <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n    <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n    <span class=\"o\">(</span><span class=\"n\">σ</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n    <span class=\"bp\">Π</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n<span class=\"bp\">|</span> <span class=\"mi\">0</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"o\">:=</span> <span class=\"n\">σ</span>\n<span class=\"bp\">|</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"n\">f</span> <span class=\"n\">g</span> <span class=\"o\">:=</span>\n    <span class=\"n\">function.update</span>\n        <span class=\"o\">(</span><span class=\"n\">function.update_fin</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"n\">i</span><span class=\"o\">)))</span>\n        <span class=\"o\">(</span><span class=\"n\">f</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">g</span> <span class=\"n\">n</span><span class=\"o\">)</span>\n\n<span class=\"k\">#eval</span> <span class=\"n\">function.update_fin</span> <span class=\"o\">(</span><span class=\"k\">fun</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">),</span> <span class=\"n\">n</span><span class=\"o\">)</span> <span class=\"mi\">3</span> <span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"mi\">5</span><span class=\"o\">,</span> <span class=\"mi\">0</span><span class=\"o\">]</span> <span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"mi\">10</span><span class=\"o\">,</span> <span class=\"mi\">8</span><span class=\"o\">,</span> <span class=\"mi\">5</span><span class=\"o\">]</span> <span class=\"mi\">0</span>\n\n\n<span class=\"kd\">example</span>\n    <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"n\">β</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"o\">}</span>\n    <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n    <span class=\"o\">(</span><span class=\"n\">σ</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">ℕ</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">xs</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">nodup</span> <span class=\"o\">:</span> <span class=\"n\">function.injective</span> <span class=\"n\">xs</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">ys</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span> <span class=\"bp\">→</span> <span class=\"n\">β</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n</span><span class=\"o\">)</span>\n    <span class=\"o\">(</span><span class=\"n\">h1</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"n\">xs</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n    <span class=\"n\">function.update_fin</span> <span class=\"n\">σ</span> <span class=\"n\">n</span> <span class=\"n\">xs</span> <span class=\"n\">ys</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"n\">ys</span> <span class=\"n\">i</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n    <span class=\"n\">induction</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n    <span class=\"n\">case</span> <span class=\"n\">nat.zero</span>\n  <span class=\"o\">{</span> <span class=\"gr\">admit</span> <span class=\"o\">},</span>\n  <span class=\"n\">case</span> <span class=\"n\">nat.succ</span> <span class=\"o\">:</span> <span class=\"n\">n</span> <span class=\"n\">ih</span>\n  <span class=\"o\">{</span>\n        <span class=\"n\">unfold</span> <span class=\"n\">function.update_fin</span><span class=\"o\">,</span>\n        <span class=\"n\">by_cases</span> <span class=\"n\">i</span> <span class=\"bp\">=</span> <span class=\"n\">n</span><span class=\"o\">,</span>\n        <span class=\"o\">{</span>\n            <span class=\"n\">subst</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">rewrite</span> <span class=\"n\">h1</span><span class=\"o\">,</span> <span class=\"n\">apply</span> <span class=\"n\">function.update_same</span>\n        <span class=\"o\">},</span>\n        <span class=\"o\">{</span>\n            <span class=\"k\">have</span> <span class=\"n\">s1</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">≠</span> <span class=\"n\">xs</span> <span class=\"bp\">↑</span><span class=\"n\">n</span><span class=\"o\">,</span> <span class=\"n\">intro</span> <span class=\"n\">contra</span><span class=\"o\">,</span> <span class=\"n\">apply</span> <span class=\"n\">h</span><span class=\"o\">,</span> <span class=\"n\">rewrite</span> <span class=\"n\">h1</span> <span class=\"n\">at</span> <span class=\"n\">contra</span><span class=\"o\">,</span>\n            <span class=\"n\">unfold</span> <span class=\"n\">function.injective</span> <span class=\"n\">at</span> <span class=\"n\">nodup</span><span class=\"o\">,</span> <span class=\"n\">exact</span> <span class=\"n\">nodup</span> <span class=\"n\">contra</span><span class=\"o\">,</span>\n            <span class=\"n\">rewrite</span> <span class=\"n\">function.update_noteq</span> <span class=\"n\">s1</span><span class=\"o\">,</span>\n            <span class=\"n\">specialize</span> <span class=\"n\">ih</span> <span class=\"o\">(</span><span class=\"n\">fin.init</span> <span class=\"n\">xs</span><span class=\"o\">),</span>\n\n            <span class=\"k\">have</span> <span class=\"n\">s2</span> <span class=\"o\">:</span> <span class=\"bp\">∀</span> <span class=\"o\">(</span><span class=\"n\">i</span> <span class=\"o\">:</span> <span class=\"n\">fin</span> <span class=\"n\">n.succ</span><span class=\"o\">),</span> <span class=\"n\">function.injective</span> <span class=\"o\">(</span><span class=\"n\">fin.init</span> <span class=\"n\">xs</span><span class=\"o\">),</span> <span class=\"n\">intros</span> <span class=\"n\">i'</span><span class=\"o\">,</span>\n            <span class=\"n\">unfold</span> <span class=\"n\">function.injective</span> <span class=\"n\">at</span> <span class=\"n\">nodup</span><span class=\"o\">,</span> <span class=\"n\">unfold</span> <span class=\"n\">function.injective</span><span class=\"o\">,</span> <span class=\"n\">unfold</span> <span class=\"n\">fin.init</span><span class=\"o\">,</span>\n            <span class=\"gr\">sorry</span><span class=\"o\">,</span>\n\n            <span class=\"n\">specialize</span> <span class=\"n\">ih</span> <span class=\"o\">(</span><span class=\"n\">s2</span> <span class=\"n\">i</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">fin.init</span> <span class=\"n\">ys</span><span class=\"o\">),</span>\n            <span class=\"n\">cases</span> <span class=\"n\">i</span><span class=\"o\">,</span>\n            <span class=\"gr\">sorry</span>\n        <span class=\"o\">}</span>\n    <span class=\"o\">},</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 300067125,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663813703
    },
    {
        "content": "<p>Is there a way to use the fact that <code>i : fin n.succ != n</code> to get <code>i : fin n</code>?</p>",
        "id": 300067328,
        "sender_full_name": "Patrick Thomas",
        "timestamp": 1663813920
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 300077743,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1663823354
    }
]