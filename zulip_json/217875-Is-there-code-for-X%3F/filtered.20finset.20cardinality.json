[
    {
        "content": "<p>Wasn't sure how to use properties of cardinality and/or finsets to show that the number of 2d indices from some finite grid satisfying some condition is equal to the sum over all rows in the grid of the number of elements satisfying the condition in the row. Am I unaware of some super-helpful lemma?</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">data.finset.basic</span>\n<span class=\"kn\">import</span> <span class=\"n\">tactic.linarith</span>\n<span class=\"kn\">import</span> <span class=\"n\">data.matrix.basic</span>\n\n<span class=\"n\">open_locale</span> <span class=\"n\">classical</span>\n<span class=\"kd\">noncomputable theory</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"n\">N</span><span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">flatInds</span> <span class=\"o\">:</span> <span class=\"n\">finset</span> <span class=\"n\">N</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">boxInds</span> <span class=\"o\">:</span> <span class=\"n\">finset</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"bp\">×</span> <span class=\"n\">N</span><span class=\"o\">))</span> <span class=\"o\">(</span><span class=\"n\">filter_func</span> <span class=\"o\">:</span> <span class=\"n\">M</span> <span class=\"bp\">→</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"bp\">×</span> <span class=\"n\">N</span><span class=\"o\">)</span> <span class=\"bp\">→</span> <span class=\"kt\">Prop</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">boxInds</span> <span class=\"o\">:=</span> <span class=\"n\">finset.product</span> <span class=\"n\">flatInds</span> <span class=\"n\">flatInds</span>\n\n<span class=\"kd\">lemma</span> <span class=\"n\">split_card</span> <span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"n\">M</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"o\">(</span><span class=\"n\">finset.filter</span> <span class=\"o\">(</span><span class=\"n\">filter_func</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"n\">boxInds</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">card</span> <span class=\"bp\">=</span>\n    <span class=\"n\">flatInds.sum</span> <span class=\"o\">(</span>\n      <span class=\"bp\">λ</span> <span class=\"o\">(</span><span class=\"n\">row</span> <span class=\"o\">:</span> <span class=\"n\">N</span><span class=\"o\">),</span> <span class=\"o\">(</span><span class=\"n\">finset.filter</span> <span class=\"o\">(</span><span class=\"n\">filter_func</span> <span class=\"n\">x</span><span class=\"o\">)</span> <span class=\"o\">([</span><span class=\"n\">row</span><span class=\"o\">]</span><span class=\"bp\">.</span><span class=\"n\">to_finset.product</span> <span class=\"n\">flatInds</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">card</span>\n    <span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"gr\">sorry</span>\n<span class=\"kd\">end</span>\n</code></pre></div>",
        "id": 265857869,
        "sender_full_name": "Evan Lohn",
        "timestamp": 1640210240
    },
    {
        "content": "<p>This is tricky without knowing your way around the library!</p>",
        "id": 265858036,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1640210320
    },
    {
        "content": "<p>You're writing the RHS in a weird way. It's better to use <code>flatInds.image (λ column, (row, column))</code>. Then you should be able to get it using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/finset.product_eq_bUnion\">docs#finset.product_eq_bUnion</a>, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/finset.filter_bUnion\">docs#finset.filter_bUnion</a>, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/finset.card_bUnion\">docs#finset.card_bUnion</a>.</p>",
        "id": 265858518,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1640210552
    }
]