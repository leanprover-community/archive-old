[
    {
        "content": "<p>Do we have a theorem that says that the closest point on a line $L$ to a point $P$ not on it is obtained by dropping a perpendicular from the point $P$ to $L$?</p>",
        "id": 290034595,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658185533
    },
    {
        "content": "<p>Isn't that Hilbert's projection theorem?</p>",
        "id": 290039985,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1658190179
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290039985\">said</a>:</p>\n<blockquote>\n<p>Isn't that Hilbert's projection theorem?</p>\n</blockquote>\n<p>is this in mathlib?</p>",
        "id": 290040276,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658190441
    },
    {
        "content": "<p>Not yet</p>",
        "id": 290040502,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1658190683
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 290040707,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658190908
    },
    {
        "content": "<p>I'm reading the wiki page for Hilbert's projection theorem ... I think this result provides a characterization of the closest point is not a direct corollary of it.</p>",
        "id": 290040884,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658191119
    },
    {
        "content": "<p>I accidentally ended up proving this while doing some linear programming stuff only to realize later that it might've already been in mathlib. Here's my code so far: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">analysis.convex.cone</span>\n<span class=\"kd\">noncomputable theory</span>\n\n<span class=\"kd\">variables</span> <span class=\"o\">{</span><span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">[</span><span class=\"n\">inner_product_space</span> <span class=\"n\">ℝ</span> <span class=\"n\">H</span><span class=\"o\">]</span>\n\n<span class=\"kn\">section</span> <span class=\"n\">closed_convex_cone</span>\n\n<span class=\"c1\">-- Reference: https://ti.inf.ethz.ch/ew/lehre/ApproxSDP09/notes/conelp.pdf</span>\n\n<span class=\"sd\">/-- Given a closed convex cone K and a point b not in K, if z is the point in K closest to b then</span>\n<span class=\"sd\">z - b is perpendicular to z. -/</span>\n<span class=\"kd\">theorem</span> <span class=\"n\">closest_point_perp</span>\n  <span class=\"o\">{</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">convex_cone</span> <span class=\"n\">ℝ</span> <span class=\"n\">H</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">hK</span> <span class=\"o\">:</span> <span class=\"n\">is_closed</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">))</span>\n  <span class=\"o\">{</span><span class=\"n\">b</span> <span class=\"o\">:</span> <span class=\"n\">H</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">disj</span> <span class=\"o\">:</span> <span class=\"n\">b</span> <span class=\"bp\">∉</span> <span class=\"n\">K</span><span class=\"o\">)</span>\n  <span class=\"o\">{</span><span class=\"n\">z</span> <span class=\"o\">:</span> <span class=\"n\">H</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">hzK</span> <span class=\"o\">:</span> <span class=\"n\">z</span> <span class=\"bp\">∈</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">))</span>\n  <span class=\"o\">(</span><span class=\"n\">h_inf</span> <span class=\"o\">:</span> <span class=\"n\">metric.inf_dist</span> <span class=\"n\">b</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"bp\">⟪</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span>\n<span class=\"kd\">begin</span>\n  <span class=\"k\">let</span> <span class=\"n\">y</span> <span class=\"o\">:=</span> <span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">b</span><span class=\"o\">,</span>\n  <span class=\"n\">by_cases</span> <span class=\"n\">hz</span> <span class=\"o\">:</span> <span class=\"n\">z</span> <span class=\"bp\">=</span> <span class=\"mi\">0</span><span class=\"o\">,</span>\n  <span class=\"o\">{</span> <span class=\"c1\">-- If z is zero, we're done.</span>\n    <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">hz</span><span class=\"o\">,</span> <span class=\"n\">inner_zero_right</span><span class=\"o\">]</span> <span class=\"o\">},</span>\n  <span class=\"kd\">begin</span>\n    <span class=\"c1\">-- In the case z ≠ 0, we provide a proof by contradiction. The proof strategy is to show that</span>\n    <span class=\"c1\">-- for a sufficiently small constant α, point z' = (1 - α) • z lies in K and is closer to b than</span>\n    <span class=\"c1\">-- z, thereby contradicting h_inf.</span>\n    <span class=\"n\">by_contra'</span> <span class=\"n\">hyz</span><span class=\"o\">,</span>\n\n    <span class=\"c1\">-- We will pick a different scaling factor depending on the sign of ⟪y, z⟫_ℝ.</span>\n    <span class=\"n\">obtain</span> <span class=\"o\">(</span><span class=\"n\">hyz_neg</span> <span class=\"bp\">|</span> <span class=\"n\">hyz_pos</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">ne.lt_or_lt</span> <span class=\"n\">hyz</span><span class=\"o\">,</span> <span class=\"n\">clear</span> <span class=\"n\">hyz</span><span class=\"o\">,</span>\n\n    <span class=\"c1\">-- Case 1: ⟪y, z⟫_ℝ &lt; 0.</span>\n    <span class=\"k\">let</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">hα</span> <span class=\"o\">:</span> <span class=\"n\">α</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">0</span> <span class=\"o\">:=</span>\n      <span class=\"n\">linarith.mul_neg</span> <span class=\"n\">hyz_neg</span> <span class=\"o\">(</span><span class=\"n\">inv_pos.2</span> <span class=\"o\">(</span><span class=\"n\">sq_pos_of_ne_zero</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">norm_ne_zero_iff.2</span> <span class=\"n\">hz</span><span class=\"o\">))),</span>\n    <span class=\"c1\">-- Scale z by (1 - α) to obtain z'.</span>\n    <span class=\"k\">let</span> <span class=\"n\">z'</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">-</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- Show that z' is in K.</span>\n    <span class=\"k\">have</span> <span class=\"n\">hz'</span> <span class=\"o\">:</span> <span class=\"n\">z'</span> <span class=\"bp\">∈</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">K.smul_mem</span> <span class=\"o\">(</span><span class=\"n\">sub_pos.2</span> <span class=\"o\">(</span><span class=\"n\">lt_trans</span> <span class=\"n\">hα</span> <span class=\"n\">zero_lt_one</span><span class=\"o\">))</span> <span class=\"n\">hzK</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- Auxiliary lemma for computation of dist b z'.</span>\n    <span class=\"k\">have</span> <span class=\"n\">h_aux</span> <span class=\"o\">:</span> <span class=\"bp\">-</span><span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">-</span> <span class=\"bp\">∥</span><span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"kd\">by</span>\n    <span class=\"kd\">begin</span>\n      <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">real_inner_smul_right</span><span class=\"o\">,</span> <span class=\"n\">norm_smul</span><span class=\"o\">,</span> <span class=\"n\">real.norm_eq_abs</span><span class=\"o\">,</span> <span class=\"n\">abs_of_neg</span> <span class=\"n\">hα</span><span class=\"o\">,</span> <span class=\"n\">neg_mul</span><span class=\"o\">,</span> <span class=\"n\">neg_sq</span><span class=\"o\">],</span>\n      <span class=\"n\">ring_nf</span><span class=\"o\">,</span>\n      <span class=\"n\">refine</span> <span class=\"n\">mul_neg_of_pos_of_neg</span> <span class=\"n\">_</span> <span class=\"n\">hα</span><span class=\"o\">,</span>\n      <span class=\"k\">calc</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"bp\">-</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rwa</span> <span class=\"o\">[</span><span class=\"n\">lt_neg</span><span class=\"o\">,</span> <span class=\"n\">neg_zero</span><span class=\"o\">]</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">norm_num</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"n\">α</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">sub_mul</span><span class=\"o\">,</span> <span class=\"bp\">←</span> <span class=\"n\">mul_assoc</span><span class=\"o\">,</span>\n              <span class=\"n\">mul_inv_cancel</span> <span class=\"o\">(</span><span class=\"n\">ne_of_gt</span> <span class=\"o\">(</span><span class=\"n\">sq_pos_of_ne_zero</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">norm_ne_zero_iff.2</span> <span class=\"n\">hz</span><span class=\"o\">)))]</span>\n    <span class=\"kd\">end</span><span class=\"o\">,</span>\n\n    <span class=\"c1\">-- Case 2: ⟪y, z⟫_ℝ &gt; 0.</span>\n    <span class=\"n\">swap</span> <span class=\"mi\">2</span><span class=\"o\">,</span>\n    <span class=\"k\">let</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">min</span> <span class=\"o\">((</span><span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">)</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"o\">,</span>\n    <span class=\"k\">have</span> <span class=\"n\">hα</span> <span class=\"o\">:</span> <span class=\"mi\">0</span> <span class=\"bp\">&lt;</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n      <span class=\"n\">lt_min_iff.2</span> <span class=\"o\">⟨</span> <span class=\"n\">mul_pos</span> <span class=\"o\">(</span><span class=\"n\">inv_pos.2</span> <span class=\"o\">(</span><span class=\"n\">sq_pos_of_ne_zero</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">norm_ne_zero_iff.2</span> <span class=\"n\">hz</span><span class=\"o\">)))</span> <span class=\"n\">hyz_pos</span><span class=\"o\">,</span>\n        <span class=\"n\">one_half_pos</span> <span class=\"o\">⟩,</span>\n    <span class=\"c1\">-- Scale z by (1 - α) to obtain z'.</span>\n    <span class=\"k\">let</span> <span class=\"n\">z'</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">-</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- Show that z' is in K.</span>\n    <span class=\"k\">have</span> <span class=\"n\">hz'</span> <span class=\"o\">:</span> <span class=\"n\">z'</span> <span class=\"bp\">∈</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">)</span>\n             <span class=\"o\">:=</span> <span class=\"n\">K.smul_mem</span> <span class=\"o\">(</span><span class=\"n\">sub_pos.2</span> <span class=\"o\">(</span><span class=\"n\">min_lt_of_right_lt</span> <span class=\"n\">one_half_lt_one</span><span class=\"o\">))</span> <span class=\"n\">hzK</span><span class=\"o\">,</span>\n    <span class=\"c1\">-- Auxiliary lemma for computation of dist b z'.</span>\n    <span class=\"k\">have</span> <span class=\"n\">h_aux</span> <span class=\"o\">:</span> <span class=\"bp\">-</span><span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">-</span> <span class=\"bp\">∥</span><span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"kd\">by</span>\n    <span class=\"kd\">begin</span>\n      <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">real_inner_smul_right</span><span class=\"o\">,</span> <span class=\"n\">norm_smul</span><span class=\"o\">,</span> <span class=\"n\">real.norm_eq_abs</span><span class=\"o\">,</span> <span class=\"n\">abs_of_pos</span> <span class=\"n\">hα</span><span class=\"o\">],</span>\n      <span class=\"n\">ring_nf</span><span class=\"o\">,</span>\n      <span class=\"n\">refine</span> <span class=\"n\">mul_neg_of_neg_of_pos</span> <span class=\"n\">_</span> <span class=\"n\">hα</span><span class=\"o\">,</span>\n      <span class=\"k\">calc</span> <span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"n\">α</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span>\n          <span class=\"bp\">≤</span> <span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"o\">((</span><span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"o\">{</span>\n          <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">sub_le_sub_iff_right</span><span class=\"o\">,</span> <span class=\"n\">mul_le_mul_left</span> <span class=\"o\">(</span><span class=\"n\">sq_pos_of_ne_zero</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">norm_ne_zero_iff.2</span> <span class=\"n\">hz</span><span class=\"o\">))],</span>\n          <span class=\"n\">exact</span> <span class=\"n\">min_le_left</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"o\">}</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"bp\">∥</span><span class=\"n\">z</span><span class=\"bp\">∥</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">mul_assoc</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"mi\">1</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span>\n          <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">mul_inv_cancel</span> <span class=\"o\">(</span><span class=\"n\">ne_of_gt</span> <span class=\"o\">(</span><span class=\"n\">sq_pos_of_ne_zero</span> <span class=\"n\">_</span> <span class=\"o\">(</span><span class=\"n\">norm_ne_zero_iff.2</span> <span class=\"n\">hz</span><span class=\"o\">)))</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">-</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"o\">{</span> <span class=\"n\">rw</span> <span class=\"bp\">←</span> <span class=\"n\">sub_mul</span><span class=\"o\">,</span> <span class=\"n\">norm_num</span> <span class=\"o\">}</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">&lt;</span> <span class=\"mi\">0</span> <span class=\"o\">:</span> <span class=\"n\">neg_lt_zero.2</span> <span class=\"n\">hyz_pos</span><span class=\"o\">,</span>\n    <span class=\"kd\">end</span><span class=\"o\">,</span>\n\n    <span class=\"c1\">-- In both cases, distance between b and z' is less than the distance between b and z.</span>\n    <span class=\"n\">repeat</span> <span class=\"kd\">begin</span>\n      <span class=\"k\">have</span> <span class=\"n\">hbzz'</span> <span class=\"o\">:</span> <span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z'</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"bp\">&lt;</span> <span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z</span> <span class=\"bp\">^</span> <span class=\"mi\">2</span> <span class=\"o\">:=</span> <span class=\"k\">calc</span> <span class=\"o\">(</span><span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z'</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span>\n          <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"o\">(</span><span class=\"mi\">1</span> <span class=\"bp\">-</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"bp\">•</span> <span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">b</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">dist_eq_norm'</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">b</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">sub_smul</span><span class=\"o\">,</span> <span class=\"n\">one_smul</span><span class=\"o\">]</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"o\">(</span><span class=\"n\">z</span> <span class=\"bp\">-</span> <span class=\"n\">b</span><span class=\"o\">)</span> <span class=\"bp\">-</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">abel</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"n\">y</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"bp\">-</span> <span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">+</span> <span class=\"bp\">∥</span><span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span>\n          <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">simp_rw</span> <span class=\"o\">[</span><span class=\"n\">norm_sq_eq_inner</span><span class=\"o\">,</span> <span class=\"n\">real_inner_sub_sub_self</span><span class=\"o\">,</span> <span class=\"n\">is_R_or_C.re_to_real</span><span class=\"o\">]</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"bp\">∥</span><span class=\"n\">y</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"mi\">2</span> <span class=\"bp\">*</span> <span class=\"bp\">⟪</span><span class=\"n\">y</span><span class=\"o\">,</span> <span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">⟫</span><span class=\"n\">_ℝ</span> <span class=\"bp\">-</span> <span class=\"bp\">∥</span><span class=\"n\">α</span> <span class=\"bp\">•</span> <span class=\"n\">z</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">sub_add</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">&lt;</span> <span class=\"bp\">∥</span><span class=\"n\">y</span><span class=\"bp\">∥^</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"n\">add_lt_iff_neg_left.mpr</span> <span class=\"n\">h_aux</span>\n      <span class=\"bp\">...</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"mi\">2</span> <span class=\"o\">:</span> <span class=\"kd\">by</span> <span class=\"n\">rw</span> <span class=\"n\">dist_eq_norm'</span><span class=\"o\">,</span>\n      <span class=\"k\">have</span> <span class=\"n\">hbz'</span> <span class=\"o\">:</span> <span class=\"n\">metric.inf_dist</span> <span class=\"n\">b</span> <span class=\"o\">(</span><span class=\"n\">K</span> <span class=\"o\">:</span> <span class=\"n\">set</span> <span class=\"n\">H</span><span class=\"o\">)</span> <span class=\"bp\">≤</span> <span class=\"n\">dist</span> <span class=\"n\">b</span> <span class=\"n\">z'</span>\n                <span class=\"o\">:=</span> <span class=\"bp\">@</span><span class=\"n\">metric.inf_dist_le_dist_of_mem</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">b</span> <span class=\"n\">_</span> <span class=\"n\">hz'</span><span class=\"o\">,</span>\n      <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h_inf</span><span class=\"o\">,</span> <span class=\"bp\">←</span> <span class=\"bp\">@</span><span class=\"n\">abs_dist</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">b</span> <span class=\"n\">z</span><span class=\"o\">,</span> <span class=\"bp\">←</span> <span class=\"bp\">@</span><span class=\"n\">abs_dist</span> <span class=\"n\">_</span> <span class=\"n\">_</span> <span class=\"n\">b</span> <span class=\"n\">z'</span><span class=\"o\">,</span> <span class=\"bp\">←</span> <span class=\"n\">sq_le_sq</span><span class=\"o\">]</span> <span class=\"n\">at</span> <span class=\"n\">hbz'</span><span class=\"o\">,</span>\n      <span class=\"n\">exact</span> <span class=\"n\">not_lt_of_le</span> <span class=\"n\">hbz'</span> <span class=\"n\">hbzz'</span><span class=\"o\">,</span>\n    <span class=\"kd\">end</span><span class=\"o\">,</span>\n  <span class=\"kd\">end</span>\n<span class=\"kd\">end</span>\n\n<span class=\"kd\">end</span> <span class=\"n\">closed_convex_cone</span>\n</code></pre></div>",
        "id": 290040992,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658191260
    },
    {
        "content": "<p>This is generalizable away from cones.</p>",
        "id": 290041647,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1658191923
    },
    {
        "content": "<p>I don't think this is true. The wikipedia proof in fact assumes that the convex set is a subspace which is weaker than a convex cone.</p>",
        "id": 290042248,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658192619
    },
    {
        "content": "<p>\"Proof of characterization of minimum point when {\\displaystyle C}C is a closed vector subspace.\"</p>",
        "id": 290042256,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658192636
    },
    {
        "content": "<p>Do you have a reference in mind?</p>",
        "id": 290042313,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658192658
    },
    {
        "content": "<p>Ah for the orthogonality sure.</p>",
        "id": 290043267,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1658193843
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"245078\">@Apurva Nakade</span> It can be much shorter.  You should use <a href=\"https://leanprover-community.github.io/mathlib_docs/find/orthogonal_projection\">docs#orthogonal_projection</a>.</p>",
        "id": 290044936,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1658195874
    },
    {
        "content": "<p>Depending on your needs (if the line doesn't pass through the origin), possibly <a href=\"https://leanprover-community.github.io/mathlib_docs/find/euclidean_geometry.orthogonal_projection\">docs#euclidean_geometry.orthogonal_projection</a></p>",
        "id": 290044994,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1658195945
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260507\">Heather Macbeth</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290044936\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"245078\">Apurva Nakade</span> It can be much shorter.  You should use <a href=\"https://leanprover-community.github.io/mathlib_docs/find/orthogonal_projection\">docs#orthogonal_projection</a>.</p>\n</blockquote>\n<p>Thank you! I'll try to rewrite it using orthogonal projection. I think this version ought to be sufficient. The line does pass through the origin with a  minor twist that we want only positive scalars. But I think it should be manageable.</p>",
        "id": 290049478,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658200865
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Closest.20point.20on.20a.20line.20to.20a.20point.20not.20on.20it/near/290039985\">said</a>:</p>\n<blockquote>\n<p>Isn't that Hilbert's projection theorem?</p>\n</blockquote>\n<p>Is this Hilbert's projection theorem: <a href=\"https://leanprover-community.github.io/mathlib_docs/find/exists_norm_eq_infi_of_complete_convex\">docs#exists_norm_eq_infi_of_complete_convex</a> ?</p>",
        "id": 290049958,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658201389
    },
    {
        "content": "<p>I feel like the doc string should be more descriptive for such an important theorem lol</p>",
        "id": 290050024,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658201451
    },
    {
        "content": "<p>The next theorem is exactly what i've been looking for <a href=\"https://leanprover-community.github.io/mathlib_docs/find/norm_eq_infi_iff_real_inner_eq_zero\">docs#norm_eq_infi_iff_real_inner_eq_zero</a> :O</p>",
        "id": 290050058,
        "sender_full_name": "Apurva Nakade",
        "timestamp": 1658201501
    }
]