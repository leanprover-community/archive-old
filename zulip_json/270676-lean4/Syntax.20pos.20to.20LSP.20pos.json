[
    {
        "content": "<p>Hmm, I am still banging my head against using the <code>EditorApi</code>for what I want to do; mostly about generating <code>insertText()</code>’s third parameter   of type  <code>TextDocumentPositionParams</code>. Currently I am using this code in lean to get my hands on a LSP-compatible position and pass it to JS</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"n\">edit</span> <span class=\"bp\">$</span><span class=\"n\">tm</span><span class=\"o\">)</span> <span class=\"bp\">=&gt;</span> <span class=\"k\">do</span>\n    <span class=\"k\">let</span> <span class=\"n\">s</span> <span class=\"bp\">←</span> <span class=\"k\">match</span> <span class=\"n\">Lean.Syntax.reprint</span> <span class=\"n\">tm</span> <span class=\"k\">with</span>\n      <span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"n\">s</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">pure</span> <span class=\"n\">s</span>\n      <span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">throwUnsupportedSyntax</span>\n    <span class=\"k\">let</span> <span class=\"n\">r</span> <span class=\"bp\">←</span> <span class=\"k\">match</span> <span class=\"n\">Lean.Syntax.getRange</span><span class=\"bp\">?</span> <span class=\"n\">tm</span> <span class=\"k\">with</span>\n      <span class=\"bp\">|</span> <span class=\"n\">some</span> <span class=\"n\">r</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">pure</span> <span class=\"n\">r</span>\n      <span class=\"bp\">|</span> <span class=\"n\">none</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">throwUnsupportedSyntax</span>\n    <span class=\"k\">let</span> <span class=\"n\">fm</span> <span class=\"o\">:=</span> <span class=\"n\">s.toFileMap</span>\n    <span class=\"k\">let</span> <span class=\"n\">lp</span> <span class=\"o\">:=</span> <span class=\"n\">String.Range.toLspRange</span> <span class=\"n\">fm</span> <span class=\"n\">r</span>\n    <span class=\"n\">dbg_trace</span> <span class=\"s2\">\"lp: {toJson lp.start}\"</span>\n    <span class=\"n\">saveWidgetInfo</span> <span class=\"bp\">`</span><span class=\"n\">insertTextWidget</span> <span class=\"o\">(</span><span class=\"n\">Json.mkObj</span> <span class=\"o\">[(</span><span class=\"s2\">\"pos\"</span><span class=\"o\">,</span> <span class=\"n\">toJson</span> <span class=\"n\">lp.start</span><span class=\"o\">)])</span> <span class=\"n\">tm</span>\n</code></pre></div>\n<p>but there are two problems</p>\n<ul>\n<li><code>TextDocumentPositionParams</code> needs a <code>uri</code>. For a while I thought this <code>pos</code> actually included and <code>uri</code> field, but it somehow disappeared later… so not sure about that</li>\n<li>The <code>toLspRange</code> produces <code>{\"line\": 1, \"character\": 1255}</code>, i.e. does not take line counts into account, which is not really correct (i.e. if I manually specify the <code>uri</code> in the JS side of things, it does insert things but in the second column)</li>\n</ul>\n<p>Is there a more principled way to connect lean’s <code>Syntax</code> markers with LSP’s <code>TextDocumentPositionParams</code>?<br>\nOr maybe easier to do it all from lean somehow, once there are functions exposed to the lean world that allow me to edit the text? (Pinging <span class=\"user-mention\" data-user-id=\"121918\">@Edward Ayers</span> again if that's ok)</p>",
        "id": 310623959,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668696553
    },
    {
        "content": "<p>Answering the parts I know about (i.e. nothing about widgets per se):</p>\n<ul>\n<li>The elaborator doesn't know about the document URI, yes. This information only exists in the server data structures. I'm not aware of a way to access it from an elaborator (which generally is oblivious to the potential existence of a server).</li>\n<li>You can however hackishly recover the document contents via</li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>  <span class=\"k\">let</span> <span class=\"bp\">.</span><span class=\"n\">original</span> <span class=\"n\">pre</span> <span class=\"bp\">..</span> <span class=\"o\">:=</span> <span class=\"n\">stx.getHeadInfo</span> <span class=\"bp\">|</span> <span class=\"n\">panic</span><span class=\"bp\">!</span> <span class=\"s2\">\"expected input syntax\"</span>\n  <span class=\"k\">let</span> <span class=\"n\">s</span> <span class=\"o\">:=</span> <span class=\"n\">pre.str</span>\n</code></pre></div>\n<p>This should give you correct output for <code>toLspRange</code> in contrast to <code>reprint</code></p>",
        "id": 310627554,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668697621
    },
    {
        "content": "<p>Doing anything document-related in a server handler would definitely be better, yeah</p>",
        "id": 310627828,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668697716
    },
    {
        "content": "<p>Is “replace a range in the document with a given string” already a kind of “anything” that one can do from the server?</p>",
        "id": 310628122,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668697801
    },
    {
        "content": "<p>Thanks for the code! Indeed now I get the right coordinates.</p>",
        "id": 310628867,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668698031
    },
    {
        "content": "<p>You can do that from the server by making an LSP request to <a href=\"https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#workspace_applyEdit\"><code>workspace/applyEdit</code></a>. The problem is that at the moment there is no api in Lean for making server → client editor requests.</p>",
        "id": 310629406,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668698190
    },
    {
        "content": "<p>So in order to do a text edit from a server you need to muck around piping lsp requests to an IO stream.</p>",
        "id": 310629524,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668698237
    },
    {
        "content": "<p>Also /cc <span class=\"user-mention\" data-user-id=\"110789\">@Jakob von Raumer</span> who just had a student working on that topic (<del>but using client-side edits afair</del>)</p>",
        "id": 310629553,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668698247
    },
    {
        "content": "<p>I feel slightly crazy. I am very certain that with an earlier version of the code, I saw an <code>uri</code> argument in the data that I somehow extracted from the <code>Syntax</code>, but it disappeared.</p>",
        "id": 310630003,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668698401
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121918\">Edward Ayers</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20pos.20to.20LSP.20pos/near/310629524\">said</a>:</p>\n<blockquote>\n<p>So in order to do a text edit from a server you need to muck around piping lsp requests to an IO stream.</p>\n</blockquote>\n<p><code>writeLspRequest</code> should just work from the server side as well, no? The server will crash on receiving unexpected responses from the client, but for a prototype I guess we can just discard them instead...</p>",
        "id": 310630374,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668698512
    },
    {
        "content": "<p>/cc <span class=\"user-mention\" data-user-id=\"497000\">@Robin Böhne</span></p>",
        "id": 310630650,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1668698583
    },
    {
        "content": "<p>This is the code Robin wrote: <a href=\"https://github.com/leanprover/lean4/compare/master...KaseQuark:lean4:master\">https://github.com/leanprover/lean4/compare/master...KaseQuark:lean4:master</a></p>",
        "id": 310630678,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1668698594
    },
    {
        "content": "<p>Is that an interactive <code>conv</code> mode tatic assembler  UI? Neat!</p>\n<p>It looks like that needs a similar infrastructure than what I want to build right now. So if that still needs extra plumbing, maybe I’ll wait for that code to be merged and then build on top of that :-)</p>",
        "id": 310633043,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668698754
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20pos.20to.20LSP.20pos/near/310633043\">said</a>:</p>\n<blockquote>\n<p>Is that an interactive <code>conv</code> mode tatic assembler  UI? Neat!</p>\n</blockquote>\n<p>Yes! It's working perfectly, just needs a bit of clean-up and to be PRed</p>",
        "id": 310634859,
        "sender_full_name": "Jakob von Raumer",
        "timestamp": 1668699047
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121918\">@Edward Ayers</span>  Trying to use [<code>applyEdit</code>](<a href=\"https://github.com/leanprover/vscode-lean4/blob/1edd92230c7630627f18dbe76cd139903a4cbcee/lean4-infoview-api/src/infoviewApi.ts#L55]\">https://github.com/leanprover/vscode-lean4/blob/1edd92230c7630627f18dbe76cd139903a4cbcee/lean4-infoview-api/src/infoviewApi.ts#L55]</a> instead of <code>insertText</code> now, but I get <code>this.methods[i] is not a function</code> with</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">TypeError</span><span class=\"o\">:</span> <span class=\"n\">this.methods</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span> <span class=\"n\">is</span> <span class=\"n\">not</span> <span class=\"n\">a</span> <span class=\"n\">function</span>\n    <span class=\"n\">at</span> <span class=\"n\">t.Rpc.</span><span class=\"bp\">&lt;</span><span class=\"n\">anonymous</span><span class=\"bp\">&gt;</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">497315</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">Generator.next</span> <span class=\"o\">(</span><span class=\"bp\">&lt;</span><span class=\"n\">anonymous</span><span class=\"bp\">&gt;</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">496341</span>\n    <span class=\"n\">at</span> <span class=\"n\">new</span> <span class=\"n\">Promise</span> <span class=\"o\">(</span><span class=\"bp\">&lt;</span><span class=\"n\">anonymous</span><span class=\"bp\">&gt;</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">n</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">496086</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">497222</span>\n    <span class=\"n\">at</span> <span class=\"n\">t.Rpc.messageReceived</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">497382</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/.</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">extensions</span><span class=\"bp\">/</span><span class=\"n\">leanprover.lean4</span><span class=\"bp\">-</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">95</span><span class=\"bp\">/</span><span class=\"n\">dist</span><span class=\"bp\">/</span><span class=\"n\">extension.js</span><span class=\"o\">:</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"mi\">479116</span>\n    <span class=\"n\">at</span> <span class=\"n\">w.invoke</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">145</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">v.deliver</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">2266</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">p.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">1844</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">d.</span><span class=\"bp\">$</span><span class=\"n\">onMessage</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">87</span><span class=\"o\">:</span><span class=\"mi\">186534</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">s._doInvokeHandler</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">95</span><span class=\"o\">:</span><span class=\"mi\">13708</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">s._invokeHandler</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">95</span><span class=\"o\">:</span><span class=\"mi\">13390</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">s._receiveRequest</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">95</span><span class=\"o\">:</span><span class=\"mi\">12159</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">s._receiveOneMessage</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">95</span><span class=\"o\">:</span><span class=\"mi\">11056</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">95</span><span class=\"o\">:</span><span class=\"mi\">8957</span>\n    <span class=\"n\">at</span> <span class=\"n\">w.invoke</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">145</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">v.deliver</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">2266</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">p.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">1844</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">a.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">18976</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">111</span><span class=\"o\">:</span><span class=\"mi\">34679</span>\n    <span class=\"n\">at</span> <span class=\"n\">w.invoke</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">145</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">v.deliver</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">2266</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">p.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">1844</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">a.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">18976</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">r._receiveMessage</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">23563</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">21097</span>\n    <span class=\"n\">at</span> <span class=\"n\">w.invoke</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">145</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">v.deliver</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">2266</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">p.fire</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">61</span><span class=\"o\">:</span><span class=\"mi\">1844</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">p.acceptChunk</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">15807</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">69</span><span class=\"o\">:</span><span class=\"mi\">14937</span>\n    <span class=\"n\">at</span> <span class=\"n\">Socket.R</span> <span class=\"o\">(</span><span class=\"bp\">/</span><span class=\"n\">nix</span><span class=\"bp\">/</span><span class=\"n\">store</span><span class=\"bp\">/</span><span class=\"mi\">8</span><span class=\"n\">ybggqbzhpmj6ax299x7kz9b53861frx</span><span class=\"bp\">-</span><span class=\"n\">vscode</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"bp\">.</span><span class=\"mi\">69</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">resources</span><span class=\"bp\">/</span><span class=\"n\">app</span><span class=\"bp\">/</span><span class=\"n\">out</span><span class=\"bp\">/</span><span class=\"n\">vs</span><span class=\"bp\">/</span><span class=\"n\">workbench</span><span class=\"bp\">/</span><span class=\"n\">api</span><span class=\"bp\">/</span><span class=\"n\">node</span><span class=\"bp\">/</span><span class=\"n\">extensionHostProcess.js</span><span class=\"o\">:</span><span class=\"mi\">111</span><span class=\"o\">:</span><span class=\"mi\">13763</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">Socket.emit</span> <span class=\"o\">(</span><span class=\"n\">node</span><span class=\"o\">:</span><span class=\"n\">events</span><span class=\"o\">:</span><span class=\"mi\">390</span><span class=\"o\">:</span><span class=\"mi\">28</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">addChunk</span> <span class=\"o\">(</span><span class=\"n\">node</span><span class=\"o\">:</span><span class=\"n\">internal</span><span class=\"bp\">/</span><span class=\"n\">streams</span><span class=\"bp\">/</span><span class=\"n\">readable</span><span class=\"o\">:</span><span class=\"mi\">315</span><span class=\"o\">:</span><span class=\"mi\">12</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">readableAddChunk</span> <span class=\"o\">(</span><span class=\"n\">node</span><span class=\"o\">:</span><span class=\"n\">internal</span><span class=\"bp\">/</span><span class=\"n\">streams</span><span class=\"bp\">/</span><span class=\"n\">readable</span><span class=\"o\">:</span><span class=\"mi\">289</span><span class=\"o\">:</span><span class=\"mi\">9</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">Socket.Readable.push</span> <span class=\"o\">(</span><span class=\"n\">node</span><span class=\"o\">:</span><span class=\"n\">internal</span><span class=\"bp\">/</span><span class=\"n\">streams</span><span class=\"bp\">/</span><span class=\"n\">readable</span><span class=\"o\">:</span><span class=\"mi\">228</span><span class=\"o\">:</span><span class=\"mi\">10</span><span class=\"o\">)</span>\n    <span class=\"n\">at</span> <span class=\"n\">Pipe.onStreamRead</span> <span class=\"o\">(</span><span class=\"n\">node</span><span class=\"o\">:</span><span class=\"n\">internal</span><span class=\"bp\">/</span><span class=\"n\">stream_base_commons</span><span class=\"o\">:</span><span class=\"mi\">199</span><span class=\"o\">:</span><span class=\"mi\">23</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>so does this mean that this function isn’t fully implemented yet, or am I doing something stupid?</p>",
        "id": 310642955,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668701357
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> could you by any chance share your widget code?</p>",
        "id": 310643257,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668701450
    },
    {
        "content": "<p>Let me create a repo…</p>",
        "id": 310643427,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668701508
    },
    {
        "content": "<p><a href=\"https://github.com/nomeata/lean4-interactive-tactic\">https://github.com/nomeata/lean4-interactive-tactic</a></p>",
        "id": 310643774,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668701588
    },
    {
        "content": "<p>The URL to the edited file is hardcoded in the <code>.ts</code> code :-)</p>",
        "id": 310643946,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668701634
    },
    {
        "content": "<p>Give me a few minutes, i will try to reproduce the error</p>",
        "id": 310644236,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668701709
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/1846\">https://github.com/leanprover/lean4/pull/1846</a></p>",
        "id": 310645726,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668702151
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20pos.20to.20LSP.20pos/near/310643774\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/nomeata/lean4-interactive-tactic\">https://github.com/nomeata/lean4-interactive-tactic</a></p>\n</blockquote>\n<p>(The pushed version might be missing <code>rollup.config.js</code>)</p>",
        "id": 310650402,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668703487
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> aha, I see what happened. Your link to <code>applyEdit</code> is for the current master branch of the infoview api, but it had not been published yet. If you look at the <code>.d.ts</code> that TypeScript gives you for <code>EditorApi</code>, that function is not there. We will need to make a new API release very soon, which will include this.</p>",
        "id": 310651272,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668703763
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span> okay, while the <code>applyEdit</code> interface not-yet-having-been-published does result in type errors, secretly you <em>can</em> still use it because the <code>vscode-lean4</code> already includes the new code. The reason for that error was not a missing interface, it was a type error in your <code>changes</code> code :) Here is a version that works for me:</p>\n<div class=\"codehilite\" data-code-language=\"TypeScript\"><pre><span></span><code><span class=\"w\">    </span><span class=\"kd\">const</span><span class=\"w\"> </span><span class=\"nx\">te</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">TextEdit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nx\">range</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">props.range</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">newText</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"hello\"</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">var</span><span class=\"w\"> </span><span class=\"nx\">changes</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"nx\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">DocumentUri</span><span class=\"p\">]</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"nx\">TextEdit</span><span class=\"p\">[]</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">{}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nx\">changes</span><span class=\"p\">[</span><span class=\"nx\">uri</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\"> </span><span class=\"nx\">te</span><span class=\"w\"> </span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">const</span><span class=\"w\"> </span><span class=\"nx\">we</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">WorkspaceEdit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"nx\">changes</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 310654703,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668704649
    },
    {
        "content": "<p>And we can write</p>\n<div class=\"codehilite\" data-code-language=\"TypeScript\"><pre><span></span><code><span class=\"w\">    </span><span class=\"c1\">// @ts-ignore</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nx\">editorConnection</span><span class=\"p\">.</span><span class=\"nx\">api</span><span class=\"p\">.</span><span class=\"nx\">applyEdit</span><span class=\"p\">(</span><span class=\"nx\">we</span><span class=\"p\">);</span><span class=\"w\"></span>\n</code></pre></div>\n<p>to ignore the type error.</p>",
        "id": 310654782,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668704671
    },
    {
        "content": "<p>I should probably figure out how to use a git version of the infoview.<br>\nI assume I need it both in <code>~/.vscode</code> somewhere, and also in my projects <code>package.json</code> so that TypeScript can typecheck it (which somehow didn’t work here)</p>",
        "id": 310674169,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668710482
    },
    {
        "content": "<blockquote>\n<p>(The pushed version might be missing rollup.config.js)</p>\n</blockquote>\n<p>Fixed, sorry.</p>",
        "id": 310674264,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668710520
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> , trying your PR, but I am unsure how to call <code>applyWorkspaceEdit</code> from a <code>RequestM</code> (or if that’s even what I should do)<br>\n(Can wait until tomorrow of course :-))</p>",
        "id": 310685464,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668714031
    },
    {
        "content": "<p>The example I posted in the PR was inside RequestM afair</p>",
        "id": 310685818,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668714154
    },
    {
        "content": "<p>Ah, I was thrown off by the <code>IO</code> type and the error message</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">type</span> <span class=\"n\">mismatch</span>\n  <span class=\"n\">applyWorkspaceEdit</span> <span class=\"o\">{</span> <span class=\"n\">label</span><span class=\"bp\">?</span> <span class=\"o\">:=</span> <span class=\"n\">none</span><span class=\"o\">,</span> <span class=\"n\">edit</span> <span class=\"o\">:=</span> <span class=\"bp\">?</span><span class=\"n\">m.1743</span> <span class=\"o\">}</span> <span class=\"n\">ctxt.hOut</span>\n<span class=\"n\">has</span> <span class=\"n\">type</span>\n  <span class=\"n\">IO</span> <span class=\"n\">Unit</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n<span class=\"n\">but</span> <span class=\"n\">is</span> <span class=\"n\">expected</span> <span class=\"n\">to</span> <span class=\"k\">have</span> <span class=\"n\">type</span>\n  <span class=\"n\">RequestM</span> <span class=\"n\">unit</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span>\n</code></pre></div>\n<p>Lean beginner here :-)</p>",
        "id": 310686328,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668714330
    },
    {
        "content": "<p><code>unit</code> looks suspicious :)</p>",
        "id": 310687348,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668714681
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20pos.20to.20LSP.20pos/near/310674169\">said</a>:</p>\n<blockquote>\n<p>I should probably figure out how to use a git version of the infoview.<br>\nI assume I need it both in <code>~/.vscode</code> somewhere, and also in my projects <code>package.json</code> so that TypeScript can typecheck it (which somehow didn’t work here)</p>\n</blockquote>\n<p>Do you mean using the a local copy of <code>@leanprover/infoview</code>? That would give you types for the new API but not much else, in particular it is unlikely to solve any TypeScript-not-compiling woes. I'm not sure what you mean about <code>~/.vscode</code>, but you shouldn't have to mess with that directory pretty much ever.</p>",
        "id": 310693835,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668716989
    },
    {
        "content": "<blockquote>\n<p>I'm not sure what you mean about ~/.vscode, but you shouldn't have to mess with that directory pretty much ever.</p>\n</blockquote>\n<p>What about <code>~/.vscode/extensions/leanprover.lean4-0.0.95/</code>? Is there no logic there that may be too old for some of these things we are trying to do here?</p>",
        "id": 310778137,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668763750
    },
    {
        "content": "<p>Yay, I just updated a piece of source code from the InfoView! (still hard-coded file uri, but hey :-))</p>",
        "id": 310779817,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668764394
    },
    {
        "content": "<p>Ok, next issue is that I kinda need to define a React component and pass it to the JS world. I am trying the very naive thing of passing JS code in the props to a generic widget, that tries to instantiate it, cargo-culting your code in<br>\n<a href=\"https://github.com/nomeata/lean4-interactive-tactic/blob/30c7377899b1b0d4ce6e6203964db85f245ce65b/widget/src/widget.tsx#L17-L24\">https://github.com/nomeata/lean4-interactive-tactic/blob/30c7377899b1b0d4ce6e6203964db85f245ce65b/widget/src/widget.tsx#L17-L24</a><br>\n(but no caching etc.)<br>\nI get errors, though, in the <code>import</code> line, namely</p>\n<ul>\n<li><a href=\"https://reactjs.org/docs/error-decoder.html/?invariant=31&amp;args[]=%5Bobject%20Promise%5D\">https://reactjs.org/docs/error-decoder.html/?invariant=31&amp;args[]=%5Bobject%20Promise%5D</a></li>\n<li><a href=\"https://reactjs.org/docs/error-decoder.html/?invariant=321\">https://reactjs.org/docs/error-decoder.html/?invariant=321</a><br>\nalthough I do get a module out it seems.</li>\n</ul>\n<p>Any hint what I might be doing wrong here?</p>",
        "id": 310789772,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668767876
    },
    {
        "content": "<p>And is there an easy way to run the widget code (or all of code?) with a non-minimized React?</p>",
        "id": 310789908,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668767929
    },
    {
        "content": "<p>Can you try replacing <code>fun({})</code> with <code>e(fun, {})</code>?</p>",
        "id": 310790376,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768081
    },
    {
        "content": "<p>Also you can't have a react component be an async function</p>",
        "id": 310790448,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768109
    },
    {
        "content": "<p>Tried <code>e(</code>… but the errors already happen at <code>import </code>time.<br>\nAh, that’s useful information. I’ll try to not do that.</p>",
        "id": 310790588,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668768149
    },
    {
        "content": "<p>You should wrap the async importing code in a React.lazy <a href=\"https://reactjs.org/docs/code-splitting.html#reactlazy\">https://reactjs.org/docs/code-splitting.html#reactlazy</a></p>",
        "id": 310790635,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768166
    },
    {
        "content": "<p>Something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">function</span> <span class=\"n\">myLazyCode</span><span class=\"o\">(</span><span class=\"n\">code</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n  <span class=\"n\">return</span> <span class=\"n\">React.lazy</span><span class=\"o\">(</span><span class=\"n\">async</span> <span class=\"o\">()</span> <span class=\"bp\">⇒</span> <span class=\"o\">{</span>\n    <span class=\"n\">const</span> <span class=\"n\">file</span> <span class=\"bp\">=</span> <span class=\"bp\">...</span>\n    <span class=\"bp\">...</span>\n    <span class=\"n\">return</span> <span class=\"n\">module.default</span>\n  <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>But then probably also memoise <code>myLazyCode</code>.</p>",
        "id": 310790978,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768292
    },
    {
        "content": "<p><code>React.lazy</code> works, yay!</p>",
        "id": 310791030,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668768315
    },
    {
        "content": "<p>I’ll worry about memoisation etc. at some later point, I first want to get to a state where I can show how great this all is (once someone reimplements it properly ;-))</p>",
        "id": 310791165,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668768368
    },
    {
        "content": "<p>the memoising is important so that it only loads the module once and you don't get multiple copies of the same component</p>",
        "id": 310791247,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768402
    },
    {
        "content": "<p>Maybe we should expose the dynamic component loading stuff in <code>@leanprover/infoview</code></p>",
        "id": 310791579,
        "sender_full_name": "Edward Ayers",
        "timestamp": 1668768546
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/270676-lean4/topic/Syntax.20pos.20to.20LSP.20pos/near/310789772\">said</a>:</p>\n<blockquote>\n<p>Ok, next issue is that I kinda need to define a React component and pass it to the JS world. I am trying the very naive thing of passing JS code in the props to a generic widget, that tries to instantiate it, cargo-culting your code in<br>\n<a href=\"https://github.com/nomeata/lean4-interactive-tactic/blob/30c7377899b1b0d4ce6e6203964db85f245ce65b/widget/src/widget.tsx#L17-L24\">https://github.com/nomeata/lean4-interactive-tactic/blob/30c7377899b1b0d4ce6e6203964db85f245ce65b/widget/src/widget.tsx#L17-L24</a><br>\n(but no caching etc.)<br>\nI get errors, though, in the <code>import</code> line, namely</p>\n<ul>\n<li><a href=\"https://reactjs.org/docs/error-decoder.html/?invariant=31&amp;args[]=%5Bobject%20Promise%5D\">https://reactjs.org/docs/error-decoder.html/?invariant=31&amp;args[]=%5Bobject%20Promise%5D</a></li>\n<li><a href=\"https://reactjs.org/docs/error-decoder.html/?invariant=321\">https://reactjs.org/docs/error-decoder.html/?invariant=321</a><br>\nalthough I do get a module out it seems.</li>\n</ul>\n<p>Any hint what I might be doing wrong here?</p>\n</blockquote>\n<p>I think this is a bit of an <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a> problem. I would hope that you wouldn't actually need to do any of the dynamic <code>import</code> tricks. Looking at your other thread, it sounds like you want a widget per instance of <code>Interactive α</code>. Why not associate a <code>UserWidgetDefinition</code> with <em>each</em> such instance and then make the <code>interactive</code> tactic store the ID of the particular widget found by instance resolution in the infotree?</p>",
        "id": 310878360,
        "sender_full_name": "Wojciech Nawrocki",
        "timestamp": 1668794211
    },
    {
        "content": "<p>That's what I tried, butI didn't immediately see how to look up the widget code by Id from JavaScript. (I need to wrap them with some common code!). So instead o cargo culted what the user widget code is doing.</p>\n<p>But this was just the path of least resistance, and cleanup is still needed. I'm calling it a day for now, but PRs are welcome :-)</p>",
        "id": 310883758,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1668795941
    }
]