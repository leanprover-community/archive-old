[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315434\">@Andrés Goens</span> You are extracting <code>rhs</code> as an <code>ident</code>, but putting it back as an <code>expr</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">macro_rules</span>\n<span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"bp\">$</span><span class=\"n\">lhs</span><span class=\"o\">:</span><span class=\"n\">ident</span> <span class=\"bp\">+</span> <span class=\"bp\">$</span><span class=\"n\">rhs</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">])</span> <span class=\"bp\">=&gt;</span> <span class=\"k\">do</span>\n  <span class=\"k\">let</span> <span class=\"n\">lhsString</span> <span class=\"o\">:=</span> <span class=\"n\">lhs.getId.toString</span>\n  <span class=\"k\">let</span> <span class=\"n\">lhsSyntax</span> <span class=\"o\">:=</span> <span class=\"n\">Lean.quote</span> <span class=\"n\">lhsString</span>\n  <span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"bp\">$</span><span class=\"n\">lhsSyntax</span> <span class=\"bp\">++</span> <span class=\"s2\">\" + \"</span> <span class=\"bp\">++</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">rhs</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">])</span>  <span class=\"c1\">-- !</span>\n</code></pre></div>",
        "id": 276786041,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1648384206
    },
    {
        "content": "<p>de <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a> attempt: I <em>think</em> you want to deal with these two cases</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">macro_rules</span>\n  <span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">])</span> <span class=\"bp\">=&gt;</span>\n    <span class=\"n\">return</span> <span class=\"n\">Lean.quote</span> <span class=\"n\">x.getId.toString</span>\n  <span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"bp\">$</span><span class=\"n\">lhs</span><span class=\"o\">:</span><span class=\"n\">expr</span> <span class=\"bp\">+</span> <span class=\"bp\">$</span><span class=\"n\">rhs</span><span class=\"o\">:</span><span class=\"n\">expr</span><span class=\"o\">])</span> <span class=\"bp\">=&gt;</span>\n    <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">rhs</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"s2\">\" + \"</span> <span class=\"bp\">++</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">rhs</span><span class=\"o\">])</span>\n\n<span class=\"k\">#check</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"n\">bar</span><span class=\"o\">]</span>       <span class=\"c1\">-- \"bar\" : String</span>\n<span class=\"k\">#check</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"n\">foo</span> <span class=\"bp\">+</span> <span class=\"n\">bar</span><span class=\"o\">]</span> <span class=\"c1\">-- \"foo\" ++ \" + \" ++ \"bar\" : String</span>\n</code></pre></div>",
        "id": 276786177,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1648384428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"451983\">Arthur Paulino</span> <a href=\"#narrow/stream/270676-lean4/topic/Lean.20nested.20syntax.20extension.20with.20identifiers/near/276786177\">said</a>:</p>\n<blockquote>\n<p>de <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a> attempt: I <em>think</em> you want to deal with these two cases</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">macro_rules</span>\n  <span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">])</span> <span class=\"bp\">=&gt;</span>\n    <span class=\"n\">return</span> <span class=\"n\">Lean.quote</span> <span class=\"n\">x.getId.toString</span>\n  <span class=\"bp\">|</span> <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"bp\">$</span><span class=\"n\">lhs</span><span class=\"o\">:</span><span class=\"n\">expr</span> <span class=\"bp\">+</span> <span class=\"bp\">$</span><span class=\"n\">rhs</span><span class=\"o\">:</span><span class=\"n\">expr</span><span class=\"o\">])</span> <span class=\"bp\">=&gt;</span>\n    <span class=\"bp\">`</span><span class=\"o\">([</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">rhs</span><span class=\"o\">]</span> <span class=\"bp\">++</span> <span class=\"s2\">\" + \"</span> <span class=\"bp\">++</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|$</span><span class=\"n\">rhs</span><span class=\"o\">])</span>\n\n<span class=\"k\">#check</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"n\">bar</span><span class=\"o\">]</span>       <span class=\"c1\">-- \"bar\" : String</span>\n<span class=\"k\">#check</span> <span class=\"o\">[</span><span class=\"n\">expr</span><span class=\"bp\">|</span> <span class=\"n\">foo</span> <span class=\"bp\">+</span> <span class=\"n\">bar</span><span class=\"o\">]</span> <span class=\"c1\">-- \"foo\" ++ \" + \" ++ \"bar\" : String</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Oh, yeah that makes sense. Thanks!</p>",
        "id": 276786334,
        "sender_full_name": "Andrés Goens",
        "timestamp": 1648384645
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315434\">Andrés Goens</span> has marked this topic as resolved.</p>",
        "id": 276786337,
        "sender_full_name": "Notification Bot",
        "timestamp": 1648384649
    }
]