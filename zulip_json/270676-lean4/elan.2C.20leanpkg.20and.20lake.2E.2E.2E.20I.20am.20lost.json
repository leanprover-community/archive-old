[
    {
        "content": "<p>OK, after one day fighting with Haskell tools (no solutions yet BTW, <a href=\"https://github.com/emacs-lsp/lsp-haskell/issues/154\">https://github.com/emacs-lsp/lsp-haskell/issues/154</a>). I planned to have some peaceful time with Lean... but... </p>\n<p>Elan supports both Lean4 and Lean3, right? But the repo says nothing about Lake, anyway, ignoring that below...</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">installed</span> <span class=\"n\">toolchains</span>\n<span class=\"c1\">--------------------</span>\n\n<span class=\"n\">stable</span>\n<span class=\"n\">nightly</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">23</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">07</span><span class=\"bp\">-</span><span class=\"mi\">29</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">10</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">stable</span> <span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n\n<span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n<span class=\"c1\">----------------</span>\n\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">stable</span> <span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"mi\">7</span><span class=\"n\">dbfaf9b7519</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I thought, let me try to update Lean4 to the last version</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"n\">update</span> <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">syncing</span> <span class=\"n\">channel</span> <span class=\"n\">updates</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">nightly'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">latest</span> <span class=\"n\">update</span> <span class=\"n\">on</span> <span class=\"n\">nightly</span><span class=\"o\">,</span> <span class=\"n\">lean</span> <span class=\"n\">version</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">19</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"n\">component</span> <span class=\"bp\">'</span><span class=\"n\">lean'</span>\n<span class=\"n\">Total</span><span class=\"o\">:</span> <span class=\"mi\">132</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">MiB</span> <span class=\"n\">Speed</span><span class=\"o\">:</span>  <span class=\"mi\">11</span><span class=\"bp\">.</span><span class=\"mi\">1</span> <span class=\"n\">MiB</span><span class=\"bp\">/</span><span class=\"n\">s</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">installing</span> <span class=\"n\">component</span> <span class=\"bp\">'</span><span class=\"n\">lean'</span>\n\n  <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span> <span class=\"n\">updated</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"n\">lean</span> <span class=\"n\">does</span> <span class=\"n\">not</span> <span class=\"n\">exist</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Wow! What the 'lean does not exist' means?  Let us see what happen.. nothing:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">ar</span><span class=\"bp\">@</span><span class=\"n\">tenis</span> <span class=\"bp\">~</span> <span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">installed</span> <span class=\"n\">toolchains</span>\n<span class=\"c1\">--------------------</span>\n\n<span class=\"n\">stable</span>\n<span class=\"n\">nightly</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">23</span><span class=\"bp\">.</span><span class=\"mi\">0</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">07</span><span class=\"bp\">-</span><span class=\"mi\">29</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">10</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">stable</span> <span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n\n<span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n<span class=\"c1\">----------------</span>\n\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">stable</span> <span class=\"o\">(</span><span class=\"n\">default</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"mi\">7</span><span class=\"n\">dbfaf9b7519</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n<span class=\"bp\">``</span>\n\n<span class=\"n\">I</span> <span class=\"n\">prefer</span> <span class=\"n\">Emacs</span><span class=\"o\">,</span> <span class=\"n\">but</span> <span class=\"n\">I</span> <span class=\"n\">watch</span> <span class=\"n\">the</span> <span class=\"n\">video</span> <span class=\"n\">pointed</span> <span class=\"kd\">by</span> <span class=\"n\">the</span> <span class=\"n\">docs</span> <span class=\"n\">to</span> <span class=\"n\">learn</span> <span class=\"n\">something.</span> <span class=\"n\">The</span> <span class=\"n\">video</span> <span class=\"n\">talks</span> <span class=\"n\">about</span> <span class=\"n\">the</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">samples</span><span class=\"bp\">/</span><span class=\"n\">blob</span><span class=\"bp\">/</span><span class=\"n\">main</span><span class=\"bp\">/</span><span class=\"n\">HelloWorld</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span> <span class=\"kd\">example</span><span class=\"bp\">.</span> <span class=\"n\">Note</span> <span class=\"n\">that</span> <span class=\"n\">only</span> <span class=\"bp\">`</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">`</span> <span class=\"n\">was</span> <span class=\"n\">defined</span> <span class=\"n\">and</span> <span class=\"n\">VS</span> <span class=\"n\">Code</span> <span class=\"n\">seems</span> <span class=\"n\">to</span> <span class=\"n\">work</span> <span class=\"n\">well</span> <span class=\"k\">with</span> <span class=\"n\">that.</span> <span class=\"n\">But</span> <span class=\"n\">not</span> <span class=\"n\">Emacs..</span> <span class=\"n\">I</span> <span class=\"n\">changed</span> <span class=\"n\">my</span> <span class=\"n\">project</span> <span class=\"n\">to</span> <span class=\"n\">that</span> <span class=\"n\">and</span>  <span class=\"n\">I</span> <span class=\"n\">got</span> <span class=\"n\">error</span> <span class=\"k\">in</span> <span class=\"n\">the</span> <span class=\"bp\">`</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">lsp</span><span class=\"o\">:</span><span class=\"n\">stderr</span><span class=\"bp\">`</span> <span class=\"n\">buffer</span><span class=\"o\">:</span>\n</code></pre></div>\n<p>error: toolchain 'leanprover/lean4:nightly' does not have the binary <code>/Users/ar/.elan/toolchains/leanprover--lean4---nightly/bin/lean</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">I</span> <span class=\"n\">finally</span> <span class=\"n\">tried</span> <span class=\"n\">to</span> <span class=\"n\">install</span> <span class=\"n\">the</span> <span class=\"n\">version</span> <span class=\"n\">given</span> <span class=\"n\">the</span> <span class=\"n\">complete</span> <span class=\"n\">date</span>\n</code></pre></div>\n<p>% elan toolchain install leanprover/lean4:nightly-2022-08-15<br>\ninfo: downloading component 'lean'<br>\nTotal: 132.1 MiB Speed:   3.9 MiB/s<br>\ninfo: installing component 'lean'</p>\n<p>leanprover/lean4:nightly-2022-08-15 installed - (lean does not exist)</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">So</span> <span class=\"n\">what</span> <span class=\"n\">is</span> <span class=\"n\">going</span> <span class=\"n\">on</span> <span class=\"n\">here</span><span class=\"bp\">?</span> <span class=\"n\">How</span> <span class=\"n\">can</span> <span class=\"n\">I</span> <span class=\"k\">have</span> <span class=\"n\">only</span> <span class=\"n\">the</span> <span class=\"n\">nightly</span> <span class=\"n\">and</span> <span class=\"n\">maybe</span> <span class=\"n\">lean3</span><span class=\"bp\">-</span><span class=\"n\">community</span> <span class=\"n\">toolchains</span> <span class=\"n\">and</span> <span class=\"k\">let</span> <span class=\"n\">elan</span> <span class=\"n\">update</span> <span class=\"n\">them</span> <span class=\"n\">for</span> <span class=\"n\">me</span> <span class=\"n\">whenever</span> <span class=\"n\">I</span> <span class=\"n\">run</span> <span class=\"bp\">`</span><span class=\"n\">elan</span> <span class=\"n\">update</span><span class=\"bp\">`?</span>\n</code></pre></div>",
        "id": 294367108,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1660945233
    },
    {
        "content": "<p>I've noticed that some of the daily builds are broken, as in, the artifact is missing some binaries. <br>\nA working build should look like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">$</span>  <span class=\"n\">ls</span> <span class=\"bp\">-</span><span class=\"n\">l</span> <span class=\"bp\">~/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-08-09/bin</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>   <span class=\"mi\">167</span><span class=\"n\">K</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">19</span> <span class=\"n\">clang</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>   <span class=\"mi\">2</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"n\">M</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">28</span> <span class=\"n\">lake</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>   <span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"n\">M</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">19</span> <span class=\"n\">ld64.lld</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>    <span class=\"mi\">49</span><span class=\"n\">K</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">27</span> <span class=\"n\">lean</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>    <span class=\"mi\">70</span><span class=\"n\">K</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">27</span> <span class=\"n\">leanc</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>   <span class=\"mi\">839</span><span class=\"n\">B</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">18</span> <span class=\"n\">leanmake</span>\n<span class=\"bp\">-</span><span class=\"n\">rwxr</span><span class=\"bp\">-</span><span class=\"n\">xr</span><span class=\"bp\">-</span><span class=\"n\">x</span>  <span class=\"mi\">1</span> <span class=\"n\">jpablo</span>  <span class=\"n\">staff</span>   <span class=\"mi\">101</span><span class=\"n\">K</span> <span class=\"n\">Aug</span>  <span class=\"mi\">9</span> <span class=\"mi\">00</span><span class=\"o\">:</span><span class=\"mi\">19</span> <span class=\"n\">llvm</span><span class=\"bp\">-</span><span class=\"n\">ar</span>\n</code></pre></div>\n<p>If it's missing something you'll get the error you mentioned.</p>",
        "id": 294381244,
        "sender_full_name": "Juan Pablo Romero",
        "timestamp": 1660957366
    },
    {
        "content": "<p>the workaround is to delete the broken build and try another from a different date</p>",
        "id": 294381268,
        "sender_full_name": "Juan Pablo Romero",
        "timestamp": 1660957410
    },
    {
        "content": "<p>Ok, I think I know what's going on.  We recently changed the lean4-samples to use <code>leanprover/lean4:nightly</code> so that our <a href=\"https://github.com/leanprover/lean4-samples/actions/runs/2890377572\">nightly schedules builds</a> would pick up any new build breaks from the latest lean bits that it installs.  When you don't specify a date, elan installs the latest.  BUT, here's the catch.  If you already have a very old version of <code>leanprover/lean4:nightly</code> installed, elan does not update it.  It's kind of operating as a cache.  So this is what I've been doing to fix that:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">elan</span> <span class=\"n\">toolchain</span> <span class=\"n\">uninstall</span> <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">elan</span> <span class=\"n\">toolchain</span> <span class=\"n\">install</span> <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n</code></pre></div>\n<p>If you do that, now the lean4-samples should behave like you see in the <a href=\"https://github.com/leanprover/lean4-samples/actions/runs/2890377572\">CI build</a>.</p>",
        "id": 294388828,
        "sender_full_name": "Chris Lovett",
        "timestamp": 1660966175
    },
    {
        "content": "<p>You can use <code>elan update</code> for that, like in the first post</p>",
        "id": 294417912,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1660989686
    },
    {
        "content": "<p>but <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span>  and <span class=\"user-mention\" data-user-id=\"434989\">@Chris Lovett</span> , see the outputs</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">no</span> <span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n\n<span class=\"n\">ar</span><span class=\"bp\">@</span><span class=\"n\">tenis</span> <span class=\"bp\">~</span> <span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"bp\">-</span><span class=\"n\">v</span> <span class=\"n\">toolchain</span> <span class=\"n\">install</span> <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">updating</span> <span class=\"n\">existing</span> <span class=\"n\">install</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">toolchain</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">syncing</span> <span class=\"n\">channel</span> <span class=\"n\">updates</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">nightly'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">latest</span> <span class=\"n\">update</span> <span class=\"n\">on</span> <span class=\"n\">nightly</span><span class=\"o\">,</span> <span class=\"n\">lean</span> <span class=\"n\">version</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"n\">component</span> <span class=\"bp\">'</span><span class=\"n\">lean'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">creating</span> <span class=\"n\">temp</span> <span class=\"n\">file</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">tmp</span><span class=\"bp\">/</span><span class=\"mi\">6</span><span class=\"n\">jp35185in2g9hjy_file</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"n\">file</span> <span class=\"k\">from</span><span class=\"o\">:</span> <span class=\"bp\">'</span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">tag</span><span class=\"bp\">/</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span><span class=\"bp\">'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"k\">with</span> <span class=\"n\">curl</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">creating</span> <span class=\"n\">temp</span> <span class=\"n\">file</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">tmp</span><span class=\"bp\">/</span><span class=\"mi\">89</span><span class=\"n\">s8utnt9hv_b2g9_file</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"n\">file</span> <span class=\"k\">from</span><span class=\"o\">:</span> <span class=\"bp\">'</span><span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">//</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">/</span><span class=\"n\">releases</span><span class=\"bp\">/</span><span class=\"n\">download</span><span class=\"bp\">/</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span><span class=\"bp\">-</span><span class=\"n\">darwin.tar.zst'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">downloading</span> <span class=\"k\">with</span> <span class=\"n\">curl</span>\n<span class=\"n\">Total</span><span class=\"o\">:</span> <span class=\"mi\">132</span><span class=\"bp\">.</span><span class=\"mi\">4</span> <span class=\"n\">MiB</span> <span class=\"n\">Speed</span><span class=\"o\">:</span>  <span class=\"mi\">11</span><span class=\"bp\">.</span><span class=\"mi\">2</span> <span class=\"n\">MiB</span><span class=\"bp\">/</span><span class=\"n\">s</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">installing</span> <span class=\"n\">component</span> <span class=\"bp\">'</span><span class=\"n\">lean'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">removing</span> <span class=\"n\">toolchain</span> <span class=\"n\">directory</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">creating</span> <span class=\"n\">toolchain</span> <span class=\"n\">directory</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">deleted</span> <span class=\"n\">temp</span> <span class=\"n\">file</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">tmp</span><span class=\"bp\">/</span><span class=\"mi\">89</span><span class=\"n\">s8utnt9hv_b2g9_file</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">deleted</span> <span class=\"n\">temp</span> <span class=\"n\">file</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">tmp</span><span class=\"bp\">/</span><span class=\"mi\">6</span><span class=\"n\">jp35185in2g9hjy_file</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">toolchain</span> <span class=\"bp\">'</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly'</span> <span class=\"n\">installed</span>\n\n  <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span> <span class=\"n\">updated</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"n\">lean</span> <span class=\"n\">does</span> <span class=\"n\">not</span> <span class=\"n\">exist</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>So after the install, note the message <code>lean does not exist</code>. Moreover, no lean binary in the expected place and no active toolchain:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">ar</span><span class=\"bp\">@</span><span class=\"n\">tenis</span> <span class=\"bp\">~</span> <span class=\"bp\">%</span> <span class=\"n\">ls</span> <span class=\"bp\">.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly/bin/</span>\n<span class=\"n\">GNUSparseFile.0</span> <span class=\"n\">clang</span>       <span class=\"n\">lake</span>        <span class=\"n\">ld64.lld</span>    <span class=\"n\">leanmake</span>    <span class=\"n\">llvm</span><span class=\"bp\">-</span><span class=\"n\">ar</span>\n\n<span class=\"n\">ar</span><span class=\"bp\">@</span><span class=\"n\">tenis</span> <span class=\"bp\">~</span> <span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">no</span> <span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n</code></pre></div>\n<p>If I try another installation:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">ar</span><span class=\"bp\">@</span><span class=\"n\">tenis</span> <span class=\"bp\">~</span> <span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"bp\">-</span><span class=\"n\">v</span> <span class=\"n\">toolchain</span> <span class=\"n\">install</span> <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">updating</span> <span class=\"n\">existing</span> <span class=\"n\">install</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly'</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">toolchain</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">syncing</span> <span class=\"n\">channel</span> <span class=\"n\">updates</span> <span class=\"n\">for</span> <span class=\"bp\">'</span><span class=\"n\">nightly'</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">latest</span> <span class=\"n\">update</span> <span class=\"n\">on</span> <span class=\"n\">nightly</span><span class=\"o\">,</span> <span class=\"n\">lean</span> <span class=\"n\">version</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span>\n<span class=\"n\">verbose</span><span class=\"o\">:</span> <span class=\"n\">toolchain</span> <span class=\"n\">is</span> <span class=\"n\">already</span> <span class=\"n\">up</span> <span class=\"n\">to</span> <span class=\"n\">date</span>\n\n  <span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span> <span class=\"n\">unchanged</span> <span class=\"bp\">-</span> <span class=\"o\">(</span><span class=\"n\">lean</span> <span class=\"n\">does</span> <span class=\"n\">not</span> <span class=\"n\">exist</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>If I uninstall it and install again, same problem!</p>",
        "id": 294452198,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661007823
    },
    {
        "content": "<p>I'm starting to be suspicious of the latest MacOS update. Now running  MacOS Monterey 12.5.1.</p>",
        "id": 294452400,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661007912
    },
    {
        "content": "<p>Hmm, there definitely is a <code>bin/lean</code> in <a href=\"https://github.com//leanprover/lean4-nightly/releases/download/nightly-2022-08-20/lean-4.0.0-nightly-2022-08-20-darwin.tar.zst\">https://github.com//leanprover/lean4-nightly/releases/download/nightly-2022-08-20/lean-4.0.0-nightly-2022-08-20-darwin.tar.zst</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">20</span><span class=\"bp\">-</span><span class=\"n\">darwin</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"o\">:</span> <span class=\"n\">Mach</span><span class=\"bp\">-</span><span class=\"n\">O</span> <span class=\"mi\">64</span><span class=\"bp\">-</span><span class=\"n\">bit</span> <span class=\"n\">x86_64</span> <span class=\"n\">executable</span><span class=\"o\">,</span> <span class=\"n\">flags</span><span class=\"o\">:</span><span class=\"bp\">&lt;</span><span class=\"n\">NOUNDEFS</span><span class=\"bp\">|</span><span class=\"n\">DYLDLINK</span><span class=\"bp\">|</span><span class=\"n\">TWOLEVEL</span><span class=\"bp\">|</span><span class=\"n\">PIE</span><span class=\"bp\">&gt;</span>\n</code></pre></div>",
        "id": 294455876,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1661009978
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 294456040,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661010055
    },
    {
        "content": "<p>This <code>GNUSparseFile.0</code> directory is really suspicious</p>",
        "id": 294456377,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661010253
    },
    {
        "content": "<p>That sounds like <a href=\"https://github.com/leanprover/elan/issues/78\">https://github.com/leanprover/elan/issues/78</a></p>",
        "id": 294456560,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1661010379
    },
    {
        "content": "<p>But I assume a (corrupted) lean binary is inside the <code>GNUSparseFile.0</code> directory</p>",
        "id": 294457028,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661010657
    },
    {
        "content": "<p>I don't know what generates the tarballs, but perhaps passing <code>--format=v7</code> to <code>tar</code> could help until <code>tar-rs</code> supports untarring sparse files.</p>",
        "id": 294457417,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661010905
    },
    {
        "content": "<p>Let's give that a try <a href=\"https://github.com/leanprover/lean4/pull/1498\">https://github.com/leanprover/lean4/pull/1498</a></p>",
        "id": 294458564,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1661011525
    },
    {
        "content": "<p>Oh nice, but I installed elan from brew. So better uninstall it and install it directly ? Will that work now?</p>",
        "id": 294460206,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661012556
    },
    {
        "content": "<p>Oh , I see now you changed the lean compressing approach , so I can try my current elan  installation with the next lean nightly release , right ?</p>",
        "id": 294460676,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661012776
    },
    {
        "content": "<p>BTW, yes, if I download the tar.zst file manually, I can expand it with <code>tar --use-compress-program=unzstd -xvf lean-4.0.0-nightly-2022-08-19-darwin.tar.zst</code>. But I don't want to mess with my elan installation, so I will wait the proper solution.</p>",
        "id": 294473359,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661021657
    },
    {
        "content": "<p>Hi, I'm another Mac/brew user currently experiencing issues very similar to what <span class=\"user-mention\" data-user-id=\"121542\">@Alexandre Rademaker</span>  described. Was there a final verdict on what I should do? </p>\n<p>Using brew to remove and reinstall elan, and using elan to uninstall and reinstall the nightly toolchain still yields the <code>lean does not exist</code> message for me, even though I believe that <a href=\"https://github.com/leanprover/lean4/pull/1498\">https://github.com/leanprover/lean4/pull/1498</a> has been merged. Should I sit tight for now, or is there something else I should try? I totally understand if the answer is just, wait, it should be fixed soon, I'm just looking to confirm whether there was a step that I overlooked/missed.</p>",
        "id": 294590644,
        "sender_full_name": "Josh Clune",
        "timestamp": 1661125495
    },
    {
        "content": "<p>A nightly (2022-08-22) with <a href=\"https://github.com/leanprover/lean4/pull/1499\">https://github.com/leanprover/lean4/pull/1499</a> should be available in about 8 hours</p>",
        "id": 294592617,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661127757
    },
    {
        "content": "<p>Great, thanks!</p>",
        "id": 294597549,
        "sender_full_name": "Josh Clune",
        "timestamp": 1661134680
    },
    {
        "content": "<p>Indeed, after running the <code>elan -v toolchain install leanprover/lean4:nightly</code> I got Lean installed, but it is strange the output of the show command</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">no</span> <span class=\"n\">active</span> <span class=\"n\">toolchain</span>\n</code></pre></div>",
        "id": 294661329,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661170007
    },
    {
        "content": "<p>Is that in a project with a <code>lean-toolchain</code> file?</p>",
        "id": 294662925,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1661170617
    },
    {
        "content": "<p>no, outside a project, in my home folder</p>",
        "id": 294663129,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661170689
    },
    {
        "content": "<p>Inside a project folder, I got</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">elan</span> <span class=\"k\">show</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span> <span class=\"o\">(</span><span class=\"n\">overridden</span> <span class=\"kd\">by</span> <span class=\"bp\">'/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">ar</span><span class=\"bp\">/</span><span class=\"n\">hpsg</span><span class=\"bp\">/</span><span class=\"n\">mrs</span><span class=\"bp\">-</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain'</span><span class=\"o\">)</span>\n<span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2022</span><span class=\"bp\">-</span><span class=\"mi\">08</span><span class=\"bp\">-</span><span class=\"mi\">22</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"n\">f8c7de5a64fc</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 294663191,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661170717
    },
    {
        "content": "<p>(FWIW my CI was broken yesterday with nightly for 08-20 on macOS, but appears to work now on 08-22, which I think means at least here something has been fixed.)</p>",
        "id": 294663291,
        "sender_full_name": "Julian Berman",
        "timestamp": 1661170756
    },
    {
        "content": "<p>sorry <span class=\"user-mention\" data-user-id=\"110024\">@Sebastian Ullrich</span> , just rewrote my last message  to make it clear.</p>",
        "id": 294663980,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1661171003
    },
    {
        "content": "<p>Use <code>elan default leanprover/lean4:nightly</code> to configure your default toolchain (the one that's used when you're not inside a project directory)</p>",
        "id": 294681554,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1661176892
    },
    {
        "content": "<p>I added a CI nightly test of elan on macOS to the <a href=\"https://github.com/leanprover/lean4-samples/pull/6/checks\">lean4-samples</a> repo.</p>",
        "id": 294739514,
        "sender_full_name": "Chris Lovett",
        "timestamp": 1661190995
    }
]