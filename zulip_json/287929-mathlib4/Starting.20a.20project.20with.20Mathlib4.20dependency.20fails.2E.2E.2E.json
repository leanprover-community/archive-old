[
    {
        "content": "<p>I'm trying to create an <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> project, and went through the following process:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">new</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">cd</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">cat</span> <span class=\"n\">lakefile.lean</span>\n<span class=\"kn\">import</span> <span class=\"n\">Lake</span>\n<span class=\"kn\">open</span> <span class=\"n\">Lake</span> <span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span> <span class=\"bp\">«</span><span class=\"n\">mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"c1\">-- add package configuration options here</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">lean_lib</span> <span class=\"bp\">«</span><span class=\"n\">Mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"c1\">-- add library configuration options here</span>\n<span class=\"o\">}</span>\n\n<span class=\"kd\">@[default_target]</span>\n<span class=\"n\">lean_exe</span> <span class=\"bp\">«</span><span class=\"n\">mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"n\">root</span> <span class=\"o\">:=</span> <span class=\"bp\">`</span><span class=\"n\">Main</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span> <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4\"</span> <span class=\"bp\">@</span> <span class=\"s2\">\"master\"</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">update</span>\n<span class=\"c1\">-- Cut but all good</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">build</span>\n<span class=\"n\">Building</span> <span class=\"n\">Mwe</span>\n<span class=\"n\">Compiling</span> <span class=\"n\">Mwe</span>\n<span class=\"n\">Building</span> <span class=\"n\">Main</span>\n<span class=\"n\">Compiling</span> <span class=\"n\">Main</span>\n<span class=\"n\">Linking</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>\n<span class=\"c1\">-- cut but all good</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">cat</span> <span class=\"n\">Mwe.lean</span>\n<span class=\"kn\">import</span> <span class=\"n\">Mathlib.Data.Sum.Basic</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">hello</span> <span class=\"o\">:=</span> <span class=\"s2\">\"world\"</span><span class=\"bp\">%</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">build</span>\n<span class=\"c1\">-- ...</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">DYLD_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/lib:././lake-packages/mathlib/build/lib /Users/arienmalec/.elan/toolchains/leanprover--lean4---nightly-2022-12-03/bin/lean -DwarningAsError=true ././lake-packages/mathlib/././Mathlib/Data/KVMap.lean -R ././lake-packages/mathlib/./. -o ././lake-packages/mathlib/build/lib/Mathlib/Data/KVMap.olean -i ././lake-packages/mathlib/build/lib/Mathlib/Data/KVMap.ilean -c ././lake-packages/mathlib/build/ir/Mathlib/Data/KVMap.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">KVMap.lean</span><span class=\"o\">:</span><span class=\"mi\">17</span><span class=\"o\">:</span><span class=\"mi\">31</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">expected</span> <span class=\"n\">token</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/bin/lean` exited with code 1</span>\n<span class=\"bp\">-</span> <span class=\"bp\">...</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">DYLD_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/lib:././lake-packages/mathlib/build/lib /Users/arienmalec/.elan/toolchains/leanprover--lean4---nightly-2022-12-03/bin/lean -DwarningAsError=true ././lake-packages/mathlib/././Mathlib/Tactic/Relation/Rfl.lean -R ././lake-packages/mathlib/./. -o ././lake-packages/mathlib/build/lib/Mathlib/Tactic/Relation/Rfl.olean -i ././lake-packages/mathlib/build/lib/Mathlib/Tactic/Relation/Rfl.ilean -c ././lake-packages/mathlib/build/ir/Mathlib/Tactic/Relation/Rfl.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">Relation</span><span class=\"bp\">/</span><span class=\"n\">Rfl.lean</span><span class=\"o\">:</span><span class=\"mi\">23</span><span class=\"o\">:</span><span class=\"mi\">31</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">expected</span> <span class=\"n\">token</span>\n<span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">Relation</span><span class=\"bp\">/</span><span class=\"n\">Rfl.lean</span><span class=\"o\">:</span><span class=\"mi\">30</span><span class=\"o\">:</span><span class=\"mi\">25</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">expected</span> <span class=\"n\">token</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/bin/lean` exited with code 1</span>\n<span class=\"bp\">-</span> <span class=\"bp\">...</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">DYLD_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/lib:././lake-packages/mathlib/build/lib /Users/arienmalec/.elan/toolchains/leanprover--lean4---nightly-2022-12-03/bin/lean -DwarningAsError=true ././lake-packages/mathlib/././Mathlib/Lean/Meta.lean -R ././lake-packages/mathlib/./. -o ././lake-packages/mathlib/build/lib/Mathlib/Lean/Meta.olean -i ././lake-packages/mathlib/build/lib/Mathlib/Lean/Meta.ilean -c ././lake-packages/mathlib/build/ir/Mathlib/Lean/Meta.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Lean</span><span class=\"bp\">/</span><span class=\"n\">Meta.lean</span><span class=\"o\">:</span><span class=\"mi\">36</span><span class=\"o\">:</span><span class=\"mi\">21</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">expected</span> <span class=\"n\">token</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/bin/lean` exited with code 1</span>\n<span class=\"c1\">-- ...</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">DYLD_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2022-12-03/lib:././lake-packages/mathlib/build/lib /Users/arienmalec/.elan/toolchains/leanprover--lean4---nightly-2022-12-03/bin/lean -DwarningAsError=true ././lake-packages/mathlib/././Mathlib/Tactic/LeftRight.lean -R ././lake-packages/mathlib/./. -o ././lake-packages/mathlib/build/lib/Mathlib/Tactic/LeftRight.olean -i ././lake-packages/mathlib/build/lib/Mathlib/Tactic/LeftRight.ilean -c ././lake-packages/mathlib/build/ir/Mathlib/Tactic/LeftRight.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/././</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Tactic</span><span class=\"bp\">/</span><span class=\"n\">LeftRight.lean</span><span class=\"o\">:</span><span class=\"mi\">15</span><span class=\"o\">:</span><span class=\"mi\">13</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">expected</span> <span class=\"n\">token</span>\n<span class=\"c1\">-- lots more like this...</span>\n<span class=\"c1\">---</span>\n</code></pre></div>\n<p>My <code>elan</code> is up to date, yadda yadda.</p>",
        "id": 319646175,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672943348
    },
    {
        "content": "<p>Did <code>lake new mwe</code> give you a lakefile with a mathlib dependency? It doesn't do that for me (I was trying to repro). Or did I misunderstand?</p>",
        "id": 319686004,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1672958535
    },
    {
        "content": "<p>I inserted the dependency</p>",
        "id": 319692630,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672961480
    },
    {
        "content": "<p>Sorry- deleted the editing steps</p>",
        "id": 319692736,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672961524
    },
    {
        "content": "<p>Do the lean-toolchains match?</p>",
        "id": 319703590,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1672967909
    },
    {
        "content": "<p>Match what, I guess? <code>lake</code> is using the toolchain specified in <code>lean-toolchain</code></p>",
        "id": 319708710,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672971697
    },
    {
        "content": "<p>Which is a day behind the toolchain for Mathlib4?</p>",
        "id": 319708795,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672971750
    },
    {
        "content": "<p>A day behind is a day too much. <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>  Just copy the <code>lean-toolchain</code> file from mathlib.</p>",
        "id": 319708851,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1672971808
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">cp</span> <span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span> <span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 319708859,
        "sender_full_name": "Gabriel Ebner",
        "timestamp": 1672971816
    },
    {
        "content": "<p>If I update the toolchain, I still get errors... How is <code>lake</code> supposed to work with mathlib4? My experience in lean 3 is that leanproject JustWorks...</p>",
        "id": 319708951,
        "sender_full_name": "Arien Malec",
        "timestamp": 1672971898
    },
    {
        "content": "<p>Leanproject was specifically designed to work with mathlib. Lake was not specifically designed to work with mathlib4</p>",
        "id": 319725967,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1672987253
    },
    {
        "content": "<p>And I suspect at some point that's going to be an issue, but discovering in another thread that making mathlib4 work as a client isn't a priority at the moment. As noted I was trying to create an Mwe scratchpad so I can isolate issues, etc.</p>",
        "id": 319851823,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673034737
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"542196\">Arien Malec</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Starting.20a.20project.20with.20Mathlib4.20dependency.20fails.2E.2E.2E/near/319851823\">said</a>:</p>\n<blockquote>\n<p>And I suspect at some point that's going to be an issue, but discovering in another thread that making mathlib4 work as a client isn't a priority at the moment. As noted I was trying to create an Mwe scratchpad so I can isolate issues, etc.</p>\n</blockquote>\n<p>Hmm, not exactly. Making <code>lake exe cache</code> work on projects that import Mathlib isn't a priority. But using Mathlib, or any other Lake project, as a dependency shouldn't be an issue (as long as there isn't any version mismatch)</p>",
        "id": 319852091,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1673034854
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"542196\">@Arien Malec</span> this is how you make your Lake project depend on Mathlib:<br>\n<a href=\"https://github.com/siddhartha-gadgil/LeanAide/blob/b6fb470c3997ea1ac1669969383691a976fc8b5d/lakefile.lean#L71-L72\">https://github.com/siddhartha-gadgil/LeanAide/blob/b6fb470c3997ea1ac1669969383691a976fc8b5d/lakefile.lean#L71-L72</a>. You need to be careful to use a mathlib rev that matches your lean-toolchain</p>",
        "id": 319852864,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1673035160
    },
    {
        "content": "<p>Let me do this again ground up and see how far I can get.</p>",
        "id": 319853198,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673035248
    },
    {
        "content": "<p>Fascinating -- same issues.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">rm</span> <span class=\"bp\">-</span><span class=\"n\">rf</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">new</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">code</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">lean</span> <span class=\"bp\">%</span> <span class=\"n\">cd</span> <span class=\"n\">mwe</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">cat</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span>\n<span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2023</span><span class=\"bp\">-</span><span class=\"mi\">01</span><span class=\"bp\">-</span><span class=\"mi\">04</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">cat</span> <span class=\"n\">lakefile.lean</span>\n<span class=\"kn\">import</span> <span class=\"n\">Lake</span>\n<span class=\"kn\">open</span> <span class=\"n\">Lake</span> <span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span> <span class=\"bp\">«</span><span class=\"n\">mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"c1\">-- add package configuration options here</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">lean_lib</span> <span class=\"bp\">«</span><span class=\"n\">Mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"c1\">-- add library configuration options here</span>\n<span class=\"o\">}</span>\n\n<span class=\"kd\">@[default_target]</span>\n<span class=\"n\">lean_exe</span> <span class=\"bp\">«</span><span class=\"n\">mwe</span><span class=\"bp\">»</span> <span class=\"o\">{</span>\n  <span class=\"n\">root</span> <span class=\"o\">:=</span> <span class=\"bp\">`</span><span class=\"n\">Main</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span>\n  <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span><span class=\"bp\">@</span><span class=\"s2\">\"a4f3950661f788086a461619be71ebf68636d7ac\"</span><span class=\"bp\">%</span>                                                            <span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">update</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib4.git</span> <span class=\"n\">to</span> <span class=\"bp\">./</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">xubaiw</span><span class=\"bp\">/</span><span class=\"n\">CMark.lean</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">CMark</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lake</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">lake</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">doc</span><span class=\"bp\">-</span><span class=\"n\">gen4</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">mhuisi</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">cli</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Cli</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">gebner</span><span class=\"bp\">/</span><span class=\"n\">quote4</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">JLimperg</span><span class=\"bp\">/</span><span class=\"n\">aesop</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">hargonix</span><span class=\"bp\">/</span><span class=\"n\">LeanInk</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">leanInk</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">xubaiw</span><span class=\"bp\">/</span><span class=\"n\">Unicode.lean</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Unicode</span>\n<span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">std4</span> <span class=\"n\">to</span> <span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Building</span> <span class=\"n\">Cache.IO</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Building</span> <span class=\"n\">Cache.Hashing</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Compiling</span> <span class=\"n\">Cache.IO</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Compiling</span> <span class=\"n\">Cache.Hashing</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Building</span> <span class=\"n\">Cache.Requests</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Compiling</span> <span class=\"n\">Cache.Requests</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Building</span> <span class=\"n\">Cache.Main</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Compiling</span> <span class=\"n\">Cache.Main</span>\n<span class=\"n\">info</span><span class=\"o\">:</span> <span class=\"n\">Linking</span> <span class=\"n\">cache</span>\n<span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">download</span> <span class=\"mi\">804</span> <span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"n\">Decompressing</span> <span class=\"mi\">803</span> <span class=\"n\">file</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">cat</span> <span class=\"n\">Mwe.lean</span>\n<span class=\"kn\">import</span> <span class=\"n\">Mathlib.Data.Sum.Basic</span>\n<span class=\"n\">arienmalec</span><span class=\"bp\">@</span><span class=\"n\">Ariens</span><span class=\"bp\">-</span><span class=\"n\">MBP</span><span class=\"bp\">-</span><span class=\"mi\">2</span> <span class=\"n\">mwe</span> <span class=\"bp\">%</span> <span class=\"n\">lake</span> <span class=\"n\">build</span>\n<span class=\"bp\">#</span> <span class=\"bp\">&lt;</span><span class=\"n\">deleted</span> <span class=\"n\">lines</span><span class=\"bp\">&gt;</span>\n<span class=\"n\">Compiling</span> <span class=\"n\">Mathlib.Data.Sum.Basic</span>\n<span class=\"n\">Building</span> <span class=\"n\">Mwe</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"bp\">&gt;</span> <span class=\"n\">LEAN_PATH</span><span class=\"bp\">=./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">Qq</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">aesop</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"o\">:</span><span class=\"bp\">././</span><span class=\"n\">lake</span><span class=\"bp\">-</span><span class=\"n\">packages</span><span class=\"bp\">/</span><span class=\"n\">std</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span> <span class=\"n\">DYLD_LIBRARY_PATH</span><span class=\"bp\">=/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2023-01-04/lib:./build/lib /Users/arienmalec/.elan/toolchains/leanprover--lean4---nightly-2023-01-04/bin/lean ./././Mwe.lean -R ././. -o ./build/lib/Mwe.olean -i ./build/lib/Mwe.ilean -c ./build/ir/Mwe.c</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">stdout</span><span class=\"o\">:</span>\n<span class=\"bp\">./././</span><span class=\"n\">Mwe.lean</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"o\">:</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">object</span> <span class=\"n\">file</span> <span class=\"bp\">'./</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Data</span><span class=\"bp\">/</span><span class=\"n\">Sum</span><span class=\"bp\">/</span><span class=\"n\">Basic.olean'</span> <span class=\"n\">of</span> <span class=\"n\">module</span> <span class=\"n\">Mathlib.Data.Sum.Basic</span> <span class=\"n\">does</span> <span class=\"n\">not</span> <span class=\"n\">exist</span>\n<span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">external</span> <span class=\"n\">command</span> <span class=\"bp\">`/</span><span class=\"n\">Users</span><span class=\"bp\">/</span><span class=\"n\">arienmalec</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">toolchains</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"c1\">--lean4---nightly-2023-01-04/bin/lean` exited with code 1</span>\n</code></pre></div>",
        "id": 319855988,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673036213
    },
    {
        "content": "<p>It has no problem building -- the issue seems to be in linking?</p>",
        "id": 319856254,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673036309
    },
    {
        "content": "<p>I'm about to go AFK, but try to host that project on github so other people can clone it and help you. Also, the stream <a class=\"stream\" data-stream-id=\"270676\" href=\"/#narrow/stream/270676-lean4\">#lean4</a> is a better place to solve these general Lean 4/Lake issues</p>",
        "id": 319859835,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1673037729
    },
    {
        "content": "<p>It fails <em>only</em> with <code>lake exe cache get</code> -- will post the repo to GH.</p>",
        "id": 319869543,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673042056
    },
    {
        "content": "<p><a href=\"https://github.com/arienmalec/mwe\">https://github.com/arienmalec/mwe</a></p>",
        "id": 319875274,
        "sender_full_name": "Arien Malec",
        "timestamp": 1673044780
    },
    {
        "content": "<p>To make a mwe scratchpad I just use a <code>scratch</code> directory in mathlib4 BTW. I edit some file in .git (info/exclude maybe?) to make it not show up in VS Code git integration.</p>",
        "id": 319918301,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1673078956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"542196\">Arien Malec</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Starting.20a.20project.20with.20Mathlib4.20dependency.20fails.2E.2E.2E/near/319869543\">said</a>:</p>\n<blockquote>\n<p>It fails <em>only</em> with <code>lake exe cache get</code> -- will post the repo to GH.</p>\n</blockquote>\n<p>I too have a repository which fails with <code>lake exe cache get</code> and so does <span class=\"user-mention\" data-user-id=\"501683\">@Raghuram</span> (he mentioned this to me). For repos depending on mathlib4 <code>lake exe cache get</code> is not yet reliable.</p>",
        "id": 319918509,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1673079121
    }
]