---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/andThen.20operator.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html">andThen operator</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="299465479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299465479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299465479">(Sep 18 2022 at 18:40)</a>:</h4>
<p>Quick question: is there an operator in the std library that  implements this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">andThen</span> <span class="o">(</span><span class="n">f</span><span class="o">:</span> <span class="n">A</span> <span class="bp">-&gt;</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">B</span> <span class="bp">-&gt;</span> <span class="n">C</span><span class="o">):</span> <span class="n">A</span> <span class="bp">-&gt;</span> <span class="n">C</span> <span class="o">:=</span> <span class="n">g</span> <span class="bp">∘</span> <span class="n">f</span>
</code></pre></div>



<a name="299465737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299465737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299465737">(Sep 18 2022 at 18:44)</a>:</h4>
<p><code>f $ g x</code>, <code>f &lt;| g x</code>, <code>flip Function.comp</code> come to mind</p>



<a name="299465761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299465761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299465761">(Sep 18 2022 at 18:44)</a>:</h4>
<p>Is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∘</mo></mrow><annotation encoding="application/x-tex">\circ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord">∘</span></span></span></span> insufficient for what you want to do?</p>



<a name="299466021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466021">(Sep 18 2022 at 18:49)</a>:</h4>
<p>oh, it's just that oftentimes I find it easier to reason from left to right</p>



<a name="299466093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466093">(Sep 18 2022 at 18:50)</a>:</h4>
<p>Ah then the pipes that Henrik mentioned would be helpful: <code>|&gt;</code> and <code>&lt;|</code>.</p>



<a name="299466111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466111">(Sep 18 2022 at 18:50)</a>:</h4>
<p>yeah, I like those, but they require an argument.</p>



<a name="299466238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466238">(Sep 18 2022 at 18:52)</a>:</h4>
<p>The definition of function.comp also requires an argument, but it's supplied with a lambda.</p>



<a name="299466279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466279">(Sep 18 2022 at 18:53)</a>:</h4>
<p>Ah I see what you want here. Maybe we can use mathlib3's notation for composition of morphisms?</p>



<a name="299466301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466301">(Sep 18 2022 at 18:53)</a>:</h4>
<p><del>docs#quiver.hom.comp I think?</del></p>



<a name="299466401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466401">(Sep 18 2022 at 18:55)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/8c9342fd8949ec8421ed6649685d5233a19e0c08/src/category_theory/category/basic.lean#L84">https://github.com/leanprover-community/mathlib/blob/8c9342fd8949ec8421ed6649685d5233a19e0c08/src/category_theory/category/basic.lean#L84</a></p>



<a name="299466447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466447">(Sep 18 2022 at 18:55)</a>:</h4>
<p>Does haskell have a standard ascii symbol for this?</p>



<a name="299466510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466510">(Sep 18 2022 at 18:56)</a>:</h4>
<p>yeah, exactly!</p>



<a name="299466701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299466701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299466701">(Sep 18 2022 at 18:58)</a>:</h4>
<p>But <code> ≫ </code> probably will be used in mathlib 4 as well, so we'd need another symbol for  plain function composition, no?</p>



<a name="299467397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299467397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299467397">(Sep 18 2022 at 19:06)</a>:</h4>
<p>lol, a quick Hoogle query revealed &gt; 7 notations for this:<br>
<a href="https://hoogle.haskell.org/?hoogle=(a%20-%3E%20b)%20-%3E%20(b%20-%3E%20c)%20-%3E%20(a%20-%3E%20c)">https://hoogle.haskell.org/?hoogle=(a%20-%3E%20b)%20-%3E%20(b%20-%3E%20c)%20-%3E%20(a%20-%3E%20c)</a></p>



<a name="299467570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299467570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299467570">(Sep 18 2022 at 19:08)</a>:</h4>
<p>Unfortunately, I don't know enough about notation overloading in Lean4 to say whether we could use the same unicode symbol for both plain functions and morphisms in a category.</p>



<a name="299467779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299467779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299467779">(Sep 18 2022 at 19:11)</a>:</h4>
<p>We could make a notation that is smart enough for this type of stuff without difficulty yes.</p>



<a name="299467863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299467863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299467863">(Sep 18 2022 at 19:12)</a>:</h4>
<p>It might have some interesting interactions with type inference but generally speaking there is no obvious reason why it shouldn't work</p>



<a name="299469498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299469498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299469498">(Sep 18 2022 at 19:33)</a>:</h4>
<p>I was going to suggest <code>∘&gt;</code> which is similar to many of the haskell versions</p>



<a name="299475146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299475146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299475146">(Sep 18 2022 at 20:56)</a>:</h4>
<p>I personally question the need for all these fancy Haskell symbols especially now that Lean has <code>|&gt;</code>, <code>|&gt;.</code>, and <code>&lt;|</code>and <code>(&lt;- …)</code> which are intuitive to read and remember.  I remember when I was a Scala programmer, an experienced software engineer at my company saying that a lot of bad Scala code looks like “Haskell fan fiction”.  I feel having to memorize all the Haskell symbols adds a lot of cognitive burden.  Of course to each their own, and it is great that Lean lets you easily add in custom notation, especially for mathematics, where we need symbols to look like standard ones.  Anyway, as with what Kevin said, you can accomplish this in a readable way with a lambda at the cost of a few extra symbols (and then you can also use <code>|&gt;.</code> which is quite useful):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">11</span><span class="o">,</span><span class="mi">222</span><span class="o">]</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="bp">=&gt;</span>
    <span class="n">Int.ofNat</span> <span class="n">x</span>
    <span class="bp">|&gt;.</span><span class="n">mod</span> <span class="mi">10</span>
    <span class="bp">|&gt;</span> <span class="o">(</span><span class="bp">.</span> <span class="bp">-</span> <span class="mi">3</span><span class="o">)</span>
    <span class="bp">|&gt;</span> <span class="n">reprStr</span>
  <span class="o">)</span>  <span class="c1">-- ["-3", "-2", "-1"]</span>
</code></pre></div>



<a name="299475472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299475472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299475472">(Sep 18 2022 at 21:01)</a>:</h4>
<blockquote>
<p>I feel having to memorize all the Haskell symbols adds a lot of cognitive burden.</p>
</blockquote>
<p>I feel the same.</p>
<p>BTW, we don't need the parentheses around <code>fun</code> in Lean 4. We can write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">11</span><span class="o">,</span><span class="mi">222</span><span class="o">]</span><span class="bp">.</span><span class="n">map</span> <span class="k">fun</span> <span class="n">x</span> <span class="bp">=&gt;</span>
    <span class="n">Int.ofNat</span> <span class="n">x</span>
    <span class="bp">|&gt;.</span><span class="n">mod</span> <span class="mi">10</span>
    <span class="bp">|&gt;</span> <span class="o">(</span><span class="bp">.</span> <span class="bp">-</span> <span class="mi">3</span><span class="o">)</span>
    <span class="bp">|&gt;</span> <span class="n">reprStr</span>
</code></pre></div>



<a name="299479661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/andThen%20operator/near/299479661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Juan Pablo Romero <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/andThen.20operator.html#299479661">(Sep 18 2022 at 22:12)</a>:</h4>
<p>Agreed with symbol explosion in Haskell. In the Scala community there's been a big push to use symbolic operators much more judiciously in the past few years.  One major library  (ZIO) even removed <code>&gt;&gt;=</code>  recently, as it is totally alien to 99% of programmers.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>