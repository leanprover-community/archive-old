---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html">âœ” Lean 4 on M1 Mac</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="246829532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246829532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246829532">(Jul 22 2021 at 10:18)</a>:</h4>
<p>I'm trying to install Lean 4 on an M1 Mac (I already have Lean 3 setup). I tried following the <a href="https://leanprover.github.io/lean4/doc/quickstart.html">Quick Start</a> page and run:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">curl</span> <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">raw.githubusercontent.com</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">/</span><span class="n">elan</span><span class="bp">/</span><span class="n">master</span><span class="bp">/</span><span class="n">elan</span><span class="bp">-</span><span class="n">init.sh</span> <span class="bp">-</span><span class="n">sSf</span> <span class="bp">|</span> <span class="n">sh</span> <span class="bp">-</span><span class="n">s</span> <span class="c1">-- --default-toolchain leanprover/lean4:nightly</span>
</code></pre></div>
<p>But I get: <code>elan: unknown CPU type: arm64</code>.</p>
<p>Following the <a href="https://leanprover.github.io/lean4/doc/setup.html#basic-setup">Basic Setup</a> seems to work. That is, I can get <code>leanprover/lean4:stable</code> as the active toolchain:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">elan</span> <span class="k">show</span>
<span class="n">installed</span> <span class="n">toolchains</span>
<span class="c1">--------------------</span>

<span class="n">stable</span>
<span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">-</span><span class="n">lean</span><span class="bp">-</span><span class="mi">3</span><span class="bp">.</span><span class="mi">24</span><span class="bp">.</span><span class="mi">0</span>
<span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">lean</span><span class="o">:</span><span class="mi">3</span><span class="bp">.</span><span class="mi">27</span><span class="bp">.</span><span class="mi">0</span>
<span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable</span> <span class="o">(</span><span class="n">default</span><span class="o">)</span>

<span class="n">active</span> <span class="n">toolchain</span>
<span class="c1">----------------</span>

<span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable</span> <span class="o">(</span><span class="n">default</span><span class="o">)</span>
<span class="n">Lean</span> <span class="o">(</span><span class="n">version</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">-</span><span class="n">m2</span><span class="o">,</span> <span class="n">commit</span> <span class="mi">26</span><span class="n">dda3f63d88</span><span class="o">,</span> <span class="n">Release</span><span class="o">)</span>
</code></pre></div>
<p>But creating a new project via <code>leanpkg init</code> still uses Lean 3:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span><span class="o">:</span> <span class="n">leanpkg</span> <span class="n">init</span> <span class="n">test</span>
<span class="n">Move</span> <span class="n">existing</span> <span class="bp">.</span><span class="n">lean</span> <span class="n">files</span> <span class="n">into</span> <span class="n">the</span> <span class="bp">'</span><span class="n">src'</span> <span class="n">folder.</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">init</span> <span class="bp">-</span><span class="n">q</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="bp">-</span><span class="n">b</span> <span class="n">lean</span><span class="bp">-</span><span class="mi">3</span><span class="bp">.</span><span class="mi">30</span><span class="bp">.</span><span class="mi">0</span>
<span class="n">Switched</span> <span class="n">to</span> <span class="n">a</span> <span class="n">new</span> <span class="n">branch</span> <span class="bp">'</span><span class="n">lean</span><span class="bp">-</span><span class="mi">3</span><span class="bp">.</span><span class="mi">30</span><span class="bp">.</span><span class="mi">0</span><span class="bp">'</span>
<span class="n">configuring</span> <span class="n">test</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span>
</code></pre></div>
<p>This also matches the <code>lean -v</code>: <code>Lean (version 3.30.0, Release)</code>.</p>
<hr>
<p>Quite frankly, with <code>lean</code>, <code>elan</code>, <code>leanpkg</code> and <code>leanproject</code>, I'm massively confused about what each component does.<br>
What needs to be installed in order to get a working Lean 4 project?</p>



<a name="246829992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246829992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246829992">(Jul 22 2021 at 10:24)</a>:</h4>
<p>I think you need <code>elan override leanprover/lean4:stable</code> in your project directory</p>



<a name="246830062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830062">(Jul 22 2021 at 10:25)</a>:</h4>
<p>I'm guessing you mean <code>elan override set leanprover/lean4:stable</code>?</p>



<a name="246830066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830066">(Jul 22 2021 at 10:25)</a>:</h4>
<p>that locally overrides the <code>lean</code> executable in your directory (it's actually a symlink to <code>elan</code> which redirects to the right <code>lean</code> installation)</p>



<a name="246830077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830077">(Jul 22 2021 at 10:25)</a>:</h4>
<p>yes that</p>



<a name="246830102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830102">(Jul 22 2021 at 10:25)</a>:</h4>
<p>I think the problem is that I don't have a Lean 4 executable, because <code>curl https://raw.githubusercontent.com/leanprover/elan/master/elan-init.sh -sSf | sh -s -- --default-toolchain leanprover/lean4:nightly</code> failed.</p>



<a name="246830165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830165">(Jul 22 2021 at 10:26)</a>:</h4>
<p>You shouldn't use that line if you already have elan installed</p>



<a name="246830374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830374">(Jul 22 2021 at 10:28)</a>:</h4>
<p>Ok, so I'm in a directory <code>lean4test</code>. I do:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">marcus</span><span class="bp">@</span><span class="n">lean4test</span><span class="o">:</span> <span class="n">elan</span> <span class="n">override</span> <span class="n">set</span> <span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable</span>
<span class="n">info</span><span class="o">:</span> <span class="n">using</span> <span class="n">existing</span> <span class="n">install</span> <span class="n">for</span> <span class="bp">'</span><span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable'</span>
<span class="n">info</span><span class="o">:</span> <span class="n">override</span> <span class="n">toolchain</span> <span class="n">for</span> <span class="bp">'/</span><span class="n">Users</span><span class="bp">/</span><span class="n">marcus</span><span class="bp">/</span><span class="n">Arbeit</span><span class="bp">/</span><span class="n">lean4test'</span> <span class="n">set</span> <span class="n">to</span> <span class="bp">'</span><span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable'</span>

  <span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable</span> <span class="n">unchanged</span> <span class="bp">-</span> <span class="n">Lean</span> <span class="o">(</span><span class="n">version</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">-</span><span class="n">m2</span><span class="o">,</span> <span class="n">commit</span> <span class="mi">26</span><span class="n">dda3f63d88</span><span class="o">,</span> <span class="n">Release</span><span class="o">)</span>
</code></pre></div>
<p>Then:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">marcus</span><span class="bp">@</span><span class="n">lean4test</span><span class="o">:</span> <span class="n">leanpkg</span> <span class="n">init</span> <span class="n">lean4test</span>
<span class="n">Move</span> <span class="n">existing</span> <span class="bp">.</span><span class="n">lean</span> <span class="n">files</span> <span class="n">into</span> <span class="n">the</span> <span class="bp">'</span><span class="n">src'</span> <span class="n">folder.</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">init</span> <span class="bp">-</span><span class="n">q</span>
<span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="bp">-</span><span class="n">b</span> <span class="n">lean</span><span class="bp">-</span><span class="mi">3</span><span class="bp">.</span><span class="mi">30</span><span class="bp">.</span><span class="mi">0</span>
<span class="n">Switched</span> <span class="n">to</span> <span class="n">a</span> <span class="n">new</span> <span class="n">branch</span> <span class="bp">'</span><span class="n">lean</span><span class="bp">-</span><span class="mi">3</span><span class="bp">.</span><span class="mi">30</span><span class="bp">.</span><span class="mi">0</span><span class="bp">'</span>
<span class="n">configuring</span> <span class="n">lean4test</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span>
</code></pre></div>
<p>That still uses Lean 3 Â¯\_(ãƒ„)_/Â¯</p>



<a name="246830426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830426">(Jul 22 2021 at 10:29)</a>:</h4>
<p>The generated leanpkg.toml will take care of selecting the correct Lean version, no need for <code>override</code>. To select a custom version temporarily, use <code> leanpkg +leanprover/lean4:nightly init test</code>.</p>



<a name="246830556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830556">(Jul 22 2021 at 10:30)</a>:</h4>
<p>That command just prints the help screen for me:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">marcus</span><span class="bp">@</span><span class="n">lean4test</span><span class="o">:</span> <span class="n">leanpkg</span> <span class="bp">+</span><span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">stable</span> <span class="n">init</span> <span class="n">test</span>
<span class="n">Lean</span> <span class="n">package</span> <span class="n">manager</span><span class="o">,</span> <span class="n">version</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">30</span><span class="bp">.</span><span class="mi">0</span>

<span class="n">Usage</span><span class="o">:</span> <span class="n">leanpkg</span> <span class="bp">&lt;</span><span class="n">command</span><span class="bp">&gt;</span>

<span class="n">configure</span>              <span class="n">download</span> <span class="n">dependencies</span>
<span class="n">build</span> <span class="o">[</span><span class="c1">-- &lt;lean-args&gt;] download dependencies and build *.olean files</span>
<span class="n">test</span>  <span class="o">[</span><span class="c1">-- &lt;lean-args&gt;] download dependencies, build *.olean files, and run test files</span>

<span class="n">new</span> <span class="bp">&lt;</span><span class="n">dir</span><span class="bp">&gt;</span>              <span class="n">create</span> <span class="n">a</span> <span class="n">Lean</span> <span class="n">package</span> <span class="k">in</span> <span class="n">a</span> <span class="n">new</span> <span class="n">directory</span>
<span class="n">init</span> <span class="bp">&lt;</span><span class="n">name</span><span class="bp">&gt;</span>            <span class="n">create</span> <span class="n">a</span> <span class="n">Lean</span> <span class="n">package</span> <span class="k">in</span> <span class="n">the</span> <span class="n">current</span> <span class="n">directory</span>

<span class="n">add</span> <span class="bp">&lt;</span><span class="n">url</span><span class="bp">&gt;</span> <span class="o">[</span><span class="n">branch</span><span class="o">]</span>     <span class="n">add</span> <span class="n">a</span> <span class="n">dependency</span> <span class="k">from</span> <span class="n">a</span> <span class="n">git</span> <span class="n">repository</span> <span class="o">(</span><span class="n">uses</span> <span class="n">latest</span> <span class="n">upstream</span> <span class="n">revision</span><span class="o">)</span>
<span class="n">add</span> <span class="bp">&lt;</span><span class="n">dir</span><span class="bp">&gt;</span>              <span class="n">add</span> <span class="n">a</span> <span class="kn">local</span> <span class="n">dependency</span>
<span class="n">upgrade</span>                <span class="n">upgrade</span> <span class="n">all</span> <span class="n">git</span> <span class="n">dependencies</span> <span class="n">to</span> <span class="n">the</span> <span class="n">latest</span> <span class="n">upstream</span> <span class="n">version</span>

<span class="n">install</span> <span class="bp">&lt;</span><span class="n">url</span><span class="bp">&gt;</span> <span class="o">[</span><span class="n">branch</span><span class="o">]</span> <span class="n">install</span> <span class="n">a</span> <span class="n">user</span><span class="bp">-</span><span class="n">wide</span> <span class="n">package</span> <span class="k">from</span> <span class="n">git</span>
<span class="n">install</span> <span class="bp">&lt;</span><span class="n">dir</span><span class="bp">&gt;</span>          <span class="n">install</span> <span class="n">a</span> <span class="n">user</span><span class="bp">-</span><span class="n">wide</span> <span class="n">package</span> <span class="k">from</span> <span class="n">a</span> <span class="kn">local</span> <span class="n">directory</span>

<span class="n">dump</span>                   <span class="n">print</span> <span class="n">the</span> <span class="n">parsed</span> <span class="n">leanpkg.toml</span> <span class="n">file</span> <span class="o">(</span><span class="n">for</span> <span class="n">debugging</span><span class="o">)</span>

<span class="n">See</span> <span class="bp">`</span><span class="n">leanpkg</span> <span class="n">help</span> <span class="bp">&lt;</span><span class="n">command</span><span class="bp">&gt;`</span> <span class="n">for</span> <span class="n">more</span> <span class="n">information</span> <span class="n">on</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">command.</span>
</code></pre></div>



<a name="246830680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830680">(Jul 22 2021 at 10:32)</a>:</h4>
<p>Then your <code>leanpkg</code> is not from <code>elan</code>. Try <code>which leanpkg</code>.</p>



<a name="246830707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246830707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246830707">(Jul 22 2021 at 10:33)</a>:</h4>
<p>Ahhh, homebrew: <code>/opt/homebrew/bin/leanpkg</code></p>



<a name="246831477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246831477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246831477">(Jul 22 2021 at 10:42)</a>:</h4>
<p>Ok, so my <code>$PATH</code>had the following order: <code>/opt/homebrew/bin:/opt/homebrew/sbin:/Users/marcus/.elan</code>.<br>
Changing that order to <code>/Users/marcus/.elan:/opt/homebrew/bin:/opt/homebrew/sbin</code> fixed the problem :)</p>



<a name="246831515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%E2%9C%94%20Lean%204%20on%20M1%20Mac/near/246831515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.E2.9C.94.20Lean.204.20on.20M1.20Mac.html#246831515">(Jul 22 2021 at 10:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="372804">Marcus Rossel</span> has marked this topic as resolved.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>