---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/vectors.20in.20lean4.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html">vectors in lean4</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="286927235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/286927235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#286927235">(Jun 21 2022 at 15:04)</a>:</h4>
<p>In the "Theorem proving with Lean4" book there is an inductive for Vectors in the section on "Inductive families".  I looked at the standard library but no vectors there.  Did someone tried to implement the basic operations on vectors : append, fromList, toList, etc. ? I must confess I am stuck with these basic things.</p>



<a name="286934074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/286934074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#286934074">(Jun 21 2022 at 15:47)</a>:</h4>
<p>The area you are talking about are so called "length indexed lists" (indexed is a type theory, not a list term here), the standard library is however just a piece of code that the compiler requires in order to bootstrap itself right now so don't expect too fancy things from it. I have a few operations I translated from the coq code in CPDT (this book: <a href="http://adam.chlipala.net/cpdt/cpdt.pdf">http://adam.chlipala.net/cpdt/cpdt.pdf</a>) here: <a href="https://github.com/hargoniX/cpdt-lean/blob/main/Cpdt/Chapter8/LengthIndexed.lean">https://github.com/hargoniX/cpdt-lean/blob/main/Cpdt/Chapter8/LengthIndexed.lean</a> but nothing too fancy.</p>
<p>If you have more concrete questions just ask here, we're happy to help.</p>



<a name="287030309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287030309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287030309">(Jun 22 2022 at 09:54)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="395550">@Henrik Böving</span> this gives me a starting point ... I see that subtypes could be useful ...</p>



<a name="287289598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287289598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287289598">(Jun 24 2022 at 05:02)</a>:</h4>
<p>I've a follow-up question/kind of in the same spirit. If I wanted to express more complex properties in the type like this, say, for ordered lists, is there a way to encode it in the type, the same way? My  naive attempt at this doesn't work</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">OrderedList</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span>
  <span class="bp">|</span> <span class="n">OrderedNil</span> <span class="o">:</span> <span class="n">OrderedList</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">OrederedCons</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">OrderedList</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="k">match</span> <span class="n">as</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">OrderedNil</span> <span class="bp">=&gt;</span> <span class="n">True</span> <span class="bp">|</span> <span class="n">OrderedCons</span> <span class="n">b</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>
<p>I suppose that the construction isn't in scope yet in its own constraint. Is there a way to express a constraint like this? I suppose I can "split it up" like so</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">OrderedList</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">b</span><span class="o">::</span><span class="n">rest</span> <span class="bp">=&gt;</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="n">OrderedList</span> <span class="n">α</span> <span class="o">(</span><span class="n">b</span><span class="o">::</span><span class="n">rest</span><span class="o">)</span>
  <span class="bp">|</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">True</span>
</code></pre></div>
<p>But that's somewhat unsatisfactory, as we don't get the same types of guarantees with the type as we do for length-indexed lists (i.e. correct by construction)</p>



<a name="287298292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287298292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287298292">(Jun 24 2022 at 07:25)</a>:</h4>
<p>If you define a notion of membership for a list like mathlib (<a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.Mem#doc">docs4#List.Mem</a>) you can (in the cons case) say something like <code>(h : ∀ y, y ∈ as → a ≤ y)
</code></p>



<a name="287315070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287315070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Evgeniy Kuznetsov <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287315070">(Jun 24 2022 at 10:41)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">OrderedList'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]:</span> <span class="n">Option</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">nil</span><span class="o">:</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="bp">.</span><span class="n">none</span>
<span class="bp">|</span> <span class="n">cons_nil</span>  <span class="o">(</span><span class="n">a</span><span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span><span class="o">:</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="bp">$</span> <span class="bp">.</span><span class="n">none</span>  <span class="o">)</span>           <span class="o">:</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="o">(</span><span class="bp">.</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">cons_cons</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span><span class="o">:</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="bp">$</span> <span class="bp">.</span><span class="n">some</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">_</span><span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">):</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="o">(</span><span class="bp">.</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">OrderedList</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:=</span> <span class="o">(</span><span class="n">head</span><span class="o">:</span> <span class="n">Option</span> <span class="n">α</span><span class="o">)</span> <span class="bp">×</span> <span class="n">OrderedList'</span> <span class="n">α</span> <span class="n">head</span>
</code></pre></div>



<a name="287338793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287338793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287338793">(Jun 24 2022 at 14:35)</a>:</h4>
<p>ahh, you're "remembering" the item at the head with the type, that's a really cool solution!</p>



<a name="287359513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287359513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287359513">(Jun 24 2022 at 17:19)</a>:</h4>
<p>What is the problem with defining inductively a Prop that the list is ordered and then OrderedList is just a Subtype of List?</p>
<p>The only complicated thing is how to write a match statements with this type. You definitely want to match on the List and the Prop at the same time.</p>



<a name="287383617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287383617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> François G. Dorais <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287383617">(Jun 24 2022 at 20:52)</a>:</h4>
<p>You can try using <code>@[matchPattern]</code> to define your own patterns:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">List.precede</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="o">[]</span> <span class="bp">=&gt;</span> <span class="n">True</span>
<span class="bp">|</span> <span class="n">y</span><span class="o">::</span><span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">y</span>

<span class="kd">inductive</span> <span class="n">IsOrdered</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">IsOrdered</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">cons</span> <span class="o">{</span><span class="n">x</span> <span class="n">xs</span><span class="o">}</span> <span class="o">:</span> <span class="n">List.precede</span> <span class="n">x</span> <span class="n">xs</span> <span class="bp">→</span> <span class="n">IsOrdered</span> <span class="n">xs</span> <span class="bp">→</span> <span class="n">IsOrdered</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">OrderedList</span> <span class="o">(</span><span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:=</span> <span class="o">(</span><span class="n">xs</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">×</span> <span class="n">IsOrdered</span> <span class="n">xs</span>

<span class="kd">@[matchPattern]</span>
<span class="kd">def</span> <span class="n">OrderedList.nil</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">OrderedList</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨[],</span> <span class="n">IsOrdered.nil</span><span class="o">⟩</span>

<span class="kd">@[matchPattern]</span>
<span class="kd">def</span> <span class="n">OrderedList.cons</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">xs</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">List.precede</span> <span class="n">x</span> <span class="n">xs</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">IsOrdered</span> <span class="n">xs</span><span class="o">)</span> <span class="o">:</span> <span class="n">OrderedList</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">,</span> <span class="n">IsOrdered.cons</span> <span class="n">h</span> <span class="n">hs</span><span class="o">⟩</span>

<span class="kd">def</span> <span class="n">matchTest</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">LE</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">OrderedList</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">Nat</span>
<span class="bp">|</span> <span class="n">OrderedList.nil</span> <span class="bp">=&gt;</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">OrderedList.cons</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="mi">0</span>
</code></pre></div>



<a name="287415080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/287415080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#287415080">(Jun 25 2022 at 05:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="346070">Tomas Skrivan</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/287359513">said</a>:</p>
<blockquote>
<p>What is the problem with defining inductively a Prop that the list is ordered and then OrderedList is just a Subtype of List?</p>
<p>The only complicated thing is how to write a match statements with this type.</p>
</blockquote>
<p>This is the big problem with subtypes (and propositions in general) when it comes to programming. Most natural pattern matching, structural recursion, type class deriving (e.g., <code>Inhabited</code>), namespacing, etc. is broken and thus requires lots of proving and other manual work to fix (instead of things "just working").</p>
<p>Don't get me wrong the tools (subtypes and proofs) are powerful, they are just often best reserved for when they are needed and use other, more convenient, approaches when possible (in the programming context at least).</p>



<a name="288040086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288040086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288040086">(Jun 30 2022 at 14:52)</a>:</h4>
<p>I played a little bit more with vectors, still based on the following definition :</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Vector</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span> <span class="n">where</span>
  <span class="bp">|</span> <span class="n">vnil</span>  <span class="o">:</span> <span class="n">Vector</span> <span class="n">A</span> <span class="mi">0</span>
  <span class="bp">|</span> <span class="n">vcons</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>
   <span class="n">deriving</span> <span class="n">Repr</span>
</code></pre></div>
<p>... I have something I don't undestand perfectly below:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">vindex</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="o">(</span><span class="n">fin</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="o">(</span><span class="n">fin</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="o">(⟨</span><span class="mi">0</span><span class="o">,</span><span class="n">_</span><span class="o">⟩</span> <span class="o">,</span> <span class="n">vcons</span> <span class="n">e</span> <span class="n">_</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">e</span>
  <span class="bp">|</span> <span class="o">(⟨</span><span class="n">m</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span><span class="n">hk</span><span class="o">⟩,</span> <span class="n">vcons</span> <span class="n">_</span> <span class="n">v'</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">vindex</span> <span class="o">⟨</span><span class="n">m</span><span class="o">,</span><span class="kd">by</span> <span class="n">apply</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="bp">;</span> <span class="n">exact</span> <span class="n">hk</span><span class="o">⟩</span> <span class="n">v'</span>
</code></pre></div>
<p>Seems fine (from my naive point of view)...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="mi">4</span> <span class="o">:=</span> <span class="n">vcons</span> <span class="mi">1</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">2</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">3</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">4</span> <span class="n">vnil</span><span class="o">)))</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">2</span> <span class="n">v4</span> <span class="c1">-- =&gt; 3</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">3</span> <span class="n">v4</span> <span class="c1">-- =&gt; 4</span>
</code></pre></div>
<p>But ... oops</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">4</span> <span class="n">v4</span> <span class="c1">-- =&gt; 1</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">5</span> <span class="n">v4</span> <span class="c1">-- =&gt; 2</span>
</code></pre></div>
<p>... not exactly what I intended <span aria-label="smiling face" class="emoji emoji-263a" role="img" title="smiling face">:smiling_face:</span> <br>
Could someone explain me what happens here (probably this is not the <code>Fin</code> I imagined) ?<br>
Also if you have a better proposition for <code>vindex</code> I would be interested</p>



<a name="288041048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288041048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288041048">(Jun 30 2022 at 14:59)</a>:</h4>
<p>Literals for <code>Fin n</code> are interpreted modulo <code>n</code>. So <code>4 : Fin 4</code> is 0, <code>5 : Fin 4</code>is 1. Arguably Lean should throw an error instead, but that doesn't play well with how these literals are implemented.</p>



<a name="288056163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288056163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288056163">(Jun 30 2022 at 16:47)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="256311">@Jannis Limperg</span>  I understand now the issue.  Probably I will play a little bit with a variant, such as <code>Bound n</code>  with the behavior I'm expecting   (a type error).   However then I don't really understand when one would like to use <code>Fin</code> (at least in my understanding on why and when it's useful...).</p>



<a name="288057686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288057686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288057686">(Jun 30 2022 at 16:59)</a>:</h4>
<p>When you want to make mathematical arguments about numbers mod n of course.</p>



<a name="288058327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288058327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288058327">(Jun 30 2022 at 17:03)</a>:</h4>
<p>There are two potentially separate problems at play here:</p>
<ol>
<li>What should <code>5 : fin 4</code> parse as?</li>
<li>What is the value of <code>(3 : fin 4) + (2 : fin 4)</code>?</li>
</ol>
<p>I think there are technical limitations which make  it hard to emit an error for <code>1</code>, while 2 is chosen because it's as good an option as any</p>



<a name="288059612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288059612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288059612">(Jun 30 2022 at 17:13)</a>:</h4>
<p>... and then maybe <code>(Mod n)</code> would be a better name ?   (Fin is already quite connoted in dependent type theory, no ?)</p>



<a name="288061363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288061363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288061363">(Jun 30 2022 at 17:27)</a>:</h4>
<p>We should have a glossary or faq entry for the nuances of fin, vs bounded (unallowed) finite numbers, vs ones with saturated ops, etc.</p>



<a name="288084871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288084871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288084871">(Jun 30 2022 at 20:44)</a>:</h4>
<p>It should also be noted that <code>Fin</code> is used to implemented native fixed-sized (finite) unsigned integers -- <code>UInt8</code>, <code>UInt16</code>, <code>UInt32</code>, <code>UInt64</code>. Mathematically, though, that is also just modular arithmetic (assuming wrapping  under/overflow as opposed to trapping under/overflow), so the name <code>Mod n</code> would still fit there too.</p>



<a name="288090306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288090306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288090306">(Jun 30 2022 at 21:32)</a>:</h4>
<p>Also when indexing arrays shouldn't we use some variant of <code>Fin n</code> that is based on <code>USize</code> instead of <code>Nat</code>. Why pay for arbitrary large integers if they can be a meaningful memory address?</p>



<a name="288099447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288099447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288099447">(Jun 30 2022 at 23:04)</a>:</h4>
<p><span class="user-mention" data-user-id="346070">@Tomas Skrivan</span> <code>Nat</code> only uses arbitrary-sized integers if the value is over a certain threshold (e.g., word-size - 1 bits) otherwise it only consumes one word. Also, many of the <code>Array</code> functions do take advantage of the fact that Arrays are at max <code>USize</code>. There is even a variant of <code>Array.get</code> that does just that (<code>Array.uget</code>).</p>



<a name="288099602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288099602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288099602">(Jun 30 2022 at 23:05)</a>:</h4>
<p>Sure, but if you look at the generated C code then <code>Nat</code> gets passed through a pointer but <code>USize</code> is passed by value.</p>



<a name="288099641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288099641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288099641">(Jun 30 2022 at 23:05)</a>:</h4>
<p>One of the advantages of the <code>Conditional</code> <a href="#narrow/stream/270676-lean4/topic/String.2EgetOp/near/287930524">approach</a> <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> suggested for <code>getOp</code> is that it could use <code>USize</code> instead of <code>Fin</code> for <code>Array</code> indexing.</p>



<a name="288099736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288099736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288099736">(Jun 30 2022 at 23:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="346070">Tomas Skrivan</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/288099602">said</a>:</p>
<blockquote>
<p>Sure, but if you look at the generated C code then <code>Nat</code> gets passed through a pointer but <code>USize</code> is passed by value.</p>
</blockquote>
<p>The <code>lean_object*</code> is not actually always a pointer. It can actually be either <code>lean_object*</code> OR a raw <code>Nat</code> (if the lower order bit is 1).</p>



<a name="288099863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288099863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288099863">(Jun 30 2022 at 23:08)</a>:</h4>
<p>Such a pointer trick is actually a familiar idea in language design (e.g., Ruby's C implementation does a similar trick for <code>Fixnum</code>, <code>True</code>, <code>False</code>, and <code>Nil</code>).</p>



<a name="288100496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288100496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288100496">(Jun 30 2022 at 23:17)</a>:</h4>
<p>Ohh I was not aware of that. I saw the pointer and updates on the reference counter in the C code. Assumed that it is not ideal and should use <code>USize</code> instead.</p>



<a name="288102986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288102986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe Hendrix <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288102986">(Jun 30 2022 at 23:50)</a>:</h4>
<p>I have a simple vector datatype used for a Lean crypto library that I am working on in my spare time.  Polymorphic vectors are in this <a href="https://github.com/joehendrix/lean-crypto/blob/main/lib/Crypto/Vector.lean">file</a>, and are a subtype of Array.  There's also byte vectors and bitvectors (which use <code>Fin</code>).</p>



<a name="288103035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288103035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe Hendrix <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288103035">(Jun 30 2022 at 23:51)</a>:</h4>
<p>It'd be nice to have a rich set of linear algebra operations and transforms such as scans for array-oriented programming.</p>



<a name="288165817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288165817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288165817">(Jul 01 2022 at 13:01)</a>:</h4>
<p>Here's an ugly version ...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">vindex</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">:</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="bp">→</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span> <span class="n">A</span>
  <span class="bp">|</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="mi">0</span><span class="o">,</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="n">vcons</span> <span class="n">e</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">e</span>
  <span class="bp">|</span> <span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">m</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="n">vcons</span> <span class="n">_</span> <span class="n">v'</span> <span class="bp">=&gt;</span> <span class="k">let</span> <span class="n">p'</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="bp">;</span> <span class="n">assumption</span>
                                  <span class="bp">@</span><span class="n">vindex</span> <span class="n">_</span> <span class="n">_</span> <span class="n">m</span> <span class="n">p'</span> <span class="n">v'</span>

<span class="kd">def</span> <span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="mi">4</span> <span class="o">:=</span> <span class="n">vcons</span> <span class="mi">1</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">2</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">3</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">4</span> <span class="n">vnil</span><span class="o">)))</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">2</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="n">v</span> <span class="c1">-- =&gt; 3</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">3</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="n">v</span> <span class="c1">-- =&gt; 4</span>

<span class="k">#check</span> <span class="n">vindex</span> <span class="mi">4</span> <span class="n">_</span> <span class="n">v</span> <span class="c1">-- crash !</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">Error</span> <span class="bp">-</span> <span class="mi">14</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">12</span><span class="o">]</span> <span class="n">Request</span> <span class="n">textDocument</span><span class="bp">/</span><span class="n">foldingRange</span> <span class="n">failed.</span>
  <span class="n">Message</span><span class="o">:</span> <span class="n">Server</span> <span class="n">process</span> <span class="n">for</span> <span class="n">file</span><span class="o">:</span><span class="bp">///&lt;...&gt;/</span><span class="n">Vectors.lean</span> <span class="n">crashed</span><span class="o">,</span> <span class="n">likely</span> <span class="n">due</span> <span class="n">to</span> <span class="n">a</span> <span class="n">stack</span> <span class="n">overflow</span> <span class="k">in</span> <span class="n">user</span> <span class="n">code.</span>
  <span class="n">Code</span><span class="o">:</span> <span class="bp">-</span><span class="mi">32603</span>
</code></pre></div>



<a name="288165908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288165908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288165908">(Jul 01 2022 at 13:02)</a>:</h4>
<p>(no need to say that I navigate by sight <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> )</p>



<a name="288166978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288166978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288166978">(Jul 01 2022 at 13:11)</a>:</h4>
<p><span class="user-mention" data-user-id="506086">@Frederic Peschanski</span> Could you please try the Lean latest nightly build? If it does not fix the problem, could you please create a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?<br>
I tried the following using the code fragments above, and it works in the latest nightly build</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Vector</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span> <span class="n">where</span>
  <span class="bp">|</span> <span class="n">vnil</span>  <span class="o">:</span> <span class="n">Vector</span> <span class="n">A</span> <span class="mi">0</span>
  <span class="bp">|</span> <span class="n">vcons</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>
   <span class="n">deriving</span> <span class="n">Repr</span>

<span class="kn">namespace</span> <span class="n">Vector</span>

<span class="kd">def</span> <span class="n">vindex</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">:</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="bp">→</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span> <span class="n">A</span>
  <span class="bp">|</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="mi">0</span><span class="o">,</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="n">vcons</span> <span class="n">e</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">e</span>
  <span class="bp">|</span> <span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">m</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="bp">.</span><span class="o">(</span><span class="n">_</span><span class="o">),</span> <span class="n">vcons</span> <span class="n">_</span> <span class="n">v'</span> <span class="bp">=&gt;</span> <span class="k">let</span> <span class="n">p'</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="bp">;</span> <span class="n">assumption</span>
                                  <span class="bp">@</span><span class="n">vindex</span> <span class="n">_</span> <span class="n">_</span> <span class="n">m</span> <span class="n">p'</span> <span class="n">v'</span>

<span class="kd">def</span> <span class="n">v</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="mi">4</span> <span class="o">:=</span> <span class="n">vcons</span> <span class="mi">1</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">2</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">3</span> <span class="o">(</span><span class="n">vcons</span> <span class="mi">4</span> <span class="n">vnil</span><span class="o">)))</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">2</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="n">v</span> <span class="c1">-- =&gt; 3</span>
<span class="k">#eval</span> <span class="n">vindex</span> <span class="mi">3</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="n">v</span> <span class="c1">-- =&gt; 4</span>

<span class="k">#check</span> <span class="n">vindex</span> <span class="mi">4</span> <span class="n">_</span> <span class="n">v</span> <span class="c1">-- vindex 4 ?m v : Nat</span>
</code></pre></div>



<a name="288171588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/288171588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frederic Peschanski <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#288171588">(Jul 01 2022 at 13:48)</a>:</h4>
<p><span class="user-mention" data-user-id="112857">@Leonardo de Moura</span> I've just <code>elan update</code>'d and I can confirm it does not crash anymore with <code>4.0.0-nightly-2022-07-01</code>, sorry for the false alarm.</p>



<a name="291113711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291113711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> cognivore <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291113711">(Jul 27 2022 at 21:36)</a>:</h4>
<p>(deleted)</p>



<a name="291425908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291425908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291425908">(Jul 30 2022 at 12:17)</a>:</h4>
<p>Vector isn't in Lean 4 yet</p>



<a name="291425915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291425915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291425915">(Jul 30 2022 at 12:17)</a>:</h4>
<p>Is contribution welcome or not (adding Vector to Init.Data.Vector)?</p>



<a name="291425992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291425992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291425992">(Jul 30 2022 at 12:19)</a>:</h4>
<p>Contributions to the Core libraries are in general not welcome unless the additions are required for something in the compilers since the todo list of the compiler team is overhelming already. You can contribute it to mathlib4 though</p>



<a name="291426046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426046">(Jul 30 2022 at 12:20)</a>:</h4>
<p>mathlib still don't have Vector? I was suprised</p>



<a name="291426066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426066">(Jul 30 2022 at 12:21)</a>:</h4>
<p>oh I think Github added a "clone master branch only" (option) when forking</p>



<a name="291426120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426120">(Jul 30 2022 at 12:22)</a>:</h4>
<p>Mathlib4 is still very rudimentary at this point.</p>
<p>Such PRs are also welcome here: <a href="https://github.com/yatima-inc/YatimaStdLib.lean">https://github.com/yatima-inc/YatimaStdLib.lean</a>. We're focusing on algorithms and data structures, mostly</p>



<a name="291426188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426188">(Jul 30 2022 at 12:24)</a>:</h4>
<p>What's Yamata Inc?</p>



<a name="291426284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426284">(Jul 30 2022 at 12:27)</a>:</h4>
<p><a href="https://github.blog/changelog/2022-07-27-you-can-now-fork-a-repo-and-copy-only-the-default-branch/">https://github.blog/changelog/2022-07-27-you-can-now-fork-a-repo-and-copy-only-the-default-branch/</a></p>



<a name="291426289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426289">(Jul 30 2022 at 12:27)</a>:</h4>
<p>I have a bad feeling about this</p>



<a name="291426357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426357">(Jul 30 2022 at 12:29)</a>:</h4>
<p>Why? Big projects tend to have 100s of branches and if you need any of them you can still fetch them from the other remote regardless</p>



<a name="291426430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426430">(Jul 30 2022 at 12:30)</a>:</h4>
<p><span class="user-mention" data-user-id="515610">@Locria Cyber</span> Yatima Inc is an R&amp;D company lead by <span class="user-mention" data-user-id="432681">@John Burnham</span> that develops open source technology, currently using Lean 4 in its stack</p>



<a name="291426755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426755">(Jul 30 2022 at 12:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291426357">said</a>:</p>
<blockquote>
<p>Why? Big projects tend to have 100s of branches and if you need any of them you can still fetch them from the other remote regardless</p>
</blockquote>
<p>It's on github clone, not github to local.</p>
<p>Maybe Github is paving the way for its clound-based "workspace".</p>



<a name="291426872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426872">(Jul 30 2022 at 12:40)</a>:</h4>
<p>Also, I had some trouble here. Seems like <code>::</code> and <code>[term*]</code>must be a typeclass in core for this to work</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Vector</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span>
  <span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">α</span> <span class="mi">0</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">α</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Vector</span> <span class="n">α</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>

<span class="kd">infix</span><span class="o">:</span><span class="mi">67</span> <span class="s2">" :: "</span> <span class="bp">=&gt;</span> <span class="n">Vector.cons</span>

<span class="kd">def</span> <span class="n">a</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">::</span> <span class="n">Vector.nil</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">ambiguous</span><span class="o">,</span> <span class="n">possible</span> <span class="n">interpretations</span>
  <span class="mi">1</span> <span class="o">::</span> <span class="n">Vector.nil</span> <span class="o">:</span> <span class="n">Vector</span> <span class="bp">?</span><span class="n">m.1893</span> <span class="o">(</span><span class="bp">?</span><span class="n">m.1894</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>

  <span class="mi">1</span> <span class="o">::</span> <span class="bp">?</span><span class="n">m.1958</span> <span class="o">:</span> <span class="n">List</span> <span class="bp">?</span><span class="n">m.1914</span>
</code></pre></div>



<a name="291426933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291426933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291426933">(Jul 30 2022 at 12:41)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">a</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="n">_</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">::</span> <span class="n">Vector.nil</span>
</code></pre></div>
<p>error:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">don't</span> <span class="n">know</span> <span class="n">how</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">placeholder</span>
<span class="n">context</span><span class="o">:</span>
<span class="bp">⊢</span> <span class="n">Nat</span>
<span class="n">when</span> <span class="n">the</span> <span class="n">resulting</span> <span class="n">type</span> <span class="n">of</span> <span class="n">a</span> <span class="n">declaration</span> <span class="n">is</span> <span class="n">explicitly</span> <span class="n">provided</span><span class="o">,</span> <span class="n">all</span> <span class="n">holes</span> <span class="o">(</span><span class="n">e.g.</span><span class="o">,</span> <span class="bp">`</span><span class="n">_</span><span class="bp">`</span><span class="o">)</span> <span class="k">in</span> <span class="n">the</span> <span class="n">header</span> <span class="n">are</span> <span class="n">resolved</span> <span class="n">before</span> <span class="n">the</span> <span class="n">declaration</span> <span class="n">body</span> <span class="n">is</span> <span class="n">processed</span>
</code></pre></div>



<a name="291427025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291427025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291427025">(Jul 30 2022 at 12:42)</a>:</h4>
<p>I do need to unify <code>a</code>'s type with declaration though.</p>



<a name="291427151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291427151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291427151">(Jul 30 2022 at 12:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291426933">said</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">a</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="n">_</span> <span class="o">:=</span> <span class="mi">1</span> <span class="o">::</span> <span class="n">Vector.nil</span>
</code></pre></div>
<p>error:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">don't</span> <span class="n">know</span> <span class="n">how</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">placeholder</span>
<span class="n">context</span><span class="o">:</span>
<span class="bp">⊢</span> <span class="n">Nat</span>
<span class="n">when</span> <span class="n">the</span> <span class="n">resulting</span> <span class="n">type</span> <span class="n">of</span> <span class="n">a</span> <span class="n">declaration</span> <span class="n">is</span> <span class="n">explicitly</span> <span class="n">provided</span><span class="o">,</span> <span class="n">all</span> <span class="n">holes</span> <span class="o">(</span><span class="n">e.g.</span><span class="o">,</span> <span class="bp">`</span><span class="n">_</span><span class="bp">`</span><span class="o">)</span> <span class="k">in</span> <span class="n">the</span> <span class="n">header</span> <span class="n">are</span> <span class="n">resolved</span> <span class="n">before</span> <span class="n">the</span> <span class="n">declaration</span> <span class="n">body</span> <span class="n">is</span> <span class="n">processed</span>
</code></pre></div><br>
</p>
</blockquote>
<p>This is the way it is supposed to work, the idea is that if you explicitly denote the type of <code>a</code> you are supposed to provide all arguments to that type explicitly which is a good thing IMO, if you are doing an explicit type you should go through with it</p>



<a name="291427291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291427291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291427291">(Jul 30 2022 at 12:49)</a>:</h4>
<p>what if I do want to get the length from compiler?</p>



<a name="291427655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291427655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291427655">(Jul 30 2022 at 12:57)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">a</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">::</span> <span class="n">Vector.nil</span> <span class="o">:</span> <span class="n">Vector</span> <span class="n">Nat</span> <span class="n">_</span><span class="o">)</span>
</code></pre></div>
<p>this would work as long as <code>::</code> isn't TC</p>



<a name="291428413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428413">(Jul 30 2022 at 13:14)</a>:</h4>
<p>thanks</p>



<a name="291428453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428453">(Jul 30 2022 at 13:14)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">h</span><span class="o">:</span> <span class="n">a</span> <span class="o">::</span> <span class="n">as</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">::</span> <span class="n">bs</span>
<span class="n">habs'</span><span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span>
<span class="bp">⊢</span> <span class="n">as</span> <span class="bp">=</span> <span class="n">bs</span>
</code></pre></div>



<a name="291428457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428457">(Jul 30 2022 at 13:14)</a>:</h4>
<p>question: how do I prove this?</p>



<a name="291428478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428478">(Jul 30 2022 at 13:15)</a>:</h4>
<p><code>::</code> is the constructor for Vect</p>



<a name="291428552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428552">(Jul 30 2022 at 13:16)</a>:</h4>
<p>by injectivity of constructor applications:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span> <span class="n">bs</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">a</span> <span class="o">::</span> <span class="n">as</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">::</span> <span class="n">bs</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">as</span> <span class="bp">=</span> <span class="n">bs</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">injection</span> <span class="n">h1</span>
  <span class="n">assumption</span>
</code></pre></div>



<a name="291428795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428795">(Jul 30 2022 at 13:22)</a>:</h4>
<p>thanks!</p>



<a name="291428804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291428804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291428804">(Jul 30 2022 at 13:22)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">SizeOf</span> <span class="o">(</span><span class="n">Vect</span> <span class="n">α</span> <span class="n">n</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">sizeOf</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">n</span>
</code></pre></div>
<p>Is this a correct use of <code>SizeOf</code>?</p>



<a name="291429028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429028">(Jul 30 2022 at 13:29)</a>:</h4>
<p>Lean should have already synthesized a SizeOf instance for you automatically that does at least yield the same result though via structural recursion instead of directly getting the <code>n</code> argument.</p>



<a name="291429126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429126">(Jul 30 2022 at 13:31)</a>:</h4>
<p>ok</p>



<a name="291429127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429127">(Jul 30 2022 at 13:31)</a>:</h4>
<p>Ah actually no it didnt</p>



<a name="291429134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429134">(Jul 30 2022 at 13:32)</a>:</h4>
<p>I think by default it's all 0</p>



<a name="291429178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429178">(Jul 30 2022 at 13:32)</a>:</h4>
<p>Also, why is <code>Fin</code> so complicated?</p>



<a name="291429190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429190">(Jul 30 2022 at 13:32)</a>:</h4>
<p>In Idris2, all the data types are their own type, and it's easier to reason about.</p>



<a name="291429193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429193">(Jul 30 2022 at 13:33)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">don't</span> <span class="n">know</span> <span class="n">how</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">placeholder</span> <span class="n">for</span> <span class="n">argument</span> <span class="bp">'</span><span class="n">isLt'</span>
<span class="n">context</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span>
<span class="n">n</span><span class="bp">✝</span> <span class="o">:</span> <span class="n">Nat</span>
<span class="n">x</span> <span class="o">:</span> <span class="n">α</span>
<span class="n">xs</span> <span class="o">:</span> <span class="n">Vect</span> <span class="n">α</span> <span class="n">n</span><span class="bp">✝</span>
<span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span>
<span class="n">prf</span> <span class="o">:</span> <span class="n">Nat.succ</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="bp">✝</span> <span class="bp">+</span> <span class="mi">1</span>
<span class="n">value</span> <span class="o">:</span> <span class="n">α</span>
<span class="bp">⊢</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="bp">✝</span>
</code></pre></div>



<a name="291429209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429209">(Jul 30 2022 at 13:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429134">said</a>:</p>
<blockquote>
<p>I think by default it's all 0</p>
</blockquote>
<p>That is not correct, yes the default SizeOf instance is <code>0</code> but lean generate an additional SizeOf instance for all inductive and structure declarations automatically while elaborating them, in the case of your Vector this is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Vector.rec</span> <span class="mi">1</span> <span class="o">(</span><span class="k">fun</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="n">a</span> <span class="n">a_1</span> <span class="n">a_ih</span> <span class="bp">=&gt;</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">sizeOf</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">sizeOf</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">a_ih</span><span class="o">)</span> <span class="n">t</span>
</code></pre></div>



<a name="291429262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429262">(Jul 30 2022 at 13:34)</a>:</h4>
<p>ok</p>



<a name="291429287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429287">(Jul 30 2022 at 13:35)</a>:</h4>
<p>Maybe I should make Nat literal its own type class, and make a new simpler <code>Fin</code>.</p>



<a name="291429289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429289">(Jul 30 2022 at 13:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429178">said</a>:</p>
<blockquote>
<p>Also, why is <code>Fin</code> so complicated?</p>
</blockquote>
<p><code>Fin</code> isn't complicated its definition is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">val</span>  <span class="o">:</span> <span class="n">Nat</span>
  <span class="n">isLt</span> <span class="o">:</span> <span class="n">LT.lt</span> <span class="n">val</span> <span class="n">n</span>
</code></pre></div>
<p>which is pretty printed more like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">val</span>  <span class="o">:</span> <span class="n">Nat</span>
  <span class="n">isLt</span> <span class="o">:</span> <span class="n">val</span> <span class="bp">&lt;</span> <span class="n">n</span>
</code></pre></div>
<p>It's just that arguing about <code>Fin</code> while doing recursion on the <code>n</code> argument is icky</p>



<a name="291429292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429292">(Jul 30 2022 at 13:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429287">said</a>:</p>
<blockquote>
<p>Maybe I should make Nat literal its own type class, and make a new simpler <code>Fin</code>.</p>
</blockquote>
<p>Nat literals are already managed by the <code>OfNat</code> typeclass</p>



<a name="291429342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429342">(Jul 30 2022 at 13:36)</a>:</h4>
<p>interesting</p>



<a name="291429350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429350">(Jul 30 2022 at 13:36)</a>:</h4>
<p>your goal earlier should be something like <code>Nat.lt_of_succ_lt_succ prf</code></p>



<a name="291429352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429352">(Jul 30 2022 at 13:36)</a>:</h4>
<p>Here's <code>Fin</code> in Idris2:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">data</span> <span class="n">Data.Fin.Fin</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="kt">Type</span>
  <span class="n">Numbers</span> <span class="n">strictly</span> <span class="n">less</span> <span class="n">than</span> <span class="n">some</span> <span class="n">bound.</span> <span class="n">The</span> <span class="n">name</span> <span class="n">comes</span> <span class="k">from</span> <span class="s2">"finite sets"</span><span class="bp">.</span>

  <span class="n">It's</span> <span class="n">probably</span> <span class="n">not</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">use</span> <span class="bp">`</span><span class="n">Fin</span><span class="bp">`</span> <span class="n">for</span> <span class="n">arithmetic</span><span class="o">,</span> <span class="n">and</span> <span class="n">they</span> <span class="n">will</span> <span class="n">be</span>
  <span class="n">exceedingly</span> <span class="n">inefficient</span> <span class="n">at</span> <span class="n">run</span> <span class="n">time.</span>
  <span class="bp">@</span> <span class="n">n</span> <span class="n">the</span> <span class="n">upper</span> <span class="n">bound</span>
  <span class="n">Totality</span><span class="o">:</span> <span class="n">total</span>
  <span class="n">Visibility</span><span class="o">:</span> <span class="n">public</span> <span class="kn">export</span>
  <span class="n">Constructors</span><span class="o">:</span>
    <span class="n">FZ</span> <span class="o">:</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">S</span> <span class="n">k</span><span class="o">)</span>
    <span class="n">FS</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">k</span> <span class="bp">-&gt;</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">S</span> <span class="n">k</span><span class="o">)</span>
</code></pre></div>



<a name="291429358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429358">(Jul 30 2022 at 13:37)</a>:</h4>
<p>This is much easier to reason about</p>



<a name="291429372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429372">(Jul 30 2022 at 13:37)</a>:</h4>
<p>Because I only need to get from <code>Fin (S k)</code> to <code>Fin k</code> (in recursion).</p>



<a name="291429381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429381">(Jul 30 2022 at 13:38)</a>:</h4>
<p>It's a lot harder to work with equalities in the index with that representation</p>



<a name="291429421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429421">(Jul 30 2022 at 13:38)</a>:</h4>
<p>in mathlib there are API lemmas for the FZ and FS constructors</p>



<a name="291429433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429433">(Jul 30 2022 at 13:38)</a>:</h4>
<p>it's pretty easy to define them</p>



<a name="291429434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429434">(Jul 30 2022 at 13:38)</a>:</h4>
<p>equalitiies in the index?</p>



<a name="291429439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429439">(Jul 30 2022 at 13:38)</a>:</h4>
<p>I imagine you could even build a custom induction principle that reflects them, there is no reason to build a new type really</p>



<a name="291429449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429449">(Jul 30 2022 at 13:39)</a>:</h4>
<p>stuff like <code>Fin (m + n) -&gt; Fin (n + m)</code></p>



<a name="291429454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429454">(Jul 30 2022 at 13:39)</a>:</h4>
<p>I'm newbie to Lean though</p>



<a name="291429467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429467">(Jul 30 2022 at 13:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429449">said</a>:</p>
<blockquote>
<p>stuff like <code>Fin (m + n) -&gt; Fin (n + m)</code></p>
</blockquote>
<p>You just need to prove that <code>m + n = n + m</code>, and they are the same type.</p>



<a name="291429469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429469">(Jul 30 2022 at 13:39)</a>:</h4>
<p>you have to be advanced type tetris master to actually come up with a proof of that using FZ and FS</p>



<a name="291429514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429514">(Jul 30 2022 at 13:40)</a>:</h4>
<p>not really</p>



<a name="291429520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429520">(Jul 30 2022 at 13:40)</a>:</h4>
<p>Advanced type tetris master is going in my type theory urban dictionary</p>



<a name="291429525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429525">(Jul 30 2022 at 13:40)</a>:</h4>
<p>Idris has this <code>cast : (a: A) -&gt; (A = B) -&gt; B</code></p>



<a name="291429527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429527">(Jul 30 2022 at 13:40)</a>:</h4>
<p>You can prove it using <code>cast</code> but then you don't know e.g. how the value computes on successor</p>



<a name="291429532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429532">(Jul 30 2022 at 13:41)</a>:</h4>
<p>It's literally the same type though</p>



<a name="291429534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429534">(Jul 30 2022 at 13:41)</a>:</h4>
<p>you won't be able to apply equation lemmas for other recursive definitions</p>



<a name="291429540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429540">(Jul 30 2022 at 13:41)</a>:</h4>
<p>what's equation lemma</p>



<a name="291429543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429543">(Jul 30 2022 at 13:41)</a>:</h4>
<p>we usually call this DTT hell</p>



<a name="291429587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429587">(Jul 30 2022 at 13:42)</a>:</h4>
<p>equation lemmas are the definitional equalities that follow from a definition by pattern matching</p>



<a name="291429598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429598">(Jul 30 2022 at 13:42)</a>:</h4>
<p>I've been avoiding using tactics because I don't quite understand the magic.</p>



<a name="291429602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429602">(Jul 30 2022 at 13:42)</a>:</h4>
<p>You can say that I'm a type tetris master</p>



<a name="291429606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429606">(Jul 30 2022 at 13:43)</a>:</h4>
<p>The advantage of the structure definition of <code>Fin</code> is that you can do all the "real" reasoning on a non-dependent type, namely <code>Nat</code></p>



<a name="291429621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429621">(Jul 30 2022 at 13:43)</a>:</h4>
<p>Yes, this style of programming you are using is seen mostly in idris and agda</p>



<a name="291429627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429627">(Jul 30 2022 at 13:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429598">said</a>:</p>
<blockquote>
<p>I've been avoiding using tactics because I don't quite understand the magic.</p>
</blockquote>
<p>I'm afraid that won't really get you too far in the Lean eco system, we are pretty focused on tactics for non trivial term level proofs</p>



<a name="291429694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429694">(Jul 30 2022 at 13:45)</a>:</h4>
<p>The situation with vectors is pretty similar BTW. In lean 4 they aren't defined, but the lean 3 definition of <code>Vector A n</code> is <code>{l : List A // l.length = n}</code></p>



<a name="291429711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429711">(Jul 30 2022 at 13:45)</a>:</h4>
<p>so all the vector operations are just list operations tupled with a proof that they preserve lengths</p>



<a name="291429757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429757">(Jul 30 2022 at 13:46)</a>:</h4>
<p>and you don't have any problems with e.g. associativity of vector append</p>



<a name="291429766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429766">(Jul 30 2022 at 13:46)</a>:</h4>
<p>This also makes the runtime representation nicer right? With the indexed variant each node is also carrying the rest of the length around</p>



<a name="291429772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429772">(Jul 30 2022 at 13:47)</a>:</h4>
<p>Indeed</p>



<a name="291429778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429778">(Jul 30 2022 at 13:47)</a>:</h4>
<p>I think agda has a mechanism to avoid this using ghost arguments</p>



<a name="291429782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429782">(Jul 30 2022 at 13:47)</a>:</h4>
<p>not sure about idris</p>



<a name="291429791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429791">(Jul 30 2022 at 13:47)</a>:</h4>
<p>Idris has beta reduction for Nat-like and  (i forgot the name) for List-like</p>



<a name="291429831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429831">(Jul 30 2022 at 13:48)</a>:</h4>
<p>(runtime representation)</p>



<a name="291429845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429845">(Jul 30 2022 at 13:48)</a>:</h4>
<p>It doesn't have the <code>Array</code> type in Lean, because its <code>List</code> is just as fast</p>



<a name="291429854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429854">(Jul 30 2022 at 13:49)</a>:</h4>
<p>in lean 4 the improvement of runtime representation for <code>Fin</code> is even more stark. the FZ/FS representation is a unary linked list, while the structure over Nat is a zero-cost wrapper around a GMP bignum with a direct numeral representation for numbers less than I think 2^63</p>



<a name="291429857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429857">(Jul 30 2022 at 13:49)</a>:</h4>
<p>Idris compile to scheme, so it's different</p>



<a name="291429864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429864">(Jul 30 2022 at 13:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429845">said</a>:</p>
<blockquote>
<p>It doesn't have the <code>Array</code> type in Lean, because its <code>List</code> is just as fast</p>
</blockquote>
<p>How can a linked list be just as fast as a slice of memory?</p>



<a name="291429866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429866">(Jul 30 2022 at 13:49)</a>:</h4>
<p>scheme magic?</p>



<a name="291429873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429873">(Jul 30 2022 at 13:49)</a>:</h4>
<p>does it have O(1) push?</p>



<a name="291429916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429916">(Jul 30 2022 at 13:50)</a>:</h4>
<p>push to the <em>end</em></p>



<a name="291429919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429919">(Jul 30 2022 at 13:50)</a>:</h4>
<p>never tried</p>



<a name="291429942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429942">(Jul 30 2022 at 13:51)</a>:</h4>
<p>need to check Chez Scheme's source code to know</p>



<a name="291429961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291429961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291429961">(Jul 30 2022 at 13:51)</a>:</h4>
<p>a google search turns up <a href="https://www.idris-lang.org/docs/idris2/current/contrib_docs/docs/Data.Linear.Array.html">https://www.idris-lang.org/docs/idris2/current/contrib_docs/docs/Data.Linear.Array.html</a></p>



<a name="291430003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430003">(Jul 30 2022 at 13:52)</a>:</h4>
<p>that's a type class</p>



<a name="291430005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430005">(Jul 30 2022 at 13:52)</a>:</h4>
<p><code>interface</code></p>



<a name="291430012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430012">(Jul 30 2022 at 13:52)</a>:</h4>
<p>there's a <code>data</code> right after</p>



<a name="291430019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430019">(Jul 30 2022 at 13:52)</a>:</h4>
<p>that's in contrib (akin to mathlib4)</p>



<a name="291430031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430031">(Jul 30 2022 at 13:53)</a>:</h4>
<p>okay, is that a disqualification?</p>



<a name="291430036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430036">(Jul 30 2022 at 13:53)</a>:</h4>
<p>They seem to have a lot of array thingies below</p>



<a name="291430050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430050">(Jul 30 2022 at 13:53)</a>:</h4>
<p>there's no <code>push</code> though</p>



<a name="291430098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430098">(Jul 30 2022 at 13:54)</a>:</h4>
<p>it's probably incomplete (again, things in <code>contrib</code> are like that)</p>



<a name="291430102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430102">(Jul 30 2022 at 13:54)</a>:</h4>
<p><a href="https://idris2-quickdocs.surge.sh/">https://idris2-quickdocs.surge.sh/</a></p>



<a name="291430118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430118">(Jul 30 2022 at 13:55)</a>:</h4>
<p>Even third-party packages are better than <code>contrib</code>. <code>contrib</code> is the historical artifact before Idris2 core team decided it's a bad idea to let anything in the main repo.</p>



<a name="291430122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430122">(Jul 30 2022 at 13:55)</a>:</h4>
<p>I would be generally doubtful that a fully functional <code>List</code> type is going to get array performance "by magic"</p>



<a name="291430132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430132">(Jul 30 2022 at 13:55)</a>:</h4>
<p>idk<br>
I assume that list operation in LISP is fast enough</p>



<a name="291430134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430134">(Jul 30 2022 at 13:55)</a>:</h4>
<p>It's a linked list</p>



<a name="291430140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430140">(Jul 30 2022 at 13:56)</a>:</h4>
<p>But that's not how memory works, as soon as you have a linked list cache performance <em>sucks</em></p>



<a name="291430156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430156">(Jul 30 2022 at 13:56)</a>:</h4>
<p>probably not in memory</p>



<a name="291430182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430182">(Jul 30 2022 at 13:56)</a>:</h4>
<p>no, it really is</p>



<a name="291430190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430190">(Jul 30 2022 at 13:56)</a>:</h4>
<p>Do you think that popular scheme implementations would only use linked list (in C)?</p>



<a name="291430193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430193">(Jul 30 2022 at 13:56)</a>:</h4>
<p>you can sometimes optimize it to be a linked list of arrays but there are lots of operations that will break up the arrays</p>



<a name="291430205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430205">(Jul 30 2022 at 13:57)</a>:</h4>
<p>(I know because I've written an optimized lisp interpreter)</p>



<a name="291430209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430209">(Jul 30 2022 at 13:57)</a>:</h4>
<p>Idris can't compile to C good enough yet.</p>



<a name="291430236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430236">(Jul 30 2022 at 13:57)</a>:</h4>
<p>The mature backends are Scheme/Racket/Javascript</p>



<a name="291430250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430250">(Jul 30 2022 at 13:58)</a>:</h4>
<p>Scheme has an actual vector type though</p>



<a name="291430302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430302">(Jul 30 2022 at 13:58)</a>:</h4>
<p>lists are lists and arrays are arrays in scheme</p>



<a name="291430311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430311">(Jul 30 2022 at 13:58)</a>:</h4>
<p>yes</p>



<a name="291430315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430315">(Jul 30 2022 at 13:58)</a>:</h4>
<p>pretty sure racket does too</p>



<a name="291430319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430319">(Jul 30 2022 at 13:58)</a>:</h4>
<p>and javascript has a whole zoo</p>



<a name="291430337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430337">(Jul 30 2022 at 13:59)</a>:</h4>
<p>so I don't see how a language with only one <code>List</code> type is going to be able to lower this to both lists and arrays</p>



<a name="291430437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430437">(Jul 30 2022 at 14:00)</a>:</h4>
<p>not both</p>



<a name="291430444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430444">(Jul 30 2022 at 14:00)</a>:</h4>
<p>it's mapped to Scheme's list</p>



<a name="291430458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430458">(Jul 30 2022 at 14:00)</a>:</h4>
<p>which is why I don't think you will get O(1) push with idris <code>List</code></p>



<a name="291430635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430635">(Jul 30 2022 at 14:04)</a>:</h4>
<p>Maybe not</p>



<a name="291430767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291430767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Locria Cyber <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291430767">(Jul 30 2022 at 14:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="515610">Locria Cyber</span> <a href="#narrow/stream/270676-lean4/topic/vectors.20in.20lean4/near/291429525">said</a>:</p>
<blockquote>
<p>Idris has this <code>cast : (a: A) -&gt; (A = B) -&gt; B</code></p>
</blockquote>
<p>How do you do something like this (in Lean)?</p>



<a name="291431386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vectors%20in%20lean4/near/291431386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vectors.20in.20lean4.html#291431386">(Jul 30 2022 at 14:19)</a>:</h4>
<p>You just do it: <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=cast#doc">docs4#cast</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>