---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/shorter.20cases.20tactic.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html">shorter cases tactic</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="303541266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303541266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303541266">(Oct 12 2022 at 00:24)</a>:</h4>
<p>I finally figured out how to port level  8 in advanced proposition world to lean4, but it's not pretty.  See <a href="https://lovettsoftware.com/NaturalNumbers/AdvancedPropositionWorld/Level8.lean.html">solution</a>.  </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">intro</span> <span class="n">hP</span> <span class="n">hQR</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hQR</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">inl</span> <span class="n">hQ</span> <span class="bp">=&gt;</span>
      <span class="n">left</span>
      <span class="n">constructor</span>
      <span class="n">assumption</span>
      <span class="n">assumption</span>
    <span class="bp">|</span> <span class="n">inr</span> <span class="n">hR</span> <span class="bp">=&gt;</span>
      <span class="n">right</span>
      <span class="n">constructor</span>
      <span class="n">assumption</span>
      <span class="n">assumption</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">inl</span> <span class="n">hPQ</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hPQ</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">intro</span> <span class="n">hP</span> <span class="n">hQ</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span>
      <span class="n">assumption</span>
      <span class="n">left</span>
      <span class="n">assumption</span>
  <span class="bp">|</span> <span class="n">inr</span> <span class="n">hPR</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hPR</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">intro</span> <span class="n">hP</span> <span class="n">hR</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span>
      <span class="n">assumption</span>
      <span class="n">right</span>
      <span class="n">assumption</span>
</code></pre></div>
<p>Here's the lean 3 solution for comparison:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">hp</span> <span class="n">hqr</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hqr</span> <span class="k">with</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
  <span class="n">left</span><span class="o">,</span> <span class="n">split</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
  <span class="n">right</span><span class="o">,</span> <span class="n">split</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">hpq</span> <span class="n">hpr</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hpq</span> <span class="k">with</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
  <span class="n">left</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hpr</span> <span class="k">with</span> <span class="n">hp</span> <span class="n">hr</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
  <span class="n">right</span><span class="o">,</span> <span class="n">assumption</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Notice how the single line cases tactics make for a much more condensed proof.  Is there another way to simplify my lean4 proof (using tactic proofs)?</p>



<a name="303564303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303564303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303564303">(Oct 12 2022 at 06:04)</a>:</h4>
<p>I see that mathlib4 has a <code>cases'</code> tactic for backwards compatibility.<br>
<a href="https://github.com/leanprover-community/mathlib4/blob/f275d4b0c8762abd3eb75a4e5c2e9a8e9e2a2254/Mathlib/Tactic/Cases.lean">https://github.com/leanprover-community/mathlib4/blob/f275d4b0c8762abd3eb75a4e5c2e9a8e9e2a2254/Mathlib/Tactic/Cases.lean</a></p>



<a name="303573001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303573001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303573001">(Oct 12 2022 at 07:26)</a>:</h4>
<p>Right now the lean 4 version looks much harder to teach, not least because of the syntax and spacing. I didn't even teach <code>{ tac }</code> brackets in lean 3, instead saying "tactics operate on the top goal".</p>



<a name="303575989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303575989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303575989">(Oct 12 2022 at 07:50)</a>:</h4>
<p>You can put multiple tactics on one line by separating them with <code>;</code> (instead of <code>,</code>), which should give you the ability to more or less directly copy the lean 3 proof</p>



<a name="303576686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303576686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303576686">(Oct 12 2022 at 07:55)</a>:</h4>
<p>Here's an approximation of a literal port of the lean 3 proof in lean 4, using the <code>cases'</code> and <code>left</code>/<code>right</code> tactics from mathlib:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Mathlib.Tactic.Cases</span>
<span class="kn">import</span> <span class="n">Mathlib.Tactic.LeftRight</span>

<span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">intro</span> <span class="n">h</span>
    <span class="n">cases'</span> <span class="n">h</span> <span class="k">with</span> <span class="n">hp</span> <span class="n">hqr</span>
    <span class="n">cases'</span> <span class="n">hqr</span> <span class="k">with</span> <span class="n">q</span> <span class="n">r</span>
    <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">intro</span> <span class="n">h</span>
    <span class="n">cases'</span> <span class="n">h</span> <span class="k">with</span> <span class="n">hpq</span> <span class="n">hpr</span>
    <span class="bp">·</span> <span class="n">cases'</span> <span class="n">hpq</span> <span class="k">with</span> <span class="n">p</span> <span class="n">q</span>
      <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
      <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">·</span> <span class="n">cases'</span> <span class="n">hpr</span> <span class="k">with</span> <span class="n">hp</span> <span class="n">hr</span>
      <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
      <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>
<p>The use of <code>·</code> for subgoals is required only because of a bug in <code>cases'</code> which appears to cause it to drop goals when it is applied on a goal state already containing multiple goals (which of course you shouldn't have in a well structured proof, but in this example we're specifically going for the stream of consciousness style so those <code>·</code> are undesirable).</p>



<a name="303576757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303576757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303576757">(Oct 12 2022 at 07:56)</a>:</h4>
<p>I just found the same bug. :-)</p>



<a name="303577001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303577001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303577001">(Oct 12 2022 at 07:58)</a>:</h4>
<p>Here's a version that uses only core lean 4 but retains the lean 3 style as much as possible:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hqr</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span>
  <span class="n">cases</span> <span class="n">hqr</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">inl</span> <span class="n">q</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">r</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span>
  <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">inl</span> <span class="n">hpq</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hpr</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span>
  <span class="n">cases</span> <span class="n">hpq</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hq</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span>
  <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">cases</span> <span class="n">hpr</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hr</span> <span class="bp">=&gt;</span> <span class="bp">?</span><span class="n">_</span>
  <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303577445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303577445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303577445">(Oct 12 2022 at 08:01)</a>:</h4>
<p>If <span class="user-mention" data-user-id="110031">@Patrick Massot</span>'s NNG version takes care of "deemphasizing syntax worries as much as possible", I'd argue teaching <em>some</em> structuring in this "pure Lean" version is not wrong</p>



<a name="303577774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303577774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303577774">(Oct 12 2022 at 08:03)</a>:</h4>
<p>here's a version with the natural structuring suggested by the cases tactic:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hqr</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hqr</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">inl</span> <span class="n">q</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">|</span> <span class="n">_</span> <span class="n">r</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">inl</span> <span class="n">hpq</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hpq</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hq</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
      <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="bp">|</span> <span class="n">_</span> <span class="n">hpr</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hpr</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hr</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span>
      <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303578731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303578731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303578731">(Oct 12 2022 at 08:10)</a>:</h4>
<p>(as usual, a syntax error after the proof caused me to write nonsense that lean wasn't actually checking... -_- Should be fixed now.)</p>



<a name="303578855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303578855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303578855">(Oct 12 2022 at 08:11)</a>:</h4>
<p>now I have to go find out why <code>cases h with | _ hpq =&gt; ?_ | _ hpr =&gt; ?_</code> doesn't work to destructure an or</p>



<a name="303580225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303580225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303580225">(Oct 12 2022 at 08:21)</a>:</h4>
<p>How do you expect that to work? <code>_</code> means "all remaining cases"</p>



<a name="303583225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303583225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303583225">(Oct 12 2022 at 08:43)</a>:</h4>
<p>posted in <a href="https://github.com/leanprover/lean4/pull/1718">lean4#1718</a>. In short, uses of <code>_</code> before the last pattern should target the first constructor that has not yet been claimed by an earlier arm</p>



<a name="303583362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303583362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303583362">(Oct 12 2022 at 08:44)</a>:</h4>
<p>and the last <code>| _ =&gt;</code> arm is applied to all remaining goals if there is more than one</p>



<a name="303583465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303583465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303583465">(Oct 12 2022 at 08:45)</a>:</h4>
<p>Yeah, I just saw the issue. I feel like it's overloading the meaning of <code>_</code> in <code>cases</code> a bit too much - why not use <code>next/all_goals</code> at that point to be explicit.</p>



<a name="303583654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303583654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303583654">(Oct 12 2022 at 08:46)</a>:</h4>
<p>In this particular case, the point is so that we can use the <code>=&gt; ?_</code> form of <code>cases</code> to dump the goals in the main context. <code>next</code> and <code>case</code> and <code>all_goals</code> are all block tactics</p>



<a name="303583925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303583925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303583925">(Oct 12 2022 at 08:48)</a>:</h4>
<p>I think cases tries a little too hard to be a half-assed version of <code>match</code>. It's not doing pattern matching, but it has some similar features and the combination is confusing</p>



<a name="303584083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303584083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303584083">(Oct 12 2022 at 08:49)</a>:</h4>
<p>Seems like your proposal would move it further away from <code>match</code> :)</p>



<a name="303584094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303584094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303584094">(Oct 12 2022 at 08:49)</a>:</h4>
<p>it would</p>



<a name="303584216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303584216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303584216">(Oct 12 2022 at 08:50)</a>:</h4>
<p>I don't think they should be using similar syntax, because that just invites misunderstandings when people try to write <code>cases x with | inl (a, b) =&gt; ...</code></p>



<a name="303584679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303584679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303584679">(Oct 12 2022 at 08:53)</a>:</h4>
<p>or why name resolution on the variants works differently, you can't write <code>cases x with | Or.inl a =&gt; ...</code> but you have to write it like that (or use <code>.inl</code>) in <code>match</code></p>



<a name="303584956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303584956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303584956">(Oct 12 2022 at 08:55)</a>:</h4>
<p>Also <code>?_</code> at the end of <code>cases</code> / <code>match</code> is non-compositional, you can't put any tactics before it. I would prefer if this was just a general mechanism to get out of a block context</p>



<a name="303585146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585146">(Oct 12 2022 at 08:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/shorter.20cases.20tactic/near/303584679">said</a>:</p>
<blockquote>
<p>or why name resolution on the variants works differently, you can't write <code>cases x with | Or.inl a =&gt; ...</code> but you have to write it like that (or use <code>.inl</code>) in <code>match</code></p>
</blockquote>
<p>Heh, in the other thread I was arguing for moving that <em>closer</em> to <code>match</code></p>



<a name="303585302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585302">(Oct 12 2022 at 08:57)</a>:</h4>
<p>I mean, I think it's mostly fine, but I think the data is in that it's a lot more cumbersome to write compared to lean 3 cases</p>



<a name="303585372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585372">(Oct 12 2022 at 08:57)</a>:</h4>
<p>I don't think we should be going back to the unstructured list of names approach, but something like rcases patterns seems like a reasonable compromise</p>



<a name="303585561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585561">(Oct 12 2022 at 08:58)</a>:</h4>
<p>and that PR is just the smallest delta I can make on current lean 4 to make it possible to do lean 3 style cases in lean 4</p>



<a name="303585689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585689">(Oct 12 2022 at 08:59)</a>:</h4>
<p>(I don't think <code>cases'</code> is an adequate solution because it is mainly intended for backward compatibility and will go away eventually if it doesn't make the bar to go into official lean 4)</p>



<a name="303585834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sébastien Michelland <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585834">(Oct 12 2022 at 09:00)</a>:</h4>
<p>Maybe a naive question but... here's the same proof in Coq:</p>
<div class="codehilite" data-code-language="Coq"><pre><span></span><code><span class="kn">Theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">{</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">:</span> <span class="n">P</span> <span class="o">/\</span> <span class="o">(</span><span class="n">Q</span> <span class="o">\/</span> <span class="n">R</span><span class="o">)</span> <span class="o">&lt;-&gt;</span> <span class="o">(</span><span class="n">P</span> <span class="o">/\</span> <span class="n">Q</span><span class="o">)</span> <span class="o">\/</span> <span class="o">(</span><span class="n">P</span> <span class="o">/\</span> <span class="n">R</span><span class="o">).</span>
  <span class="k">split</span><span class="o">.</span>
  <span class="o">*</span> <span class="k">intros</span> <span class="o">[</span><span class="n">HP</span> <span class="o">[</span><span class="n">HQ</span><span class="o">|</span><span class="n">HR</span><span class="o">]].</span>
    <span class="o">-</span> <span class="k">left</span><span class="o">.</span> <span class="k">split</span><span class="o">;</span> <span class="kp">assumption</span><span class="o">.</span>
    <span class="o">-</span> <span class="k">right</span><span class="o">.</span> <span class="k">split</span><span class="o">;</span> <span class="kp">assumption</span><span class="o">.</span>
  <span class="o">*</span> <span class="k">intros</span> <span class="o">[[</span><span class="n">HP</span> <span class="n">HQ</span><span class="o">]|[</span><span class="n">HP</span> <span class="n">HR</span><span class="o">]].</span>
    <span class="o">-</span> <span class="k">split</span><span class="o">.</span> <span class="kp">assumption</span><span class="o">.</span> <span class="k">left</span><span class="o">;</span> <span class="kp">assumption</span><span class="o">.</span>
    <span class="o">-</span> <span class="k">split</span><span class="o">.</span> <span class="kp">assumption</span><span class="o">.</span> <span class="k">right</span><span class="o">;</span> <span class="kp">assumption</span><span class="o">.</span>
</code></pre></div>
<p>What's wrong with having a linear/non-structured case (or here intros) and then structuring with bullets?</p>



<a name="303585889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585889">(Oct 12 2022 at 09:00)</a>:</h4>
<p>that's what I mean by <code>rcases</code> patterns</p>



<a name="303585941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303585941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303585941">(Oct 12 2022 at 09:01)</a>:</h4>
<p>rcases was in large part inspired by coq's syntax for pattern matching intros</p>



<a name="303586471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303586471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303586471">(Oct 12 2022 at 09:04)</a>:</h4>
<p>Here's a lean 4 transcription of the coq proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Std.Tactic.RCases</span>
<span class="kn">import</span> <span class="n">Mathlib.Tactic.LeftRight</span>

<span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">{</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="bp">·</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="bp">·</span> <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="bp">·</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="bp">·</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303586783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303586783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303586783">(Oct 12 2022 at 09:06)</a>:</h4>
<p>There was a lot of support for somehow unifying <code>intro</code> and <code>rintro</code> from the mathlib crowd, but they are fairly syntactically incompatible even though they are very similar</p>



<a name="303586881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303586881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303586881">(Oct 12 2022 at 09:07)</a>:</h4>
<p>I would like <code>rcases</code> to land in lean core in some way, maybe with some syntax modifications but essentially the same interface</p>



<a name="303610633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303610633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303610633">(Oct 12 2022 at 11:53)</a>:</h4>
<p><span class="user-mention" data-user-id="484617">@Sébastien Michelland</span> the natural number game was written for mathematicians who have no programming background and I made a conscious decision not to teach any structuring.  You would not believe the horrors I saw when I was beta testing with mathematics undergraduates. If we add some sort of structuring in Lean 4 then part of me thinks that this is a great idea to teach mathematicians about how to think correctly about a proof being a program, but another part of me is just worried that this will confuse them (certainly I do not want to assume that they have ever seen functional programming, for example). Perhaps one solution that we could have in Lean 4 is that whenever a proof breaks into 2, we literally end up with 2 windows where they can type.</p>



<a name="303625133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303625133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sébastien Michelland <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303625133">(Oct 12 2022 at 13:18)</a>:</h4>
<p>Right, it seems reasonable to separate these concerns. (I mean I would never have doubted  that mathematicians have an intuition of a subproof within a proof, but you've clearly seen more than I have. xD) So in that regard, separating the splitting/recursing from the structuring does make sense.</p>



<a name="303681794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303681794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> François G. Dorais <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303681794">(Oct 12 2022 at 17:01)</a>:</h4>
<p>For the sake of listing one more option, one can also use <code>next</code> to avoid the <code>with | ...</code> syntax.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- Plain Lean, no imports</span>
<span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">{</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">intro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span><span class="n">HQR</span><span class="o">⟩</span>
    <span class="n">cases</span> <span class="n">HQR</span>
    <span class="n">next</span> <span class="n">HQ</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inl</span>
      <span class="n">constructor</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HP</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HQ</span>
    <span class="n">next</span> <span class="n">HR</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inr</span>
      <span class="n">constructor</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HP</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HR</span>
  <span class="bp">·</span> <span class="n">intro</span> <span class="n">H</span>
    <span class="n">cases</span> <span class="n">H</span>
    <span class="n">next</span> <span class="n">HPQ</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HPQ.left</span>
      <span class="bp">·</span> <span class="n">apply</span> <span class="n">Or.inl</span>
        <span class="n">exact</span> <span class="n">HPQ.right</span>
    <span class="n">next</span> <span class="n">HPR</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span>
      <span class="bp">·</span> <span class="n">exact</span> <span class="n">HPR.left</span>
      <span class="bp">·</span> <span class="n">apply</span> <span class="n">Or.inr</span>
        <span class="n">exact</span> <span class="n">HPR.right</span>
</code></pre></div>



<a name="303722079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303722079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303722079">(Oct 12 2022 at 21:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/shorter.20cases.20tactic/near/303577774">said</a>:</p>
<blockquote>
<p>here's a version with the natural structuring suggested by the cases tactic:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="n">intro</span> <span class="n">h</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">_</span> <span class="n">hp</span> <span class="n">hqr</span> <span class="bp">=&gt;</span>
    <span class="n">cases</span> <span class="n">hqr</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">inl</span> <span class="n">q</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">|</span> <span class="n">_</span> <span class="n">r</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">intro</span> <span class="n">h</span>
</code></pre></div><br>
</p>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> In this proof of yours (cropped for clarity), is it conventional that you indented </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="n">cases</span> <span class="n">hqr</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">inl</span> <span class="n">q</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inl</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">|</span> <span class="n">_</span> <span class="n">r</span> <span class="bp">=&gt;</span>
      <span class="n">apply</span> <span class="n">Or.inr</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>
<p>?  In Lean 3 we wouldn't brace after a step which doesn't increase the number of goals.</p>



<a name="303723525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303723525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303723525">(Oct 12 2022 at 21:19)</a>:</h4>
<p>I indented it because the thing after <code>cases</code> is a block of tactics, it's like <code>all_goals</code> or other tactic combinator. When you say "we wouldn't brace after a step which doesn't increase the number of goals", that implies that <code>cases h with | _ hp hqr =&gt;</code> is a tactic, and it's not. The standalone tactic version would be written <code>cases h with | _ hp hqr =&gt; ?_</code>, and I would not indent after that since you can put parentheses around that tactic without causing a syntax error</p>



<a name="303723751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303723751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303723751">(Oct 12 2022 at 21:21)</a>:</h4>
<p>In particular, you can see the <code>intro h</code> is not indented along with the <code>cases hqr</code>. If you were to dedent the block, it would actually change the meaning of the code, since the <code>intro h</code> would be brought into the block as well</p>



<a name="303724072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303724072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303724072">(Oct 12 2022 at 21:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/shorter.20cases.20tactic/near/303723751">said</a>:</p>
<blockquote>
<p>In particular, you can see the <code>intro h</code> is not indented along with the <code>cases hqr</code>. If you were to dedent the block, it would actually change the meaning of the code, since the <code>intro h</code> would be brought into the block as well</p>
</blockquote>
<p>To check, you mean the second <code>intro h</code>?</p>



<a name="303724136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303724136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303724136">(Oct 12 2022 at 21:24)</a>:</h4>
<p>yes</p>



<a name="303724229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303724229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303724229">(Oct 12 2022 at 21:25)</a>:</h4>
<p>Thanks!</p>



<a name="303738591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303738591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303738591">(Oct 12 2022 at 23:46)</a>:</h4>
<p>Speaking of semi-colons, the NNG for lean3 says "Note the semicolon**! It means "do the next tactic to all the goals, not just the top one".  I take it this is not the case in lean4, where it just means the same as a newline?</p>



<a name="303738825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303738825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303738825">(Oct 12 2022 at 23:49)</a>:</h4>
<p>in lean 4 that remark is directed to <code>&lt;;&gt;</code></p>



<a name="303743743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303743743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303743743">(Oct 13 2022 at 00:55)</a>:</h4>
<p>Can someone explain why/what the "dot" is exactly so I can explain it in the <a href="http://lovettsoftware.com/NaturalNumbers/AdvancedPropositionWorld/Level8.lean.html">updated version of the tutorial</a> ?  Specifically, why can't an indent do the same thing? I noticed the inner dots on the rintro subgoals where not needed, what are the guidelines, only use dot when necessary? Or use them everywhere for consistency?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303745414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303745414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303745414">(Oct 13 2022 at 01:23)</a>:</h4>
<p>The dot focuses, so the other goals disappear from view, until you reach the next dot.</p>



<a name="303745547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303745547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303745547">(Oct 13 2022 at 01:25)</a>:</h4>
<p>So it's cleaner to use the dot, and helpful if someone is ever going to read the proof. Using the dot consistently prevents you from writing proofs in which the reader has to track multiple goals in their head, and work out from the proof where the argument close one and moves on to the next.</p>



<a name="303752337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303752337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303752337">(Oct 13 2022 at 03:13)</a>:</h4>
<p>The dot is valuable for readers because of all the ways you <em>could</em> have written the code that wouldn't compile with the dots. For example, this doesn't compile:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
  <span class="bp">·</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
  <span class="bp">·</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>
<p>That's because the first goal is not closed by the <code>rintro</code> line, it still has two subgoals and you get an error saying the proof isn't done yet. So by looking at a proof like this I can immediately see that <code>constructor</code> would have to produce six goals for the proof to compile. While it is true that the inner dots are not required, the following proof has the same structure and also compiles:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span>
    <span class="n">assumption</span><span class="bp">;</span> <span class="n">constructor</span>
    <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>
<p>but now that I've scrambled the lines it's not clear where one goal ends and the next one starts. Adding the dots provides visual proof that I didn't scramble the goals like this.</p>



<a name="303910271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303910271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303910271">(Oct 13 2022 at 19:39)</a>:</h4>
<p>My question though was about this case which also compiles, but it seems the inner dots are not needed.  </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="bp">.</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="bp">.</span> <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="bp">.</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">.</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>
<p>it's almost like the mathlib <code>left</code> tactic is also acting like a dot?  So is it recommended i include these inner dots or not?  </p>
<p>Can I think of dot almost like a "push tail; pop tail" operation that hides all the trailing goals so I can focus on the topmost goal? If I am to believe the tactic state I see in the InfoView as I move my cursor around, it seems like "pop" is automatic as soon as the goals are accomplished the remaining goal re-appears, so I'm not sure why I need a dot on the second <code>rintro</code>.</p>



<a name="303911528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303911528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303911528">(Oct 13 2022 at 19:47)</a>:</h4>
<p>Dots are never needed if you have placed them correctly</p>



<a name="303911605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303911605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303911605">(Oct 13 2022 at 19:47)</a>:</h4>
<p>The value of placing dots is to say "the fact that it still compiles means my proof must actually have this structure"</p>



<a name="303912075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303912075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303912075">(Oct 13 2022 at 19:50)</a>:</h4>
<p>The actual effect of the dot is the following:</p>
<p>Given a goal state <code>[g1, g2, ... gn]</code>, <code>. tacs</code> is a tactic which first changes the goal state to <code>[g1]</code>, then runs <code>tacs</code>. If the resulting goal state is not <code>[]</code>, throw an error. Then restore the remaining goals <code>[g2, ..., gn]</code>.</p>



<a name="303912598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303912598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303912598">(Oct 13 2022 at 19:53)</a>:</h4>
<p>In other words, it's a checkpoint at the <em>end</em> of <code>tacs</code> which ensures that at that point the goal <code>g1</code> has been completely dealt with. It's just like an <code>assert()</code> in the middle of some code - if you remove it, stuff still works, but that doesn't mean the <code>assert</code> doesn't have value</p>



<a name="303913384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303913384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303913384">(Oct 13 2022 at 19:58)</a>:</h4>
<blockquote>
<p>it seems like "pop" is automatic as soon as the goals are accomplished the remaining goal re-appears, so I'm not sure why I need a dot on the second rintro.</p>
</blockquote>
<p>When there is only one goal remaining, the dot is a no-op, and sometimes people will leave off the dot on the last case, especially if the cases are very asymmetric like in a proof by induction where the base case is one line and the induction step is the rest of the proof, and they want to avoid indenting the rest of the proof. But you might keep the dots in if you want to emphasize the symmetry of the cases like in a <code>by_cases</code> proof or one that destructures an <code>\/</code> as in this case. If we were to leave off the last-case dots, it would look like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="bp">.</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
  <span class="bp">.</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="n">constructor</span><span class="bp">;</span> <span class="n">assumption</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303913723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303913723" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303913723">(Oct 13 2022 at 20:01)</a>:</h4>
<p>this is similar to whether you like to format a function with a big <code>if</code> statement as:</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cond</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">then_stuff</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="n">else_stuff</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="C"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cond</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">then_stuff</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">else_stuff</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="303914711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303914711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303914711">(Oct 13 2022 at 20:07)</a>:</h4>
<blockquote>
<p>So is it recommended i include these inner dots or not?</p>
</blockquote>
<p>It is recommended you always add the dots after any tactic that produces more than one goal. When the tactics are on one line, my personal preference is to use <code>{ }</code> (which is the lean 3 version of the dot which is still available in lean 4) instead of <code>(. tacs); ...</code>. With that style, the proof would look like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="bp">.</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="bp">.</span> <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="bp">·</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="bp">.</span> <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="bp">.</span> <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
</code></pre></div>



<a name="303914898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303914898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303914898">(Oct 13 2022 at 20:08)</a>:</h4>
<p>Now I can tell by looking at the proof that the <code>constructor</code> on the last line made two goals and <code>assumption</code> clears the first one and <code>right; assumption</code> clears the second.</p>



<a name="303919057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919057">(Oct 13 2022 at 20:34)</a>:</h4>
<p>Thanks very helpful, if you prefer curly braces why not write this instead?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
  <span class="o">}</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span>
  <span class="o">}</span>
</code></pre></div>



<a name="303919578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919578">(Oct 13 2022 at 20:37)</a>:</h4>
<p>that used to not work at all in lean 4, does that work now?</p>



<a name="303919691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919691">(Oct 13 2022 at 20:38)</a>:</h4>
<p>the lean 3 style looks like this</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span>
    <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span> <span class="o">}</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span>
    <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span> <span class="o">}</span>
</code></pre></div>



<a name="303919754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919754">(Oct 13 2022 at 20:39)</a>:</h4>
<p>and it does work now in lean 4, but I think the dots are more in keeping with the whitespace sensitive and newline-terminated style of lean 4</p>



<a name="303919778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919778">(Oct 13 2022 at 20:39)</a>:</h4>
<p>Yep I'm getting Goals accomplished <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> with the curly bracket version.</p>



<a name="303919873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919873">(Oct 13 2022 at 20:40)</a>:</h4>
<p>although you are still missing some braces there</p>



<a name="303919920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919920">(Oct 13 2022 at 20:40)</a>:</h4>
<p>it's more like this</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">and_or_distrib_left</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">Q</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">constructor</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span> <span class="bp">|</span> <span class="n">HR</span><span class="o">⟩</span>
    <span class="o">{</span> <span class="n">left</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span> <span class="o">}</span>
    <span class="o">{</span> <span class="n">right</span><span class="bp">;</span> <span class="n">constructor</span> <span class="bp">&lt;;&gt;</span> <span class="n">assumption</span> <span class="o">}</span> <span class="o">}</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">(⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HQ</span><span class="o">⟩</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">HP</span><span class="o">,</span> <span class="n">HR</span><span class="o">⟩)</span>
    <span class="o">{</span> <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">left</span><span class="bp">;</span> <span class="n">assumption</span> <span class="o">}</span>
    <span class="o">{</span> <span class="n">constructor</span><span class="bp">;</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span><span class="bp">;</span> <span class="n">right</span><span class="bp">;</span> <span class="n">assumption</span> <span class="o">}</span> <span class="o">}</span>
</code></pre></div>



<a name="303919965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919965">(Oct 13 2022 at 20:40)</a>:</h4>
<p>Well hmmm.  Gets a bit much.  I ended up documenting both styles and including your nice definition of dot here <a href="http://lovettsoftware.com/NaturalNumbers/AdvancedPropositionWorld/Level8.lean.html">http://lovettsoftware.com/NaturalNumbers/AdvancedPropositionWorld/Level8.lean.html</a></p>



<a name="303919997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303919997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303919997">(Oct 13 2022 at 20:41)</a>:</h4>
<p>the dots definitely look cleaner</p>



<a name="303920213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303920213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303920213">(Oct 13 2022 at 20:42)</a>:</h4>
<p>But it is interesting one can mix the style of grouping with parens when necessary, but also chipping away at the top goal without parens also works, so you can "simplify" the use of braces...</p>



<a name="303920282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303920282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303920282">(Oct 13 2022 at 20:43)</a>:</h4>
<p>the idea with the "structured style" is to never call a tactic when more than one goal is visible</p>



<a name="303920344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303920344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303920344">(Oct 13 2022 at 20:43)</a>:</h4>
<p>mathlib would reject your proof if you use the unstructured style</p>



<a name="303920435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303920435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303920435">(Oct 13 2022 at 20:44)</a>:</h4>
<p>it's good for hacking on the problem but it isn't "professional looking" and more importantly it's difficult to maintain</p>



<a name="303920547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303920547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303920547">(Oct 13 2022 at 20:45)</a>:</h4>
<p>if a tactic goes from closing a goal to no longer closing the goal, then the next tactic will be called on the wrong goal and you get all sorts of crazy cascading errors</p>



<a name="303921115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303921115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303921115">(Oct 13 2022 at 20:49)</a>:</h4>
<p>so "simplifying" the braces is not allowed - every brace there is required (although you can write it using <code>.</code> or <code>case</code> or <code>next</code> if you prefer, or use a tactic with built in structuring like <code>cases e with | a =&gt; tac | b =&gt; tac</code>)</p>



<a name="303921792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303921792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303921792">(Oct 13 2022 at 20:53)</a>:</h4>
<p>Also, just to be clear, parentheses in tactics are also legal but they have no block structuring effect. <code>(tac1; tac2); tac3</code> means the same as <code>tac1; tac2; tac3</code>. The main reason to use parentheses is to clear up a precedence or parsing issue, or run multiple tactics in a slot where only one tactic is allowed like <code>tac1 &lt;;&gt; (tac2; tac3)</code> (which would run <code>tac2</code> then <code>tac3</code> on every subgoal produced by <code>tac1</code>).</p>



<a name="303922035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303922035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303922035">(Oct 13 2022 at 20:55)</a>:</h4>
<p>I see, good to know, I definitely follow the maintainability argument.  It was surprising to me to learn that tactics that do nothing don't report an error in general.  Some do, like intro tells you when there's no way to introduce a new hypothesis, but <code>rw</code> silently fails...</p>



<a name="303922233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303922233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303922233">(Oct 13 2022 at 20:56)</a>:</h4>
<p>Example? We had a conversation about finding and removing those issues earlier, so I'm interested to see where that happens</p>



<a name="303922340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303922340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303922340">(Oct 13 2022 at 20:57)</a>:</h4>
<p>if you mean <code>rw []</code>, that one is defined to do nothing (other than the reducible rfl at the end) so it shouldn't fail, but if a rewrite is attempted it should not fail silently</p>



<a name="303922489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303922489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303922489">(Oct 13 2022 at 20:58)</a>:</h4>
<p>in lean 3 tactics would fail by convention if they make no progress, and I think we want to adopt the same behavior in lean 4</p>



<a name="303930852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303930852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303930852">(Oct 13 2022 at 21:58)</a>:</h4>
<p>Ok, good to know.  I know I've seen it but can't reproduce it right now, I will file a bug if I see it again with a repro.<br>
PS: thanks for the <code>tac1 &lt;;&gt; (tac2; tac3)</code> tip, that indeed seems handy.</p>



<a name="303933006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303933006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303933006">(Oct 13 2022 at 22:16)</a>:</h4>
<p>It is <code>apply</code> that silently fails, not <code>rw</code>.</p>



<a name="303933543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303933543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303933543">(Oct 13 2022 at 22:21)</a>:</h4>
<p>Again, can you show an <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>, I have not experienced this</p>



<a name="303936849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303936849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303936849">(Oct 13 2022 at 22:52)</a>:</h4>
<p>It might be an incremental editing issue.  If I have unfinished work ahead in the proof then apply produces no error:</p>
<p><a href="/user_uploads/3121/Jux5HZfwQOZJkhng-NBVIziP/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/Jux5HZfwQOZJkhng-NBVIziP/image.png" title="image.png"><img src="/user_uploads/3121/Jux5HZfwQOZJkhng-NBVIziP/image.png"></a></div><p>But if I fix the missing syntax ahead, then apply shows the error:</p>
<p><a href="/user_uploads/3121/sFXwebprpEuW6bSXcVh0P6Kl/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/sFXwebprpEuW6bSXcVh0P6Kl/image.png" title="image.png"><img src="/user_uploads/3121/sFXwebprpEuW6bSXcVh0P6Kl/image.png"></a></div>



<a name="303961700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/shorter%20cases%20tactic/near/303961700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/shorter.20cases.20tactic.html#303961700">(Oct 14 2022 at 04:26)</a>:</h4>
<p>one way to deal with that is to make sure your proof always compiles (unless you are mid-line) by placing <code>sorry</code>s that fill in all the holes in you proof.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>