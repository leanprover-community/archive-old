---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Widgets.20in.20vscode.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html">Widgets in vscode</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="257997400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/257997400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#257997400">(Oct 18 2021 at 09:02)</a>:</h4>
<p>I have just merged <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span>'s PR that enables widget support in the vscode extension.  This will most likely break something, so please keep an eye out for new bugs and complain here or on the bugtracker if you find one!</p>



<a name="257997420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/257997420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#257997420">(Oct 18 2021 at 09:03)</a>:</h4>
<p>Now we just need an elisp guru for the last remaining editor...</p>



<a name="258240497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/258240497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Reichelt <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#258240497">(Oct 19 2021 at 17:42)</a>:</h4>
<p>Not sure if it's related, but the timing matches quite well. On my machine (VSCode on Linux), the infoview now stops updating after a while. The "Problems" tab still updates properly, but the infoview is stuck in some state, usually empty. Here's a screenshot: <a href="https://imgur.com/RrHLi7w.png">https://imgur.com/RrHLi7w.png</a></p>
<div class="message_inline_image"><a href="https://imgur.com/RrHLi7w.png"><img src="https://uploads.zulipusercontent.net/7115a9d1c5cbd54b80dc246ac931ed20fd6b5776/68747470733a2f2f696d6775722e636f6d2f5272484c6937772e706e67"></a></div>



<a name="258240724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/258240724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#258240724">(Oct 19 2021 at 17:43)</a>:</h4>
<p>This might be the same issue as <a href="https://github.com/Julian/lean.nvim/issues/176">https://github.com/Julian/lean.nvim/issues/176</a><br>
Do you remember how you got into the stuck state?  It would be awesome for debugging if we could reliably reproduce this.</p>



<a name="258241314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/258241314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Reichelt <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#258241314">(Oct 19 2021 at 17:47)</a>:</h4>
<p>Unfortunately not, except that I can reliably reproduce it by working for 5-15 minutes. ;)</p>



<a name="258247636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/258247636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#258247636">(Oct 19 2021 at 18:23)</a>:</h4>
<p>If you can indeed manage to get it into the stuck state and can come back and interactively debug while you're in the stuck state that may also help all of us figure it out -- e.g. by enabling logging and seeing what chatter is going from VSCode -&gt; lean, or stracing the language server process and seeing what it's doing, or something.</p>



<a name="258257830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/258257830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Reichelt <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#258257830">(Oct 19 2021 at 19:31)</a>:</h4>
<p>I've just noticed that in one of my files, it reliably happens almost immediately after opening. More specifically, only the first click works, then it gets stuck. It's a particularly heavy file; that might be part of the reason. If someone else wants to try it with the same file, the project is at <a href="https://github.com/SReichelt/universe-abstractions">https://github.com/SReichelt/universe-abstractions</a>, and the particular file is FunctorUniverse.lean.</p>



<a name="318150148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318150148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318150148">(Dec 27 2022 at 19:41)</a>:</h4>
<p>Is there any plan to bring the Lean 3 infoview widgets to Lean 4?  I particularly miss the buttons which displayed on the pop-up from clicking a subterm in the infoview: (1) jump to the definition of the leading function application, (2) copy the whole subterm, (3) close the pop-up.</p>



<a name="318150529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318150529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318150529">(Dec 27 2022 at 19:44)</a>:</h4>
<p>jump to definition is already there, close the popup should hopefully be a lot more automatic than it used to be</p>



<a name="318150978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318150978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318150978">(Dec 27 2022 at 19:48)</a>:</h4>
<p>For "copy the subterm", one relatively unimposing way to do it would be to have clicking on a hoverable term (such that the term has a highlight and the hover itself may or may not be shown) select the text, and then you can just ctrl-C copy it</p>



<a name="318152187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318152187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318152187">(Dec 27 2022 at 19:57)</a>:</h4>
<p>Heather, jump to definition is there as an Easter egg, you need to know the secret code which is Ctrl-click.</p>



<a name="318152350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318152350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318152350">(Dec 27 2022 at 19:58)</a>:</h4>
<p>I agree that the copy-paste button is needed. And it would be good to have a smart one (providing something that is more likely to elaborate than what is displayed).</p>



<a name="318152566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318152566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318152566">(Dec 27 2022 at 20:00)</a>:</h4>
<p>Thanks Patrick.  Indeed I didn't know about the Ctrl-click.</p>



<a name="318152645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318152645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318152645">(Dec 27 2022 at 20:01)</a>:</h4>
<p>It also took me forever. I think I had to ask Ed and he revealed this secret to me. It has been here for ever, hiding in plain sight.</p>



<a name="318153105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318153105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318153105">(Dec 27 2022 at 20:04)</a>:</h4>
<p>Less important, but I also think the display in Lean 3 is visually clearer.  It gives more prominence to the type of the term (which is often what I want to know): it displays as say</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>ℝ
3 * a + b ^ 1.5
</code></pre></div>
<p>rather than</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>3 * a + b ^ 1.5 : ℝ
</code></pre></div>
<p>Does anyone else share my appetite for requesting a change on that?</p>



<a name="318168473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318168473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318168473">(Dec 27 2022 at 22:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/270676-lean4/topic/Widgets.20in.20vscode/near/318152645">said</a>:</p>
<blockquote>
<p>It also took me forever. I think I had to ask Ed and he revealed this secret to me. It has been here for ever, hiding in plain sight.</p>
</blockquote>
<p>Yeah.. the hope was that for people who already use VScode where ctrl-click is the default way of jumping to a definition via mouse, this would be "obvious" so they wouldn't even have to think about it. Clearly that's not the case though, especially for people who use the keyboard or the right-click menu. I do think the new UX is better because you can jump to the leading function without even opening a popup, but it needs to be more discoverable. Maybe we need a (?) button that shows a small tutorial.</p>



<a name="318168757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318168757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318168757">(Dec 27 2022 at 22:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/270676-lean4/topic/Widgets.20in.20vscode/near/318152645">said</a>:</p>
<blockquote>
<p>It also took me forever. I think I had to ask Ed and he revealed this secret to me. It has been here for ever, hiding in plain sight.</p>
</blockquote>
<p>I also discovered this easter egg from Ed -- I bumped into him in person a couple of months ago and moaned about its absence and he told me the secret :-)</p>



<a name="318168909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318168909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318168909">(Dec 27 2022 at 22:45)</a>:</h4>
<blockquote>
<p>For "copy the subterm", one relatively unimposing way to do it would be to have clicking on a hoverable term (such that the term has a highlight and the hover itself may or may not be shown) select the text, and then you can just ctrl-C copy it</p>
</blockquote>
<p>This is a good idea, except that currently clicking on a subterm also opens a popup. Not sure that clicking should do two things at once since you may not always want to both select something for copying <em>and</em> open the popup</p>



<a name="318168990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318168990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318168990">(Dec 27 2022 at 22:46)</a>:</h4>
<blockquote>
<p>Does anyone else share my appetite for requesting a change on that?</p>
</blockquote>
<p>Implementation-wise this would be a trivial change; it's just a matter of what the community prefers</p>



<a name="318170065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Widgets%20in%20vscode/near/318170065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Widgets.20in.20vscode.html#318170065">(Dec 27 2022 at 22:57)</a>:</h4>
<p>In Lean 3 cut-and-paste from the infoview was hit-and-miss (and apparently even more hit and miss on Windows), but in Lean 4 I've had no problems. Like Heather I today wanted to see the type of a (large) expression (I wasn't sure if it was Prop or Type) and it was a little annoying than clicking on it in the infoview didn't immediately just tell me the answer, so I had to use my brain.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>