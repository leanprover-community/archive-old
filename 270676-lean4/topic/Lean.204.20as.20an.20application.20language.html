---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html">Lean 4 as an application language</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="291544730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291544730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291544730">(Aug 01 2022 at 08:27)</a>:</h4>
<p>Hi, the Lean 4 language looks amazing and it would be awesome to use as an application language (currently I use Scala and Rust, but would prefer a pure FP language with dependent types). How viable is it to use as a general application development language currently (I believe that's at least a minor goal)? I use Scala.js a lot, which is great, and I don't believe Lean 4 has a JS backend. How much effort would it be to create a JS (or WASM) backend?</p>



<a name="291545276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545276">(Aug 01 2022 at 08:33)</a>:</h4>
<p>There have been talks about making a WASM backend, but in the short term that would probably only be compiling the generated C code to WASM</p>



<a name="291545296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545296">(Aug 01 2022 at 08:33)</a>:</h4>
<p>which is what we already do for the in-browser version of lean</p>



<a name="291545335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545335">(Aug 01 2022 at 08:34)</a>:</h4>
<p>And there's not much wrong with that, I believe</p>



<a name="291545378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545378">(Aug 01 2022 at 08:34)</a>:</h4>
<p>Prior discussion: <a href="#narrow/stream/270676-lean4/topic/Lean.204.20and.20WASM/near/242384891">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean.204.20and.20WASM/near/242384891</a></p>



<a name="291545561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545561">(Aug 01 2022 at 08:36)</a>:</h4>
<p>Would it be wise to make a WASM backend that directly emits WASM? I think it might be useful because if we emit WASM directly, we can emit a much smaller file.</p>



<a name="291545588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545588">(Aug 01 2022 at 08:36)</a>:</h4>
<p>I'm just asking. I'm not demanding anything, I swear!</p>



<a name="291545599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545599">(Aug 01 2022 at 08:36)</a>:</h4>
<p><span class="user-mention" data-user-id="130575">@Siddharth Bhat</span> was looking into that as a possible project</p>



<a name="291545746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545746">(Aug 01 2022 at 08:38)</a>:</h4>
<p>but also, keep in mind that if you directly emit WASM then you aren't getting any e.g. LLVM optimizations</p>



<a name="291545938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291545938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291545938">(Aug 01 2022 at 08:40)</a>:</h4>
<p>I'm not sure why a direct backend would generate smaller code than, say, LLVM optimizing for size; what makes you believe that? And as Mario said, you may still want some optimizations for <em>speed</em>. I don't know if anyone's profiled the costs and benefits of AOT optimization regarding the different WASM JITs yet.</p>



<a name="291546749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291546749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291546749">(Aug 01 2022 at 08:50)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Ok, that's possible of course, but maybe not the fastest turn around during development as LLVM is quite slow. With Scala.js the re-compilation is basically instant for small projects.</p>



<a name="291546923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291546923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291546923">(Aug 01 2022 at 08:52)</a>:</h4>
<p>Okay, but writing a good optimizing compiler is a tremendously huge project so it would be reasonable to expect that any homebrew solution will be much worse than an off-the-shelf compiler framework</p>



<a name="291547032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547032">(Aug 01 2022 at 08:53)</a>:</h4>
<p>For lean, you can run things on the spot as interpreted, but the compiler takes a bit longer</p>



<a name="291547146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547146">(Aug 01 2022 at 08:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I'm thinking more of a development build for quick iteration, and then use LLVM for final release build. This is basically what Scala.js does (but compiles to JavaScript instead)</p>



<a name="291547196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547196">(Aug 01 2022 at 08:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language/near/291547032">said</a>:</p>
<blockquote>
<p>For lean, you can run things on the spot as interpreted, but the compiler takes a bit longer</p>
</blockquote>
<p>Hmm, but that doesn't work if you call from JS or use browser API's right?</p>



<a name="291547198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547198">(Aug 01 2022 at 08:55)</a>:</h4>
<p>During development, you get live response in the editor. That's as quick iteration as you could ever ask for</p>



<a name="291547228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547228">(Aug 01 2022 at 08:55)</a>:</h4>
<p>You can even run JS code on the spot in the widget view</p>



<a name="291547372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547372">(Aug 01 2022 at 08:57)</a>:</h4>
<p>I don't know that much about scala.js but I don't think lean is trying to be a direct competitor</p>



<a name="291547481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547481">(Aug 01 2022 at 08:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language/near/291547198">said</a>:</p>
<blockquote>
<p>During development, you get live response in the editor. That's as quick iteration as you could ever ask for</p>
</blockquote>
<p>Ok, where is this online editor?</p>



<a name="291547576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547576">(Aug 01 2022 at 09:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language/near/291547372">said</a>:</p>
<blockquote>
<p>I don't know that much about scala.js but I don't think lean is trying to be a direct competitor</p>
</blockquote>
<p>It's just compiling Scala code to JS, with libraries providing access to JS API's (basically FFI). It uses the JS GC though.</p>



<a name="291547657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547657">(Aug 01 2022 at 09:00)</a>:</h4>
<p>The editor is VSCode, which is an electron app so it integrates with a node.js backend IIUC</p>



<a name="291547699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547699">(Aug 01 2022 at 09:01)</a>:</h4>
<p>I wouldn't recommend the online editor for serious application development</p>



<a name="291547812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547812">(Aug 01 2022 at 09:02)</a>:</h4>
<p>But let's say I want to call a Lean 4 function from JS and then render stuff in a HTML canvas, then I would have to compile to WASM using LLVM?</p>



<a name="291547829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547829">(Aug 01 2022 at 09:02)</a>:</h4>
<p>I'm saying you can literally do this in the editor, it shows up on the right side panel</p>



<a name="291547990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291547990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291547990">(Aug 01 2022 at 09:04)</a>:</h4>
<p>Hmm, in VS Code? Where would my canvas be rendered?</p>



<a name="291548145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291548145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291548145">(Aug 01 2022 at 09:06)</a>:</h4>
<p>It's a little outdated, but here's an example of a widget application: <a href="https://github.com/TwoFX/sudoku">https://github.com/TwoFX/sudoku</a></p>



<a name="291548207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291548207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291548207">(Aug 01 2022 at 09:06)</a>:</h4>
<p>Here's another one (Lean 3): <a href="https://github.com/kendfrey/rubiks-cube-group">https://github.com/kendfrey/rubiks-cube-group</a></p>



<a name="291548307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291548307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291548307">(Aug 01 2022 at 09:07)</a>:</h4>
<p>Oh, that's really cool! <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="291548511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291548511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291548511">(Aug 01 2022 at 09:09)</a>:</h4>
<p>So, you can also add user interaction, timers etc. on the page and re-evaluate Lean functions?</p>



<a name="291548944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291548944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291548944">(Aug 01 2022 at 09:14)</a>:</h4>
<p>The whole lean document is kept up to date, it's not like python worksheets where you have to run them in order. So re-evaluation happens transparently: if you edit the code you see the changes immediately</p>



<a name="291549014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291549014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291549014">(Aug 01 2022 at 09:15)</a>:</h4>
<p>and yes, you can put user interface elements in the page to interact with the widget</p>



<a name="291549092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291549092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291549092">(Aug 01 2022 at 09:16)</a>:</h4>
<p>I think one of those puzzle game examples allowed you to click on the puzzle and it would add the corresponding move to the source code</p>



<a name="291550102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291550102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291550102">(Aug 01 2022 at 09:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Can't seem to find that. How would I call/eval a Lean function from a JS function?</p>



<a name="291550218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291550218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291550218">(Aug 01 2022 at 09:26)</a>:</h4>
<p><span class="user-mention" data-user-id="121918">@Edward Ayers</span> and <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> are the ones to ask about Lean/JS integration</p>



<a name="291551753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291551753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291551753">(Aug 01 2022 at 09:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language/near/291550102">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> Can't seem to find that. How would I call/eval a Lean function from a JS function?</p>
</blockquote>
<p>Wow good timing, I am literally writing a tutorial on this now (for Lean 4) :) I can ping you when it's done.</p>



<a name="291552226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291552226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291552226">(Aug 01 2022 at 09:48)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> That would be awesome! I'm considering using it for simple game development, like updating game state based on user input and re-drawing a canvas or WebGL (similar to Elm examples).</p>



<a name="291553427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291553427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291553427">(Aug 01 2022 at 10:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language/near/291552226">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="128280">Wojciech Nawrocki</span> That would be awesome! I'm considering using it for simple game development, like updating game state based on user input and re-drawing a canvas or WebGL (similar to Elm examples).</p>
</blockquote>
<p>Then the Lean/JS interface will probably not be of much help to you, unfortunately. In this case "calling Lean from JS" means "making a remote procedure call", with JS running in a browser (or VSCode, which is a browser) and Lean running in the Lean language server. This is useful for accessing objects such as <code>Environment</code>s and <code>Expr</code>s which live in the server, but not so much for general-purpose "I would rather write this function in Lean" programming. Anything low-latency has to be written in JS. As others noted above, it would also be possible to <em>compile</em> Lean to JS/WASM so that it can run in the client, but afaik noone has gotten that to work so far.</p>



<a name="291554167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291554167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291554167">(Aug 01 2022 at 10:08)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> Yes, I realize that. I don't care much about performance during the initial development phase (it doesn't have to be realtime). And for later release build I would definitely compile to WASM using LLVM. But maybe I'm too early adopter of Lean 4 for such an application :)</p>



<a name="291555072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291555072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291555072">(Aug 01 2022 at 10:18)</a>:</h4>
<p><span class="user-mention" data-user-id="369607">@Jesper Nordenberg</span> another way to put it is that we currently have a way to invoke a remote Lean server from JS, but no way to invoke Lean code within the same execution environment that the JS is running in. So it's not just a question of performance but also ABI - to make RPC calls to remote Lean you need to encode data in various ways whereas a local call could pass it around directly. Additionally when the remote server is <em>actually</em> remote (i.e. on a separate machine rather than a different process on the same machine), the latency can be up in hundreds of ms which means you can really only make such calls sparingly.</p>



<a name="291556000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/291556000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#291556000">(Aug 01 2022 at 10:28)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> Ok, I suppose the only viable way is to compile to WASM then for testing</p>



<a name="292396403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/292396403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reinier van der Gronden <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#292396403">(Aug 08 2022 at 12:44)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> is your method of calling a Lean function from JS different from the <a href="https://leanprover.github.io/lean4/doc/examples/widgets.lean.html">User Widgets</a>? I'm investigating this right now because I want to talk between Lean code and infoview for code improvement suggestions, but it seems that one of your latests point on having to encode all data to the Lean server complicates the use of TacticM, because all MVars and contexts are likely difficult to communicate, currently widgets seem to build on top of TermElabM.</p>



<a name="292399195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/292399195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#292399195">(Aug 08 2022 at 13:10)</a>:</h4>
<p><span class="user-mention" data-user-id="507443">@Reinier van der Gronden</span> no, it is exactly the method described there. <a href="https://github.com/leanprover/lean4/blob/860d726d726ebd30a95ff95d192bb8a2fe55e30c/src/Lean/Widget/Basic.lean#L18">Here</a> is an example of how we can send a tactic context to and from the infoview. I suppose we should also have a section about this in the User Widgets tutorial.</p>



<a name="292548924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20as%20an%20application%20language/near/292548924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reinier van der Gronden <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20as.20an.20application.20language.html#292548924">(Aug 09 2022 at 09:51)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> Thanks for that pointer, I'll take a look!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>