---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html">Jump to definition across files, in lean4 repo</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="261575652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261575652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261575652">(Nov 15 2021 at 23:22)</a>:</h4>
<p>When I have the <code>lean4</code> repository open in VSCode (where I've use <code>elan override</code> to tell the extension to use Lean 4), jump-to-definition (F12) works great with in a single file, but I just get <code>No definition found</code> for any definitions coming from imports.</p>
<p>Does this work for others? Is it a known problem?</p>



<a name="261601772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261601772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261601772">(Nov 16 2021 at 06:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> nope, that has been my experience as well</p>



<a name="261601852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261601852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261601852">(Nov 16 2021 at 06:17)</a>:</h4>
<p>I mentioned this in an older thread (see <a href="#narrow/stream/270676-lean4/topic/Segfault.20due.20to.20mutual.20recursion.3F/near/255345029">here</a>), but <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> said it worked fined for him, so we were never able to hash out the problem.</p>



<a name="261601937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261601937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261601937">(Nov 16 2021 at 06:19)</a>:</h4>
<p>I made an issue at <a href="https://github.com/leanprover/vscode-lean4/issues/77">https://github.com/leanprover/vscode-lean4/issues/77</a></p>



<a name="261602200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602200">(Nov 16 2021 at 06:21)</a>:</h4>
<p>just pulled the latest lean, and it still seems to be working, although I forget if I have any relevant <code>elan override</code> settings</p>



<a name="261602274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602274">(Nov 16 2021 at 06:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">elan</span> <span class="n">override</span> <span class="n">list</span>
<span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">mario</span><span class="bp">/</span><span class="n">Documents</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span>                <span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">nightly</span>
<span class="bp">...</span>
</code></pre></div>



<a name="261602363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602363">(Nov 16 2021 at 06:24)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, well that is probably why it is working -- it is not actually pointing to the custom Lean build as describing in <a href="https://leanprover.github.io/lean4/doc/dev/index.html?highlight=dev#dev-setup-using-elan">dev setup for elan</a> section of the manual</p>



<a name="261602421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602421">(Nov 16 2021 at 06:25)</a>:</h4>
<p>ah right, I have not actually built lean</p>



<a name="261602425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602425">(Nov 16 2021 at 06:25)</a>:</h4>
<p>Yes, I'm seeing the same thing now. It works with the nightly, but not with a local toolchain.</p>



<a name="261602439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602439">(Nov 16 2021 at 06:25)</a>:</h4>
<p>if you look at to where its jumping to, you will probably notice it is going to the sources for the toolchain not those for the repo</p>



<a name="261602484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602484">(Nov 16 2021 at 06:26)</a>:</h4>
<p>yes, that's right</p>



<a name="261602510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602510">(Nov 16 2021 at 06:27)</a>:</h4>
<p>that is not the goal XD</p>



<a name="261602582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602582">(Nov 16 2021 at 06:28)</a>:</h4>
<p>I treat lean4 repo as read only anyway so it's not a big deal for me, but if the dev build version is broken then I guess that should be fixed</p>



<a name="261602635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261602635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261602635">(Nov 16 2021 at 06:29)</a>:</h4>
<p>I've updated the desciption in the issue to reflect all this.</p>



<a name="261603663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261603663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261603663">(Nov 16 2021 at 06:50)</a>:</h4>
<p>Yes I have the same problem. As a partial solution, I have set <code>CMAKE_INSTALL_PREFIX</code> to point to <code>~/.elan/toolchain</code> and when rebuilding I run <code>make install</code>. Now jumping to definition works but jumps to the installed files in elan directory instead of the file in repo.</p>



<a name="261614678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261614678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261614678">(Nov 16 2021 at 09:20)</a>:</h4>
<p>As posted on the vscode-lean4 issue, this is a known problem:</p>
<p>Local builds don't know where the sources are.  There are several "solutions" for this:</p>
<ul>
<li>Set the <code>LEAN_SRC_PATH</code> environment variable.</li>
<li><code>ln -s ~/lean4/src/ ~/lean4/build/release/stage1/lib/lean/</code></li>
</ul>
<p>Ideally, they'd be able to figure out the source path automatically, but that's a <code>lean4</code> issue not a <code>vscode-lean4</code> one.</p>



<a name="261614890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261614890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261614890">(Nov 16 2021 at 09:22)</a>:</h4>
<p>Yes, the first bullet is documented at <a href="https://github.com/kha/lean4/blob/781a28b8f4badddbc01d1a8a6822128d5173c65a/doc/dev/index.md?plain=1#L30-L33">https://github.com/kha/lean4/blob/781a28b8f4badddbc01d1a8a6822128d5173c65a/doc/dev/index.md?plain=1#L30-L33</a>. We could automate the second bullet in cmake on Unix platforms.</p>



<a name="261614968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261614968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261614968">(Nov 16 2021 at 09:23)</a>:</h4>
<p>The symlink is not ideal either, because go-to-definition now goes to a different path than the actual source files.  But it's definitely a less confusing out-of-the-box experience.</p>



<a name="261615046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Jump%20to%20definition%20across%20files%2C%20in%20lean4%20repo/near/261615046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Jump.20to.20definition.20across.20files.2C.20in.20lean4.20repo.html#261615046">(Nov 16 2021 at 09:24)</a>:</h4>
<p>Ahh... we <em>could</em> <code>realPath</code> it</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>