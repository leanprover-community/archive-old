---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/LeanMySQL.20feedback.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html">LeanMySQL feedback</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="263242499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263242499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263242499">(Dec 01 2021 at 04:12)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> any tip/idea on how to make it a bit simpler/straightforward than having to write <code>colProp%</code> everytime?</p>



<a name="263243383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263243383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263243383">(Dec 01 2021 at 04:33)</a>:</h4>
<p>Actually wait, I need to think of the use cases better</p>



<a name="263243530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263243530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263243530">(Dec 01 2021 at 04:36)</a>:</h4>
<p>you could make <code>filter</code> a macro which takes a <code>colProp</code> and produces a <code>term</code></p>



<a name="263259056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263259056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263259056">(Dec 01 2021 at 08:44)</a>:</h4>
<p>Might as well go full LINQ at this point</p>



<a name="263259462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263259462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263259462">(Dec 01 2021 at 08:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/263054245">said</a>:</p>
<blockquote>
<p>Is there a way to hide things from the API user? Or this is not a thing in Lean?</p>
</blockquote>
<p><code>private</code> is as much a thing in Lean programming as in other languages. While it's true that it can be counterproductive for <em>proving</em>, it is extremely unlikely that code that was not designed to be reasoned about from the very beginning will ever be reasoned about. So you should not worry about it.</p>



<a name="263288343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263288343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263288343">(Dec 01 2021 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> incidental reasoning still appears (e.g., for things like <code>Array.get</code>). Also, like <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> , I think <code>private</code> in general is (in most cases) a bad idea. </p>
<p>It makes sense in purely compiled languages where the compiler can use that information to do smarter optimizations because it knows the symbols won't be used outside the current target. For a  highly reflective language like Lean, though, where it is still perfectly possible circumvent <code>private</code> with tricks, it just makes for bad UX.  </p>
<p>For example, there are a number of <code>private</code> definitions in the Lean core that I have had to copy paste into various projects because I needed to use them. One good example that has been brought up in the <code>doc-gen4</code> discussion is <code>Name.isBlacklisted</code>.</p>



<a name="263291191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263291191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263291191">(Dec 01 2021 at 13:41)</a>:</h4>
<p>Is there any use for the <code>private</code> keyword at all in your opinion then?</p>



<a name="263291200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263291200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263291200">(Dec 01 2021 at 13:41)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span></p>



<a name="263292497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263292497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263292497">(Dec 01 2021 at 13:51)</a>:</h4>
<p><span class="user-mention" data-user-id="395550">@Henrik Böving</span> I think it works fine for auxiliary functions to <code>partial</code> definitions (though <code>where</code> clauses are an alternative there) and for some tricks with runtime unsafe code like <a href="https://github.com/leanprover/lean4/blob/5c39ddbad1bd187a4db71610bc874c402ae24356/src/Init/Prelude.lean#L2141"><code>Macro.MethodsRefPointed</code></a> where an end user fiddling with the definition directly can break invariants and be quite bad.</p>
<p>But, in general, no, I don't think <code>private</code> should be used (an opinion I believe is shared by <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>).</p>



<a name="263292768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263292768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263292768">(Dec 01 2021 at 13:52)</a>:</h4>
<p>Auxiliary definitions in general can't be <code>private</code>, since that's often where you want to start when proving properties about an operation. If it's a <code>partial</code> definition you are already hosed though, so I agree with <span class="user-mention" data-user-id="315577">@Mac</span> 's assessment</p>



<a name="263292957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263292957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263292957">(Dec 01 2021 at 13:54)</a>:</h4>
<p>I think of <code>private</code> as the keyword to use when you want someone to curse your name 2 years later</p>



<a name="263293998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263293998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263293998">(Dec 01 2021 at 14:00)</a>:</h4>
<p>I like to think of  the proper use of <code>private</code> in  program languages as "if an user interacts with this directly, the computer is likely to halt and catch fire". In imperative languages, <code>private</code> is thus most apt for black magic implementation details. In a declarative, functional language like Lean, though, such black magic should be vanishingly rare (and thus the use of <code>private</code> as well).</p>



<a name="263295890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263295890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263295890">(Dec 01 2021 at 14:13)</a>:</h4>
<p><code>private</code> can also be seen as a means to simplify APIs, so the user can focus on learning how to make use of the lib more easily</p>



<a name="263295966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263295966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263295966">(Dec 01 2021 at 14:13)</a>:</h4>
<p>"Look at this HUGE lib, but you can make full usage of its potential with these 4 functions"</p>



<a name="263296031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263296031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263296031">(Dec 01 2021 at 14:14)</a>:</h4>
<p>I think another mechanism should be used for that, analogous to rust's <code>#[doc(hidden)]</code></p>



<a name="263296179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263296179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263296179">(Dec 01 2021 at 14:15)</a>:</h4>
<p>we've talked about a mechanized version of the "main definitions" section in mathlib files before using some kind of <code>@[main_definition]</code> attribute</p>



<a name="263296194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263296194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263296194">(Dec 01 2021 at 14:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/263295890">said</a>:</p>
<blockquote>
<p><code>private</code> can also be seen as a means to simplify APIs, so the user can focus on learning how to make use of the lib more easily</p>
</blockquote>
<p>The problem is that it also prevents more advanced users from adapting it to suit their needs.</p>



<a name="263296845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263296845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263296845">(Dec 01 2021 at 14:19)</a>:</h4>
<p>I wonder whether it would be effective to just count mathlib-internal lemma uses to get a pretty accurate usefulness metric for theorems in a mathlib file. (This could also apply to anything generated by doc-gen, but mathlib probably has enough internal uses that it is not misleading except for leaf theorems)</p>



<a name="263297086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263297086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263297086">(Dec 01 2021 at 14:21)</a>:</h4>
<p>Re-sorting lemmas is sometimes problematic though, because order in the source is also a useful signal for relevance</p>



<a name="263297506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263297506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263297506">(Dec 01 2021 at 14:24)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> instead of re-sorting the lemma, one could just stick a <code>Popular definitions: foo, bar, etc.</code> string with a links to said definitions at the bottom of the module introduction.</p>



<a name="263300013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263300013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263300013">(Dec 01 2021 at 14:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/263297506">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> instead of re-sorting the lemma, one could just stick a <code>Popular definitions: foo, bar, etc.</code> string with a links to said definitions at the bottom of the module introduction.</p>
</blockquote>
<p>I think something machine parsable would be nicer for this, that way one could for example also have these lemmas rank higher in auto complete suggestions.</p>



<a name="263300163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263300163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263300163">(Dec 01 2021 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="395550">@Henrik Böving</span> ah, sorry, I meant at the bottom of the introduction in the generated module documentation, not in the module docstring (i.e., the popular lemma would be automatically deduced from usage data as Mario was suggesting).</p>



<a name="263300345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263300345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263300345">(Dec 01 2021 at 14:42)</a>:</h4>
<p>Ahh, that certainly sounds nice yes, although I'm still far from that with my doc-gen4 stuff <em>takes note</em></p>



<a name="263308929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263308929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263308929">(Dec 01 2021 at 15:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/263295890">said</a>:</p>
<blockquote>
<p><code>private</code> can also be seen as a means to simplify APIs, so the user can focus on learning how to make use of the lib more easily</p>
</blockquote>
<p>In C++ this is often <a href="https://stackoverflow.com/questions/26546265/what-is-the-detail-namespace-commonly-used-for">done</a> by hiding implementation details into <code>internal</code> or <code>detail</code> namespace. The same can be done in Lean and does not prevent user from reasoning about your code.</p>



<a name="263310771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263310771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263310771">(Dec 01 2021 at 15:51)</a>:</h4>
<p>indeed, you will find lots of definitions in mathlib with <code>_aux</code> in their names, used to evoke exactly this sense of internalness. For example <a href="https://leanprover-community.github.io/mathlib_docs/find/list.permutations_aux">docs#list.permutations_aux</a> is called that because you probably don't want to be using it unless you know what you are doing, but it nevertheless has a bunch of theorems about it, like <a href="https://leanprover-community.github.io/mathlib_docs/find/list.mem_permutations_aux_of_perm">docs#list.mem_permutations_aux_of_perm</a> (naturally, in order to prove theorems about <a href="https://leanprover-community.github.io/mathlib_docs/find/list.permutations">docs#list.permutations</a>)</p>



<a name="263311751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263311751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263311751">(Dec 01 2021 at 15:57)</a>:</h4>
<p>Thanks for such a rich set of ideas!</p>



<a name="263317296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263317296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263317296">(Dec 01 2021 at 16:31)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I wonder if <code>private</code> would be more useful if it were like <code>protected</code> but put its definition in a namespace called <code>private</code> and opened the private namespace.  For example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">baz</span>

<span class="kn">private</span> <span class="kd">def</span> <span class="n">frobnicate_whatsits</span> <span class="o">:</span> <span class="n">IO</span> <span class="o">()</span> <span class="o">:=</span> <span class="bp">...</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">IO</span> <span class="o">()</span> <span class="o">:=</span> <span class="n">frobnicate_whatsits</span>

<span class="kd">end</span> <span class="n">baz</span>
</code></pre></div>
<p>would be like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">baz</span>

<span class="kn">namespace</span> <span class="kn">private</span>

<span class="kd">def</span> <span class="n">frobnicate_whatsits</span> <span class="o">:</span> <span class="n">IO</span> <span class="o">()</span> <span class="o">:=</span> <span class="bp">...</span>

<span class="kd">end</span> <span class="kn">private</span>
<span class="kn">open</span> <span class="kn">private</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">IO</span> <span class="o">()</span> <span class="o">:=</span> <span class="n">frobnicate_whatsits</span>

<span class="kd">end</span> <span class="n">baz</span>
</code></pre></div>
<p>Then outside the <code>baz</code> namespace, you'd have to go out of your way to refer to <code>baz.private.frobnicate_whatsits</code>, but it's still referenceable.</p>



<a name="263317925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263317925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263317925">(Dec 01 2021 at 16:35)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> that would make <code>private</code> extremely trivial syntactic sugar: <code>private def foo</code> would just be short for <code>def private.foo</code></p>



<a name="263318167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263318167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263318167">(Dec 01 2021 at 16:36)</a>:</h4>
<p>Don't forget that I'm suggesting it also be extremely trivial syntactic sugar for <code>open private</code> so that you can refer to it without <code>private</code>.</p>



<a name="263318465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263318465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263318465">(Dec 01 2021 at 16:38)</a>:</h4>
<p>At least in Lean 3, defining something as <code>def private.foo</code> can be different from <code>def foo</code> because in a recursive function it seems you need to use the full name.</p>



<a name="263318629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263318629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263318629">(Dec 01 2021 at 16:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/263318465">said</a>:</p>
<blockquote>
<p>At least in Lean 3, defining something as <code>def private.foo</code> can be different from <code>def foo</code> because in a recursive function it seems you need to use the full name.</p>
</blockquote>
<p>that is not true in Lean 4 anymore, <code>def foo.bar</code> is literally just syntactic sugar for <code>namespace foo; def bar; end foo</code>.</p>



<a name="263318974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263318974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263318974">(Dec 01 2021 at 16:41)</a>:</h4>
<p>I can't tell, is it being trivial syntactic sugar an objection?</p>



<a name="263319336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263319336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263319336">(Dec 01 2021 at 16:43)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> yeah, while I don't think the current <code>private</code> should be used often, there are cases were it is appropriate and it does do something more complex than what you are proposing (which doesn't seem worth the sugar in my honest opinion).</p>



<a name="263320735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263320735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263320735">(Dec 01 2021 at 16:52)</a>:</h4>
<p>While the current <code>private</code> might sometimes be appropriate, is it <em>necessary</em>? The reasoning behind this proposal is that it's sort of the minimal functionality to make it feel like Lean has a <code>private</code> modifier, but it still makes the definitions available enough for proofs.</p>
<p>A more complicated proposal is that anything that's <code>private</code> becomes noncomputable outside where it should be used (or some other mechanism to prevent you from evaluating private definitions).</p>



<a name="263321058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263321058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263321058">(Dec 01 2021 at 16:55)</a>:</h4>
<p>Three words that have been around my head: <code>private</code>, <code>secret</code> and <code>internal</code>. Maybe having different behaviors available can help</p>



<a name="263383719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/263383719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#263383719">(Dec 02 2021 at 01:47)</a>:</h4>
<p>I've finished the first "stable" version of <code>LeanMySQL</code> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <br>
<a href="https://github.com/arthurpaulino/LeanMySQL">https://github.com/arthurpaulino/LeanMySQL</a><br>
I've dropped some problematic approaches and decided to keep this initial version simple.<br>
Feedback is more than welcome!</p>
<p>And thanks everyone for the support <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>



<a name="274177603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274177603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274177603">(Mar 04 2022 at 19:30)</a>:</h4>
<p><span class="user-mention" data-user-id="434989">@Chris Lovett</span> and <span class="user-mention" data-user-id="463095">@Yuri de Wit</span> I read what you said <a href="#narrow/stream/270676-lean4/topic/new.20lean4-samples.20repo/near/274075023">here</a> so I brought the conversation to this more specific thread.</p>
<p>The <code>LeanMySQL</code> package has evolved since the last time I shared news about it and the next step is precisely providing a better API for queries. I've been thinking about a simple SQL DSL.</p>
<p>I don't think I've fully understood the ideas you guys mentioned. Are you talking about a way to make lean query the database at compile time (while writing Lean code) like <a href="https://raw.githubusercontent.com/fsprojects/SQLProvider/master/docs/files/sqlprovider.gif">this</a>?</p>
<div class="message_inline_image"><a href="https://raw.githubusercontent.com/fsprojects/SQLProvider/master/docs/files/sqlprovider.gif" title="this"><img src="https://uploads.zulipusercontent.net/4eae66ad5080264948f5f451fa23b722f6c292f6/68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f667370726f6a656374732f53514c50726f76696465722f6d61737465722f646f63732f66696c65732f73716c70726f76696465722e676966"></a></div>



<a name="274177973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274177973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274177973">(Mar 04 2022 at 19:33)</a>:</h4>
<p>I vaguely remember <span class="user-mention" data-user-id="306601">@Kyle Miller</span> providing a link to that F# page too</p>



<a name="274178722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274178722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274178722">(Mar 04 2022 at 19:38)</a>:</h4>
<p>I was thinking only of the language integrated query aspects of this kind of integration, being able to query the database live for metadata to provide intellisense fricken cool too.  If we could do both that would rock.  Is Lean4 InfoTree extensible enough to do that?</p>



<a name="274179047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274179047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274179047">(Mar 04 2022 at 19:41)</a>:</h4>
<p>I <em>suspect</em> it's possible, but I still haven't been able to make custom C code computations available via FFI like that. I've always been reliant on using the computation of C code inside the IO monad on built Lean code.</p>
<p>On your question about the InfoTree, I don't know the InfoTree is</p>



<a name="274179746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274179746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274179746">(Mar 04 2022 at 19:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="434989">Chris Lovett</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/274178722">said</a>:</p>
<blockquote>
<p>I was thinking only of the language integrated query aspects of this kind of integration</p>
</blockquote>
<p>Can you explain this in more detail? I couldn't grasp the idea</p>



<a name="274179915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274179915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yuri de Wit <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274179915">(Mar 04 2022 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Yes, that is exactly it. Really useful when integrating common external models such as SQL but could be anything including C headers, etc. However, it is way less important than a proper SQL DSL  (LINQ or otherwise).</p>



<a name="274180246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274180246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274180246">(Mar 04 2022 at 19:52)</a>:</h4>
<p>Language integrated query to me is just how they added "from", "select", "groupby", and "join" as keywords to C# and F#? so that you can write SQL queries in the language in a first class way rather than embedding the SQL query in an opaque string literal which was the old fashioned way of doing things before LINQ came along...</p>



<a name="274180376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274180376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274180376">(Mar 04 2022 at 19:53)</a>:</h4>
<p>Lean4 has extensible syntax so this part should be easy to do in Lean4...</p>



<a name="274180539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274180539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274180539">(Mar 04 2022 at 19:54)</a>:</h4>
<p>I see, thanks. I get it now. I'm going for it!</p>



<a name="274181773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274181773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274181773">(Mar 04 2022 at 20:04)</a>:</h4>
<p>You should basically be able to declare a bunch of <code>syntax</code> + a custom <code>TermElab</code> (I suspect this might be too hard for just a <code>macro_rules</code> to get right) to elaborate some sort of built-in query language to something one can pass to the SQL server/whatever</p>



<a name="274183275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274183275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274183275">(Mar 04 2022 at 20:16)</a>:</h4>
<p><span class="user-mention" data-user-id="463095">@Yuri de Wit</span> I can see it working if I declare a representation of the schemes in Lean by hand, but I don't know how to make Lean query the schemes dynamically like that</p>



<a name="274205640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274205640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yuri de Wit <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274205640">(Mar 05 2022 at 00:02)</a>:</h4>
<p>I am not entirely sure, but I am afraid it would require some support from the compiler.</p>



<a name="274241767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274241767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274241767">(Mar 05 2022 at 12:50)</a>:</h4>
<p>I was able to get a minimal DSL for simple "select from where"-like queries that's able to express things like <a href="https://github.com/arthurpaulino/LeanMySQL/blob/7feb06b8e008ccbd9c2a49daca9cf3e151541037/lib/SQL.lean#L91">this</a>.</p>
<p>But I have no idea how to build a syntax for it. I would like to be able to write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">q</span> <span class="o">:</span> <span class="n">SQLQuery</span> <span class="o">:=</span> <span class="n">SELECT</span> <span class="n">name</span><span class="o">,</span> <span class="n">age</span> <span class="n">FROM</span> <span class="n">person</span> <span class="n">WHERE</span> <span class="n">age</span> <span class="bp">&gt;=</span> <span class="mi">20</span>
</code></pre></div>
<p>Help is very much appreciated <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span><br>
By "help" I mean any help. Examples, documentation etc</p>



<a name="274251876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274251876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274251876">(Mar 05 2022 at 16:24)</a>:</h4>
<p>You can look at Mac's lean4-alloy which defines quite an extensive amount of syntax, there is also lots of syntax declarations to be viewed in the compiler you can grep for and a few examples on how to custom syntax in the docs folder.</p>



<a name="274251992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274251992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Florian Würmseer <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274251992">(Mar 05 2022 at 16:27)</a>:</h4>
<p>Hi, speaking of SQL and feedback, I'm trying to get my feet wet with Lean (and functional programming). I investigated a little bit about <span class="user-mention" data-user-id="395550">@Henrik Böving</span> s approach of using custom syntax and TermElab. I was able to get simple SELECT FROM queries working, but it felt more tedious than it should be. I'd be more than happy to receive some feedback (Especially before I move to more complex syntax like Where and Having) on the <a href="https://github.com/FWuermse/lean-postgres">project</a> to make sure this is the right way to do custom syntax and other things. Although this is for postgres, the dialects don't differ that much, and I'm hoping we can generalize queries like syntax in the future.</p>



<a name="274253408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274253408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274253408">(Mar 05 2022 at 16:57)</a>:</h4>
<p>Nice pointers! <code>alloy</code> is indeed a rich example.</p>
<p><span class="user-mention" data-user-id="466861">@Florian Würmseer</span>, I definitely think we can merge efforts with more granular packages. I'm really happy to know that you're doing something similar <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span></p>



<a name="274253867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274253867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddharth Bhat <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274253867">(Mar 05 2022 at 17:03)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> If you like, there's more examples over at <a href="https://github.com/opencompl/lean-mlir/blob/master/MLIR/EDSL.lean#L114-L120"><code>opencompl/lean-mlir/EDSL.lean</code></a>, which follows exactly the grammar defined over at <a href="https://github.com/joker-eph/llvm-project-with-mlir/blob/master/mlir/g3doc/LangRef.md#type-system">MLIR/LangRef.md</a>. This maybe useful to see a <code>1:1</code> translation :)</p>



<a name="274253955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274253955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274253955">(Mar 05 2022 at 17:05)</a>:</h4>
<p>Well sadly we are in SQL land so there is no "the grammar" there is a grammar for every dialect :/</p>



<a name="274279533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274279533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274279533">(Mar 06 2022 at 02:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="466861">Florian Würmseer</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/274251992">said</a>:</p>
<blockquote>
<p>I'd be more than happy to receive some feedback</p>
</blockquote>
<p>I'm unsure about accepting a list of tables on the <code>FROM</code> clause (I'm checking your code)</p>



<a name="274295529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274295529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274295529">(Mar 06 2022 at 09:23)</a>:</h4>
<p>Also I don't think we're supposed to perform matches against those autogenerated syntax terms like <code>`Query.col_AS_</code>. I am (slowly) figuring it out by looking at all sources provided (including your project) and also based on some limited experience writing a few tactics in Lean 4. Will let you know as soon as I achieve something more concrete</p>



<a name="274400612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274400612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274400612">(Mar 07 2022 at 14:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/LeanMySQL.20feedback/near/274295529">said</a>:</p>
<blockquote>
<p>Also I don't think we're supposed to perform matches against those autogenerated syntax terms like <code>`Query.col_AS_</code>. </p>
</blockquote>
<p>Yeah this is not the way. <span class="user-mention" data-user-id="466861">@Florian Würmseer</span> , I've created <a href="https://github.com/FWuermse/lean-postgres/pull/1">a PR</a> for your project that makes the elaboration code more idiomatic. For the syntax implemented so far, you could also get away with macros, but maybe you'll eventually need more power.</p>



<a name="274439415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274439415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Florian Würmseer <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274439415">(Mar 07 2022 at 18:49)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="451983">@Arthur Paulino</span> and <span class="user-mention" data-user-id="256311">@Jannis Limperg</span>  for the feedback! Very much appreciated. And your pull request really helped me to understand the Syntax and original intention of termElabs.</p>



<a name="274442636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274442636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yuri de Wit <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274442636">(Mar 07 2022 at 19:12)</a>:</h4>
<p>Interesting ... looking a the PR created by <span class="user-mention" data-user-id="256311">@Jannis Limperg</span> , I was also <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span> over it as it is a bit different than what I read in another document (I think the official one?).</p>
<p>I would also have reached out to declare_syntax_cat and company, but probably just for a single category for the whole DSL.</p>



<a name="274446089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274446089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274446089">(Mar 07 2022 at 19:38)</a>:</h4>
<p>My pleasure! No claims that this code is in any way optimal btw, it still doesn't feel particularly elegant to me.</p>



<a name="274448573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274448573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274448573">(Mar 07 2022 at 19:56)</a>:</h4>
<p>I'm needing some help too. I'm seeing myself writing repeated code because of parentheses. For example, on <a href="https://github.com/arthurpaulino/LeanMySQL/blob/255f1dbc0e9dbd8090c2b512d58188ba58b11b9c/lib/SQLSyntax.lean#L88-L89">these two lines</a>, I've written match cases that are very similar and have the same consequences.</p>
<p>Is there a way to avoid this duplication hell? It's gonna get worse once I write the match cases for <code>sqlProp</code> <span aria-label="scared" class="emoji emoji-1f628" role="img" title="scared">:scared:</span></p>



<a name="274448776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274448776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274448776">(Mar 07 2022 at 19:58)</a>:</h4>
<p>Why do you have non-nestable parentheses like that?</p>



<a name="274448805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274448805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274448805">(Mar 07 2022 at 19:58)</a>:</h4>
<p>You could always call yourself recursively in the paren case</p>



<a name="274448955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274448955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274448955">(Mar 07 2022 at 20:00)</a>:</h4>
<p>I see what you mean. I'll do some work</p>



<a name="274449009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449009">(Mar 07 2022 at 20:00)</a>:</h4>
<p>Thanks!</p>



<a name="274449033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449033">(Mar 07 2022 at 20:00)</a>:</h4>
<p>I'm not sure why the <code>sqlProp</code> case would be particularly bad</p>



<a name="274449160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449160">(Mar 07 2022 at 20:00)</a>:</h4>
<p>you should have a function for "get value from ident" or whatever you need to make the six relational operators work</p>



<a name="274449215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449215">(Mar 07 2022 at 20:01)</a>:</h4>
<p>in any case you can make it six calls to a function for relational operators</p>



<a name="274449465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449465">(Mar 07 2022 at 20:02)</a>:</h4>
<p>It would be bad for the <code>sqlProp</code> case because each side of the operator can be inside parens too</p>



<a name="274449537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449537">(Mar 07 2022 at 20:03)</a>:</h4>
<p>But I can kill it all with the recursive call. I'll try that</p>



<a name="274449732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274449732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274449732">(Mar 07 2022 at 20:04)</a>:</h4>
<p>Normally you would handle that by having a grammar construction like <code>syntax "(" sqlProp ")" : sqlProp</code> and then it only has to be handled once</p>



<a name="274450033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274450033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274450033">(Mar 07 2022 at 20:07)</a>:</h4>
<p>For the first case it's a bit trickier because the parens don't always cover the entire syntax:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">declare_syntax_cat</span>                  <span class="n">selectField</span>
<span class="n">syntax</span> <span class="n">ident</span>                      <span class="o">:</span> <span class="n">selectField</span>
<span class="n">syntax</span> <span class="n">ident</span> <span class="s2">" AS "</span> <span class="n">ident</span>         <span class="o">:</span> <span class="n">selectField</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">ident</span> <span class="s2">")"</span>              <span class="o">:</span> <span class="n">selectField</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">ident</span> <span class="s2">")"</span> <span class="s2">" AS "</span> <span class="n">ident</span> <span class="o">:</span> <span class="n">selectField</span>
</code></pre></div>



<a name="274450077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274450077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274450077">(Mar 07 2022 at 20:07)</a>:</h4>
<p>but it's definitely manageable with a new <code>declare_syntax_cat</code></p>



<a name="274454728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274454728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274454728">(Mar 07 2022 at 20:46)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I make heavy use of <code>private</code>, and I think it is very useful when maintaining the code. It makes it clear the function should not be used in other modules. It also helps accidental misuse when the function makes many assumptions about the input arguments. It also makes it clear to Lean users they should not assume this function will exist forever. </p>
<blockquote>
<p>For a highly reflective language like Lean, though, where it is still perfectly possible circumvent private with tricks, it just makes for bad UX.</p>
</blockquote>
<p>Sure, you can circumvent with tricks, but you cannot complain when things break if you use this kind of trick. </p>
<blockquote>
<p>In imperative languages, private is thus most apt for black magic implementation details. </p>
</blockquote>
<p>This is not true . <code>private</code> (<code>static</code>) is heavily used in many projects to hide implementation details from others even when there is no black magic.</p>



<a name="274455264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274455264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274455264">(Mar 07 2022 at 20:50)</a>:</h4>
<p>(sorry for the little mess btw. I wanted to rename the thread I created but for some reason Zulip split it in two)</p>



<a name="274457981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274457981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274457981">(Mar 07 2022 at 21:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112857">Leonardo de Moura</span> Since this thread is quite old, I am not going to resurrect it. However, I do appreciate hearing your thoughts on the topic, even if I (and <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> ) disagree.</p>



<a name="274458558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/LeanMySQL%20feedback/near/274458558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/LeanMySQL.20feedback.html#274458558">(Mar 07 2022 at 21:14)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I thought it was a new thread since it was on the top today. It seems it accidentally moved to the top when Arthur renamed some thread.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>