---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Nontrivial.20HEq.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Nontrivial.20HEq.html">Nontrivial HEq</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="312628478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Nontrivial%20HEq/near/312628478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Nontrivial.20HEq.html#312628478">(Nov 28 2022 at 13:34)</a>:</h4>
<p>I've asked in a <a href="#narrow/stream/270676-lean4/topic/.E2.9C.94.20Simple.20HEq">previous thread</a> how to prove a simple heterogeneous equality. Unfortunately that didn't work for my real project, so I've come up with a more complex MWE:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">Graph</span>            <span class="o">:</span> <span class="kt">Type</span>                                  <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">Path</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Graph</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span>                                  <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">Path.final</span>       <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span> <span class="bp">→</span> <span class="kt">Type</span>                         <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">Path.NonEmpty</span>    <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span> <span class="bp">→</span> <span class="kt">Prop</span>                         <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">Path.SamePrefix</span>  <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span> <span class="bp">→</span> <span class="n">Path</span> <span class="n">g</span> <span class="bp">→</span> <span class="kt">Prop</span>                <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">Path.final'</span>      <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span><span class="o">)</span> <span class="bp">→</span> <span class="n">Path.NonEmpty</span> <span class="n">p</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">def</span> <span class="n">Sibling</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">p'</span> <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span> <span class="bp">//</span> <span class="n">Path.SamePrefix</span> <span class="n">p</span> <span class="n">p'</span> <span class="o">}</span>
<span class="kd">structure</span> <span class="n">Leaf</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Graph</span><span class="o">)</span> <span class="n">where</span> <span class="n">path</span> <span class="o">:</span> <span class="n">Path</span> <span class="n">g</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Graph</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">Leaf</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Sibling</span> <span class="n">l.path</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">s.val.final</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">Path.NonEmpty</span> <span class="n">s.val</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">s.val.final</span> <span class="bp">=</span> <span class="n">s.val.final'</span> <span class="n">hn</span><span class="o">)</span> <span class="o">:</span> <span class="n">HEq</span> <span class="n">f</span> <span class="o">(</span><span class="n">hf</span> <span class="bp">▸</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="gr">sorry</span>
</code></pre></div>
<p>Again the goal is in a sense trivial as it feels intuitively obvious that a type cast should produce something heterogeneously equal (perhaps my intuition fails me here?). But I don't know how to solve this proof.<br>
Any guidance on how to approach this would be appreciated :)</p>



<a name="312629164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Nontrivial%20HEq/near/312629164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Nontrivial.20HEq.html#312629164">(Nov 28 2022 at 13:38)</a>:</h4>
<p>This is <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=cast_heq#doc">docs4#cast_heq</a></p>



<a name="312629225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Nontrivial%20HEq/near/312629225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Nontrivial.20HEq.html#312629225">(Nov 28 2022 at 13:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">Graph</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">Leaf</span> <span class="n">g</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Sibling</span> <span class="n">l.path</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">s.val.final</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">Path.NonEmpty</span> <span class="n">s.val</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">s.val.final</span> <span class="bp">=</span> <span class="n">s.val.final'</span> <span class="n">hn</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">HEq</span> <span class="n">f</span> <span class="o">(</span><span class="n">hf</span> <span class="bp">▸</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">cast_heq</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
</code></pre></div>



<a name="312676564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Nontrivial%20HEq/near/312676564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marcus Rossel <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Nontrivial.20HEq.html#312676564">(Nov 28 2022 at 17:10)</a>:</h4>
<p>Hmm, this still doesn't work for my real project. I'll try to refine the MWE.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>