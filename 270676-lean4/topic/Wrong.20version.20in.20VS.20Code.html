---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html">Wrong version in VS Code</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="302768241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768241">(Oct 07 2022 at 01:33)</a>:</h4>
<p>Hi! I am updating my toolchain to <code>leanprover/lean4:nightly-2022-10-06</code>. After the code fixes, I am now able to run <code>lake build</code>. But, in VS Code, it's behaving as if I were still using the previous version (<code>leanprover/lean4:nightly-2022-07-11</code>). So the code compiles via terminal but it's completely broken in VS Code. Has anyone seen anything similar?</p>



<a name="302768633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768633">(Oct 07 2022 at 01:38)</a>:</h4>
<p>It sounds vaguely familiar but if I have seen it before I don't remember what I did. Maybe try <code>elan show</code> in the terminal to see if there are any overrides?</p>



<a name="302768678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768678">(Oct 07 2022 at 01:39)</a>:</h4>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>λ elan show
installed toolchains
--------------------

stable
leanprover/lean4:nightly
leanprover/lean4:nightly-2022-07-11 (default)
leanprover/lean4:nightly-2022-07-16
leanprover/lean4:nightly-2022-09-11
leanprover/lean4:nightly-2022-10-06

active toolchain
----------------

leanprover/lean4:nightly-2022-10-06 (overridden by '/home/arthur/dev/lean/viper/lean-toolchain')
Lean (version 4.0.0-nightly-2022-10-06, commit b172ba8a34e7, Release)
</code></pre></div>



<a name="302768843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768843">(Oct 07 2022 at 01:41)</a>:</h4>
<p>Apparently it's picking that "default" toolchain. How can I make it pick the toolchain defined in my <code>lean-toolchain</code> file?</p>



<a name="302768849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768849">(Oct 07 2022 at 01:41)</a>:</h4>
<p>Check <code>elan override help</code>. Maybe <code>elan override unset</code>?</p>



<a name="302768941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302768941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302768941">(Oct 07 2022 at 01:42)</a>:</h4>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>λ elan override unset
info: no override toolchain for '/home/arthur/dev/lean/viper'
info: you may use `--path &lt;path&gt;` option to remove override toolchain for a specific path
</code></pre></div>



<a name="302769152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769152">(Oct 07 2022 at 01:45)</a>:</h4>
<p>I think I am out of ideas. It is strange that <code>elan show</code> says <code>overridden</code> but then <code>elan override unset</code> disagrees. But I really don't understand why using the command line in the root folder would yield a different result than VS Code.</p>



<a name="302769456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769456">(Oct 07 2022 at 01:50)</a>:</h4>
<p>"override" here just means that it picks up the version from the <code>lean-toolchain</code> file</p>



<a name="302769494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769494">(Oct 07 2022 at 01:50)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Have you restarted VS Code?</p>



<a name="302769540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769540">(Oct 07 2022 at 01:51)</a>:</h4>
<p>Also, sometimes deleting the <code>build</code> directory helps.</p>



<a name="302769686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769686">(Oct 07 2022 at 01:54)</a>:</h4>
<p>Yes, I have restarted VS Code. I have also deleted the <code>build</code> folder</p>



<a name="302769714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769714">(Oct 07 2022 at 01:54)</a>:</h4>
<p>Another thing to try: run the "select toolchain" command, click "other", and then press enter. See also <a href="https://github.com/leanprover/vscode-lean4/issues/79">https://github.com/leanprover/vscode-lean4/issues/79</a></p>



<a name="302769716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769716">(Oct 07 2022 at 01:54)</a>:</h4>
<p><code>#eval Lean.versionString</code> or something still returns the old one</p>



<a name="302769763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302769763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302769763">(Oct 07 2022 at 01:55)</a>:</h4>
<p>Hmmm, I will try that solution tomorrow. Thanks!</p>



<a name="302770013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302770013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302770013">(Oct 07 2022 at 01:58)</a>:</h4>
<p>How to run that <code>select toolchain</code> command tho?</p>



<a name="302770141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302770141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302770141">(Oct 07 2022 at 02:00)</a>:</h4>
<p>ctrl-shift-p</p>



<a name="302770834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302770834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302770834">(Oct 07 2022 at 02:09)</a>:</h4>
<p>Just put "leanprover/lean4:nightly-2022-10-06" in your <code>lean-toolchain</code> file.</p>



<a name="302771153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302771153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302771153">(Oct 07 2022 at 02:12)</a>:</h4>
<p><span class="user-mention" data-user-id="434989">@Chris Lovett</span> that's what I have</p>



<a name="302771569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302771569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302771569">(Oct 07 2022 at 02:18)</a>:</h4>
<p>I'm not able to reproduce this using the <a href="https://github.com/leanprover/lean4-samples/tree/main/HelloWorld">lean4-samples/HelloWorld</a>.  Can you?</p>



<a name="302771698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302771698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302771698">(Oct 07 2022 at 02:20)</a>:</h4>
<p>I think recently I had to kill all the <code>lean</code> processes on my computer for vscode to switch over... It seems occasionally brittle to version updates</p>



<a name="302771884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302771884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302771884">(Oct 07 2022 at 02:23)</a>:</h4>
<p>Wait, I think I have a repro, I installed <code>leanprover/lean4:nightly-2022-10-06</code> specifically, and it is having trouble using it even after restarting VS code.  So I'm investigating.</p>



<a name="302772905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302772905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302772905">(Oct 07 2022 at 02:38)</a>:</h4>
<p>Interesting,  I have changed the <code>lean4-samples\HelloWorld\lean-toolchain</code> to <code>leanprover/lean4:nightly-2022-10-06</code> and got this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">leanink</span><span class="o">)</span> <span class="n">D</span><span class="o">:</span><span class="bp">\</span><span class="n">git</span><span class="bp">\</span><span class="n">leanprover</span><span class="bp">\</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">\</span><span class="n">HelloWorld</span><span class="bp">&gt;</span><span class="n">lake</span> <span class="c1">--version</span>
<span class="n">Lake</span> <span class="n">version</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span> <span class="o">(</span><span class="n">Lean</span> <span class="n">version</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">-</span><span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">09</span><span class="bp">-</span><span class="mi">26</span><span class="o">)</span>
</code></pre></div>
<p>Turns out I didn't realize but I did have an elan override set in this folder:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">leanink</span><span class="o">)</span> <span class="n">D</span><span class="o">:</span><span class="bp">\</span><span class="n">git</span><span class="bp">\</span><span class="n">leanprover</span><span class="bp">\</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">\</span><span class="n">HelloWorld</span><span class="bp">&gt;</span><span class="n">elan</span> <span class="n">override</span> <span class="n">list</span>
<span class="n">D</span><span class="o">:</span><span class="bp">\</span><span class="n">git</span><span class="bp">\</span><span class="n">leanprover</span><span class="bp">\</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">\</span><span class="n">HelloWorld</span>      <span class="n">leanprover</span><span class="bp">/</span><span class="n">lean4</span><span class="o">:</span><span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">09</span><span class="bp">-</span><span class="mi">26</span>
</code></pre></div>
<p>So after removing that with <code>elan override unset</code> then VS code started working properly (after a Lean4: Restart Server).</p>



<a name="302772918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302772918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302772918">(Oct 07 2022 at 02:38)</a>:</h4>
<p>so can you check your <code>elan override list</code> ?</p>



<a name="302801159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302801159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302801159">(Oct 07 2022 at 08:22)</a>:</h4>
<p><span class="user-mention" data-user-id="434989">@Chris Lovett</span> <br>
<span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code/near/302768941">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Text only"><pre><span></span><code>λ elan override unset
info: no override toolchain for '/home/arthur/dev/lean/viper'
info: you may use `--path &lt;path&gt;` option to remove override toolchain for a specific path
</code></pre></div><br>
</p>
</blockquote>



<a name="302801460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302801460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302801460">(Oct 07 2022 at 08:25)</a>:</h4>
<p>I can think of only two further causes:</p>
<ul>
<li>You do not have the <code>viper</code> folder opened as the workspace folder</li>
<li>Some Lean override local to VS Code, e.g. in its extension settings</li>
</ul>



<a name="302842318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302842318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302842318">(Oct 07 2022 at 12:42)</a>:</h4>
<p>The solution was using Gabriel's idea with the "Select Lean toolchain" command (via ctrl-shift-p) and then choosing the option "Reset toolchain override" or something. Thanks everyone!</p>



<a name="302927147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Wrong%20version%20in%20VS%20Code/near/302927147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Wrong.20version.20in.20VS.20Code.html#302927147">(Oct 07 2022 at 20:10)</a>:</h4>
<p>Yes when you use "Lean4: Select Toolchain" the selection you make is <em>sticky</em> for that folder, so to remove it you do have to use the "Reset workspace override".  The "Lean4: Select Toolchain" command will show you when a workspace override is in effect:<br>
<a href="/user_uploads/3121/YHVdHNvN58FZyX5zWav9cAIT/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/YHVdHNvN58FZyX5zWav9cAIT/image.png" title="image.png"><img src="/user_uploads/3121/YHVdHNvN58FZyX5zWav9cAIT/image.png"></a></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>