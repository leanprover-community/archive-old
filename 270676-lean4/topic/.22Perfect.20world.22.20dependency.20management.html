---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html">"Perfect world" dependency management</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="299834610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/299834610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#299834610">(Sep 20 2022 at 19:37)</a>:</h4>
<p>Hey, I'm not sure if there's already a thread for discussing this, but I wanted to start talking about what we envision as the best experience for dependency management in Lean4.</p>
<p>Some questions:</p>
<ul>
<li>Do we need to ensure all dependencies are on the same Lean version? If so, how do we ensure these dependencies are on the same Lean version, when each dependency may only have releases for a subset of all Lean versions?</li>
<li>What should the expectation be for library authors in terms of releasing updates for new lean versions?</li>
<li>Should we find ways to support targeting multiple Lean versions? This is a feature in other build management systems which can be useful for ensuring we can line up all dependencies' lean versions</li>
</ul>



<a name="300064187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300064187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300064187">(Sep 22 2022 at 01:42)</a>:</h4>
<p>I do think multiple target is a very feasible solution here, particularly because of the metaprogramming facilities. It'd be cool if in your Lakefile you gave the list of target lean versions</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">target</span> <span class="bp">...</span> <span class="o">{</span>
  <span class="bp">...</span>
  <span class="n">leanVersions</span> <span class="o">:=</span> <span class="bp">#</span><span class="o">[</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">09</span><span class="bp">-</span><span class="mi">15</span><span class="o">,</span>  <span class="mi">2022</span><span class="bp">-</span><span class="mi">09</span><span class="bp">-</span><span class="mi">20</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div>
<p>and then there was a <code>leanVersion</code> flag somewhere so you could have conditional declarations depending on the version</p>



<a name="300064229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300064229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300064229">(Sep 22 2022 at 01:43)</a>:</h4>
<p>This would definitely not be easy to support tooling-wise (the language server would probably just run on one version for the purposes of development), but I think at least having Lake support it would be feasible?</p>



<a name="300205268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300205268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300205268">(Sep 22 2022 at 17:03)</a>:</h4>
<blockquote>
<p>What should the expectation be for library authors in terms of releasing updates for new lean versions?</p>
</blockquote>
<p>For lean4-cli, I try to ensure that the library is updated on the same day it was broken on, and I only release updates for nightlies where the library had to be patched. If I was depending on something other than Lean 4 (I don't), I'd probably also try to ensure the same thing if a library update broke my library in-between the last nightly update of my library and now.</p>



<a name="300217089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300217089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300217089">(Sep 22 2022 at 18:08)</a>:</h4>
<p>Do you have some system in place to know when nightly breaks the library? (a daily CI job or something?)</p>



<a name="300220613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300220613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300220613">(Sep 22 2022 at 18:31)</a>:</h4>
<p>Yup, it PMs me on Zulip: <a href="https://github.com/mhuisi/lean4-cli/blob/main/.github/workflows/check_nightly.yml">https://github.com/mhuisi/lean4-cli/blob/main/.github/workflows/check_nightly.yml</a></p>



<a name="300224611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300224611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300224611">(Sep 22 2022 at 18:53)</a>:</h4>
<p>Ahh, it builds the nightly on a separate branch. Seems like it works well at the current pace of Lean updates :D</p>



<a name="300225060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300225060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300225060">(Sep 22 2022 at 18:56)</a>:</h4>
<p>This also suggests one potential expectation for libraries, which is that the newest git version should successfully build on the newest git versions of all its dependencies and the latest nightly version of lean:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>&lt;update toolchain to latest nightly&gt;
lake update
lake build <span class="c1"># should return 0</span>
</code></pre></div>
<p>But of course that also expects libraries to update as frequently as daily, which seems impractical (particularly for libraries with many dependencies).</p>



<a name="300226069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300226069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300226069">(Sep 22 2022 at 19:01)</a>:</h4>
<p>I'm getting the sense that Lake will need some way to pull revisions from git that aren't the latest, which I think would require either embedding that information in lakefiles somehow, or having an external crates.io-esque package registry that maintains a mapping of lean versions to package revisions</p>



<a name="300227939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300227939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300227939">(Sep 22 2022 at 19:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/300224611">said</a>:</p>
<blockquote>
<p>Ahh, it builds the nightly on a separate branch. Seems like it works well at the current pace of Lean updates :D</p>
</blockquote>
<p>The separate branch is mostly so that folks can track the lean4-cli version that works with the most recent nightly in their lakefile without having to edit it (if they want to), similar to how <code>leanprover/lean4:nightly</code> refers to the most recent Lean 4 nightly. Meanwhile, <code>main</code> tracks the most recent milestone / full release for Lean 4.</p>



<a name="300596503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300596503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300596503">(Sep 25 2022 at 00:48)</a>:</h4>
<p>Does it only push to the branch if the build succeeds? I guess that makes sense</p>



<a name="300668204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300668204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300668204">(Sep 25 2022 at 16:22)</a>:</h4>
<p>If the build fails, it notifies me on Zulip, I fix it, and then I push a new version for the new nightly.</p>



<a name="300701890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/300701890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#300701890">(Sep 26 2022 at 00:03)</a>:</h4>
<p>Based on what we've discussed so far, I think when updating dependencies we want to ask the question,</p>
<blockquote>
<p>What is the newest revision of &lt;dependency&gt; that builds successfully on &lt;lean version&gt;?</p>
</blockquote>
<p>Marc's been successful at keeping lean4-cli up to date, so that the newest git revision is always the answer to that question. But for less frequently updating repositories, it would be good to have some way to query for this.</p>
<p>Maybe <a href="https://xubaiw.github.io/reservoir-index/">Reservoir</a> can be modified to have HTTP GET endpoints to query this information?</p>



<a name="306378375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/306378375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#306378375">(Oct 27 2022 at 05:45)</a>:</h4>
<p>another thought to add to the perfect world dependency management: automated AST refactoring for breaking changes.</p>
<p>if you make a breaking change in your library, you can add some meta code somewhere that tells lake how to automatically refactor user code around that breaking change. fearless refactors galore!</p>



<a name="306378493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/306378493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#306378493">(Oct 27 2022 at 05:47)</a>:</h4>
<p>(Then when users run <code>lake update</code> or whatever, all the update scripts for those versions are executed on the project's code)</p>



<a name="318918850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/318918850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#318918850">(Jan 02 2023 at 00:28)</a>:</h4>
<p>I think I'd like to work on ^ soon. I've come to the conclusion that the perfect world would be Lean libraries where CI automatically PRs updates so that we can have a very quick turnaround updating long chains of library dependencies.</p>
<p>LMK if you'd want to collaborate on this! (also looking for good name ideas, something to do with lakes/water bodies would be great)</p>



<a name="321998689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/321998689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#321998689">(Jan 18 2023 at 08:47)</a>:</h4>
<p>One thing I've been wondering is: what if Lake becomes more restrictive?</p>
<p>For example, it could forbid stating direct dependencies if they're already present as transitive dependencies. As a more precise example, I wouldn't be allowed to require <code>Std</code> on my lakefile if I'm already requiring <code>Mathlib</code>, since <code>Mathlib</code> already requires <code>Std</code>. Then, two or more dependencies can coexist iff there's no conflict on their manifests (different versions for some package).</p>
<p>This is the most sane behavior I can think of that doesn't use semantic versioning.</p>



<a name="321999945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/321999945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#321999945">(Jan 18 2023 at 08:54)</a>:</h4>
<p>Maybe. I'm not sure how we'd avoid constantly having conflicts in minor versions. Rust cargo can handle packaging with <em>multiple different versions</em> of a library in the same code base, but I suspect that would require support from the compiler or something.</p>



<a name="322000544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322000544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322000544">(Jan 18 2023 at 08:58)</a>:</h4>
<p>Cargo infra is on another level because they can do much more with a dedicated platform for hosting packages. So they can use semantic versioning and allow version intervals</p>



<a name="322001335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322001335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322001335">(Jan 18 2023 at 09:04)</a>:</h4>
<p>(.. Perhaps we can do the same? :P The idea has been floated, and Isabelle and Coq both have their own centralized package platform!)</p>



<a name="322001931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322001931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322001931">(Jan 18 2023 at 09:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/321999945">said</a>:</p>
<blockquote>
<p>Maybe. I'm not sure how we'd avoid constantly having conflicts in minor versions.</p>
</blockquote>
<p>The issue is that the conflicts already exist and pass silently until we get a failure when building. It can become highly unpredictable, because you don't know which version of a transitive dependency you may download, if two dependencies require different versions of the same package. You're lucky when the version that is downloaded is compatible with all packages that require it.</p>
<p>Right now, filling out requirements and calling <code>lake build</code> is pretty much a prayer</p>



<a name="322003834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322003834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322003834">(Jan 18 2023 at 09:18)</a>:</h4>
<p>Idea: <code>lake update</code> would have the restrictive behavior I mentioned above and <code>lake update!</code> would allow room for luck, if you're eager</p>



<a name="322004491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322004491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322004491">(Jan 18 2023 at 09:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/321998689">said</a>:</p>
<blockquote>
<p>One thing I've been wondering is: what if Lake becomes more restrictive?</p>
<p>For example, it could forbid stating direct dependencies if they're already present as transitive dependencies. As a more precise example, I wouldn't be allowed to require <code>Std</code> on my lakefile if I'm already requiring <code>Mathlib</code>, since <code>Mathlib</code> already requires <code>Std</code>. Then, two or more dependencies can coexist iff there's no conflict on their manifests (different versions for some package).</p>
<p>This is the most sane behavior I can think of that doesn't use semantic versioning.</p>
</blockquote>
<p>I don't see how that will help. Basically every package will have an std4 dependency, so as soon as you want to combine two of these packages you're back to square one.</p>



<a name="322004522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322004522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322004522">(Jan 18 2023 at 09:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/322001335">said</a>:</p>
<blockquote>
<p>(.. Perhaps we can do the same? :P The idea has been floated, and Isabelle and Coq both have their own centralized package platform!)</p>
</blockquote>
<p>I suspect this solution won't be seriously considered until the next stable release of Lean 4, but I could be wrong!</p>



<a name="322005274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005274">(Jan 18 2023 at 09:26)</a>:</h4>
<p>I suspect that without semver we're kinda stuck. We need some way of determining compatibility across version intervals, or else it will always be too brittle.</p>



<a name="322005322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005322">(Jan 18 2023 at 09:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> I think knowing the exact source of incompatibility is already of great help</p>



<a name="322005394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005394">(Jan 18 2023 at 09:26)</a>:</h4>
<p>In the dependently typed world semantic versioning will be basically trivial, i.e., all changes are breaking</p>



<a name="322005494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005494">(Jan 18 2023 at 09:27)</a>:</h4>
<p>I think you cannot expect to really gain anything from it, and you would have to use a more conventional method, e.g., releases every N months</p>



<a name="322005732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005732">(Jan 18 2023 at 09:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/322005394">said</a>:</p>
<blockquote>
<p>In the dependently typed world semantic versioning will be basically trivial, i.e., all changes are breaking</p>
</blockquote>
<p>I disagree. While that might be true for mathlib, many other packages do behave well wrt major, minor and patch versioning</p>



<a name="322005779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005779">(Jan 18 2023 at 09:28)</a>:</h4>
<p>Either that or you make a much more fine-grained analysis of what is actually used, but I'm not convinced this is worthwhile</p>



<a name="322005923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322005923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322005923">(Jan 18 2023 at 09:29)</a>:</h4>
<p>The only obvious breaking change is a bump on the Lean toolchain. Every other change can be versioned carefully and precisely</p>



<a name="322006323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322006323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322006323">(Jan 18 2023 at 09:31)</a>:</h4>
<p>I also suspect that we can have solid tooling for handling breaking changes, i.e. with some amount of automation to patch downstream breaks... but that's at best an active area of research and at worst impossible :)</p>



<a name="322006782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322006782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322006782">(Jan 18 2023 at 09:33)</a>:</h4>
<p>Well Lean exposes the whole environment via tactics, so any change could break something.</p>



<a name="322006945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322006945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322006945">(Jan 18 2023 at 09:34)</a>:</h4>
<p>More seriously, Lean doesn't really offer much in the way of implementation hiding.</p>



<a name="322007238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007238">(Jan 18 2023 at 09:36)</a>:</h4>
<p>IMO semantic versioning is a poor approach which is mainly justified by the fact that, in an untyped language, anything else is even worse.</p>



<a name="322007426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007426">(Jan 18 2023 at 09:37)</a>:</h4>
<p>At some point sooner or later you're going to reinvent package distributions (e.g., Stackage).</p>



<a name="322007437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007437">(Jan 18 2023 at 09:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/322005779">said</a>:</p>
<blockquote>
<p>Either that or you make a much more fine-grained analysis of what is actually used, but I'm not convinced this is worthwhile</p>
</blockquote>
<p>I think you would have a different perspective if you were managing a non-trivial graph of libs that aren't focused on theorem proving. Yes, adding a new simp lemma can be a breaking change. But we very rarely use those</p>



<a name="322007511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007511">(Jan 18 2023 at 09:37)</a>:</h4>
<p>I mean, I guess we could ditch semver and just express compatibility in terms of git commit ranges. Seems slightly less user-friendly, but definitely an expression of the "every change is a breaking change" reality</p>



<a name="322007539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007539">(Jan 18 2023 at 09:37)</a>:</h4>
<p>I have far more experience in this than I would like in the Haskell world</p>



<a name="322007739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007739">(Jan 18 2023 at 09:38)</a>:</h4>
<p>how do haskell packages manage noncompatibility?</p>



<a name="322007937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322007937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322007937">(Jan 18 2023 at 09:39)</a>:</h4>
<p>People who want to get stuff done use Stackage, while people who like to argue about stuff use version ranges</p>



<a name="322008111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322008111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322008111">(Jan 18 2023 at 09:40)</a>:</h4>
<p>That's obviously just my opinion, but seriously I have seen huge amounts of time wasted on these questions.</p>



<a name="322008891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322008891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322008891">(Jan 18 2023 at 09:44)</a>:</h4>
<p>I don't think it's time wasted though. I think it's time wasted when you're fighting against incompatibilities that are too hard to track</p>



<a name="322009007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322009007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322009007">(Jan 18 2023 at 09:45)</a>:</h4>
<p>It seems the idea with Stackage is to have someone do the work of tracking down incompatibilities once, instead of everyone having to work it out on their own?</p>



<a name="322009045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322009045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322009045">(Jan 18 2023 at 09:45)</a>:</h4>
<p>That's why everyone should just agree to be on e.g. the March 2023 version of everything, until June</p>



<a name="322009281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322009281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322009281">(Jan 18 2023 at 09:46)</a>:</h4>
<p>If you need to be on the bleeding edge of one of your external dependencies, you might need to fork things for a bit to make everything compatible. I think the lakefile is already expressive enough to support that.</p>



<a name="322009776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322009776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322009776">(Jan 18 2023 at 09:49)</a>:</h4>
<p>I can't see that working for a community that's large enough</p>



<a name="322011185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322011185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322011185">(Jan 18 2023 at 09:57)</a>:</h4>
<p>Because a breaking change would trigger a wave of fixes and everyone would have to be extremely agile to provide the next version so other people can fix the next packages in the dependency graph</p>



<a name="322011846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322011846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322011846">(Jan 18 2023 at 10:01)</a>:</h4>
<p>If it's on a cycle of a month or three months or something, it probably gives most packages sufficient time to update. But that's a pretty slow cycle.</p>



<a name="322011987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322011987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322011987">(Jan 18 2023 at 10:02)</a>:</h4>
<p>The package distribution maintainers can also just fix things in the package distribution version (that's how OS distributions work).</p>



<a name="322012053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012053">(Jan 18 2023 at 10:02)</a>:</h4>
<p>What are the breaking changes in Lean 4? I know:</p>
<ul>
<li>Changes in the toolchain</li>
<li>Changes in type signatures</li>
<li>Changes on declaration names</li>
<li>Changes on file placements </li>
<li>Changes on <code>simp</code> theorems</li>
<li>Changes on instances</li>
</ul>



<a name="322012328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012328">(Jan 18 2023 at 10:04)</a>:</h4>
<p>And all definitions</p>



<a name="322012397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012397">(Jan 18 2023 at 10:04)</a>:</h4>
<p>Unless you hide stuff behind <code>opaque</code>/<code>implementedBy</code>, I guess</p>



<a name="322012683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012683">(Jan 18 2023 at 10:06)</a>:</h4>
<p>also changes in comments and line lengths, since positions of declarations are in the environment</p>



<a name="322012746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012746">(Jan 18 2023 at 10:06)</a>:</h4>
<p>in fact, changes to documentation regularly break lean tests, so that's not even a straw man</p>



<a name="322012804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012804">(Jan 18 2023 at 10:06)</a>:</h4>
<p>Right so in practice you need to work "modulo something", but you might not be able to get people to agree on what that "something" is ...</p>



<a name="322012955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322012955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322012955">(Jan 18 2023 at 10:07)</a>:</h4>
<p>Why is that a breaking change? Why would a change in documentation break something?</p>



<a name="322013112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013112">(Jan 18 2023 at 10:08)</a>:</h4>
<p>I mean, I know it's enough to invalidate the use of the olean file, but not the source, right?</p>



<a name="322013135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013135">(Jan 18 2023 at 10:08)</a>:</h4>
<p>technically, in the sense "there exists a lean program that would break", basically everything is a breaking change</p>



<a name="322013241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013241">(Jan 18 2023 at 10:09)</a>:</h4>
<p>you can read declaration locations out of the environment, that's how the server's go-to-def works</p>



<a name="322013316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013316">(Jan 18 2023 at 10:09)</a>:</h4>
<p>you can also read the contents of docstrings, and there are lean tests that do so</p>



<a name="322013510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013510">(Jan 18 2023 at 10:10)</a>:</h4>
<p>I wouldn't be surprised if source file hashes are in the environment too</p>



<a name="322013684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013684">(Jan 18 2023 at 10:11)</a>:</h4>
<p>Is it converging to a state where people have to manage their own separate forks for pretty much everything?</p>



<a name="322013690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013690">(Jan 18 2023 at 10:11)</a>:</h4>
<p>That said, "is a breaking change" != "breaks a majority of packages"... We don't have enough experience yet with the ecosystem to know how much breakage to expect every time you update a dependency.</p>



<a name="322013927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322013927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322013927">(Jan 18 2023 at 10:12)</a>:</h4>
<p>IIRC Rust has a good discussion about what "breaking change" means somewhere which in particular does not define it as "every observable behavior of the code" which is what my example amounts to</p>



<a name="322014113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014113">(Jan 18 2023 at 10:13)</a>:</h4>
<p><a href="https://rust-lang.github.io/rfcs/1105-api-evolution.html">https://rust-lang.github.io/rfcs/1105-api-evolution.html</a></p>



<a name="322014115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014115">(Jan 18 2023 at 10:13)</a>:</h4>
<p>"every observable <em>compiletime</em> behavior" :)</p>



<a name="322014126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014126">(Jan 18 2023 at 10:13)</a>:</h4>
<p>Probably the correct reaction is that those tests are broken, but then it's still an empirical fact that they exist.<br>
So the conclusion is that if you define "breaking change" in a reasonable way, you don't actually have whatever guarantee you think you are getting from semver, even in practice and not just in theory.</p>



<a name="322014442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014442">(Jan 18 2023 at 10:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/322014115">said</a>:</p>
<blockquote>
<p>"every observable <em>compiletime</em> behavior" :)</p>
</blockquote>
<p>Unfortunately, since lean is a dependent type theory most behaviors visible at runtime are also visible at compiletime (and even more so because in addition to a DTT it also has a comprehensive whitebox API to the elaborator itself)</p>



<a name="322014443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014443">(Jan 18 2023 at 10:15)</a>:</h4>
<p>Tests, especially the kinds we use, are a bad example of a legitimate downstream user of a package</p>



<a name="322014887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322014887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322014887">(Jan 18 2023 at 10:17)</a>:</h4>
<p>although, arguably changes in runtime behavior are also semver-breaking</p>



<a name="322015460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322015460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322015460">(Jan 18 2023 at 10:20)</a>:</h4>
<p>There is a big overlap of this discussion and improving compile times by build short-circuiting. If we don't import definition bodies by default, and track docstrings and source locations outside of the environment in a server-exclusive part (not sure if we have cross-module <code>inherit_doc</code>s...), we're in a much better position to define "<em>reasonably</em> breaking change".</p>



<a name="322015548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322015548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322015548">(Jan 18 2023 at 10:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management/near/322012683">said</a>:</p>
<blockquote>
<p>also changes in comments and line lengths, since positions of declarations are in the environment</p>
</blockquote>
<p>Is there an alternative solution? Why isn't there a separate process that analyzes comments etc?</p>



<a name="322015736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322015736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322015736">(Jan 18 2023 at 10:22)</a>:</h4>
<p>it is convenient to have that information available for metaprogramming, I think it would be a regression to remove it</p>



<a name="322016341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322016341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322016341">(Jan 18 2023 at 10:25)</a>:</h4>
<p>I still don't see how changing a comment can break a client user</p>



<a name="322016652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322016652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322016652">(Jan 18 2023 at 10:27)</a>:</h4>
<p>And heck, if that's the case, it's a pretty serious design decision</p>



<a name="322016772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322016772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322016772">(Jan 18 2023 at 10:27)</a>:</h4>
<p>Concretely, suppose that the client imports dependency <code>EvilPackage</code> that imports your library. <code>EvilPackage</code> has an <code>#eval guard ((docString ``YourLibrary.foo).length = 37)</code> in it, so when you change the doc string <code>EvilPackage</code> and the client build break</p>



<a name="322017031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322017031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322017031">(Jan 18 2023 at 10:28)</a>:</h4>
<p>Lean has a very open metaprogramming model, you can do almost anything. I think we need to own that instead of trying to erect walls to mostly stop stuff from leaking</p>



<a name="322017179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322017179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322017179">(Jan 18 2023 at 10:29)</a>:</h4>
<p>In particular, I think that <code>EvilPackage</code> should be regarded as a bad citizen in this scenario, and <code>YourLibrary</code> made a non-breaking change</p>



<a name="322017338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322017338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322017338">(Jan 18 2023 at 10:30)</a>:</h4>
<p>Right, so in order to own such freedom we need appropriate warning tools</p>



<a name="322017490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322017490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322017490">(Jan 18 2023 at 10:31)</a>:</h4>
<p>I think that comes down to having guidelines along the lines of "don't make your program's compilation depend on the bodies of opaque declarations, or the positions or docstrings of declarations"</p>



<a name="322018123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322018123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322018123">(Jan 18 2023 at 10:34)</a>:</h4>
<p>That's one thing, but I am also motivated to revamp my initial idea. I think Lake should warn the user when:</p>
<ul>
<li>Requiring a package that's already required by another dependency</li>
<li>Requiring two or more packages with incompatible dependencies in their manifests</li>
</ul>



<a name="322018347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322018347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322018347">(Jan 18 2023 at 10:35)</a>:</h4>
<p>I think requiring no diamonds is too strict, but requiring a package twice with different commits sounds like a great cause for warning</p>



<a name="322018683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322018683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322018683">(Jan 18 2023 at 10:37)</a>:</h4>
<p>It's just a warning, not a block</p>



<a name="322018895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322018895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322018895">(Jan 18 2023 at 10:38)</a>:</h4>
<p>even saying that diamonds are a warning is too strict because warnings should ideally be actionable and there are normal situations which inevitably lead to diamonds</p>



<a name="322019074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019074">(Jan 18 2023 at 10:39)</a>:</h4>
<p>The example that Sebastian gave is one of them, suppose you have A and B that both depend on Std and then C depends on A and B (and hence Std transitively, twice)</p>



<a name="322019075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019075">(Jan 18 2023 at 10:39)</a>:</h4>
<p>Maybe it should be an "info"</p>



<a name="322019278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019278">(Jan 18 2023 at 10:40)</a>:</h4>
<p>If both packages are using the same version of Std then it isn't even a bad situation and no errors are expected</p>



<a name="322019342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019342">(Jan 18 2023 at 10:40)</a>:</h4>
<p>Diamonds are fine as long as they have matching manifests. That's why I said "incompatible manifests"</p>



<a name="322019484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019484">(Jan 18 2023 at 10:40)</a>:</h4>
<p>it only becomes a potential problem when lake decides to deliberately compile a dependency with a different commit than the manifest says</p>



<a name="322019561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019561">(Jan 18 2023 at 10:41)</a>:</h4>
<p>and in that case you could give a warning along with the compile error</p>



<a name="322019603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019603">(Jan 18 2023 at 10:41)</a>:</h4>
<p>or a warning even if there is no error, perhaps</p>



<a name="322019773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019773">(Jan 18 2023 at 10:42)</a>:</h4>
<p>But that's flaky. A warning would be welcome</p>



<a name="322019828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322019828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322019828">(Jan 18 2023 at 10:42)</a>:</h4>
<p>There are several very slow moving packages that don't break over long periods though, and it is possibly too much to ask them to update all the time when they are very compatible</p>



<a name="322020183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322020183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322020183">(Jan 18 2023 at 10:44)</a>:</h4>
<p>If they are slow then they will be at the same commit on multiple packages that import them</p>



<a name="322020222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322020222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322020222">(Jan 18 2023 at 10:44)</a>:</h4>
<p>And no warning would be raised</p>



<a name="322020461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322020461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322020461">(Jan 18 2023 at 10:45)</a>:</h4>
<p>The burden isn't on the back of slow and compatible packages. It's on the back of whoever ensembles packages with potentially incompatible dependencies</p>



<a name="322020487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322020487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322020487">(Jan 18 2023 at 10:45)</a>:</h4>
<p>yes, but for example <code>Unicode</code> (which is slow moving) might import <code>Std</code> (which is relatively fast moving but backward compatible) and a downstream dependency like <code>Mathlib</code> (which is fast moving) also wants bleeding edge <code>Std</code>, in addition to an old but compatible version of <code>Unicode</code> that imports an old version of <code>Std</code></p>



<a name="322020791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322020791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322020791">(Jan 18 2023 at 10:47)</a>:</h4>
<p>in this case it works best to just ignore the version of <code>Std</code> that <code>Unicode</code> is recommending, because it works on latest <code>Std</code> as well, but the only way to reflect this with perfect matching at all times would be to frequently bump <code>Unicode</code> with the only change being a <code>Std</code> bump</p>



<a name="322021399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322021399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322021399">(Jan 18 2023 at 10:50)</a>:</h4>
<p>You say "best" because you know beforehand that those are backward compatible</p>



<a name="322021424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322021424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322021424">(Jan 18 2023 at 10:50)</a>:</h4>
<p>yes</p>



<a name="322021452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322021452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322021452">(Jan 18 2023 at 10:50)</a>:</h4>
<p>the question is how to reflect this sensibly</p>



<a name="322022116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322022116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322022116">(Jan 18 2023 at 10:53)</a>:</h4>
<p>Alright, warnings on build errors look like a reasonable step. Or a <code>lake check</code> that would warn the user about any of those sources of danger, including diamonds</p>



<a name="322024659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322024659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322024659">(Jan 18 2023 at 11:05)</a>:</h4>
<p>A proposal for improvement over status quo:<br>
(1) Some centralized record akin to Stackage, which tracks the set of packages that compile on each nightly Lean release<br>
(2) Lake support for updating your project to the latest nightly stack on which all your dependencies compile<br>
(3) Something akin to Marc Huisinga's auto-update bot that tries to build a package on each nightly-whatever stack (once all its dependencies successfully build on the stack), so that stable packages require almost no manual work to keep updated.</p>



<a name="322024671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322024671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322024671">(Jan 18 2023 at 11:05)</a>:</h4>
<p>(deleted)</p>



<a name="322025002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%22Perfect%20world%22%20dependency%20management/near/322025002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.22Perfect.20world.22.20dependency.20management.html#322025002">(Jan 18 2023 at 11:07)</a>:</h4>
<p>(zulip race condition! <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span>)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>