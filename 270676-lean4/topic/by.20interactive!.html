---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/by.20interactive!.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html">by interactive!</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="310836732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310836732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310836732">(Nov 18 2022 at 14:42)</a>:</h4>
<p><a href="/user_uploads/3121/wpmI2wiXVLDml3sLI4KiVYhS/by_interactive.gif">by_interactive.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/wpmI2wiXVLDml3sLI4KiVYhS/by_interactive.gif" title="by_interactive.gif"><img src="/user_uploads/3121/wpmI2wiXVLDml3sLI4KiVYhS/by_interactive.gif"></a></div>



<a name="310837253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310837253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310837253">(Nov 18 2022 at 14:45)</a>:</h4>
<p>It works! Very sluggish as it loses focus, so probalby due to the missing cache that <span class="user-mention" data-user-id="121918">@Edward Ayers</span> mentioned. But hey, we are getting somewhere</p>



<a name="310839528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310839528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310839528">(Nov 18 2022 at 14:56)</a>:</h4>
<p>And just 9 minutes to create  a new dynamic input widget for a new type (<code>Int</code>), including reading how to convert Int to String in Lean and TypeScript.<br>
All new code is on the screen!<br>
<a href="/user_uploads/3121/wxM0LPLLb2KLrqv13H1AR5Pb/by_interactive_int.gif">by_interactive_int.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/wxM0LPLLb2KLrqv13H1AR5Pb/by_interactive_int.gif" title="by_interactive_int.gif"><img src="/user_uploads/3121/wxM0LPLLb2KLrqv13H1AR5Pb/by_interactive_int.gif"></a></div>



<a name="310839961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310839961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310839961">(Nov 18 2022 at 14:58)</a>:</h4>
<p>Great, you can now implement a selection of everyone's favorite telephone number entry fields!</p>



<a name="310840692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310840692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310840692">(Nov 18 2022 at 15:01)</a>:</h4>
<p>This is the core of the idea:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The public interface: -/</span>
<span class="kd">class</span> <span class="n">Interactive</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="n">where</span>
  <span class="sd">/--</span>
<span class="sd">  JS source of a React module/component. Its props argument will contain</span>
<span class="sd">   * data : string : A String representing the current state</span>
<span class="sd">   * onDataChange : string -&gt; (): A callback called when the state changes</span>
<span class="sd">  -/</span>
  <span class="n">component</span> <span class="o">:</span> <span class="n">String</span>
  <span class="sd">/--</span>
<span class="sd">  A lean function converting a string representation to a lean value.</span>
<span class="sd">  TODO: How should errors be reported here?</span>
<span class="sd">  -/</span>
  <span class="n">fromInteractiveString</span> <span class="o">:</span> <span class="n">String</span> <span class="bp">-&gt;</span> <span class="n">a</span>
</code></pre></div>
<p>The current implementation is very shoddy. My secret plan is that someone finds the idea great but the implementation disgusting and will do it nicely again :-)</p>



<a name="310841616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310841616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310841616">(Nov 18 2022 at 15:05)</a>:</h4>
<p>It would be cool if you could use this sort of thing to configure a tactic, where when you click on a tactic it shows a list of configuration options, then when you change one it reflects that back into the code.</p>



<a name="310842138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310842138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310842138">(Nov 18 2022 at 15:07)</a>:</h4>
<p>Floris and I were just talking about something like <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#squeeze_simp">tactic#squeeze_simp</a>, where after squeezing it could replace itself. I know this isn't what you're going for with <code>interactive</code>, but this does seem to suggest a number of interesting UI directions.</p>



<a name="310842578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310842578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310842578">(Nov 18 2022 at 15:09)</a>:</h4>
<p>Yes, definitely related, and could use the same infrastructure. (Even simpler, as no JS is involved)</p>



<a name="310842734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310842734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310842734">(Nov 18 2022 at 15:10)</a>:</h4>
<p>If you don't need a visualization in the info view, you should use code actions instead</p>



<a name="310845184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310845184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310845184">(Nov 18 2022 at 15:21)</a>:</h4>
<p><span class="user-mention" data-user-id="121918">@Edward Ayers</span> I am now caching the Component (I believe), and the input field keeps the focus, but it does not keep, for example,  the cursor position in the input.</p>



<a name="310851506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310851506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310851506">(Nov 18 2022 at 15:49)</a>:</h4>
<p>One thing I think would be extremely useful is something similar to the "extract lemma" functionality of idris (I don't know what it's actually called). IIRC, the general consensus is that this was not possible with Lean3, but this demo and the comments suggest that it might be possible in Lean4?</p>



<a name="310851917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310851917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310851917">(Nov 18 2022 at 15:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="470149">Joachim Breitner</span> <a href="#narrow/stream/270676-lean4/topic/by.20interactive!/near/310845184">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="121918">Edward Ayers</span> I am now caching the Component (I believe), and the input field keeps the focus, but it does not keep, for example,  the cursor position in the input.</p>
</blockquote>
<p>I think this means that when react is diffing the new DOM with the old DOM it's not identifying the two components. Which suggests to me they might not be being cached. Could you share your code?</p>



<a name="310852827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310852827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310852827">(Nov 18 2022 at 15:54)</a>:</h4>
<p><a href="https://github.com/nomeata/lean4-interactive-tactic/blob/master/widget/src/widget.tsx">https://github.com/nomeata/lean4-interactive-tactic/blob/master/widget/src/widget.tsx</a></p>



<a name="310853650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310853650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310853650">(Nov 18 2022 at 15:58)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> If that is sensitive to the current selection, I don't think that is covered by code actions. It would have to be yet another custom request.</p>



<a name="310860373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310860373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310860373">(Nov 18 2022 at 16:29)</a>:</h4>
<p>20 loc!<br>
<a href="/user_uploads/3121/F3ow_NGPgt4T7mjLoXvZU-yn/by_interactive_color.png">by_interactive_color.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/F3ow_NGPgt4T7mjLoXvZU-yn/by_interactive_color.png" title="by_interactive_color.png"><img src="/user_uploads/3121/F3ow_NGPgt4T7mjLoXvZU-yn/by_interactive_color.png"></a></div>



<a name="310861027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310861027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310861027">(Nov 18 2022 at 16:32)</a>:</h4>
<p>Ed, with this widget the cursor stays in the right position. Maybe this component is smarter about being rebuilt with the same data as a plain <code>&lt;input&gt;</code>, but it works nice.</p>



<a name="310861056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310861056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310861056">(Nov 18 2022 at 16:32)</a>:</h4>
<p>I’ll add some debounce to the general widget</p>



<a name="310863970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310863970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310863970">(Nov 18 2022 at 16:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="470149">Joachim Breitner</span> <a href="#narrow/stream/270676-lean4/topic/by.20interactive!/near/310852827">said</a>:</p>
<blockquote>
<p><a href="https://github.com/nomeata/lean4-interactive-tactic/blob/master/widget/src/widget.tsx">https://github.com/nomeata/lean4-interactive-tactic/blob/master/widget/src/widget.tsx</a></p>
</blockquote>
<p>Can you try this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">Interactive</span> <span class="n">String</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">component</span> <span class="o">:=</span> <span class="s2">"</span>
<span class="s2">      import * as React from 'react';</span>
<span class="s2">      const e = React.createElement;</span>
<span class="s2">      export default function(props) {</span>
<span class="s2">        const [str, setStr] = React.useState(props.data)</span>
<span class="s2">        React.useEffect(() =&gt; setStr(props.data), [props.data])</span>
<span class="s2">        return e('div', null,</span>
<span class="s2">          'You can edit the String here!',</span>
<span class="s2">          e('input', {</span>
<span class="s2">             value: str,</span>
<span class="s2">             onChange : (event) =&gt; {</span>
<span class="s2">              const value =event.target.value</span>
<span class="s2">              setStr(value)</span>
<span class="s2">              props.onDataChange(value);</span>
<span class="s2">              },</span>
<span class="s2">          })</span>
<span class="s2">        )</span>
<span class="s2">      }"</span><span class="o">,</span>
  <span class="n">fromInteractiveString</span> <span class="o">:=</span> <span class="n">id</span>
  <span class="o">}</span>
</code></pre></div>



<a name="310864272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310864272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310864272">(Nov 18 2022 at 16:47)</a>:</h4>
<p>I think the problem is just that there is a delay between changing <code>&lt;input&gt;</code> and the <a href="http://props.data">props.data</a> changing, and during this delay React gets itself in to a funny state, so the solution is to have a local state too.</p>



<a name="310868713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310868713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310868713">(Nov 18 2022 at 17:08)</a>:</h4>
<p>Spot on! I accidentially solved this when adding debouncing, as there I also have a local state. But in the wrapper widget, so that authors of the small snippets don’t have to deal with this.</p>



<a name="310868962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310868962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310868962">(Nov 18 2022 at 17:09)</a>:</h4>
<p>It's coming along pretty nicely :-)</p>



<a name="310905911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310905911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310905911">(Nov 18 2022 at 19:30)</a>:</h4>
<p>How can I build the <code>widget.js</code> file?</p>



<a name="310907193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310907193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310907193">(Nov 18 2022 at 19:38)</a>:</h4>
<p>Run</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">npm</span> <span class="n">install</span>
<span class="n">npm</span> <span class="n">run</span> <span class="n">build</span>
</code></pre></div>
<p>in the widget directory (and also the color directory)</p>



<a name="310907433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310907433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310907433">(Nov 18 2022 at 19:40)</a>:</h4>
<p>I think my node/npm is perhaps several years too old</p>



<a name="310907561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310907561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310907561">(Nov 18 2022 at 19:41)</a>:</h4>
<p>e.g.</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>$ /home/rwbarton/math/lean4/lean4-interactive-tactic/widget/node_modules/rollup/dist/bin/rollup --help
/home/rwbarton/math/lean4/lean4-interactive-tactic/widget/node_modules/rollup/dist/bin/rollup:1270
const SECOND_ROUNDING_EPSILON = 0.000_000_1;
                                ^^^^^

SyntaxError: Invalid or unexpected token
    at Module._compile (internal/modules/cjs/loader.js:723:23)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:789:10)
    at Module.load (internal/modules/cjs/loader.js:653:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:593:12)
    at Function.Module._load (internal/modules/cjs/loader.js:585:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:831:12)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:623:3)
</code></pre></div>



<a name="310908448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310908448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310908448">(Nov 18 2022 at 19:46)</a>:</h4>
<p>Aha, I found a successful path: blow away my <code>node_modules</code> directory from previous attempts and then run in turn <code>npm install node</code>, <code>npm install npm</code>, add <code>"type": "module"</code> to <code>packages.json</code> (IDK what this means, but something suggested it), and then <code>npm run build</code>.</p>



<a name="310991014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310991014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310991014">(Nov 19 2022 at 10:23)</a>:</h4>
<p>As a prototype to make nice gifs to show off this is “done”. But where should we take it now? Should <code>by interactive</code> be a feature that comes with lean proper, like <code>#widget</code> itself (after plenty of cleanup, error handling, unifying the dynamic module loading with the existing infrastructure)? Or only a separately installable library?</p>



<a name="310991430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310991430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310991430">(Nov 19 2022 at 10:26)</a>:</h4>
<p>I imagine that it could be a self-contained library (that maybe depends on std). And then mathlib can depend on your lib.</p>



<a name="310993760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310993760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310993760">(Nov 19 2022 at 10:45)</a>:</h4>
<p>But I'm not an expert on Lean 4 library infrastructure.</p>



<a name="310995948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310995948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310995948">(Nov 19 2022 at 11:01)</a>:</h4>
<p>Have you thought about supporting parameterized instances (e.g. <code>instance {n : Nat} : Interactive (Fin n → Int) </code>)? Or providing access to the proof state?</p>



<a name="310997073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310997073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310997073">(Nov 19 2022 at 11:04)</a>:</h4>
<p>I hacked up something ugly for parameterized instances using <code>eval</code>, though I think it could also be done without</p>



<a name="310997529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310997529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310997529">(Nov 19 2022 at 11:06)</a>:</h4>
<p>It’s just using instance resolution as is, so parametrized instances could “just work”, could they? Or maybe I am misunderstanding what you want to achieve.</p>



<a name="310997867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310997867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310997867">(Nov 19 2022 at 11:07)</a>:</h4>
<p>I did think about generic instances like <code>Interactive t -&gt; Interactive (List t)</code> that wrap an arbitrary interactive widgets for <code>t</code> in a generic list editing widget… doable, but not sure how useful it is.</p>



<a name="310998242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310998242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310998242">(Nov 19 2022 at 11:08)</a>:</h4>
<p>e.g. for <code>Interactive (Fin n → Int)</code>, the widget should already know the value of <code>n</code> somehow.</p>



<a name="310998562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310998562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310998562">(Nov 19 2022 at 11:09)</a>:</h4>
<p>Ah, I see: You want to allow the class to pass the values of the instance parameters to the widget somehow?</p>



<a name="310998706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310998706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310998706">(Nov 19 2022 at 11:09)</a>:</h4>
<p>I tried just splicing it into the <code>component</code> field, but then <code>whnf</code> doesn't reduce it to a string literal any more.</p>



<a name="310998917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/310998917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#310998917">(Nov 19 2022 at 11:10)</a>:</h4>
<p>I get it now. Yes, the <code>whnf</code> is a crutch anyways, and “proper evaluation” makes more sense, if possible.</p>



<a name="319098204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/by%20interactive%21/near/319098204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/by.20interactive!.html#319098204">(Jan 02 2023 at 21:47)</a>:</h4>
<p>By the way, <a href="https://www.cs.cmu.edu/~comar/graphite-icse12.pdf">this work</a> on Graphite does something very similar for Eclipse except the widgets show up inline. VS Code has an <a href="https://github.com/microsoft/vscode/issues/85682">editor inset API</a> but it looks very experimental and possibly not working.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>