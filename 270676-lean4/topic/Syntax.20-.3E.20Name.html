---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Syntax.20-.3E.20Name.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html">Syntax -> Name</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275929853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275929853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275929853">(Mar 19 2022 at 21:10)</a>:</h4>
<p>I'd like to build a macro that looks somewhat like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">macro</span> <span class="s2">"("</span> <span class="n">x</span><span class="o">:</span><span class="n">ident</span> <span class="s2">"="</span> <span class="n">y</span><span class="o">:</span><span class="n">term</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">term</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">λ</span> <span class="n">name</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="bp">$</span><span class="n">x</span> <span class="bp">==</span> <span class="n">name</span> <span class="k">then</span> <span class="bp">$</span><span class="n">y</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div>
<p>but <code>x</code> should be turned into a <code>Name</code> instead of being an identifier, I did find the function. I did find <code> getNameOfIdent'</code> which looks like what I need but its only used in more involved elaborators so I'm not quite sure how to use it in a macro case, can i even? If not how can I achieve what i want?</p>



<a name="275930448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275930448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275930448">(Mar 19 2022 at 21:24)</a>:</h4>
<p>use <code>x.getId</code></p>



<a name="275930811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275930811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275930811">(Mar 19 2022 at 21:34)</a>:</h4>
<p>How exactly?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">macro</span> <span class="s2">"("</span> <span class="n">x</span><span class="o">:</span><span class="n">ident</span> <span class="s2">"="</span> <span class="n">y</span><span class="o">:</span><span class="n">term</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">term</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">λ</span> <span class="n">name</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="n">x.getId</span> <span class="bp">==</span> <span class="n">name</span> <span class="k">then</span> <span class="bp">$</span><span class="n">y</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span>

<span class="k">#check</span> <span class="o">(</span><span class="n">x</span> <span class="bp">=</span> <span class="mi">12</span><span class="o">)</span>
</code></pre></div>
<p>didnt work</p>



<a name="275931028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275931028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275931028">(Mar 19 2022 at 21:39)</a>:</h4>
<p>Also since this syntax will probably bite me sooner or later I did try other delimiters (namely <code>&lt;</code>) but those ended up  colliding with other syntax as well :/ Would someone happen to have better suggestion for syntax like this?</p>



<a name="275931140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275931140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275931140">(Mar 19 2022 at 21:42)</a>:</h4>
<p>Can you show the error message that you get?</p>



<a name="275931224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275931224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275931224">(Mar 19 2022 at 21:44)</a>:</h4>
<p>Also, sorry for the lack of details: this should work better (modulo the right choice of concrete syntax):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">`</span><span class="o">(</span><span class="bp">λ</span> <span class="n">name</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="bp">$</span><span class="o">(</span><span class="n">Lean.Syntax.mkNameLit</span> <span class="n">x.getId</span><span class="o">)</span> <span class="bp">==</span> <span class="n">name</span> <span class="k">then</span> <span class="bp">$</span><span class="n">y</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div>



<a name="275931680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275931680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275931680">(Mar 19 2022 at 21:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110026">Simon Hudon</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275931140">said</a>:</p>
<blockquote>
<p>Can you show the error message that you get?</p>
</blockquote>
<p>The error is that it tells me on the next line its expecting a term, I susepect this is because it might be expecting a greater than notation at the end? not sure.</p>
<p><span class="user-mention silent" data-user-id="110026">Simon Hudon</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275931224">said</a>:</p>
<blockquote>
<p>Also, sorry for the lack of details: this should work better (modulo the right choice of concrete syntax):</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">`</span><span class="o">(</span><span class="bp">λ</span> <span class="n">name</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="bp">$</span><span class="o">(</span><span class="n">Lean.Syntax.mkNameLit</span> <span class="n">x.getId</span><span class="o">)</span> <span class="bp">==</span> <span class="n">name</span> <span class="k">then</span> <span class="bp">$</span><span class="n">y</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Yes it diiid work better but mkNameLit takes a String so I did a .toString on the getIdent which resulted in:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">macro</span> <span class="s2">"("</span> <span class="n">x</span><span class="o">:</span><span class="n">ident</span> <span class="s2">"="</span> <span class="n">y</span><span class="o">:</span><span class="n">term</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">term</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">λ</span> <span class="n">name</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="bp">$</span><span class="o">(</span><span class="n">Lean.Syntax.mkNameLit</span> <span class="n">x.getId.toString</span><span class="o">)</span> <span class="bp">==</span> <span class="n">name</span> <span class="k">then</span> <span class="bp">$</span><span class="n">y</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span>

<span class="k">#check</span> <span class="o">(</span><span class="n">x</span> <span class="bp">=</span> <span class="mi">12</span><span class="o">)</span>
</code></pre></div>
<p>but this in turn still gives me a:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">overloaded</span><span class="o">,</span> <span class="n">errors</span>
  <span class="n">elaboration</span> <span class="n">function</span> <span class="n">for</span> <span class="bp">'</span><span class="n">nameLit'</span> <span class="n">has</span> <span class="n">not</span> <span class="n">been</span> <span class="n">implemented</span>
    <span class="n">failed</span> <span class="n">to</span> <span class="n">pretty</span> <span class="n">print</span> <span class="n">term</span> <span class="o">(</span><span class="n">use</span> <span class="bp">'</span><span class="kd">set_option</span> <span class="n">pp.rawOnError</span> <span class="n">true'</span> <span class="n">for</span> <span class="n">raw</span> <span class="n">representation</span><span class="o">)</span>

  <span class="mi">25</span><span class="o">:</span><span class="mi">8</span> <span class="n">unknown</span> <span class="n">identifier</span> <span class="sc">'x'</span>
</code></pre></div>
<p>:/</p>



<a name="275932592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275932592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275932592">(Mar 19 2022 at 22:11)</a>:</h4>
<p>It's not clear to me what your macro is supposed to do. Do you really want <code>(x = 12) : Name -&gt; Nat</code>?</p>



<a name="275932741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275932741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275932741">(Mar 19 2022 at 22:14)</a>:</h4>
<p>In any case, you'll want <code>quote x.getId</code></p>



<a name="275933852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275933852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275933852">(Mar 19 2022 at 22:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275932592">said</a>:</p>
<blockquote>
<p>It's not clear to me what your macro is supposed to do. Do you really want <code>(x = 12) : Name -&gt; Nat</code>?</p>
</blockquote>
<p>Yes, the original syntax I was aiming for was &lt;x = 12&gt; : Name -&gt; Nat but the parser doesnt seem to like that</p>



<a name="275933900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275933900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275933900">(Mar 19 2022 at 22:38)</a>:</h4>
<p>But the quote part did work out thank you!</p>



<a name="275941046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275941046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275941046">(Mar 20 2022 at 01:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275933852">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275932592">said</a>:</p>
<blockquote>
<p>It's not clear to me what your macro is supposed to do. Do you really want <code>(x = 12) : Name -&gt; Nat</code>?</p>
</blockquote>
<p>Yes, the original syntax I was aiming for was &lt;x = 12&gt; : Name -&gt; Nat but the parser doesnt seem to like that</p>
</blockquote>
<p>Umm, <code>(x = 12)</code> isn't really better. That syntax already means something, are you going to break all uses of <code>=</code> in parentheses?</p>



<a name="275963485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275963485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275963485">(Mar 20 2022 at 12:03)</a>:</h4>
<p>I'm very much aware of that, I just don't know of another alternative /o\ feel free to give me one</p>



<a name="275964990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275964990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275964990">(Mar 20 2022 at 12:40)</a>:</h4>
<p>what is the context? This looks like an <a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a> problem</p>



<a name="275965083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965083">(Mar 20 2022 at 12:42)</a>:</h4>
<p>I'm mirroring <a href="https://isabelle.in.tum.de/library/HOL/HOL-IMP/AExp.html">https://isabelle.in.tum.de/library/HOL/HOL-IMP/AExp.html</a> and they defined the syntax <code>&lt;''y'' := 7&gt;</code> so I tried to mirror that (without the <code>''</code> around names, i also attempted <code>:=</code> instead of<code>=</code> but that came down to the same) and this is what came out of it</p>



<a name="275965501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965501">(Mar 20 2022 at 12:52)</a>:</h4>
<p>I recommend using a dedicated syntax category for your expressions, with a macro introducer syntax like <code>imp { x := 7 }</code></p>



<a name="275965512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965512">(Mar 20 2022 at 12:52)</a>:</h4>
<p>Ah that does sound reasonable yes, thank you!</p>



<a name="275965540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965540">(Mar 20 2022 at 12:53)</a>:</h4>
<p>also it should not expand to that if statement, it should be a definition like <code>assign "x" (const 7)</code></p>



<a name="275965593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965593">(Mar 20 2022 at 12:54)</a>:</h4>
<p>Why's that?</p>



<a name="275965600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965600">(Mar 20 2022 at 12:54)</a>:</h4>
<p>because that way you can have appropriate simp lemmas and theorems about the definition</p>



<a name="275965620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965620">(Mar 20 2022 at 12:55)</a>:</h4>
<p>if you write a big program then using notations will lead to an unnecessarily large term</p>



<a name="275965631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965631">(Mar 20 2022 at 12:55)</a>:</h4>
<p>also delab doesn't work as well on such expressions</p>



<a name="275965637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965637">(Mar 20 2022 at 12:55)</a>:</h4>
<p>I see</p>



<a name="275965748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275965748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275965748">(Mar 20 2022 at 12:58)</a>:</h4>
<p>Oh also, I did notice that they use this <code>blast</code> tactic quite a lot (it's a generic tableau prover) do we have such a thing as well (maybe in Lean 3?) would it be useful for us if not?</p>



<a name="275966229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275966229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275966229">(Mar 20 2022 at 13:08)</a>:</h4>
<p>there is <code>eblast</code> in lean 3, but it is not used much because it has bugs and no maintainer. It would certainly be good to have a FOL prover in lean, it is not something that we handle well</p>



<a name="275966237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275966237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275966237">(Mar 20 2022 at 13:08)</a>:</h4>
<p><em>puts that on the list of things to have a look at at some point</em></p>



<a name="275966345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275966345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275966345">(Mar 20 2022 at 13:09)</a>:</h4>
<p>I believe <code>aesop</code> will address some of the needs in this domain, although that is closer to <code>auto</code> than <code>blast</code></p>



<a name="275966601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275966601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275966601">(Mar 20 2022 at 13:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/Syntax.20-.3E.20Name/near/275966237">said</a>:</p>
<blockquote>
<p><em>puts that on the list of things to have a look at at some point</em></p>
</blockquote>
<p>scratch that I'm just writing endless stacks of cases and apply here, I'll look into it right away</p>



<a name="275967608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275967608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275967608">(Mar 20 2022 at 13:38)</a>:</h4>
<p>did you try <code>simp</code>? It is probably selection bias but I don't really find a strong need for a <code>blast</code> like tactic most of the time</p>



<a name="275967959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275967959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275967959">(Mar 20 2022 at 13:45)</a>:</h4>
<p>I did <code>@[simp]</code> my declarations yeah, the thing is that my proofs right now basically look like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">apply</span> <span class="n">Iff.intro</span>
  <span class="n">case</span> <span class="n">mp</span> <span class="bp">=&gt;</span>
    <span class="n">intro</span> <span class="n">h</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">Seq</span> <span class="n">h1</span> <span class="n">h2</span> <span class="bp">=&gt;</span>
      <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span>
      <span class="bp">|</span> <span class="n">Seq</span> <span class="n">h3</span> <span class="n">h4</span> <span class="bp">=&gt;</span>
        <span class="n">apply</span> <span class="n">Seq</span> <span class="n">h3</span>
        <span class="n">apply</span> <span class="n">Seq</span> <span class="n">h4</span>
        <span class="n">assumption</span>
  <span class="n">case</span> <span class="n">mpr</span> <span class="bp">=&gt;</span>
    <span class="n">intro</span> <span class="n">h</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">Seq</span> <span class="n">h1</span> <span class="n">h2</span> <span class="bp">=&gt;</span>
      <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span>
      <span class="bp">|</span> <span class="n">Seq</span> <span class="n">h3</span> <span class="n">h4</span> <span class="bp">=&gt;</span>
        <span class="n">apply</span> <span class="n">Seq</span>
        <span class="n">apply</span> <span class="n">Seq</span> <span class="n">h1</span>
        <span class="n">repeat</span> <span class="o">{</span><span class="n">assumption</span><span class="o">}</span>
</code></pre></div>
<p>and simp doesnt seem to be able to apply <code>cases</code> on its own. But this proof would definitely be <code>blast</code>-able if blast was told about the cases as eleminiation rule and the <code>Seq</code> as intro rule since its just a tableau like this.</p>



<a name="275968027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275968027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275968027">(Mar 20 2022 at 13:46)</a>:</h4>
<p>that looks like <code>And.assoc</code></p>



<a name="275968095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275968095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275968095">(Mar 20 2022 at 13:48)</a>:</h4>
<p>and you can probably write the proof as <code>⟨fun ⟨⟨a, b⟩, c⟩ =&gt; ⟨a, ⟨b, c⟩⟩, fun ⟨a, ⟨b, c⟩⟩ =&gt; ⟨⟨a, b⟩, c⟩⟩</code></p>



<a name="275968101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275968101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275968101">(Mar 20 2022 at 13:48)</a>:</h4>
<p>lets see</p>



<a name="275968195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275968195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275968195">(Mar 20 2022 at 13:50)</a>:</h4>
<p>Ah, no I cannot (but that's just because I didn't show the big picture here) I'm now in this theory <a href="https://isabelle.in.tum.de/library/HOL/HOL-IMP/Big_Step.html">https://isabelle.in.tum.de/library/HOL/HOL-IMP/Big_Step.html</a> at <code>Seq_assoc</code> so whenever I apply <code>Seq</code> I can't just use the anonymous constructor.</p>



<a name="275968297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275968297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275968297">(Mar 20 2022 at 13:53)</a>:</h4>
<p>If you move further down the file you'll also see that they are just able to <code>blast</code> most of the semantic equivalence goals</p>



<a name="275976632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275976632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275976632">(Mar 20 2022 at 16:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> do we have automation for such things with simp as well? Or does this require something new then?</p>



<a name="275976636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275976636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275976636">(Mar 20 2022 at 16:54)</a>:</h4>
<p>I'm guessing the 2nd?</p>



<a name="275976674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275976674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275976674">(Mar 20 2022 at 16:55)</a>:</h4>
<p>You haven't shown a MWE so I don't know whether it can be done better. I'm just making guesses based on your code snippet</p>



<a name="275977054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977054">(Mar 20 2022 at 17:02)</a>:</h4>
<p>That would be:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- Everything until BigStep is just setup</span>
<span class="kd">inductive</span> <span class="n">AExp</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">N</span> <span class="o">:</span> <span class="n">Int</span> <span class="bp">→</span> <span class="n">AExp</span>
<span class="bp">|</span> <span class="n">V</span> <span class="o">:</span> <span class="n">String</span> <span class="bp">→</span> <span class="n">AExp</span>
<span class="bp">|</span> <span class="n">Plus</span> <span class="o">:</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">AExp</span>

<span class="n">abbrev</span> <span class="n">State</span> <span class="o">:=</span> <span class="n">String</span> <span class="bp">→</span> <span class="n">Int</span>

<span class="kn">namespace</span> <span class="n">AExp</span>
<span class="n">declare_syntax_cat</span> <span class="n">aexp</span>

<span class="n">syntax</span> <span class="n">num</span> <span class="o">:</span> <span class="n">aexp</span>
<span class="n">syntax</span> <span class="s2">"-"</span> <span class="n">num</span> <span class="o">:</span> <span class="n">aexp</span>
<span class="n">syntax</span> <span class="n">str</span> <span class="o">:</span> <span class="n">aexp</span>
<span class="n">syntax</span> <span class="n">aexp</span> <span class="s2">"+"</span> <span class="n">aexp</span> <span class="o">:</span> <span class="n">aexp</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">aexp</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">aexp</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="o">:</span> <span class="n">aexp</span>

<span class="n">syntax</span> <span class="s2">"[AExp|"</span> <span class="n">aexp</span> <span class="s2">"]"</span> <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">num</span><span class="o">:</span><span class="n">numLit</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">AExp.N</span> <span class="bp">$</span><span class="n">num</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">-</span> <span class="bp">$</span><span class="n">num</span><span class="o">:</span><span class="n">numLit</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">AExp.N</span> <span class="o">(</span><span class="bp">-$</span><span class="n">num</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">strLit</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">AExp.V</span> <span class="bp">$</span><span class="n">x</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">l</span> <span class="bp">+</span> <span class="bp">$</span><span class="n">r</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">AExp.Plus</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">l</span><span class="o">]</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">r</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="o">(</span> <span class="bp">$</span><span class="n">x</span> <span class="o">)])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">$</span><span class="n">x</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">aval</span> <span class="o">:</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">Int</span>
<span class="bp">|</span> <span class="n">N</span> <span class="n">n</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="n">n</span>
<span class="bp">|</span> <span class="n">V</span> <span class="n">n</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="n">s</span> <span class="n">n</span>
<span class="bp">|</span> <span class="n">Plus</span> <span class="n">l</span> <span class="n">r</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">aval</span> <span class="n">l</span> <span class="n">s</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">aval</span> <span class="n">r</span> <span class="n">s</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">updateState</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">State</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">String</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">Int</span><span class="o">)</span> <span class="o">:</span> <span class="n">State</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="n">x</span> <span class="bp">==</span> <span class="n">n</span> <span class="k">then</span> <span class="n">v</span> <span class="k">else</span> <span class="n">s</span> <span class="n">x</span>

<span class="kd">end</span> <span class="n">AExp</span>

<span class="kd">inductive</span> <span class="n">BExp</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">BConstant</span> <span class="o">:</span> <span class="n">Bool</span> <span class="bp">→</span> <span class="n">BExp</span>
<span class="bp">|</span> <span class="n">Not</span> <span class="o">:</span> <span class="n">BExp</span> <span class="bp">→</span> <span class="n">BExp</span>
<span class="bp">|</span> <span class="n">And</span> <span class="o">:</span> <span class="n">BExp</span> <span class="bp">→</span> <span class="n">BExp</span> <span class="bp">→</span> <span class="n">BExp</span>
<span class="bp">|</span> <span class="n">Less</span> <span class="o">:</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">BExp</span>

<span class="kn">namespace</span> <span class="n">BExp</span>
<span class="kn">open</span> <span class="n">AExp</span>

<span class="n">declare_syntax_cat</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="s2">"⊤"</span> <span class="o">:</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="s2">"⊥"</span> <span class="o">:</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="s2">"¬"</span> <span class="n">bexp</span> <span class="o">:</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="n">aexp</span> <span class="s2">"&lt;"</span> <span class="n">aexp</span> <span class="o">:</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">bexp</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">bexp</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="o">:</span> <span class="n">bexp</span>

<span class="n">syntax</span> <span class="s2">"[BExp|"</span> <span class="n">bexp</span> <span class="s2">"]"</span> <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">⊤</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">BExp.BConstant</span> <span class="n">Bool.true</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">⊥</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">BExp.BConstant</span> <span class="n">Bool.false</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">¬</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">BExp.Not</span> <span class="bp">$</span><span class="n">x</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">l</span><span class="o">:</span><span class="n">aexp</span> <span class="bp">&lt;</span> <span class="bp">$</span><span class="n">r</span><span class="o">:</span><span class="n">aexp</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">BExp.Less</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">l</span><span class="o">]</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">r</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="o">(</span> <span class="bp">$</span><span class="n">x</span> <span class="o">)])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">$</span><span class="n">x</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">bval</span> <span class="o">:</span> <span class="n">BExp</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">Bool</span>
<span class="bp">|</span> <span class="n">BConstant</span> <span class="n">b</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="n">b</span>
<span class="bp">|</span> <span class="n">Not</span> <span class="n">b</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="bp">!</span><span class="o">(</span><span class="n">bval</span> <span class="n">b</span> <span class="n">s</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">And</span> <span class="n">l</span> <span class="n">r</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="n">bval</span> <span class="n">l</span> <span class="n">s</span> <span class="bp">&amp;&amp;</span> <span class="n">bval</span> <span class="n">r</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">Less</span> <span class="n">l</span> <span class="n">r</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=&gt;</span> <span class="n">aval</span> <span class="n">l</span> <span class="n">s</span> <span class="bp">&lt;</span> <span class="n">aval</span> <span class="n">r</span> <span class="n">s</span>

<span class="kd">inductive</span> <span class="n">Com</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">Assign</span> <span class="o">:</span> <span class="n">String</span> <span class="bp">→</span> <span class="n">AExp</span> <span class="bp">→</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">If</span> <span class="o">:</span> <span class="n">BExp</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">While</span> <span class="o">:</span> <span class="n">BExpr</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span>

<span class="n">declare_syntax_cat</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"SKIP"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">str</span> <span class="s2">":="</span> <span class="n">aexp</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="s2">":="</span> <span class="n">aexp</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">com</span> <span class="s2">";"</span> <span class="n">com</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="s2">"if"</span> <span class="n">bexp</span> <span class="s2">"exec"</span> <span class="n">com</span> <span class="s2">"else"</span> <span class="n">com</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="s2">"while"</span> <span class="n">bexp</span> <span class="s2">"exec"</span> <span class="n">com</span><span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">com</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="o">:</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"[Com|"</span> <span class="n">com</span> <span class="s2">"]"</span> <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">SKIP</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Skip</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">strLit</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">y</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Assign</span> <span class="bp">$</span><span class="n">x</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">y</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Assign</span> <span class="bp">$</span><span class="n">x</span> <span class="o">[</span><span class="n">AExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span> <span class="bp">;</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Seq</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="k">if</span> <span class="bp">$</span><span class="n">b</span> <span class="n">exec</span> <span class="bp">$</span><span class="n">l</span> <span class="k">else</span> <span class="bp">$</span><span class="n">r</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.If</span> <span class="o">[</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">b</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">l</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">r</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="bp">$</span><span class="n">b</span> <span class="n">exec</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.While</span> <span class="o">[</span><span class="n">BExp</span><span class="bp">|</span> <span class="bp">$</span><span class="n">b</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">com</span> <span class="o">)])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">$</span><span class="n">x</span><span class="o">)</span>

<span class="kd">inductive</span> <span class="n">BigStep</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">Skip</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">Assign</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">a</span><span class="o">]</span> <span class="n">s</span> <span class="o">(</span><span class="n">updateState</span> <span class="n">s</span> <span class="n">x</span> <span class="o">(</span><span class="n">aval</span> <span class="n">a</span> <span class="n">s</span><span class="o">))</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c1</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c2</span> <span class="n">s2</span> <span class="n">s3</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s3</span>
<span class="bp">|</span> <span class="n">IfTrue</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c1</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="k">if</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c1</span> <span class="k">else</span> <span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s2</span>
<span class="bp">|</span> <span class="n">IfFalse</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c2</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="k">if</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c1</span> <span class="k">else</span> <span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s2</span>
<span class="bp">|</span> <span class="n">WhileFalse</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">bval</span> <span class="n">b</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">WhileTrue</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s2</span> <span class="n">s3</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s3</span>

<span class="kd">notation</span> <span class="s2">"("</span> <span class="n">c</span> <span class="s2">","</span> <span class="n">s</span> <span class="s2">")"</span> <span class="s2">"→"</span> <span class="n">t</span> <span class="bp">=&gt;</span> <span class="n">BigStep</span> <span class="n">c</span> <span class="n">s</span> <span class="n">t</span>

<span class="kd">theorem</span> <span class="n">seq_assoc</span> <span class="o">:</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span><span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">)</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>...one can probably ignore the syntax stuff for the most part, its really about the BigStep inductive and the theorem</p>



<a name="275977104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977104">(Mar 20 2022 at 17:04)</a>:</h4>
<p>It basically comes down to "Do we have good support for automatic reasoning on inductive predicates"</p>



<a name="275977262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977262">(Mar 20 2022 at 17:07)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Com</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span>

<span class="n">declare_syntax_cat</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"SKIP"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">com</span> <span class="s2">";"</span> <span class="n">com</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">com</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="o">:</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"[Com|"</span> <span class="n">com</span> <span class="s2">"]"</span> <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">SKIP</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Skip</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span> <span class="bp">;</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Seq</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">com</span> <span class="o">)])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">$</span><span class="n">x</span><span class="o">)</span>

<span class="kd">inductive</span> <span class="n">BigStep</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">Skip</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c1</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c2</span> <span class="n">s2</span> <span class="n">s3</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s3</span>

<span class="kd">notation</span> <span class="s2">"("</span> <span class="n">c</span> <span class="s2">","</span> <span class="n">s</span> <span class="s2">")"</span> <span class="s2">"→"</span> <span class="n">t</span> <span class="bp">=&gt;</span> <span class="n">BigStep</span> <span class="n">c</span> <span class="n">s</span> <span class="n">t</span>

<span class="kd">theorem</span> <span class="n">seq_assoc</span> <span class="o">:</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span><span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">)</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>I guess this one would be more minimal xd</p>



<a name="275977429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977429">(Mar 20 2022 at 17:11)</a>:</h4>
<p>Hmm...actually removing things did change apparently change stuff so the original proof doesnt work anymore :/</p>



<a name="275977512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977512">(Mar 20 2022 at 17:13)</a>:</h4>
<p>The <code>Skip</code> case looks wrong; it appears red in the definition of <code>BigStep</code> because it's actually a variable</p>



<a name="275977577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977577">(Mar 20 2022 at 17:14)</a>:</h4>
<p>Now it works, it shouldve bee <code>Com.Skip</code> yeah..</p>



<a name="275977669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275977669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275977669">(Mar 20 2022 at 17:16)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">BigStep</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">skip</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">Com.Skip</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">assign</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">a</span><span class="o">]</span> <span class="n">s</span> <span class="o">(</span><span class="n">updateState</span> <span class="n">s</span> <span class="n">x</span> <span class="o">(</span><span class="n">aval</span> <span class="n">a</span> <span class="n">s</span><span class="o">))</span>
<span class="bp">|</span> <span class="n">seq</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c1</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c2</span> <span class="n">s2</span> <span class="n">s3</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s3</span>
<span class="bp">|</span> <span class="n">if_true</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c1</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="k">if</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c1</span> <span class="k">else</span> <span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s2</span>
<span class="bp">|</span> <span class="n">if_false</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c2</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="k">if</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c1</span> <span class="k">else</span> <span class="n">c2</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s2</span>
<span class="bp">|</span> <span class="n">while_false</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">bval</span> <span class="n">b</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">while_true</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">bval</span> <span class="n">b</span> <span class="n">s1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c</span> <span class="n">s1</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s2</span> <span class="n">s3</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">while</span> <span class="n">b</span> <span class="n">exec</span> <span class="n">c</span><span class="o">]</span> <span class="n">s1</span> <span class="n">s3</span>

<span class="kd">notation</span> <span class="s2">"("</span> <span class="n">c</span> <span class="s2">", "</span> <span class="n">s</span> <span class="s2">")"</span> <span class="s2">" → "</span> <span class="n">t</span> <span class="bp">=&gt;</span> <span class="n">BigStep</span> <span class="n">c</span> <span class="n">s</span> <span class="n">t</span>

<span class="kd">theorem</span> <span class="n">BigStep.seq_assoc</span> <span class="o">:</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span><span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">)</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="bp">;</span><span class="n">c3</span><span class="o">],</span> <span class="n">s</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s'</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="k">fun</span> <span class="bp">|</span> <span class="n">seq</span> <span class="o">(</span><span class="n">seq</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">)</span> <span class="n">h3</span> <span class="bp">=&gt;</span> <span class="n">seq</span> <span class="n">h1</span> <span class="o">(</span><span class="n">seq</span> <span class="n">h2</span> <span class="n">h3</span><span class="o">),</span>
   <span class="k">fun</span> <span class="bp">|</span> <span class="n">seq</span> <span class="n">h1</span> <span class="o">(</span><span class="n">seq</span> <span class="n">h2</span> <span class="n">h3</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">seq</span> <span class="o">(</span><span class="n">seq</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">)</span> <span class="n">h3</span><span class="o">⟩</span>
</code></pre></div>



<a name="275978204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275978204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275978204">(Mar 20 2022 at 17:28)</a>:</h4>
<p>That does indeed look much better yes...but judging from this the answer to my question seems that we don't really have good automation for constructing these derivation trees automatically, just nice syntax to denote them right?</p>



<a name="275979037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275979037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275979037">(Mar 20 2022 at 17:48)</a>:</h4>
<p>Well, it would be different if you used and / or / eq instead of a custom inductive type</p>



<a name="275979427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275979427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275979427">(Mar 20 2022 at 17:55)</a>:</h4>
<p>Yeah I get that...but getting that to work is exactly the point of Isabelle's blast since it's not just a FOL prover but a generic tableau prover.</p>



<a name="275979432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/275979432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#275979432">(Mar 20 2022 at 17:55)</a>:</h4>
<p>Anyways, thanks for all the help and patience!</p>



<a name="277155706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/277155706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#277155706">(Mar 30 2022 at 14:45)</a>:</h4>
<p>FYI <a href="https://github.com/JLimperg/aesop">Aesop</a> now solves this (with some appropriately tagged lemmas):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Aesop</span>

<span class="n">abbrev</span> <span class="n">State</span> <span class="o">:=</span> <span class="n">String</span> <span class="bp">→</span> <span class="n">Int</span>

<span class="kd">inductive</span> <span class="n">Com</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">Com</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">Com</span>

<span class="n">declare_syntax_cat</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"SKIP"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">com</span> <span class="s2">";"</span> <span class="n">com</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="s2">"("</span> <span class="n">com</span> <span class="s2">")"</span> <span class="o">:</span> <span class="n">com</span>
<span class="n">syntax</span> <span class="n">term</span> <span class="o">:</span> <span class="n">com</span>

<span class="n">syntax</span> <span class="s2">"[Com|"</span> <span class="n">com</span> <span class="s2">"]"</span> <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="n">SKIP</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Skip</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span> <span class="bp">;</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">Com.Seq</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">]</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">y</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">com</span> <span class="o">)])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">])</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">([</span><span class="n">Com</span><span class="bp">|</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span> <span class="o">])</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="bp">$</span><span class="n">x</span><span class="o">)</span>

<span class="kd">@[aesop safe]</span>
<span class="kd">inductive</span> <span class="n">BigStep</span> <span class="o">:</span> <span class="n">Com</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="n">State</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">Skip</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">Com.Skip</span> <span class="n">s</span> <span class="n">s</span>
<span class="bp">|</span> <span class="n">Seq</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c₁</span> <span class="n">s</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="n">c₂</span> <span class="n">t</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c₁</span><span class="bp">;</span><span class="n">c₂</span><span class="o">]</span> <span class="n">s</span> <span class="n">u</span>

<span class="kn">namespace</span> <span class="n">BigStep</span>

<span class="kd">@[aesop norm elim]</span>
<span class="kd">theorem</span> <span class="n">Seq_inv</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c₁</span><span class="bp">;</span><span class="n">c₂</span><span class="o">]</span> <span class="n">s</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∃</span> <span class="n">t</span><span class="o">,</span> <span class="n">BigStep</span> <span class="n">c₁</span> <span class="n">s</span> <span class="n">t</span> <span class="bp">∧</span> <span class="n">BigStep</span> <span class="n">c₂</span> <span class="n">t</span> <span class="n">u</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">h</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">Seq</span> <span class="o">(</span><span class="n">t</span> <span class="o">:=</span> <span class="n">t</span><span class="o">)</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="bp">=&gt;</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">h₁</span><span class="o">,</span> <span class="n">h₂</span><span class="o">⟩</span>

<span class="kd">end</span> <span class="n">BigStep</span>

<span class="kd">theorem</span> <span class="n">seq_assoc</span> <span class="o">:</span>
    <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="o">(</span><span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="o">)</span><span class="bp">;</span><span class="n">c3</span><span class="o">]</span> <span class="n">s</span> <span class="n">s'</span> <span class="bp">↔</span> <span class="n">BigStep</span> <span class="o">[</span><span class="n">Com</span><span class="bp">|</span> <span class="n">c1</span><span class="bp">;</span><span class="n">c2</span><span class="bp">;</span><span class="n">c3</span><span class="o">]</span> <span class="n">s</span> <span class="n">s'</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">aesop</span>
</code></pre></div>



<a name="277175515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Syntax%20-%3E%20Name/near/277175515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Syntax.20-.3E.20Name.html#277175515">(Mar 30 2022 at 16:59)</a>:</h4>
<p>Yay more concrete semantics for me!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>