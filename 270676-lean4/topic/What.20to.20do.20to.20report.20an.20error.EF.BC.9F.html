---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html">What to do to report an errorÔºü</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="310359910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310359910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> üëÄÔºü <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310359910">(Nov 16 2022 at 08:35)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñï</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">:</span> <span class="n">‚Ñï</span> <span class="o">:=</span> <span class="n">x</span>
<span class="kd">def</span> <span class="n">bar</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñï</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">‚Ñï</span> <span class="o">:=</span>
  <span class="k">if</span> <span class="n">h‚ÇÄ</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">4</span> <span class="k">then</span>
    <span class="n">foo</span> <span class="n">x</span> <span class="o">(</span><span class="kd">by</span> <span class="k">have</span> <span class="n">h‚ÇÅ</span> <span class="o">:</span> <span class="mi">4</span> <span class="bp">‚â§</span> <span class="mi">5</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
              <span class="n">revert</span> <span class="n">h‚ÇÄ</span>
              <span class="n">revert</span> <span class="n">h‚ÇÅ</span>
              <span class="n">apply</span> <span class="n">le.trans_lt'</span><span class="o">)</span>
  <span class="k">else</span> <span class="mi">0</span>
</code></pre></div>



<a name="310365090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310365090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310365090">(Nov 16 2022 at 09:12)</a>:</h4>
<p>What's your question?</p>



<a name="310365363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310365363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> üëÄÔºü <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310365363">(Nov 16 2022 at 09:14)</a>:</h4>
<p>contradictory conditions, but do not report borrowing.</p>



<a name="310366451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310366451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310366451">(Nov 16 2022 at 09:21)</a>:</h4>
<p>What do you think the error is here? I'm assuming the code compiles and it looks ok to me. What you're doing is weird but I see no logical problem with it</p>



<a name="310366617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310366617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> üëÄÔºü <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310366617">(Nov 16 2022 at 09:22)</a>:</h4>
<p>How to get lean to warn at h‚ÇÄ</p>



<a name="310366893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310366893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> üëÄÔºü <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310366893">(Nov 16 2022 at 09:24)</a>:</h4>
<p>This conditional branch is not possible to execute</p>



<a name="310367230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310367230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310367230">(Nov 16 2022 at 09:26)</a>:</h4>
<p>Lean won't know that it is impossible without you proving it first.</p>



<a name="310368153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310368153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> üëÄÔºü <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310368153">(Nov 16 2022 at 09:32)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">‚Ñï</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">bar</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>Prove it in this way?</p>



<a name="310368605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310368605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310368605">(Nov 16 2022 at 09:34)</a>:</h4>
<p>That gives an error since <code>bar</code> takes two arguments</p>



<a name="310368669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310368669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310368669">(Nov 16 2022 at 09:34)</a>:</h4>
<p>If you have a proof of false (<code>h : false</code>) in a conditional branch / goal, you can close the branch / goal by casing on <code>h</code> (or applying <code>h.elim</code> if it works in Lean4).</p>



<a name="310369052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310369052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310369052">(Nov 16 2022 at 09:37)</a>:</h4>
<p>Here is a working example of the code so far:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span> <span class="n">x</span>
<span class="kd">def</span> <span class="n">bar</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span>
  <span class="k">if</span> <span class="n">h‚ÇÄ</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">4</span> <span class="k">then</span>
    <span class="n">foo</span> <span class="n">x</span> <span class="o">(</span><span class="n">Nat.le.step</span> <span class="n">h‚ÇÄ</span><span class="o">)</span>
  <span class="k">else</span> <span class="mi">0</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">bar</span> <span class="n">x</span> <span class="n">h</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">unfold</span> <span class="n">bar</span>
  <span class="n">split</span>
  <span class="bp">¬∑</span> <span class="n">rename_i</span> <span class="n">h'</span>
    <span class="n">apply</span> <span class="n">False.elim</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="n">Nat.lt_of_le_of_lt</span> <span class="n">h</span> <span class="n">h'</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span>
  <span class="bp">¬∑</span> <span class="n">exact</span> <span class="n">rfl</span>
</code></pre></div>



<a name="310369090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310369090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310369090">(Nov 16 2022 at 09:37)</a>:</h4>
<p>I had to change the <code>example</code> to prove <code>bar x h = 0</code> since <code>bar x h = x</code> isn't true.</p>



<a name="310369305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310369305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310369305">(Nov 16 2022 at 09:39)</a>:</h4>
<p>Lean won't do analysis for you that cases certain cases are impossible, if this is what you're asking about.</p>



<a name="310370039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310370039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310370039">(Nov 16 2022 at 09:43)</a>:</h4>
<p>Another way to write <code>bar</code> is to use <code>False.elim</code> to essentially tell Lean the case can't happen.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span> <span class="n">x</span>
<span class="kd">def</span> <span class="n">bar</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span>
  <span class="k">if</span> <span class="n">h‚ÇÄ</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">4</span> <span class="k">then</span>
    <span class="n">False.elim</span> <span class="bp">$</span> <span class="kd">by</span> <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">Nat.lt_of_le_of_lt</span> <span class="n">h</span> <span class="n">h‚ÇÄ</span><span class="bp">;</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span> <span class="o">}</span>
  <span class="k">else</span> <span class="mi">0</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">‚â•</span> <span class="mi">6</span><span class="o">)</span> <span class="o">:</span> <span class="n">bar</span> <span class="n">x</span> <span class="n">h</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">unfold</span> <span class="n">bar</span>
  <span class="n">split</span>
  <span class="bp">¬∑</span> <span class="gr">sorry</span> <span class="c1">-- ‚ä¢ False.elim (_ : False) = 0</span>
  <span class="bp">¬∑</span> <span class="n">exact</span> <span class="n">rfl</span>
</code></pre></div>
<p>I'm not sure the best way to fill in this <code>sorry</code> though... The term has a proof of <code>False</code> in it, so there's probably some good lemma or tactic for this somewhere.</p>



<a name="310370382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310370382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310370382">(Nov 16 2022 at 09:45)</a>:</h4>
<p>There's generalize_proofs in mathlib, and it seems like it is already ported into mathlib 4.</p>



<a name="310374438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310374438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310374438">(Nov 16 2022 at 10:10)</a>:</h4>
<p>Rather than using <code>split</code>, I would just prove that <code>not (x &lt; 4)</code> and simp with it</p>



<a name="310445795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310445795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310445795">(Nov 16 2022 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> </p>
<blockquote>
<p>I'm not sure the best way to fill in this sorry though... The term has a proof of False in it, so there's probably some good lemma or tactic for this somewhere.</p>
</blockquote>
<p>You can use <code>contradiction</code>.</p>



<a name="310447674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/What%20to%20do%20to%20report%20an%20error%EF%BC%9F/near/310447674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/What.20to.20do.20to.20report.20an.20error.EF.BC.9F.html#310447674">(Nov 16 2022 at 16:25)</a>:</h4>
<p>Ah, great, thanks! (For the curious, <a href="https://github.com/leanprover/lean4/blob/1de142a20b5e8a51f5ec35846a6f661e007a5ac3/src/Lean/Meta/Tactic/Contradiction.lean#L26">where it searches for False.elim in the target</a>)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>