---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/examining.20well-founded.20def.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html">examining well-founded def</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="265257802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265257802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265257802">(Dec 17 2021 at 06:11)</a>:</h4>
<p>Is there any way to either generate code using <code>WellFounded.fix</code> or reasonably unfold a function defined using <code>termination_by</code>? I have a pretty simple function that decreases based on nat subtraction; if I define it using termination_by, it unfolds into a big irreducible machine-generated term. <br>
I'm fine with using <code>fix</code> and defining lemmas along the lines of <code>div_eq</code>, but <code>WellFounded.fix</code> in user code still throws an error about not generating anything executable.</p>



<a name="265258293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265258293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265258293">(Dec 17 2021 at 06:20)</a>:</h4>
<p>The way to generate code using <code>WellFounded.fix</code> is to have two versions of the function and connect them using <code>implementedBy</code>; there are a couple of examples <a href="https://github.com/leanprover-community/mathlib4/pull/136/files#diff-5bc22d5628c8fa02d3ad1c242328f6431d96968394fdf98590bb480b2134efe7L42">here</a> that were replaced by <code>termination_by</code> in <a href="https://github.com/leanprover-community/mathlib4/pull/136">mathlib4#136</a></p>



<a name="265258326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265258326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265258326">(Dec 17 2021 at 06:21)</a>:</h4>
<p>It is also possible to unfold the autogenerated <code>fix</code> equation. The simplest way to do it at the moment is to use <code>simp [my_func, my_func._unary]; rw [WellFounded.fix_eq]; rfl</code> with an appropriately stated equality lemma</p>



<a name="265259763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265259763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265259763">(Dec 17 2021 at 06:52)</a>:</h4>
<p>Thank you; it took a little bit of effort, but I think I got where I needed to be.</p>



<a name="265358718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265358718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265358718">(Dec 17 2021 at 20:51)</a>:</h4>
<p>Is there a way to use the <code>termination_by</code> and <code>decreasing_by</code> gadgets for theorems?</p>



<a name="265364203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265364203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265364203">(Dec 17 2021 at 21:40)</a>:</h4>
<p>Yes, it works exactly the same way</p>



<a name="265372553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265372553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265372553">(Dec 17 2021 at 22:47)</a>:</h4>
<p>I was using <code>lemma</code> instead of <code>theorem</code>; I think the parser for <code>lemma</code> needs to be extended with additional patterns for termination and decreasing. They don't seem to be part of <code>val:declVal</code>.</p>



<a name="265373509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/examining%20well-founded%20def/near/265373509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/examining.20well-founded.20def.html#265373509">(Dec 17 2021 at 22:59)</a>:</h4>
<p>There's a <code>terminationSuffix</code> parser in Parser/Commands.lean, but it doesn't seem to be accessible.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>