---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html">[RFC] name/version package fields</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="254114011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254114011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254114011">(Sep 20 2021 at 20:36)</a>:</h4>
<p>In designing <a href="https://github.com/leanprover/lake">Lake</a>, I have found the <code>name</code> and <code>version</code> properties of Lean packages to be rather superfluous. </p>
<p>The <code>name</code> field is only really used to derive the defaults of more precise properties like the root module of a library or the name of the binary. The <code>version</code> field isn't used at all and is sort of redundant considering Lean packages are also intended to be Git repositories and the  tags/commit hashes of repositories provide much better versioning than the <code>version</code> field ever could.</p>
<p>As such, I am proposing to <strong>remove the <code>version</code> field entirely</strong> (as it currently completely unused), and <em>considering</em> similarly <strong>removing the <code>name</code> field</strong> and just  having users to specify the more precise fields (e.g., <code>moduleRoot</code>) instead.</p>
<p>However, as these changes would be a major departure from the way Lean packages have thus far been defined, I first wanted to field these ideas to the larger Lean 4 community to make sure they were reasonable.</p>



<a name="254131768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254131768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254131768">(Sep 20 2021 at 23:04)</a>:</h4>
<p>Even though they are not used now it would seem useful to me to keep at least the version field. For example how are we going to enforce things like semantic versioning with libraries that are only versioned via git hashes so to speak.  With this git commit based versioning approach it would be impossible to make guarantees about API stability of libraries. Of course the library developers could start using git tags to indicate versions but then people would just end up looking up the commit id of the git tag with the proper version and add it as a dependency so I would at least propose to not drop the version field without replacement but add it optional to refer to git tags in order to make stuff like semantic versioning etc. possible. (Although this might already be possible? Never tried/looked out for that). </p>
<p>For the name field I could imagine exactly one use case where it might become useful which is in case Lean 4 ever gets something like a <a href="http://crates.io">crates.io</a> or <a href="http://npm.org">npm.org</a> package repository where you can refer to packages by their name and names have to be unique (if this is realistic enough to be considered ,dropping the version field also seems like a bad idea to me, since these package repositories are usually not git repos but  merely distributions of the current state of the source code so you'd have to refer to specific versions of those as well)</p>



<a name="254134045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254134045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254134045">(Sep 20 2021 at 23:25)</a>:</h4>
<p><span class="user-mention" data-user-id="395550">@Henrik Böving</span> Thanks for sharing your thoughts! </p>
<blockquote>
<p>For the name field I could imagine exactly one use case where it might become useful which is in case Lean 4 ever gets something like a <a href="http://crates.io">crates.io</a> or <a href="http://npm.org">npm.org</a> package repository where you can refer to packages by their name and names have to be unique</p>
</blockquote>
<p>The name of the module root could easily double as this unique name, though. In fact, it would be more accurate, as it has to be unique between packages or it would otherwise cause import troubles. That is, a package cannot depend on two separate packages that have the same root name (e.g., <code>Foo</code>) as there is no way to distinguish which module an <code>import Foo</code> would refer too .</p>



<a name="254134189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254134189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254134189">(Sep 20 2021 at 23:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254131768">said</a>:</p>
<blockquote>
<p>Even though they are not used now it would seem useful to me to keep at least the version field. For example how are we going to enforce things like semantic versioning with libraries that are only versioned via git hashes so to speak.  With this git commit based versioning approach it would be impossible to make guarantees about API stability of libraries. Of course the library developers could start using git tags to indicate versions but then people would just end up looking up the commit id of the git tag with the proper version and add it as a dependency so I would at least propose to not drop the version field without replacement but add it optional to refer to git tags in order to make stuff like semantic versioning etc. possible.</p>
</blockquote>
<p>I am not quite sure I understand your objection to just using Git tags for semantic versioning? I would think that would be a better solution than the <code>version</code> field.</p>



<a name="254174518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254174518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254174518">(Sep 21 2021 at 08:52)</a>:</h4>
<p>No no, using git tags is of course perfectly fine but it should then be possible to use a git tag directly when declaring a dependency in the manifest file, but maybe that already is possible? I never tried that.</p>



<a name="254175367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254175367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254175367">(Sep 21 2021 at 09:00)</a>:</h4>
<p>A mere version tag would not allow for multiple packages in a single repo, though <code>$pkg-$version</code> tags could work</p>



<a name="254183615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254183615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254183615">(Sep 21 2021 at 10:15)</a>:</h4>
<p>Removing version is a very good idea in my opinion removing the name probably not. I think the preferable thing to do is to tie versions / remote resources to a locally unique name and to not specify any version of the package / workspace itself, but instead distinguish between versions by creating archives which can be referred to by url, or by git commit hashes. </p>
<p>As an example consider something like the boost family of libraries, there are ~30-50 of them. Or the llvm project with tons of subprojects and libraries. In Bazel you have multiple ways of bringing remote resources into your WORKSPACE, they go by <code>http_archive</code>, <code>new_http_archive</code>, <code>local_repository</code>, <code>git_repository</code>, etc. They have the role to tie a remote / local resource uniquely specified by a url and checked by a hash like sha256, to a local name <code>@resource_name</code> and refer to libraries, executables, tests defined in that workspace as <code>@resource_name//:foo, ..., @resource_name//bla/:main</code>. In particular you always depend on such named resources without any references to versions. That way there is only one place to change if you change the library version, that you depend on. I'm not necessarily suggesting copying this 1:1, but I think strictly separating versioning from naming resources is a very good idea.</p>
<p>I'm mangling the terminology a bit, the Bazel concepts are explained here (<a href="https://docs.bazel.build/versions/main/build-ref.html">https://docs.bazel.build/versions/main/build-ref.html</a>).</p>



<a name="254187496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254187496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254187496">(Sep 21 2021 at 10:54)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> Bazel is a build system and not a package manager, so its applicability is limited here. I believe that for a mature package ecosystem, semantic versioning is the only scalable solution discovered so far, in which case your dependency references are <em>not</em> uniquely specified after all (except in the root package where you should have a lock file).</p>



<a name="254188007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254188007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254188007">(Sep 21 2021 at 10:59)</a>:</h4>
<p>I'd prefer if the notion of a Lean package wasn't entangled with a particular VCS in the first place. This seems like a hack that doesn't save much effort and would be hard to change later on.</p>



<a name="254189226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254189226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254189226">(Sep 21 2021 at 11:10)</a>:</h4>
<p>I'd tend to agree, but then you really need a registry that indexes packages by versions. With Git tags, you could list them without looking at all commits changing <code>package.lean</code>.</p>



<a name="254189358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254189358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254189358">(Sep 21 2021 at 11:11)</a>:</h4>
<p>And even if such a registry were VCS-agnostic, the package manager could derive a version from a Git tag (or other source) and embed it during upload, so you could still have both.</p>



<a name="254204831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254204831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254204831">(Sep 21 2021 at 13:16)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> It was my impression that Lake was aiming to be both build system and package manager and this RFC was essentially about how to delineate the two. In that aspect the solution in Bazel is relevant I think. There the dependencies on WORKSPACE external packages is managed by binding them to names, which can be referred to within the workspace as I sketched above. This is orthogonal to semantic versioning, as the external packages can indeed be versioned semantically. However Bazel essentially only allows equality constraints or dependence on e.g. HEAD. The other feature some package manages  have, namely to solve constraints based on version ranges is in my opinion proven to <em>not</em> scale, as solving constraints can quickly blow up in your face in two ways: Either by not explicitly tracking dependency on the presence of system libraries or certain hardware features (e.g. building a library with and without CUDA support) or in the myriad of ways that cabal / npm tends to fail. Solutions that scale are to "build the world", like nix, spack or in fact all linux distributions do and then to deploy in a specific container which locks non-explicitly tracked system dependencies in place and then to explicitly track dependencies across packages that are under your control. The spack documentation contains many good examples, why semantic versioning is not enough (<a href="https://spack.readthedocs.io/en/latest/features.html">https://spack.readthedocs.io/en/latest/features.html</a>) (<a href="https://tgamblin.github.io/pubs/spack-sc15.pdf">https://tgamblin.github.io/pubs/spack-sc15.pdf</a>).</p>



<a name="254204876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254204876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254204876">(Sep 21 2021 at 13:16)</a>:</h4>
<p>(FWIW in the broader Python community, I perceive a very slight move <em>away</em> from semantic versioning, which no one ever does properly anyhow. I don't have statistics, though I can calculate them, but in the past few years, a number of packages have adopted calver very enthusiastically.  -- <a href="https://calver.org/">https://calver.org/</a> )</p>
<p>And also in Python, we don't make declaring package versions via VCS tags the <em>only</em> way, but it's trivial to do so using hooks, specifically <a href="https://github.com/pypa/setuptools_scm/">https://github.com/pypa/setuptools_scm/</a></p>



<a name="254206873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254206873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254206873">(Sep 21 2021 at 13:30)</a>:</h4>
<p>Regarding doing semantic versioning properly, in <a href="https://elm-lang.org/">https://elm-lang.org/</a> exists a mechanism to automatically enforce semantic versioning (scroll down to "Enforced Semantic Versioning") Which basically does a diff on the type level and checks whether there are major change or not etc. Now I don't know if this is doable for lean (or how hard it would be) but if it is doable and someone actually implements this to enforce semantic versioning at compile time I'd consider the issue of "doing semantic versioning properly" solved for lean.</p>



<a name="254207554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254207554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254207554">(Sep 21 2021 at 13:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254206873">said</a>:</p>
<blockquote>
<p>Regarding doing semantic versioning properly, in <a href="https://elm-lang.org/">https://elm-lang.org/</a> exists a mechanism to automatically enforce semantic versioning (scroll down to "Enforced Semantic Versioning") Which basically does a diff on the type level and checks whether there are major change or not etc. Now I don't know if this is doable for lean (or how hard it would be) but if it is doable and someone actually implements this to enforce semantic versioning at compile time I'd consider the issue of "doing semantic versioning properly" solved for lean.</p>
</blockquote>
<p>It would not in cases that the Lean library depends on the existence of certain system libraries, compiler versions and or the target architecture it is build for. If you cannot properly specify the dependence on those, the semantic version alone does not capture all necessary information. For example you would maybe like to express library A version x depends on library B version y built with CUDA support.</p>



<a name="254207923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254207923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254207923">(Sep 21 2021 at 13:38)</a>:</h4>
<p>And also it's just impossible :) (and I'm a proponent of semver personally by the way) -- but no one ever does what you're supposed to in semver, which is define what your public API actually <em>is</em> -- and it's not just types and interfaces. For Python I put some notes here: <a href="https://regret.readthedocs.io/en/stable/before-you-deprecate/#document-your-public-api">https://regret.readthedocs.io/en/stable/before-you-deprecate/#document-your-public-api</a> which are things no one I know of ever really specifies, and even those who try of course will come to some scenario where it's unclear</p>



<a name="254209158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254209158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254209158">(Sep 21 2021 at 13:46)</a>:</h4>
<p>Which is why you need to maintain a distribution of everything you depend on at specific versions (if you are deploying to something) and have automated ways of building more recent distributions. Bazel in a large organisation provides that in the form of WORKSPACE and BUILD definitions for all known good packages, which you can then just import into your current WORKSPACE. Spack allows the same by allowing to define meta-packages, which all organisation internal packages then can depend on.</p>



<a name="254211962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254211962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254211962">(Sep 21 2021 at 14:03)</a>:</h4>
<p>Anyways, maybe in more concrete terms, right now in Lake one has </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Source</span> <span class="n">where</span>
<span class="bp">|</span> <span class="n">path</span> <span class="o">(</span><span class="n">dir</span> <span class="o">:</span> <span class="n">FilePath</span><span class="o">)</span> <span class="o">:</span> <span class="n">Source</span>
<span class="bp">|</span> <span class="n">git</span> <span class="o">(</span><span class="n">url</span> <span class="n">rev</span> <span class="o">:</span> <span class="n">String</span><span class="o">)</span> <span class="o">(</span><span class="n">branch</span> <span class="o">:</span> <span class="n">Option</span> <span class="n">String</span><span class="o">)</span> <span class="o">:</span> <span class="n">Source</span>
<span class="n">deriving</span> <span class="n">Inhabited</span><span class="o">,</span> <span class="n">Repr</span>

<span class="kd">structure</span> <span class="n">Dependency</span> <span class="n">where</span>
  <span class="n">name</span> <span class="o">:</span> <span class="n">String</span>
  <span class="n">src</span>  <span class="o">:</span> <span class="n">Source</span>
  <span class="n">dir</span>  <span class="o">:</span> <span class="n">FilePath</span> <span class="o">:=</span> <span class="s2">"."</span>
  <span class="n">args</span> <span class="o">:</span> <span class="n">List</span> <span class="n">String</span> <span class="o">:=</span> <span class="o">[]</span>
</code></pre></div>
<p>my comment above was that it might make sense to map everything to labels and declare the meaning of labels separately. That is if there is a <code>git_repository(name = "A", url="...",  sha256="")</code>, then everything else can refer to things in there as "@A//..." in Bazel without caring about that this originated from a git repository. Moreover the equivalent of the "Source / Dependency" type in Bazel is extensible, because everything is expressed in terms of labels, Providers and Dependency sets.</p>



<a name="254231254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254231254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254231254">(Sep 21 2021 at 15:56)</a>:</h4>
<p>For names, my idea is to identify lean libraries / packages by there root module (e.g., <code>Lake</code> for lake,  <code>Mathlib4</code> for mathlib4, etc.), which is necessarily unique due to Lean's import resolution procedure, rather than another, potentially different <code>name</code> field.</p>



<a name="254232151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254232151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254232151">(Sep 21 2021 at 16:01)</a>:</h4>
<p>For versions, my idea is to identify the version of the a package by its dependency configuration (i.e., its, ideally permalink, source, path within it, and configuration arguments). If the a package from the same permalink source can change versions, that is already a major problem for reproducibility.  So, I think assuming a one to one match between them is reasonable and sufficient for versioning.</p>



<a name="254232860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254232860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254232860">(Sep 21 2021 at 16:04)</a>:</h4>
<p>For Git (i.e. probably &gt;95% of our dependencies) that's simply the commit hash, right? Have you thought more about some kind of lock file for Lake?</p>



<a name="254236497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254236497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254236497">(Sep 21 2021 at 16:28)</a>:</h4>
<p>Yep, the commit hash / tag (plus repo URL) would be the permalink source for Git repos. I do have an idea for a lockfile, but there is currently no need for one as al dependencies are currently specified with a single version/source/revision rather than a range.</p>



<a name="254237190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254237190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254237190">(Sep 21 2021 at 16:32)</a>:</h4>
<p>The same is true for Nix Flakes, but they still have a .json lock file - because programmatically updating that one is far easier than an arbitrary .nix/.lean file :)</p>



<a name="254238072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254238072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254238072">(Sep 21 2021 at 16:38)</a>:</h4>
<p>Well, the more important reason may be that it also locks transitive dependencies and thus can get quite big. That way, if you have a dependency diamond with mismatched versions, the top flake can record the resolution. So even without ranges, lock files can be helpful.</p>



<a name="254238533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254238533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254238533">(Sep 21 2021 at 16:41)</a>:</h4>
<p>I don't disagree. It just isn't very high on my priority list right now as it is not currently necessary and wouldn't really add any new capabilities to Lake.</p>



<a name="254238806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254238806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254238806">(Sep 21 2021 at 16:42)</a>:</h4>
<p>If you want, you could add an issue about it to the Lake repo (and I could mark it as lower priority) so that we keep it in mind. It could also be used to alert others that it is a planned feature and they could upvote if they desire it for some use case I have not yet thought of.</p>



<a name="254267961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254267961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254267961">(Sep 21 2021 at 19:54)</a>:</h4>
<blockquote>
<p>For names, my idea is to identify lean libraries / packages by their root module (e.g., <code>Lake</code> for lake,  <code>Mathlib4</code> for mathlib4, etc.), which is necessarily unique due to Lean's import resolution procedure</p>
</blockquote>
<p>Is this true? Is it not possible in Lean4 to have "namespace packages" (to borrow a term from python) like we have in lean3?</p>



<a name="254268177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254268177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254268177">(Sep 21 2021 at 19:55)</a>:</h4>
<p>That is, have <code>MyFoo</code> provide <code>src/My/Foo.lean</code> and <code>MyBar</code> provide <code>src/My/Bar.lean</code>.</p>



<a name="254425959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254425959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254425959">(Sep 22 2021 at 19:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254231254">said</a>:</p>
<blockquote>
<p>For names, my idea is to identify lean libraries / packages by their root module (e.g., <code>Lake</code> for lake,  <code>Mathlib4</code> for mathlib4, etc.), which is necessarily unique due to Lean's import resolution procedure, rather than another, potentially different <code>name</code> field.</p>
</blockquote>
<p>Something I was wondering: Haskell has converged on a design, where many libraries insert themselves in a common namespace e.g. Data.ByteString. If I understand you correctly this wouldn't be possible with that design.</p>



<a name="254426105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254426105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254426105">(Sep 22 2021 at 19:39)</a>:</h4>
<p>Yes, lean 3 does the same thing and this is a point of divergence in lean 4</p>



<a name="254430960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254430960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254430960">(Sep 22 2021 at 20:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130511">Christian Pehle</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254425959">said</a>:</p>
<blockquote>
<p>Something I was wondering: Haskell has converged on a design, where many libraries insert themselves in a common namespace e.g. Data.ByteString. If I understand you correctly this wouldn't be possible with that design.</p>
</blockquote>
<p>Technically, there is nothing preventing you from setting your module root to something like <code>Data.ByteString</code>. Though yes, this would prevent packages from sharing the same module root. Personally, however, I think this approach is very suspect. I know that Haskell has had many problems with package name clashes, and this may be part of the reason. Luckily, in Haskell, you can additionally specify the package something comes from in addition to its module in an <code>import</code> statement -- something you can not do in Lean.</p>



<a name="254431280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254431280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254431280">(Sep 22 2021 at 20:11)</a>:</h4>
<p>Also, as  <code>.olean</code> files are located based on their module name, even if Lake supported packages sharing the module names, Lean itself would not (they would clash, whichever one was first in the LEAN_PATH would be loaded and the other one not).</p>



<a name="254432152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254432152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254432152">(Sep 22 2021 at 20:17)</a>:</h4>
<p>I would agree that, if Lean had a more flexible module system, separating package identifiers from module identifiers would make sense. However, as that is not the case, I think, by the principle of Occam's razor, merging them into one is appropriate as it packages simpler.</p>



<a name="254432453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254432453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254432453">(Sep 22 2021 at 20:19)</a>:</h4>
<p>It also allow means packages are then identified by a <code>Name</code> rather than a <code>String</code>, further increasing uniformity with things like declarations.</p>



<a name="254435080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254435080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254435080">(Sep 22 2021 at 20:36)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span>  Since there is an open issue (<a href="https://github.com/leanprover/lean4/issues/416">https://github.com/leanprover/lean4/issues/416</a>), I guess there might be some movement on this still. What I like about the Haskell approach is that one can in principle view the hierarchy as being arranged around semantic names and not vanity names. I have had experience with name clashes in Haskell and that indeed can be quite messy.</p>



<a name="254435448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254435448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254435448">(Sep 22 2021 at 20:39)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> I am personally quite found of vanity names! (If the names of my projects didn't give that away already. <span aria-label="rolling on the floor laughing" class="emoji emoji-1f923" role="img" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span> ) Still, as I said, there is nothing prevent you from doing the whole namespaced<code>Data.X</code>, <code>Text.X</code>, or <code>My.X</code> approach if you want (the module root does not have to be atomic)  -- that would still be supported by the proposed change.</p>



<a name="254435627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254435627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254435627">(Sep 22 2021 at 20:40)</a>:</h4>
<p>On the issue point, the module system in development is about moving away from transitive imports to a more modern limited import system. It is not proposing to change the module resolution procedure.</p>



<a name="254435926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254435926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254435926">(Sep 22 2021 at 20:42)</a>:</h4>
<p>Furthermore, I am not even sure what the difference between identifying a package / module by a unique module name vs a non-unique module name and a unique package name is. They can still both result in clashes -- the later just adds the hassle of another name you need to specify.</p>



<a name="254436300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254436300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254436300">(Sep 22 2021 at 20:45)</a>:</h4>
<p>I think everyone here can attest to the confusion newcomers have with mathlib 3 putting things in <code>init</code></p>



<a name="254436321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254436321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254436321">(Sep 22 2021 at 20:45)</a>:</h4>
<p>Also, as you said, <span class="user-mention" data-user-id="130511">@Christian Pehle</span> , the common way to resolve such name clash problems is to import a given source with a name assigned by the user. In which case, any name field on the package (module or otherwise) is superfluous as the name gets overwritten and unique identifier is now the permalink to the source.</p>



<a name="254436895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254436895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254436895">(Sep 22 2021 at 20:49)</a>:</h4>
<p>Yes, Bazel is I think a neat case study how to deal with names and dependencies in a fairly principled and language agnostic way. Those are so to speak the language external ways of dealing with dependencies. Since C++ absolutely makes no guarantees and follows no conventions, that's the only thing you get. On a slightly unrelated note, sophisticated module systems tend to only matter once a lot of code has been written. As is evidenced by the evolution of the go module system.</p>



<a name="254437134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254437134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254437134">(Sep 22 2021 at 20:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254436300">said</a>:</p>
<blockquote>
<p>I think everyone here can attest to the confusion newcomers have with mathlib 3 putting things in <code>init</code></p>
</blockquote>
<p>But mathlib 3 doesn't put anything in <code>init</code>?</p>



<a name="254437241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254437241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254437241">(Sep 22 2021 at 20:52)</a>:</h4>
<p>It does put things in <code>data</code> though, alongside other things in <code>data</code> in lean 3 core (exactly like the haskell example)</p>



<a name="254437999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254437999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254437999">(Sep 22 2021 at 20:56)</a>:</h4>
<p>Yes, <code>data</code>, sorry :)</p>



<a name="254438314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254438314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254438314">(Sep 22 2021 at 20:58)</a>:</h4>
<p>Does anyone know what happens when you overlap module names in java (which also lets you set the hierarchy)?</p>



<a name="254438734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254438734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254438734">(Sep 22 2021 at 21:01)</a>:</h4>
<p>Rust follows the model that prefixes everything with the crate name, but it also has lots of tools to rename things that lean doesn't have (module re-exports, <code>as</code> in imports)</p>



<a name="254438868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254438868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254438868">(Sep 22 2021 at 21:01)</a>:</h4>
<p>also the <code>crate</code> keyword, which avoids needing to write <code>import Mathlib.Foo.Bar</code> in all internal mathlib imports</p>



<a name="254439034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439034">(Sep 22 2021 at 21:02)</a>:</h4>
<p>in fact I don't even think it is legal to use the name of the crate in place of <code>crate</code> there in rust</p>



<a name="254439320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439320">(Sep 22 2021 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> I think that is also one of the reasons why Rust has overtaken Go  for many users. Rust had clearly learned from previous programming languages many best practices about a language's infrastructure whereas Go was rather slow on the uptake.</p>



<a name="254439501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439501">(Sep 22 2021 at 21:05)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I agree that rust should probably be considered the gold standard at the moment for language infrastructure.</p>



<a name="254439594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439594">(Sep 22 2021 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254437241">said</a>:</p>
<blockquote>
<p>It does put things in <code>data</code> though, alongside other things in <code>data</code> in lean 3 core (exactly like the haskell example)</p>
</blockquote>
<p>As <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span>  notes, this makes it hard for others to know that package is, in fact, that (a package) and not part of the core library, which can cause a lot consternation.</p>



<a name="254439801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439801">(Sep 22 2021 at 21:07)</a>:</h4>
<p>But rust also does not have a huge amount of "add on" material in downstream crates, while this is a totally expected outcome in lean. (This is in part because the orphan rules make such add-ons be very much second class citizens, and often you have to do some kind of conditional compilation in the original crate to support a particular downstream user, which I don't think we should be pushing for in lean.)</p>



<a name="254439882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439882">(Sep 22 2021 at 21:08)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> I personally would argue for NodeJS / TypeScript / etc., but Rust is very impressive. There are some design decisions of Rust, that I do not like, though.</p>



<a name="254439971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254439971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254439971">(Sep 22 2021 at 21:08)</a>:</h4>
<p>In OCaml it is possible to at least compose libraries out of components, the <a href="https://ocaml.janestreet.com/ocaml-core/latest/doc/core/">https://ocaml.janestreet.com/ocaml-core/latest/doc/core/</a> core library of JaneStreet is a good example. It is made up of lots of components which are assembled into a whole. I would btw. be careful to argue in terms of what possible bad things can happen, a lot of that comes down to professionalism and organisation.</p>



<a name="254440021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440021">(Sep 22 2021 at 21:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254439594">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254437241">said</a>:</p>
<blockquote>
<p>It does put things in <code>data</code> though, alongside other things in <code>data</code> in lean 3 core (exactly like the haskell example)</p>
</blockquote>
<p>As <span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span>  notes, this makes it hard for others to know that package is, in fact, that (a package) and not part of the core library, which can cause a lot consternation.</p>
</blockquote>
<p>I'm still not sure whether this is a pro or con of the design though</p>



<a name="254440152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440152">(Sep 22 2021 at 21:10)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Well its a con in my opinion. <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="254440220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440220">(Sep 22 2021 at 21:10)</a>:</h4>
<p>But why? Can you give a concrete example of where this causes problems? "Add on" libraries being able to coexist with the original material without users having to worry what parts come from where seems like a good thing</p>



<a name="254440232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440232">(Sep 22 2021 at 21:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254439801">said</a>:</p>
<blockquote>
<p>But rust also does not have a huge amount of "add on" material in downstream crates, while this is a totally expected outcome in lean.</p>
</blockquote>
<p>What do you mean by "add-on"  material?</p>



<a name="254440324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440324">(Sep 22 2021 at 21:11)</a>:</h4>
<p>e.g. Lean core defines <code>List.append</code>, mathlib defines <code>List.subset</code></p>



<a name="254440386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440386">(Sep 22 2021 at 21:12)</a>:</h4>
<p>and users don't have to worry about the origin of a definition to use it</p>



<a name="254440392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440392">(Sep 22 2021 at 21:12)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, when I am reading some libraries code to learn from it replicate it, I would kind of like know what dependencies I need to do so and not have to dig into each one of the (possibly hundreds) of the dependencies of the library to figure out which is contributing it.</p>



<a name="254440445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440445">(Sep 22 2021 at 21:12)</a>:</h4>
<p>For finding the source of a definition, I of course use go-to-definition anyway</p>



<a name="254440472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440472">(Sep 22 2021 at 21:13)</a>:</h4>
<p>knowing that it comes from a given library isn't that much of a help to finding it</p>



<a name="254440481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440481">(Sep 22 2021 at 21:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254440324">said</a>:</p>
<blockquote>
<p>e.g. Lean core defines <code>List.append</code>, mathlib defines <code>List.subset</code></p>
</blockquote>
<p>And this is horrible -- if two libraries define <code>List.subset</code>, they can no longer be used together.</p>



<a name="254440502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440502">(Sep 22 2021 at 21:13)</a>:</h4>
<p>My guess would be that especially in mathematics if you start organising things in a hierarchy, you might want to insert personal extensions into that hierarchy without being able to modify the core library.</p>



<a name="254440538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440538">(Sep 22 2021 at 21:14)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> If I am viewing a source non-interactively (i.e., on a website like GitHub or Stack overflow) that doesn't really help.</p>



<a name="254440623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440623">(Sep 22 2021 at 21:14)</a>:</h4>
<p>there are things you can do like searching for <code>def List.subset</code> but sure, that's hard</p>



<a name="254440659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440659">(Sep 22 2021 at 21:14)</a>:</h4>
<p>because lean is really flexible in how things can get defined</p>



<a name="254440667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440667">(Sep 22 2021 at 21:14)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> Yes, <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>'s example is all well and dandy for monolithic standardized libraries like mathlib, but not for general programming.</p>



<a name="254440789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440789">(Sep 22 2021 at 21:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254440623">said</a>:</p>
<blockquote>
<p>there are things you can do like searching for <code>def List.subset</code> but sure, that's hard</p>
</blockquote>
<p>Well then, haven't I proven my case?</p>



<a name="254440794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440794">(Sep 22 2021 at 21:15)</a>:</h4>
<p>If you have a bring-your-own-hierarchy approach like haskell or java, you can always use a very specific namespace of your own to avoid any namespace clashes if you want</p>



<a name="254440803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440803">(Sep 22 2021 at 21:15)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span>, but actually there are many instances where people end up doing similar (horrible) things in C++ :).</p>



<a name="254440907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440907">(Sep 22 2021 at 21:16)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> was that suppose to be an argument for or against my point? XD</p>



<a name="254440927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440927">(Sep 22 2021 at 21:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254440789">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254440623">said</a>:</p>
<blockquote>
<p>there are things you can do like searching for <code>def List.subset</code> but sure, that's hard</p>
</blockquote>
<p>Well then, haven't I proven my case?</p>
</blockquote>
<p>This is hard no matter what - unless you make lean be much more explicit about how definitions are contributed you are kind of hosed regarding <code>grep</code> for finding definitions</p>



<a name="254440999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254440999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254440999">(Sep 22 2021 at 21:17)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> the whole point of the new module system is to do just that.</p>



<a name="254441005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441005">(Sep 22 2021 at 21:17)</a>:</h4>
<p>commands can just make up names and add definitions there</p>



<a name="254441090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441090">(Sep 22 2021 at 21:18)</a>:</h4>
<p>no, the module system does nothing to solve this problem</p>



<a name="254441203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441203">(Sep 22 2021 at 21:19)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  Which module system do you mean? That is, in fact, (part of) the point of <a href="https://github.com/leanprover/lean4/issues/416">#416</a>.</p>



<a name="254441679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441679">(Sep 22 2021 at 21:23)</a>:</h4>
<p>I have had discussion with <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> and Leo about it and, from what I understood, being more explicit which definitions you are importing is a major component of the idea.</p>



<a name="254441694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441694">(Sep 22 2021 at 21:23)</a>:</h4>
<p>Even with module names and renaming etc, I don't see how the problem of manual go-to-definition is made any easier. If anything, you now have many steps to get from one to the other</p>



<a name="254441714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441714">(Sep 22 2021 at 21:23)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> well the ideal situation is that you can do powerful things but most of the time it is not necessary. It certainly shouldn't be the norm, but it would be nice to be able to compose a namespace hierarchy out of multiple libraries (the JaneStreet Core library would be a neat example). This is also common in let's say C++, for organising large amounts of code under a common namespace, but separated into several libraries (boost, folly, absl, ...)</p>



<a name="254441930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441930">(Sep 22 2021 at 21:25)</a>:</h4>
<p>Again, there is nothing preventing on frrom doing this with Lake or in what I have proposed. This is mostly just a discussion on style as to whether  doing so is a good idea. I think most programmers experience from C/C++ has taught them it is not (hence why Rust forbids it).</p>



<a name="254441979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254441979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254441979">(Sep 22 2021 at 21:25)</a>:</h4>
<p>My impression was that you wanted the module system to enforce it</p>



<a name="254442102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442102">(Sep 22 2021 at 21:26)</a>:</h4>
<p>No, I tend to be very against enforcing style.</p>



<a name="254442205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442205">(Sep 22 2021 at 21:27)</a>:</h4>
<p>well, not all features of C++ are equally bad :). I don't think that allowing a namespace to incorporate many libraries is an example of a bad feature, since even if all of them belonged to the same project (say LLVM), you would still want to be able to compile them separately. We might be talking past each other, though.</p>



<a name="254442209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442209">(Sep 22 2021 at 21:27)</a>:</h4>
<p>In  fact, I would suggest that Lean do something similar to  Ruby's refinements to all such things to be done in a manner that avoids clashes.</p>



<a name="254442270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442270">(Sep 22 2021 at 21:28)</a>:</h4>
<p>Doing this in the style guide is no problem at all. Small libraries can live in a namespace of their own, while monolithic libraries like mathlib will want to take many namespaces and possibly also contribute additionally to existing namespaces in its dependencies</p>



<a name="254442747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442747">(Sep 22 2021 at 21:32)</a>:</h4>
<p>One thing the build tool can do to help here is to add a package and also specify a rename map like <code>"*" -&gt; "Mathlib.*"</code> when an import name clash is imminent (or even just because the user prefers strict namespacing)</p>



<a name="254442884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254442884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254442884">(Sep 22 2021 at 21:33)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> I have no objections to inter-organizational building of namespace or even to library that is specifically meant augment another specific library (like <code>nest_asyncio</code> to <code>asyncio</code> in Python). I have a problem with cases like mathlib where the are argument the Lean core in ways many other libraries would likely do do similarly, thereby creating conflicts. Even then, <em>if</em> Lean had some thing like Ruby's refinements and mathlib did that instead, I wouldn't object to it.</p>



<a name="254443029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443029">(Sep 22 2021 at 21:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254442747">said</a>:</p>
<blockquote>
<p>One thing the build tool can do to help here is to add a package and also specify a rename map like <code>"*" -&gt; "Mathlib.*"</code> when an import name clash is imminent (or even just because the user prefers strict namespacing)</p>
</blockquote>
<p>No, it can't. Lean does not permit renaming of modules.</p>



<a name="254443043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443043">(Sep 22 2021 at 21:34)</a>:</h4>
<p>let's say it did</p>



<a name="254443081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443081">(Sep 22 2021 at 21:35)</a>:</h4>
<p>i.e. suppose you could customize the function from "import name -&gt; olean" more than just a list of root paths</p>



<a name="254443085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443085">(Sep 22 2021 at 21:35)</a>:</h4>
<p>Well then, things would be different then, wouldn't they? <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="254443108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443108">(Sep 22 2021 at 21:35)</a>:</h4>
<p>I am all for customization when possible.</p>



<a name="254443145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443145">(Sep 22 2021 at 21:36)</a>:</h4>
<p>I think this is a fairly simple feature to add to lean 4</p>



<a name="254443195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443195">(Sep 22 2021 at 21:36)</a>:</h4>
<p>It is sadly not.</p>



<a name="254443275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443275">(Sep 22 2021 at 21:37)</a>:</h4>
<p>Lean current module system (and the front-end for that matter) heavily tie a module's name with its file name and its <code>.olean</code>.</p>



<a name="254443301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443301">(Sep 22 2021 at 21:37)</a>:</h4>
<p>in what sense?</p>



<a name="254443303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443303">(Sep 22 2021 at 21:37)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I'm not familiar with what ruby does, but generally speaking pointing to bad examples in programming are always a bit unconvincing to me, I think asking what good things are enabled by this is more fruitful.</p>



<a name="254443337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443337">(Sep 22 2021 at 21:37)</a>:</h4>
<p>especially for languages which are not meant to be programmed by 10.000 programmers on the same project.</p>



<a name="254443354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443354">(Sep 22 2021 at 21:37)</a>:</h4>
<p>there is a function that maps import names to oleans; if that function is modified everything else would follow</p>



<a name="254443531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443531">(Sep 22 2021 at 21:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> ah, no. The module name / its file name is part of the name of the symbols generated by the compiler, two modules with clashing names would have clashing symbols.</p>



<a name="254443718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443718">(Sep 22 2021 at 21:41)</a>:</h4>
<p>I'm not suggesting anything about modules with clashing names</p>



<a name="254443754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443754">(Sep 22 2021 at 21:41)</a>:</h4>
<p>although it is true that module renames are problematic in that scenario</p>



<a name="254443777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443777">(Sep 22 2021 at 21:41)</a>:</h4>
<p>Huh? But:</p>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254442747">said</a>:</p>
<blockquote>
<p>One thing the build tool can do to help here is to add a package and also specify a rename map like <code>"*" -&gt; "Mathlib.*"</code> <strong><em>when an import name clash is imminent</em></strong> (or even just because the user prefers strict namespacing)</p>
</blockquote>
<p>(emphasis mine)</p>



<a name="254443855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443855">(Sep 22 2021 at 21:42)</a>:</h4>
<p>In the project after that rename, there is no import name clash</p>



<a name="254443897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443897">(Sep 22 2021 at 21:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130511">Christian Pehle</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254443303">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> I'm not familiar with what ruby does, but generally speaking pointing to bad examples in programming are always a bit unconvincing to me, I think asking what good things are enabled by this is more fruitful.</p>
</blockquote>
<p>I was pointing to a good example? I was complimenting Ruby's refinements and saying Lean should copy them?</p>



<a name="254443927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254443927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254443927">(Sep 22 2021 at 21:43)</a>:</h4>
<p>you have <code>Foo</code> and <code>Mathlib.Foo</code> modules, those are different names</p>



<a name="254444066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444066">(Sep 22 2021 at 21:44)</a>:</h4>
<p>For compiler symbols, probably it would be better to use a strict-namespaced version of the import name instead of the user facing version</p>



<a name="254444070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444070">(Sep 22 2021 at 21:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> At the Lean level yes, but the binary symbols aren't renamed (and generally, can't be), so you would get all kinds of errors at compile time.</p>



<a name="254444146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444146">(Sep 22 2021 at 21:45)</a>:</h4>
<p>And since Lean uses said compiled symbols interactively, it would probably even cause segfaults in the editor.</p>



<a name="254444278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444278">(Sep 22 2021 at 21:46)</a>:</h4>
<p>I don't think it is too much to ask for all libraries in the dependency graph to have distinct names</p>



<a name="254444334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444334">(Sep 22 2021 at 21:47)</a>:</h4>
<p>so if you stick that on the import name you will get something globally unambiguous</p>



<a name="254444365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444365">(Sep 22 2021 at 21:47)</a>:</h4>
<p>and renames are only there to affect how <code>import</code> resolution works</p>



<a name="254444495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444495">(Sep 22 2021 at 21:48)</a>:</h4>
<p>But the library name is the import name?</p>



<a name="254444610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444610">(Sep 22 2021 at 21:49)</a>:</h4>
<p>In the version I'm suggesting, it need not be</p>



<a name="254444647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444647">(Sep 22 2021 at 21:49)</a>:</h4>
<p>it might be, perhaps that's in the style guide for small libraries</p>



<a name="254444718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444718">(Sep 22 2021 at 21:50)</a>:</h4>
<p>If a name my module<code>Foo</code>, what am I then expected to name the library, <code>Bar</code>?</p>



<a name="254444865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444865">(Sep 22 2021 at 21:51)</a>:</h4>
<p>When you say module, you mean a lean/olean file, right? Those get whatever name the author wants them to have, and downstream users import the file by that name by default</p>



<a name="254444887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444887">(Sep 22 2021 at 21:51)</a>:</h4>
<p>The name of the library is not intrinsically connected to that</p>



<a name="254444894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444894">(Sep 22 2021 at 21:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254443897">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="130511">Christian Pehle</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254443303">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> I'm not familiar with what ruby does, but generally speaking pointing to bad examples in programming are always a bit unconvincing to me, I think asking what good things are enabled by this is more fruitful.</p>
</blockquote>
<p>I was pointing to a good example? I was complimenting Ruby's refinements and saying Lean should copy them?</p>
</blockquote>
<p>Ah, that was confusing. I meant pointing to Mathlib as a bad example. I will look into what ruby does ;).</p>



<a name="254444898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444898">(Sep 22 2021 at 21:52)</a>:</h4>
<p>I can not envision why you would name the library something different than the module. Furthermore, that would require a fundamental change to how the Lean code generator works.</p>



<a name="254444994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254444994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254444994">(Sep 22 2021 at 21:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254444865">said</a>:</p>
<blockquote>
<p>When you say module, you mean a lean/olean file, right? Those get whatever name the author wants them to have, and downstream users import the file by that name by default</p>
</blockquote>
<p>No, I mean the module in Lean, which then adds its name as a prefix to the symbols in the binary library (i.e., the shared or static lib). The way Lean currently works this also happens to be the file path, but that would be relatively more easy to change.</p>



<a name="254445004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445004">(Sep 22 2021 at 21:52)</a>:</h4>
<p>For example, maybe the haskell library called <code>bytestrings</code> has a module named <code>Data.ByteString.Strict</code></p>



<a name="254445180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445180">(Sep 22 2021 at 21:54)</a>:</h4>
<p>In this example, the symbol <code>ByteString.length</code> would be something like <code>bytestrings__Data_ByteString_Strict__ByteString_length</code></p>



<a name="254445323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445323">(Sep 22 2021 at 21:55)</a>:</h4>
<p>Why not just call your module <code>ByteStrings.Data.ByteString.Strict</code> (or just <code>ByteStrings.Strict</code>) then?</p>



<a name="254445355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445355">(Sep 22 2021 at 21:55)</a>:</h4>
<p>because I don't want to write <code>import ByteStrings.Data.ByteString.Strict</code></p>



<a name="254445412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445412">(Sep 22 2021 at 21:56)</a>:</h4>
<p>as long as I don't have to do that, feel free to have that be the internal "module name"</p>



<a name="254445456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445456">(Sep 22 2021 at 21:56)</a>:</h4>
<p>as I said, why not just call it <code>ByteStrings.Strict</code> then?</p>



<a name="254445538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445538">(Sep 22 2021 at 21:57)</a>:</h4>
<p>because Haskell users are used to know that everything related to Data (data structures is found under Data).</p>



<a name="254445602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445602">(Sep 22 2021 at 21:57)</a>:</h4>
<p>in the mathematics case it would be odd to search for lemmas about rings in multiple hierarchical namespaces</p>



<a name="254445617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445617">(Sep 22 2021 at 21:57)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> sure, that's Haskell and there is tradition behind it. However, why would any new language want to copy that?</p>



<a name="254445792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445792">(Sep 22 2021 at 21:59)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> Yeah, but in the mathematics case, they are all under <code>Mathlib</code> so it doesn't matter.</p>



<a name="254445829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445829">(Sep 22 2021 at 21:59)</a>:</h4>
<p>only if all mathematics exists in <code>Mathlib</code></p>



<a name="254445852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445852">(Sep 22 2021 at 21:59)</a>:</h4>
<p>which isn't even true in lean 3, some lemmas are in core</p>



<a name="254445897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445897">(Sep 22 2021 at 22:00)</a>:</h4>
<p>and there are third party libraries too</p>



<a name="254445948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445948">(Sep 22 2021 at 22:00)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> which seems to be the idea there. And you could re-export the lemma from core.</p>



<a name="254445979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254445979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254445979">(Sep 22 2021 at 22:00)</a>:</h4>
<p>I think that isn't a long term scalable approach, moreover I think encouraging this kind of monolithic code base would probably not a great idea.</p>



<a name="254446010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446010">(Sep 22 2021 at 22:00)</a>:</h4>
<p>Mathlib modules are named <em>by topic</em></p>



<a name="254446057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446057">(Sep 22 2021 at 22:00)</a>:</h4>
<p>not by origin</p>



<a name="254446111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446111">(Sep 22 2021 at 22:01)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> I agree, but in said case, I think splitting them up by source package makes more sense.</p>



<a name="254446184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446184">(Sep 22 2021 at 22:01)</a>:</h4>
<p>Note that the topics are not neatly arranged into a dependency hierarchy</p>



<a name="254446213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446213">(Sep 22 2021 at 22:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> which makes sense in a monolithic system, not in a system where there may be multiple different variations of the same concept.</p>



<a name="254446331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446331">(Sep 22 2021 at 22:02)</a>:</h4>
<p>Those variations need to play well together or else need to be completely separate and never communicate</p>



<a name="254446404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446404">(Sep 22 2021 at 22:03)</a>:</h4>
<p>That's the Coq world, and I actively try to discourage that in lean</p>



<a name="254446419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446419">(Sep 22 2021 at 22:03)</a>:</h4>
<p>incompatible libraries are no fun</p>



<a name="254446421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446421">(Sep 22 2021 at 22:03)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Or, as is more common in programming, they don't play together at all and monkey patching / glue code is written to try to get them to function anyway.</p>



<a name="254446500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446500">(Sep 22 2021 at 22:03)</a>:</h4>
<p>Or both libraries get rewritten from scratch to make them work.</p>



<a name="254446519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446519">(Sep 22 2021 at 22:04)</a>:</h4>
<p>I consider this a key strength of mathlib</p>



<a name="254446670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254446670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254446670">(Sep 22 2021 at 22:05)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I know. I do not. We have had this discussion before. Since it is clear we disagree, I am not sure what the point here is (especially since the proposal in question would still support both approaches).</p>



<a name="254447086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447086">(Sep 22 2021 at 22:08)</a>:</h4>
<p>As far as I know, lean 4's import mechanism is largely the same as lean 3's, and the fact that <code>import Foo.Bar</code> only imports things in package <code>Foo</code> is exclusively a package manager limitation. I want to lift that limitation</p>



<a name="254447372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447372">(Sep 22 2021 at 22:11)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> and as I was previously explaining, that is not the case. It is a property of the current Lean module system. Ask Leo or Sebastian f you want it changed in the short term. I am planning on building modules directly in Lake at some point (without calling out to the Lean binary), in which case I could then maybe alter the import system to do something different (in fact, I have already laid the groundwork on the configuration side to do so), but that is not feasible right now.</p>



<a name="254447649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447649">(Sep 22 2021 at 22:13)</a>:</h4>
<p>Are you talking about the compiler symbol issue? Let's assume for the time being that there are no import name clashes anywhere</p>



<a name="254447692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447692">(Sep 22 2021 at 22:14)</a>:</h4>
<p>This is not actually that difficult to ensure in the near to medium term</p>



<a name="254447767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447767">(Sep 22 2021 at 22:14)</a>:</h4>
<p>The main limitation I can see at the moment is that the Data.olean file (say) is generated once and can't be amended, same for the generated c code. But in principle it should be possible to regenerate that based on a computed Data.lean file, which simply imports everything in the Data name hierarchy. This would require some distinction at the file level or in the yet to be designed module system.</p>



<a name="254447893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447893">(Sep 22 2021 at 22:15)</a>:</h4>
<p>No, I am talking about the way in which Lean import modules. When Lean elaborates <code>import Foo.Bar</code>, it looks for the file <code>Foo/Bar.olean</code> in a <code>LEAN_PATH</code> directory and enforces that module loaded is named <code>Foo.Bar</code>. In fact, the compiled <code>Foo/Bar.olean</code> includes that its name (and file path) is such, and that information is used for many interactivity features (afaik).</p>



<a name="254447981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254447981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254447981">(Sep 22 2021 at 22:16)</a>:</h4>
<p>okay, that sounds fine</p>



<a name="254448025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448025">(Sep 22 2021 at 22:16)</a>:</h4>
<p>at least as long as we aren't trying to rename modules</p>



<a name="254448060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448060">(Sep 22 2021 at 22:17)</a>:</h4>
<p>actually even then I think it's fine as long as the true names of the modules don't collide</p>



<a name="254448402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448402">(Sep 22 2021 at 22:20)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Okay, now I'm confused, what is it that you want then?</p>



<a name="254448720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448720">(Sep 22 2021 at 22:23)</a>:</h4>
<p>For the near term? <code>import Foo.Bar</code> looks for <code>Foo/Bar.olean</code> in the <code>LEAN_PATH</code>, which includes all loaded packages. Renames would be nice but let's suppose there aren't any for now. So <code>import Data.Nat.Basic</code> picks up <code>Data/Nat/Basic.olean</code> in <code>mathlib4/src</code> if it is a dependency of the current project</p>



<a name="254448760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448760">(Sep 22 2021 at 22:23)</a>:</h4>
<p>In other words: exactly what lean 3 does</p>



<a name="254448863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448863">(Sep 22 2021 at 22:24)</a>:</h4>
<p>That is what is done? (and what was done in <code>leanpkg</code>?)</p>



<a name="254448918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254448918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254448918">(Sep 22 2021 at 22:25)</a>:</h4>
<p><code>leanpkg</code> has a requirement that everything goes under a <code>Mathlib</code> folder and there exists a <code>Mathlib.lean</code> file that imports everything</p>



<a name="254449092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449092">(Sep 22 2021 at 22:26)</a>:</h4>
<p>Lake allows for an arbitrary <code>srcDir</code>, but you still do need a file that imports everything to build from. That how the build system figures out what packages to build (and it what order).</p>



<a name="254449166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449166">(Sep 22 2021 at 22:27)</a>:</h4>
<p>Otherwise, you would have to manual specify each module in the package configuration.</p>



<a name="254449169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449169">(Sep 22 2021 at 22:27)</a>:</h4>
<p>in lean 3, you could just build everything in the <code>src/</code> directory</p>



<a name="254449214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449214">(Sep 22 2021 at 22:27)</a>:</h4>
<p>the dependency order sorts itself out because you still have to build dependents first</p>



<a name="254449607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449607">(Sep 22 2021 at 22:29)</a>:</h4>
<p>Note that mathlib4 had to add a CI check to make sure that all files in the directory are imported in the <code>Mathlib.lean</code> file, so this build file is really not doing us any favors</p>



<a name="254449643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449643">(Sep 22 2021 at 22:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254448720">said</a>:</p>
<blockquote>
<p>So <code>import Data.Nat.Basic</code> picks up <code>Data/Nat/Basic.olean</code> in <code>mathlib4/src</code> if it is a dependency of the current project</p>
</blockquote>
<p>Oh, I missed that you said <code>Data.Nat.Basic</code> and not <code>Mathlib.Nat.Basic</code> (or the like). How is Lake suppose to know that this module is part of mathlib?</p>



<a name="254449730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449730">(Sep 22 2021 at 22:29)</a>:</h4>
<p>It just checks for the name in all packages</p>



<a name="254449807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449807">(Sep 22 2021 at 22:30)</a>:</h4>
<p>if the name exists in more than one package, hard error</p>



<a name="254449827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449827">(Sep 22 2021 at 22:30)</a>:</h4>
<p>What if two packages have the a file with the same name. Also that is not really a scalable solution.</p>



<a name="254449848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449848">(Sep 22 2021 at 22:30)</a>:</h4>
<p>Sorry, you beat me by a second.</p>



<a name="254449864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449864">(Sep 22 2021 at 22:30)</a>:</h4>
<p>sure it is, like I said we can make sure there are no name clashes in the short to medium term</p>



<a name="254449900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449900">(Sep 22 2021 at 22:31)</a>:</h4>
<p>java has managed this for a huge ecosystem using only a style guide (and a penchant for long package names)</p>



<a name="254449925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449925">(Sep 22 2021 at 22:31)</a>:</h4>
<p>Also, how does it know it is not in a non-dependent package (like the Lean core)?</p>



<a name="254449991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254449991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254449991">(Sep 22 2021 at 22:32)</a>:</h4>
<p>I don't understand the question</p>



<a name="254450115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450115">(Sep 22 2021 at 22:33)</a>:</h4>
<p>If I import <code>Lean.Data.Json</code> (or <code>Std.Data.RBMap</code>, for example, how is Lake suppose to know that said file should not be expected to be in one of the dependent packages?</p>



<a name="254450186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450186">(Sep 22 2021 at 22:33)</a>:</h4>
<p>If it exists in lean core, then it does not exist in any dependent packages because import names are unique</p>



<a name="254450275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450275">(Sep 22 2021 at 22:34)</a>:</h4>
<p>Yeah, but how does Lake know what modules are in Lean core (or are otherwise pre-built)?</p>



<a name="254450335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450335">(Sep 22 2021 at 22:35)</a>:</h4>
<p>I assume you know what packages are available and what import names they contribute?</p>



<a name="254450354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450354">(Sep 22 2021 at 22:35)</a>:</h4>
<p>No?</p>



<a name="254450447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450447">(Sep 22 2021 at 22:36)</a>:</h4>
<p>In any case, the build tool doesn't really have to figure this out, it just points lean at all of the packages and lets lean do the work</p>



<a name="254450465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450465">(Sep 22 2021 at 22:36)</a>:</h4>
<p>unless I misunderstand the workflow</p>



<a name="254450553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450553">(Sep 22 2021 at 22:37)</a>:</h4>
<p>The build tool needs to know what modules to build and which to already expect to be built. Currently this is done by analyzing the recursive imports of the module root and building those modules which are submodules of said root.</p>



<a name="254450664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450664">(Sep 22 2021 at 22:38)</a>:</h4>
<p>You could do this less intelligently by manually specifying this for each possible import, but that does not seem feasible.</p>



<a name="254450725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450725">(Sep 22 2021 at 22:39)</a>:</h4>
<p>the lean 3 version of that is that you build all <code>*.lean</code> files in the <code>src/</code> directory that aren't already built</p>



<a name="254450781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450781">(Sep 22 2021 at 22:39)</a>:</h4>
<p>so you can make a list of all those import names and any name appearing in a <code>import ...</code> that isn't in the list doesn't need to be built</p>



<a name="254450789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450789">(Sep 22 2021 at 22:39)</a>:</h4>
<p>That is because Lean 3 is interpreted -- it interprets its imports on the fly. Lean 4 is not, the imports need to be pre-built.</p>



<a name="254450860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450860">(Sep 22 2021 at 22:40)</a>:</h4>
<p>You still look at lean files to find the dependencies, though?</p>



<a name="254450961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450961">(Sep 22 2021 at 22:41)</a>:</h4>
<p>so if the <code>src/</code> directory has <code>Foo/Bar.lean</code> and <code>Foo2/Baz.lean</code> then you expect to build some subset of <code>Foo.Bar</code> and <code>Foo2.Baz</code>, and by looking at the imports of these files you learn which to build first</p>



<a name="254450983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254450983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254450983">(Sep 22 2021 at 22:41)</a>:</h4>
<p>Yes, in the build tool. But the build tool is not building every module, unlike in Lean 3, where the interpreter was interpreting every module. As such, the build tool needs to know which modules to build and which to not (i.e., which to expect to have already been provided as pre-packaged <code>.olean</code>s).</p>



<a name="254451188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451188">(Sep 22 2021 at 22:42)</a>:</h4>
<p>if it's not on the list of things to build, then it is expected to be provided upstream</p>



<a name="254451284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451284">(Sep 22 2021 at 22:43)</a>:</h4>
<p>However, yes <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, and alternate strategy that relies entirely an what files are in the source directory would be possible.</p>



<a name="254451319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451319">(Sep 22 2021 at 22:43)</a>:</h4>
<p>My point earlier was that even if the build tool doesn't rely on the contents of the source directory, we will need to hack around it so that it does</p>



<a name="254451379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451379">(Sep 22 2021 at 22:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254451188">said</a>:</p>
<blockquote>
<p>if it's not on the list of things to build, then it is expected to be provided upstream</p>
</blockquote>
<p>The question here is where to get that list from.</p>



<a name="254451402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451402">(Sep 22 2021 at 22:44)</a>:</h4>
<p>because this is likely to be an error from contributors</p>



<a name="254451408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451408">(Sep 22 2021 at 22:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> so, shouldn't that be a problem resolved by mathlib then (if it means a contributor made an error)?</p>



<a name="254451463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451463">(Sep 22 2021 at 22:45)</a>:</h4>
<p>It's not really a mathlib specific problem</p>



<a name="254451485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451485">(Sep 22 2021 at 22:45)</a>:</h4>
<p>You probably don't want a build to spuriously succeed when there are errors in unimported files</p>



<a name="254451562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451562">(Sep 22 2021 at 22:46)</a>:</h4>
<p>It seems perfectly reasonable to expect a library to provide a module that imports everything the library provides.</p>



<a name="254451596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451596">(Sep 22 2021 at 22:46)</a>:</h4>
<p>maybe the library can provide that if it wants, but it's not obvious to me that all libraries should be built like that</p>



<a name="254451646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451646">(Sep 22 2021 at 22:47)</a>:</h4>
<p>most of the time the library allows ways to import specific parts of interest</p>



<a name="254451764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451764">(Sep 22 2021 at 22:48)</a>:</h4>
<p>Why not? I would expect to be able to import a library in its entirety -- the only case where this is less than desirable would be in libraries that are not, in fact, a single library, but are instead a conglomeration of multiple relevantly distinct sub libraries. In which case they should be packaged separately.</p>



<a name="254451806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451806">(Sep 22 2021 at 22:48)</a>:</h4>
<p>I notice my comment above about python namespace packages was ignored, so this comparison may not be helpful here; but <code>scipy</code> behaves in the way Mario describes</p>



<a name="254451839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451839">(Sep 22 2021 at 22:49)</a>:</h4>
<p>There is no one "import all of SciPy" file, because that's not a sensible thing to do</p>



<a name="254451950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451950">(Sep 22 2021 at 22:50)</a>:</h4>
<p>You have to import the components you care about like <code>scipy.stats</code> and <code>scipy.signal</code> separately.</p>



<a name="254451987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254451987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254451987">(Sep 22 2021 at 22:50)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> <code>scipy</code> has an <code>__init__.py</code> which is exactly that module (in Python).</p>



<a name="254452000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452000">(Sep 22 2021 at 22:50)</a>:</h4>
<p>No it's not</p>



<a name="254452036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452036">(Sep 22 2021 at 22:51)</a>:</h4>
<p>Because it doesn't import those submodules</p>



<a name="254452074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452074">(Sep 22 2021 at 22:51)</a>:</h4>
<p>It's the place that <em>could</em> contain that behavior, but by a conscious choice does not.</p>



<a name="254452091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452091">(Sep 22 2021 at 22:51)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> well yes, but that is due to how Python's module system works, it unifies the entire directory structure into a module so you don't have to do such specification manually.</p>



<a name="254452214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452214">(Sep 22 2021 at 22:52)</a>:</h4>
<p>Unlike, for example, JS, where you would.</p>



<a name="254452234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452234">(Sep 22 2021 at 22:53)</a>:</h4>
<p>Which is exactly what lean3 does too (replacing <code>__init__.py</code> with <code>default.lean</code>), right?</p>



<a name="254452416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452416">(Sep 22 2021 at 22:54)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> sort of. However, there is a major distinction. In Lean importing <code>Foo</code> for a directory  <code>Foo</code> only imports the <code>default.lean</code>. In Python, importing <code>Foo</code> would import the entire directory structure recursively.</p>



<a name="254452442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452442">(Sep 22 2021 at 22:54)</a>:</h4>
<p>That's also false</p>



<a name="254452492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452492">(Sep 22 2021 at 22:55)</a>:</h4>
<p><code>import Foo</code> only runs <code>Foo/__init__.py</code> - <code>assert "Foo.Bar" not in sys.modules</code> proves that.</p>



<a name="254452646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452646">(Sep 22 2021 at 22:56)</a>:</h4>
<p>I may be mistaken, Python is mostly certainly not may language of choice, so I am not an expert, but I am pretty sure that after an <code>import scipy</code>, for example, you could refer to <code>scipu.odr.models.polynomial</code>.</p>



<a name="254452706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452706">(Sep 22 2021 at 22:57)</a>:</h4>
<p>Only if <code>__init__.py</code> contains <code>import .odr</code></p>



<a name="254452770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452770">(Sep 22 2021 at 22:58)</a>:</h4>
<p>are you sure?</p>



<a name="254452818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452818">(Sep 22 2021 at 22:58)</a>:</h4>
<p>Yes</p>



<a name="254452922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452922">(Sep 22 2021 at 22:59)</a>:</h4>
<p>Welp, guess I was wrong, that was not my understanding.</p>



<a name="254452964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254452964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254452964">(Sep 22 2021 at 22:59)</a>:</h4>
<p>(And it's very much stylistically discouraged to do this in Python -- i.e. if you're a package author, you should not import all your submodules in your <code>__init__.pys</code>) And similarly for users of modules, they should not use <code>import foo</code> and rely on <code>foo.bar</code> being imported just because <code>foo</code> happens to do so for its own reasons.</p>



<a name="254453165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453165">(Sep 22 2021 at 23:00)</a>:</h4>
<p>It should be noted, though, that appealing to Python is not a great way to convince me of something, as it is my most hated language. XD</p>



<a name="254453183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453183">(Sep 22 2021 at 23:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254452770">said</a>:</p>
<blockquote>
<p>are you sure?</p>
</blockquote>
<p>this becomes really important for python libraries that bind to large c++ libraries, which take a significant amount of time to import and resolve symbols. We structure our wrapping code in the same way, the base python module certainly doesn't import all submodules.</p>



<a name="254453376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453376">(Sep 22 2021 at 23:02)</a>:</h4>
<p><span class="user-mention" data-user-id="130511">@Christian Pehle</span> then what is the point of the base module then?</p>



<a name="254453397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453397">(Sep 22 2021 at 23:02)</a>:</h4>
<p>Namespacing, mainly</p>



<a name="254453398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453398">(Sep 22 2021 at 23:02)</a>:</h4>
<p>why not just import the submodules?</p>



<a name="254453405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453405">(Sep 22 2021 at 23:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254453376">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="130511">Christian Pehle</span> then what is the point of the base module then?</p>
</blockquote>
<p>In order to organise everything under a common name</p>



<a name="254453488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453488">(Sep 22 2021 at 23:03)</a>:</h4>
<p>like in the scipy example.</p>



<a name="254453501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453501">(Sep 22 2021 at 23:03)</a>:</h4>
<p>But why does that name need to be importable then?</p>



<a name="254453510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453510">(Sep 22 2021 at 23:03)</a>:</h4>
<blockquote>
<p>I notice my comment above about python namespace packages was ignored, so this comparison may not be helpful here; but scipy behaves in the way Mario describes</p>
</blockquote>
<p>I didn't see your comment until now, and maybe this isn't relevant for Lean but IMO namespace packages would be much more popular in Python if we hadn't botched their implementation for the first 10 years they existed -- everyone was scarred by how broken they were that by the time they worked folks had learned not to use them. But for a new language I'd certainly expect namespace package-like functionality to be useful personally.</p>



<a name="254453525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453525">(Sep 22 2021 at 23:03)</a>:</h4>
<p>Sometimes <code>mypackage/__init__.py</code> contains little more than <code>mypackage.__version__</code> and a docstring.</p>



<a name="254453682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453682">(Sep 22 2021 at 23:04)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> Also note that I didn't answer your question directly because <span class="user-mention" data-user-id="130511">@Christian Pehle</span> asked a similar question right below it and I ended up responding to him.</p>



<a name="254453701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453701">(Sep 22 2021 at 23:05)</a>:</h4>
<p><span class="user-mention" data-user-id="321696">@Julian Berman</span>: especially since lean 3 has exactly this namespace package behavior already</p>



<a name="254453726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453726">(Sep 22 2021 at 23:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254453501">said</a>:</p>
<blockquote>
<p>But why does that name need to be importable then?</p>
</blockquote>
<p>well it might only import some of the functionality and not others, this would be library specific. for example you might decide to make common functionality available and not import certain other functionality by default.</p>



<a name="254453787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453787">(Sep 22 2021 at 23:05)</a>:</h4>
<p>I think <code>import tactic</code> is like this</p>



<a name="254453788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453788">(Sep 22 2021 at 23:05)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> And for the record, my response was that this proposal and Lake at the moment support such a thing already.</p>



<a name="254453809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453809">(Sep 22 2021 at 23:05)</a>:</h4>
<p>it imports most but not all of the things in <code>tactic.*</code></p>



<a name="254453929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254453929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254453929">(Sep 22 2021 at 23:06)</a>:</h4>
<p>But what if I <em>want</em> to import everything, it seems perfectly reasonable to ask for clean way to do this from a library.</p>



<a name="254454011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454011">(Sep 22 2021 at 23:07)</a>:</h4>
<p>What's the line of reasoning for wanting to import everything?</p>



<a name="254454124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454124">(Sep 22 2021 at 23:08)</a>:</h4>
<p>Is it because of things like simp and library_search?</p>



<a name="254454259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454259">(Sep 22 2021 at 23:09)</a>:</h4>
<p>The build tool can handle construction of an exhaustive import, this is what <code>leanproject mk-all</code> is for</p>



<a name="254454263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454263">(Sep 22 2021 at 23:10)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> Yeah, those are good examples. It is also useful if is just trying to whip a quick example / test and doesn't want to go hunt down where something comes from.</p>



<a name="254454412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454412">(Sep 22 2021 at 23:11)</a>:</h4>
<p>but I don't think such imports should ever be used by users. The library author is responsible for providing convenient entry points to the API, which may or may not coincide with importing literally everything</p>



<a name="254454603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454603">(Sep 22 2021 at 23:12)</a>:</h4>
<p>I mostly disagree and from the initial design of Lean 4's build system it seems like the devs did to. However, I can see the merit in a alternatively build strategy that just builds everything in the source dir. So I will put that in the TODOs.</p>



<a name="254454805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454805">(Sep 22 2021 at 23:14)</a>:</h4>
<p>In fact, it was already in my list of ideas, I just didn't rate it highly as it was not part of the original build system and it would require a somewhat significant overhaul.</p>



<a name="254454915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454915">(Sep 22 2021 at 23:15)</a>:</h4>
<p>What's the downside of building everything in the source dir?</p>



<a name="254454985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254454985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254454985">(Sep 22 2021 at 23:16)</a>:</h4>
<p>(other than not having an implementation of it yet!)</p>



<a name="254455095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455095">(Sep 22 2021 at 23:17)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> you way wish to conditionally compile files based on what target you are building. For example, the binary may use some files from the source directory while the library uses others.</p>



<a name="254455191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455191">(Sep 22 2021 at 23:18)</a>:</h4>
<p>For example, mathport probably doesn't want its binary being shipped with its library.</p>



<a name="254455410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455410">(Sep 22 2021 at 23:20)</a>:</h4>
<p>Right now, the mathport binary is in a completely separate package from the library. I consider this a suboptimal solution</p>



<a name="254455478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455478">(Sep 22 2021 at 23:21)</a>:</h4>
<p>From what understand, <span class="user-mention" data-user-id="230999">@Daniel Selsam</span> was working on changing that (as Lake already supports an alternate binary root from the main library root).</p>



<a name="254455494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455494">(Sep 22 2021 at 23:22)</a>:</h4>
<p>That's what I mean, that was the change</p>



<a name="254455557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455557">(Sep 22 2021 at 23:22)</a>:</h4>
<p>What do you mean?</p>



<a name="254455573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455573">(Sep 22 2021 at 23:22)</a>:</h4>
<p>It was previously in one directory, now everything is in a further <code>Lib/</code> directory and I can't open <code>mathport</code> anymore and browse around in vscode</p>



<a name="254455607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455607">(Sep 22 2021 at 23:23)</a>:</h4>
<p>No, I was saying that he was working on merging it back into one directory (using Lake's support for alternate binary roots).</p>



<a name="254455714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455714">(Sep 22 2021 at 23:24)</a>:</h4>
<p>It should be fully possible to do so with the current Lake.</p>



<a name="254455727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455727">(Sep 22 2021 at 23:24)</a>:</h4>
<p>At the moment, the app is at <code>App/MathportApp.lean</code> and everything else is in <code>Lib/Mathport/*.lean</code></p>



<a name="254455742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455742">(Sep 22 2021 at 23:24)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I tried to get your "one-package" solution to work for mathport but (caveat: I didn't try hard at all) wasn't able to get the imports to work cleanly, i.e. to avoid an extra layer e.g. <code>Lib.</code>. I would happily merge a mathport PR that makes it one-package if the imports stay mostly the same.</p>



<a name="254455914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455914">(Sep 22 2021 at 23:26)</a>:</h4>
<p>that extra layer is exactly why I think tying the import name to the package name is a bad idea</p>



<a name="254455933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455933">(Sep 22 2021 at 23:26)</a>:</h4>
<p>because now we would need <code>import MathportLib.*</code> and <code>import MathportApp.*</code></p>



<a name="254455983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254455983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254455983">(Sep 22 2021 at 23:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254455933">said</a>:</p>
<blockquote>
<p>because now we would need <code>import MathportLib.*</code> and <code>import MathportApp.*</code></p>
</blockquote>
<p>Right now "MathportLib" is just called <code>Mathport</code>, and the point of <code>MathportApp</code> is that it never gets imported.</p>



<a name="254456111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456111">(Sep 22 2021 at 23:28)</a>:</h4>
<p>You use emacs so the experience might be different, but in vscode I have the issue since the refactor that opening the <code>mathport</code> directory doesn't let me browse lean files anymore, it can't resolve the imports</p>



<a name="254456132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456132">(Sep 22 2021 at 23:28)</a>:</h4>
<p>I have to open the <code>Lib</code> directory instead</p>



<a name="254456135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456135">(Sep 22 2021 at 23:28)</a>:</h4>
<p>While the three of us are here -- it is time for <code>Mathport</code> (the library, which uses <code>lake</code>) to depend on <code>Mathlib4</code> (which uses <code>leanpkg</code>). Should I just swap out <code>leanpkg</code> for <code>lake</code> in a fork for now, or PR the swap?</p>



<a name="254456196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456196">(Sep 22 2021 at 23:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I imagine that is because there is not yet support for <code>lake</code> in VSCode?</p>



<a name="254456203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456203">(Sep 22 2021 at 23:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254456132">said</a>:</p>
<blockquote>
<p>I have to open the <code>Lib</code> directory instead</p>
</blockquote>
<p>Ah, I have not had a similar issue in Emacs. I don't know enough about VSCode to know if there is any easy fix for that.</p>



<a name="254456349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456349">(Sep 22 2021 at 23:31)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> I get the following error when trying to build mathport:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">.\.\</span><span class="n">Mathport</span><span class="bp">\</span><span class="n">Prelude</span><span class="bp">\</span><span class="n">Syntax.lean</span><span class="o">:</span><span class="mi">154</span><span class="o">:</span><span class="mi">35</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">tactic</span>
</code></pre></div>
<p>Do you know why this might be?</p>



<a name="254456453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456453">(Sep 22 2021 at 23:32)</a>:</h4>
<p>Probably a lean4 version issue. <code>allGoals</code> was changed relatively recently to <code>all_goals</code>.</p>



<a name="254456484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456484">(Sep 22 2021 at 23:32)</a>:</h4>
<p>ah, yep that is likely it</p>



<a name="254456513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456513">(Sep 22 2021 at 23:33)</a>:</h4>
<p>I forgot to update the version in the <code>lean-toolchain</code> file.</p>



<a name="254456665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456665">(Sep 22 2021 at 23:34)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I just pushed a change to use the most recently nightly. I don't know how to even check that it works though -- do you mind pulling and seeing if it builds?</p>



<a name="254456726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456726">(Sep 22 2021 at 23:35)</a>:</h4>
<p>fyi, the most recently nightly is 09-22</p>



<a name="254456966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254456966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254456966">(Sep 22 2021 at 23:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254456726">said</a>:</p>
<blockquote>
<p>fyi, the most recently nightly is 09-22</p>
</blockquote>
<p>thanks, force-pushed</p>



<a name="254457182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254457182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254457182">(Sep 22 2021 at 23:41)</a>:</h4>
<p>ah, I was waiting for the snake case naming change to land on nightly before updating mathport</p>



<a name="254458589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254458589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254458589">(Sep 22 2021 at 23:59)</a>:</h4>
<p>Just checking, <span class="user-mention" data-user-id="230999">@Daniel Selsam</span> , mathport builds consistently on your machine with Lake currently?</p>



<a name="254458975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254458975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254458975">(Sep 23 2021 at 00:02)</a>:</h4>
<p>I am encountering the errors you mentioned but, oddly, just repeating the build multiple resolves them. This makes me suspect it is some race condition (i.e., some bug in Lake build ordering).</p>



<a name="254459031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459031">(Sep 23 2021 at 00:03)</a>:</h4>
<p>I just downloaded <code>lake</code> and building mathport seems to work, although vscode doesn't work in the <code>Lib</code> folder either right now</p>



<a name="254459038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459038">(Sep 23 2021 at 00:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254458589">said</a>:</p>
<blockquote>
<p>Just checking, <span class="user-mention silent" data-user-id="230999">Daniel Selsam</span> , mathport builds consistently on your machine with Lake currently?</p>
</blockquote>
<p>Yes, mathport builds consistently on my machine. It takes a long time though due to some gnarly mutual inductives.</p>



<a name="254459068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459068">(Sep 23 2021 at 00:03)</a>:</h4>
<p>I haven't updated <code>lake</code> in a while though.</p>



<a name="254459349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459349">(Sep 23 2021 at 00:06)</a>:</h4>
<p>On the other hand, it seems like a Lean problem because it ends up with errors like "unknown namespace Lean" which should not be something Lake could make disappear.</p>



<a name="254459369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459369">(Sep 23 2021 at 00:06)</a>:</h4>
<p>does <code>lake</code> interoperate with the lean server mode at all? It seems to not know what to do at all without a <code>leanpkg.toml</code> file</p>



<a name="254459442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459442">(Sep 23 2021 at 00:07)</a>:</h4>
<p>I haven't tested this, but you might be able to set the <code>leanpkg</code> executable for VS Code to <code>lake</code> and make it work.</p>



<a name="254459446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459446">(Sep 23 2021 at 00:07)</a>:</h4>
<p>The lean server / vscode extension should be able to recognize either the lake config file or a file generated by lake</p>



<a name="254459547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459547">(Sep 23 2021 at 00:08)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> I don't think my lean4 version is exactly tonight's nightly. I forget how to find the commit hash for a given nightly -- what commit exactly are you using?</p>



<a name="254459574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459574">(Sep 23 2021 at 00:08)</a>:</h4>
<p>The one you pushed to the repo :)</p>



<a name="254459619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459619">(Sep 23 2021 at 00:09)</a>:</h4>
<p>Can you remind me how I find out what commit number that is? I don't use the nightly stuff, I build lean locally.</p>



<a name="254459629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459629">(Sep 23 2021 at 00:09)</a>:</h4>
<p>note that the next nightly is currently in progress (it runs at 5 PM PST)</p>



<a name="254459675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459675">(Sep 23 2021 at 00:10)</a>:</h4>
<p>This is 09-22 nightly -&gt; <a href="https://github.com/leanprover/lean4/actions/runs/1259774217">https://github.com/leanprover/lean4/actions/runs/1259774217</a></p>



<a name="254459699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459699">(Sep 23 2021 at 00:10)</a>:</h4>
<p>Thanks, I found it. The "CI" action.</p>



<a name="254459716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459716">(Sep 23 2021 at 00:10)</a>:</h4>
<p>search for "scheduled" actions</p>



<a name="254459895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459895">(Sep 23 2021 at 00:13)</a>:</h4>
<p>no, that is actually the 09-23 nightly</p>



<a name="254459911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254459911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254459911">(Sep 23 2021 at 00:13)</a>:</h4>
<p>nightlies are named after the following day in Lean (from a US perspective)</p>



<a name="254460025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460025">(Sep 23 2021 at 00:14)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> could you try to clone and build <a href="https://github.com/tydeu/mathport">https://github.com/tydeu/mathport</a> (by running <code>lake build-bin</code> in <code>Lib</code>) -- I am curious if you get the same errors I am.</p>



<a name="254460057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460057">(Sep 23 2021 at 00:15)</a>:</h4>
<p>Why are you building <code>bin</code> there?</p>



<a name="254460061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460061">(Sep 23 2021 at 00:15)</a>:</h4>
<p>the action I pointed to ran yesterday</p>



<a name="254460088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460088">(Sep 23 2021 at 00:15)</a>:</h4>
<p>Here is my mathport meta-build process: <a href="https://github.com/leanprover/mathport/blob/master/Makefile#L3-L9">https://github.com/leanprover/mathport/blob/master/Makefile#L3-L9</a></p>



<a name="254460104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460104">(Sep 23 2021 at 00:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> ah, sorry, my bad</p>



<a name="254460184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460184">(Sep 23 2021 at 00:16)</a>:</h4>
<p>Oh and I just found out a non-hacky way of dealing with the <code>cd Lib &amp;&amp;</code>. I will fix.</p>



<a name="254460194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460194">(Sep 23 2021 at 00:16)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> ah, that is still equivalent to just running the build from <code>Lib</code> right?</p>



<a name="254460216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460216">(Sep 23 2021 at 00:16)</a>:</h4>
<p>Yes, <code>lake build-lib</code> in <code>Lib</code>.</p>



<a name="254460241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460241">(Sep 23 2021 at 00:16)</a>:</h4>
<p>Ah I merged the bin and lib and wanted to see if it would work for you</p>



<a name="254460288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460288">(Sep 23 2021 at 00:17)</a>:</h4>
<p>but you still have a <code>Lib</code> folder?</p>



<a name="254460289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460289">(Sep 23 2021 at 00:17)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> FYI leanprover/mathport/master builds fine for me on 6a880fecc996, which I think is the nightly in the tool file.</p>



<a name="254460292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460292">(Sep 23 2021 at 00:17)</a>:</h4>
<p>I missed the fact that there was a Makefile. XD</p>



<a name="254460311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460311">(Sep 23 2021 at 00:17)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> exactly, hence why I wanted you to try build my change</p>



<a name="254460378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460378">(Sep 23 2021 at 00:18)</a>:</h4>
<p>I understand now, I am building your project.</p>



<a name="254460386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460386">(Sep 23 2021 at 00:18)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> you should try dumping everything in your <code>Lib/</code> folder in the root and try to make it work that way</p>



<a name="254460410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460410">(Sep 23 2021 at 00:18)</a>:</h4>
<p>that was roughly what the directory hierarchy looked like a month ago</p>



<a name="254460437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460437">(Sep 23 2021 at 00:19)</a>:</h4>
<p>sure, but first I just wanted to see if <span class="user-mention" data-user-id="230999">@Daniel Selsam</span> got the same errors I do to see if this was just a problem with my setup (which I suspect it may be).</p>



<a name="254460522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460522">(Sep 23 2021 at 00:20)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> Beautiful. It works. Having both lean files in the same directory is the "trick" I overlooked.</p>



<a name="254460564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460564">(Sep 23 2021 at 00:20)</a>:</h4>
<p>Let me confirm that I can import the Library from another executable...</p>



<a name="254460567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460567">(Sep 23 2021 at 00:20)</a>:</h4>
<p>Yeah, that is a requirement that is enforced by Lean.</p>



<a name="254460654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460654">(Sep 23 2021 at 00:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254459442">said</a>:</p>
<blockquote>
<p>I haven't tested this, but you might be able to set the <code>leanpkg</code> executable for VS Code to <code>lake</code> and make it work.</p>
</blockquote>
<p>This didn't work for me, I still get the same error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">unknown</span> <span class="n">package</span> <span class="bp">'</span><span class="n">Mathport'</span>
<span class="n">You</span> <span class="n">might</span> <span class="n">need</span> <span class="n">to</span> <span class="kn">open</span> <span class="bp">'/</span><span class="n">home</span><span class="bp">/</span><span class="n">mario</span><span class="bp">/</span><span class="n">Documents</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">Lib'</span> <span class="n">as</span> <span class="n">a</span> <span class="n">workspace</span> <span class="k">in</span> <span class="n">your</span> <span class="n">editor</span>
</code></pre></div>
<p>(this is when the <code>Lib</code> folder is open as the root and opening a random mathport file that imports another one)</p>



<a name="254460739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460739">(Sep 23 2021 at 00:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="230999">Daniel Selsam</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254460564">said</a>:</p>
<blockquote>
<p>Let me confirm that I can import the Library from another executable...</p>
</blockquote>
<p>It works. <span class="user-mention" data-user-id="315577">@Mac</span> Thanks for your help! I will refactor Mathport now (as Mario suggests, with both lean files in the root dir).</p>



<a name="254460762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460762">(Sep 23 2021 at 00:23)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> are you on windows?</p>



<a name="254460772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460772">(Sep 23 2021 at 00:23)</a>:</h4>
<p>linux</p>



<a name="254460788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460788">(Sep 23 2021 at 00:23)</a>:</h4>
<p>Oh,  I noticed you were talking about the editor -- yeah that happens to me as well.</p>



<a name="254460916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460916">(Sep 23 2021 at 00:25)</a>:</h4>
<p>What are the plans for making editor usage work? If possible, we should not need to require that a particular folder is open as root</p>



<a name="254460999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254460999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254460999">(Sep 23 2021 at 00:26)</a>:</h4>
<p>lean 3 walked up the folder hierarchy to find a <code>leanpkg.path</code> file which determined the root, as well as import resolution</p>



<a name="254461104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461104">(Sep 23 2021 at 00:27)</a>:</h4>
<p>(needless to say, this is pretty high priority breakage for me - I can't really imagine using lean non-interactively)</p>



<a name="254461225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461225">(Sep 23 2021 at 00:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> you need to point your LEAN_PATH at the build directory (i.e., <code>Lib/build/lib</code>)</p>



<a name="254461311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461311">(Sep 23 2021 at 00:30)</a>:</h4>
<p>This is editor usage we're talking about here, there is no manual LEAN_PATH</p>



<a name="254461394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461394">(Sep 23 2021 at 00:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> you can have a setting like the following in your <code>.vscode/settings.json</code></p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"lean4.serverEnv"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"LEAN_PATH"</span><span class="p">:</span> <span class="s2">"./Lib/build/lib"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



<a name="254461417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461417">(Sep 23 2021 at 00:31)</a>:</h4>
<p>is that being committed?</p>



<a name="254461444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461444">(Sep 23 2021 at 00:31)</a>:</h4>
<p>It could be?</p>



<a name="254461547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461547">(Sep 23 2021 at 00:32)</a>:</h4>
<p>maybe <code>lake config-vscode</code> can add this setting as appropriate?</p>



<a name="254461564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461564">(Sep 23 2021 at 00:33)</a>:</h4>
<p>The problem is that Lake is not yet following integrated with Lean, so the Lean server is still using <code>leanpkg</code>.</p>



<a name="254461568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461568">(Sep 23 2021 at 00:33)</a>:</h4>
<p>it still seems kind of unfortunate</p>



<a name="254461585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461585">(Sep 23 2021 at 00:33)</a>:</h4>
<p>What is the perfect world version of integration here?</p>



<a name="254461688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461688">(Sep 23 2021 at 00:34)</a>:</h4>
<p>Well the first step is this: <a href="https://github.com/leanprover/lean4/pull/683">https://github.com/leanprover/lean4/pull/683</a></p>



<a name="254461711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461711">(Sep 23 2021 at 00:34)</a>:</h4>
<p>Lake will soon be bundled and distributed with Lean instead of leanpkg</p>



<a name="254461713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461713">(Sep 23 2021 at 00:34)</a>:</h4>
<p>I set the leanpkg path to <code>lake</code> but I noticed that this setting is called <code>lean.leanpkgPath</code> instead of <code>lean4.leanpkgPath</code> so probably it's not the right setting</p>



<a name="254461774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461774">(Sep 23 2021 at 00:35)</a>:</h4>
<p>oh, so that might be arriving in today's nightly?</p>



<a name="254461793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461793">(Sep 23 2021 at 00:35)</a>:</h4>
<p>You are right, in Lean 4, <code>leanpkg</code> is just currently hard coded into the server</p>



<a name="254461855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461855">(Sep 23 2021 at 00:36)</a>:</h4>
<p>I will try symlinking it</p>



<a name="254461907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461907">(Sep 23 2021 at 00:36)</a>:</h4>
<p>Note that the lean server uses the <code>leanpkg</code> in its direct not the one from <code>PATH</code></p>



<a name="254461950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254461950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254461950">(Sep 23 2021 at 00:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254461104">said</a>:</p>
<blockquote>
<p>(needless to say, this is pretty high priority breakage for me - I can't really imagine using lean non-interactively)</p>
</blockquote>
<p>FYI when I use mathported packages, I just set my LEAN_PATH manually and it works for both Emacs and VSCode. Specifically, I have <code>MATHPORT_PATH</code> in my <code>.bashrc</code> and then just type <code>LEAN_PATH=$MATHPORT_PATH code &amp;</code> or whatever. I agree it would be great if this were easy &amp; automatic for normal lake projects, but the fallback needn't be using Lean non-interactively.</p>



<a name="254462328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462328">(Sep 23 2021 at 00:42)</a>:</h4>
<p>hm, <code>env LEAN_PATH=Lib/build/Mathport code .</code> from the project root isn't working for me</p>



<a name="254462333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462333">(Sep 23 2021 at 00:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254461774">said</a>:</p>
<blockquote>
<p>oh, so that might be arriving in today's nightly?</p>
</blockquote>
<p>Ah no, it is a draft PR after all, but I imagine it will probably there in a week or so.</p>



<a name="254462360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462360">(Sep 23 2021 at 00:42)</a>:</h4>
<p>How about a patch to the extension to add the <code>leanpkgPath</code> option?</p>



<a name="254462398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462398">(Sep 23 2021 at 00:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254462328">said</a>:</p>
<blockquote>
<p>hm, <code>env LEAN_PATH=Lib/build/Mathport code .</code> from the project root isn't working for me</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">LEAN_PATH</span><span class="bp">=&lt;</span><span class="n">package</span><span class="bp">-</span><span class="n">root</span><span class="bp">&gt;/</span><span class="n">build</span><span class="bp">/</span><span class="n">lib</span><span class="o">:</span><span class="bp">&lt;</span><span class="n">other</span><span class="bp">-</span><span class="n">package</span><span class="bp">-</span><span class="n">root</span><span class="bp">&gt;/</span><span class="n">build</span><span class="bp">/</span><span class="n">lib</span>
</code></pre></div>



<a name="254462478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462478">(Sep 23 2021 at 00:44)</a>:</h4>
<p>Also I pushed the refactor, so this should be moot for now. Can you confirm that everything works smoothly once you pull <a href="https://github.com/leanprover/mathport/commit/b7481b0814b53e198cdc63f6b57a9e08854c116f">https://github.com/leanprover/mathport/commit/b7481b0814b53e198cdc63f6b57a9e08854c116f</a>?</p>



<a name="254462872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462872">(Sep 23 2021 at 00:49)</a>:</h4>
<p>things look good with <code>env LEAN_PATH=&lt;root&gt;/build/lib code .</code></p>



<a name="254462928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254462928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254462928">(Sep 23 2021 at 00:50)</a>:</h4>
<p>although I can't open <code>package.lean</code> because of <code>import Lake.*</code></p>



<a name="254463039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463039">(Sep 23 2021 at 00:51)</a>:</h4>
<p>I guess that can't be fixed until <code>Lake</code> is packaged with the standard distribution?</p>



<a name="254463066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463066">(Sep 23 2021 at 00:51)</a>:</h4>
<p>you could add lake's build dir to the <code>LEAN_PATH</code> as well</p>



<a name="254463078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463078">(Sep 23 2021 at 00:51)</a>:</h4>
<p>you can always concatenate <del><code>&lt;lake-root&gt;/build/lib</code></del> <code>&lt;lake-root&gt;/build</code> to LEAN_PATH as well</p>



<a name="254463153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463153">(Sep 23 2021 at 00:52)</a>:</h4>
<p>actually it would just be <code>&lt;lake-root&gt;/build</code> (as Lake is built with <code>leanmake</code>)</p>



<a name="254463205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463205">(Sep 23 2021 at 00:53)</a>:</h4>
<p>Just to give an idea of what this RFC was originally about, the idea is that instead of:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">package</span> <span class="o">:</span> <span class="n">Lake.PackageConfig</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">name</span> <span class="o">:=</span> <span class="s2">"Mathport"</span>
  <span class="n">version</span> <span class="o">:=</span> <span class="s2">"0.1"</span>
  <span class="n">binRoot</span> <span class="o">:=</span> <span class="bp">`</span><span class="n">MathportApp</span>
<span class="o">}</span>
</code></pre></div>
<p>you would just have:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">package</span> <span class="o">:</span> <span class="n">Lake.PackageConfig</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">moduleRoot</span> <span class="o">:=</span> <span class="bp">`</span><span class="n">Mathport</span>
  <span class="n">binRoot</span> <span class="o">:=</span> <span class="bp">`</span><span class="n">MathportApp</span>
<span class="o">}</span>
</code></pre></div>



<a name="254463359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463359">(Sep 23 2021 at 00:55)</a>:</h4>
<p>what if that was <code>moduleRoots</code> and took a list of module names?</p>



<a name="254463373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463373">(Sep 23 2021 at 00:55)</a>:</h4>
<p>or a glob</p>



<a name="254463518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463518">(Sep 23 2021 at 00:57)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> multiple module roots is certainly feasible. In fact, the single root is actually a special case of a multi root function.</p>



<a name="254463541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463541">(Sep 23 2021 at 00:57)</a>:</h4>
<p>with a glob you can get the "build everything in the directory" behavior</p>



<a name="254463593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463593">(Sep 23 2021 at 00:58)</a>:</h4>
<p>yeah, but that would require some support in Lean for globs XD</p>



<a name="254463602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463602">(Sep 23 2021 at 00:58)</a>:</h4>
<p>no, I'm thinking that you interpret the glob yourself</p>



<a name="254463614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463614">(Sep 23 2021 at 00:58)</a>:</h4>
<p>also, the idea is that is suppose to be a module <code>Name</code>, not a <code>String</code>.</p>



<a name="254463652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463652">(Sep 23 2021 at 00:59)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> sure, of course, I could do that</p>



<a name="254463691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463691">(Sep 23 2021 at 00:59)</a>:</h4>
<p>Having built in lean support for <code>import tactic.*</code> would be interesting, but probably isn't needed in the short term</p>



<a name="254463834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463834">(Sep 23 2021 at 01:00)</a>:</h4>
<p>oh, I didn't mean globs in imports, I meant globs in a string (i.e., in <code>IO</code> to find files).</p>



<a name="254463879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463879">(Sep 23 2021 at 01:01)</a>:</h4>
<p>Having to write one of my own makes such a request considerably more work</p>



<a name="254463916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463916">(Sep 23 2021 at 01:02)</a>:</h4>
<p>That is, you would have <code>moduleRoots := [`Mathport.*]</code> and it would get everything in the mathport directory</p>



<a name="254463961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463961">(Sep 23 2021 at 01:02)</a>:</h4>
<p>maybe that doesn't work because <code>*</code> is not an identifier char</p>



<a name="254463973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463973">(Sep 23 2021 at 01:03)</a>:</h4>
<p>but it would work with strings</p>



<a name="254463989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254463989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254463989">(Sep 23 2021 at 01:03)</a>:</h4>
<p>That would require either that name literals support globs or the creation of my own new <code>Name</code> type and syntax -- again more work that I am not sure I would like to invest in at the moment</p>



<a name="254464054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464054">(Sep 23 2021 at 01:04)</a>:</h4>
<p>or you could have an inductive type <code>NameOrGlob</code> with a coercion for <code>Name</code> and a function <code>glob `Mathport</code>  to mean <code>Mathport.*</code></p>



<a name="254464060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464060">(Sep 23 2021 at 01:04)</a>:</h4>
<p>Anyway, the point of this RFC is just whether removing the version field and potentially merging name with module root are okay ideas.</p>



<a name="254464076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464076">(Sep 23 2021 at 01:04)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  again, very true</p>



<a name="254464098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464098">(Sep 23 2021 at 01:05)</a>:</h4>
<p>though at that point it would not be a list of module roots, but rather a list of modules</p>



<a name="254464113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464113">(Sep 23 2021 at 01:05)</a>:</h4>
<p>yeah <code>moduleRoots</code> is a misnomer</p>



<a name="254464122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464122">(Sep 23 2021 at 01:05)</a>:</h4>
<p>maybe <code>builds</code> is better</p>



<a name="254464137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464137">(Sep 23 2021 at 01:05)</a>:</h4>
<p>well, its not a misnomer at the moment</p>



<a name="254464204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464204">(Sep 23 2021 at 01:06)</a>:</h4>
<p>it seems to be equivocating between whether it refers to the module to build or the root module</p>



<a name="254464268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464268">(Sep 23 2021 at 01:07)</a>:</h4>
<p>it is the root the module -- all submodules of this root are built during the build and it is the first one built.</p>



<a name="254464284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464284">(Sep 23 2021 at 01:07)</a>:</h4>
<p>it is also the root of the resulting import DAG</p>



<a name="254464296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464296">(Sep 23 2021 at 01:07)</a>:</h4>
<p><code>binRoot</code> seems not to be the root of the module hierarchy it depends on</p>



<a name="254464343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464343">(Sep 23 2021 at 01:08)</a>:</h4>
<p>e.g. <code>MathportApp</code> depends on <code>Mathport.Foo.Bar</code></p>



<a name="254464364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464364">(Sep 23 2021 at 01:08)</a>:</h4>
<p>bin root is the root of its import DAG, it is however not of the modules to build</p>



<a name="254464390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464390">(Sep 23 2021 at 01:08)</a>:</h4>
<p><code>builds</code> is the root(s) of the import DAG too</p>



<a name="254464499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464499">(Sep 23 2021 at 01:10)</a>:</h4>
<p>yes, <code>moduleRoots := [`Foo, `Bar, ...]</code> would still be a list of roots</p>



<a name="254464526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464526">(Sep 23 2021 at 01:10)</a>:</h4>
<p>However, <code>modules := [glob `Foo]</code> would no longer be.</p>



<a name="254464575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464575">(Sep 23 2021 at 01:11)</a>:</h4>
<p>sure</p>



<a name="254464602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464602">(Sep 23 2021 at 01:11)</a>:</h4>
<p>The type could actually be <code>IO (List Name)</code>, using coercions to make <code>glob</code> work</p>



<a name="254464714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464714">(Sep 23 2021 at 01:12)</a>:</h4>
<p>well, there are lots of less fancy ways to make it work</p>



<a name="254464788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464788">(Sep 23 2021 at 01:13)</a>:</h4>
<p>a package config can already use <code>IO</code> with an <code>IOPackager</code>, so you could determine the set of modules at configuration time instead of build time, yes.</p>



<a name="254464872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464872">(Sep 23 2021 at 01:14)</a>:</h4>
<p>remind me how those are distinguished in the present architecture?</p>



<a name="254464904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464904">(Sep 23 2021 at 01:15)</a>:</h4>
<p>you just change the return type of <code>package</code> ;)</p>



<a name="254464992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254464992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254464992">(Sep 23 2021 at 01:16)</a>:</h4>
<p>I mean, what is the difference between config time and build time</p>



<a name="254465008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465008">(Sep 23 2021 at 01:16)</a>:</h4>
<p>AFAIK you just call <code>lake build-lib</code> and it does everything</p>



<a name="254465011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465011">(Sep 23 2021 at 01:16)</a>:</h4>
<p>My next two planned changes are a nice little DSL for configurations and renaming <code>package.lean</code> to <code>lakefile.lean</code> (to generalize it beyond package building)</p>



<a name="254465043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465043">(Sep 23 2021 at 01:17)</a>:</h4>
<p>I think that in the specific case of <code>glob</code> it is worth keeping that "declarative" i.e. not an <code>IOPackager</code></p>



<a name="254465309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465309">(Sep 23 2021 at 01:20)</a>:</h4>
<p>I mostly agree -- the question is simply where it ends up on my priority list</p>



<a name="254465348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465348">(Sep 23 2021 at 01:21)</a>:</h4>
<p>Furthermore, Lake is open source, if you want to propose some change feel free to PR it</p>



<a name="254465357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465357">(Sep 23 2021 at 01:21)</a>:</h4>
<p>I'm looking into that now</p>



<a name="254465451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254465451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254465451">(Sep 23 2021 at 01:22)</a>:</h4>
<p>Honestly, if you can write the glob code (i.e., the type + the translation to a list of modules), I will do the rest.</p>



<a name="254646705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254646705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254646705">(Sep 24 2021 at 03:55)</a>:</h4>
<p>I think the "mathematicians'" perspective on namespacing (in the sense of identifiers) used inside the language and package names (in the sense of specifying dependencies between projects) will uniformly be that these should be completely independent.</p>



<a name="254646760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254646760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254646760">(Sep 24 2021 at 03:56)</a>:</h4>
<p>For a mathematician, I think that it is natural to think about namespaces as "mathematical topics" and packages as "books/articles". Certainly one wants to be able to continue to develop a single topic across several books.</p>



<a name="254646767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254646767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254646767">(Sep 24 2021 at 03:56)</a>:</h4>
<p>As we transition to Lean4 we're hopefully going to see multiple libraries. Initially there will just be mathlib4, but hopefully soon afterwards a programming standard library (possibly with additional packages) will separate out, and mathlib4 will have to continuously adapt as these begin to evolve independently.</p>



<a name="254646776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254646776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254646776">(Sep 24 2021 at 03:56)</a>:</h4>
<p>I think there will be continuous tension that mathlib4 will want "more theorems per definition" relative to a more programming oriented standard library. This is just meant as an illustration that it will remain essential that we can "retrofit" additional theorems onto a definition made in a dependency. Dot notation has been very helpful in allowing readable mathematical notation, and I hope we'll be able to continue doing this. The combination of these two observations is I think a strong argument that a "later" package should be able to create declarations in the exact same namespace as an "earlier" package.</p>



<a name="254646779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254646779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254646779">(Sep 24 2021 at 03:56)</a>:</h4>
<p>We've debated over the last few years about whether or not mathematics should be done in a monolithic repository. (My summary: yes, at least all the "standard material", i.e. everything you might ever see in a "standard" course, should be in one library. Research level maths deserves seperate packages.) Interoperability is hugely important, and this encourages monolithic libraries. (We would be completely justified in arguing that Lean's math ecosystem is strictly superior in terms of interoperability to any other language's.) Nevertheless I think it's important that as Lean4 comes (and as mathlib aims for saturation of masters-level mathematics!) that we make it viable and attractive to have multiple packages. I would say that technical obstacles to sharing namespaces between packages could be a significant obstacle to this (speaking to the mathematics applications).</p>



<a name="254647705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254647705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254647705">(Sep 24 2021 at 04:09)</a>:</h4>
<p>Keep in mind that there are two kinds of namespaces being talked about here, that I will call "import namespaces" and "declaration namespaces". The first kind is the namespacing in <code>Data.Nat.Basic</code>, and the second is <code>List.append</code>.</p>
<p>We did talk about doing strict package based declaration namespacing early on, but I think that the design of dot-notation resolution makes this a non-starter. I get the sense that this is what <span class="user-mention" data-user-id="110087">@Scott Morrison</span> is worried about. But the discussion in this topic has been primarily about import namespacing, i.e. whether it is okay for lean core to have <code>data.vector</code> and mathlib to have <code>data.vector2</code> (which has since been renamed to <code>data.vector.basic</code>).</p>
<p>The design of lean 4 <code>leanpkg</code> specifically disallows overlapping import namespaces, because every import namespace gets prefixed with the name of the package. I think that Scott's argument still applies to import namespaces, at least the way mathlib uses them, because mathlib's import namespaces are essentially topical in nature, like <code>topology.basic</code>, and so it is natural for such namespaces to be used across multiple projects.</p>
<p>My present goal is to get <code>lake</code> to be non-opinionated about whether import namespaces are used as in lean 3 / mathlib or the current lean 4 / leanpkg design, so that we can defer the decision to a style guide and CS / Math communities can make independent choices about what works best.</p>



<a name="254647827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254647827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254647827">(Sep 24 2021 at 04:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254646779">said</a>:</p>
<blockquote>
<p>I would say that technical obstacles to sharing namespaces between packages could be a significant obstacle to this (speaking to the mathematics applications).</p>
</blockquote>
<p>What I think is important to note here is that this is considered REALLY, REALLY bad practice in the CS community. Thus, this is anathema to any CS-facing tools. While I do understand that mathematicians want this, and Lean 4 wishes to cater to them as well as can be, and as such wish to do design Lake to be flexible enough to support this, it should not be the default approach (though it should be  relatively easy to change this). </p>
<p>This should also be a minimal problem for mathematics, as  such packages are likely to be few in number, but monolithic, so  a little setup cost for package configuration is reasonable. CS packages, on the hand, are likely to be large in number and only rarely monolithic. Thus, having the defaults geared towards said application makes it so there is not tons of boiler-plate customization across  the vast majority packages.</p>



<a name="254648037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648037">(Sep 24 2021 at 04:14)</a>:</h4>
<p>I was conflating "import namespaces" and "declaration namespaces". If they are completely separate, what possible significance do "import" namespaces have? Isn't it effectively just a filename?</p>



<a name="254648073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648073">(Sep 24 2021 at 04:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254647705">said</a>:</p>
<blockquote>
<p>We did talk about doing strict package based declaration namespacing early on, but I think that the design of dot-notation resolution makes this a non-starter.</p>
</blockquote>
<p>I know I must sound like a broken record by now, but I still think that copying Ruby's refinements would be great way to be able to please both crowds when it comes to declaration namespacing.</p>



<a name="254648109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648109">(Sep 24 2021 at 04:15)</a>:</h4>
<p>I have been ignoring this comment because I don't know what Ruby refinements are. Could you elaborate?</p>



<a name="254648357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648357">(Sep 24 2021 at 04:18)</a>:</h4>
<p>In Ruby, you can define scoped 'refinements` to add fields to namespace (called modules there), classes, etc. that are only enable when the scope in question is opened. For Lean and mathlib this would something like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">Mathlib</span>
<span class="n">refine</span> <span class="kn">namespace</span> <span class="n">List</span>
<span class="c1">-- declarations to be added to the global `List` namespace</span>
<span class="kd">def</span> <span class="n">List.subset</span> <span class="o">:=</span> <span class="bp">...</span>
<span class="kd">end</span> <span class="n">List</span>
<span class="kd">end</span> <span class="n">Mathlib</span>
<span class="c1">-- `List.subset` does not exist</span>
<span class="k">#check</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">]</span><span class="bp">.</span><span class="n">subset</span> <span class="c1">--- error</span>
<span class="kn">open</span> <span class="n">Mathlib</span>
<span class="c1">-- subset is now part of the root `List` namespace</span>
<span class="k">#check</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">]</span><span class="bp">.</span><span class="n">subset</span>  <span class="bp">...</span> <span class="c1">--  dot notation works</span>
</code></pre></div>



<a name="254648397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648397">(Sep 24 2021 at 04:19)</a>:</h4>
<p>In what sense are you still in the <code>Mathlib</code> namespace after the <code>refine</code> command?</p>



<a name="254648411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648411">(Sep 24 2021 at 04:19)</a>:</h4>
<p>What is the "true name" of <code>List.subset</code> in this example? Is it <code>Mathlib.List.subset</code>?</p>



<a name="254648421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648421">(Sep 24 2021 at 04:19)</a>:</h4>
<p>What does that gain you over just not having <code>namespace Mathlib</code> there at all?</p>



<a name="254648493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648493">(Sep 24 2021 at 04:20)</a>:</h4>
<p>oh -- I see, the <code>open Mathlib</code> is required for the final #check to work.</p>



<a name="254648497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648497">(Sep 24 2021 at 04:20)</a>:</h4>
<p>or is this like a macro that adds a bunch of definitions later</p>



<a name="254648588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648588">(Sep 24 2021 at 04:21)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> <br>
<span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254648411">said</a>:</p>
<blockquote>
<p>What is the "true name" of <code>List.subset</code> in this example? Is it <code>Mathlib.List.subset</code>?</p>
</blockquote>
<p>Implementation-wise, it would probably be something like <code>Mathlib._refine.List.subset</code> (i.e., some name magic like private and macro scopes).</p>



<a name="254648665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648665">(Sep 24 2021 at 04:22)</a>:</h4>
<p>Just to make sure I am on the right page regarding "import" namespaces, is the question about whether <code>import A.B.C</code> should mean:</p>
<ol>
<li>please look in package <code>A</code> for a file <code>B/C.lean</code> or</li>
<li>please look in all dependent packages for a file <code>A/B/C.lean</code> (possibly giving a helpful error message if there is more than one)</li>
</ol>



<a name="254648674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648674">(Sep 24 2021 at 04:22)</a>:</h4>
<p>yes, that's right</p>



<a name="254648701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648701">(Sep 24 2021 at 04:23)</a>:</h4>
<p>Lean's "raw" behavior is (2), but the build tool has the power to make it essentially do (1)</p>



<a name="254648779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648779">(Sep 24 2021 at 04:24)</a>:</h4>
<p>In lean 3 / mathlib we use (2) without restraint, and Sebastian and Mac think that's a bad idea</p>



<a name="254648784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648784">(Sep 24 2021 at 04:24)</a>:</h4>
<p>I see. There's <span aria-label="bike" class="emoji emoji-1f6b2" role="img" title="bike">:bike:</span>, but no emoji for "shed"... :-(</p>



<a name="254648853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648853">(Sep 24 2021 at 04:25)</a>:</h4>
<p>If that's the only distinction I don't think "mathematicans" will care either way.</p>



<a name="254648953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254648953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254648953">(Sep 24 2021 at 04:26)</a>:</h4>
<p>To the extent that it only affects what you write after <code>import</code>, I don't really care that much, but I do think that we should be able to control the directory structure</p>



<a name="254649018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649018">(Sep 24 2021 at 04:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254648701">said</a>:</p>
<blockquote>
<p>Lean's "raw" behavior is (2), but the build tool has the power to make it essentially do (1)</p>
</blockquote>
<p>Lean's raw behavior is neither? It demands that the source already be in a compiled <code>.olean</code> file in <code>LEAN_PATH</code> called <code>A/B/C.olean</code>.</p>



<a name="254649030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649030">(Sep 24 2021 at 04:28)</a>:</h4>
<p>Also, since you can't rename modules after the fact (unlike rust), you can sometimes end up with implementation details leaking through the package structure</p>



<a name="254649086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649086">(Sep 24 2021 at 04:28)</a>:</h4>
<blockquote>
<p>we should be able to control the directory structure</p>
</blockquote>
<p>You mean inside a git repository called <code>MyPackage</code>, whether the <code>.lean</code> files must live in a <code>MyPackage</code> subdirectory or can flexibly be in <code>src</code> or <code>MyPackage</code> or ...?</p>



<a name="254649127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649127">(Sep 24 2021 at 04:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254649018">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/254648701">said</a>:</p>
<blockquote>
<p>Lean's "raw" behavior is (2), but the build tool has the power to make it essentially do (1)</p>
</blockquote>
<p>Lean's raw behavior is neither? It demands that the source already be in a compiled <code>.olean</code> file in <code>LEAN_PATH</code> called <code>A/B/C.olean</code>.</p>
</blockquote>
<p>Replace "all dependent packages" with "everything in the <code>LEAN_PATH</code>" in Scott's description and that's literally what lean does</p>



<a name="254649159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649159">(Sep 24 2021 at 04:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> there is a significant distinction between <code>.olean</code> files and <code>.lean</code> files.</p>



<a name="254649163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649163">(Sep 24 2021 at 04:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> yes</p>



<a name="254649173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649173">(Sep 24 2021 at 04:29)</a>:</h4>
<p>I don't care where <code>olean</code> files go</p>



<a name="254649248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649248">(Sep 24 2021 at 04:30)</a>:</h4>
<p>They go in a central content-addressed cache that is automatically shared between all users of Lean, no? :-)</p>



<a name="254649336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649336">(Sep 24 2021 at 04:31)</a>:</h4>
<p>If reorganizing the olean files differently from the lean files to make things easy for the build tool helps, please go for it</p>



<a name="254649538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649538">(Sep 24 2021 at 04:34)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what exactly is it above and beyond what I just implemented that you want now?</p>



<a name="254649631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649631">(Sep 24 2021 at 04:35)</a>:</h4>
<p>I think what we have now is fine (although I suggested something about module roots in the Glob PR that would help with mathlib style import namespaces)</p>



<a name="254649702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649702">(Sep 24 2021 at 04:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> which I just noted (in said PR) is what is currently being done.</p>



<a name="254649726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649726">(Sep 24 2021 at 04:36)</a>:</h4>
<p>ah okay then</p>



<a name="254649777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649777">(Sep 24 2021 at 04:37)</a>:</h4>
<p>What would happen if a package claims <code>Glob.all</code> with the current implementation then?</p>



<a name="254649877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649877">(Sep 24 2021 at 04:38)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> the only somewhat relevant difference is that if you declare you own <code>Data</code> you will own all <code>Data.*</code> imports  (it won't smartly exclude those for the  Lean core or some other upstream package).</p>



<a name="254649915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649915">(Sep 24 2021 at 04:39)</a>:</h4>
<p>ah, and I guess the same for if you own <code>*</code>, you won't be able to <code>import Lean</code> or anything like that</p>



<a name="254649983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254649983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254649983">(Sep 24 2021 at 04:40)</a>:</h4>
<p>exactly</p>



<a name="254650158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254650158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254650158">(Sep 24 2021 at 04:43)</a>:</h4>
<p>Yeah I think we can work with this. I'm thinking that mathlib4 will be mostly in <code>Mathlib</code> namespace, but there might be some <code>more_std</code> style parts of the library (in mathlib or in a co-located dependency) which will carve out bits of <code>Lean</code> or <code>Std</code></p>



<a name="254650432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254650432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254650432">(Sep 24 2021 at 04:46)</a>:</h4>
<p>I could add a <code>libExcludeRoots</code> field to so that you could exclude certain modules/roots from your package (e.g., <code>Lean</code>), but I think in most cases that would be just as cumbersome as specifying the modules you are adding. That is, in the current approach, you would have to specify the modules/roots you added when injecting into a not (purely) local root. With exclusion, you would instead have to specify the ones you didn't . I suspect the later will usually be larger (or at the very least comparable in size).</p>



<a name="254650772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/254650772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#254650772">(Sep 24 2021 at 04:51)</a>:</h4>
<p>Yeah I agree. It's not an obvious win, so I would keep it as a potential improvement and investigate later if a compelling use case comes up</p>



<a name="255515656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255515656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255515656">(Sep 30 2021 at 04:26)</a>:</h4>
<blockquote>
<p>you can have a setting like the following in your .vscode/settings.json<br>
[vscode configuration manually setting the LEAN_PATH environment variable]</p>
</blockquote>
<p>I would like to strongly urge you to avoid this style of configuration.  Project configuration should not be stored in vscode settings; this excludes other editors (emacs, neovim, ...), and other tools like continuous integration.  Setting environment variables manually (before starting the editor) is not a particularly user-friendly option either.</p>
<p>Let me suggest some integration requirements that I would expect as an editor dev / user.  It should be possible to:</p>
<ol>
<li>Figure out the project root without calling lake or lean or elan.  This is important to start LSP servers in the right directory, configure various editor's "project search" modes, and lean version detection.  Lake is already doing great here: you just look for the closest <code>lakefile.lean</code> file and that's the root.</li>
<li>Start an LSP server for a project root in a uniform way.  Right now this is <code>lean --server</code>.  (We could change this to <code>lake server</code> if a lakefile is detected, but all else equal I'd rather stick with <code>lean --server</code> to avoid two separate legacy/lake code paths.)  Either way, the important part is: this needs to be uniform and not require any project-specific configuration.  We want people to open projects and have them <em>work out of the box</em>.</li>
<li>Figure out the source directories containing the project and its dependencies.  In Lean 3 this was easy with <code>lean -p</code>.  In Lean 4 with leanpkg this is more complicated and slow with <code>leanpkg print-paths</code>.  This is important to implement "full-text search in project sources" in editors.</li>
<li>Run lean on a file manually, with the correct dependencies and plugins set.  This worked great in Lean 3, but is not available in Lean 4 / leanpkg.</li>
<li>Do of all this in the <code>lean4/src</code> and <code>lean4/tests</code> directories as well.</li>
</ol>
<p>In other words, dependency paths, plugins, etc. should be managed by a single authority (= lake).  Then other tools can just call lake and figure out the project settings.</p>



<a name="255515931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255515931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255515931">(Sep 30 2021 at 04:31)</a>:</h4>
<p>(Also please make all of these available in a machine-readable format (= json).  Some tools just print some markdown and you have to play "does the regex cover all corner cases".  I'm looking at you, elan...)</p>



<a name="255515946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255515946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255515946">(Sep 30 2021 at 04:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> yes, this is the goal -- that was merely a stop gap measure for the time being</p>



<a name="255516087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516087">(Sep 30 2021 at 04:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255515656">said</a>:</p>
<blockquote>
<ol start="2">
<li>Start an LSP server for a project root in a uniform way.  Right now this is <code>lean --server</code>.  (We could change this to <code>lake server</code> if a lakefile is detected, but all else equal I'd rather stick with <code>lean --server</code> to avoid two separate legacy/lake code paths.)  Either way, the important part is: this needs to be uniform and not require any project-specific configuration.  We want people to open projects and have them <em>work out of the box</em>.</li>
</ol>
</blockquote>
<p>I do intend to have a <code>lake server</code> (it is actually in my TODO  next list already). The reason is that lake file configurations may wish to specify additional options to pass to the server (that may even need building -- e.g., plugins), thus it makes sense for lake to simplify that with a <code>lake server</code> in the root directory.</p>



<a name="255516261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516261">(Sep 30 2021 at 04:36)</a>:</h4>
<p>I think, to satisfy Gabriel's list of requirements, if <code>lake server</code> exists it also has to handle the case where the project is set up with a <code>leanpkg.toml</code> or any other "approved" setup (including whatever the lean 4 source directory does)</p>



<a name="255516265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516265">(Sep 30 2021 at 04:36)</a>:</h4>
<p>Also, for all intents in purposes, all Lean projects need some kind of Lean configuration file in order for interactivity to work (and <code>lake</code> is meant to be that new standard), so the VSCode extension can probably just replace <code>lean --server</code> with <code>lake server</code> (after maybe a short interim period of legacy support).</p>



<a name="255516425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516425">(Sep 30 2021 at 04:38)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> you make a good point about the Lean source directory. <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> do you know whether the Lean server is doing some special magic with <code>--print-paths</code> to make the Lean source directory work despite lacking a <code>leanpkg.toml</code>?</p>



<a name="255516430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516430">(Sep 30 2021 at 04:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255516261">said</a>:</p>
<blockquote>
<p>I think, to satisfy Gabriel's list of requirements, if <code>lake server</code> exists it also has to handle the case where the project is set up with a <code>leanpkg.toml</code></p>
</blockquote>
<p>Yes, but I think it would be kind of okay to have a "flag day" where <code>leanpkg.toml</code> support is removed at the same time that <code>lake</code> support is made mandatory.  Either way there is going to be a bit of migration nightmare.</p>
<blockquote>
<p>or any other "approved" setup (including whatever the lean 4 source directory does)</p>
</blockquote>
<p>This is a really important point, I'll add it to the list.</p>



<a name="255516463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516463">(Sep 30 2021 at 04:39)</a>:</h4>
<p>Indeed, one way to remove <code>leanpkg.toml</code> support is to make it not "approved" anymore. That's an acceptable solution to me</p>



<a name="255516588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516588">(Sep 30 2021 at 04:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255516430">said</a>:</p>
<blockquote>
<p>Either way there is going to be a bit of migration nightmare.</p>
</blockquote>
<p>I mean Lean itself has major breaking changes quite often, so I hope there is not to many people who are expecting to be able to update their Lean toolchain without doing any migration work.</p>



<a name="255516641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516641">(Sep 30 2021 at 04:42)</a>:</h4>
<p>Maybe it is possible to get the lean 4 source directory to contain a <code>lakefile.lean</code> that contains some special "I am core" flag?</p>



<a name="255516646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516646">(Sep 30 2021 at 04:42)</a>:</h4>
<p>It's a migration nightmare for the <em>editor developers</em>.  Editors need to support old Lean versions for the forseeable future.</p>



<a name="255516704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516704">(Sep 30 2021 at 04:43)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> that confuses me a bit. Why do future versions of the Lean 4 VSCode extension need to support old pre-release Lean nightlies?</p>



<a name="255516768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516768">(Sep 30 2021 at 04:44)</a>:</h4>
<p>Because old versions of mathlib require old nightlies.  And people need to open old versions of mathlib (or other projects) to port them to new Lean versions.</p>



<a name="255516779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516779">(Sep 30 2021 at 04:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255516641">said</a>:</p>
<blockquote>
<p>Maybe it is possible to get the lean 4 source directory to contain a <code>lakefile.lean</code> that contains some special "I am core" flag?</p>
</blockquote>
<p>The simplest solution is to just to default <code>lake server</code> to <code>lean --server</code> if the is no package configuration.</p>



<a name="255516782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516782">(Sep 30 2021 at 04:44)</a>:</h4>
<p>(Or just for historical curiosity.)</p>



<a name="255516796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516796">(Sep 30 2021 at 04:44)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> That doesn't solve the "find the root" problem though</p>



<a name="255516965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255516965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255516965">(Sep 30 2021 at 04:47)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> I think it's okay to have breaking changes here, although it will certainly be painful. There aren't that many lean 4 projects out there yet, and the new system will hopefully be somewhat backward compatible, although you might need to add a dummy lakefile</p>



<a name="255517045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517045">(Sep 30 2021 at 04:48)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> if someone is running a much older Lean, can't they just use an older version of the extension?</p>



<a name="255517056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517056">(Sep 30 2021 at 04:48)</a>:</h4>
<p>What I would <em>really</em> like is some way to be backward compatible <em>with lean 3</em>, so that the editor can reliably turn on the right extension</p>



<a name="255517063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517063">(Sep 30 2021 at 04:48)</a>:</h4>
<p>It's really not okay, at least for a short while some projects will be pre-lake and some post-lake.  And I want to open both of them.  Without changing editors, downgrading extensions, etc.</p>



<a name="255517130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517130">(Sep 30 2021 at 04:49)</a>:</h4>
<blockquote>
<p>some way to be backward compatible with lean 3,</p>
</blockquote>
<p>It doesn't need to be compatible, the detection code just has to support both.  (E.g. if leanpkg.toml is there look at the version field, if lakefile.lean is there then it's Lean 4.)</p>



<a name="255517135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517135">(Sep 30 2021 at 04:49)</a>:</h4>
<p>I'm still using "workspace enable" for the lean 4 extension, because it still manages to screw things up and I don't blame it at all since there is no external indication of whether the code is lean 3 or lean 4</p>



<a name="255517152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517152">(Sep 30 2021 at 04:49)</a>:</h4>
<p>While I must say I respect your commitment to backwards computability <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> , I feel that you may be fighting a losing battle with the speed of changes in Lean.</p>



<a name="255517223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517223">(Sep 30 2021 at 04:50)</a>:</h4>
<p>I think it is possible to be backward compatible in the short term (for pre-lake and post-lake)</p>



<a name="255517244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517244">(Sep 30 2021 at 04:50)</a>:</h4>
<p>I agree there, I meant on a more general note.</p>



<a name="255517275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517275">(Sep 30 2021 at 04:51)</a>:</h4>
<p>and I think that extends to lean 3 / lean 4, although I fail to understand why lean 4 <code>leanpkg.toml</code>s don't say anything about the lean version</p>



<a name="255517288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517288">(Sep 30 2021 at 04:51)</a>:</h4>
<p>But they do?</p>



<a name="255517326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517326">(Sep 30 2021 at 04:52)</a>:</h4>
<p>This did enlighten me on what the <code>old</code> folder in the <code>vscode4-lean</code> folder is for now, though.</p>



<a name="255517342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517342">(Sep 30 2021 at 04:52)</a>:</h4>
<p>The <code>old</code> folder is a red herring.  We should probably remove it.  It's not used.</p>



<a name="255517353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517353">(Sep 30 2021 at 04:52)</a>:</h4>
<p>last I checked the default leanpkg.toml looked like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">package</span><span class="o">]</span>
<span class="n">name</span> <span class="bp">=</span> <span class="s2">"test"</span>
<span class="n">version</span> <span class="bp">=</span> <span class="s2">"0.1"</span>
</code></pre></div>



<a name="255517383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517383">(Sep 30 2021 at 04:53)</a>:</h4>
<p>Ah, then I am simply impressed on how you managed to integrate the RPC changes without breaking backwards compatibility.</p>



<a name="255517400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517400">(Sep 30 2021 at 04:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  you can add a <code>lean_version</code> field to that.</p>



<a name="255517419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517419">(Sep 30 2021 at 04:53)</a>:</h4>
<p>And I think the newer <code>leanpkg</code> (i.e., from the last couple of months) does that by default.</p>



<a name="255517487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517487">(Sep 30 2021 at 04:54)</a>:</h4>
<blockquote>
<p>how you managed to integrate the RPC changes without breaking backwards compatibility.</p>
</blockquote>
<p>This is pretty easy, you just fall back to the old protocol if the new one fails. :-)  I believe the Lean 3 extension now has backwards compatibility reaching a few years back.</p>



<a name="255517621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517621">(Sep 30 2021 at 04:56)</a>:</h4>
<p>I think <code>lake</code> will have to maintain backward compatibility with lean 3 <code>leanpkg.toml</code> files for a very long time (in the sense that it should at least be able to find the root and determine that it's not a lean 4 project)</p>



<a name="255517686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517686">(Sep 30 2021 at 04:57)</a>:</h4>
<p><code>elan</code> will also have to maintain this kind of backward compatibility.</p>



<a name="255517762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517762">(Sep 30 2021 at 04:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what do you mean by that? In what scenario would <code>lake</code> care?</p>



<a name="255517786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517786">(Sep 30 2021 at 04:59)</a>:</h4>
<p>it would be nice if it called <code>leanpkg</code> or <code>leanproject</code> in those cases</p>



<a name="255517874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255517874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255517874">(Sep 30 2021 at 05:00)</a>:</h4>
<p>If the editor is set up to just always call <code>lake server</code> then <code>lake</code> has to handle deferring to lean 3 tools</p>



<a name="255518019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518019">(Sep 30 2021 at 05:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255515656">said</a>:</p>
<blockquote>
<ol start="3">
<li>Figure out the source directories containing the project and its dependencies.  In Lean 3 this was easy with <code>lean -p</code>.  In Lean 4 with leanpkg this is more complicated and slow with <code>leanpkg print-paths</code>.  This is important to implement "full-text search in project sources" in editors.</li>
</ol>
</blockquote>
<p>Also, what do you mean by this? What would you like <code>lake</code> to do? I might be a good for us to have a heart-to-heart some time so that you can share what you want from lake and vice versa.</p>



<a name="255518098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518098">(Sep 30 2021 at 05:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> as far as I am aware the <code>lean4</code> extension is not compatible with Lean 3, is it?</p>



<a name="255518133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518133">(Sep 30 2021 at 05:02)</a>:</h4>
<p>If it is, I imagine it is doing some magic to figure that out, in which case I think it should case on which version it is using.</p>



<a name="255518139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518139">(Sep 30 2021 at 05:02)</a>:</h4>
<p>The scenario here is that a user opens a random lean file when both extensions are installed</p>



<a name="255518163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518163">(Sep 30 2021 at 05:03)</a>:</h4>
<p>I do not intend to make Lake backwards compatible with Lean 3 (as Lean 4 is not either).</p>



<a name="255518169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518169">(Sep 30 2021 at 05:03)</a>:</h4>
<p>someone has to figure out who is supposed to run the show</p>



<a name="255518241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518241">(Sep 30 2021 at 05:04)</a>:</h4>
<p>It's not literally about backwards compatibility in that sense, it's more like figuring out that it is lean 3 and backing off in a way that doesn't interfere with the lean 3 extension</p>



<a name="255518367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518367">(Sep 30 2021 at 05:06)</a>:</h4>
<p>For <code>lake server</code> I see two options: (1) have <code>lake</code> bail if it can't find a <code>lakefile.lean</code> (and the project is not Lean 4 compatible) or  (2) have it run <code>lean --server</code> (which may be compatible with both?).</p>



<a name="255518413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518413">(Sep 30 2021 at 05:06)</a>:</h4>
<blockquote>
<p>[3. figure out directories] What would you like lake to do?</p>
</blockquote>
<p>I want a <code>lake path</code> command that prints something like this:</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span> <span class="nt">"dependencies"</span><span class="p">:</span> <span class="p">[</span>
 <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Init"</span><span class="p">,</span> <span class="nt">"core"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"..."</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"..."</span> <span class="p">},</span>
 <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Std"</span><span class="p">,</span> <span class="nt">"core"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"..."</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"..."</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"A"</span><span class="p">,</span> <span class="nt">"dependency"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"some/path"</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"build/..."</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"B"</span><span class="p">,</span> <span class="nt">"dependency"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"some/path"</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"build/..."</span> <span class="p">},</span>
 <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"MyProject"</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"./MyProject"</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"./build"</span> <span class="p">}</span>
<span class="p">]</span> <span class="p">}</span>
</code></pre></div>



<a name="255518469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518469">(Sep 30 2021 at 05:07)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span>  currently <code>print-paths</code> also builds dependencies and modules (as <code>leanpkg print-paths</code> does), do you still want this new command to do that?</p>



<a name="255518486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518486">(Sep 30 2021 at 05:07)</a>:</h4>
<p>Note that I'm speaking from a user perspective; I'm not sure exactly what IO behavior <code>lake server</code> needs to have such that the lean 4 and lean 3 extensions can work out their differences</p>



<a name="255518494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518494">(Sep 30 2021 at 05:07)</a>:</h4>
<blockquote>
<p>If the editor is set up to just always call lake server then lake has to handle deferring to lean 3 tools</p>
</blockquote>
<p>Since lake will obviously be distributed together with lean (right?), this wont be possible.  Not for Lean 3, and not for old Lean 4 versions either.  (Since we can't retroactively add lake to those releases.)</p>



<a name="255518541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518541">(Sep 30 2021 at 05:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Unfortunately, neither do I. <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="255518542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518542">(Sep 30 2021 at 05:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255518469">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span>  currently <code>print-paths</code> also builds dependencies and modules (as <code>leanpkg print-paths</code> does), do you still want this new command to do that?</p>
</blockquote>
<p>Decidedly <em>not</em>.</p>



<a name="255518567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518567">(Sep 30 2021 at 05:08)</a>:</h4>
<p>There will obviously be a <code>lake build</code> command that does this.</p>



<a name="255518600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518600">(Sep 30 2021 at 05:09)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> The reason this was done this is that the the Lean server currently uses <code>leanpkg print-paths</code> to build oleans for imports.</p>



<a name="255518619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518619">(Sep 30 2021 at 05:09)</a>:</h4>
<p>Yes, I'm well aware of that (and why I said it's a <em>slow</em> replacement for <code>lean -p</code>).</p>



<a name="255518627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518627">(Sep 30 2021 at 05:09)</a>:</h4>
<p><code>print-paths</code> is a weird name for "build dependencies"</p>



<a name="255518643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518643">(Sep 30 2021 at 05:10)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  it <em>also</em> prints paths.</p>



<a name="255518710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518710">(Sep 30 2021 at 05:10)</a>:</h4>
<p>It prints <em>some</em> paths.  For example it doesn't print the paths to the core library.</p>



<a name="255518728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518728">(Sep 30 2021 at 05:11)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> is <code>print-paths</code> just a hodge podge of stuff the editor needed and stuff the server needed? Like should <code>print-paths</code> and <code>build-imports</code> parts be split up?</p>



<a name="255518768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518768">(Sep 30 2021 at 05:11)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> Unforunately, <code>lake</code> has no way of knowing which libraries are "core" libaries (at least no more so than the editor does).</p>



<a name="255518770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518770">(Sep 30 2021 at 05:11)</a>:</h4>
<p>Yes, I believe it's just the interface between server and leanpkg and not really intended for outside use.</p>



<a name="255518831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518831">(Sep 30 2021 at 05:12)</a>:</h4>
<p>(deleted)</p>



<a name="255518890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518890">(Sep 30 2021 at 05:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255518768">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> Unforunately, <code>lake</code> has no way of knowing which libraries are "core" libaries (at least no more so than the editor does).</p>
</blockquote>
<p>It's not so important to know whether a dependency is a core library or not (but you can guess pretty easily: Init, Std, Lean -&gt; core, others -&gt; not).  The important part is that it is listed, and that you get the source directory.</p>



<a name="255518960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518960">(Sep 30 2021 at 05:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255518413">said</a>:</p>
<blockquote>
<blockquote>
<p>[3. figure out directories] What would you like lake to do?</p>
</blockquote>
<p>I want a <code>lake path</code> command that prints something like this:</p>
<p><div class="codehilite" data-code-language="JSON"><pre><span></span><code><span class="p">{</span> <span class="nt">"dependencies"</span><span class="p">:</span> <span class="p">[</span>
 <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Init"</span><span class="p">,</span> <span class="nt">"core"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"..."</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"..."</span> <span class="p">},</span>
  <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"A"</span><span class="p">,</span> <span class="nt">"dependency"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"some/path"</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"build/..."</span> <span class="p">},</span>
 <span class="p">{</span> <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"MyProject"</span><span class="p">,</span> <span class="nt">"src"</span><span class="p">:</span> <span class="s2">"./MyProject"</span><span class="p">,</span> <span class="nt">"binary"</span><span class="p">:</span> <span class="s2">"./build"</span> <span class="p">}</span>
<span class="p">]</span> <span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>
<p>I assume by <code>binary</code> you mean the path to the oleans (not the binary executable or static library). Also what is <code>name</code> in this example? The root module name, the name of the package, the name of the folder, something else?</p>



<a name="255518980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518980">(Sep 30 2021 at 05:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255518486">said</a>:</p>
<blockquote>
<p>Note that I'm speaking from a user perspective; I'm not sure exactly what IO behavior <code>lake server</code> needs to have such that the lean 4 and lean 3 extensions can work out their differences</p>
</blockquote>
<p>How plausible is it to just have one extension which encompasses both lean 3 and lean 4? Has this been discussed / considered? I realize it's basically two extensions folded in one, but I would like the switching logic at least to have somewhere to live</p>



<a name="255518985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255518985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255518985">(Sep 30 2021 at 05:15)</a>:</h4>
<p>The package name (which should be identical to the module name).  If they're not identical -&gt; two fields.</p>



<a name="255519023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519023">(Sep 30 2021 at 05:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> , <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> already demanded (and his demand was met) that they not be.</p>



<a name="255519088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519088">(Sep 30 2021 at 05:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255518980">said</a>:</p>
<blockquote>
<p>How plausible is it to just have one extension which encompasses both lean 3 and lean 4? Has this been discussed / considered? I realize it's basically two extensions folded in one, but I would like the switching logic at least to have somewhere to live</p>
</blockquote>
<p>The neovim extension is structured in this way, but it uses the <code>lean-language-server</code> project to wrap Lean 3 in a LSP server so that it looks more like Lean 4.</p>



<a name="255519094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519094">(Sep 30 2021 at 05:16)</a>:</h4>
<p>In fact, due to <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>'s demand, there is not necessarily any such thing as the root module of a package anymore.</p>



<a name="255519116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519116">(Sep 30 2021 at 05:16)</a>:</h4>
<p>Oh great, didn't read through everything!</p>



<a name="255519198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519198">(Sep 30 2021 at 05:18)</a>:</h4>
<p>The important part is that there is a list of dependent packages, together with their source location and whatever names we know.</p>



<a name="255519247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519247">(Sep 30 2021 at 05:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> I'm curious, what is this used for?</p>



<a name="255519267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519267">(Sep 30 2021 at 05:19)</a>:</h4>
<p>That sounds like the information a third party would need to resolve <code>import Foo.Bar</code></p>



<a name="255519280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519280">(Sep 30 2021 at 05:19)</a>:</h4>
<p>For one, knowing that might better help me know what information to offer.</p>



<a name="255519327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519327">(Sep 30 2021 at 05:19)</a>:</h4>
<p>The name is not particularly important to me.  It just seemed obvious to include.  (For example you can tell the core modules by their name.)</p>



<a name="255519328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519328">(Sep 30 2021 at 05:19)</a>:</h4>
<p>It also allows the editor to know what constitutes the "source directorie(s)"</p>



<a name="255519407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519407">(Sep 30 2021 at 05:20)</a>:</h4>
<p>If <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> guess is right, would a <code>lake where &lt;module(s)&gt;</code> be more useful instead?</p>



<a name="255519408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519408">(Sep 30 2021 at 05:20)</a>:</h4>
<p>Right.  In neovim we have a command to search in all source directories.  This requires a list of source directories.</p>



<a name="255519437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519437">(Sep 30 2021 at 05:21)</a>:</h4>
<p>It's also useful for debugging purposes (this is what lean thinks your project structure is like).</p>



<a name="255519543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519543">(Sep 30 2021 at 05:22)</a>:</h4>
<p><span class="user-mention" data-user-id="315577">@Mac</span> Rather than <code>lake where</code> (which might also be useful for some things), I think you want some finite amount of data that uniquely determines the result of <code>lake where M</code> for all <code>M</code></p>



<a name="255519659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519659">(Sep 30 2021 at 05:24)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> see <em>this</em> is why you don't want to specify arbitrary source files for modules. <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="255519728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519728">(Sep 30 2021 at 05:25)</a>:</h4>
<p>admittedly, this was not really a case I had thought of either.</p>



<a name="255519733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519733">(Sep 30 2021 at 05:25)</a>:</h4>
<p>IIUC, the finite data I refer to is exactly the <code>LEAN_PATH</code></p>



<a name="255519790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519790">(Sep 30 2021 at 05:26)</a>:</h4>
<p>Well no, because you also need the locations of the source files (<code>LEAN_PATH</code> is just oleans).</p>



<a name="255519796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519796">(Sep 30 2021 at 05:26)</a>:</h4>
<p>A complication is that in Lean 4, LEAN_PATH contains the binary files, while I also want the source files.</p>



<a name="255519839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519839">(Sep 30 2021 at 05:27)</a>:</h4>
<p>how does go-to-definition handle this today? Do the oleans reference the lean file locations?</p>



<a name="255519905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255519905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255519905">(Sep 30 2021 at 05:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> <code>leanpkg print-paths</code> also prints source directories.</p>



<a name="255520415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520415">(Sep 30 2021 at 05:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> so the basic idea is to print source and olean directories for the package and its dependencies, source and olean directors for lean (and lake), and then whatever other extra olean directories exists (e.g., those in <code>LEAN_PATH</code>)?</p>



<a name="255520520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520520">(Sep 30 2021 at 05:38)</a>:</h4>
<p>Is <code>lake</code> influenced by the <code>LEAN_PATH</code> environment variable passed to it?</p>



<a name="255520537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520537">(Sep 30 2021 at 05:38)</a>:</h4>
<p>I'd really rather that env var get killed with fire</p>



<a name="255520601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520601">(Sep 30 2021 at 05:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> most certainly that's how <code>lake</code> itself knows where to look for imports used in the <code>lakefile.lean</code>  (though it currently isn't used in building)</p>



<a name="255520720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520720">(Sep 30 2021 at 05:41)</a>:</h4>
<p>I would hope that the only imports available in <code>lakefile.lean</code> are lean and lake (and maybe the current directory? That seems shaky)</p>



<a name="255520748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520748">(Sep 30 2021 at 05:41)</a>:</h4>
<p>if you need more than that you will need a lakefile for your lakefile</p>



<a name="255520814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520814">(Sep 30 2021 at 05:42)</a>:</h4>
<p>The idea that Sebastian and I where floating is that there would also be globally installed packages that could be used .</p>



<a name="255520832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520832">(Sep 30 2021 at 05:42)</a>:</h4>
<p>That sounds bad for reproducibility</p>



<a name="255520849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520849">(Sep 30 2021 at 05:42)</a>:</h4>
<p>And, if we want to support test libraries or custom build target libraries, something of the sort will need to exist.</p>



<a name="255520965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255520965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255520965">(Sep 30 2021 at 05:44)</a>:</h4>
<p>Such packages will hopefully be specified in the eventual lake lockfile, so it shouldn't break reporducibility.</p>



<a name="255521037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521037">(Sep 30 2021 at 05:45)</a>:</h4>
<p>I think "lakefile for your lakefile" should actually be considered. Perhaps the outer lakefile needs only core imports, but there is a section of the file (using a macro to make effectively a nice looking multiline string) that contains the real lakefile, and the outer lakefile tells you how to acquire the dependencies for the inner lakefile</p>



<a name="255521054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521054">(Sep 30 2021 at 05:45)</a>:</h4>
<p>but I hope that this is some ways off</p>



<a name="255521143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521143">(Sep 30 2021 at 05:46)</a>:</h4>
<p>It does mean that lake will have to ship with a kind of "standard build library" for common features that shouldn't need the complexity</p>



<a name="255521165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521165">(Sep 30 2021 at 05:47)</a>:</h4>
<p>or maybe that's a separate package that nevertheless ships with lean + lake</p>



<a name="255521182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521182">(Sep 30 2021 at 05:47)</a>:</h4>
<p>Now that, I think is  too complexity. I am pretty confident the lockfile approach (i.e., <code>watershed.json</code>) will be sufficient</p>



<a name="255521243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521243">(Sep 30 2021 at 05:48)</a>:</h4>
<p>I don't understand how the lockfile helps. You should always be able to get a build working if someone deletes the lockfile</p>



<a name="255521258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521258">(Sep 30 2021 at 05:48)</a>:</h4>
<p>(modulo upgrade bugs)</p>



<a name="255521294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521294">(Sep 30 2021 at 05:49)</a>:</h4>
<p>The lockfile I'm describing would be more of a used packages manifest.</p>



<a name="255521317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521317">(Sep 30 2021 at 05:49)</a>:</h4>
<p>I thought <code>lakefile.lean</code> <em>was</em> the package manifest</p>



<a name="255521383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521383">(Sep 30 2021 at 05:50)</a>:</h4>
<p>no, <code>lakefile.lean</code> is the package/workspace configuration / configurer (i.e., akin to an old <code>configure</code> script or a cmake lists)</p>



<a name="255521435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521435">(Sep 30 2021 at 05:51)</a>:</h4>
<p>The manifest would be a partial by-product of the configuration (for some of its packages)</p>



<a name="255521442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521442">(Sep 30 2021 at 05:51)</a>:</h4>
<p>why are those separate concepts?</p>



<a name="255521517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521517">(Sep 30 2021 at 05:52)</a>:</h4>
<p>I'm hoping we can have just one file that solves all our lean packaging needs</p>



<a name="255521565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521565">(Sep 30 2021 at 05:53)</a>:</h4>
<p>back in the day, this was a plain toml file. Now it's a lean file for added flexibility, but it should still be a particularly simple kind of lean code, and I see no reasons why most users should need imports besides <code>Lake</code></p>



<a name="255521661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521661">(Sep 30 2021 at 05:55)</a>:</h4>
<p>For common build operations, they should just work with <code>import Lake</code> or perhaps <code>import Lake; import LakeTools</code></p>



<a name="255521675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521675">(Sep 30 2021 at 05:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> if your lake file is building multiple C packages (and or things from other languages) you will probably want to do more complex stuff. Also test drivers will likely be included in the <code>lakefule</code>.</p>



<a name="255521791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521791">(Sep 30 2021 at 05:56)</a>:</h4>
<p>Ideally, the <code>lakefile.lean</code> would be used for any and all CLI (and potentially, GUI) operations you wish to perform within a  Lean workspace.</p>



<a name="255521811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521811">(Sep 30 2021 at 05:57)</a>:</h4>
<p>Calling external commands is already covered by "lean + lake" though, so unless you are importing a package for simplifying C&lt;-&gt;lean integration you should be able to get by with the basics</p>



<a name="255521831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521831">(Sep 30 2021 at 05:57)</a>:</h4>
<p>and any such package would for me be a candidate for inclusion in <code>LakeTools</code></p>



<a name="255521894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521894">(Sep 30 2021 at 05:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> have you used NPM for complex web development?</p>



<a name="255521919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521919">(Sep 30 2021 at 05:59)</a>:</h4>
<p>I have...</p>



<a name="255521927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521927">(Sep 30 2021 at 05:59)</a>:</h4>
<p>There are a whole lot of additional tools and dependencies specified in a <code>package.json</code> that are  used just for administration.</p>



<a name="255521955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521955">(Sep 30 2021 at 05:59)</a>:</h4>
<p>this sounds a lot like the <code>build.rs</code> style though</p>



<a name="255521964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255521964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255521964">(Sep 30 2021 at 05:59)</a>:</h4>
<p>i.e. "lakefile in a lakefile"</p>



<a name="255522054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255522054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255522054">(Sep 30 2021 at 06:00)</a>:</h4>
<p>For example, features like those provided by <code>lerna</code>, <code>@vue/cli</code>, <code>mocha</code>, <code>webpack</code> would all be things what would hopefully be included in a <code>lakefile.lean</code>.</p>



<a name="255522278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255522278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255522278">(Sep 30 2021 at 06:03)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> yeah, this could all be "lakefile in a lakefile" stuff, but I would like to avoid that complexity if possible.</p>



<a name="255522470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255522470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255522470">(Sep 30 2021 at 06:05)</a>:</h4>
<p>I would like to avoid the complexity of having <code>lake build</code> not work when the only thing in the project is a <code>lakefile.lean</code> in the root</p>



<a name="255522539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255522539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255522539">(Sep 30 2021 at 06:06)</a>:</h4>
<p>I think that all that webpack mocha stuff is complexity that should be deferred</p>



<a name="255522624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255522624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255522624">(Sep 30 2021 at 06:07)</a>:</h4>
<p>For some projects, the needed build tools can be added to the core distribution. For some projects, the build tools are written inline in the <code>lakefile.lean</code>. I would like to defer the existence of a third category as long as possible</p>



<a name="255524423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255524423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255524423">(Sep 30 2021 at 06:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255522470">said</a>:</p>
<blockquote>
<p>I would like to avoid the complexity of having <code>lake build</code> not work when the only thing in the project is a <code>lakefile.lean</code> in the root</p>
</blockquote>
<p>Even in my scenario, It would only not work in cases where the lakefile needs more packages than just <code>Lake</code> and <code>Lean</code> (which would be just as true now).</p>



<a name="255530632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255530632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255530632">(Sep 30 2021 at 07:37)</a>:</h4>
<p>Fwiw, <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, the whole point of the lock file was so that you can use standard tools to read it.</p>
<p>A lean file is a bad thing to read by anything but lean. And even then it's problematic because it allows you to write more or less arbitrary code.</p>
<p>The machine readable manifest is generated off of it into json for compatibility.</p>
<p>The only real consideration, imo, is whether lake spits it out to stdout when passed a flag or whether it sits in a lock file on the file system</p>



<a name="255530839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255530839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255530839">(Sep 30 2021 at 07:39)</a>:</h4>
<p>I don't disagree with that, but it's orthogonal to my point. Users cannot be expected to maintain a lockfile, and it should always be possible to delete and regenerate it with the only loss of information being the exact versions of dependents as of the last run of the tool</p>



<a name="255530950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255530950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255530950">(Sep 30 2021 at 07:40)</a>:</h4>
<p>It's also orthogonal to my point.  Lockfiles can only contain system-independent information, but I want <code>lake path</code> to print system-specific information (such as the location of the core library).</p>



<a name="255531456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531456">(Sep 30 2021 at 07:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315577">Mac</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255524423">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255522470">said</a>:</p>
<blockquote>
<p>I would like to avoid the complexity of having <code>lake build</code> not work when the only thing in the project is a <code>lakefile.lean</code> in the root</p>
</blockquote>
<p>Even in my scenario, It would only not work in cases where the lakefile needs more packages than just <code>Lake</code> and <code>Lean</code> (which would be just as true now).</p>
</blockquote>
<p>Right. My hope is to make "needs more packages than just <code>Lake</code> and <code>Lean</code>" be a distant future, and when that distant future arrives I want a <code>build.rs</code> styled solution. Certainly none of the lean 4 projects I am aware of (including in particular mathlib4) require more than lean + lake at the build stage</p>



<a name="255531633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531633">(Sep 30 2021 at 07:48)</a>:</h4>
<p>fair points. And regarding lean + lake. That's kind of the idea of the modular design no? We can always add support for a bunch of helpers, like ftp, 7zip, gzip, etc.</p>



<a name="255531720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531720">(Sep 30 2021 at 07:50)</a>:</h4>
<p>Can we not ship those helpers with lean + lake, so that users don't need to deal with a multi-stage build?</p>



<a name="255531792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531792">(Sep 30 2021 at 07:50)</a>:</h4>
<p>what I meant: lake can ship with a large library of useful helpers that no one single lake script will need all of.</p>



<a name="255531831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531831">(Sep 30 2021 at 07:51)</a>:</h4>
<p>I do think that lean 4 can make describing a multi stage build relatively painless, but for most uses I think that a library of helpers will suffice</p>



<a name="255531859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255531859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255531859">(Sep 30 2021 at 07:51)</a>:</h4>
<p>basically what's project-specific should be so little, that there really shouldn't be a need for multi-stage builds</p>



<a name="255532050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255532050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255532050">(Sep 30 2021 at 07:53)</a>:</h4>
<p>one thing we probably would like to have though, is be able to depend on another lean file from within a lake file. Not sure, if that's possible today. But not supporting it =&gt; you create potentially unmaintainably large build files and supporting it =&gt; the need for a multi-stage build becomes even much less important.</p>



<a name="255532201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255532201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255532201">(Sep 30 2021 at 07:55)</a>:</h4>
<p>One way to accomplish that would be to use a fixed folder like <code>lakefile/</code> that gets added to the <code>LEAN_PATH</code> when reading <code>lakefile.lean</code></p>



<a name="255532248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255532248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255532248">(Sep 30 2021 at 07:55)</a>:</h4>
<p>(sorry, very laggy message sending), yes, something like that. In case normal <code>import</code> statements don't work.</p>



<a name="255534465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255534465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255534465">(Sep 30 2021 at 08:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255516646">said</a>:</p>
<blockquote>
<p>It's a migration nightmare for the <em>editor developers</em>.  Editors need to support old Lean versions for the forseeable future.</p>
</blockquote>
<p>If only we a tool that could specify &amp; set up exact, compatible versions of the compiler, editor, <em>and</em> editor extension <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> . But that tool would likely have to be so general that it would come with its own set of issues and likely not work across all interesting platforms...</p>



<a name="255536072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536072">(Sep 30 2021 at 08:29)</a>:</h4>
<p>Indeed it is hard to conceive that such a tool might struggle with old versions of editors. <a href="https://github.com/NixOS/nixpkgs/issues/97443">ehm</a> <a href="https://github.com/NixOS/nixpkgs/issues/95808">mmh</a></p>



<a name="255536131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536131">(Sep 30 2021 at 08:30)</a>:</h4>
<p>I hadn't realised until recently that nix has been around for a long time. I'd thought it was new and that windows and good macos support were plausible things to hope for. :-)</p>



<a name="255536183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536183">(Sep 30 2021 at 08:30)</a>:</h4>
<p>I believe we also had a bug where new gtk plugins made old applications crash, but I can't find it right now.</p>



<a name="255536300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536300">(Sep 30 2021 at 08:31)</a>:</h4>
<p>Ahaha. It may take a few more decades until we figure out reproducibility for GUIs.</p>



<a name="255536679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536679">(Sep 30 2021 at 08:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields/near/255536300">said</a>:</p>
<blockquote>
<p>Ahaha. It may take a few more decades until we figure out reproducibility for GUIs.</p>
</blockquote>
<p>maybe when AI is good enough to get a video stream of the your screen and also 100% trustworthy...</p>



<a name="255536975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255536975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255536975">(Sep 30 2021 at 08:38)</a>:</h4>
<p>This one was also fun: <a href="https://github.com/NixOS/nixpkgs/pull/132937">https://github.com/NixOS/nixpkgs/pull/132937</a>. It's almost like some upstreams <em>want</em> to break reproducibility.</p>



<a name="255537173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255537173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255537173">(Sep 30 2021 at 08:40)</a>:</h4>
<p>honestly, git submodules are the only realistic way of hoping for a sense of reproducibility :D</p>



<a name="255537198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255537198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255537198">(Sep 30 2021 at 08:40)</a>:</h4>
<p>and they are pain to work with.</p>



<a name="255537200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255537200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255537200">(Sep 30 2021 at 08:40)</a>:</h4>
<p>Reminds me of texlive a few years back: you can only download the release tarball today, hurry because tomorrow we'll push new versions and remove the old ones!  (I think there's an official mirror for the release tarballs now.)</p>



<a name="255537321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255537321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255537321">(Sep 30 2021 at 08:41)</a>:</h4>
<p>at least texlive is pretty good these days... When I started my math in the early 2000s or so, there was no texlive for windows afaik. So you were stuck with miktex that definitely worked for <em>some</em> packages. Oh joy...</p>



<a name="255537448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255537448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Fabian <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255537448">(Sep 30 2021 at 08:42)</a>:</h4>
<p>and a linux-y setup on windows was not for the faint of heart.</p>



<a name="255546570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255546570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255546570">(Sep 30 2021 at 09:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> as far as I am aware that is same thought process is still the default state of  affairs for MSYS2. Last I checked, it is incredibly difficult to install anything but the latest version of a package.</p>



<a name="255547093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547093">(Sep 30 2021 at 10:01)</a>:</h4>
<p>They have stable archive URLs you can install with <code>pacman -U</code> at least (<span class="user-mention" data-user-id="110994">@Joe Hendrix</span> taught me that). But just like with Arch Linux, anything but a full upgrade is probably unsupported.</p>



<a name="255547253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547253">(Sep 30 2021 at 10:03)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> but what happen when said package also depends on on older version of other packages <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="255547318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547318">(Sep 30 2021 at 10:03)</a>:</h4>
<p>Welcome to dependency hell</p>



<a name="255547413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547413">(Sep 30 2021 at 10:04)</a>:</h4>
<p>But that is true for almost all system package managers</p>



<a name="255547460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547460">(Sep 30 2021 at 10:04)</a>:</h4>
<p>Not <code>brew</code> as far as I am aware.</p>



<a name="255547640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255547640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255547640">(Sep 30 2021 at 10:06)</a>:</h4>
<p>You can install multiple versions of the same package, and use them in dependency diamonds?</p>



<a name="255552215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/%5BRFC%5D%20name/version%20package%20fields/near/255552215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/.5BRFC.5D.20name.2Fversion.20package.20fields.html#255552215">(Sep 30 2021 at 10:49)</a>:</h4>
<p>I guess you meant that while it cannot solve dependency hell, it can at least resolve correct versions of dependencies given a specific version and given that none of them have been installed in different versions. In that case, yes, most package managers that are not pacman can do that afaik.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>