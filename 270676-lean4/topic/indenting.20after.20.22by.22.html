---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/indenting.20after.20.22by.22.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html">indenting after "by"</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="309480072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309480072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309480072">(Nov 13 2022 at 17:27)</a>:</h4>
<p>These two examples work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>
  <span class="n">h2</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>
</code></pre></div>
<p>This one doesn't:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>
</code></pre></div>
<p>This one does:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">by</span>
                  <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>
</code></pre></div>
<p>I'm trying to figure out what the rules are for indenting after <code>by</code>.  It appears that the rules after <code>have</code> are different from the rules after <code>calc</code>.  Can someone explain what the rules are?</p>



<a name="309482386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309482386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309482386">(Nov 13 2022 at 17:49)</a>:</h4>
<p>This is probably because of <a href="https://github.com/leanprover/lean4/pull/1811">https://github.com/leanprover/lean4/pull/1811</a> (/cc <span class="user-mention" data-user-id="380302">@Adrien Champion</span>). It looks like we should special-case <code>by</code> in the <code>calcStep</code> parser.</p>



<a name="309502575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309502575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309502575">(Nov 13 2022 at 21:40)</a>:</h4>
<p>Yeah <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> pointed something similar to me earlier</p>



<a name="309505929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309505929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309505929">(Nov 13 2022 at 22:24)</a>:</h4>
<p>So what's happening is that <code>calc</code> does a <code>withPosition</code> on the RHS of the <code>:=</code>:</p>
<ul>
<li><a href="https://github.com/leanprover/lean4/blob/2386c401d231cb15292ba358cf58ab33adb5dfca/src/Init/NotationExtra.lean#L91">https://github.com/leanprover/lean4/blob/2386c401d231cb15292ba358cf58ab33adb5dfca/src/Init/NotationExtra.lean#L91</a></li>
</ul>



<a name="309506030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309506030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309506030">(Nov 13 2022 at 22:26)</a>:</h4>
<p>I'm not completely sure why it does that, but then <code>by</code>'s tactics need to be <code>colGt</code> that position because of my PR</p>



<a name="309506086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309506086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309506086">(Nov 13 2022 at 22:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> (correct me if I'm wrong) and I feel like this <code>withPosition</code> on the RHS should not be there, we're trying to understand whether it is important or not</p>



<a name="309506361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309506361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309506361">(Nov 13 2022 at 22:30)</a>:</h4>
<p>Also, sorry if my PR caused some confusion <span aria-label="crying cat" class="emoji emoji-1f63f" role="img" title="crying cat">:crying_cat:</span></p>



<a name="309506378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309506378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309506378">(Nov 13 2022 at 22:30)</a>:</h4>
<p>it looks like that <code>withPosition</code> has been there <a href="https://github.com/leanprover/lean4/commit/f9fd0b3de4626a668d4ae6b45609dd2b94db82b5">from the beginning</a>, cc: <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span></p>



<a name="309506503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309506503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309506503">(Nov 13 2022 at 22:32)</a>:</h4>
<p>If you really want to use line indentation <span class="user-mention" data-user-id="380302">@Adrien Champion</span>, one way to accomplish that would be a combinator <code>withPositionAtLineStart(p)</code> which sets the position to the first non-whitespace character in the line</p>



<a name="309511676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309511676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309511676">(Nov 13 2022 at 23:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> and myself's current plan is to just remove the <code>withPosition</code> in <a href="https://github.com/leanprover/lean4/blob/2386c401d231cb15292ba358cf58ab33adb5dfca/src/Init/NotationExtra.lean#L91"><code>calcStep</code></a>, which solves the issue but makes custom-aligned <code>calc</code> lines like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">t1</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="n">t1</span> <span class="bp">=</span> <span class="n">t2</span> <span class="o">:=</span> <span class="n">pf12</span>
     <span class="n">_</span> <span class="bp">=</span> <span class="n">t3</span> <span class="o">:=</span> <span class="n">pf23</span>
     <span class="n">_</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span> <span class="n">pf34</span>
</code></pre></div>
<p>illegal, it would need to be rewritten as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">t1</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="n">t1</span> <span class="bp">=</span> <span class="n">t2</span> <span class="o">:=</span> <span class="n">pf12</span>
    <span class="n">_</span> <span class="bp">=</span> <span class="n">t3</span> <span class="o">:=</span> <span class="n">pf23</span>
    <span class="n">_</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span> <span class="n">pf34</span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">t1</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="n">t1</span> <span class="bp">=</span> <span class="n">t2</span> <span class="o">:=</span> <span class="n">pf12</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t3</span> <span class="o">:=</span> <span class="n">pf23</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span> <span class="n">pf34</span>
</code></pre></div>
<p>if you're feeling fancy, which I feel is a fair tradeoff</p>



<a name="309551900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309551900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309551900">(Nov 14 2022 at 08:42)</a>:</h4>
<p>Sure, the last example looks like our conventional formatting for patterns</p>



<a name="309556826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309556826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309556826">(Nov 14 2022 at 09:16)</a>:</h4>
<p>I tend to see the first one a lot more, where the LHS is right-aligned, but maybe that's a coincidence</p>



<a name="309558319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309558319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309558319">(Nov 14 2022 at 09:26)</a>:</h4>
<p>I can't say I see <code>calc</code> at all in the code I'm usually looking at, so I don't know what's more common</p>



<a name="309617452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309617452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309617452">(Nov 14 2022 at 14:37)</a>:</h4>
<p>If the left side of the first equation (<code>t1</code> in examples above) is long, then the third possibility will look a little funny, with a large gap between <code>_</code> and <code>=</code>.  But I can get used to it.<br>
I suspect the first and second are more common than the third, but I don't really know.  Here are two examples from Chapter 7 of "Theorem Proving in Lean 4":</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="k">calc</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
                  <span class="n">_</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
                  <span class="n">_</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span>  <span class="n">m</span>  <span class="o">:=</span> <span class="gr">sorry</span><span class="o">)</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>     <span class="k">calc</span> <span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
           <span class="n">_</span>  <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">))</span>           <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
           <span class="n">_</span>  <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">m</span><span class="o">)</span>             <span class="o">:=</span> <span class="n">rfl</span><span class="o">)</span>
</code></pre></div>



<a name="309618046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309618046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309618046">(Nov 14 2022 at 14:40)</a>:</h4>
<p>How would you format the first example if the tactic step took multiple lines?</p>



<a name="309619992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/309619992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#309619992">(Nov 14 2022 at 14:49)</a>:</h4>
<p>Do you mean would I indent further than the <code>_</code>, or even the <code>=</code>?  Yes, my instinct would be to make the tactic proof not interfere, visually, with the sequence of equations, so I would probably want to indent past the <code>=</code>.  Which means I would probably use the style of the second example, with the lines after the first not indented so far.<br>
Is something like the following allowed?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="k">calc</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">n</span>
        <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
      <span class="n">_</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
      <span class="n">_</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span>  <span class="n">m</span>  <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>Sometimes, when writing calculational proofs in LaTeX, I have used that style if the formulas were long.</p>



<a name="310578370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310578370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310578370">(Nov 17 2022 at 10:07)</a>:</h4>
<p>The fix where we remove the <code>withPosition</code> in <code>calcStep</code> accounts for both styles above</p>



<a name="310578418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310578418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310578418">(Nov 17 2022 at 10:07)</a>:</h4>
<p>I prepared a PR and added a few tests inspired by these examples:</p>
<ul>
<li><a href="https://github.com/leanprover/lean4/compare/master...AdrienChampion:lean4:calc_indent_fix#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578">https://github.com/leanprover/lean4/compare/master...AdrienChampion:lean4:calc_indent_fix#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578</a></li>
</ul>



<a name="310578482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310578482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310578482">(Nov 17 2022 at 10:08)</a>:</h4>
<p>In particular these two:</p>
<ul>
<li><a href="https://github.com/leanprover/lean4/compare/master...AdrienChampion:lean4:calc_indent_fix#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578R25-R38">https://github.com/leanprover/lean4/compare/master...AdrienChampion:lean4:calc_indent_fix#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578R25-R38</a></li>
</ul>



<a name="310621292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310621292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310621292">(Nov 17 2022 at 14:34)</a>:</h4>
<p>FYI: <a href="https://github.com/leanprover/lean4/pull/1844">https://github.com/leanprover/lean4/pull/1844</a></p>



<a name="310621930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310621930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310621930">(Nov 17 2022 at 14:38)</a>:</h4>
<p>It would be good to have more opinions on whether the new style is acceptable (see PR tests). Just to reiterate, special-casing <code>by</code> in <code>calc</code> would allow us to keep the old style (as long as you indent your tactics more than the next calc line).</p>



<a name="310641948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310641948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310641948">(Nov 17 2022 at 16:05)</a>:</h4>
<p>Will the example from my original message work with this fix?  Perhaps something like this could be added to the test file:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">t1</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="n">t1</span> <span class="bp">=</span> <span class="n">t2</span> <span class="o">:=</span> <span class="n">pf12</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t3</span> <span class="o">:=</span> <span class="kd">by</span>
      <span class="n">exact</span> <span class="n">pf23</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span> <span class="n">pf34</span>
</code></pre></div>



<a name="310673276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310673276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310673276">(Nov 17 2022 at 18:36)</a>:</h4>
<p>yes, that will work</p>



<a name="310765364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/indenting%20after%20%22by%22/near/310765364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adrien Champion <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/indenting.20after.20.22by.22.html#310765364">(Nov 18 2022 at 08:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="453098">Dan Velleman</span> <a href="#narrow/stream/270676-lean4/topic/indenting.20after.20.22by.22/near/310641948">said</a>:</p>
<blockquote>
<p>Will the example from my original message work with this fix?  Perhaps something like this could be added to the test file:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">t1</span> <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span>
  <span class="k">calc</span>
    <span class="n">t1</span> <span class="bp">=</span> <span class="n">t2</span> <span class="o">:=</span> <span class="n">pf12</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t3</span> <span class="o">:=</span> <span class="kd">by</span>
      <span class="n">exact</span> <span class="n">pf23</span>
    <span class="n">_</span>  <span class="bp">=</span> <span class="n">t4</span> <span class="o">:=</span> <span class="n">pf34</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Added your example as a test thanks <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
<ul>
<li><a href="https://github.com/leanprover/lean4/pull/1844/files#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578R47-R52">https://github.com/leanprover/lean4/pull/1844/files#diff-033f2685e2b9ff73636791b77ef24e24530d42bb8bca39f9d3afc9036a073578R47-R52</a></li>
</ul>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>