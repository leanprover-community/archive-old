---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html">Prototype: Jupyter for Lean4</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="280022135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280022135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddharth Bhat <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280022135">(Apr 25 2022 at 05:10)</a>:</h4>
<p>Here's an <a href="https://github.com/bollu/lean-to/blob/master/examples/HelloWorld.ipynb">example of a Hello World Jupyter notebook</a> that was created with the Jupyter Kernel in the same repo. Note that Github renders Jupyter notebooks by default!</p>
<h3>Rationale</h3>
<p>As I understand it, <a href="https://github.com/insightmind/LeanInk">LeanInk</a> is meant for static visualization of Lean4 code+proofs. I wondered if having a Jupyter kernel would complement this in writing "programming" style Lean4 code. I wonder what others feel about this, and if it makes sense to develop this further. This was a quick weekend hack to see if this is feasible (seems to be so!)</p>
<h3>Technical details</h3>
<p>This is implemented as a large chunk of C++ in <a href="https://github.com/bollu/lean-to/blob/02696aa855f35cacbf2c774cef5273d7949626c0/asm-kernel.cpp#L600"><code>asm-kernel.cpp</code></a> that interacts with Jupyter via ZeroMQ, and a little bit of Lean4 in <a href="https://github.com/bollu/lean-to/blob/02696aa855f35cacbf2c774cef5273d7949626c0/REPLLib.lean"><code>REPLLib.lean</code></a> to run Lean4 commands. Many thanks to <a href="https://github.com/arthurpaulino/LeanREPL"><code>arthurpaulino/LeanREPL</code></a> for the REPL code. </p>
<h3>Questions</h3>
<p>I'd like to develop this further for fun, so feature requests would be nice <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span>. More to the point, I don't want to duplicate work and split the community's attention between the Jupyter kernel and LeanInk, so having a clearer picture of the relationship between the two would be very useful for me!</p>



<a name="280023700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280023700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280023700">(Apr 25 2022 at 05:38)</a>:</h4>
<p>Just to remark the obvious -- things like this would be really useful for people like me who are teaching this stuff.</p>



<a name="280024006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280024006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280024006">(Apr 25 2022 at 05:43)</a>:</h4>
<p>That's a great proof of concept! Well done!</p>



<a name="280031052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280031052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280031052">(Apr 25 2022 at 07:19)</a>:</h4>
<p>Very nice to see. Does it suffer the usual Jupyter notebook issue where dependent cells are not updated?</p>
<p>Julia's Pluto.jl notebook resolves this issue. Might have other things worth looking into. <a href="https://github.com/fonsp/Pluto.jl">https://github.com/fonsp/Pluto.jl</a></p>



<a name="280031953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280031953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280031953">(Apr 25 2022 at 07:29)</a>:</h4>
<blockquote>
<p>Pluto offers an environment where changed code takes effect instantly and where deleted code leaves no trace. Unlike Jupyter or Matlab, there is no mutable workspace, but rather, an important guarantee:</p>
<blockquote>
<p>At any instant, the program state is completely described by the code you see.</p>
</blockquote>
<p>No hidden state, no hidden bugs.</p>
</blockquote>



<a name="280033072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280033072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280033072">(Apr 25 2022 at 07:41)</a>:</h4>
<p>If my language/compiler project goes well, I plan to make a Pluto.jl style reactive notebook with a <a href="http://Hazel.org">Hazel.org</a> style editor. All edits produce valid syntax. A program containing holes may still be partially reduced. Likewise type and binding errors become holes. All intermediate editor states are thus useful without heuristics or breaking the LSP's ability to infer types and so on.</p>



<a name="280034586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280034586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280034586">(Apr 25 2022 at 07:57)</a>:</h4>
<p>I know Lean is somewhat accepting with invalid syntax, but it doesn't go out of its way to inject typed holes in place of binding or type errors. I wonder how difficult this would be to add to Lean...</p>



<a name="280035460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280035460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280035460">(Apr 25 2022 at 08:04)</a>:</h4>
<p>Or if it'd even be welcome.</p>



<a name="280035939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280035939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280035939">(Apr 25 2022 at 08:08)</a>:</h4>
<p>I'm very supportive of structure editors, personally, but I didn't find the <a href="http://Hazel.org">Hazel.org</a> editor to be the smoothest experience..... I would happily use a structure editor for Lean if it was as smooth of an experience as using VSCode :P</p>



<a name="280036039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280036039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280036039">(Apr 25 2022 at 08:09)</a>:</h4>
<p>(This might partly be a symptom of the VSCode extension not having substantial autocomplete options -- once we have e.g. exhaustive match template generation, the need might be even less there)</p>



<a name="280036730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280036730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sofia <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280036730">(Apr 25 2022 at 08:15)</a>:</h4>
<p>Hazel certainly could be a lot smoother. I've been thinking more like the traditional auto-complete syntax expansion, maybe even grayed out multiple-choice.</p>



<a name="280052240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280052240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280052240">(Apr 25 2022 at 10:59)</a>:</h4>
<p>Nice work!!<br>
The REPL I wrote (which is not completely authorial either) supports rollbacks exactly for the cases in which an upward cell is executed. In this scenario, my plan would be to reset the cells below it and clean their output.</p>
<p>I'd recommend keeping a clear use case in mind for the development of the kernel so you knowi what you're aiming at. I wrote the REPL after seeing Tomas' SciLean lib and I thought that eventually we'd be able to process data in Lean. Turns out Jupyter notebooks are great for that because once you run the code to read a dataframe, it's cached in memory so you're free to play with it.</p>
<p>The downside of a Jupyter notebook is that we don't have the fast interactive response from the server while we're trying to prove theorems for example (which is a big part of Lean's use case)</p>



<a name="280052625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280052625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280052625">(Apr 25 2022 at 11:02)</a>:</h4>
<blockquote>
<p>Turns out Jupyter notebooks are great for that because once you run the code to read a dataframe, it's cached in memory so you're free to play with it.</p>
</blockquote>
<p>I mean, that's true of the Lean language server as well, no? Do you have something in mind we could improve there?</p>



<a name="280053442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280053442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280053442">(Apr 25 2022 at 11:12)</a>:</h4>
<p>Reading a dataframe (say a CSV file) sounds like an IO operation to me. The current limitation I see is that IO calls like read/write files can be run after you compile your Lean code to a binary and run it. We can't, for instance, run a piece of code to read a file and play with its content on the same interface, whereas an interface like Jupyter would be fine for such task</p>



<a name="280053511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280053511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280053511">(Apr 25 2022 at 11:13)</a>:</h4>
<p>(the limitation might be on the combination of VS Code + lean4 plugin rather than on the language server)</p>



<a name="280053873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280053873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280053873">(Apr 25 2022 at 11:17)</a>:</h4>
<p>I even came to the point of envisioning a separate plugin to talk to the language server from Jupyter, similar to what we have for VS Code. So we would have a Lean 4 infoview on Jupyter. But the motivation needs to be strong before that path is crossed because I think it's a long road with a lot of work</p>



<a name="280054565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280054565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280054565">(Apr 25 2022 at 11:24)</a>:</h4>
<p>There is no such limitation, see <a href="https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Util/IncludeStr.lean">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Util/IncludeStr.lean</a></p>



<a name="280054810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280054810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280054810">(Apr 25 2022 at 11:27)</a>:</h4>
<p>Having said that, while I believe the current compilation strategy should ensure the string is loaded exactly once as long as only text below it is changed, this is not true for further computations done on the string, even if they are stored in parameter-less <code>def</code>s. This is a performance optimization in the interpreter we've considered before, but it has been low priority so far.</p>



<a name="280054957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280054957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280054957">(Apr 25 2022 at 11:28)</a>:</h4>
<p>Interesting! But what about plotting things? Jupyter supports having images as the output of cells</p>



<a name="280055034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280055034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280055034">(Apr 25 2022 at 11:29)</a>:</h4>
<p>Technically speaking the infoview could support plotting things as well and e.g. pretty print trees as SVGs instead of the more sexp like representation</p>



<a name="280056259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280056259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280056259">(Apr 25 2022 at 11:41)</a>:</h4>
<p>Makes sense, but it's different from having the plots laid out so people can just scroll down and explore the document.<br>
I am aware that I'm making a stretch because I am talking about using Lean for a task that has the right tooling already set for Python, R etc. I am just daydreaming :D</p>



<a name="280084595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280084595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christian Pehle <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280084595">(Apr 25 2022 at 15:23)</a>:</h4>
<p>I experimented with plotting a bit using a hacked lean-vscode that didn't escape html in strings, I thought it was surprisingly nice to just rendered svg in a separate organised pane next to the eval commands, which automatically update when you change code.</p>



<a name="280134891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/280134891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> François G. Dorais <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#280134891">(Apr 25 2022 at 21:56)</a>:</h4>
<p>This is really cool!</p>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4/near/280052240">said</a>:</p>
<blockquote>
<p>[...] In this scenario, my plan would be to reset the cells below it and clean their output.</p>
</blockquote>
<p>This goes against the traditional notebook format where things are executed in order they are input and not in the order of the file contents. I think the traditional notebook format is a bad fit for Lean so a non-traditional notebook format is probably better. The drawback is that I would expect having to constantly battle with the Jupyter core in the implementation. I hope it works out anyway!</p>



<a name="282691152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282691152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282691152">(May 17 2022 at 19:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130511">Christian Pehle</span> <a href="#narrow/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4/near/280084595">said</a>:</p>
<blockquote>
<p>I experimented with plotting a bit using a hacked lean-vscode that didn't escape html in strings, I thought it was surprisingly nice to just rendered svg in a separate organised pane next to the eval commands, which automatically update when you change code.</p>
</blockquote>
<p>Now I'm wondering how hard it would be to hack lean-vscode to show all <code>#eval</code> output in a continuous panel that automatically scrolls to where you are in the document, like what the markdown extension does for previewing your markdown</p>



<a name="282691311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282691311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282691311">(May 17 2022 at 19:04)</a>:</h4>
<p>Is your code in a repository somewhere that I can play around with? <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="282692035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282692035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282692035">(May 17 2022 at 19:08)</a>:</h4>
<p>If i look at my goal view in Emacs the language server is already telling the client/vscode in this case where the messages are coming from line (and even column) wise so If you have some code to sync that scrolling, shouldnt be too hard.</p>



<a name="282692431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282692431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282692431">(May 17 2022 at 19:11)</a>:</h4>
<p>If we get something like that working, + a library for building data visualizations in HTML, + SciLean, + the optimization Sebastian mentioned, I feel like we'd basically have a Lean replacement for jupyter, no?</p>



<a name="282702543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282702543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282702543">(May 17 2022 at 20:30)</a>:</h4>
<p>(Oh, one other "small" thing -- making a web extension for VS Code, so that it can be run in the browser...)</p>



<a name="282756983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282756983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282756983">(May 18 2022 at 08:45)</a>:</h4>
<p>In emacs, lsp can highlight subterms and show their types, see attached picture(probably works in VS code too). </p>
<p><a href="/user_uploads/3121/n2wYMe5FdbR9gVZ7Olsh481X/Screenshot-from-2022-05-18-10-17-59.png">Screenshot-from-2022-05-18-10-17-59.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/n2wYMe5FdbR9gVZ7Olsh481X/Screenshot-from-2022-05-18-10-17-59.png" title="Screenshot-from-2022-05-18-10-17-59.png"><img src="/user_uploads/3121/n2wYMe5FdbR9gVZ7Olsh481X/Screenshot-from-2022-05-18-10-17-59.png"></a></div><p>Would it be possible to get something similar in the goal view? In particular, I would like to generate appropriate <code>conv</code> command <code>enter [...]</code> to zoom in on such a subterm and rewrite it as user desires.</p>
<p>Imagined workflow would be that you right click on a subterm and get a menu of potentially operations: simplify, expand, together etc.</p>



<a name="282757762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282757762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282757762">(May 18 2022 at 08:51)</a>:</h4>
<p><span class="user-mention" data-user-id="346070">@Tomas Skrivan</span> That's certainly part of what the widget framework should accomplish. In Lean 3 there was never widget support for <code>conv</code>, but I'm pretty sure it is on <span class="user-mention" data-user-id="121918">@Edward Ayers</span>'s radar for Lean 4.</p>



<a name="282758601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282758601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282758601">(May 18 2022 at 09:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="346070">Tomas Skrivan</span> <a href="#narrow/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4/near/282756983">said</a>:</p>
<blockquote>
<p>In particular, I would like to generate appropriate <code>conv</code> command <code>enter [...]</code> to zoom in on such a subterm and rewrite it as user desires.</p>
</blockquote>
<p>This is <em>exactly</em> what one of <span class="user-mention" data-user-id="110789">@Jakob von Raumer</span>'s students is working on right now, so... stay tuned!</p>



<a name="282758770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282758770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282758770">(May 18 2022 at 09:01)</a>:</h4>
<p>That is, for VS Code (and possibly lean.nvim). No attempts to port widgets to lean4-mode have been made yet.</p>



<a name="282759858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/282759858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#282759858">(May 18 2022 at 09:10)</a>:</h4>
<p>That is amazing! Looking forward trying it out.</p>



<a name="285166433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/285166433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Marco <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#285166433">(Jun 06 2022 at 20:18)</a>:</h4>
<p>I have hacked a proof of concept for lean3:</p>
<p><a href="https://github.com/miguelmarco/leankernel">https://github.com/miguelmarco/leankernel</a></p>
<p>It works but may be fragile.</p>
<p>My main problem is that the jupyter notebook paradigm requires a "clear state" in the backend when the  answer is given, whereas the lean server works ayncronously. So the jupyter kernel might think that the lean server has finished processing the last request, answer to the frontend, and then some more messages from the lean server might arrive. The heuristic I use for this is to wait for a <code>is_running:False</code>message, and then wait 0.5 seconds without new messages. This introduces a slowdown in the user experience.</p>
<p>Is there a way to ask the lean server if it is really done processing all the previous requests?</p>



<a name="289024104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/289024104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ziyu Zhou <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#289024104">(Jul 09 2022 at 06:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="461731">Miguel Marco</span> <a href="#narrow/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4/near/285166433">said</a>:</p>
<blockquote>
<p>I have hacked a proof of concept for lean3:</p>
<p><a href="https://github.com/miguelmarco/leankernel">https://github.com/miguelmarco/leankernel</a></p>
<p>It works but may be fragile.</p>
<p>My main problem is that the jupyter notebook paradigm requires a "clear state" in the backend when the  answer is given, whereas the lean server works ayncronously. So the jupyter kernel might think that the lean server has finished processing the last request, answer to the frontend, and then some more messages from the lean server might arrive. The heuristic I use for this is to wait for a <code>is_running:False</code>message, and then wait 0.5 seconds without new messages. This introduces a slowdown in the user experience.</p>
<p>Is there a way to ask the lean server if it is really done processing all the previous requests?</p>
</blockquote>
<p>I tried to install your leankernel on windows10 and ubuntu22.04, but both of them didn't work. I think I followed the Readme.md every step of the way. May I ask for a detailed installation tutorial?</p>



<a name="289025074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/289025074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#289025074">(Jul 09 2022 at 06:47)</a>:</h4>
<p>Did you get an error message?</p>



<a name="289038716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/289038716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ziyu Zhou <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#289038716">(Jul 09 2022 at 12:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="325367">Mauricio Collares</span> <a href="#narrow/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4/near/289025074">said</a>:</p>
<blockquote>
<p>Did you get an error message?</p>
</blockquote>
<p>It prompts: Failed to start the Kernel. Jupyter log:<br>
<a href="/user_uploads/3121/dHvfkGg_UDC8_x1wAs7m82WA/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/dHvfkGg_UDC8_x1wAs7m82WA/image.png" title="image.png"><img src="/user_uploads/3121/dHvfkGg_UDC8_x1wAs7m82WA/image.png"></a></div>



<a name="289039115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/289039115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ziyu Zhou <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#289039115">(Jul 09 2022 at 12:31)</a>:</h4>
<p>There must be something wrong with my installation process, but I cannot check it out. If you could give me an example of a proper installation, especially the environment variable configuration information, I'd appreciate it.</p>



<a name="294489652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/294489652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Marco <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#294489652">(Aug 20 2022 at 23:07)</a>:</h4>
<p>Sorry for not answering before. I didn't see the message.</p>
<p>From what I see, you use conda installation, right?</p>
<p>I am not familiar with that kind of environments. Maybe there is a specific way to install python packages there?</p>



<a name="294524508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/294524508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ziyu Zhou <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#294524508">(Aug 21 2022 at 09:37)</a>:</h4>
<p>Actually I used ''pip install .''</p>
<p>I'm not very familiar with how jupyter kernel works, and it's hard for me to make a reasonable guess as to what went wrong with my installation process. A more detailed installation tutorial may be helpful. Thank you!</p>



<a name="319462945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/319462945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Marco <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#319462945">(Jan 04 2023 at 20:00)</a>:</h4>
<p>Sorry again for the delay. Since I finally got some free time, i have taken a look again at this project, and found that it was indeed a problem in the code as it has been published. </p>
<p>I will try to improve it. Will let you know when it is done.</p>



<a name="319464328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Prototype%3A%20Jupyter%20for%20Lean4/near/319464328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Marco <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Prototype.3A.20Jupyter.20for.20Lean4.html#319464328">(Jan 04 2023 at 20:08)</a>:</h4>
<p>In the meantime, you can try to edit the <code>kernel.json</code> file to make it look like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">{</span><span class="s2">"argv"</span><span class="o">:[</span><span class="s2">"python3"</span> <span class="o">,</span><span class="s2">"-m"</span> <span class="o">,</span> <span class="s2">"leankernel.leankernel"</span><span class="o">,</span> <span class="s2">"-f"</span><span class="o">,</span> <span class="s2">"{connection_file}"</span><span class="o">],</span>
 <span class="s2">"display_name"</span><span class="o">:</span><span class="s2">"Lean"</span><span class="o">,</span>
 <span class="s2">"language"</span><span class="o">:</span> <span class="s2">"lean"</span><span class="o">,</span>
<span class="s2">"env"</span> <span class="o">:</span> <span class="o">{</span>
    <span class="s2">"LEAN_MEMORY"</span> <span class="o">:</span> <span class="s2">"4096"</span><span class="o">,</span>
    <span class="s2">"LEAN_TIME"</span>  <span class="o">:</span> <span class="s2">"100000"</span><span class="o">,</span>
    <span class="s2">"LEAN_BINARY"</span>  <span class="o">:</span> <span class="s2">"YOUR_LEAN_BINARY,</span>
<span class="s2">    "</span><span class="n">LEAN_PATHFILES</span><span class="s2">" : "</span><span class="n">YOUR_PATH_TO_LEAN_FILES</span><span class="s2">"</span>
<span class="s2"> }</span>
<span class="s2">}</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>