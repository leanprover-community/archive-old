---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html">Lean 4 analogue of semireducible for TransparencyMode?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="302754098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302754098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302754098">(Oct 06 2022 at 22:46)</a>:</h4>
<p>Some tactics expect a <code>TransparencyMode</code> argument, but while Lean 3 used <code>semireducible</code> and <code>reducible</code> as possible values, <code>semireducible</code> doesn't seem to be an option verbatim anymore; instead</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">TransparencyMode</span> <span class="n">where</span>
  <span class="bp">|</span> <span class="n">all</span> <span class="bp">|</span> <span class="n">default</span> <span class="bp">|</span> <span class="n">reducible</span> <span class="bp">|</span> <span class="n">instances</span>
  <span class="n">deriving</span> <span class="n">Inhabited</span><span class="o">,</span> <span class="n">BEq</span><span class="o">,</span> <span class="n">Repr</span>
</code></pre></div>
<p>Which of these ought to be used in place of <code>semireducible</code> for a tactic with a <code>!</code> variant?</p>
<p>I found some documenation for <code>TransparencyMode</code> on page 26 of the metaprogramming book, but I'm still not sure which of these corresponds to semireducibility (if any)—or if things have been totally reworked somehow. Is it <code>default</code>, since as I understand it <code>semireducible</code> was the default in Lean 3?</p>



<a name="302757168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302757168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302757168">(Oct 06 2022 at 23:17)</a>:</h4>
<p>It's <code>default</code>, yes.</p>



<a name="302757693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302757693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302757693">(Oct 06 2022 at 23:22)</a>:</h4>
<p>Great, thanks!</p>



<a name="302757709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302757709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302757709">(Oct 06 2022 at 23:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="548935">Thomas Murrills</span> has marked this topic as resolved.</p>



<a name="302757758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302757758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302757758">(Oct 06 2022 at 23:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="548935">Thomas Murrills</span> has marked this topic as unresolved.</p>



<a name="302757993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302757993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302757993">(Oct 06 2022 at 23:25)</a>:</h4>
<p>So, just to be sure the behavior is the same—the convention is that <code>!</code> variants use the <code>default</code> transparency mode, while ones without <code>!</code> use the <code>reducible</code>transparency mode, right? (Just double checking since based on the names I'd expect it to be flipped)</p>



<a name="302763211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302763211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302763211">(Oct 07 2022 at 00:23)</a>:</h4>
<p>Yes, that's the convention. The idea is that <code>!</code> is telling the tactic to work harder (i.e. by being more willing to unfold definitions).</p>



<a name="302763756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302763756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302763756">(Oct 07 2022 at 00:30)</a>:</h4>
<p>It would be nice to resolve that convention with lean 4 core; Leo pointed out that this could be confusing given that lean 4 declarations ending in <code>!</code> usually means they panic under some conditions</p>



<a name="302763904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302763904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302763904">(Oct 07 2022 at 00:32)</a>:</h4>
<p>Speaking of syntax, it would also be great if we could use <code>syntax "contrapose" "!"?</code> (or whatever we end up using instead of bang).</p>



<a name="302764044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302764044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302764044">(Oct 07 2022 at 00:33)</a>:</h4>
<p>Personally I think it's fine to just have this secondary meaning, although it's muddier in the case of macros, which <em>also</em> use <code>!</code> with incompatible meaning, sometimes to indicate that they are macros (this convention is dying out but still exists in the <code>s!</code>/<code>f!</code>/<code>m!</code> macros), but since they look like terms they might use the term meaning (who's to say what the <code>!</code> in <code>panic! ""</code> means?) or since they are like tactics they might use the tactic meaning (no macros like that exist right now, but I can imagine some mathlib tactics having term forms that inherit the tactic syntax)</p>



<a name="302764389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302764389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302764389">(Oct 07 2022 at 00:39)</a>:</h4>
<p>I think we could implement something like <code>syntax "contrapose" afterIdent("!")?</code> where <code>afterIdent</code> splits the previous ident token if it consumed the specified string</p>



<a name="302779252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302779252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302779252">(Oct 07 2022 at 04:33)</a>:</h4>
<p>is there a tactic naming convention for specifying the use of other transparency modes? e.g. appending something like <code>!!</code> or <code>!a</code> to indicate <code>all</code> or <code>!i</code> for <code>instances</code>? or do we typically not implement these in tactics for some reason? (I don’t have any usage experience, so I don’t know if this is a reasonable question in practice!)</p>



<a name="302780931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302780931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302780931">(Oct 07 2022 at 05:02)</a>:</h4>
<p>Some tactics that have this kind of option allow a <code>config</code> argument which will have a field for the reducibility setting. They are not used enough for the sigil soup to be worth the readability cost</p>



<a name="302781055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302781055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302781055">(Oct 07 2022 at 05:04)</a>:</h4>
<p>It occurs to me that <code>erw</code> should maybe be renamed to <code>rw!</code> to follow this naming convention (it is the <code>reducibility := .default</code> version of <code>rw</code>)</p>



<a name="302785690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Lean%204%20analogue%20of%20semireducible%20for%20TransparencyMode%3F/near/302785690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Lean.204.20analogue.20of.20semireducible.20for.20TransparencyMode.3F.html#302785690">(Oct 07 2022 at 06:07)</a>:</h4>
<p>Knuth would probably write <code>rw$</code> and <code>contrapose$</code> to hint that they are doing "more expensive" stuff.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>