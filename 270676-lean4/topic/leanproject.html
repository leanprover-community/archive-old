---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/leanproject.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html">leanproject</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="268564646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268564646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268564646">(Jan 19 2022 at 16:24)</a>:</h4>
<p>Do you people think it would make sense to turn <code>mathlibtools</code> into a Lean 4 script? I think it would make the Lean setup easier by eliminating the Python dependency. Maybe even implementing such functionalities inside <code>lake</code> for unification purposes?</p>



<a name="268564810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268564810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268564810">(Jan 19 2022 at 16:25)</a>:</h4>
<p>Yes, this should definitely go inside the build system</p>



<a name="268565311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268565311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268565311">(Jan 19 2022 at 16:28)</a>:</h4>
<p>And would it embrace the Git functionalities as well? I totally understand (and I think it was a really good idea) that <code>mathlibtools</code> provides a simplified interface for Git, but would it make sense inside a build system?</p>



<a name="268565614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268565614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268565614">(Jan 19 2022 at 16:30)</a>:</h4>
<p>(maybe the Git functionalities could be implemented in Mathlib4 <code>lake</code> scripts <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span>)</p>



<a name="268566371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268566371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268566371">(Jan 19 2022 at 16:35)</a>:</h4>
<p>I don't know much about mathlibtools, so I don't know what that entails. But at least for e.g. retrieving projects, Nix for example has <code>nix flake clone github:leanprover-community/mathlib4</code>, so I would say yes.</p>



<a name="268566649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268566649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268566649">(Jan 19 2022 at 16:37)</a>:</h4>
<p>The story might also change a bit if a package index is introduced, then the package manager is definitely the one that would implement cloning a package by name.</p>



<a name="268571019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268571019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268571019">(Jan 19 2022 at 17:04)</a>:</h4>
<p>Personally I am very uncomfortable with tools performing git operations on repositories of mine they don't "own" and fully manage. I sort of hope any Lean4 tool doesn't attempt to do so by default, but I see that's balanced with trying to present a simpler interface for some who don't need all of git and unarguably has worked well for that audience. But it seems the two of those are separate goals, so hopefully it's separable in some way.</p>



<a name="268571700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268571700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268571700">(Jan 19 2022 at 17:08)</a>:</h4>
<p><code>leanproject</code> uses git operations primarily for when it wants to download mathlib into your <code>_target</code> directory, a la <code>cargo</code>. Does <code>lake</code> do git downloads as well?</p>



<a name="268571818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268571818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268571818">(Jan 19 2022 at 17:09)</a>:</h4>
<p>it does expect to fully manage <code>_target</code>, so maybe that sidesteps your concern</p>



<a name="268571868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268571868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268571868">(Jan 19 2022 at 17:09)</a>:</h4>
<p><code>leanproject</code> seems to be able to open PRs:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ leanproject pr
Usage: leanproject pr <span class="o">[</span>OPTIONS<span class="o">]</span> BRANCH_NAME
Try <span class="s1">'leanproject pr -h'</span> <span class="k">for</span> help.

Error: Missing argument <span class="s1">'BRANCH_NAME'</span>.
</code></pre></div>



<a name="268572028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268572028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268572028">(Jan 19 2022 at 17:10)</a>:</h4>
<p>Huh. Don't you need a github API token to do that?</p>



<a name="268572094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268572094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268572094">(Jan 19 2022 at 17:10)</a>:</h4>
<p>I guess it simply opens a browser?</p>



<a name="268572528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268572528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268572528">(Jan 19 2022 at 17:13)</a>:</h4>
<p>Hm, it did something unexpected:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>.../mathlib$ leanproject pr test-branch
Checking out master...
Pulling...
<span class="sb">`</span>get-mathlib-cache<span class="sb">`</span> is <span class="k">for</span> projects which depend on mathlib, not <span class="k">for</span> mathlib itself. Running <span class="sb">`</span>get-cache<span class="sb">`</span> instead.
Looking <span class="k">for</span> mathlib oleans <span class="k">for</span> c72e709ea
  locally...
  remotely...
  Found remote mathlib oleans
Using matching cache
  c72e709ea: <span class="m">100</span>%<span class="p">|</span>██████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span> <span class="m">58</span>.7M/58.7M <span class="o">[</span><span class="m">00</span>:17&lt;<span class="m">00</span>:00, <span class="m">3</span>.50MB/s<span class="o">]</span>
Applying cache
  files extracted: <span class="m">2091</span> <span class="o">[</span><span class="m">00</span>:06, <span class="m">304</span>.01/s<span class="o">]</span>
Checking out new branch...
Setting remote tracking to origin...
Done.
</code></pre></div>



<a name="268572714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268572714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268572714">(Jan 19 2022 at 17:14)</a>:</h4>
<p>Then</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>.../mathlib$ git st
No ramo test-branch
</code></pre></div>
<p>Seems like it just prepared my directory to work on something new</p>



<a name="268572902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268572902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268572902">(Jan 19 2022 at 17:15)</a>:</h4>
<p>I would advise against running commands before reading their description :)</p>



<a name="268573044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573044">(Jan 19 2022 at 17:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/leanproject/near/268571700">said</a>:</p>
<blockquote>
<p><code>leanproject</code> uses git operations primarily for when it wants to download mathlib into your <code>_target</code> directory, a la <code>cargo</code>. Does <code>lake</code> do git downloads as well?</p>
</blockquote>
<p>Yeah -- touching repositories in _target is fine -- some stuff touches or used to touch the working tree though, most of which I see was changed to not do that now in <a href="https://github.com/leanprover-community/mathlib-tools/pull/113">https://github.com/leanprover-community/mathlib-tools/pull/113</a> -- that's the sort of stuff I hope is always avoided, and if it can't be is very loud and disablable</p>



<a name="268573536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573536">(Jan 19 2022 at 17:19)</a>:</h4>
<p>I don't think leanproject overwriting .lean files from cache has ever been a planned feature</p>



<a name="268573707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573707">(Jan 19 2022 at 17:20)</a>:</h4>
<p>And Lean 4's separation of .lean and .olean files makes it very hard to reimplement it as an unplanned feature</p>



<a name="268573774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573774">(Jan 19 2022 at 17:21)</a>:</h4>
<p>Same of course for "don't run git stash on my repo, don't run git pull, etc.". Long as it doesn't do those things then yeah that's all I was referring to.</p>



<a name="268573833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573833">(Jan 19 2022 at 17:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/270676-lean4/topic/leanproject/near/268572528">said</a>:</p>
<blockquote>
<p>Hm, it did something unexpected (based on the command name):</p>
</blockquote>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ leanproject pr -h
Usage: leanproject pr <span class="o">[</span>OPTIONS<span class="o">]</span> BRANCH_NAME

  Prepare to work on a mathlib pull-request on a new branch.
</code></pre></div>



<a name="268573959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268573959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268573959">(Jan 19 2022 at 17:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/270676-lean4/topic/leanproject/near/268572902">said</a>:</p>
<blockquote>
<p>I would advise against running commands before reading their description :)</p>
</blockquote>
<p>That sounds really wise.</p>



<a name="268574087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268574087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268574087">(Jan 19 2022 at 17:23)</a>:</h4>
<p>Yeah, my bad. The description says it but we weren't able to have an approximate guess of what it would do</p>



<a name="268574299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268574299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268574299">(Jan 19 2022 at 17:25)</a>:</h4>
<p>About the main topic: I very much hope that Lean 4 will have a very nice tool doing everything that <code>leanproject</code> currently does and more, and doing it better. <code>leanproject</code> was coded by a non-programmer as a stop-gap measure at a time where it became really painful to work on mathlib without such a tool. Then some stuff was added, sometimes by other people, bugs were introduced and some were fixed. But really we need a much better tool for Lean 4, and I very much hope I won't be writing it.</p>



<a name="268575244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/leanproject/near/268575244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/leanproject.html#268575244">(Jan 19 2022 at 17:31)</a>:</h4>
<p>Right, <code>leanproject</code> offers a nice tooling and I particularly love <code>get-cache</code>, for instance.<br>
Maybe the question is: which tools should do what?<br>
I think <code>lake</code> scripts provide a great set of possibilities for repository-specific needs, like helping out mathematicians to deal with Git (which is not a super friendly tool, even for some programmers)</p>
<p>Edit: please note that I'm not complaining about <code>leanproject</code>, sorry if it looked like it. There would be nothing wrong if, say, it opened a PR page in the browser or something like that</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>