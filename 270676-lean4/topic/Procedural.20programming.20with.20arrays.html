---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html">Procedural programming with arrays</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="313177874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313177874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kind Bubble <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313177874">(Nov 30 2022 at 23:34)</a>:</h4>
<p>I thought I read somewhere that Arrays in Lean 4 are mutable. What does this entail on the front and back end?</p>



<a name="313179324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313179324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313179324">(Nov 30 2022 at 23:48)</a>:</h4>
<p>Arrays in Lean will be optimized to be accessed in a mutable way if you use them in a linear fashion, that is there is only ever one reference to them at a time at runtime.</p>
<p>That being said I don't quite understand your question, do you want to know how its implemented?</p>



<a name="313184753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313184753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313184753">(Dec 01 2022 at 00:38)</a>:</h4>
<p>This paper explains the implementation if I understand correctly.  <a href="https://arxiv.org/pdf/1908.05647.pdf">https://arxiv.org/pdf/1908.05647.pdf</a></p>



<a name="313185065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313185065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313185065">(Dec 01 2022 at 00:42)</a>:</h4>
<p>I don't know if arrays are particularly special, or if this generally falls under the "destructive updates" pattern.  Various slides by the developers (e.g. <a href="http://leanprover.github.io/talks/NFM2022.pdf">http://leanprover.github.io/talks/NFM2022.pdf</a>) summarizes it as:</p>
<blockquote>
<p>Runtime uses reference counting for GC, and performs destructive updates if RC = 1</p>
</blockquote>



<a name="313233613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313233613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313233613">(Dec 01 2022 at 09:19)</a>:</h4>
<p>Arrays are special in the sense that destructive updates are triggered by runtime primitives (think <code>Array.push</code>), not heuristic optimizations</p>



<a name="313233759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313233759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313233759">(Dec 01 2022 at 09:20)</a>:</h4>
<p>See §7.1</p>



<a name="313360387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Procedural%20programming%20with%20arrays/near/313360387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kind Bubble <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Procedural.20programming.20with.20arrays.html#313360387">(Dec 01 2022 at 19:39)</a>:</h4>
<p>Thanks, this is good info. I think I'll have to keep this understanding for several months into the future since I'm just getting used to the basics.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>