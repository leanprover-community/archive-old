---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Fin.20without.20wrapping.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html">Fin without wrapping</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="274890112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274890112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274890112">(Mar 10 2022 at 20:21)</a>:</h4>
<p>In this photo <a href="/user_uploads/3121/VIGGG_iMppqIteuBwCTpHVs5/image.png">image.png</a>  it wraps the value of 88 mod 5, but I don't really want that . I would prefer it to not typecheck, like in Idris. Is there another version of <code>Fin</code> with that behavior?</p>
<div class="message_inline_image"><a href="/user_uploads/3121/VIGGG_iMppqIteuBwCTpHVs5/image.png" title="image.png"><img src="/user_uploads/3121/VIGGG_iMppqIteuBwCTpHVs5/image.png"></a></div>



<a name="274890243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274890243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274890243">(Mar 10 2022 at 20:22)</a>:</h4>
<p>You could implement one, the translation of numerals to types is controlled by the <code>OfNat</code> type class</p>



<a name="274890389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274890389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274890389">(Mar 10 2022 at 20:24)</a>:</h4>
<p>But why is it not default?</p>



<a name="274893142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274893142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274893142">(Mar 10 2022 at 20:51)</a>:</h4>
<p>The simple answer is "to match the behavior of lean 3"</p>



<a name="274894662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274894662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274894662">(Mar 10 2022 at 21:04)</a>:</h4>
<p>You could also make a mathematical argument if <code>FIn n</code> is supposed to be numbers <code>mod n</code> then <code>12 mod 10</code> should be <code>2</code></p>



<a name="274894859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274894859" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274894859">(Mar 10 2022 at 21:06)</a>:</h4>
<p>But it shouldn't</p>



<a name="274895829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274895829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274895829">(Mar 10 2022 at 21:15)</a>:</h4>
<p>Why? The equivalence class of 12 in the <code>mod 10</code> relation exists.</p>



<a name="274896132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274896132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274896132">(Mar 10 2022 at 21:18)</a>:</h4>
<p>You cant just say it shouldnt, this is how  numbers mod n work in mathematics, just because some other language has some other opinion on what <code>Fin</code> represents doesnt mean that we have to follow it</p>



<a name="274897271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274897271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274897271">(Mar 10 2022 at 21:28)</a>:</h4>
<p>I wasn't contradicting how mod worked. So it seems that <code>Fin n</code> represents a mod system of <code>n</code>.</p>



<a name="274901672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274901672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274901672">(Mar 10 2022 at 22:03)</a>:</h4>
<p>Also, by analogy with Lean3, an alternative possibility for <code>fin n</code> would probably be absorbing addition.  In particular <code>n + n</code> would typecheck and be equal to <code>n</code>.</p>



<a name="274901685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274901685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274901685">(Mar 10 2022 at 22:03)</a>:</h4>
<p>I do not think that there is in Lean something that does not typechecks when you are out of bounds.  The fact that functions need to be total seems an obstacle to "not typechecking sometimes".</p>



<a name="274902084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274902084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274902084">(Mar 10 2022 at 22:06)</a>:</h4>
<p>It is possible for lean 4 to have a type which only supports some numbers, although you have to do the computation in the typeclass system so that might not be great</p>



<a name="274903366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274903366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274903366">(Mar 10 2022 at 22:14)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Mathlib.Data.Nat.Basic</span>

<span class="kd">def</span> <span class="n">Fin'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Fin</span> <span class="n">n</span>

<span class="kd">class</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">Nat.succ_pos</span> <span class="n">_</span><span class="o">⟩</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="n">n</span><span class="o">)</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_not_le</span> <span class="k">fun</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)⟩</span>

<span class="k">#check</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="o">(</span><span class="mi">6</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
</code></pre></div>



<a name="274903681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274903681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274903681">(Mar 10 2022 at 22:17)</a>:</h4>
<p>I look forward to having ℕ subtraction being undefined when it should be negative!  <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="274903966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274903966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274903966">(Mar 10 2022 at 22:19)</a>:</h4>
<p>This doesn't work as well when the numbers aren't concrete, though. For nat subtraction that would be bad because you wouldn't be able to write <code>a - b</code>  where <code>a</code> and <code>b</code> are variables</p>



<a name="274904271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274904271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274904271">(Mar 10 2022 at 22:22)</a>:</h4>
<p>Sure, anyway, after the initial shock of being able to compute <code>3-4</code> to</p>
<ul>
<li>obtain a natural number,</li>
<li>and moreover the natural number <code>0</code></li>
</ul>
<p>i have grown used to it and would probably prefer the garbage values to pain involving typeclasses!</p>



<a name="274904567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274904567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274904567">(Mar 10 2022 at 22:25)</a>:</h4>
<p>At the beginning it seemed a little a joke: "I am formalizing mathematics to not make mistakes. For instance, I can prove that <code>2-4=0</code> and that <code>7/0=0</code>".</p>



<a name="274904587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274904587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274904587">(Mar 10 2022 at 22:25)</a>:</h4>
<p>Is there an implicit coercion from Nat to Fin n in Lean 3? I think this really only is an issue with numeric literals, since I don't think a coercion exists</p>



<a name="274904770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274904770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274904770">(Mar 10 2022 at 22:27)</a>:</h4>
<p>In the case of <code>Fin'</code> it's probably fine since as you say you would only care if you want to write a literal, and <code>1 : Fin n</code> doesn't make sense anyway (although I can imagine that being annoying if, say, <code>n</code> is a prime number)</p>



<a name="274904860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274904860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274904860">(Mar 10 2022 at 22:28)</a>:</h4>
<p>for nat subtraction it wouldn't really work though because the <code>Sub</code> typeclass is accessed whenever you have a <code>-</code> in the expression</p>



<a name="274922197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922197">(Mar 11 2022 at 01:52)</a>:</h4>
<p>Why are the bodies of the instances product types? <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> ?</p>



<a name="274922231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922231">(Mar 11 2022 at 01:53)</a>:</h4>
<p>Also, what does <code>OfNat (Fin' n) i</code> do</p>



<a name="274922240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922240">(Mar 11 2022 at 01:53)</a>:</h4>
<p>as well as the body of the instance. Im not really sure what any of those instances do</p>



<a name="274922288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922288">(Mar 11 2022 at 01:54)</a>:</h4>
<p>An <code>instance</code> is a proof/construction of an element of a <code>class</code>, which is a special kind of <code>structure</code>, which is essentially a generalized tuple type</p>



<a name="274922327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922327">(Mar 11 2022 at 01:55)</a>:</h4>
<p>In this case we are creating an inhabitant of <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OfNat#doc">docs4#OfNat</a></p>



<a name="274922459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922459">(Mar 11 2022 at 01:57)</a>:</h4>
<p>Actually, now that you mention it, I'm surprised that what I wrote typechecks. Normally I would have needed to write</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">[</span><span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="n">n</span><span class="o">)</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_not_le</span> <span class="k">fun</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)⟩⟩</span>
</code></pre></div>
<p>which is probably easier to explain</p>



<a name="274922507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922507">(Mar 11 2022 at 01:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> Did you know about this behavior?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">Inhabited</span> <span class="o">(</span><span class="n">Nat</span> <span class="bp">×</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">⟩</span>
</code></pre></div>



<a name="274922719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922719">(Mar 11 2022 at 02:00)</a>:</h4>
<p>But to get back to your question <span class="user-mention" data-user-id="467926">@Joseph O</span>: The instance has the form <code>⟨⟨i, h⟩⟩</code> where the first set of brackets is destructuring the <code>OfNat</code> class to produce a goal of <code>Fin' n</code>, and the second set is unpacking <code>Fin' n</code> which is defined to be <code>Fin n</code> (<a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin#doc">docs4#Fin</a>) which is a tuple of an element, here <code>i</code>, and a proof that <code>i &lt; n</code></p>



<a name="274922790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922790">(Mar 11 2022 at 02:01)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span>
</code></pre></div>
<p>here, pos just returns a proof that n is greater than 0?</p>



<a name="274922853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274922853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274922853">(Mar 11 2022 at 02:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274922719">said</a>:</p>
<blockquote>
<p>But to get back to your question <span class="user-mention silent" data-user-id="467926">Joseph O</span>: The instance has the form <code>⟨⟨i, h⟩⟩</code> where the first set of brackets is destructuring the <code>OfNat</code> class to produce a goal of <code>Fin' n</code>, and the second set is unpacking <code>Fin' n</code> which is defined to be <code>Fin n</code> (<a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin#doc">docs4#Fin</a>) which is a tuple of an element, here <code>i</code>, and a proof that <code>i &lt; n</code></p>
</blockquote>
<p>Would i understand this all better if i read TPIL4?</p>



<a name="274923011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274923011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274923011">(Mar 11 2022 at 02:04)</a>:</h4>
<p>The purpose of the instance <code>OfNat (Fin' n) i</code> is a signal to lean's parser. When you write <code>3 : Fin 5</code>, it expands the <code>3</code> to something like <code>OfNat.ofNat (nat_lit 3)</code> where <code>nat_lit 3</code> is a "raw" nat literal (these are primitive in the syntax) and <code>ofNat</code> has an additional hidden argument of type <code>OfNat (Fin' 5) (nat_lit 3)</code> that is inferred by typeclass inference. Since we have declared this <code>instance</code>, typeclass inference will try to apply it, resulting in the subgoal <code>IsPos (5 - 3)</code>. It will then try to unify this with <code>IsPos (Nat.succ ?n)</code>, and lean's unifier can solve the equation <code>5 - 3 = Nat.succ ?n</code> to <code>?n := 1</code>, so the numeral typechecks</p>



<a name="274923146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274923146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274923146">(Mar 11 2022 at 02:06)</a>:</h4>
<p><code>IsPos n</code> is a class which is equivalent to <code>0 &lt; n</code> (hence the name), but it is a <code>class</code> which means it can be used in typeclass inference. You can't have an argument like <code>instance [0 &lt; n] : MyClass (foo n)</code> directly</p>



<a name="274923190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274923190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274923190">(Mar 11 2022 at 02:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274922853">said</a>:</p>
<blockquote>
<p>Would i understand this all better if i read TPIL4?</p>
</blockquote>
<p>The answer is usually "yes" to this kind of question</p>



<a name="274924077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274924077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274924077">(Mar 11 2022 at 02:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274922719">said</a>:</p>
<blockquote>
<p>But to get back to your question <span class="user-mention silent" data-user-id="467926">Joseph O</span>: The instance has the form <code>⟨⟨i, h⟩⟩</code> where the first set of brackets is destructuring the <code>OfNat</code> class to produce a goal of <code>Fin' n</code>, and the second set is unpacking <code>Fin' n</code> which is defined to be <code>Fin n</code> (<a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin#doc">docs4#Fin</a>) which is a tuple of an element, here <code>i</code>, and a proof that <code>i &lt; n</code></p>
</blockquote>
<p>But why are you nesting tuples?</p>



<a name="274924359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274924359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274924359">(Mar 11 2022 at 02:27)</a>:</h4>
<p>Because <code>OfNat A i</code> is a tuple containing <code>A</code>, so <code>OfNat (Fin n) i</code> is a tuple containing <code>Fin n</code> which is itself a tuple containing a natural number and a proof that it is less than <code>n</code></p>



<a name="274924682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274924682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274924682">(Mar 11 2022 at 02:32)</a>:</h4>
<p>Why <code>[IsPos (n - i)]</code> in the last instance?</p>



<a name="274925164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925164">(Mar 11 2022 at 02:41)</a>:</h4>
<p>We want the typeclass problem to be solvable iff <code>i &lt; n</code>, so one way to do that without too many steps is to compute <code>n - i</code> and if it is nonzero then <code>i &lt; n</code></p>



<a name="274925368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925368">(Mar 11 2022 at 02:44)</a>:</h4>
<p>The set of things we can compute this way is somewhat limited, but natural number inequalities happen to be provable this way</p>



<a name="274925414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925414">(Mar 11 2022 at 02:45)</a>:</h4>
<p>we probably won't be able to have a type which only admits numerals which are prime numbers</p>



<a name="274925601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925601">(Mar 11 2022 at 02:49)</a>:</h4>
<p>But also, to be clear: this is totally an abuse of the typeclass and unification algorithms and I don't recommend it. There are better ways to do this with fewer downsides</p>



<a name="274925711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925711">(Mar 11 2022 at 02:50)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">notation</span> <span class="s2">"♯"</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="o">(⟨</span><span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">_</span><span class="o">)</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">3</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">4</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">5</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">6</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
</code></pre></div>



<a name="274925762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925762">(Mar 11 2022 at 02:51)</a>:</h4>
<p>That is clean</p>



<a name="274925820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925820">(Mar 11 2022 at 02:52)</a>:</h4>
<p>But Im not sure how I would utilize it with functions</p>



<a name="274925853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925853">(Mar 11 2022 at 02:53)</a>:</h4>
<p>This one works on primes too:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">isPrime</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">Bool</span> <span class="o">:=</span> <span class="n">Id.run</span> <span class="k">do</span>
  <span class="n">for</span> <span class="n">i</span> <span class="k">in</span> <span class="o">[</span><span class="mi">2</span><span class="o">:</span><span class="n">p</span><span class="o">]</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">p</span> <span class="bp">%</span> <span class="n">i</span> <span class="bp">==</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">return</span> <span class="n">false</span>
  <span class="n">return</span> <span class="n">p</span> <span class="bp">≠</span> <span class="mi">1</span>

<span class="kd">def</span> <span class="n">Prime</span> <span class="o">:=</span> <span class="o">{</span><span class="n">n</span> <span class="bp">//</span> <span class="n">isPrime</span> <span class="n">n</span><span class="o">}</span>
<span class="kd">notation</span> <span class="s2">"♯"</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="o">(⟨</span><span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">Prime</span><span class="o">)</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">3</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">4</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">5</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">6</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">12</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">37</span> <span class="c1">-- ok</span>
</code></pre></div>



<a name="274925962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925962">(Mar 11 2022 at 02:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274925601">said</a>:</p>
<blockquote>
<p>But also, to be clear: this is totally an abuse of the typeclass and unification algorithms and I don't recommend it. There are better ways to do this with fewer downsides</p>
</blockquote>
<p>I mean, I still wish I understood it. I will probably have to come back to this thread later on</p>



<a name="274925975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925975">(Mar 11 2022 at 02:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274925853">said</a>:</p>
<blockquote>
<p>This one works on primes too:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">isPrime</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">Bool</span> <span class="o">:=</span> <span class="n">Id.run</span> <span class="k">do</span>
  <span class="n">for</span> <span class="n">i</span> <span class="k">in</span> <span class="o">[</span><span class="mi">2</span><span class="o">:</span><span class="n">p</span><span class="o">]</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">p</span> <span class="bp">%</span> <span class="n">i</span> <span class="bp">==</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">return</span> <span class="n">false</span>
  <span class="n">return</span> <span class="n">p</span> <span class="bp">≠</span> <span class="mi">1</span>

<span class="kd">def</span> <span class="n">Prime</span> <span class="o">:=</span> <span class="o">{</span><span class="n">n</span> <span class="bp">//</span> <span class="n">isPrime</span> <span class="n">n</span><span class="o">}</span>
<span class="kd">notation</span> <span class="s2">"♯"</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="o">(⟨</span><span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">Prime</span><span class="o">)</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">3</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">4</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">5</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">6</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">12</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="bp">♯</span><span class="mi">37</span> <span class="c1">-- ok</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Why do you need to use the do dsl?</p>



<a name="274925982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274925982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274925982">(Mar 11 2022 at 02:56)</a>:</h4>
<p>Here is an approach using only functions instead of notation:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">Fin.mk'</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">)</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">n</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">Fin.mk'</span> <span class="mi">3</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">Fin.mk'</span> <span class="mi">4</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">Fin.mk'</span> <span class="mi">5</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">Fin.mk'</span> <span class="mi">6</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
</code></pre></div>



<a name="274926026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926026">(Mar 11 2022 at 02:56)</a>:</h4>
<p>Interesting</p>



<a name="274926035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926035">(Mar 11 2022 at 02:56)</a>:</h4>
<p>what does <code>by decide</code> tactic do?</p>



<a name="274926043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926043">(Mar 11 2022 at 02:56)</a>:</h4>
<p>I don't need the do DSL, I use it because it is nice but you can write the same loop in other ways</p>



<a name="274926068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926068">(Mar 11 2022 at 02:57)</a>:</h4>
<p>The <code>by decide</code> tactic proves any decidable proposition that evaluates to <code>true</code></p>



<a name="274926127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926127">(Mar 11 2022 at 02:58)</a>:</h4>
<p>In this case the purpose of the <code>isPrime</code> function was to give an implementation that can be executed to determine primality of a number suitable for <code>by decide</code></p>



<a name="274926140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926140">(Mar 11 2022 at 02:58)</a>:</h4>
<p>decidable propositions are also marked by a typeclass <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Decidable#doc">docs4#Decidable</a></p>



<a name="274926189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926189">(Mar 11 2022 at 02:59)</a>:</h4>
<p>basically, a decidable proposition is one equivalent to a (computable) <code>Bool</code> value</p>



<a name="274926333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926333">(Mar 11 2022 at 03:01)</a>:</h4>
<p>and all the basic stuff like <code>a &lt; b</code> on natural numbers is decidable so lean knows how to evaluate it even though syntactically it has type <code>Prop</code> not <code>Bool</code></p>



<a name="274926428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926428">(Mar 11 2022 at 03:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274925711">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">notation</span> <span class="s2">"♯"</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="o">(⟨</span><span class="n">n</span><span class="o">,</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">_</span><span class="o">)</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">3</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">4</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- ok</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">5</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
<span class="k">#check</span> <span class="o">(</span><span class="bp">♯</span><span class="mi">6</span> <span class="o">:</span> <span class="n">Fin</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">-- fail</span>
</code></pre></div><br>
</p>
</blockquote>
<p>So fin has an instance of Decidable?</p>



<a name="274926450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926450">(Mar 11 2022 at 03:02)</a>:</h4>
<p><code>Prop</code>s in general can be undecidable, for example</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">isTwinPrime</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">isPrime</span> <span class="n">p</span> <span class="bp">&amp;&amp;</span> <span class="n">isPrime</span> <span class="o">(</span><span class="n">p</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span>

<span class="k">#check</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">p</span><span class="o">,</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">p</span> <span class="bp">∧</span> <span class="n">isTwinPrime</span> <span class="n">p</span>
</code></pre></div>
<p>If you find a way to decide this proposition you will win fame and fortune</p>



<a name="274926477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926477">(Mar 11 2022 at 03:03)</a>:</h4>
<p>Not Fin, the thing being decided there are propositions like <code>3 &lt; 5</code> and <code>5 &lt; 5</code></p>



<a name="274926567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274926567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274926567">(Mar 11 2022 at 03:05)</a>:</h4>
<p>If you replace <code>by decide</code> with <code>by {}</code>, lean will give an error showing the proposition it is trying to solve</p>



<a name="274927496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274927496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274927496">(Mar 11 2022 at 03:25)</a>:</h4>
<p><a href="/user_uploads/3121/-TRBBm9WalyB8QWEF7K63UOH/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/-TRBBm9WalyB8QWEF7K63UOH/image.png" title="image.png"><img src="/user_uploads/3121/-TRBBm9WalyB8QWEF7K63UOH/image.png"></a></div>



<a name="274928052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274928052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274928052">(Mar 11 2022 at 03:37)</a>:</h4>
<p>I would like to start from the beginning. What is this typeclass instance doing, and also what really is the purpose of <code>IsPos</code>, </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">Nat.succ_pos</span> <span class="n">_</span><span class="o">⟩</span>
</code></pre></div>



<a name="274928061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274928061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274928061">(Mar 11 2022 at 03:37)</a>:</h4>
<p>I feel like this would be useful for me in the future</p>



<a name="274928087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274928087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274928087">(Mar 11 2022 at 03:37)</a>:</h4>
<p>No need to explain the second instance a second time.</p>



<a name="274928132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274928132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274928132">(Mar 11 2022 at 03:38)</a>:</h4>
<p>But I will try to utilize the simpler solutions</p>



<a name="274929983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274929983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274929983">(Mar 11 2022 at 04:12)</a>:</h4>
<p>The typeclass instance makes it so that when lean wants to solve a problem of the form <code>IsPos (Nat.succ ?n)</code>, it will find that proof. For example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">foo</span> <span class="o">[</span><span class="n">IsPos</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="mi">2</span><span class="o">)]</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="k">#check</span> <span class="n">foo</span>
</code></pre></div>
<p>Writing <code>foo</code> here elaborates to <code>@foo _</code> where the <code>_</code> is a proof of <code>IsPos (Nat.succ 2)</code>, and we are asking the typeclass inference system to go find a proof using the declared instances. It will come back with <code>myInst 2</code>, assuming that the name of that instance was <code>myInst</code> (it has an automatically generated name, but you can name it with <code>instance myInst : IsPos (Nat.succ n) := ⟨Nat.succ_pos _⟩</code>).</p>



<a name="274930007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274930007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274930007">(Mar 11 2022 at 04:13)</a>:</h4>
<p>The purpose of the <code>IsPos</code> typeclass is to make it so that typeclass inference can solve problems of the form "is this a nonzero natural number?"</p>



<a name="274930087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274930087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274930087">(Mar 11 2022 at 04:14)</a>:</h4>
<p>The second instance makes use of this class to ask "is <code>n - i</code> a nonzero natural number?", which is equivalent to "Is <code>i &lt; n</code>?"</p>



<a name="274930184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274930184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274930184">(Mar 11 2022 at 04:16)</a>:</h4>
<p>The point is that we are trying to get typeclass inference to answer this "Is <code>i &lt; n</code>?" question because this is the necessary component to make fin numerals work the way you expect: we want <code>3 : Fin 5</code> to work but not <code>5 : Fin 3</code>, and in general <code>i : Fin n</code> for numerals <code>i</code> and <code>n</code> should work exactly when <code>i &lt; n</code></p>



<a name="274967953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274967953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274967953">(Mar 11 2022 at 12:29)</a>:</h4>
<p>Ah thanks</p>



<a name="274987111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274987111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274987111">(Mar 11 2022 at 15:05)</a>:</h4>
<p>how would I go about fixing this error?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="kd">instance</span>
  <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="mi">0</span>
</code></pre></div>



<a name="274989279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/274989279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#274989279">(Mar 11 2022 at 15:22)</a>:</h4>
<p>Make the instance :-) We have it in Lean 3:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">succ</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span> <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">succ_pos</span> <span class="n">n</span><span class="o">⟩⟩</span>
</code></pre></div>



<a name="275010585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275010585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275010585">(Mar 11 2022 at 18:02)</a>:</h4>
<p>Thanks. I will just translate that to Lean 4.</p>



<a name="275010918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275010918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275010918">(Mar 11 2022 at 18:05)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">HasZero</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">Nat.succ_pos</span> <span class="n">n</span><span class="o">⟩⟩</span>
</code></pre></div>
<p>it has a different name in lean 4?</p>



<a name="275010948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275010948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275010948">(Mar 11 2022 at 18:05)</a>:</h4>
<p>I don't know whether the Lean 4 type class inference system will be smart enough to know that <code>length(a::as)=succ(something)</code> either</p>



<a name="275010982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275010982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275010982">(Mar 11 2022 at 18:05)</a>:</h4>
<p>Yeah, in Lean 4 you use this <code>OfNat</code> thing instead. I don't know the details of that either.</p>



<a name="275013051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275013051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275013051">(Mar 11 2022 at 18:21)</a>:</h4>
<p>well that didnt exactly work</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">Nat.succ_pos</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">))⟩⟩</span>
</code></pre></div>



<a name="275015604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275015604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275015604">(Mar 11 2022 at 18:42)</a>:</h4>
<p>How would I go about making this instance?</p>



<a name="275015884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275015884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275015884">(Mar 11 2022 at 18:44)</a>:</h4>
<p>I'm late to this thread and not a Lean 4 expert; can you post a mwe? I don't even know what <code>Fin'</code> is.</p>



<a name="275017679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275017679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275017679">(Mar 11 2022 at 18:56)</a>:</h4>
<p>Here you go</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Mathlib.Data.Nat.Basic</span>

<span class="kd">def</span> <span class="n">Fin'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Fin</span> <span class="n">n</span>

<span class="kd">class</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">Nat.succ_pos</span> <span class="n">_</span><span class="o">⟩</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="n">n</span><span class="o">)</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_not_le</span> <span class="k">fun</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)⟩</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">))⟩⟩</span>
</code></pre></div>



<a name="275022609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275022609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275022609">(Mar 11 2022 at 19:29)</a>:</h4>
<p>That doesn't work because you never told Lean the type of <code>as</code>.</p>



<a name="275022818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275022818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275022818">(Mar 11 2022 at 19:31)</a>:</h4>
<p>and when you do, it doesn't work for the reason that the error explains: right you the second component of <code>⟨0, _⟩</code> is the statement <code>0 &lt; length...</code>, as opposed to its proof.</p>



<a name="275022963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275022963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275022963">(Mar 11 2022 at 19:32)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variable</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>
</code></pre></div>



<a name="275023913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275023913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275023913">(Mar 11 2022 at 19:41)</a>:</h4>
<p>Ah thank you</p>



<a name="275024132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275024132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275024132">(Mar 11 2022 at 19:42)</a>:</h4>
<p>Now that the instance is made, the error should go away in this function, but it isn't</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">List.get''</span> <span class="o">[</span><span class="n">OfNat</span> <span class="n">i</span> <span class="mi">0</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">nil</span><span class="o">,</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">False.elim</span> <span class="bp">$</span> <span class="n">Nat.not_lt_zero</span> <span class="n">_</span> <span class="n">_</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="n">a</span> <span class="n">as</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="n">a</span>
</code></pre></div>



<a name="275024151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275024151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275024151">(Mar 11 2022 at 19:43)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="kd">instance</span>
  <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="mi">0</span>
</code></pre></div>



<a name="275024434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275024434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275024434">(Mar 11 2022 at 19:45)</a>:</h4>
<p>Rotten luck -- type class inference can't find it, by the looks of things. I know nothing about how Lean 4 type class inference works I'm afraid</p>



<a name="275024890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275024890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275024890">(Mar 11 2022 at 19:48)</a>:</h4>
<p>Hint: you need to write <code>instance : OfNat (Fin' (List.length (a :: as))) (nat_lit 0)</code></p>



<a name="275025273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275025273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275025273">(Mar 11 2022 at 19:51)</a>:</h4>
<p><code>[OfNat i 0]</code> looks like nonsense -- maybe remove it?</p>



<a name="275030493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275030493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275030493">(Mar 11 2022 at 20:35)</a>:</h4>
<p>Ah yeah. That was part of my previous attempts.</p>



<a name="275030689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275030689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275030689">(Mar 11 2022 at 20:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275024890">said</a>:</p>
<blockquote>
<p>Hint: you need to write <code>instance : OfNat (Fin' (List.length (a :: as))) (nat_lit 0)</code></p>
</blockquote>
<p>Why did that fix it though?</p>



<a name="275031050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275031050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275031050">(Mar 11 2022 at 20:40)</a>:</h4>
<p>Also, now the function </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">List.get''</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">nil</span><span class="o">,</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">False.elim</span> <span class="bp">$</span> <span class="n">Nat.not_lt_zero</span> <span class="n">_</span> <span class="n">_</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span> <span class="bp">=&gt;</span> <span class="n">as.get''</span> <span class="n">i</span>
</code></pre></div>
<p>has the error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="kd">instance</span>
  <span class="n">HAdd</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="bp">?</span><span class="n">m.1019</span>
</code></pre></div>



<a name="275037984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275037984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275037984">(Mar 11 2022 at 21:48)</a>:</h4>
<p>You know what to do then :-)</p>



<a name="275038331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275038331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275038331">(Mar 11 2022 at 21:50)</a>:</h4>
<p>You understand the error, right? You defined <code>Fin'</code> so it's now your problem. If <code>i : Fin' n</code> then what does <code>i + 1</code> mean? No idea -- you didn't tell me what + meant, or what 1 meant.</p>



<a name="275067035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275067035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275067035">(Mar 12 2022 at 00:40)</a>:</h4>
<p>I see. I think i have a fix</p>



<a name="275067230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275067230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275067230">(Mar 12 2022 at 00:44)</a>:</h4>
<p><a href="/user_uploads/3121/_H5aGosLdBgCH5M6igINI3Cn/image.png">image.png</a> Well thats strange. How do people match on <code>Nat.succ i</code> then.</p>
<div class="message_inline_image"><a href="/user_uploads/3121/_H5aGosLdBgCH5M6igINI3Cn/image.png" title="image.png"><img src="/user_uploads/3121/_H5aGosLdBgCH5M6igINI3Cn/image.png"></a></div>



<a name="275067246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275067246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275067246">(Mar 12 2022 at 00:45)</a>:</h4>
<p>Also, for a MWE, </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">Fin'.succ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">k</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Fin.succ</span> <span class="n">n</span>
</code></pre></div>



<a name="275090779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275090779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275090779">(Mar 12 2022 at 11:01)</a>:</h4>
<p>Fin.succ is not a constructor of the Fin datatype (whcih you could see by looking at its definition) thus it and any further definition cannot just be matched upon like this.</p>



<a name="275097393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275097393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275097393">(Mar 12 2022 at 13:36)</a>:</h4>
<p>then, what alternative solutions lie?</p>



<a name="275098168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275098168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275098168">(Mar 12 2022 at 13:55)</a>:</h4>
<p><span class="user-mention" data-user-id="467926">@Joseph O</span> Note that in other systems (e.g, Agda and Idris), <code>Fin n</code> is an inductive datatype with two constructors. In Lean, it is essentially a subtype of <code>Nat</code>, i.e, a pair containing: a <code>Nat</code>, and a proof that it is smaller than <code>n</code>. You can use <code>match</code> to "access" this structure. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">get</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span>   <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">get</span> <span class="n">as</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>
</code></pre></div>
<p>Here is the same definition without the anonymous constructor notation.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">get</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="n">Fin.mk</span> <span class="mi">0</span> <span class="n">_</span>     <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="n">Fin.mk</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">get</span> <span class="n">as</span> <span class="o">(</span><span class="n">Fin.mk</span> <span class="n">i</span> <span class="o">(</span><span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">))</span>
</code></pre></div>
<p>We can also define <code>Fin n</code> as it is defined in other systems and then match on <code>Fin.succ</code>. Example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">Ex</span> <span class="c1">-- Using namespace `Ex` to avoid name collision with the Lean `Fin`</span>

<span class="kd">inductive</span> <span class="n">Fin</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Type</span>
  <span class="bp">|</span> <span class="n">zero</span> <span class="o">:</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span>
  <span class="bp">|</span> <span class="n">succ</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Fin</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span>
  <span class="n">deriving</span> <span class="n">Repr</span>

<span class="kd">def</span> <span class="n">get</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="n">Fin.zero</span>   <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="n">Fin.succ</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">get</span> <span class="n">as</span> <span class="n">i</span>

<span class="kd">end</span> <span class="n">Ex</span>
</code></pre></div>



<a name="275111364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111364">(Mar 12 2022 at 18:55)</a>:</h4>
<p>Ah i see. Tho, it would still be the wrapping version I think</p>



<a name="275111439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111439">(Mar 12 2022 at 18:57)</a>:</h4>
<p>Also, why did you decide not to consider the <code>| nil,  i</code> case anymore?</p>



<a name="275111497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111497">(Mar 12 2022 at 18:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111364">said</a>:</p>
<blockquote>
<p>Ah i see. Tho, it would still be the wrapping version I think</p>
</blockquote>
<p>You can still use the wrapping if you want</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">Fin'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Fin</span> <span class="n">n</span>

<span class="kd">def</span> <span class="n">get</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span>   <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">get</span> <span class="n">as</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>
</code></pre></div>



<a name="275111511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111511">(Mar 12 2022 at 18:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111439">said</a>:</p>
<blockquote>
<p>Also, why did you decide not to consider the <code>| nil,  i</code> case anymore?</p>
</blockquote>
<p>Lean 4 can prove it is unreachable.</p>



<a name="275111543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111543">(Mar 12 2022 at 18:59)</a>:</h4>
<p>But it is reachable? Like what if someone gives <code>List.get [] 8</code></p>



<a name="275111740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111740">(Mar 12 2022 at 19:01)</a>:</h4>
<p>Also, I have this error again, <code>failed to synthesize instance
  OfNat (Fin' (List.length [1, 5, 4])) 7</code></p>



<a name="275111805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111805">(Mar 12 2022 at 19:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111543">said</a>:</p>
<blockquote>
<p>But it is reachable? Like what if someone gives <code>List.get [] 8</code></p>
</blockquote>
<p>It is not. You will not be able to do that. The type <code>Fin [].length</code> is not inhabited.</p>



<a name="275111807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111807">(Mar 12 2022 at 19:02)</a>:</h4>
<p>That would mean they are passing an element of type <code>Fin 0</code> and that is equivalent to the emtpy type and thus impossible to do</p>



<a name="275111878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111878">(Mar 12 2022 at 19:04)</a>:</h4>
<p>Empty type. Ok i see.</p>



<a name="275111882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111882">(Mar 12 2022 at 19:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112857">Leonardo de Moura</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111511">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111439">said</a>:</p>
<blockquote>
<p>Also, why did you decide not to consider the <code>| nil,  i</code> case anymore?</p>
</blockquote>
<p>Lean 4 can prove it is unreachable.</p>
</blockquote>
<p>This is also a thing that I've been wondering about for a bit, how does it actually automagically construct this proof? Can you explain it/point me to the implementation?</p>



<a name="275111883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111883">(Mar 12 2022 at 19:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111740">said</a>:</p>
<blockquote>
<p>Also, I have this error again, <code>failed to synthesize instance
  OfNat (Fin' (List.length [1, 5, 4])) 7</code></p>
</blockquote>
<p>I did not add <code>OfNat</code> instances in my example.  I just showed you how to define the <code>get</code> function.</p>



<a name="275111897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111897">(Mar 12 2022 at 19:04)</a>:</h4>
<p>Right but I already have the OfNat instance</p>



<a name="275111904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111904">(Mar 12 2022 at 19:05)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">nat_lit</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>
</code></pre></div>



<a name="275111919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111919">(Mar 12 2022 at 19:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111882">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="112857">Leonardo de Moura</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111511">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111439">said</a>:</p>
<blockquote>
<p>Also, why did you decide not to consider the <code>| nil,  i</code> case anymore?</p>
</blockquote>
<p>Lean 4 can prove it is unreachable.</p>
</blockquote>
<p>This is also a thing that I've been wondering about for a bit, how does it actually automagically construct this proof? Can you explain it/point me to the implementation?</p>
</blockquote>
<p><a href="https://github.com/leanprover/lean4/blob/master/src/Lean/Meta/Match/Match.lean#L148-L152">https://github.com/leanprover/lean4/blob/master/src/Lean/Meta/Match/Match.lean#L148-L152</a></p>



<a name="275111970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111970">(Mar 12 2022 at 19:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111904">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">nat_lit</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>
</code></pre></div><br>
</p>
</blockquote>
<p>This instance is for <code>0</code> only.</p>



<a name="275111981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275111981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275111981">(Mar 12 2022 at 19:06)</a>:</h4>
<p>That looks quite a lot easier than I imagined <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span></p>



<a name="275112068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275112068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275112068">(Mar 12 2022 at 19:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112857">Leonardo de Moura</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111970">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275111904">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">nat_lit</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>
</code></pre></div><br>
</p>
</blockquote>
<p>This instance is for <code>0</code> only.</p>
</blockquote>
<p>Well, does that mean I have to do it manually for every literal?</p>



<a name="275112661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275112661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275112661">(Mar 12 2022 at 19:21)</a>:</h4>
<p><span class="user-mention" data-user-id="467926">@Joseph O</span> I did not read the whole thread. I think this kind of instance is not the way to go. You could add another instance for the <code>Nat.succ</code> case, but I see it as an abuse of the typeclass mechanism. Moreover, you will have to do it for many other functions. These two are for <code>List.length</code>. <code>Fin</code> is like a subtype. So we often have to synthesize proofs. We can use tactics to synthesize the proofs.  Example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="n">get</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="kd">by</span> <span class="n">decide</span><span class="o">⟩</span>
</code></pre></div>
<p>We can also create helper notation if we have to do it a lot.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">notation</span> <span class="s2">"#("</span> <span class="n">a</span> <span class="s2">")"</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">Fin.mk</span> <span class="n">a</span> <span class="o">(</span><span class="kd">by</span> <span class="n">decide</span><span class="o">))</span>

<span class="k">#eval</span> <span class="n">get</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="bp">#</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="k">#eval</span> <span class="n">get</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="bp">#</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="k">#eval</span> <span class="n">get</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="bp">#</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="k">#eval</span> <span class="n">get</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="bp">#</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="c1">-- Error</span>
</code></pre></div>



<a name="275122850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275122850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275122850">(Mar 12 2022 at 23:48)</a>:</h4>
<p>Ah cool, thanks</p>



<a name="275126649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275126649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275126649">(Mar 13 2022 at 01:37)</a>:</h4>
<p>So i rewrote my nth function with this new <code>Fin'</code>, </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">nth</span> <span class="o">{</span><span class="n">αs</span> <span class="o">:</span> <span class="n">List</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">:</span> <span class="n">HList</span> <span class="n">αs</span> <span class="bp">→</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">αs.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">αs.get'</span> <span class="n">n</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="n">x</span> <span class="n">xs</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">x</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="n">x</span> <span class="n">xs</span><span class="o">,</span> <span class="o">⟨</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">xs.nth</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>
</code></pre></div>
<p>but, <br>
when i try to run</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="bp">⟪</span><span class="mi">1</span><span class="o">,</span><span class="s2">"2"</span><span class="o">,</span><span class="mi">3</span><span class="bp">.</span><span class="mi">0</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</code></pre></div>
<p>, it gives this error </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">expression</span>
  <span class="n">nth</span> <span class="o">(</span><span class="mi">1</span><span class="bp">!!</span><span class="s2">"2"</span><span class="bp">!!</span><span class="mi">3</span><span class="bp">.</span><span class="mi">0</span><span class="bp">!!</span><span class="n">unit</span><span class="o">)</span> <span class="o">{</span> <span class="n">val</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">isLt</span> <span class="o">:=</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">&lt;</span> <span class="n">List.length</span> <span class="o">[</span><span class="n">ℕ</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Float</span><span class="o">])</span> <span class="o">}</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">List.get'</span> <span class="o">[</span><span class="n">ℕ</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Float</span><span class="o">]</span> <span class="o">{</span> <span class="n">val</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">isLt</span> <span class="o">:=</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">&lt;</span> <span class="n">List.length</span> <span class="o">[</span><span class="n">ℕ</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Float</span><span class="o">])</span> <span class="o">}</span>
<span class="n">but</span> <span class="kd">instance</span>
  <span class="n">Lean.MetaEval</span> <span class="o">(</span><span class="n">List.get'</span> <span class="o">[</span><span class="n">ℕ</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Float</span><span class="o">]</span> <span class="o">{</span> <span class="n">val</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">isLt</span> <span class="o">:=</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">&lt;</span> <span class="n">List.length</span> <span class="o">[</span><span class="n">ℕ</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Float</span><span class="o">])</span> <span class="o">})</span>
<span class="n">failed</span> <span class="n">to</span> <span class="n">be</span> <span class="n">synthesized</span><span class="o">,</span> <span class="n">this</span> <span class="kd">instance</span> <span class="n">instructs</span> <span class="n">Lean</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="n">display</span> <span class="n">the</span> <span class="n">resulting</span> <span class="n">value</span><span class="o">,</span> <span class="n">recall</span> <span class="n">that</span> <span class="n">any</span> <span class="n">type</span> <span class="n">implementing</span> <span class="n">the</span> <span class="bp">`</span><span class="n">Repr</span><span class="bp">`</span> <span class="kd">class</span> <span class="n">also</span> <span class="n">implements</span> <span class="n">the</span> <span class="bp">`</span><span class="n">Lean.MetaEval</span><span class="bp">`</span> <span class="kd">class</span>
</code></pre></div>



<a name="275128564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275128564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275128564">(Mar 13 2022 at 02:31)</a>:</h4>
<p>What's the definition of <code>List.get'</code>? <a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>



<a name="275129620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275129620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275129620">(Mar 13 2022 at 03:02)</a>:</h4>
<p>(deleted)</p>



<a name="275129845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275129845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275129845">(Mar 13 2022 at 03:08)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">List.get'</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin'</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">as.get'</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>
<span class="bp">```</span>
</code></pre></div>



<a name="275130048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275130048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275130048">(Mar 13 2022 at 03:14)</a>:</h4>
<p>The error message says you need to tell Lean how to display/print the result.</p>



<a name="275130294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275130294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275130294">(Mar 13 2022 at 03:21)</a>:</h4>
<p><span class="user-mention" data-user-id="467926">@Joseph O</span> During typeclass resolution, Lean only unfolds definitions tagged as <code>[reducible]</code>. The motivation is to control the cost of this procedure. The result type of your example depends on <code>List.get'</code>. Thus, Lean fails to build the <code>Repr</code> instance for the type. Here is a working example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">HList</span> <span class="o">:</span> <span class="n">List</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>
  <span class="bp">|</span> <span class="n">nil</span>  <span class="o">:</span> <span class="n">HList</span> <span class="o">[]</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">HList</span> <span class="n">αs</span> <span class="bp">→</span> <span class="n">HList</span> <span class="o">(</span><span class="n">α</span><span class="o">::</span><span class="n">αs</span><span class="o">)</span>

<span class="kd">@[reducible]</span> <span class="kd">def</span> <span class="n">List.get'</span> <span class="o">:</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">as.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span>   <span class="bp">=&gt;</span> <span class="n">a</span>
  <span class="bp">|</span> <span class="n">a</span><span class="o">::</span><span class="n">as</span><span class="o">,</span> <span class="o">⟨</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">get'</span> <span class="n">as</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>

<span class="kd">def</span> <span class="n">HList.nth</span> <span class="o">:</span> <span class="n">HList</span> <span class="n">αs</span> <span class="bp">→</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Fin</span> <span class="n">αs.length</span><span class="o">)</span> <span class="bp">→</span> <span class="n">αs.get'</span> <span class="n">n</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="n">x</span> <span class="n">xs</span><span class="o">,</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span>   <span class="bp">=&gt;</span> <span class="n">x</span>
  <span class="bp">|</span> <span class="n">cons</span> <span class="n">x</span> <span class="n">xs</span><span class="o">,</span> <span class="o">⟨</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">xs.nth</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">Nat.lt_of_succ_lt_succ</span> <span class="n">h</span><span class="o">⟩</span>

<span class="kd">notation</span> <span class="s2">"#("</span> <span class="n">a</span> <span class="s2">")"</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">Fin.mk</span> <span class="n">a</span> <span class="o">(</span><span class="kd">by</span> <span class="n">decide</span><span class="o">))</span>

<span class="n">syntax</span> <span class="s2">"⟪"</span> <span class="n">term</span><span class="o">,</span><span class="bp">*</span> <span class="s2">"⟫"</span>  <span class="o">:</span> <span class="n">term</span>

<span class="n">macro_rules</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="bp">⟪</span> <span class="bp">⟫</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">HList.nil</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="bp">⟪</span> <span class="bp">$</span><span class="n">a</span> <span class="bp">⟫</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">HList.cons</span> <span class="bp">$</span><span class="n">a</span> <span class="n">HList.nil</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="bp">⟪</span> <span class="bp">$</span><span class="n">a</span><span class="o">,</span> <span class="bp">$</span><span class="n">as</span><span class="o">,</span><span class="bp">*</span> <span class="bp">⟫</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">HList.cons</span> <span class="bp">$</span><span class="n">a</span> <span class="bp">⟪$</span><span class="n">as</span><span class="o">,</span><span class="bp">*⟫</span><span class="o">)</span>

<span class="k">#eval</span> <span class="bp">⟪</span><span class="mi">10</span><span class="o">,</span> <span class="n">true</span><span class="o">,</span> <span class="mi">20</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<span class="k">#eval</span> <span class="bp">⟪</span><span class="mi">10</span><span class="o">,</span> <span class="n">true</span><span class="o">,</span> <span class="mi">20</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="k">#eval</span> <span class="bp">⟪</span><span class="mi">10</span><span class="o">,</span> <span class="n">true</span><span class="o">,</span> <span class="mi">20</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</code></pre></div>



<a name="275131125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275131125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275131125">(Mar 13 2022 at 03:45)</a>:</h4>
<p>Another trick you can use is to tell Lean what type containing the <code>List.get'</code> reduces too. The type checker will make sure you provided the correct type.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="n">id</span> <span class="o">(</span><span class="n">α</span> <span class="o">:=</span> <span class="n">String</span><span class="o">)</span> <span class="o">(</span><span class="bp">⟪</span><span class="mi">1</span><span class="o">,</span><span class="s2">"2"</span><span class="o">,</span><span class="mi">3</span><span class="bp">.</span><span class="mi">0</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</code></pre></div>
<p>You can also define your own identity function where all arguments are explicit.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">the</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">a</span>

<span class="k">#eval</span> <span class="n">the</span> <span class="n">String</span> <span class="o">(</span><span class="bp">⟪</span><span class="mi">1</span><span class="o">,</span><span class="s2">"2"</span><span class="o">,</span><span class="mi">3</span><span class="bp">.</span><span class="mi">0</span><span class="bp">⟫.</span><span class="n">nth</span> <span class="bp">#</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</code></pre></div>



<a name="275131646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275131646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275131646">(Mar 13 2022 at 04:00)</a>:</h4>
<p>I pushed a small improvement to the <code>#eval</code> command. Now, when it fails to construct the <code>MetaEval</code> instance, it reduces the result type and tries again. The next nighly build should have this improvement, and your example will work without any tricks.</p>



<a name="275131830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275131830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275131830">(Mar 13 2022 at 04:03)</a>:</h4>
<p>I also added this example to the test suite: <a href="https://github.com/leanprover/lean4/blob/master/tests/lean/run/hlistOverload.lean">https://github.com/leanprover/lean4/blob/master/tests/lean/run/hlistOverload.lean</a></p>



<a name="275150812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275150812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275150812">(Mar 13 2022 at 12:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112857">Leonardo de Moura</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275131830">said</a>:</p>
<blockquote>
<p>I also added this example to the test suite: <a href="https://github.com/leanprover/lean4/blob/master/tests/lean/run/hlistOverload.lean">https://github.com/leanprover/lean4/blob/master/tests/lean/run/hlistOverload.lean</a></p>
</blockquote>
<p>Im honored, though how were you still able to use the brackets? I remember when I was creating the macro, it would give me an error saying that <code>[]</code> was already taken</p>



<a name="275150968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275150968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275150968">(Mar 13 2022 at 12:28)</a>:</h4>
<p>ah, you gave it a name. Got it. Ive always wanted to use the brackets</p>



<a name="275150997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275150997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275150997">(Mar 13 2022 at 12:29)</a>:</h4>
<p>Ah, its actually the <code>kind</code> tag.</p>



<a name="275151002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275151002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275151002">(Mar 13 2022 at 12:29)</a>:</h4>
<p>I will keep that in mind for my future macros, thanks</p>



<a name="275159502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275159502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275159502">(Mar 13 2022 at 15:14)</a>:</h4>
<p>Do you mind explaining why this error? <a href="/user_uploads/3121/ir97eyHX-2u9mwgvHGPLOm6F/image.png">image.png</a> <br>
it has to do with using HList</p>
<div class="message_inline_image"><a href="/user_uploads/3121/ir97eyHX-2u9mwgvHGPLOm6F/image.png" title="image.png"><img src="/user_uploads/3121/ir97eyHX-2u9mwgvHGPLOm6F/image.png"></a></div>



<a name="275160530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160530">(Mar 13 2022 at 15:38)</a>:</h4>
<p>Does the notation work outside of <code>match</code>? For instance, in <code>#check [1, "2"]</code>?</p>



<a name="275160566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160566">(Mar 13 2022 at 15:39)</a>:</h4>
<p>Might it be because there is some <code>ToString</code> instance for <code>Nat</code>? (just guessing)</p>



<a name="275160634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160634">(Mar 13 2022 at 15:40)</a>:</h4>
<p><a href="/user_uploads/3121/LNRXjtQDtHHKrP1POkk2LFT9/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/LNRXjtQDtHHKrP1POkk2LFT9/image.png" title="image.png"><img src="/user_uploads/3121/LNRXjtQDtHHKrP1POkk2LFT9/image.png"></a></div>



<a name="275160698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160698">(Mar 13 2022 at 15:42)</a>:</h4>
<p>And the same if you don't explicitely annotate the type in <code>check</code>?</p>



<a name="275160814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160814">(Mar 13 2022 at 15:45)</a>:</h4>
<p>It can't decide whether Im refering to list or hlist <a href="/user_uploads/3121/qiwSBat_Y19o0BZZu5kex2Q5/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/qiwSBat_Y19o0BZZu5kex2Q5/image.png" title="image.png"><img src="/user_uploads/3121/qiwSBat_Y19o0BZZu5kex2Q5/image.png"></a></div>



<a name="275160818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160818">(Mar 13 2022 at 15:45)</a>:</h4>
<p>Or maybe a better experiment to test the <code>ToString</code> speculation, would <code>#check ([1, "2"] : List String)</code> also work? (I'm not really sure that what I'm saying makes sense)</p>



<a name="275160864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160864">(Mar 13 2022 at 15:46)</a>:</h4>
<p>Oh, so it seems that's it then</p>



<a name="275160877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160877">(Mar 13 2022 at 15:46)</a>:</h4>
<p>1 can be implicitely converted to the String "1"</p>



<a name="275160880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275160880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275160880">(Mar 13 2022 at 15:46)</a>:</h4>
<p>Same error <a href="/user_uploads/3121/nHUpMASmrJvJvDdv_c5ztUEL/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/nHUpMASmrJvJvDdv_c5ztUEL/image.png" title="image.png"><img src="/user_uploads/3121/nHUpMASmrJvJvDdv_c5ztUEL/image.png"></a></div>



<a name="275161126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275161126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275161126">(Mar 13 2022 at 15:53)</a>:</h4>
<p>Maybe if you write <code>(1 : Nat)</code> inside the list notation? Though I'm skeptical, it is probably the same thing</p>



<a name="275161181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275161181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275161181">(Mar 13 2022 at 15:54)</a>:</h4>
<p>Sorry, I don't know how to fix this, we'll have to wait for someone who knows better. At least it seems that we've figured out the root cause</p>



<a name="275161969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275161969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275161969">(Mar 13 2022 at 16:09)</a>:</h4>
<p><span class="user-mention" data-user-id="467926">@Joseph O</span>  You have to get the most recent nightly build. The support for overloaded notations in patterns has been implemented a few days ago.</p>



<a name="275161975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275161975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275161975">(Mar 13 2022 at 16:09)</a>:</h4>
<p>Ah I see. Let me update.</p>



<a name="275162047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162047">(Mar 13 2022 at 16:11)</a>:</h4>
<p>Huh, seems like im on the latest.</p>



<a name="275162099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162099">(Mar 13 2022 at 16:12)</a>:</h4>
<p><code>leanprover/lean4:nightly-2022-03-09</code></p>



<a name="275162185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162185">(Mar 13 2022 at 16:14)</a>:</h4>
<p>I also have to use the same version as mathlib, or else I get errors.</p>



<a name="275162300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162300">(Mar 13 2022 at 16:16)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">`</span><span class="n">c</span><span class="o">:</span><span class="bp">\</span><span class="n">Users</span><span class="bp">\</span><span class="n">vatis</span><span class="bp">\.</span><span class="n">elan</span><span class="bp">\</span><span class="n">toolchains</span><span class="bp">\</span><span class="n">leanprover</span><span class="c1">--lean4---nightly\bin\lake.exe print-paths Init Mathlib.Data.Nat.Basic` failed:</span>

<span class="n">stderr</span><span class="o">:</span>
<span class="n">info</span><span class="o">:</span> <span class="n">mathlib</span><span class="o">:</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">update</span> <span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span> <span class="n">to</span> <span class="n">revision</span> <span class="n">master</span>
<span class="n">info</span><span class="o">:</span> <span class="bp">&gt;</span> <span class="n">LEAN_PATH</span><span class="bp">=.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\</span><span class="n">build</span><span class="bp">\</span><span class="n">lib</span><span class="bp">;.\</span><span class="n">build</span><span class="bp">\</span><span class="n">lib</span> <span class="n">c</span><span class="o">:</span><span class="bp">\</span><span class="n">Users</span><span class="bp">\</span><span class="n">vatis</span><span class="bp">\.</span><span class="n">elan</span><span class="bp">\</span><span class="n">toolchains</span><span class="bp">\</span><span class="n">leanprover</span><span class="c1">--lean4---nightly\bin\lean.exe .\lean_packages\mathlib\.\.\Mathlib\Init\Logic.lean -R .\lean_packages\mathlib\.\. -o .\lean_packages\mathlib\.\build\lib\Mathlib\Init\Logic.olean -i .\lean_packages\mathlib\.\build\lib\Mathlib\Init\Logic.ilean -c .\lean_packages\mathlib\.\build\ir\Mathlib\Init\Logic.c</span>
<span class="n">info</span><span class="o">:</span> <span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">371</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">identifier</span> <span class="bp">'</span><span class="n">decidable_of_decidable_of_iff'</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">377</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">identifier</span> <span class="bp">'</span><span class="n">decidable_of_decidable_of_iff'</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">455</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">decidable_of_decidable_of_iff</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.10918</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">456</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">decidable_of_decidable_of_iff</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.10918</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">453</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="o">(</span><span class="n">kernel</span><span class="o">)</span> <span class="n">declaration</span> <span class="n">has</span> <span class="n">metavariables</span> <span class="bp">'</span><span class="n">if_ctx_simp_congr_prop'</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">460</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">decidable_of_decidable_of_iff</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.11110</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">461</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">identifier</span> <span class="bp">'</span><span class="n">if_ctx_simp_congr_prop'</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">458</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="o">(</span><span class="n">kernel</span><span class="o">)</span> <span class="n">declaration</span> <span class="n">has</span> <span class="n">metavariables</span> <span class="bp">'</span><span class="n">if_simp_congr_prop'</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">480</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">decidable_of_decidable_of_iff</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.11607</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">481</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">decidable_of_decidable_of_iff</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.11607</span>
<span class="bp">.\</span><span class="n">lean_packages</span><span class="bp">\</span><span class="n">mathlib</span><span class="bp">\.\.\</span><span class="n">Mathlib</span><span class="bp">\</span><span class="n">Init</span><span class="bp">\</span><span class="n">Logic.lean</span><span class="o">:</span><span class="mi">475</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="o">(</span><span class="n">kernel</span><span class="o">)</span> <span class="n">declaration</span> <span class="n">has</span> <span class="n">metavariables</span> <span class="bp">'</span><span class="n">dif_ctx_simp_congr'</span>

<span class="n">error</span><span class="o">:</span> <span class="n">external</span> <span class="n">command</span> <span class="n">c</span><span class="o">:</span><span class="bp">\</span><span class="n">Users</span><span class="bp">\</span><span class="n">vatis</span><span class="bp">\.</span><span class="n">elan</span><span class="bp">\</span><span class="n">toolchains</span><span class="bp">\</span><span class="n">leanprover</span><span class="c1">--lean4---nightly\bin\lean.exe exited with status 1</span>
<span class="n">error</span><span class="o">:</span> <span class="n">build</span> <span class="n">failed</span>
</code></pre></div>
<p>its honestly really annoying tbh</p>



<a name="275162319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162319">(Mar 13 2022 at 16:17)</a>:</h4>
<p>This is the latest <a href="https://github.com/leanprover/lean4-nightly/releases/tag/nightly-2022-03-13">https://github.com/leanprover/lean4-nightly/releases/tag/nightly-2022-03-13</a><br>
I just added your example to the test suite: <a href="https://github.com/leanprover/lean4/commit/672a889c83cfc00a07a78a28a9d9d99ae1a41162">https://github.com/leanprover/lean4/commit/672a889c83cfc00a07a78a28a9d9d99ae1a41162</a></p>



<a name="275162397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162397">(Mar 13 2022 at 16:19)</a>:</h4>
<p>It works now, thanks!</p>



<a name="275162445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275162445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275162445">(Mar 13 2022 at 16:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275162185">said</a>:</p>
<blockquote>
<p>I also have to use the same version as mathlib, or else I get errors.</p>
</blockquote>
<p>Recent changes in Lean seem to have broken Mathlib 4. It will be fixed soon.</p>



<a name="275165559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275165559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275165559">(Mar 13 2022 at 17:30)</a>:</h4>
<p>Mathlib4 has been updated to today's nightly now</p>



<a name="275166686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275166686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275166686">(Mar 13 2022 at 17:57)</a>:</h4>
<p>Small questions:</p>
<ol>
<li>What does <code>Nat.lt_of_succ_lt_succ</code> do, and why was it used here <code>| a::as, ⟨i+1, h⟩ =&gt; get as ⟨i, Nat.lt_of_succ_lt_succ h⟩</code>?</li>
<li>What does <code>Nat.succ_pos</code> do?</li>
<li>Why did lean need this instance, </li>
</ol>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">nat_lit</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>
</code></pre></div>
<p>and how exactly in the second argument of the <code>Fin'</code> working in this instance?<br>
4</p>



<a name="275166692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275166692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275166692">(Mar 13 2022 at 17:57)</a>:</h4>
<p>Sorry for all the questions, but Im quite new to this way of programming</p>



<a name="275168448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275168448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275168448">(Mar 13 2022 at 18:37)</a>:</h4>
<p>If only the functions had docstrings. But that's ok.</p>



<a name="275168508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275168508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275168508">(Mar 13 2022 at 18:38)</a>:</h4>
<p>The core team is doing so much work already <span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span></p>



<a name="275168520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275168520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275168520">(Mar 13 2022 at 18:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275168448">said</a>:</p>
<blockquote>
<p>If only the functions had docstrings. But that's ok.</p>
</blockquote>
<p>Awaiting your diff <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="275168599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275168599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275168599">(Mar 13 2022 at 18:40)</a>:</h4>
<p>I would if I knew what they did lol</p>



<a name="275175710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275175710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275175710">(Mar 13 2022 at 21:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275166686">said</a>:</p>
<blockquote>
<p>What does <code>Nat.lt_of_succ_lt_succ</code> do, and why was it used here <code>| a::as, ⟨i+1, h⟩ =&gt; get as ⟨i, Nat.lt_of_succ_lt_succ h⟩</code>?</p>
</blockquote>
<p>The type of <code>Nat.lt_of_succ_lt_succ</code> should tell you everything about it; it just says that <code>n + 1 &lt; m + 1</code> implies <code>n &lt; m</code>.<br>
Similar for <code>Nat.succ_pos</code>, the type gives you all the information.</p>
<p><code>get</code> expects something of type <code>Fin as.length</code>, which is a structure that contains a <code>Nat</code> and a proof that this nat is <code>&lt; as.length</code></p>



<a name="275176687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275176687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275176687">(Mar 13 2022 at 21:48)</a>:</h4>
<p>In mathlib we give docstrings to all our definitions but to very few of our proofs for precisely this reason: the type of the proof tells you what it's a proof of.</p>



<a name="275183361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275183361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275183361">(Mar 14 2022 at 00:25)</a>:</h4>
<p>Ok, but the question unanswered: <code>Why did lean need this instance?</code></p>



<a name="275188137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275188137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275188137">(Mar 14 2022 at 02:26)</a>:</h4>
<p>Refer back to <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/274923011">here</a>. The <code>OfNat (Fin' (List.length (a :: as))) (nat_lit 0)</code> instance means that when interpreting <code>0</code> as an element of <code>Fin' (List.length (a :: as))</code> it will use this instance to supply the value</p>



<a name="275188158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275188158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275188158">(Mar 14 2022 at 02:27)</a>:</h4>
<p>without it, <code>0 : Fin' (List.length (a :: as))</code> will not typecheck</p>



<a name="275188218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275188218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275188218">(Mar 14 2022 at 02:28)</a>:</h4>
<p>and with it, this expands to <code>⟨0, (Nat.succ_pos _ : Nat.lt 0 (List.length (a :: as)))⟩ : Fin' (List.length (a :: as))</code></p>



<a name="275188396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275188396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275188396">(Mar 14 2022 at 02:32)</a>:</h4>
<p>Ah I see. But what about any other literal?</p>



<a name="275188421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275188421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275188421">(Mar 14 2022 at 02:33)</a>:</h4>
<p>I remember that they are handled.</p>



<a name="275189939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275189939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275189939">(Mar 14 2022 at 03:09)</a>:</h4>
<p>No other literal will work in the type <code>Fin' (List.length (a :: as))</code>, as you can observe</p>



<a name="275189993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275189993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275189993">(Mar 14 2022 at 03:10)</a>:</h4>
<p>Like Leo said, this instance only works for <code>0</code></p>



<a name="275190019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275190019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275190019">(Mar 14 2022 at 03:10)</a>:</h4>
<p>And indeed it wouldn't be reasonable for any other literal to work because <code>1</code> might not actually be in the type if <code>as</code> is the empty list</p>



<a name="275190028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275190028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275190028">(Mar 14 2022 at 03:11)</a>:</h4>
<p>if <code>as = []</code> then this type is <code>Fin' 1</code> which only has a <code>0</code></p>



<a name="275190084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275190084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275190084">(Mar 14 2022 at 03:12)</a>:</h4>
<p>So maybe you want an instance for <code>1 : Fin' (List.length (a :: b :: as))</code> as well, and this just gets back to why this is a terrible idea</p>



<a name="275226589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275226589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275226589">(Mar 14 2022 at 12:10)</a>:</h4>
<p>So then why did my code work?</p>



<a name="275226813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275226813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275226813">(Mar 14 2022 at 12:13)</a>:</h4>
<p>I remember I made a function with a generic type that needed to be added, and it need an <code>[OfNat a  0]</code> instance as well. Why does it only need to know 0? Is this all the information it needs? What does the <code>OfNat</code> instance tell about a type?</p>



<a name="275226882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275226882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275226882">(Mar 14 2022 at 12:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275189939">said</a>:</p>
<blockquote>
<p>No other literal will work in the type <code>Fin' (List.length (a :: as))</code>, as you can observe</p>
</blockquote>
<p>Besides 0?</p>



<a name="275286926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275286926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275286926">(Mar 14 2022 at 19:30)</a>:</h4>
<p>Ok so i was trying to decipher this part of one of the instances:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Nat.lt_of_not_le</span> <span class="k">fun</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)</span>
</code></pre></div>
<p>So far I have:<br>
Nat.lt_of_not_le takes in two nats and a proof of <code>~ a &lt;= b</code>, and returns a proof that <code>b &lt; a</code>.  I don't know where you are giving in the two nats, but <code>fun h =&gt; ne_of_gt IsPos.pos (Nat.sub_eq_zero_iff_le.2 h)</code> is the proof of <code>~ a &lt;= b</code>, which is evident from the type signature <code>n ≤ i → False</code> (I have no idea how the <code>n</code> and <code>i</code> get in the signature.  In the body, you then prove that <code>a /= b</code> by giving in a proof of <code>b &lt; a</code> to <code>Nat.ne_of_gt</code> (where are you giving in the two nats). I don't know what the <code>IsPos.pos</code> arg is doing there, as it is only proving that <code>0 &lt; n</code>,  and after that you are taking the second element of  <code>Nat.sub_eq_zero_iff_le</code> which is <code>Nat.sub_eq_zero_of_le</code> and giving in h which I have which has a signature of <code>n &lt;= i</code>, which we are trying to prove false. in short, i have no idea how this is working</p>



<a name="275288749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275288749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275288749">(Mar 14 2022 at 19:47)</a>:</h4>
<p>First thing you need to know is that lean has implicit arguments, so if you give <code>~ a &lt;= b</code> to <code>Nat.lt_of_not_le</code>, it can figure out the <code>a</code> and <code>b</code> itself</p>



<a name="275289631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275289631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275289631">(Mar 14 2022 at 19:55)</a>:</h4>
<p>If <code>h</code> is a term of type <code>n &lt;= i</code>, then <code>Nat.sub_eq_zero_iff_le.2 h</code> is a term of type <code>n - i = 0</code>.<br>
<code>ne_of_gt</code> takes a term of type <code>x &gt; y</code> (not sure what they are here) and gives a term of type <code>x /= y</code> or <code>x = y → false</code>; if you then apply that to an equality (<code>n - i = 0</code>), you get <code>false</code>.<br>
So I'm guessing <code>x = n - i</code>, <code>y = 0</code>, so <code>IsPos.pos</code> must be <code>x - i &gt; 0</code>?</p>



<a name="275289719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275289719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275289719">(Mar 14 2022 at 19:56)</a>:</h4>
<p>yeah</p>



<a name="275289726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275289726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275289726">(Mar 14 2022 at 19:56)</a>:</h4>
<p>Does that connect a few dots? :)</p>



<a name="275289749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275289749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275289749">(Mar 14 2022 at 19:56)</a>:</h4>
<p>I have to read it again but yeah</p>



<a name="275289756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275289756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275289756">(Mar 14 2022 at 19:56)</a>:</h4>
<p>:)</p>



<a name="275291139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275291139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275291139">(Mar 14 2022 at 20:04)</a>:</h4>
<p>offtopic: I remember being mind blown by these crazy types when I only knew simple types like <code>int</code>, <code>float</code>, <code>string</code> etc</p>



<a name="275456000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275456000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275456000">(Mar 16 2022 at 00:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="467926">Joseph O</span> has marked this topic as unresolved.</p>



<a name="275456025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275456025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275456025">(Mar 16 2022 at 00:59)</a>:</h4>
<p>Wait, so this whole time</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">notation</span><span class="o">:</span><span class="n">max</span> <span class="s2">"#"</span> <span class="n">a</span><span class="o">:</span><span class="n">max</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">Fin.mk</span> <span class="n">a</span> <span class="o">(</span><span class="kd">by</span> <span class="n">decide</span><span class="o">))</span>
</code></pre></div>
<p>what the equivalent of </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">Fin'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">Fin</span> <span class="n">n</span>

<span class="kd">variable</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">as</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))</span> <span class="o">(</span><span class="n">nat_lit</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Nat.succ_pos</span> <span class="n">_</span> <span class="o">:</span> <span class="n">Nat.lt</span> <span class="mi">0</span> <span class="o">(</span><span class="n">List.length</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)))⟩⟩</span>

<span class="kd">class</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:=</span> <span class="n">pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">IsPos</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">Nat.succ_pos</span> <span class="n">_</span><span class="o">⟩</span>

<span class="kd">instance</span> <span class="o">[</span><span class="n">IsPos</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">i</span><span class="o">)]</span> <span class="o">:</span> <span class="n">OfNat</span> <span class="o">(</span><span class="n">Fin'</span> <span class="n">n</span><span class="o">)</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">Nat.lt_of_not_le</span> <span class="k">fun</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)⟩</span>
</code></pre></div>
<p><span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="275456055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275456055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275456055">(Mar 16 2022 at 00:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/270676-lean4/topic/Fin.20without.20wrapping/near/275289631">said</a>:</p>
<blockquote>
<p>If <code>h</code> is a term of type <code>n &lt;= i</code>, then <code>Nat.sub_eq_zero_iff_le.2 h</code> is a term of type <code>n - i = 0</code>.<br>
<code>ne_of_gt</code> takes a term of type <code>x &gt; y</code> (not sure what they are here) and gives a term of type <code>x /= y</code> or <code>x = y → false</code>; if you then apply that to an equality (<code>n - i = 0</code>), you get <code>false</code>.<br>
So I'm guessing <code>x = n - i</code>, <code>y = 0</code>, so <code>IsPos.pos</code> must be <code>x - i &gt; 0</code>?</p>
</blockquote>
<p>yeah so now the only thing i don't understand is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">ne_of_gt</span> <span class="n">IsPos.pos</span> <span class="o">(</span><span class="n">Nat.sub_eq_zero_iff_le.2</span> <span class="n">h</span><span class="o">)</span>
</code></pre></div>



<a name="275459095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275459095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275459095">(Mar 16 2022 at 01:55)</a>:</h4>
<p>What is your question about it?</p>



<a name="275471591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Fin%20without%20wrapping/near/275471591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Fin.20without.20wrapping.html#275471591">(Mar 16 2022 at 06:27)</a>:</h4>
<p>Do you know that <code>f a b</code> is actually <code>(f a) b</code>, where f is a function that takes a and returns another function that takes b?<br>
Also, that <code>x ≠ y</code>is really a function that takes a proof of <code>x = y</code>to false?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>