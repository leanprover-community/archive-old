---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html">Conditional dependencies in lakefile</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="319907404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/319907404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Raghuram Sundararajan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#319907404">(Jan 07 2023 at 05:37)</a>:</h4>
<p>I created a new Lake package with <code>lake new test math</code> and ran <code>lake update</code> in it. I expected that since <code>test</code> only depends on <code>mathlib</code> and without <code>-Kdoc=on</code> or similar, none of <code>mathlib</code> or its transitive dependencies depend on <code>doc-gen4</code>, that <code>doc-gen4</code> would not be cloned. However, it was.</p>
<p>Is this the expected behaviour? That is, is the conditional nature of <code>meta if</code> configuration only supposed to apply during <code>lake build</code>, etc., and not when downloading dependencies using <code>lake update</code>?</p>



<a name="321702693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/321702693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Raghuram Sundararajan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#321702693">(Jan 16 2023 at 19:01)</a>:</h4>
<p>bump</p>



<a name="321702858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/321702858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Raghuram Sundararajan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#321702858">(Jan 16 2023 at 19:02)</a>:</h4>
<p>It is a bit annoying to clone <code>Unicode</code> as a 100 MB <code>doc-gen4</code> dependency in every toy project that depends on mathlib.</p>



<a name="321713935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/321713935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#321713935">(Jan 16 2023 at 20:30)</a>:</h4>
<p>As a reference, some package managers use the concept of "dev dependencies", which shouldn't be downloaded if the package is being used as a dependency of another</p>



<a name="321954013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/321954013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#321954013">(Jan 18 2023 at 00:35)</a>:</h4>
<p>This sounds like a bug in Lake <span class="user-mention" data-user-id="450003">@Raghuram Sundararajan</span> , it would be good to have this recorded as an issue on <a href="https://github.com/leanprover/lake">https://github.com/leanprover/lake</a> .</p>



<a name="322735812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Conditional%20dependencies%20in%20lakefile/near/322735812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Raghuram Sundararajan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile.html#322735812">(Jan 21 2023 at 14:40)</a>:</h4>
<p><strong>Wojciech Nawrocki</strong> <a href="#narrow/stream/270676-lean4/topic/Conditional.20dependencies.20in.20lakefile/near/321954013">said</a>:</p>
<blockquote>
<p>This sounds like a bug in Lake <span class="user-mention silent" data-user-id="450003">Raghuram Sundararajan</span> , it would be good to have this recorded as an issue on <a href="https://github.com/leanprover/lake">https://github.com/leanprover/lake</a> .</p>
</blockquote>
<p>Done <a href="https://github.com/leanprover/lake/issues/149">here</a>. Sorry for the delay; I forgot about this.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>