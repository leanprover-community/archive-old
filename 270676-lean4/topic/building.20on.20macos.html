---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/building.20on.20macos.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html">building on macos</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="256672653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256672653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256672653">(Oct 08 2021 at 00:50)</a>:</h4>
<p>I'm having a terrible time building lean4 from source on macos. A week or two ago I could do this fine, but today I'm out of luck.</p>
<p>I'm running on Big Sur, with XCode installed, and the XCode command line tools installed. I've run <code>brew install cmake gmp ccache</code> per the <a href="https://leanprover.github.io/lean4/doc/make/osx-10.9.html">macos build instructions</a>.</p>
<p>Running</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">mkdir</span> <span class="bp">-</span><span class="n">p</span> <span class="n">build</span><span class="bp">/</span><span class="n">release</span>
<span class="n">cd</span> <span class="n">build</span><span class="bp">/</span><span class="n">release</span>
<span class="n">cmake</span> <span class="bp">../..</span>
<span class="n">make</span>
</code></pre></div>
<p>gives me</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span> <span class="mi">78</span><span class="bp">%</span><span class="o">]</span> <span class="n">Built</span> <span class="n">target</span> <span class="n">leancpp</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">../</span><span class="n">stdlib</span><span class="bp">//</span><span class="n">Init</span><span class="bp">/</span><span class="n">Data.c</span>
<span class="n">clang</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="n">version</span> <span class="n">number</span> <span class="k">in</span> <span class="bp">'-</span><span class="n">mmacosx</span><span class="bp">-</span><span class="n">version</span><span class="bp">-</span><span class="n">min</span><span class="bp">='</span>
</code></pre></div>
<p>Adding <code>export MACOSX_DEPLOYMENT_TARGET=10.14</code> resolves this issue (CI already does this; I'll make a PR for the manual), but then I get:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage0</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">lean</span>
<span class="n">ld</span><span class="o">:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="n">for</span> <span class="bp">-</span><span class="n">lSystem</span>
<span class="n">clang</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span> <span class="o">(</span><span class="n">use</span> <span class="bp">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="o">)</span>
</code></pre></div>
<p>Does anyone know what to do to fix this? Has anyone successfully built lean4 on macos recently?</p>



<a name="256675299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256675299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256675299">(Oct 08 2021 at 01:26)</a>:</h4>
<p>Yes you need <code>MACOSX_DEPLOYMENT_TARGET</code> set</p>



<a name="256675315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256675315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256675315">(Oct 08 2021 at 01:26)</a>:</h4>
<p>This changed recently I think, not sure why, but also I put lean 4 in a tap</p>



<a name="256675320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256675320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256675320">(Oct 08 2021 at 01:26)</a>:</h4>
<p>So you can feel free to use that as well</p>



<a name="256675333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256675333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256675333">(Oct 08 2021 at 01:27)</a>:</h4>
<p><code>brew install --head julian/tap/lean</code></p>



<a name="256675345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256675345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256675345">(Oct 08 2021 at 01:27)</a>:</h4>
<p>Otherwise if you want to do it yourself you need <a href="https://github.com/Julian/homebrew-tap/blob/master/Formula/lean.rb#L20">https://github.com/Julian/homebrew-tap/blob/master/Formula/lean.rb#L20</a></p>



<a name="256677396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677396">(Oct 08 2021 at 01:58)</a>:</h4>
<p>Very frustrating. <code>brew install --build-from-source --head julian/tap/lean</code> does indeed work. Using the tap is not satisfactory: I would really prefer to just be able to do this with <code>cmake</code> and <code>make</code>, so that I can pass other compiler flags.</p>



<a name="256677667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677667">(Oct 08 2021 at 02:01)</a>:</h4>
<p>I've tried using the same arguments for <code>cmake</code> and <code>make</code> that <code>brew install --build-from-source --verbose</code> reports using:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">cmake</span> <span class="bp">../..</span> <span class="bp">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="bp">=/</span><span class="n">usr</span><span class="bp">/</span><span class="kn">local</span><span class="bp">/</span><span class="n">Cellar</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="mi">2</span> <span class="bp">-</span><span class="n">DCMAKE_INSTALL_LIBDIR</span><span class="bp">=</span><span class="n">lib</span> <span class="bp">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="bp">=</span><span class="n">Release</span> <span class="bp">-</span><span class="n">DCMAKE_FIND_FRAMEWORK</span><span class="bp">=</span><span class="n">LAST</span> <span class="bp">-</span><span class="n">DCMAKE_VERBOSE_MAKEFILE</span><span class="bp">=</span><span class="n">ON</span> <span class="bp">-</span><span class="n">Wno</span><span class="bp">-</span><span class="n">dev</span> <span class="bp">-</span><span class="n">DBUILD_TESTING</span><span class="bp">=</span><span class="n">OFF</span> <span class="bp">-</span><span class="n">DCMAKE_OSX_SYSROOT</span><span class="bp">=/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX11.sdk</span>

<span class="n">make</span> <span class="n">MACOSX_DEPLOYMENT_TARGET</span><span class="bp">=</span><span class="mi">11</span><span class="bp">.</span><span class="mi">00</span> <span class="bp">-</span><span class="n">j36</span>
</code></pre></div>
<p>but I still get the same <code>ld: library not found for -lSystem</code> error.</p>
<p>There is some difference between the environment <code>brew install</code> is providing and the terminal. :-(</p>



<a name="256677907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677907">(Oct 08 2021 at 02:04)</a>:</h4>
<p>Fair enough. Perhaps which compiler you've got first on your path?</p>



<a name="256677915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677915">(Oct 08 2021 at 02:04)</a>:</h4>
<p>Otherwise when I compile manually I do...</p>



<a name="256677946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677946">(Oct 08 2021 at 02:05)</a>:</h4>
<p><code>rm -rf build/release &amp;&amp; mkdir -p build/release &amp;&amp; cd build/release &amp;&amp; cmake -DCMAKE_INSTALL_PREFIX=/opt/lean4/nightly/ ../.. &amp;&amp; make -j36 SDKROOT=$(xcrun --sdk macosx --show-sdk-path) MACOSX_DEPLOYMENT_TARGET=11.00</code></p>



<a name="256677950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256677950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256677950">(Oct 08 2021 at 02:05)</a>:</h4>
<p>Perhaps try that just in case?</p>



<a name="256678145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256678145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256678145">(Oct 08 2021 at 02:08)</a>:</h4>
<p>Looks like the <code>SDKROOT</code> might be the trick.</p>



<a name="256678155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256678155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256678155">(Oct 08 2021 at 02:08)</a>:</h4>
<p>Great.</p>



<a name="256747405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256747405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256747405">(Oct 08 2021 at 14:24)</a>:</h4>
<p>This might be due to the following changed line: <a href="https://github.com/leanprover/lean4/blob/305d035f17d9b4d0297c0345bf67e5b9b360595b/src/CMakeLists.txt#L431">https://github.com/leanprover/lean4/blob/305d035f17d9b4d0297c0345bf67e5b9b360595b/src/CMakeLists.txt#L431</a><br>
Could you post the output of <code>grep LEANC_OPTS build/release/stage1/stdlib.make</code>?</p>



<a name="256757680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256757680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256757680">(Oct 08 2021 at 15:32)</a>:</h4>
<p>Mine:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">~/</span><span class="n">Development</span><span class="bp">/</span><span class="n">lean4</span> <span class="n">is</span> <span class="n">a</span> <span class="n">git</span> <span class="n">repository</span> <span class="n">on</span> <span class="n">master</span>
<span class="bp">⊙</span>  <span class="n">grep</span> <span class="n">LEANC_OPTS</span> <span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">stdlib.make</span>                                                                                                                                 <span class="n">julian</span><span class="bp">@</span><span class="n">Airm</span>
        <span class="n">LEANC_OPTS</span><span class="bp">+=</span><span class="s2">" -O3 -DNDEBUG -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -mmacosx-version-min=11.00"</span><span class="bp">\</span>
        <span class="bp">+</span><span class="s2">"/Users/julian/Development/lean4/build/release/stage1/bin/leanmake"</span> <span class="n">lib</span> <span class="n">PKG</span><span class="bp">=</span><span class="n">Init</span> <span class="bp">$</span><span class="o">(</span><span class="n">LEANMAKE_OPTS</span><span class="o">)</span> <span class="n">LEANC_OPTS</span><span class="bp">+=-</span><span class="n">DLEAN_EXPORTING</span>
        <span class="bp">+</span><span class="s2">"/Users/julian/Development/lean4/build/release/stage1/bin/leanmake"</span> <span class="n">lib</span> <span class="n">PKG</span><span class="bp">=</span><span class="n">Std</span> <span class="bp">$</span><span class="o">(</span><span class="n">LEANMAKE_OPTS</span><span class="o">)</span> <span class="n">LEANC_OPTS</span><span class="bp">+=-</span><span class="n">DLEAN_EXPORTING</span>
        <span class="bp">+</span><span class="s2">"/Users/julian/Development/lean4/build/release/stage1/bin/leanmake"</span> <span class="n">lib</span> <span class="n">PKG</span><span class="bp">=</span><span class="n">Lean</span> <span class="bp">$</span><span class="o">(</span><span class="n">LEANMAKE_OPTS</span><span class="o">)</span> <span class="n">LEANC_OPTS</span><span class="bp">+=-</span><span class="n">DLEAN_EXPORTING</span>

<span class="bp">~/</span><span class="n">Development</span><span class="bp">/</span><span class="n">lean4</span> <span class="n">is</span> <span class="n">a</span> <span class="n">git</span> <span class="n">repository</span> <span class="n">on</span> <span class="n">master</span>
<span class="bp">⊙</span>  <span class="n">xcrun</span> <span class="c1">--sdk macosx --show-sdk-path                                                                                                                                               julian@Airm</span>
<span class="bp">/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX.sdk</span>
</code></pre></div>



<a name="256757793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256757793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256757793">(Oct 08 2021 at 15:32)</a>:</h4>
<p>Thanks. We're working on a fix.</p>



<a name="256767125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256767125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256767125">(Oct 08 2021 at 16:34)</a>:</h4>
<p>It should work without any extra flags again now</p>



<a name="256779241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256779241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256779241">(Oct 08 2021 at 17:55)</a>:</h4>
<p>Thanks! I can confirm I don't need <code>MACOSX_DEPLOYMENT_TARGET</code> (which for me was newly required). Though supplying <code>SDKROOT</code> still is necessary (but that was at least for me always necessary)</p>



<a name="256793265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256793265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256793265">(Oct 08 2021 at 19:30)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> fyi, you probably have already noticed this, but in case you missed it, that fix broke the Nix CI macOS build</p>



<a name="256796249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256796249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256796249">(Oct 08 2021 at 19:52)</a>:</h4>
<p><span class="user-mention" data-user-id="321696">@Julian Berman</span> CMake has some built-in logic for inferring the SDK, which seems to work on CI and on Leo's machine, but apparently not on yours for some reason</p>



<a name="256798664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256798664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256798664">(Oct 08 2021 at 20:11)</a>:</h4>
<p>Hrm. OK, not sure why -- though I guess let's see which bucket Scott falls into, probably not mine if he hasn't had to set it till now.</p>



<a name="256808173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256808173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256808173">(Oct 08 2021 at 21:24)</a>:</h4>
<p>Unfortunately on <code>master</code>, without any flags, I am still failing with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span>    <span class="o">]</span> <span class="n">Linking</span> <span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">leanc</span>
<span class="n">ld</span><span class="o">:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="n">for</span> <span class="bp">-</span><span class="n">lSystem</span>
<span class="n">clang</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span> <span class="o">(</span><span class="n">use</span> <span class="bp">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="o">)</span>
</code></pre></div>



<a name="256809164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256809164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256809164">(Oct 08 2021 at 21:33)</a>:</h4>
<p>And</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">make</span> <span class="bp">-</span><span class="n">j36</span> <span class="n">SDKROOT</span><span class="bp">=$</span><span class="o">(</span><span class="n">xcrun</span> <span class="c1">--sdk macosx --show-sdk-path)</span>
</code></pre></div>
<p>works.</p>



<a name="256809318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256809318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256809318">(Oct 08 2021 at 21:35)</a>:</h4>
<p>For reference <code>xcrun</code> is reporting <code>/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk</code>, and in <code>/Library/Developer/CommandLineTools/SDKs/</code> I have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">%</span> <span class="n">ls</span> <span class="bp">-</span><span class="n">al</span>
<span class="n">total</span> <span class="mi">0</span>
<span class="n">drwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">6</span> <span class="n">root</span>  <span class="n">wheel</span>  <span class="mi">192</span>  <span class="mi">8</span> <span class="n">Oct</span> <span class="mi">12</span><span class="o">:</span><span class="mi">39</span> <span class="bp">.</span>
<span class="n">drwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">5</span> <span class="n">root</span>  <span class="n">admin</span>  <span class="mi">160</span>  <span class="mi">8</span> <span class="n">Oct</span> <span class="mi">11</span><span class="o">:</span><span class="mi">08</span> <span class="bp">..</span>
<span class="n">lrwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">root</span>  <span class="n">wheel</span>   <span class="mi">14</span>  <span class="mi">8</span> <span class="n">Oct</span> <span class="mi">12</span><span class="o">:</span><span class="mi">39</span> <span class="n">MacOSX.sdk</span> <span class="bp">-&gt;</span> <span class="n">MacOSX11.3.sdk</span>
<span class="n">drwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">root</span>  <span class="n">wheel</span>  <span class="mi">224</span> <span class="mi">30</span> <span class="n">Nov</span>  <span class="mi">2020</span> <span class="n">MacOSX11.1.sdk</span>
<span class="n">drwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">7</span> <span class="n">root</span>  <span class="n">wheel</span>  <span class="mi">224</span>  <span class="mi">8</span> <span class="n">Oct</span> <span class="mi">12</span><span class="o">:</span><span class="mi">39</span> <span class="n">MacOSX11.3.sdk</span>
<span class="n">lrwxr</span><span class="bp">-</span><span class="n">xr</span><span class="bp">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">root</span>  <span class="n">wheel</span>   <span class="mi">14</span>  <span class="mi">8</span> <span class="n">Oct</span> <span class="mi">12</span><span class="o">:</span><span class="mi">38</span> <span class="n">MacOSX11.sdk</span> <span class="bp">-&gt;</span> <span class="n">MacOSX11.3.sdk</span>
</code></pre></div>



<a name="256851155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851155">(Oct 09 2021 at 08:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> That's weird though, it must have succeeded for <code>stage0/bin/lean</code> this time? Could you try again with a clean build directory and <code>make -j36 VERBOSE=1</code>, and post the cmdlines after "Linking ..." if the error persists?</p>



<a name="256851617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851617">(Oct 09 2021 at 08:16)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span>    <span class="o">]</span> <span class="n">Linking</span> <span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">leanc</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">o</span> <span class="s2">"/Users/scott/projects/lean/lean4/build/release/stage1/bin/leanc"</span> <span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanc.o</span> <span class="bp">-</span><span class="n">lleanshared</span>  <span class="bp">-</span><span class="n">Wl</span><span class="o">,</span><span class="bp">-</span><span class="n">rpath</span><span class="o">,</span><span class="bp">@</span><span class="n">executable_path</span><span class="bp">/../</span><span class="n">lib</span> <span class="bp">-</span><span class="n">Wl</span><span class="o">,</span><span class="bp">-</span><span class="n">rpath</span><span class="o">,</span><span class="bp">@</span><span class="n">executable_path</span><span class="bp">/../</span><span class="n">lib</span><span class="bp">/</span><span class="n">lean</span>
<span class="n">ld</span><span class="o">:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="n">for</span> <span class="bp">-</span><span class="n">lSystem</span>
<span class="n">clang</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span> <span class="o">(</span><span class="n">use</span> <span class="bp">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="o">)</span>
<span class="n">make</span><span class="o">[</span><span class="mi">7</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">leanc</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">1</span>
<span class="n">make</span><span class="o">[</span><span class="mi">6</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">Leanc</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">5</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">leanc</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">4</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">leanc.dir</span><span class="bp">/</span><span class="n">all</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">4</span><span class="o">]:</span> <span class="bp">***</span> <span class="n">Waiting</span> <span class="n">for</span> <span class="n">unfinished</span> <span class="n">jobs....</span>
<span class="n">mv</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Build.c.tmp"</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Build.c"</span>
<span class="n">mv</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Manifest.c.tmp"</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Manifest.c"</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Build.c</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Resolve.lean</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">c</span> <span class="bp">-</span><span class="n">o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Build.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Build.c</span> <span class="bp">-</span><span class="n">O3</span> <span class="bp">-</span><span class="n">DNDEBUG</span> <span class="bp">-</span><span class="n">isysroot</span><span class="bp">/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX11.3.sdk</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage0</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">lean</span> <span class="bp">-</span><span class="n">s40000</span> <span class="bp">-</span><span class="n">o</span> <span class="s2">"../build/release/stage1/lib/lean/Leanpkg/Resolve.olean"</span> <span class="c1">--c="../build/release/stage1/lib/temp/Leanpkg/Resolve.c.tmp" Leanpkg/Resolve.lean</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Manifest.c</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">c</span> <span class="bp">-</span><span class="n">o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Manifest.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Manifest.c</span> <span class="bp">-</span><span class="n">O3</span> <span class="bp">-</span><span class="n">DNDEBUG</span> <span class="bp">-</span><span class="n">isysroot</span><span class="bp">/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX11.3.sdk</span>
<span class="n">mv</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Resolve.c.tmp"</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg/Resolve.c"</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="n">Leanpkg.lean</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage0</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">lean</span> <span class="bp">-</span><span class="n">s40000</span> <span class="bp">-</span><span class="n">o</span> <span class="s2">"../build/release/stage1/lib/lean/Leanpkg.olean"</span> <span class="c1">--c="../build/release/stage1/lib/temp/Leanpkg.c.tmp" Leanpkg.lean</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Resolve.c</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">c</span> <span class="bp">-</span><span class="n">o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Resolve.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Resolve.c</span> <span class="bp">-</span><span class="n">O3</span> <span class="bp">-</span><span class="n">DNDEBUG</span> <span class="bp">-</span><span class="n">isysroot</span><span class="bp">/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX11.3.sdk</span>
<span class="n">mv</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg.c.tmp"</span> <span class="s2">"../build/release/stage1/lib/temp/Leanpkg.c"</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Building</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg.c</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">c</span> <span class="bp">-</span><span class="n">o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg.c</span> <span class="bp">-</span><span class="n">O3</span> <span class="bp">-</span><span class="n">DNDEBUG</span> <span class="bp">-</span><span class="n">isysroot</span><span class="bp">/</span><span class="n">Library</span><span class="bp">/</span><span class="n">Developer</span><span class="bp">/</span><span class="n">CommandLineTools</span><span class="bp">/</span><span class="n">SDKs</span><span class="bp">/</span><span class="n">MacOSX11.3.sdk</span>
<span class="o">[</span>    <span class="o">]</span> <span class="n">Linking</span> <span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">leanpkg</span>
<span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">leanc.sh</span> <span class="bp">-</span><span class="n">o</span> <span class="s2">"/Users/scott/projects/lean/lean4/build/release/stage1/bin/leanpkg"</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">LeanVersion.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Proc.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Manifest.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Git.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Build.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Resolve.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg</span><span class="bp">/</span><span class="n">Toml.o</span> <span class="bp">../</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">temp</span><span class="bp">/</span><span class="n">Leanpkg.o</span> <span class="bp">-</span><span class="n">lleanshared</span>  <span class="bp">-</span><span class="n">Wl</span><span class="o">,</span><span class="bp">-</span><span class="n">rpath</span><span class="o">,</span><span class="bp">@</span><span class="n">executable_path</span><span class="bp">/../</span><span class="n">lib</span> <span class="bp">-</span><span class="n">Wl</span><span class="o">,</span><span class="bp">-</span><span class="n">rpath</span><span class="o">,</span><span class="bp">@</span><span class="n">executable_path</span><span class="bp">/../</span><span class="n">lib</span><span class="bp">/</span><span class="n">lean</span>
<span class="n">ld</span><span class="o">:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="n">for</span> <span class="bp">-</span><span class="n">lSystem</span>
<span class="n">clang</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span> <span class="o">(</span><span class="n">use</span> <span class="bp">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="o">)</span>
<span class="n">make</span><span class="o">[</span><span class="mi">7</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">scott</span><span class="bp">/</span><span class="n">projects</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">leanpkg</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">1</span>
<span class="n">make</span><span class="o">[</span><span class="mi">6</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">Leanpkg</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">5</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">leanpkg</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">4</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">leanpkg.dir</span><span class="bp">/</span><span class="n">all</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">3</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">all</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">2</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">stage1</span><span class="bp">-</span><span class="kd">prefix</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">-</span><span class="n">stamp</span><span class="bp">/</span><span class="n">stage1</span><span class="bp">-</span><span class="n">build</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">[</span><span class="mi">1</span><span class="o">]:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">stage1.dir</span><span class="bp">/</span><span class="n">all</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="o">:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">all</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">2</span>
</code></pre></div>



<a name="256851731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851731">(Oct 09 2021 at 08:18)</a>:</h4>
<p>But <code>make lean VERBOSE=1</code> works?</p>



<a name="256851791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851791">(Oct 09 2021 at 08:19)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">$</span> <span class="n">make</span> <span class="n">lean</span> <span class="n">VERBOSE</span><span class="bp">=</span><span class="mi">1</span>
<span class="n">make</span><span class="o">:</span> <span class="bp">***</span> <span class="n">No</span> <span class="n">rule</span> <span class="n">to</span> <span class="n">make</span> <span class="n">target</span> <span class="bp">`</span><span class="n">lean'.</span>  <span class="n">Stop.</span>
</code></pre></div>



<a name="256851862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851862">(Oct 09 2021 at 08:20)</a>:</h4>
<p>Ah, try again in <code>stage1/</code></p>



<a name="256851885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851885">(Oct 09 2021 at 08:21)</a>:</h4>
<p>Yes, that works.</p>



<a name="256851890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851890">(Oct 09 2021 at 08:21)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">make</span><span class="o">[</span><span class="mi">4</span><span class="o">]:</span> <span class="n">Nothing</span> <span class="n">to</span> <span class="n">be</span> <span class="n">done</span> <span class="n">for</span> <span class="bp">`</span><span class="n">lean'.</span>
</code></pre></div>



<a name="256851907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851907">(Oct 09 2021 at 08:21)</a>:</h4>
<p>Ok, thanks. And after <code>rm bin/lean</code>?</p>



<a name="256851986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256851986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256851986">(Oct 09 2021 at 08:22)</a>:</h4>
<p>Wait, I can see the mistake</p>



<a name="256852133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256852133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256852133">(Oct 09 2021 at 08:25)</a>:</h4>
<p>This should fix it; will merge after CI is green <a href="https://github.com/Kha/lean4/commit/2ab8a38daa36650ad70f40f2290bf9c22ae0406e">https://github.com/Kha/lean4/commit/2ab8a38daa36650ad70f40f2290bf9c22ae0406e</a></p>



<a name="256852757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256852757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256852757">(Oct 09 2021 at 08:36)</a>:</h4>
<p>That commit works beautifully for me. :-)</p>



<a name="256877065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/building%20on%20macos/near/256877065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/building.20on.20macos.html#256877065">(Oct 09 2021 at 15:16)</a>:</h4>
<p>Works here too now without any options. Thanks Sebastian.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>