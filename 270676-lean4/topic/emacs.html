---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/emacs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html">emacs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="221657870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221657870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221657870">(Jan 05 2021 at 15:18)</a>:</h4>
<p>Just for future reference, here's the link to the emacs lean4 package<br>
<a href="https://github.com/leanprover/lean4/tree/master/lean4-mode">https://github.com/leanprover/lean4/tree/master/lean4-mode</a></p>
<p>Will this be on melpa at some point soon?</p>



<a name="221658107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221658107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221658107">(Jan 05 2021 at 15:20)</a>:</h4>
<p>Probably, when it (and the language server) is more stable</p>



<a name="221670854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221670854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221670854">(Jan 05 2021 at 16:53)</a>:</h4>
<p>Just in case it helps anyone else, the following code in <code>packages.el</code> seems to work for <code>doom emacs</code></p>
<div class="codehilite" data-code-language="EmacsLisp"><pre><span></span><code><span class="p">(</span><span class="nv">package!</span> <span class="nv">dash</span><span class="p">)</span>
<span class="p">(</span><span class="nv">package!</span> <span class="nv">flycheck</span><span class="p">)</span>
<span class="p">(</span><span class="nv">package!</span> <span class="nv">dash-functional</span><span class="p">)</span>
<span class="p">(</span><span class="nv">package!</span> <span class="nv">f</span><span class="p">)</span>
<span class="p">(</span><span class="nv">package!</span> <span class="nv">s</span><span class="p">)</span>
<span class="p">(</span><span class="nv">package!</span> <span class="nv">lsp-mode</span><span class="p">)</span>

<span class="p">(</span><span class="nv">package!</span> <span class="nv">lean4-mode</span> <span class="nb">:recipe</span>
  <span class="p">(</span><span class="nb">:host</span> <span class="nv">github</span>
   <span class="nb">:repo</span> <span class="s">"leanprover/lean4"</span>
   <span class="nb">:files</span> <span class="p">(</span><span class="s">"lean4-mode/*.el"</span><span class="p">)))</span>
</code></pre></div>



<a name="221676100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221676100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Koundinya Vajjha <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221676100">(Jan 05 2021 at 17:32)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> thank you!</p>



<a name="221676278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221676278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221676278">(Jan 05 2021 at 17:34)</a>:</h4>
<p>Looks like <code>(require 'lean4-mode)</code> is problematic if you have both <code>lean4-mode</code> and <code>lean-mode</code> installed. And without it you have to manually activate <code>lean4-mode</code> with e.g. <code>M-x</code>. Is there a way to have it automatically activate <code>lean4-mode</code> in a <code>lean4</code> project?</p>



<a name="221677370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221677370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221677370">(Jan 05 2021 at 17:42)</a>:</h4>
<p>maybe <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Directory-Variables.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/Directory-Variables.html</a></p>



<a name="221677524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221677524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221677524">(Jan 05 2021 at 17:43)</a>:</h4>
<p>Yeah that's a good workaround.</p>



<a name="221698776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221698776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221698776">(Jan 05 2021 at 20:41)</a>:</h4>
<p>I just (re)installed <code>lean4-mode</code> (I had a version from before it was based on LSP). I have a weird situation where I'm having <code>status: starting</code> for a very long time</p>



<a name="221698925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221698925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221698925">(Jan 05 2021 at 20:43)</a>:</h4>
<p>Are you using the Nix setup?</p>



<a name="221699271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221699271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221699271">(Jan 05 2021 at 20:47)</a>:</h4>
<p>To install Lean4 yes but not to install the emacs mode. Does the nix setup help also with emacs?</p>



<a name="221699690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221699690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221699690">(Jan 05 2021 at 20:50)</a>:</h4>
<blockquote>
<p>There is preliminary integration of the Nix-based build system into editors started as above, which automatically builds dependencies when opening or invalidating a file. There is no progress report yet, and build errors from dependencies will crash the language server; see the stderr logs for the build error in that case.</p>
</blockquote>



<a name="221699822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221699822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221699822">(Jan 05 2021 at 20:51)</a>:</h4>
<p>The language server starting for a long time can mean Nix compiling dependencies in the background, but that shouldn't happen if you pointed <code>lean4-mode</code> manually at the result of <code>nix build</code>.</p>



<a name="221700348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221700348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221700348">(Jan 05 2021 at 20:56)</a>:</h4>
<p>Do refer to setting <code>lean4-rootdir</code> manually?</p>



<a name="221700440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221700440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221700440">(Jan 05 2021 at 20:56)</a>:</h4>
<p>Yes, whatever you did to set it up</p>



<a name="221700769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221700769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221700769">(Jan 05 2021 at 20:59)</a>:</h4>
<p>Ok thanks! I'll need to get back to it a bit later. I'll let you know how it goes</p>



<a name="221701381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221701381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221701381">(Jan 05 2021 at 21:04)</a>:</h4>
<p>Btw, given my part of the talk yesterday I probably don't have to mention that I will have only limited patience dealing with manual setups not using Nix (completely) from now on <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="221726917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221726917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221726917">(Jan 06 2021 at 02:21)</a>:</h4>
<p>That's understandable</p>



<a name="221727221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221727221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221727221">(Jan 06 2021 at 02:27)</a>:</h4>
<p>For emacs, what is the nix way of doing things?</p>



<a name="221727520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221727520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221727520">(Jan 06 2021 at 02:33)</a>:</h4>
<p>I really like what you did with the documentation btw. I especially like the button that copies code snippets. For shell code, it also copies <code>$</code> however</p>



<a name="221728754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/221728754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#221728754">(Jan 06 2021 at 03:00)</a>:</h4>
<p>I just saw the following line in the instructions:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>nix run .#emacs-dev MyPackage.lean  <span class="c1"># arguments can be passed as well, e.g. the file to open</span>
</code></pre></div>
<p>Is this what you refer to as the nix emacs setup? It kind of looks like I'd need a different instance of emacs for each project. That's not very practical</p>



<a name="222090203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222090203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222090203">(Jan 08 2021 at 16:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> did you ever get <code>emacs</code> to behave with <code>nix</code>? If so, could you give some hints on how you set it up?</p>



<a name="222091877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222091877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222091877">(Jan 08 2021 at 16:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110026">Simon Hudon</span> <a href="#narrow/stream/270676-lean4/topic/emacs/near/221728754">said</a>:</p>
<blockquote>
<p>It kind of looks like I'd need a different instance of emacs for each project. That's not very practical</p>
</blockquote>
<p>FWIW, I use a separate instance per workspace, so that's not really an issue for me. But if you don't want that, the nix-env-selector solution mentioned in the "using nix" topic sounds like the next-best thing.</p>



<a name="222093018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093018">(Jan 08 2021 at 16:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> I see. I kind of use emacs as an operating system where I do a whole bunch of stuff until I'm forced to interact with OSX again</p>



<a name="222093067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093067">(Jan 08 2021 at 16:29)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> Sorry I haven't made progress yet. I'm going to try again tonight</p>



<a name="222093202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093202">(Jan 08 2021 at 16:30)</a>:</h4>
<p><code>nix-env-selector</code> is a vs-code thing right?</p>



<a name="222093536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093536">(Jan 08 2021 at 16:33)</a>:</h4>
<p>Whoops, yeah. I use <code>direnv</code> in Emacs (for things that are not Lean), though that needs one more setup step per project...</p>



<a name="222093936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093936">(Jan 08 2021 at 16:36)</a>:</h4>
<p>Isn't there a way to make this <code>nix build .#lean-dev -o ./lean-dev</code> step happen automatically when opening the nix-shell using a <code>shell.nix</code> file? I think it's also possible to ask nix-shell to set up a link + update the path variable so that <code>lean</code> is symlinked to <code>./lean-dev</code>. I guess what I'm going for is to have it automatically set up the links + path stuff when I run <code>nix-shell</code> so that emacs is happy when I run <code>emacs</code> from within the <code>nix-shell</code>.</p>



<a name="222093990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222093990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222093990">(Jan 08 2021 at 16:37)</a>:</h4>
<p>I'll take a look at <code>direnv</code>. Thanks!</p>



<a name="222094015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094015">(Jan 08 2021 at 16:37)</a>:</h4>
<p>If you're running Emacs from within a nix-shell anyway, why not use <code>.#emacs-dev</code>?</p>



<a name="222094048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094048">(Jan 08 2021 at 16:37)</a>:</h4>
<p>Does this not create a whole new installation of emacs?</p>



<a name="222094231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094231">(Jan 08 2021 at 16:39)</a>:</h4>
<p>Yes, it does download "a bit" of stuff. But it will use your <code>.emacs.d</code>.</p>



<a name="222094306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094306">(Jan 08 2021 at 16:40)</a>:</h4>
<p>Oh ok.</p>



<a name="222094629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094629">(Jan 08 2021 at 16:43)</a>:</h4>
<p>"a bit" ~= 1G</p>



<a name="222094910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222094910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222094910">(Jan 08 2021 at 16:45)</a>:</h4>
<p>If you wish to build a Lean program from scratch, you must first invent the universe. -- Carl Sagan</p>



<a name="222095060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222095060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222095060">(Jan 08 2021 at 16:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/270676-lean4/topic/emacs/near/222093936">said</a>:</p>
<blockquote>
<p>Isn't there a way to make this <code>nix build .#lean-dev -o ./lean-dev</code> step happen automatically when opening the nix-shell using a <code>shell.nix</code> file?</p>
</blockquote>
<p>If you use <code>nix shell .#lean-dev</code> instead, it will put the correct <code>lean</code> binary in your path, which should be sufficient if you've already installed <code>lean4-mode</code> another way.</p>



<a name="222095359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222095359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222095359">(Jan 08 2021 at 16:49)</a>:</h4>
<p>Hmm... what's the actual command?</p>



<a name="222095384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222095384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222095384">(Jan 08 2021 at 16:49)</a>:</h4>
<p>I've been using <code>nix-shell https://github.com/leanprover/lean4/archive/master.tar.gz -A nix</code> to start the nix shell with the custom nix</p>



<a name="222095957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222095957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222095957">(Jan 08 2021 at 16:54)</a>:</h4>
<p>Ah I see. You mean run <code>nix shell .#lean-dev</code> in the nix-shell.</p>



<a name="222095969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/222095969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#222095969">(Jan 08 2021 at 16:54)</a>:</h4>
<p>Yes, this works</p>



<a name="289746916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289746916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289746916">(Jul 15 2022 at 16:01)</a>:</h4>
<p>Is there an example of emacs setup that works both for lean3 and lean4? <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span></p>



<a name="289746965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289746965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289746965">(Jul 15 2022 at 16:01)</a>:</h4>
<p>BTW, why not put <code>lean4-mode</code> to <code>melpa</code>?</p>



<a name="289747290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289747290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289747290">(Jul 15 2022 at 16:03)</a>:</h4>
<p><a href="https://github.com/melpa/melpa/pull/8106">https://github.com/melpa/melpa/pull/8106</a></p>



<a name="289747310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289747310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289747310">(Jul 15 2022 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/270676-lean4/topic/emacs/near/289746916">said</a>:</p>
<blockquote>
<p>Is there an example of emacs setup that works both for lean3 and lean4? <span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span></p>
</blockquote>
<p>Sorry, I don't use Lean 3 anymore</p>



<a name="289748217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289748217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289748217">(Jul 15 2022 at 16:11)</a>:</h4>
<p>I guess, I'll have to use different editors for Lean 3 and Lean 4 (or different instances of emacs).</p>



<a name="289749654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289749654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289749654">(Jul 15 2022 at 16:22)</a>:</h4>
<p>At some point I had both working. I have lean-mode installed through melpa and lean4-mode with straight. The only annoying thing is that for every lean3 file I have to manually switch to lean-mode.</p>
<p>If I remember correctly, I set elan default toolchain to lean3 as all my lean4 code live in lake projects and there Lean version is determined by toolchain file.</p>



<a name="289848095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289848095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289848095">(Jul 16 2022 at 21:16)</a>:</h4>
<p>Requiring <code>lean-mode</code> and <code>lean4-mode</code> and doing <code>(setq lean4-autodetect-lean3 t)</code> works for me (or at least worked at some point).</p>



<a name="289851644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/289851644" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#289851644">(Jul 16 2022 at 22:53)</a>:</h4>
<p>I'll try later tonight.</p>



<a name="314921161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/emacs/near/314921161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/emacs.html#314921161">(Dec 09 2022 at 15:34)</a>:</h4>
<p>After many years of divergence and manual sync, lean4-mode now uses the same abbreviations.json as vscode-lean4: <a href="https://github.com/leanprover/lean4-mode/pull/23">https://github.com/leanprover/lean4-mode/pull/23</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>