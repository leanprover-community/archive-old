---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html">In buffer message alignment in lean4-mode</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="281935720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281935720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281935720">(May 11 2022 at 08:57)</a>:</h4>
<p>The message with #check or #print shows the message aligned to the right and quite often the message does not show fully, see attached picture.</p>
<p><a href="/user_uploads/3121/8jv8de6-7itQaWov0ovWM51S/Screenshot-from-2022-05-11-10-52-36.png">Screenshot-from-2022-05-11-10-52-36.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/8jv8de6-7itQaWov0ovWM51S/Screenshot-from-2022-05-11-10-52-36.png" title="Screenshot-from-2022-05-11-10-52-36.png"><img src="/user_uploads/3121/8jv8de6-7itQaWov0ovWM51S/Screenshot-from-2022-05-11-10-52-36.png"></a></div><p>I'm not entirely sure if it is problem in <code>lean4-mode</code>, some other part of emacs or my config. Anyway, I was unable to figure out where the problem is. Does this happen to someone else? How can it be fixed?</p>



<a name="281936396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281936396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281936396">(May 11 2022 at 09:03)</a>:</h4>
<p>I also have this (also with the Haskell LSP plugin). Don't know what to do about it so I always use the goal buffer.</p>



<a name="281936680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281936680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281936680">(May 11 2022 at 09:06)</a>:</h4>
<p>Looks like <a href="https://github.com/emacs-lsp/lsp-ui#lsp-ui-sideline">https://github.com/emacs-lsp/lsp-ui#lsp-ui-sideline</a></p>



<a name="281936794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281936794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281936794">(May 11 2022 at 09:07)</a>:</h4>
<p>Not exactly much to customize there</p>



<a name="281937731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281937731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281937731">(May 11 2022 at 09:16)</a>:</h4>
<p>Interesting, I increased <code>lsp-ui-sideline-diagnostic-max-</code> <code>line-length</code>/<code>lines</code> and the local context now shows up, neat. But still does not solve the problem with cutting off the end of the line:<br>
<a href="/user_uploads/3121/E1PlLC8Z7AS_RJBXbvchVFSp/Screenshot-from-2022-05-11-11-14-25.png">Screenshot-from-2022-05-11-11-14-25.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/E1PlLC8Z7AS_RJBXbvchVFSp/Screenshot-from-2022-05-11-11-14-25.png" title="Screenshot-from-2022-05-11-11-14-25.png"><img src="/user_uploads/3121/E1PlLC8Z7AS_RJBXbvchVFSp/Screenshot-from-2022-05-11-11-14-25.png"></a></div>



<a name="281938018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281938018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281938018">(May 11 2022 at 09:19)</a>:</h4>
<p>Ah, I think this is a problem with Unicode characters, which probably screw up some internal size measurements</p>



<a name="281938513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281938513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281938513">(May 11 2022 at 09:24)</a>:</h4>
<p>Even in C++ it just either cuts off the line or does not show the line at all.</p>



<a name="281939070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281939070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281939070">(May 11 2022 at 09:29)</a>:</h4>
<p>Note that it is not cut off in your last example, the <code>Y</code> is wrapped to the beginning of the next line</p>



<a name="281939156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281939156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281939156">(May 11 2022 at 09:30)</a>:</h4>
<p>True, but in the first example it is cut off.</p>



<a name="281939175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281939175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281939175">(May 11 2022 at 09:30)</a>:</h4>
<p>Some experimentation in C++:</p>
<p>High <code>line-length</code><br>
<a href="/user_uploads/3121/93gatghJn9xUOFIRyAjHGSCk/Screenshot-from-2022-05-11-11-25-39.png">Screenshot-from-2022-05-11-11-25-39.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/93gatghJn9xUOFIRyAjHGSCk/Screenshot-from-2022-05-11-11-25-39.png" title="Screenshot-from-2022-05-11-11-25-39.png"><img src="/user_uploads/3121/93gatghJn9xUOFIRyAjHGSCk/Screenshot-from-2022-05-11-11-25-39.png"></a></div><p>Normal <code>line-length</code>, you can see the cut off at  <code>... of type 'const</code> <br>
<a href="/user_uploads/3121/7sH5SvE-3q_966jhsvHCcnWK/Screenshot-from-2022-05-11-11-26-05.png">Screenshot-from-2022-05-11-11-26-05.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/7sH5SvE-3q_966jhsvHCcnWK/Screenshot-from-2022-05-11-11-26-05.png" title="Screenshot-from-2022-05-11-11-26-05.png"><img src="/user_uploads/3121/7sH5SvE-3q_966jhsvHCcnWK/Screenshot-from-2022-05-11-11-26-05.png"></a></div>



<a name="281939379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281939379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281939379">(May 11 2022 at 09:33)</a>:</h4>
<p>It tries to do some really smart stuff, like find a line where the message fits and display it there.  I kind of liked the lean3 behavior where it just add extra lines under #check</p>



<a name="281943741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281943741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281943741">(May 11 2022 at 10:19)</a>:</h4>
<p>I think that was <a href="https://github.com/leanprover/lean-mode/blob/master/lean-message-boxes.el">https://github.com/leanprover/lean-mode/blob/master/lean-message-boxes.el</a> by <span class="user-mention" data-user-id="354934">@David Thrane Christiansen</span> . It shouldn't be too hard to port.</p>



<a name="281944167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281944167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Thrane Christiansen <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281944167">(May 11 2022 at 10:23)</a>:</h4>
<p>I'd be happy to explain that code to anyone who needs it, but I don't have time to port it myself right now.</p>
<p>Perhaps it should be generalized into a library that can work with lsp-mode, eglot, or other sources of metadata about a program, and then give it a Lean/LSP backend for this case? It seems like it would be useful for non-LSP data sources as well, like racket-xp-mode, flymake/flycheck, or even M-x compile output.</p>
<p>I can walk you through the design of something like that in my head, and explain the UI code, and generally mentor the elisp development.</p>



<a name="281944298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/In%20buffer%20message%20alignment%20in%20lean4-mode/near/281944298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Thrane Christiansen <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/In.20buffer.20message.20alignment.20in.20lean4-mode.html#281944298">(May 11 2022 at 10:24)</a>:</h4>
<p>FWIW I don't use lsp-ui at all, and the Lean info buffer is also a reasonable way to see these things for my uses, and it doesn't suffer from the constraints of having to put the messages inline in the buffer text.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>