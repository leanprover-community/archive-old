---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html">vscode-lean4 Doesn't Work When I Switch Files</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="232013137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vscode-lean4%20Doesn%27t%20Work%20When%20I%20Switch%20Files/near/232013137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arjun Viswanathan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html#232013137">(Mar 26 2021 at 18:37)</a>:</h4>
<p>The VSCode extension for Lean4 works properly on my project when I open it as long as I stay within the file that I opened to. When I switch tabs to a different Lean file, I immediately get this output:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Watchdog</span> <span class="n">error</span><span class="o">:</span> <span class="n">Got</span> <span class="n">unknown</span> <span class="n">document</span> <span class="n">URI</span> <span class="o">(</span><span class="n">file</span><span class="o">:</span><span class="bp">///</span><span class="n">filename</span><span class="o">)</span>
<span class="o">[</span><span class="n">Info</span>  <span class="bp">-</span> <span class="mi">1</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">01</span> <span class="n">PM</span><span class="o">]</span> <span class="n">Connection</span> <span class="n">to</span> <span class="n">server</span> <span class="n">got</span> <span class="n">closed.</span> <span class="n">Server</span> <span class="n">will</span> <span class="n">restart.</span>
<span class="o">[</span><span class="n">Error</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">01</span> <span class="n">PM</span><span class="o">]</span> <span class="n">Request</span> <span class="n">textDocument</span><span class="bp">/</span><span class="n">documentSymbol</span> <span class="n">failed.</span>
<span class="n">Error</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">got</span> <span class="n">disposed.</span>
    <span class="n">at</span> <span class="n">Object.dispose</span> <span class="o">(</span><span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">arjun</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">145468</span><span class="o">)</span>
</code></pre></div>
<p>and then the extension doesn't work anymore until I restart VSCode.</p>
<p>Has anybody else had this experience? Any help will be appreciated.</p>



<a name="232019397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vscode-lean4%20Doesn%27t%20Work%20When%20I%20Switch%20Files/near/232019397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html#232019397">(Mar 26 2021 at 19:27)</a>:</h4>
<p>I'm getting this inconsistently on 4.0.0-m2 with 0.0.2 for the extension. Mine is slightly more verbose:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Watchdog</span> <span class="n">error</span><span class="o">:</span> <span class="n">Got</span> <span class="n">unknown</span> <span class="n">document</span> <span class="n">URI</span> <span class="o">(</span><span class="n">file</span><span class="o">:</span><span class="bp">///</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/</span><span class="n">test_dir</span><span class="bp">/</span><span class="n">testfile2.lean</span><span class="o">)</span>
<span class="o">[</span><span class="n">Info</span>  <span class="bp">-</span> <span class="mi">2</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">18</span> <span class="n">PM</span><span class="o">]</span> <span class="n">Connection</span> <span class="n">to</span> <span class="n">server</span> <span class="n">got</span> <span class="n">closed.</span> <span class="n">Server</span> <span class="n">will</span> <span class="n">restart.</span>
<span class="o">[</span><span class="n">Error</span> <span class="bp">-</span> <span class="mi">2</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mi">18</span> <span class="n">PM</span><span class="o">]</span> <span class="n">Request</span> <span class="n">textDocument</span><span class="bp">/</span><span class="n">documentSymbol</span> <span class="n">failed.</span>
<span class="n">Error</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">got</span> <span class="n">disposed.</span>
    <span class="n">at</span> <span class="n">Object.dispose</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">145468</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">Object.dispose</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">225640</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">C.handleConnectionClosed</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">225853</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">C.handleConnectionClosed</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">286241</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">t</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">223942</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">invoke</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">147081</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">o.fire</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">147842</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">Y</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">134726</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">invoke</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">147081</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">o.fire</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">147842</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">m.fireClose</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">159295</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">Socket.</span><span class="bp">&lt;</span><span class="n">anonymous</span><span class="bp">&gt;</span> <span class="o">(</span><span class="bp">/</span><span class="n">Users</span><span class="bp">/</span><span class="n">zzz</span><span class="bp">/.</span><span class="n">vscode</span><span class="bp">/</span><span class="n">extensions</span><span class="bp">/</span><span class="n">leanprover.lean4</span><span class="bp">-</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">20</span><span class="bp">/</span><span class="n">out</span><span class="bp">/</span><span class="n">extension.js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">160080</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">Socket.emit</span> <span class="o">(</span><span class="n">events.js</span><span class="o">:</span><span class="mi">315</span><span class="o">:</span><span class="mi">20</span><span class="o">)</span>
    <span class="n">at</span> <span class="n">Pipe.</span><span class="bp">&lt;</span><span class="n">anonymous</span><span class="bp">&gt;</span> <span class="o">(</span><span class="n">net.js</span><span class="o">:</span><span class="mi">674</span><span class="o">:</span><span class="mi">12</span><span class="o">)</span>
</code></pre></div>



<a name="232020164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vscode-lean4%20Doesn%27t%20Work%20When%20I%20Switch%20Files/near/232020164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html#232020164">(Mar 26 2021 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="248359">@Arjun Viswanathan</span> This might just be an issue with stable. The instructions for the vscode extension say to use the nightly build of lean4, and that does seem to prevent this.</p>



<a name="232024638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/vscode-lean4%20Doesn%27t%20Work%20When%20I%20Switch%20Files/near/232024638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/vscode-lean4.20Doesn't.20Work.20When.20I.20Switch.20Files.html#232024638">(Mar 26 2021 at 20:07)</a>:</h4>
<p>Yup, this has been fixed a few days ago: <a href="https://github.com/leanprover/lean4/pull/344/commits/a266f584d551185703d44e2d3142eeb5c026ce82">https://github.com/leanprover/lean4/pull/344/commits/a266f584d551185703d44e2d3142eeb5c026ce82</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>