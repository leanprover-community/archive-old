---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/match.20gaurds.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html">match gaurds</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272036308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272036308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272036308">(Feb 15 2022 at 20:54)</a>:</h4>
<p>how do i fix this type error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">allPairsAux</span> <span class="o">(</span><span class="n">xs</span><span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ys</span><span class="o">:</span> <span class="n">List</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">accum</span><span class="o">:</span> <span class="n">List</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">))</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">xs</span><span class="o">,</span> <span class="n">ys</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">_</span><span class="o">,</span> <span class="o">[]</span> <span class="bp">=&gt;</span> <span class="n">accum</span>
  <span class="bp">|</span> <span class="o">[],</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">accum</span>
  <span class="bp">|</span> <span class="n">x</span><span class="o">::</span><span class="n">xs</span><span class="o">,</span> <span class="n">y</span><span class="o">::</span><span class="n">ys</span> <span class="bp">=&gt;</span>
    <span class="n">allPairsAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="o">((</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)::</span><span class="n">accum</span><span class="o">)</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span>
  <span class="n">accum</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">List</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="bp">?</span><span class="n">u.18</span> <span class="bp">?</span><span class="n">u.15</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.166</span> <span class="o">:</span> <span class="kt">Sort</span> <span class="bp">?</span><span class="n">u.25</span>
</code></pre></div>



<a name="272036635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272036635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272036635">(Feb 15 2022 at 20:56)</a>:</h4>
<p>should i write out the return type?</p>



<a name="272036692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272036692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272036692">(Feb 15 2022 at 20:56)</a>:</h4>
<p>yeah that fixed it</p>



<a name="272038458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272038458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272038458">(Feb 15 2022 at 21:09)</a>:</h4>
<p>excuse my previous question, i have a new one:</p>
<p>how can i have gaurds on patterns, like in f# i can do</p>
<div class="codehilite" data-code-language="F#"><pre><span></span><code><span class="k">match</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">with</span><span class="w"></span>
</code></pre></div>



<a name="272040057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272040057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272040057">(Feb 15 2022 at 21:22)</a>:</h4>
<p>Afaik Lean doesn't support pattern guards, so you would just write <code>=&gt; if x &gt; 5 then .. else ..</code>.</p>



<a name="272041641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272041641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272041641">(Feb 15 2022 at 21:35)</a>:</h4>
<p>Here's a hacky way to have a pattern guard, where you add an additional boolean discriminant:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">notation</span><span class="o">:</span><span class="mi">50</span> <span class="n">e</span><span class="o">:</span><span class="mi">51</span> <span class="s2">" matches "</span> <span class="n">p</span><span class="o">:</span><span class="mi">0</span> <span class="s2">" where "</span> <span class="n">f</span><span class="o">:</span><span class="mi">0</span> <span class="bp">=&gt;</span> <span class="o">((</span><span class="k">match</span> <span class="n">e</span> <span class="k">with</span> <span class="bp">|</span> <span class="n">p</span> <span class="bp">=&gt;</span> <span class="n">f</span> <span class="bp">|</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">false</span><span class="o">)</span> <span class="o">:</span> <span class="n">Bool</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">foo</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">l</span><span class="o">,</span> <span class="n">l</span> <span class="n">matches</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">_</span><span class="o">)</span> <span class="n">where</span> <span class="n">x</span> <span class="bp">&gt;</span> <span class="mi">5</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">),</span> <span class="n">true</span> <span class="bp">=&gt;</span> <span class="n">xs</span>
  <span class="bp">|</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">l</span>
</code></pre></div>
<p>The <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Notation.lean#L206">matches notation</a> gave me the idea.</p>



<a name="272051294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/match%20gaurds/near/272051294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph O <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/match.20gaurds.html#272051294">(Feb 15 2022 at 23:08)</a>:</h4>
<p>Man, <span class="user-mention" data-user-id="306601">@Kyle Miller</span> you are the master of hacky solutions</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>