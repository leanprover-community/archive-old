---
layout: archive
title: Zulip Chat Archive
permalink: /stream/270676-lean4/topic/Testing.20out.20widgets.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/index.html">lean4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html">Testing out widgets</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="293028833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293028833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293028833">(Aug 12 2022 at 00:08)</a>:</h4>
<p>I just had a moment to try out widgets while traveling. First of all, amazing work! However, I got into few troubles while reading the <a href="https://leanprover.github.io/lean4/doc/examples/widgets.lean.html">doc</a>.</p>
<ol>
<li>It is not explained what "RPC method" is. What does the RPC stand for?</li>
<li>When I copy paste the code snippets the formatting is all messed up. For example copy pasting the <code>getType</code> method to VS Code I get</li>
</ol>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">open</span> <span class="n">Server</span> <span class="n">RequestM</span> <span class="k">in</span>
<span class="kd">@[serverRpcMethod]</span>
<span class="kd">def</span>
<span class="n">getType</span> <span class="o">(</span>
<span class="n">params</span> <span class="o">:</span>
<span class="n">GetTypeParams</span><span class="o">)</span> <span class="o">:</span>
<span class="n">RequestM</span> <span class="o">(</span>
<span class="n">RequestTask</span>
<span class="n">CodeWithInfos</span><span class="o">)</span>
<span class="bp">...</span>
</code></pre></div>
<ol start="3">
<li>When building the rubiks cube example I got an error the following error. I have zero experience with web development, so it is gibberish to me.</li>
</ol>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">error</span><span class="o">:</span> <span class="bp">&gt;</span> <span class="n">npm</span> <span class="n">run</span> <span class="n">build</span> <span class="c1">-- --tsxName rubiks    # in directory ./widget</span>
<span class="n">error</span><span class="o">:</span> <span class="n">stdout</span><span class="o">:</span>

<span class="bp">&gt;</span> <span class="n">rubiks</span><span class="bp">-</span><span class="n">cube</span><span class="bp">@</span><span class="mi">1</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span> <span class="n">build</span> <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">tomass</span><span class="bp">/</span><span class="n">Documents</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">/</span><span class="n">RubiksCube</span><span class="bp">/</span><span class="n">widget</span>
<span class="bp">&gt;</span> <span class="n">rollup</span> <span class="c1">--environment NODE_ENV:production --config "--tsxName" "rubiks"</span>
<span class="n">error</span><span class="o">:</span> <span class="n">stderr</span><span class="o">:</span>
<span class="n">sh</span><span class="o">:</span> <span class="mi">1</span><span class="o">:</span> <span class="n">rollup</span><span class="o">:</span> <span class="n">not</span> <span class="n">found</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">code</span> <span class="n">ELIFECYCLE</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">syscall</span> <span class="n">spawn</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">file</span> <span class="n">sh</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">errno</span> <span class="n">ENOENT</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">rubiks</span><span class="bp">-</span><span class="n">cube</span><span class="bp">@</span><span class="mi">1</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">:</span> <span class="bp">`</span><span class="n">rollup</span> <span class="c1">--environment NODE_ENV:production --config "--tsxName" "rubiks"`</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">spawn</span> <span class="n">ENOENT</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">Failed</span> <span class="n">at</span> <span class="n">the</span> <span class="n">rubiks</span><span class="bp">-</span><span class="n">cube</span><span class="bp">@</span><span class="mi">1</span><span class="bp">.</span><span class="mi">0</span><span class="bp">.</span><span class="mi">0</span> <span class="n">build</span> <span class="n">script.</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">probably</span> <span class="n">not</span> <span class="n">a</span> <span class="n">problem</span> <span class="k">with</span> <span class="n">npm.</span> <span class="n">There</span> <span class="n">is</span> <span class="n">likely</span> <span class="n">additional</span> <span class="n">logging</span> <span class="n">output</span> <span class="n">above.</span>

<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span> <span class="n">A</span> <span class="n">complete</span> <span class="n">log</span> <span class="n">of</span> <span class="n">this</span> <span class="n">run</span> <span class="n">can</span> <span class="n">be</span> <span class="n">found</span> <span class="k">in</span><span class="o">:</span>
<span class="n">npm</span> <span class="n">ERR</span><span class="bp">!</span>     <span class="bp">/</span><span class="n">home</span><span class="bp">/</span><span class="n">tomass</span><span class="bp">/.</span><span class="n">npm</span><span class="bp">/</span><span class="n">_logs</span><span class="bp">/</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">08</span><span class="bp">-</span><span class="mi">11</span><span class="n">T23_53_44_208Z</span><span class="bp">-</span><span class="n">debug.log</span>
<span class="n">error</span><span class="o">:</span> <span class="n">external</span> <span class="n">command</span> <span class="bp">`</span><span class="n">npm</span><span class="bp">`</span> <span class="n">exited</span> <span class="k">with</span> <span class="n">code</span> <span class="mi">1</span>
</code></pre></div>



<a name="293031142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293031142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293031142">(Aug 12 2022 at 00:45)</a>:</h4>
<p>RPC stands for "remote procedure call". It's basically a way for a program running inside VSCode to directly call a function inside the lean executable (or vice versa)</p>



<a name="293031380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293031380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Lovett <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293031380">(Aug 12 2022 at 00:49)</a>:</h4>
<p>Check your npm versions, this is what I'm using:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">base</span><span class="o">)</span> <span class="n">chris</span><span class="bp">@</span><span class="n">clovett15</span><span class="o">:</span><span class="bp">~/</span><span class="n">git</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">/</span><span class="n">RubiksCube</span><span class="bp">/</span><span class="n">widget</span><span class="bp">$</span> <span class="n">npm</span> <span class="c1">--version</span>
<span class="mi">8</span><span class="bp">.</span><span class="mi">5</span><span class="bp">.</span><span class="mi">5</span>
<span class="o">(</span><span class="n">base</span><span class="o">)</span> <span class="n">chris</span><span class="bp">@</span><span class="n">clovett15</span><span class="o">:</span><span class="bp">~/</span><span class="n">git</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">-</span><span class="n">samples</span><span class="bp">/</span><span class="n">RubiksCube</span><span class="bp">/</span><span class="n">widget</span><span class="bp">$</span> <span class="n">node</span> <span class="c1">--version</span>
<span class="n">v16.15.0</span>
</code></pre></div>
<p>then I do this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">cd</span> <span class="n">widget</span>
<span class="n">npm</span> <span class="n">install</span>
<span class="n">cd</span> <span class="bp">..</span>
<span class="n">lake</span> <span class="n">build</span> <span class="n">rubiksJs</span>
<span class="n">lake</span> <span class="n">build</span>
<span class="n">code</span> <span class="bp">.</span>
</code></pre></div>
<p>If you are on Windows you may need some other fixes I'm working on.</p>



<a name="293061128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293061128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293061128">(Aug 12 2022 at 07:52)</a>:</h4>
<blockquote>
<p>When I copy paste the code snippets the formatting is all messed up. For example copy pasting the <code>getType</code> method to VS Code I get</p>
</blockquote>
<p>Ah that's unfortunate. The tutorial is compiled from a literate Lean file <a href="https://github.com/leanprover/lean4/blob/104196e599b3f7ff00ceffec112dc4a705cc279d/doc/examples/widgets.lean">here</a>, we should probably link it from the leanink html. (CC <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> )</p>



<a name="293061968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293061968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293061968">(Aug 12 2022 at 07:57)</a>:</h4>
<blockquote>
<p>When building the rubiks cube example I got an error the following error. I have zero experience with web development, so it is gibberish to me</p>
</blockquote>
<p>It looks like the widget build forgot to install its dependencies. As Chris says, you may have an old Node.js version or something, but it's hard to say. However you should not have to run all these steps yourself. The following two steps suffice for me on a fresh clone:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>lake build rubiksJs
code Rubiks.lean
</code></pre></div>
<p>If these don't suffice, it's a bug I'd say.</p>



<a name="293062521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293062521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293062521">(Aug 12 2022 at 07:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="128280">Wojciech Nawrocki</span> <a href="#narrow/stream/270676-lean4/topic/Testing.20out.20widgets/near/293061128">said</a>:</p>
<blockquote>
<blockquote>
<p>When I copy paste the code snippets the formatting is all messed up. For example copy pasting the <code>getType</code> method to VS Code I get</p>
</blockquote>
<p>Ah that's unfortunate. The tutorial is compiled from a literate Lean file <a href="https://github.com/leanprover/lean4/blob/104196e599b3f7ff00ceffec112dc4a705cc279d/doc/examples/widgets.lean">here</a>, we should probably link it from the leanink html. (CC <span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> )</p>
</blockquote>
<p>We can do that, would be even better to fix this in LeanInk though</p>



<a name="293066267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293066267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293066267">(Aug 12 2022 at 08:32)</a>:</h4>
<blockquote>
<p>It is not explained what "RPC method" is. What does the RPC stand for?</p>
</blockquote>
<p>The acronym is now expanded in the tutorial.</p>



<a name="293090363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293090363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293090363">(Aug 12 2022 at 11:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="128280">Wojciech Nawrocki</span> <a href="#narrow/stream/270676-lean4/topic/Testing.20out.20widgets/near/293061968">said</a>:</p>
<blockquote>
<blockquote>
<p>When building the rubiks cube example I got an error the following error. I have zero experience with web development, so it is gibberish to me</p>
</blockquote>
<p>It looks like the widget build forgot to install its dependencies. As Chris says, you may have an old Node.js version or something, but it's hard to say. However you should not have to run all these steps yourself. The following two steps suffice for me on a fresh clone:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>lake build rubiksJs
code Rubiks.lean
</code></pre></div>
<p>If these don't suffice, it's a bug I'd say.</p>
</blockquote>
<p>This unfortunately does not work for me. </p>
<p>I have <code>npm --version = 6.14.4</code> and <code>nodejs --version = v10.19.0</code>. I guess these are default versions on Ubuuntu 20.04. Do I need to upgrade? (I have tried few upgrade commands from stack exchange but without success yet)</p>



<a name="293094586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293094586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293094586">(Aug 12 2022 at 12:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="346070">Tomas Skrivan</span> <a href="#narrow/stream/270676-lean4/topic/Testing.20out.20widgets/near/293090363">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="128280">Wojciech Nawrocki</span> <a href="#narrow/stream/270676-lean4/topic/Testing.20out.20widgets/near/293061968">said</a>:</p>
<blockquote>
<blockquote>
<p>When building the rubiks cube example I got an error the following error. I have zero experience with web development, so it is gibberish to me</p>
</blockquote>
<p>It looks like the widget build forgot to install its dependencies. As Chris says, you may have an old Node.js version or something, but it's hard to say. However you should not have to run all these steps yourself. The following two steps suffice for me on a fresh clone:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>lake build rubiksJs
code Rubiks.lean
</code></pre></div>
<p>If these don't suffice, it's a bug I'd say.</p>
</blockquote>
<p>This unfortunately does not work for me. </p>
<p>I have <code>npm --version = 6.14.4</code> and <code>nodejs --version = v10.19.0</code>. I guess these are default versions on Ubuuntu 20.04. Do I need to upgrade? (I have tried few upgrade commands from stack exchange but without success yet)</p>
</blockquote>
<p>I see, these are very old versions. I can't say for sure that this will solve the issue but it's definitely worth trying a newer one. A good user-directory installation method is <a href="https://github.com/nvm-sh/nvm">nvm</a>, it'll pull something newer than your distro's version. It works basically like <code>elan</code>.</p>



<a name="293096494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Testing%20out%20widgets/near/293096494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/270676-lean4/topic/Testing.20out.20widgets.html#293096494">(Aug 12 2022 at 12:15)</a>:</h4>
<p>Great, got it working now. It is super cool!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>