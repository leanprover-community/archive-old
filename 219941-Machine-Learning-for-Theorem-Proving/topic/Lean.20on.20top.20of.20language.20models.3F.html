---
layout: archive
title: Zulip Chat Archive
permalink: /stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/index.html">Machine Learning for Theorem Proving</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html">Lean on top of language models?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="312678492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312678492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vadim Fomin <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312678492">(Nov 28 2022 at 17:19)</a>:</h4>
<p>Hey there! I recently joined this community and I want to play around with Lean. My main background is in natural language processing. It's my impression that you can use neural networks for theorem proving by training a large language model and using Lean for verification after generating candidate proofs (e. g. <a href="https://openai.com/blog/formal-math/">this</a>). Can anyone point me to how you can actually use Lean for that sort of stuff automatically, by talking to Lean from Python? (A wrapper or a server with an API would be nice...)</p>



<a name="312682030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312682030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312682030">(Nov 28 2022 at 17:37)</a>:</h4>
<p>the openai project that did that wrote such a wrapper and published it: <a href="https://github.com/openai/lean-gym">https://github.com/openai/lean-gym</a></p>



<a name="312682130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312682130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312682130">(Nov 28 2022 at 17:37)</a>:</h4>
<blockquote>
<p>It's my impression that you can use neural networks for theorem proving by training a large language model and using Lean for verification after generating candidate proofs</p>
</blockquote>
<p>wether that's true I guess is <a href="#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Meta.20IMO.20result/near/311956563">up for debate</a></p>



<a name="312682799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312682799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Timothee Lacroix <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312682799">(Nov 28 2022 at 17:41)</a>:</h4>
<p>Why do you say it's up for debate? <br>
I believe the only debate in the post you linked is about the faithfulness of formal statements in minif2f, not about the use of lean to verify proofs :)</p>
<p>Other useful resources by openai for neural theorem proving and lean : </p>
<p><a href="https://github.com/jesse-michael-han/lean-step-public">https://github.com/jesse-michael-han/lean-step-public</a><br>
<a href="https://github.com/jasonrute/lean_proof_recording">https://github.com/jasonrute/lean_proof_recording</a></p>



<a name="312684577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312684577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Timothee Lacroix <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312684577">(Nov 28 2022 at 17:43)</a>:</h4>
<p>And latest minif2f <a href="https://github.com/facebookresearch/miniF2F">https://github.com/facebookresearch/miniF2F</a></p>



<a name="312684900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312684900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312684900">(Nov 28 2022 at 17:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="359917">Timothee Lacroix</span> <a href="#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F/near/312682799">said</a>:</p>
<blockquote>
<p>Why do you say it's up for debate? <br>
I believe the only debate in the post you linked is about the faithfulness of formal statements in minif2f, not about the use of lean to verify proofs :)<br>
</p>
</blockquote>
<p>oh, sorry, I should have been a bit more precise. I didn't mean that using Lean to verify them was up for debate, but rather how well NLP-based language models transfer over to Lean/formal statements</p>



<a name="312684981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312684981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrés Goens <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312684981">(Nov 28 2022 at 17:45)</a>:</h4>
<p>(thanks for the clarification)</p>



<a name="312685916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312685916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Timothee Lacroix <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312685916">(Nov 28 2022 at 17:50)</a>:</h4>
<p>Ah yeah :) some work remains to be done, that's for sure :D</p>



<a name="312686361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312686361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312686361">(Nov 28 2022 at 17:52)</a>:</h4>
<p>First, it should be pointed out that Lean (and most other ITPs) are designed as computer languages and use-cases like this have been ad-hoc-ly added on top, and don't feel very natural.  For lean, there are three many routes of communication:</p>
<ol>
<li>Metaprogramming: Lean has an extensive meta-programming framework which lets you look at the internals of Lean objects, execute tactics, and just in general communicate with IO in a variety of ways.  The problem is that you have to know Lean's metaprogramming framework (written in Lean) to get anywhere.  The lean-gym mentioned above as well as written in Lean.  If your usecase fits into that, then you don't need to even touch Lean's metaprogramming code, but the API is limited.   The two datasets mentioned above also are gotten via metaprogramming.  Those are the same datasets used by both OpenAI and Meta Research.</li>
<li>C++: Lean 3 is written in C++.  (An aside, Lean 3 will probably be the main version of Lean for about another year or less, while the library is ported to Lean 4.  Lean 4 is mostly written in Lean 4 and has better programming features.  My answer is for Lean 3 since that is where all the proof data is currently located.)  Meta Research wrote (proprietary) code to directly hook into the C++ backend.  However, a small piece of that is available for everyone to use, namely, you can hook up any LLM to Lean's infoview to give suggestions.  (<a class="stream-topic" data-stream-id="113488" href="/#narrow/stream/113488-general/topic/api.20suggestion.20vscode.20integration">#general &gt; api suggestion vscode integration</a>) This is the easies way to use an existing LLM.  Again, the API is particular to their use case and format.</li>
<li>Lean communicates with VS Code, Emacs, etc. via a language server.  It is a simple JSON server that can be used directly.  But there is also a light weight python interface (which is not well maintained) at <a href="https://github.com/leanprover-community/lean-client-python">https://github.com/leanprover-community/lean-client-python</a>.  I could imagine a copilot-like API which directly interacts with the editor or language server.</li>
</ol>



<a name="312687271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312687271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312687271">(Nov 28 2022 at 17:57)</a>:</h4>
<p>As for how to go about training a LLM, it is fairly easy if you have the data (and the GPUs/skills <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span>).  See this talk (<a href="https://www.youtube.com/watch?v=EXpmbAfBNnw">https://www.youtube.com/watch?v=EXpmbAfBNnw</a>) or any of the following papers:</p>
<div class="youtube-video message_inline_image"><a data-id="EXpmbAfBNnw" href="https://www.youtube.com/watch?v=EXpmbAfBNnw"><img src="https://uploads.zulipusercontent.net/bd2a9c6a819c867efb19ea439f4a113b891f5dae/68747470733a2f2f692e7974696d672e636f6d2f76692f4558706d624166424e6e772f64656661756c742e6a7067"></a></div><ul>
<li><a href="https://arxiv.org/abs/2009.03393">Generative Language Modeling for Automated Theorem Proving</a></li>
<li><a href="https://arxiv.org/abs/2102.06203">Proof Artifact Co-training for Theorem Proving with Language Models</a></li>
<li><a href="https://arxiv.org/abs/2202.01344">Formal Mathematics Statement Curriculum Learning</a></li>
<li><a href="https://arxiv.org/abs/2205.10893">Thor: Wielding Hammers to Integrate Language Models and Automated Theorem Provers</a></li>
<li><a href="https://arxiv.org/abs/2205.11491">HyperTree Proof Search for Neural Theorem Proving</a></li>
</ul>



<a name="312687804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312687804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312687804">(Nov 28 2022 at 17:59)</a>:</h4>
<p>If you aren't ITP specific, there is also a toy environment called INT, which is easier to work with:</p>
<ul>
<li>
<p><a href="https://arxiv.org/abs/2007.02924">INT: An Inequality Benchmark for Evaluating Generalization in Theorem Proving
</a></p>
</li>
<li>
<p><a href="https://github.com/albertqjiang/INT">https://github.com/albertqjiang/INT</a></p>
</li>
</ul>



<a name="312688386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312688386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312688386">(Nov 28 2022 at 18:02)</a>:</h4>
<p>And Isabelle also has a publicly available interface for machine learning maintained by <span class="user-mention" data-user-id="258175">@Albert Jiang</span> and others, and used in their papers, including Thor.  I think it is <a href="https://github.com/albertqjiang/Portal-to-ISAbelle">https://github.com/albertqjiang/Portal-to-ISAbelle</a></p>



<a name="312689525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312689525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312689525">(Nov 28 2022 at 18:08)</a>:</h4>
<p>Finally if you want to use pretrained models like GPT-3, Codex, etc.  You could just have that generate whole proofs in one go, with no interaction.   Then you could just interact with Lean via its command line interface, asking it to just check a proof in a file.</p>



<a name="312692813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312692813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vadim Fomin <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312692813">(Nov 28 2022 at 18:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="315434">Andrés Goens</span> <a href="#narrow/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F/near/312682030">said</a>:</p>
<blockquote>
<p>the openai project that did that wrote such a wrapper and published it: <a href="https://github.com/openai/lean-gym">https://github.com/openai/lean-gym</a></p>
</blockquote>
<p>That's specifically what I was looking for, thank you!</p>



<a name="312693372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312693372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vadim Fomin <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312693372">(Nov 28 2022 at 18:26)</a>:</h4>
<p>Thank you Jason, very useful!! Will mess around and probably come back with more questions :)</p>



<a name="312703076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/219941-Machine%20Learning%20for%20Theorem%20Proving/topic/Lean%20on%20top%20of%20language%20models%3F/near/312703076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Vadim Fomin <a href="https://leanprover-community.github.io/archive/stream/219941-Machine-Learning-for-Theorem-Proving/topic/Lean.20on.20top.20of.20language.20models.3F.html#312703076">(Nov 28 2022 at 19:16)</a>:</h4>
<p>I think the most reasonable thing for me would be to figure out how to start a server, and dive into its API</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>