---
layout: archive
title: Zulip Chat Archive
permalink: /stream/341532-lean4-dev/topic/conv.20zoom.20button.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/index.html">lean4 dev</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html">conv zoom button</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="297431842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297431842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297431842">(Sep 06 2022 at 15:42)</a>:</h4>
<p>Let's continue here <span class="user-mention" data-user-id="497000">@Robin Böhne</span> <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> <span class="user-mention" data-user-id="121918">@Edward Ayers</span>, then we don't have to copy any previous discussion if anybody else wants to chime in.</p>



<a name="297432255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432255">(Sep 06 2022 at 15:44)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="497000">@Robin Böhne</span> was about to implement an rpc procedure to set the cursor to a given position, in order to place the cursor after the inserted <code>enter [...]</code> conv command which is inserted by the <code>Zoom</code> button in the infoview</p>



<a name="297432393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432393">(Sep 06 2022 at 15:45)</a>:</h4>
<p>Please more context!  What is <code>Zoom</code>?</p>



<a name="297432622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432622">(Sep 06 2022 at 15:46)</a>:</h4>
<p><span class="user-mention" data-user-id="497000">@Robin Böhne</span> has, as part of his Bachelor project, implemented a button for the Infoview Type Info which lets the user zoom in to a subterm using <code>conv</code></p>



<a name="297432752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432752">(Sep 06 2022 at 15:47)</a>:</h4>
<p>The only part that's missing for it to be smooth is to place the cursor after the commands we insert, so the state after clicking the button is actually the zoomed in one.</p>



<a name="297432763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432763">(Sep 06 2022 at 15:47)</a>:</h4>
<p>Can you please elaborate a bit more?  What is "zoom"?</p>



<a name="297432816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432816">(Sep 06 2022 at 15:47)</a>:</h4>
<p><code>conv {  enter[...] }</code></p>



<a name="297432871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297432871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob von Raumer <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297432871">(Sep 06 2022 at 15:48)</a>:</h4>
<p>Sorry, I have to leave, I'll add more details later, or someone else can <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="297433064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433064">(Sep 06 2022 at 15:48)</a>:</h4>
<p>It sounds to me like "Zoom" is a widget functionality that is a GUI for <code>conv</code> mode?</p>



<a name="297433099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433099">(Sep 06 2022 at 15:49)</a>:</h4>
<p>That's my guess as well.</p>



<a name="297433168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433168">(Sep 06 2022 at 15:49)</a>:</h4>
<p>It would be great if somebody could post a "before" and an "after" state.</p>



<a name="297433261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433261">(Sep 06 2022 at 15:49)</a>:</h4>
<p>And also where this "zoom" button appears.  Is this a button in popups, or somewhere else?</p>



<a name="297433357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433357">(Sep 06 2022 at 15:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/341532-lean4-dev/topic/conv.20zoom.20button/near/297433064">said</a>:</p>
<blockquote>
<p>It sounds to me like "Zoom" is a widget functionality that is a GUI for <code>conv</code> mode?</p>
</blockquote>
<p>Yes, map a subterm in the info view to a <code>conv</code> step making that subterm the "conv goal"</p>



<a name="297433575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Robin Böhne <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433575">(Sep 06 2022 at 15:51)</a>:</h4>
<p>To give a bit more context, what I'm doing is I'm writing a function that makes using conv easier. In the infoview, you can hover over subterm, and I added a "zoom" button to those popups that automatically inserts the correct <code>enter</code> command to get from the goal to the subterm. For example, let's say our goal is <code>x + y = y + x + 0</code>, now we can hover over the second x, click "zoom", and the button will insert <code>enter [2, 1, 2]</code> at the correct position.</p>
<p>For that I used the cursor position, for example, I use it to find the position in the document syntax tree that I need to insert the <code>enter</code> at and I use it to get the goal.</p>



<a name="297433949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297433949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297433949">(Sep 06 2022 at 15:53)</a>:</h4>
<p>The cursor position is going to be super flaky, but okay for a tech preview.  For example, <code>  |rw [xyz]</code> shows a different conv state than <code>  r|w [xyz]</code> (where <code>|</code> is the cursor position).  In one case you'd want to insert the tactic on the line above, in the other one on the line below.</p>



<a name="297434073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297434073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297434073">(Sep 06 2022 at 15:54)</a>:</h4>
<p>(Inserting lines is of course not particularly robust either, but all we've got atm.)</p>



<a name="297434512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297434512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297434512">(Sep 06 2022 at 15:56)</a>:</h4>
<blockquote>
<p>The only part that's missing for it to be smooth is to place the cursor after the commands we insert, so the state after clicking the button is actually the zoomed in one.</p>
</blockquote>
<p>In the private discussion, I understood that the problem was something else, namely that you don't know the position at which you want to insert the tactic.  Can you elaborate on where you're stuck?</p>



<a name="297436003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297436003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Robin Böhne <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297436003">(Sep 06 2022 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/341532-lean4-dev/topic/conv.20zoom.20button/near/297434512">said</a>:</p>
<blockquote>
<blockquote>
<p>The only part that's missing for it to be smooth is to place the cursor after the commands we insert, so the state after clicking the button is actually the zoomed in one.</p>
</blockquote>
<p>In the private discussion, I understood that the problem was something else, namely that you don't know the position at which you want to insert the tactic.  Can you elaborate on where you're stuck?</p>
</blockquote>
<p>Well, I know how to get the position at which I want to insert the tactic from the cursor position. The problem right now is that I can't get the cursor position in the first place. Before, I could just pass the <code>pos</code>property from the popup, but now that the position is hidden in <code>RpcSessionAtPos</code>, I can't get the cursor position anymore.</p>



<a name="297436670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297436670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Robin Böhne <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297436670">(Sep 06 2022 at 16:06)</a>:</h4>
<p>As for placing the cursor at the correct position after inserting, that's an entirely seperate issue</p>



<a name="297437417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297437417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297437417">(Sep 06 2022 at 16:10)</a>:</h4>
<p>Hmm, we could add a <code>InfoPosition</code> React context..</p>



<a name="297439438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/conv%20zoom%20button/near/297439438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Robin Böhne <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/conv.20zoom.20button.html#297439438">(Sep 06 2022 at 16:20)</a>:</h4>
<p>Yes, that could work.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>