---
layout: archive
title: Zulip Chat Archive
permalink: /stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/index.html">lean4 dev</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html">[Compiler] new compiler first phase is active</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="300591215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300591215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300591215">(Sep 24 2022 at 23:04)</a>:</h4>
<p>The new compiler base phase is active at <code>master</code>.<br>
The main drawback is that the <code>.olean</code> are bigger now. They will get smaller after we replace the old code generator with the new one.<br>
We talked about having the new compiler intermediate code in a separate file, but this has not been implemented yet.<br>
The new code generator can compile the main Lean 4 repo, but it certainly contains bugs.<br>
We still need to run experiments and collect statistics for the new generated code.</p>



<a name="300664502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300664502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300664502">(Sep 25 2022 at 15:45)</a>:</h4>
<p>Clarification: the first phase of the new compiler is active, but we are still using the old compiler to generate C code and IR.</p>



<a name="300664799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300664799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300664799">(Sep 25 2022 at 15:48)</a>:</h4>
<p>The whole old compiler, not only those parts, correct?</p>



<a name="300664955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300664955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300664955">(Sep 25 2022 at 15:50)</a>:</h4>
<p>If we want to avoid the size and speed overhead, we could introduce a Lean option for enabling the new compiler, which we would only activate when working on it, and only for stages &gt; 0.</p>



<a name="300665014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300665014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300665014">(Sep 25 2022 at 15:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300664799">said</a>:</p>
<blockquote>
<p>The whole old compiler, not only those parts, correct?</p>
</blockquote>
<p>Yes, the whole old compiler is still being used do generate code.<br>
Then new compiler is being executed, and the result of the base phase is being saved.</p>



<a name="300665445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300665445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300665445">(Sep 25 2022 at 15:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300664955">said</a>:</p>
<blockquote>
<p>If we want to avoid the size and speed overhead, we could introduce a Lean option for enabling the new compiler, which we would only activate when working on it, and only for stages &gt; 0.</p>
</blockquote>
<p>I considered this option, but it is inconvenient because of dependencies. To turn the option on for <code>A.lean</code>, we need it on for all its dependencies.</p>



<a name="300665866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300665866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300665866">(Sep 25 2022 at 15:59)</a>:</h4>
<p>Right, that's why I was thinking of enabling it for an entire stage. It could be as simple as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">+</span>    <span class="bp">//</span> <span class="n">uncomment</span> <span class="n">this</span> <span class="n">to</span> <span class="n">test</span> <span class="n">the</span> <span class="n">new</span> <span class="n">compiler</span>
<span class="bp">+</span>    <span class="bp">//</span><span class="n">opts</span> <span class="bp">=</span> <span class="n">opts.update</span><span class="o">({</span><span class="s2">"compiler"</span><span class="o">,</span> <span class="s2">"new"</span><span class="o">}),</span> <span class="n">true</span><span class="o">)</span><span class="bp">;</span>
</code></pre></div>
<p>in <code>src/stdlib_flags.h</code> (which would automatically limit it to stages &gt; 0).</p>



<a name="300666382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300666382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300666382">(Sep 25 2022 at 16:04)</a>:</h4>
<p>Unless we have a major issue (e.g, <code>Mathlib4</code> cannot be compiled anymore), I prefer to keep it as-is. <br>
This is a temporary annoyance, we hope to replace the current code generator with the new one before the end of the year.</p>



<a name="300666778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300666778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300666778">(Sep 25 2022 at 16:07)</a>:</h4>
<p>Am I right in understanding that it shouldn't actually do anything currently (other than throwing errors if the compiler fails on something)?</p>



<a name="300667225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300667225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300667225">(Sep 25 2022 at 16:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300666778">said</a>:</p>
<blockquote>
<p>Am I right in understanding that it shouldn't actually do anything currently (other than throwing errors if the compiler fails on something)?</p>
</blockquote>
<p>Correct. The new compiler is executing all passes from the base phase, and checking the generated code (type checking, join points, etc) after each pass. <br>
We are also providing APIs for accessing the generated code, adding custom passes, and checks.</p>



<a name="300667553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300667553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300667553">(Sep 25 2022 at 16:15)</a>:</h4>
<p>I assume that running it on std + mathlib won't actually reveal issues then, since even compiler errors are swallowed by the noncomputable checker IIUC</p>



<a name="300667719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300667719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300667719">(Sep 25 2022 at 16:17)</a>:</h4>
<p>I don't think the olean bloat is a problem as long as it's temporary. Seems better to have this stuff available for users who want to use the new APIs</p>



<a name="300667816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300667816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300667816">(Sep 25 2022 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300667553">said</a>:</p>
<blockquote>
<p>I assume that running it on std + mathlib won't actually reveal issues then, since even compiler errors are swallowed by the noncomputable checker IIUC</p>
</blockquote>
<p>The new code generator is a Lean program, errors will <strong>not</strong> be swallowed. I had to fix a bunch of bugs to make sure I could process the Lean 4 repo using it.</p>



<a name="300668050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668050">(Sep 25 2022 at 16:20)</a>:</h4>
<p>Lake has already exposed issues in the new code generator too, and we had to fix some of the new compiler passes we have. The failures are produced by the new code generator <code>Check.lean</code>.</p>



<a name="300668087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668087">(Sep 25 2022 at 16:21)</a>:</h4>
<p>I'll run it later today and see if anything comes up</p>



<a name="300668134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668134">(Sep 25 2022 at 16:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300668087">said</a>:</p>
<blockquote>
<p>I'll run it later today and see if anything comes up</p>
</blockquote>
<p>Thanks. <br>
If you have time to create nasty examples with dependent types, it would be very useful too.</p>



<a name="300668488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668488">(Sep 25 2022 at 16:25)</a>:</h4>
<p>One useful feature is that we can write programs in Lean to analyze the code produced by the new code generator. For example, here are the biggest functions generated by the new code generator. The first column is the size of the generated code.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">2150</span> <span class="n">_private.Init.Meta.0.Lean.Meta.Simp.beqConfig._</span><span class="bp">@.</span><span class="n">Init.Meta._hyg.11775</span>
<span class="mi">2408</span> <span class="n">Lean.Elab.Command.expandMacroArg.mkSyntaxAndPat</span>
<span class="mi">2513</span> <span class="n">Lean.Elab.Term.Do.ToCodeBlock.doForToCode</span>
<span class="mi">2550</span> <span class="n">Lean.Parser.Tactic._aux_Init_Meta___macroRules_Lean_Parser_Tactic_declareSimpLikeTactic_1</span>
<span class="mi">2629</span> <span class="n">Lean.Meta.Closure.collectExprAux</span>
<span class="mi">2735</span> <span class="n">Lean.Elab.Command.expandMacroArg.mkSyntaxAndPat</span>
<span class="mi">2854</span> <span class="n">Lean.Elab.Command.expandMixfix</span>
<span class="mi">2899</span> <span class="n">Lean.Elab.Term.Do.ToTerm.matchNestedTermResult</span>
<span class="mi">3963</span> <span class="n">_private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo</span>
<span class="mi">6038</span> <span class="n">_private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo</span>
<span class="mi">31593</span> <span class="n">Lean.Json.Parser.escapedChar</span>
</code></pre></div>
<p>I found it very useful. The result for <code>Lean.Json.Parser.escapedChar</code> is exposing a code explosion issue at one of the optimizations in the new compiler. I am trying to fix it today.</p>



<a name="300668605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668605">(Sep 25 2022 at 16:26)</a>:</h4>
<p>Do you have the code for that so I can try it on the other repos?</p>



<a name="300668657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668657">(Sep 25 2022 at 16:27)</a>:</h4>
<p>This should also reveal issues in explosion of derive handler generated expressions as well, yes?</p>



<a name="300668694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668694">(Sep 25 2022 at 16:27)</a>:</h4>
<p>I guess huge proofs wouldn't show up though</p>



<a name="300668805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668805">(Sep 25 2022 at 16:29)</a>:</h4>
<p>Why are there two results for <code>getHeadInfo</code> and why are they so different?</p>



<a name="300668864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668864">(Sep 25 2022 at 16:29)</a>:</h4>
<p>We have the function <code>Lean.Compiler.LCNF.forEachDecl f</code> that executes <code>f</code> at each generated declaration.<br>
To generate the table above, I printed the size of all functions</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Lean.Compiler.LCNF.forEachDecl</span> <span class="k">fun</span> <span class="n">decl</span> <span class="bp">=&gt;</span> <span class="k">do</span>
  <span class="n">IO.println</span> <span class="n">s</span><span class="bp">!</span><span class="s2">"{decl.size} {decl.name}"</span>
</code></pre></div>
<p>Then used <code>sort -n out.txt | tail -50</code> to get the biggest ones.</p>



<a name="300668961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300668961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300668961">(Sep 25 2022 at 16:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300668694">said</a>:</p>
<blockquote>
<p>I guess huge proofs wouldn't show up though</p>
</blockquote>
<p>They should not.</p>



<a name="300669027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300669027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300669027">(Sep 25 2022 at 16:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300668805">said</a>:</p>
<blockquote>
<p>Why are there two results for <code>getHeadInfo</code> and why are they so different?</p>
</blockquote>
<p>I did not have time to investigate this issue yet. I am currently working on the <code>31593 Lean.Json.Parser.escapedChar</code> code explosion issue.</p>



<a name="300669141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300669141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300669141">(Sep 25 2022 at 16:32)</a>:</h4>
<p>Another thing worth testing would be the code generated from <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> 's new do notation</p>



<a name="300669335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300669335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300669335">(Sep 25 2022 at 16:34)</a>:</h4>
<p>You can use <code>set_option trace.Compiler.result true</code> before a declaration to instruct Lean to display the new compiler generated (base phase) code for it.</p>



<a name="300669792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300669792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300669792">(Sep 25 2022 at 16:40)</a>:</h4>
<p>The following auxiliary pp options are also useful.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">open</span> <span class="n">Lean.Compiler</span>  <span class="c1">-- enable scoped notation for `lcAny` and `lcErased`</span>
<span class="kd">set_option</span> <span class="n">pp.funBinderTypes</span> <span class="n">true</span>
<span class="kd">set_option</span> <span class="n">pp.letVarTypes</span> <span class="n">true</span>  <span class="c1">-- I seldom use this one, only when debugging</span>
<span class="kd">set_option</span> <span class="n">pp.explicit</span> <span class="n">true</span> <span class="c1">-- I seldom use this one, it displays computationally irrelevant arguments.</span>
<span class="kd">set_option</span> <span class="n">trace.Compiler.result</span> <span class="n">true</span>
</code></pre></div>



<a name="300669896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300669896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300669896">(Sep 25 2022 at 16:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300668657">said</a>:</p>
<blockquote>
<p>This should also reveal issues in explosion of derive handler generated expressions as well, yes?</p>
</blockquote>
<p>Correct.</p>



<a name="300688751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300688751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300688751">(Sep 25 2022 at 20:34)</a>:</h4>
<p>There is a new bug in the std/mathlib linter framework which I think is indirectly caused by this change. The <code>dupNamespace</code> linter tries to fire on <code>Lean.throwError._at_.Lean.throwErrorAt._at_.Lean.resolveGlobalConstNoOverload._at_._aux_Std_Tactic_NormCast_Lemmas___elabRules_commandAddElim__1.spec_1.spec_14.spec_14</code> (I guess because of the duplicated <code>spec_14</code>), but the declaration doesn't exist in the environment which seems impossible since we obtained the declaration by looping over the environment itself</p>



<a name="300688789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300688789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300688789">(Sep 25 2022 at 20:35)</a>:</h4>
<p>are the new compiler defs being added to the environment in a weird way?</p>



<a name="300689154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300689154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300689154">(Sep 25 2022 at 20:40)</a>:</h4>
<p>This is strange, we have a separate map for the new compiler. <br>
<a href="https://github.com/leanprover/lean4/blob/master/src/Lean/Compiler/LCNF/PhaseExt.lean#L23">https://github.com/leanprover/lean4/blob/master/src/Lean/Compiler/LCNF/PhaseExt.lean#L23</a></p>
<p>However, I am using the new API<br>
<a href="https://github.com/leanprover/lean4/blob/master/src/Lean/Environment.lean#L147">https://github.com/leanprover/lean4/blob/master/src/Lean/Environment.lean#L147</a><br>
to store in which module an auxiliary compiler declaration has been created.</p>



<a name="300689973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300689973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300689973">(Sep 25 2022 at 20:51)</a>:</h4>
<p>Here's a MWE:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Lean</span>
<span class="kn">open</span> <span class="n">Lean</span>

<span class="k">#eval</span> <span class="k">show</span> <span class="n">CoreM</span> <span class="n">Unit</span> <span class="k">from</span> <span class="k">do</span>
  <span class="n">for</span> <span class="o">(</span><span class="n">declName</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="k">in</span> <span class="o">(</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">const2ModIdx.toArray</span> <span class="k">do</span>
    <span class="k">if</span> <span class="o">((</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">find</span><span class="bp">?</span> <span class="n">declName</span><span class="o">)</span><span class="bp">.</span><span class="n">isNone</span> <span class="k">then</span>
      <span class="n">println</span><span class="bp">!</span> <span class="s2">"{declName}"</span>
</code></pre></div>
<p>This returns lots of results, we're assuming it should be empty</p>



<a name="300690218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300690218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300690218">(Sep 25 2022 at 20:54)</a>:</h4>
<p>Ah, I guess your pointers are answering this question. The "extra decls" are in <code>const2ModIdx</code> even though they aren't in <code>constants</code></p>



<a name="300690383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300690383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300690383">(Sep 25 2022 at 20:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/300690218">said</a>:</p>
<blockquote>
<p>Ah, I guess your pointers are answering this question. The "extra decls" are in <code>const2ModIdx</code> even though they aren't in <code>constants</code></p>
</blockquote>
<p>Correct.</p>



<a name="300690438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300690438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300690438">(Sep 25 2022 at 20:58)</a>:</h4>
<p>Here's the offending code:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- Get the list of all declarations in the specified package. -/</span>
<span class="kd">def</span> <span class="n">getDeclsInPackage</span> <span class="o">(</span><span class="n">pkg</span> <span class="o">:</span> <span class="n">Name</span><span class="o">)</span> <span class="o">:</span> <span class="n">CoreM</span> <span class="o">(</span><span class="n">Array</span> <span class="n">Name</span><span class="o">)</span> <span class="o">:=</span> <span class="k">do</span>
  <span class="k">let</span> <span class="n">mut</span> <span class="n">decls</span> <span class="bp">←</span> <span class="n">getDeclsInCurrModule</span>
  <span class="n">for</span> <span class="n">decl</span> <span class="k">in</span> <span class="n">decls</span> <span class="k">do</span>
    <span class="n">assert</span><span class="bp">!</span> <span class="o">((</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">find</span><span class="bp">?</span> <span class="n">decl</span><span class="o">)</span><span class="bp">.</span><span class="n">isSome</span>
  <span class="k">let</span> <span class="n">modules</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">header.moduleNames.map</span> <span class="o">(</span><span class="n">pkg.isPrefixOf</span> <span class="bp">·</span><span class="o">)</span>
  <span class="n">for</span> <span class="o">(</span><span class="n">declName</span><span class="o">,</span> <span class="n">moduleIdx</span><span class="o">)</span> <span class="k">in</span> <span class="o">(</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">const2ModIdx.toArray</span> <span class="k">do</span> <span class="c1">-- suspicious</span>
    <span class="k">if</span> <span class="n">modules</span><span class="o">[(</span><span class="n">id</span> <span class="n">moduleIdx</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)]</span><span class="bp">?</span> <span class="bp">==</span> <span class="n">true</span> <span class="k">then</span>
      <span class="n">assert</span><span class="bp">!</span> <span class="o">((</span><span class="bp">←</span> <span class="n">getEnv</span><span class="o">)</span><span class="bp">.</span><span class="n">find</span><span class="bp">?</span> <span class="n">declName</span><span class="o">)</span><span class="bp">.</span><span class="n">isSome</span>
      <span class="n">decls</span> <span class="o">:=</span> <span class="n">decls.push</span> <span class="n">declName</span>
  <span class="n">pure</span> <span class="n">decls</span>
</code></pre></div>
<p>It sounds like we should be looping over <code>constants</code> and just index into <code>const2ModIdx</code> instead of looping over the latter directly</p>



<a name="300690510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300690510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300690510">(Sep 25 2022 at 20:58)</a>:</h4>
<blockquote>
<p>It sounds like we should be looping over constants and just index into const2ModIdx instead of looping over the latter directly</p>
</blockquote>
<p>Correct, or check whether <code>declName</code> is in <code>constants</code> or not.</p>



<a name="300691205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300691205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300691205">(Sep 25 2022 at 21:08)</a>:</h4>
<p>Updated the <code>consts2ModIdx</code> docstring.</p>



<a name="300880829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300880829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300880829">(Sep 26 2022 at 18:57)</a>:</h4>
<p>Oh wow, this change has almost doubled the nightly download size!  It adds 94 megabytes of zstd-compressed files to the releases. :-/</p>



<a name="300881110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/300881110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#300881110">(Sep 26 2022 at 18:59)</a>:</h4>
<p>(This is almost as large as the previous oleans + llvm + clang + two binary builds (.so+.a)).)</p>



<a name="301140846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301140846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301140846">(Sep 28 2022 at 00:41)</a>:</h4>
<p>It has already got a bit better. Here are the Linux zstd file sizes </p>
<ul>
<li>09-20 138 Mb</li>
<li>09-25 232 Mb</li>
<li>09-27 180 Mb</li>
</ul>



<a name="301351925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301351925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301351925">(Sep 29 2022 at 00:46)</a>:</h4>
<p>The size of the biggest functions is also going down.</p>
<ul>
<li>09-26</li>
</ul>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">size</span> <span class="bp">|</span> <span class="n">function</span> <span class="n">name</span>
<span class="c1">--------------------------</span>
<span class="mi">2513</span> <span class="n">Lean.Elab.Term.Do.ToCodeBlock.doForToCode</span>
<span class="mi">2529</span> <span class="n">Lean.Parser.Tactic._aux_Init_Meta___macroRules_Lean_Parser_Tactic_declareSimpLikeTactic_1</span>
<span class="mi">2899</span> <span class="n">Lean.Elab.Term.Do.ToTerm.matchNestedTermResult</span>
<span class="mi">3314</span> <span class="n">_private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo</span>
</code></pre></div>
<ul>
<li>09-28</li>
</ul>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">2073</span> <span class="n">Lean.Parser.Tactic._aux_Init_Meta___macroRules_Lean_Parser_Tactic_declareSimpLikeTactic_1</span>
<span class="mi">2118</span> <span class="n">Lean.Elab.Term.Do.ToCodeBlock.doForToCode</span>
<span class="mi">2348</span> <span class="n">Lean.Elab.Term.Do.ToTerm.matchNestedTermResult</span>
<span class="mi">2990</span> <span class="n">_private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo</span>
</code></pre></div>



<a name="301565485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301565485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301565485">(Sep 30 2022 at 03:14)</a>:</h4>
<ul>
<li>09-29 </li>
</ul>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">1226</span> <span class="n">Lean.Parser.Tactic._aux_Init_Meta___macroRules_Lean_Parser_Tactic_declareSimpLikeTactic_1</span>
<span class="mi">1297</span> <span class="n">Lean.Elab.Term.Do.ToCodeBlock.doForToCode</span>
<span class="mi">1322</span> <span class="n">Lean.Elab.Term.Do.ToTerm.matchNestedTermResult</span>
<span class="mi">1707</span> <span class="n">Lean.Elab.Command.expandMacroArg.mkSyntaxAndPat</span>
<span class="mi">2103</span> <span class="n">_private.Lean.Elab.Quotation.0.Lean.Elab.Term.Quotation.getHeadInfo</span>
</code></pre></div>



<a name="301569874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301569874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301569874">(Sep 30 2022 at 04:39)</a>:</h4>
<p>these metrics are really useful</p>



<a name="301647339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301647339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301647339">(Sep 30 2022 at 13:30)</a>:</h4>
<p>The recent improvements also helped with the Linux zstd file sizes. The Linux zstd files went from 180 to 160 Mb.</p>
<ul>
<li>09-20 138 Mb</li>
<li>09-25 232 Mb</li>
<li>09-27 180 Mb</li>
<li>09-30 160 Mb</li>
</ul>



<a name="301678055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301678055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301678055">(Sep 30 2022 at 15:47)</a>:</h4>
<p>And this is including the old code generator stuff as well right? So we should see another significant decrease in size once we get around to removing that</p>



<a name="301678295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/341532-lean4%20dev/topic/%5BCompiler%5D%20new%20compiler%20first%20phase%20is%20active/near/301678295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Leonardo de Moura <a href="https://leanprover-community.github.io/archive/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active.html#301678295">(Sep 30 2022 at 15:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="395550">Henrik Böving</span> <a href="#narrow/stream/341532-lean4-dev/topic/.5BCompiler.5D.20new.20compiler.20first.20phase.20is.20active/near/301678055">said</a>:</p>
<blockquote>
<p>And this is including the old code generator stuff as well right? So we should see another significant decrease in size once we get around to removing that</p>
</blockquote>
<p>Yes, the .olean contains the old code generator code for its stage1, stage2, and low level IR</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>