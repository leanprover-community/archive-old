---
layout: archive
title: Zulip Chat Archive
permalink: /stream/187764-Lean-for-teaching/topic/Real.20analysis.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/index.html">Lean for teaching</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html">Real analysis</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="196926248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196926248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196926248">(May 08 2020 at 17:35)</a>:</h4>
<p>If I understand correctly, <span class="user-mention" data-user-id="210574">@Patrick Massot</span> has taught a whole real analysis course in Lean.  I would like to do this someday, but as a test last semester I had two real analysis students do some optional exercises:</p>



<a name="196926471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196926471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196926471">(May 08 2020 at 17:37)</a>:</h4>
<p>(By the way, since it was just two students, I could give just a few more difficult problems, rather than working up to them with large numbers of easier problems.)</p>



<a name="196926594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196926594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196926594">(May 08 2020 at 17:38)</a>:</h4>
<p>This is not quite the situation. Students have a whole real analysis course during the first semester with zero Lean (or any proof assistant). They see epsilons during lectures, but the exams are 100% about calculating stuff. During the second semester they have twelve weeks with me, doing two hours of Lean with me. What we cover in those 12 weeks is a strict subset of the first semester course.</p>



<a name="196926867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196926867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196926867">(May 08 2020 at 17:40)</a>:</h4>
<p>project 1:  I wrote a proof that</p>
<div class="codehilite"><pre><span></span><code><span class="n">Lemma</span> <span class="n">limitX</span> <span class="o">:</span> <span class="n">limit</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="bp">=&gt;</span>  <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="o">(</span><span class="n">INR</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">INR</span> <span class="n">n</span><span class="o">)</span><span class="bp">^</span><span class="mi">4</span> <span class="bp">-</span> <span class="mi">3</span> <span class="bp">*</span> <span class="o">(</span><span class="n">INR</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">3</span> <span class="o">))</span> <span class="mi">0</span><span class="bp">.</span>
</code></pre></div>


<p>and had them adapt it to a proof that </p>
<div class="codehilite"><pre><span></span><code><span class="n">Lemma</span> <span class="n">limitX</span> <span class="o">:</span> <span class="n">limit</span> <span class="o">(</span><span class="k">fun</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="bp">=&gt;</span>  <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">3</span><span class="bp">*</span><span class="n">INR</span> <span class="n">n</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">INR</span> <span class="n">n</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">INR</span> <span class="n">n</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)))</span> <span class="o">(</span><span class="mi">5</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span><span class="bp">.</span>
</code></pre></div>



<a name="196927168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927168">(May 08 2020 at 17:42)</a>:</h4>
<p>project 2: I wrote a proof that</p>
<div class="codehilite"><pre><span></span><code><span class="n">Lemma</span> <span class="n">limit_plus</span> <span class="o">:</span>  <span class="k">forall</span> <span class="o">(</span><span class="n">Xn</span> <span class="n">Yn</span><span class="o">:</span><span class="n">nat</span> <span class="bp">-&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span><span class="o">:</span><span class="n">R</span><span class="o">),</span> <span class="n">limit</span> <span class="n">Xn</span> <span class="n">x</span> <span class="bp">-&gt;</span> <span class="n">limit</span> <span class="n">Yn</span> <span class="n">y</span> <span class="bp">-&gt;</span> <span class="n">limit</span> <span class="o">(</span><span class="k">fun</span> <span class="n">n</span><span class="o">:</span><span class="n">nat</span> <span class="bp">=&gt;</span> <span class="n">Xn</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">Yn</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span>
</code></pre></div>


<p>and had them adapt it to a proof that</p>
<div class="codehilite"><pre><span></span><code><span class="n">Lemma</span> <span class="n">limit_mult</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">Xn</span> <span class="n">Yn</span><span class="o">:</span><span class="n">nat</span> <span class="bp">-&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span><span class="o">:</span><span class="n">R</span><span class="o">),</span> <span class="n">limit</span> <span class="n">Xn</span> <span class="n">x</span> <span class="bp">-&gt;</span> <span class="n">limit</span> <span class="n">Yn</span> <span class="n">y</span> <span class="bp">-&gt;</span> <span class="n">limit</span> <span class="o">(</span><span class="k">fun</span> <span class="n">n</span><span class="o">:</span><span class="n">nat</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">Xn</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">Yn</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span><span class="bp">.</span>
</code></pre></div>



<a name="196927487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927487">(May 08 2020 at 17:45)</a>:</h4>
<p>project 3: I indicated this section of the textbook and had them formalize it themselves:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Definition</span> <span class="n">monotone_incr</span> <span class="o">(</span><span class="n">Xn</span><span class="o">:</span><span class="n">nat</span> <span class="bp">-&gt;</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="k">forall</span> <span class="n">n</span><span class="o">:</span><span class="n">nat</span><span class="o">,</span> <span class="o">(</span><span class="n">Xn</span> <span class="n">n</span><span class="o">)</span> <span class="bp">&lt;=</span> <span class="o">(</span><span class="n">Xn</span> <span class="o">(</span><span class="n">S</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span>

<span class="n">Lemma</span> <span class="n">monotone_conv</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">Xn</span><span class="o">:</span><span class="n">nat</span> <span class="bp">-&gt;</span> <span class="n">R</span><span class="o">),</span> <span class="n">monotone_incr</span> <span class="n">Xn</span> <span class="bp">-&gt;</span> <span class="n">bound</span> <span class="o">(</span><span class="k">fun</span> <span class="n">y</span><span class="o">:</span><span class="n">R</span> <span class="bp">=&gt;</span> <span class="o">(</span><span class="n">exists</span> <span class="n">n</span><span class="o">:</span><span class="n">nat</span><span class="o">,</span> <span class="n">Xn</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">y</span><span class="o">))</span> <span class="bp">-&gt;</span> <span class="n">exists</span> <span class="n">x</span><span class="o">:</span><span class="n">R</span><span class="o">,</span> <span class="n">limit</span> <span class="n">Xn</span> <span class="n">x</span><span class="bp">.</span>
</code></pre></div>



<a name="196927510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927510">(May 08 2020 at 17:45)</a>:</h4>
<p><code>INR n</code> is the real number corresponding to the natural number <code>n</code>?</p>



<a name="196927617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927617">(May 08 2020 at 17:46)</a>:</h4>
<p>Yes. (For those new to the thread, this is Coq, not Lean.)</p>



<a name="196927658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927658">(May 08 2020 at 17:46)</a>:</h4>
<p>I am sure there is a clever way to do type conversions in Coq, but since I was new to it myself, I only knew the clunky way.</p>



<a name="196927794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196927794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196927794">(May 08 2020 at 17:47)</a>:</h4>
<p>I am new to Lean but I have already discovered that it has nice type conversion commands!</p>



<a name="196928147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928147">(May 08 2020 at 17:50)</a>:</h4>
<p>You can just coerce in Lean: given <code>n : ℕ</code> you can just talk about <code>n : ℝ</code>. It's great that you're showing mathematicians formal proof verification systems! I use Lean in my undergraduate lectures but it's 100% optional; I run a club on Thursday evenings where people can talk to me about it.</p>



<a name="196928211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928211">(May 08 2020 at 17:51)</a>:</h4>
<p>Did anyone manage to do project 3? It looks pretty tough. Are there good introductions to mathematics in Coq? We're frantically trying to make Lean teaching materials for mathematicians.</p>



<a name="196928292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928292">(May 08 2020 at 17:52)</a>:</h4>
<p>It was a good experience and the students seemed to learn a lot from it (as did I).  I think real analysis is a very good playground for formalized proof:  the proof structures are complicated (all those for-alls and there-exists), but also more or less the same every time, so the students can get the hang of it fast.</p>



<a name="196928376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928376">(May 08 2020 at 17:52)</a>:</h4>
<p>Yes, they did all 3 projects!  I spent a <em>lot</em> of time helping, but they took the big steps themselves.</p>



<a name="196928484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928484">(May 08 2020 at 17:53)</a>:</h4>
<p>I guess I can prove these things in Lean but I have no idea how these things would look like in Coq. Are there specialised tools for solving this sort of thing? For the first lemma I would just show that for n sufficiently large the abs value of the numerator was at most 2n and the abs value of the denominator was at least 1/2*n^4, which would be a bit of a kerfuffle</p>



<a name="196928684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928684">(May 08 2020 at 17:55)</a>:</h4>
<p>For me, the mess of absolute values and epsilons is the point -- I think this is what introductory real analysis course should teach them :)</p>



<a name="196928847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928847">(May 08 2020 at 17:56)</a>:</h4>
<p>I hesitate to say "Coq can't do this or that", because I am also fairly new to Coq -- but I do not know how to do the analogue of a <code>calc</code> proof or <code>library_search</code> in Coq.</p>



<a name="196928901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928901">(May 08 2020 at 17:56)</a>:</h4>
<p>These are both great features of Lean, which make it more natural.  I plan to switch to Lean if/when I do this again.</p>



<a name="196928922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196928922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196928922">(May 08 2020 at 17:56)</a>:</h4>
<p>But conversely you could envisage a more conceptual proof along the lines of "by a tactic, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>4</mn></msup><mo>−</mo><mn>3</mn><mi>n</mi><mo>+</mo><mn>3</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msup><mi>n</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">(n^4-3n+3)/n^4</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> tends to 1, so by a theorem we can replace the denominator by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">n^4</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> etc</p>



<a name="196929031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929031">(May 08 2020 at 17:57)</a>:</h4>
<p>But such a tactic doesn't exist in Lean (although the theorem does) so one would have to work in a more low-level manner. It would not surprise me if one could solve all these questions with a tactic in Isabelle/HOL</p>



<a name="196929152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929152">(May 08 2020 at 17:58)</a>:</h4>
<p>But on the other hand, did you say you were a differential geometer? Trying to define tangent bundles in Isabelle/HOL would be a nightmare, that's why I am using a system with dependent types</p>



<a name="196929444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929444">(May 08 2020 at 18:00)</a>:</h4>
<p>Indeed, it would be possible to write tactics to do all these problems.  But I think the experience of doing them "on paper" as a beginning analysis student is better replicated by typing out the proofs by hand, rather than by invoking a tactic.  My dream is to set a homework assignment full of epsilon-delta problems, and have the computer grade it!</p>



<a name="196929467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929467">(May 08 2020 at 18:00)</a>:</h4>
<p>It would take some guts to do this sort of thing in a differential geometry course though :-) I taught algebraic geometry last term and I formalised about 1/3 of the course but then I got bogged down by the Nullstellensatz and eventually got so far behind that I put the entire thing on hold</p>



<a name="196929594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929594">(May 08 2020 at 18:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196929444" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196929444">said</a>:</p>
<blockquote>
<p>My dream is to set a homework assignment full of epsilon-delta problems, and have the computer grade it!</p>
</blockquote>
<p>Right! The problem is that I don't think my university would at this point buy the idea of forcing 1st years to learn a system such as this. Course they're doing this sort of thing in computer science departments everywhere!</p>



<a name="196929703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929703">(May 08 2020 at 18:02)</a>:</h4>
<p>Though Coq does have one lower-level tactic that helps with these -- it's called <code>nra</code>, "nonlinear real arithmetic", and it's a (limited) nonlinear version of Lean's <code>linarith</code>. Great for inequalities.</p>



<a name="196929782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929782">(May 08 2020 at 18:03)</a>:</h4>
<p>I spent some time today grading Richard Thomas' 1st year analysis exam, and in Q2 he divides by zero! If he'd formalised his solutions in Lean he would have noticed :-)</p>



<a name="196929868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929868">(May 08 2020 at 18:03)</a>:</h4>
<p>So it's not just the teachers who get a better deal if the students are formalising solutions in Lean, the students would also not have to deal with annoying typos in an exam situation</p>



<a name="196929942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929942">(May 08 2020 at 18:04)</a>:</h4>
<p>"2(b): For <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n\geq0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> show that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msqrt><mo>−</mo><msqrt><mi>n</mi></msqrt><mo>≤</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msqrt><mi>n</mi></msqrt></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sqrt{n+1}-\sqrt{n}\leq\frac{1}{2\sqrt{n}}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.17444499999999996em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8655550000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-2.825555em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1080" width="400em"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17444499999999996em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1080" width="400em"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.383108em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6258665em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8059050000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-2.765905em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1080" width="400em"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.234095em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>"</p>



<a name="196929986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196929986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196929986">(May 08 2020 at 18:04)</a>:</h4>
<p>Fortunately I was marking Q3 so I don't get to see what the students thought of that...</p>



<a name="196930012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930012">(May 08 2020 at 18:05)</a>:</h4>
<p>In Lean 1/0=0 so the question is actually false :-)</p>



<a name="196930039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930039">(May 08 2020 at 18:05)</a>:</h4>
<p>One more lower-level tactic that does not exist in Coq, so far as I know, but would be great:  something like <code>ring</code> or <code>linarith</code> but which also manipulates absolute values (at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>a</mi><mi>b</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|ab|=|a||b|</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault">b</span><span class="mord">∣</span></span></span></span>, but maybe also <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>a</mi><mo>+</mo><mi>b</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|a+b|\leq |a|+|b|</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">b</span><span class="mord">∣</span></span></span></span>).  Maybe Lean's <code>simp</code> does this?</p>



<a name="196930065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930065">(May 08 2020 at 18:05)</a>:</h4>
<p>I formalised my exam! But I am a bit of an extremist...</p>



<a name="196930121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930121">(May 08 2020 at 18:05)</a>:</h4>
<p><code>simp</code> only rewrites equalities, so it won't use the triangle inequality</p>



<a name="196930225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930225">(May 08 2020 at 18:06)</a>:</h4>
<p>Oh dear.  That hits close to home, I just corrected an in-progress exam (we are teaching remotely and asynchronously) with a sign error.</p>



<a name="196930276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930276">(May 08 2020 at 18:06)</a>:</h4>
<p>and I don't think <code>linarith</code> uses the triangle inequality either. But I've formalised a bunch of stuff like this in Lean (and got students to formalise more at my club) and the trick is that there are lemmas called things like <code>abs_le</code> and you rewrite those first</p>



<a name="196930323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930323">(May 08 2020 at 18:07)</a>:</h4>
<p>You replace <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">|x|\leq a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">-a\leq x\leq a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord">−</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and then <code>linarith</code> can do its magic</p>



<a name="196930481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930481">(May 08 2020 at 18:08)</a>:</h4>
<p>One of my undergraduates got quite into it and made <a href="https://github.com/JasonKYi/M4000x_LEAN_formalisation" title="https://github.com/JasonKYi/M4000x_LEAN_formalisation">this</a></p>



<a name="196930627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930627">(May 08 2020 at 18:09)</a>:</h4>
<p>!!!</p>



<a name="196930631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930631">(May 08 2020 at 18:09)</a>:</h4>
<p>It's pretty cool what undergraduates can do if you encourage them; he's doing basic stuff with differentiability and continuity in Lean, just formalising the lectures himself -- I taught him Lean and he just decided to go for it. There is a bunch of elementary analysis there.</p>



<a name="196930703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930703">(May 08 2020 at 18:10)</a>:</h4>
<p>It's things like this that make me think that this has a real role to play in education.</p>



<a name="196930758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196930758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196930758">(May 08 2020 at 18:11)</a>:</h4>
<p>and you probably saw the same sort of things too, some students just get good. This place is a really good place for beginners to ask Lean questions, it's a lot more efficient than googling</p>



<a name="196931235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196931235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196931235">(May 08 2020 at 18:15)</a>:</h4>
<p>Yes, indeed.</p>



<a name="196931431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196931431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196931431">(May 08 2020 at 18:16)</a>:</h4>
<p>Did some of the students manage to do the exercises? How hard is it to get Coq up and running? The community have tried to make it really easy to install Lean but it's still a fair amount of work for an 18 year old Windows user who is not used to having to type commands into the command line.</p>



<a name="196931905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196931905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196931905">(May 08 2020 at 18:20)</a>:</h4>
<p>This was just a couple of students, who volunteered to be my guinea pigs.  They did all 3 projects, but I spent a <em>lot</em> of time helping, everything from installation help onwards.</p>



<a name="196931960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196931960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196931960">(May 08 2020 at 18:21)</a>:</h4>
<p>Yeah that's how it is until you reach some basic minimum of competent users.</p>



<a name="196932065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932065">(May 08 2020 at 18:22)</a>:</h4>
<p>The first year I ran my Thursday evening club it was hard work and I lost a lot of people early on. The second time I had a bunch of competent 2nd years and it went much better.</p>



<a name="196932215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932215">(May 08 2020 at 18:23)</a>:</h4>
<p>But I see that Patrick Massot set up his exercises so they run in a <a href="https://www.imo.universite-paris-saclay.fr/~pmassot/enseignement/math114/leanweb/#url=https%3A%2F%2Fwww.imo.universite-paris-saclay.fr%2F~pmassot%2Fenseignement%2Fmath114%2Fleanweb%2F01_egalites.lean" title="https://www.imo.universite-paris-saclay.fr/~pmassot/enseignement/math114/leanweb/#url=https%3A%2F%2Fwww.imo.universite-paris-saclay.fr%2F~pmassot%2Fenseignement%2Fmath114%2Fleanweb%2F01_egalites.lean">browser</a>; I plan to try that next time.</p>



<a name="196932360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932360">(May 08 2020 at 18:25)</a>:</h4>
<p>Yeah, he also wrote tools which mix well-typeset mathematics and Lean, e.g. <a href="http://wwwf.imperial.ac.uk/~buzzard/docs/lean/sandwich.html" title="http://wwwf.imperial.ac.uk/~buzzard/docs/lean/sandwich.html">here</a></p>



<a name="196932392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932392">(May 08 2020 at 18:25)</a>:</h4>
<p>you can click on a line in a proof and then on a grey rectangle to see Lean's tactic state.</p>



<a name="196932424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932424">(May 08 2020 at 18:25)</a>:</h4>
<p>That's great!</p>



<a name="196932433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932433">(May 08 2020 at 18:26)</a>:</h4>
<p>I think there is huge potential here, for crazy formalised books etc</p>



<a name="196932507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932507">(May 08 2020 at 18:26)</a>:</h4>
<p>I just have no idea why software like this has been around for 30+ years but mathematicians haven't adopted it for teaching.</p>



<a name="196932642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932642">(May 08 2020 at 18:27)</a>:</h4>
<p>It would be interesting to re-do the proofs you gave your students in Lean to see if they're more or less painful</p>



<a name="196932968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196932968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196932968">(May 08 2020 at 18:30)</a>:</h4>
<p>I'm pretty sure they'll be less painful.  My naive understanding is that Lean has better type conversion, and it has unicode and <code>calc</code> proofs and <code>library_search</code>, and these more than make up for the loss of <code>nra</code>.</p>



<a name="196933204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196933204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196933204">(May 08 2020 at 18:32)</a>:</h4>
<p>Anyway, yes, this is the future of teaching!  But it's not quite clear when the future will really arrive.</p>



<a name="196933520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196933520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196933520">(May 08 2020 at 18:35)</a>:</h4>
<p>I want <code>nra</code> anyway. What does it do? The trick is to persuade one of the CS people to write it :-)</p>



<a name="196934179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196934179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196934179">(May 08 2020 at 18:41)</a>:</h4>
<p><code>nra</code> : all I know is <a href="https://coq.inria.fr/refman/addendum/micromega.html#coq:tacn.nra" title="https://coq.inria.fr/refman/addendum/micromega.html#coq:tacn.nra">this</a> (1 paragraph of documentation) plus <a href="https://github.com/coq/coq/tree/master/theories/micromega" title="https://github.com/coq/coq/tree/master/theories/micromega">this</a> (source code).  The documentation says it's experimental, but it works well!</p>



<a name="196941091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196941091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196941091">(May 08 2020 at 19:39)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> thanks a lot for your explanations. I'm sorry I had to leave for family duty while you were chatting with Kevin.</p>



<a name="196941263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196941263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196941263">(May 08 2020 at 19:40)</a>:</h4>
<p>About the Coq/Lean comparison: for that kind of mathematics there is clearly no foundational difference at all. It's all about being less user unfriendly (you cannot really hope for the general tool to be really user-friendly) and the surrounding tooling.</p>



<a name="196941403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196941403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196941403">(May 08 2020 at 19:41)</a>:</h4>
<p>I think that unicode + absence of iron curtain is already a big advantage for students. And ongoing work will make things even more friendly. This include Ed Ayers's tactic state widget efforts and of course the whole Lean 4 project. For instance I really look forward to customizable pretty-printing.</p>



<a name="196941690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196941690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196941690">(May 08 2020 at 19:44)</a>:</h4>
<p>My students used Lean is pretty diverse setups. Before the lock-down they had access to computer rooms running Lean + VScode locally. Since the beginning they also have bundle like what I link to at the beginning of <a href="https://www.imo.universite-paris-saclay.fr/~pmassot/enseignement/" title="https://www.imo.universite-paris-saclay.fr/~pmassot/enseignement/">this page</a> (first three links). These are single zip file having everything in one folder (Lean+VScode+extension+library, everything) but without any flexibility to create project or update Lean or mathlib. They also used Lean i the browser as you saw, and Lean on CoCalc.</p>



<a name="196942005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942005">(May 08 2020 at 19:47)</a>:</h4>
<p>My work also involved very very careful choice of exercises to make sure students see almost only the best parts of dependent types. For instance your first project is the opposite of what I did, because it mixes natural number with real numbers. My only exception to this is the sequence <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1/(n+1)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> that is used in several places, but I give all required lemmas about it. My student didn't even prove it goes to zero.</p>



<a name="196942027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942027">(May 08 2020 at 19:47)</a>:</h4>
<p>Your projects 2 to 4 are in my course.</p>



<a name="196942148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942148">(May 08 2020 at 19:48)</a>:</h4>
<p>Thanks!  CoCalc looks like another good option.  Do you have an institutional subscription?  I may try to get one.</p>



<a name="196942367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942367">(May 08 2020 at 19:50)</a>:</h4>
<p>Regarding project 1:  I agree, the switching back and forth between <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">N</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span> is very painful.  I had already decided that if I were to give the same projects again, I would reverse the order of (1) and (2).</p>



<a name="196942435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942435">(May 08 2020 at 19:50)</a>:</h4>
<p>Luckily we now have <code>norm_cast</code> and <code>push_cast</code></p>



<a name="196942621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942621">(May 08 2020 at 19:52)</a>:</h4>
<p>I know we have <code>norm_cast</code>, and this would be a very important part of a course about learning Lean. But I wanted to avoid it at all cost in a course about regular maths using a proof assistant as a tool only.</p>



<a name="196942754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196942754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196942754">(May 08 2020 at 19:53)</a>:</h4>
<p>I guess, I think that doing exercises like project 1 (on paper) is really pedagogically very useful for beginning students.  I set exams that mostly consist of such problems!</p>



<a name="196943094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943094">(May 08 2020 at 19:56)</a>:</h4>
<p>If you want to know more about the big picture here, it's probably useful to know that proof assistants don't have to make limit computation difficult.  You can watch <span class="user-mention" data-user-id="233634">@Manuel Eberl</span> 's <a href="https://www.youtube.com/watch?v=jMjNAhfUpSs&amp;list=PLlF-CfQhukNkWwZt45vkNfWfuO-tBBqPN&amp;index=3&amp;t=0s" title="https://www.youtube.com/watch?v=jMjNAhfUpSs&amp;list=PLlF-CfQhukNkWwZt45vkNfWfuO-tBBqPN&amp;index=3&amp;t=0s">great talk</a> about computing limits in Isabelle.</p>
<div class="youtube-video message_inline_image"><a data-id="jMjNAhfUpSs" href="https://www.youtube.com/watch?v=jMjNAhfUpSs&amp;list=PLlF-CfQhukNkWwZt45vkNfWfuO-tBBqPN&amp;index=3&amp;t=0s" title="https://www.youtube.com/watch?v=jMjNAhfUpSs&amp;list=PLlF-CfQhukNkWwZt45vkNfWfuO-tBBqPN&amp;index=3&amp;t=0s"><img src="https://i.ytimg.com/vi/jMjNAhfUpSs/default.jpg"></a></div>



<a name="196943477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943477">(May 08 2020 at 19:59)</a>:</h4>
<p>For such tasks mathlib is currently light years behind the automation available in Isabelle. In this case there is no fundamental reason. You only need someone with Manuel's skills and enough motivation. One major problem is that those people are academics so they need papers. The first people doing such a thing can get a paper about it. But then the people porting it to other proof assistants still have a lot of work to do without having a paper. I'm exaggerating a bit, but this is a very real issue. Sometimes the solution is to get a MSc student porting things, and learning along the way, but sometimes it's too hard (or there aren't enough students).</p>



<a name="196943489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943489">(May 08 2020 at 19:59)</a>:</h4>
<p>This is very interesting to me, though maybe it's a separate discussion ... Yes, I had seen this work of Manuel Eberl.  But when I do analysis (in research), I really do flail around with inequalities, until some quantity is bounded in some Banach space norm.  It feels much closer to "by-hand" epsilon-delta analysis than to big-O notation.</p>



<a name="196943513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943513">(May 08 2020 at 19:59)</a>:</h4>
<p>Yes, it's a completely separate discussion.</p>



<a name="196943659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943659">(May 08 2020 at 20:00)</a>:</h4>
<p>For me, I am more excited about tools to manipulate inequalities (see the discussion with Kevin above about <code>nra</code> and my <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196930039" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196930039">imagined tactic</a> for the absolute value) than about tools which spit out the limit of any of a specialized class of sequences.</p>



<a name="196943732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943732">(May 08 2020 at 20:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196943477" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196943477">said</a>:</p>
<blockquote>
<p>For such tasks mathlib is currently light years beyond the automation available in Isabelle.</p>
</blockquote>
<p>You mean "behind", I guess</p>



<a name="196943752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943752">(May 08 2020 at 20:01)</a>:</h4>
<p>But probably I am not understanding the full scope of Eberl's work.</p>



<a name="196943791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943791">(May 08 2020 at 20:02)</a>:</h4>
<p>Yes, my English is crappy. Let me edit my post so that less people will be confused.</p>



<a name="196943934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196943934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196943934">(May 08 2020 at 20:02)</a>:</h4>
<p>What a silly idea to have those opposite words so close alphabetically</p>



<a name="196945299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196945299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196945299">(May 08 2020 at 20:15)</a>:</h4>
<p>As I wrote on the general stream, the nra tactic seems like one hour of work by someone knowing how to do that kind of things. What would you want the absolute value tactic to do?</p>



<a name="196945866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196945866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196945866">(May 08 2020 at 20:21)</a>:</h4>
<p>Wow, I did not know that this chat room was "ask and you shall receive" :)</p>



<a name="196946132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946132">(May 08 2020 at 20:23)</a>:</h4>
<p>Sometimes it works surprisingly well</p>



<a name="196946138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946138">(May 08 2020 at 20:23)</a>:</h4>
<p>Sometimes it fails completely</p>



<a name="196946153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946153">(May 08 2020 at 20:23)</a>:</h4>
<p>I would like a tactic that works in (say) normed spaces, that will verify facts of the form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">∥</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">∥</mo><mi>a</mi><mo stretchy="false">∥</mo><mo>+</mo><mo stretchy="false">∥</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert 2a + b\rVert\leq 3\lVert a\rVert +  \lVert b-a\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">∥</span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">∥</span></span></span></span>.</p>



<a name="196946179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946179">(May 08 2020 at 20:24)</a>:</h4>
<p>Do I have two wishes left?</p>



<a name="196946314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946314">(May 08 2020 at 20:25)</a>:</h4>
<p>So, combining features of <code>ring</code> and <code>nra</code>, but also dealing with norms.</p>



<a name="196946775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946775">(May 08 2020 at 20:29)</a>:</h4>
<p>It needs quite a bit more cleverness than <code>ring</code> and <code>nra</code>, unless I'm missing a trick here.</p>



<a name="196946884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946884">(May 08 2020 at 20:30)</a>:</h4>
<p>You need to have the idea of rewriting <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>3</mn><mi>a</mi><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2a+ b = 3a + (b-a)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>. <code>ring</code> doesn't require any idea</p>



<a name="196946911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946911">(May 08 2020 at 20:30)</a>:</h4>
<p><code>ring</code>can check this identity, but not come up with the statement</p>



<a name="196946960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196946960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196946960">(May 08 2020 at 20:31)</a>:</h4>
<p>I think that's right -- I thought about it briefly a while back, couldn't see a deterministic algorithm, so it has to be a matter of writing a good, tailored search.</p>



<a name="196947121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196947121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196947121">(May 08 2020 at 20:32)</a>:</h4>
<p>Of course we can specifically detect goals of the form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi>μ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>z</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\|| x \|| \le \lambda \||y\|| + \mu \||z\||</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mord">∥</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∥</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord">∥</span><span class="mord">∣</span></span></span></span>, but that would be a really specialized tactic</p>



<a name="196947196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196947196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196947196">(May 08 2020 at 20:32)</a>:</h4>
<p>and not good for teaching IMO, since I want students to come up with the idea, and Lean to do automatically things that we wouldn't write on paper.</p>



<a name="196947252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196947252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196947252">(May 08 2020 at 20:33)</a>:</h4>
<p>From that point of view linarith is already too smart sometimes. It closes goals that students would have a hard time doing on paper, especially when there are many inequalities floating around</p>



<a name="196951122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196951122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196951122">(May 08 2020 at 21:10)</a>:</h4>
<p>On the other hand I'd love a Groebner basis tactic and that would definitely prove things which non-puzzle-minded undergraduates would find tricky. Sometimes you just want to get on though</p>



<a name="196951498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196951498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196951498">(May 08 2020 at 21:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196947196" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196947196">said</a>:</p>
<blockquote>
<p>and not good for teaching IMO, since I want students to come up with the idea, and Lean to do automatically things that we wouldn't write on paper.<br>
From that point of view linarith is already too smart sometimes. It closes goals that students would have a hard time doing on paper, especially when there are many inequalities floating around</p>
</blockquote>
<p>Thank you for writing this, I had been thinking this but had not quite put it into words.  For <strong>teaching</strong>, I would like to have a set of tactics, which automate everything that the undergraduate finds obvious (let's say, chains of 3 combinations of the field axioms, the ordering axioms, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>a</mi><mi>b</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|ab|=|a||b|</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault">b</span><span class="mord">∣</span></span></span></span>), and nothing else.</p>



<a name="196952420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196952420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196952420">(May 08 2020 at 21:24)</a>:</h4>
<p>Back to this point ...</p>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196946153" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196946153">said</a>:</p>
<blockquote>
<p>I would like a tactic that works in (say) normed spaces, that will verify facts of the form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">∥</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">∥</mo><mi>a</mi><mo stretchy="false">∥</mo><mo>+</mo><mo stretchy="false">∥</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert 2a + b\rVert\leq 3\lVert a\rVert +  \lVert b-a\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">∥</span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">∥</span></span></span></span>.</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196947121" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196947121">said</a>:</p>
<blockquote>
<p>Of course we can specifically detect goals of the form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi>μ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi><mi>z</mi><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\|| x \|| \le \lambda \||y\|| + \mu \||z\||</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mord">∥</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∥</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class="mord">∥</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord">∥</span><span class="mord">∣</span></span></span></span>, but that would be a really specialized tactic</p>
</blockquote>
<p>I think you understood what I meant (you are an analyst too), but my dream tactic would not just verify that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">∥</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">∥</mo><mi>a</mi><mo stretchy="false">∥</mo><mo>+</mo><mo stretchy="false">∥</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert 2a + b\rVert\leq 3\lVert a\rVert +  \lVert b-a\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">∥</span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">∥</span></span></span></span>, but would invent that fact itself, when faced with hypotheses <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mi>c</mi><mo stretchy="false">∥</mo><mo>≤</mo><mo stretchy="false">∥</mo><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert c\rVert \leq \lVert 2a + b\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">c</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">∥</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mi>a</mi><mo stretchy="false">∥</mo><mo>≤</mo><mo stretchy="false">∥</mo><mi>e</mi><mi>f</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert a\rVert\leq \lVert ef\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mclose">∥</span></span></span></span> (let's say we're in a normed algebra), in order to prove the goal <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∥</mo><mi>c</mi><mo stretchy="false">∥</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">∥</mo><mi>e</mi><mo stretchy="false">∥</mo><mo stretchy="false">∥</mo><mi>f</mi><mo stretchy="false">∥</mo><mo>+</mo><mo stretchy="false">∥</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\lVert c\rVert \leq 3\lVert e\rVert\lVert f\rVert + \lVert b-a\rVert</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">c</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">∥</span><span class="mord mathdefault">e</span><span class="mclose">∥</span><span class="mopen">∥</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">∥</span></span></span></span>.  But I know there is no algorithm for this.</p>



<a name="196952778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196952778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196952778">(May 08 2020 at 21:29)</a>:</h4>
<p>I think that a mix of <code>simp</code>, <code>norm_num</code>, <code>linarith</code> and <code>rewrite_search</code> (not yet in mathlib) would get quite far with such a goal. But it would also be slow.</p>



<a name="196952858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196952858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196952858">(May 08 2020 at 21:30)</a>:</h4>
<p>The nice thing is that some of these tactics can print a tactic script that is longer and less elegant, but faster.</p>



<a name="196953463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196953463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196953463">(May 08 2020 at 21:37)</a>:</h4>
<p>This very nice paper may be of interest: <a href="https://arxiv.org/abs/0904.3482" title="https://arxiv.org/abs/0904.3482">https://arxiv.org/abs/0904.3482</a>.</p>



<a name="196954791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196954791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196954791">(May 08 2020 at 21:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110865">@Jeremy Avigad</span>, thank you for the link.  I am not used to reading logic papers, but is this paper saying that there exists an algorithm which determines the truth of statements like<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mi>d</mi><mo>∈</mo><mi>V</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mo stretchy="false">∥</mo><mi>c</mi><mo stretchy="false">∥</mo><mo>≤</mo><mo stretchy="false">∥</mo><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">∥</mo><mo>∧</mo><mo stretchy="false">∥</mo><mi>a</mi><mo stretchy="false">∥</mo><mo>≤</mo><mo stretchy="false">∥</mo><mi>d</mi><mo stretchy="false">∥</mo><mo stretchy="false">)</mo><mo>⇒</mo><mo stretchy="false">(</mo><mo stretchy="false">∥</mo><mi>c</mi><mo stretchy="false">∥</mo><mo>≤</mo><mn>3</mn><mo stretchy="false">∥</mo><mi>d</mi><mo stretchy="false">∥</mo><mo>+</mo><mo stretchy="false">∥</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">∥</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\forall a,b,c,d\in V,(\lVert c\rVert \leq \lVert 2a+b\rVert\land\lVert a\rVert\leq \lVert d\rVert )\Rightarrow (\lVert c\rVert\leq 3\lVert d\rVert +\lVert b-a\rVert)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">∀</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mopen">∥</span><span class="mord mathdefault">c</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord">2</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">d</span><span class="mclose">∥</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">∥</span><span class="mord mathdefault">c</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">∥</span><span class="mord mathdefault">d</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">∥</span><span class="mclose">)</span></span></span></span><br>
?  If so that's everything I asked for except the extension from vector spaces to algebras.</p>



<a name="196962060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196962060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196962060">(May 08 2020 at 23:35)</a>:</h4>
<p>I think it does suggest that, but it reduces it to the theory of real closed fields, and this is a highly non trivial thing to implement.</p>



<a name="196964823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196964823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196964823">(May 09 2020 at 00:32)</a>:</h4>
<p>In addition to being hard to implement, it's also like doubly exponentially slow, right?</p>



<a name="196964911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196964911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196964911">(May 09 2020 at 00:34)</a>:</h4>
<p>(on the topic of proving inequalities, <a href="http://theory.stanford.edu/~valiant/papers/instanceOpt.pdf" title="http://theory.stanford.edu/~valiant/papers/instanceOpt.pdf">this paper</a> has a nice algorithm for a broad class of cauchy-schwartz-like inequalities)</p>



<a name="196964915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196964915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196964915">(May 09 2020 at 00:34)</a>:</h4>
<p>Yeah, but e^e^3 still isn't very big, and the examples in practice are only that big.</p>



<a name="196964926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196964926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196964926">(May 09 2020 at 00:35)</a>:</h4>
<p>I don't think humans are any better than double exponential.</p>



<a name="196965006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196965006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196965006">(May 09 2020 at 00:37)</a>:</h4>
<p>I think it would be magical (and I don't see any limitation other than engineer hours, which is to say it's not happening anytime soon) to have a server that runs an expensive algorithm like this and memorizes all the queries it's received together with a witness that is much cheaper to check than running the algorithm</p>



<a name="196965965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196965965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196965965">(May 09 2020 at 01:02)</a>:</h4>
<p>Instructive, thanks!</p>



<a name="196974327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196974327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196974327">(May 09 2020 at 05:12)</a>:</h4>
<p><span class="user-mention" data-user-id="252300">@Jalex Stark</span> Are there good witnesses for real closed fields? If you use terms to inhabit the existentials, you can probably bring it down to the quantifier free part but I think it's still pretty hard from there</p>



<a name="196986598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196986598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196986598">(May 09 2020 at 11:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196946132" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196946132">said</a>:</p>
<blockquote>
<blockquote>
<p>Wow, I did not know that this chat room was "ask and you shall receive" :)</p>
</blockquote>
<p>Sometimes it works surprisingly well</p>
</blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/issues/2637" title="https://github.com/leanprover-community/mathlib/issues/2637">https://github.com/leanprover-community/mathlib/issues/2637</a></p>



<a name="196986648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196986648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196986648">(May 09 2020 at 11:18)</a>:</h4>
<p>(deleted)</p>



<a name="196988216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196988216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196988216">(May 09 2020 at 11:55)</a>:</h4>
<p>hmm. I guess I come from a world where every proof can be made exponentially shorter by using a PCP. <br>
but I guess we need deterministic proofs, and  I don't have any particular ideas here.</p>



<a name="196988374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196988374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196988374">(May 09 2020 at 11:58)</a>:</h4>
<p>I like nondeterministic proofs</p>



<a name="196988435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196988435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196988435">(May 09 2020 at 12:00)</a>:</h4>
<p>To put it another way, I'm specifically interested in whether there is an NP algorithm for real closed fields that is faster than double exponential</p>



<a name="196989628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196989628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196989628">(May 09 2020 at 12:32)</a>:</h4>
<p>Okay, so we have a doubly-exponential NP-type proof, which is just a transcript of the deterministic algorithm. Standard pcp machinery can give us a pcp of the same length. That's a doubly-exponentially long proof string such that if the theorem is false, then you can find a hole with constant probability by checking only a constant number of random locations. Of course, checking a random location in a doubly-exponentially long string requires exponentially much randomness.</p>



<a name="196989702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196989702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196989702">(May 09 2020 at 12:34)</a>:</h4>
<p>what does pcp stand for here? I thought it was post correspondence problem but I don't see the relation</p>



<a name="196989726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196989726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196989726">(May 09 2020 at 12:35)</a>:</h4>
<p>Probabilistically checkable proof</p>



<a name="196989772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196989772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196989772">(May 09 2020 at 12:36)</a>:</h4>
<p>I edited out the false thing above, which makes the already-not-good-enough thing a bit worse</p>



<a name="196989779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196989779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196989779">(May 09 2020 at 12:37)</a>:</h4>
<p>Oh I see. I think these aren't good enough for lean, even with an oracle (the human, or mathematica, etc)</p>



<a name="196990683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/196990683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#196990683">(May 09 2020 at 13:01)</a>:</h4>
<p>okay, that's sad but also what I expected</p>



<a name="197002571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197002571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197002571">(May 09 2020 at 17:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196986598" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196986598">said</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Wow, I did not know that this chat room was "ask and you shall receive" :)</p>
</blockquote>
<p>Sometimes it works surprisingly well</p>
</blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/issues/2637" title="https://github.com/leanprover-community/mathlib/issues/2637">https://github.com/leanprover-community/mathlib/issues/2637</a></p>
</blockquote>
<p>So cool, thank you!!</p>



<a name="197061677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197061677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197061677">(May 10 2020 at 15:31)</a>:</h4>
<p>I keep meaning to do these Coq projects in Lean but marking keeps getting in the way :-(. I think the way I would do the first one would be to prove that the limit of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>n</mi><mn>4</mn></msup><mo>−</mo><mn>3</mn><mi>n</mi><mo>+</mo><mn>3</mn></mrow><msup><mi>n</mi><mn>4</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{n^4-3n+3}{n^4}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.36292em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01792em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">3</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> is 1 and then use the calculus of limits to reduce the question to finding the limit of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mi>n</mi><mo>+</mo><mn>5</mn></mrow><msup><mi>n</mi><mn>4</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{(-1)^nn+5}{n^4}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. In general I think I would want a lemma saying that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="double-struck">R</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">p(x)\in\R[x]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">R</span></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span> has degree <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> then the limit of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><msup><mi>n</mi><mi>d</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{p(n)}{n^d}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.3674199999999999em;vertical-align:-0.3574199999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.64258em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7820285714285713em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3574199999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> is the leading term of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>. If these things aren't in the library I'm going to have to start getting my hands dirty. But this seems to be a nice way to a "conceptual" proof of the projects.</p>



<a name="197061730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197061730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197061730">(May 10 2020 at 15:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> how would you do this <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196926867" title="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196926867">https://leanprover.zulipchat.com/#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/196926867</a> in Lean?</p>



<a name="197258593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197258593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197258593">(May 12 2020 at 10:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197002571">said</a>:</p>
<blockquote>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/issues/2637">https://github.com/leanprover-community/mathlib/issues/2637</a></p>
</blockquote>
<p>So cool, thank you!!</p>
</blockquote>
<p>It would be nice if you could give us a list of half a dozen goals the Coq version can solve (and you find useful if possible) so they can be added as tests to the Lean version.</p>



<a name="197345103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197345103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197345103">(May 12 2020 at 21:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> , how is this for a start?  Adapted from my student's proof that products preserve limits.  Let me know if the tests should be more or less focused than this (eg is it useful to have irrelevant hypotheses, random function applications that the parser has to treat as blocks, etc?  Or should the examples be truly minimal?)</p>
<p>In Coq, using <code>nra</code>, I can do</p>
<div class="codehilite"><pre><span></span><code><span class="n">Lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="n">A</span> <span class="bp">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span><span class="bp">.</span>
<span class="n">Proof</span><span class="bp">.</span>
  <span class="n">nra</span><span class="bp">.</span>
<span class="n">Qed</span><span class="bp">.</span>
</code></pre></div>


<p>The best I can figure out in Lean (without the new <code>nlinarith</code>) is</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">A</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">calc</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span>
    <span class="bp">=</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_3</span> <span class="n">a_6</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_8</span><span class="o">)</span> <span class="n">h1</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">a_6</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_1</span> <span class="n">a_6</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">&lt;</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="n">add_le_add_right&#39;</span> <span class="o">(</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_2</span> <span class="n">h2</span><span class="o">)</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>(I would also be interested to hear if there are any tricks that would shorten the above proof.)</p>



<a name="197346096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346096">(May 12 2020 at 22:05)</a>:</h4>
<p>Yes, this is a very good start.</p>



<a name="197346208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346208">(May 12 2020 at 22:06)</a>:</h4>
<p>(a few edits to the above, as </p>
<blockquote>
<p>The best I can figure out in Lean</p>
</blockquote>
<p>improves)</p>



<a name="197346315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346315">(May 12 2020 at 22:07)</a>:</h4>
<p>I don't know if you noticed, but you can follow the conversation at <a href="https://github.com/leanprover-community/mathlib/pull/2637">https://github.com/leanprover-community/mathlib/pull/2637</a></p>



<a name="197346481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346481">(May 12 2020 at 22:09)</a>:</h4>
<p>About your Lean code, you probably missed the fact you can feed <code>linarith</code> a list of facts to use.</p>



<a name="197346625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346625">(May 12 2020 at 22:10)</a>:</h4>
<p>So <code>linarith</code> would replace the explicit <code>add_le_add_right'</code> invocations, is that correct?</p>



<a name="197346660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346660">(May 12 2020 at 22:10)</a>:</h4>
<p>Yes</p>



<a name="197346682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346682">(May 12 2020 at 22:11)</a>:</h4>
<p>For instance you can begin your <code>calc</code> with</p>
<div class="codehilite"><pre><span></span><code>  <span class="k">calc</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span>
      <span class="bp">≤</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="o">)</span> <span class="o">:</span>  <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">,</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">]</span>
</code></pre></div>



<a name="197346719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346719">(May 12 2020 at 22:11)</a>:</h4>
<p>But this is still crappy. We really need that new tactic here</p>



<a name="197346821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197346821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197346821">(May 12 2020 at 22:12)</a>:</h4>
<p>Still, that's better, thanks!</p>



<a name="197347456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197347456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197347456">(May 12 2020 at 22:19)</a>:</h4>
<p>Here's what I can reduce to using the trick you told me.  It's interesting to me that two invocations of <code>ring</code> cannot be removed.  I had thought that <code>linarith</code> subsumed <code>ring</code>, but it seems not.</p>
<div class="codehilite"><pre><span></span><code><span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">A</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">calc</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span>
      <span class="bp">≤</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_3</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_8</span><span class="o">)</span> <span class="n">h1</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_1</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">&lt;</span> <span class="n">B</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_2</span> <span class="n">h2</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="197347508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197347508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197347508">(May 12 2020 at 22:19)</a>:</h4>
<p>Coq's <code>nra</code> is clearly doing more than it claims in the documentation. There's no comparison between <code>y</code> and <code>0</code>, so its preprocessing shouldn't learn anything new about <code>u*y</code>. This should just be treated as an atom that it knows nothing about, and it shouldn't find a proof.</p>



<a name="197347786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197347786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197347786">(May 12 2020 at 22:22)</a>:</h4>
<blockquote>
<p>I had thought that linarith subsumed ring, but it seems not.</p>
</blockquote>
<p>I'm surprised <code>linarith</code> doesn't solve the first <code>ring</code> goal. In the second, <code>linarith</code> won't know to identify <code>B*A</code> with <code>A*B</code>.</p>



<a name="197347860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197347860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197347860">(May 12 2020 at 22:23)</a>:</h4>
<p>Oh, it's because <code>2*A*B</code> is <code>(2*A)*B</code>.</p>



<a name="197347900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197347900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197347900">(May 12 2020 at 22:23)</a>:</h4>
<p>Conjecture:  The <a href="https://coq.inria.fr/refman/addendum/micromega.html">tactic family</a> containing <code>nra</code> also contains <code>psatz</code>, which has the same purpose (nonlinear arithmetic) but uses a different algorithm.  Perhaps at some point <code>psatz</code> was determined to be better and <code>nra</code> now just is an alias for <code>psatz</code>.</p>



<a name="197348048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348048">(May 12 2020 at 22:25)</a>:</h4>
<p>Could be! I can dig a little deeper tomorrow.</p>



<a name="197348150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348150">(May 12 2020 at 22:26)</a>:</h4>
<p>Here's the <a href="https://github.com/coq/coq/tree/master/theories/micromega">source code</a>; I couldn't make head nor tail of it, but you surely can.</p>



<a name="197348472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348472">(May 12 2020 at 22:30)</a>:</h4>
<p>I've made it as far as <a href="https://github.com/coq/coq/blob/fb7292570380e0490d7c74db1718725149996ffd/plugins/micromega/certificate.ml#L486-L500">here</a>, which seems to be where the actual work is</p>



<a name="197348477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348477">(May 12 2020 at 22:30)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">A</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">calc</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span>
      <span class="bp">≤</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_3</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_8</span><span class="o">)</span> <span class="n">h1</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_1</span> <span class="n">a_6</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">linarith</span> <span class="o">[</span><span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_2</span> <span class="n">h2</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>

<span class="kn">end</span>
</code></pre></div>



<a name="197348614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348614">(May 12 2020 at 22:31)</a>:</h4>
<p>Aha, <a href="https://github.com/coq/coq/blob/fb7292570380e0490d7c74db1718725149996ffd/plugins/micromega/certificate.ml#L448-L451">nlinear_preprocess</a> is the preprocessor</p>



<a name="197348842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348842">(May 12 2020 at 22:34)</a>:</h4>
<p>Not claiming this is really better, but</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">A</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_3</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_8</span><span class="o">)</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_1</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_2</span> <span class="n">h2</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_comm</span> <span class="n">A</span> <span class="n">B</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
  <span class="n">linarith</span>
<span class="kn">end</span>
</code></pre></div>



<a name="197348935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197348935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197348935">(May 12 2020 at 22:35)</a>:</h4>
<p>I think what they failed to mention is that constraints are already normalized to <code>0 &lt;= x</code>, <code>0 &lt; x</code> or <code>0 = x</code></p>



<a name="197351762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197351762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197351762">(May 12 2020 at 23:08)</a>:</h4>
<p>One more quick example, also solved by <code>nra</code> in Coq:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">mul_pos&#39;</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="197352767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197352767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197352767">(May 12 2020 at 23:24)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hA</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">hB</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">mul_pos&#39;</span><span class="bp">;</span> <span class="n">linarith</span>
</code></pre></div>



<a name="197353831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197353831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197353831">(May 12 2020 at 23:41)</a>:</h4>
<p>If my mental model of <code>nra</code> is correct, it should be doing this:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_nonneg</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">sub_nonneg_of_le</span> <span class="n">a_1</span><span class="o">),</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>but evidently that doesn't work</p>



<a name="197354798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197354798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197354798">(May 12 2020 at 23:57)</a>:</h4>
<p>Actually, I think it's also doing normalization into monomials first as well. So it's more like</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_nonneg</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">sub_nonneg_of_le</span> <span class="n">a_1</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mul_sub</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">rw</span> <span class="k">show</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">=</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">/</span> <span class="mi">8</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>which does work</p>



<a name="197354871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197354871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197354871">(May 12 2020 at 23:58)</a>:</h4>
<p>I don't think it's going to be possible to support this without getting into the weeds of <code>linarith</code></p>



<a name="197363077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197363077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197363077">(May 13 2020 at 02:29)</a>:</h4>
<p>I guess the point is that Coq's <code>lra</code> behaves differently from <code>linarith</code>?  In particular, as we <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197347456">discussed earlier</a>, it subsumes <code>ring</code>, whereas <code>linarith</code> does not.  For example, if I directly translate to Coq the <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197348842">code written</a> by <span class="user-mention" data-user-id="110596">@Rob Lewis</span> above, I can cut the two lines</p>
<div class="codehilite"><pre><span></span><code>  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_comm</span> <span class="n">A</span> <span class="n">B</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">ring</span><span class="o">,</span>
</code></pre></div>


<p>i.e., just the following works:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Require</span> <span class="n">Import</span> <span class="n">Rbase</span><span class="bp">.</span>
<span class="n">Require</span> <span class="n">Import</span> <span class="n">Psatz</span><span class="bp">.</span>
<span class="n">Local</span> <span class="n">Open</span> <span class="n">Scope</span> <span class="n">R_scope</span><span class="bp">.</span>

<span class="n">Lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="n">A</span> <span class="bp">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">-&gt;</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span><span class="bp">.</span>
<span class="n">Proof</span><span class="bp">.</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">a_1</span> <span class="n">a_2</span> <span class="n">a_3</span> <span class="n">a_4</span> <span class="n">a_5</span> <span class="n">a_6</span> <span class="n">a_7</span> <span class="n">a_8</span><span class="bp">.</span>
  <span class="n">assert</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">B</span><span class="o">)</span> <span class="k">by</span> <span class="n">lra</span><span class="bp">.</span>
  <span class="n">assert</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">A</span><span class="o">)</span> <span class="k">by</span> <span class="n">lra</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_l</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_5</span> <span class="n">a_4</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_r</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">h1</span> <span class="o">(</span><span class="n">Rlt_le</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_7</span><span class="o">)</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_l</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_6</span> <span class="n">a_3</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_r</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">h1</span> <span class="o">(</span><span class="n">Rlt_le</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_8</span><span class="o">)</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_r</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_6</span> <span class="o">(</span><span class="n">Rlt_le</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_7</span><span class="o">)</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_r</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">a_6</span> <span class="n">a_1</span><span class="bp">.</span>
  <span class="n">pose</span> <span class="k">proof</span> <span class="n">Rmult_le_compat_r</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">h2</span> <span class="n">a_2</span><span class="bp">.</span>
  <span class="n">lra</span><span class="bp">.</span>
<span class="n">Qed</span><span class="bp">.</span>
</code></pre></div>



<a name="197389999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197389999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197389999">(May 13 2020 at 09:51)</a>:</h4>
<p>Yep. Coq clearly does some kind of normalization of atoms in <code>lra</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">Require</span> <span class="kn">Import</span>  <span class="n">Psatz</span> <span class="n">Rbase</span><span class="o">.</span>
<span class="kn">Open</span> <span class="kn">Scope</span> <span class="n">R_scope</span><span class="o">.</span>

<span class="kn">Lemma</span> <span class="n">test2</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">.</span>
<span class="kn">Proof</span><span class="o">.</span>
  <span class="n">lra</span><span class="o">.</span>
<span class="kn">Qed</span><span class="o">.</span>
</code></pre></div>


<p><code>*</code> associates to the left, so it figures out that <code>(3*u)*v</code> is actually <code>3*(u*v)</code> where <code>u*v</code> is the atom it cares about.</p>



<a name="197390220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197390220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197390220">(May 13 2020 at 09:53)</a>:</h4>
<p><code>linarith</code> could actually be adapted to do that one pretty easily, but this one is more surprising:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">Lemma</span> <span class="n">test2</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">u</span><span class="o">.</span>
<span class="kn">Proof</span><span class="o">.</span>
  <span class="n">lra</span><span class="o">.</span>
<span class="kn">Qed</span><span class="o">.</span>
</code></pre></div>



<a name="197390362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197390362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197390362">(May 13 2020 at 09:55)</a>:</h4>
<p>It must be calling <code>ring</code> on the atoms? This sounds super expensive.</p>



<a name="197390635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197390635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197390635">(May 13 2020 at 09:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> is there an API for <code>ring</code>-without-proofs? Like, I give it an <code>expr</code> and get a ring-normalized <code>expr</code> back without a proof that they're equal.</p>



<a name="197398086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197398086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197398086">(May 13 2020 at 11:22)</a>:</h4>
<p>I have a partially working <code>linarith</code> that handles this at least. It needs efficiency improvements to be used in practice, and should become part of the more expensive <code>linarith!</code>. But there's a bug in <code>ring</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>

<span class="c1">-- loops</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="c1">-- ring,</span>
<span class="kn">end</span>
</code></pre></div>


<p>Haven't investigated yet.</p>



<a name="197427151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197427151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197427151">(May 13 2020 at 15:15)</a>:</h4>
<p>I'm now marking my Lean exam. I didn't teach them the <code>assumption</code> tactic because that's one more tactic to learn and <code>exact</code> is good enough. Hence they use <code>linarith</code> instead of <code>assumption</code>. <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="197430247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197430247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197430247">(May 13 2020 at 15:35)</a>:</h4>
<p>Students are efficient, they do what works!  After my ones learned that <code>nra</code> did effectively anything, I think I saw them use it to prove that <code>2 * u = u + u</code>  :)</p>



<a name="197430847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197430847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197430847">(May 13 2020 at 15:38)</a>:</h4>
<p>I prove <code>0&lt;1</code> with <code>norm_num</code> because it's fewer characters than <code>exact zero_lt_one</code> and <code>exact dec_trivial</code>.</p>



<a name="197431023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197431023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197431023">(May 13 2020 at 15:39)</a>:</h4>
<p>When I give advice to people writing new tactics, I tell them that their users will abuse them in every way possible. They need to be foolproof. This is why the new <code>norm_cast</code> figures out attributes for you automatically.</p>



<a name="197431113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197431113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197431113">(May 13 2020 at 15:40)</a>:</h4>
<p>Both those uses are fair. I don't want to waste student neurons on remembering the names of whatever specifically prove <code>2 * u = u + u</code> or <code>0 &lt; 1</code>.</p>



<a name="197431123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197431123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197431123">(May 13 2020 at 15:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197430847">said</a>:</p>
<blockquote>
<p>I prove <code>0&lt;1</code> with <code>norm_num</code> because it's fewer characters than <code>exact zero_lt_one</code> and <code>exact dec_trivial</code>.</p>
</blockquote>
<p>This doesn't sound like abuse though, that's exactly the situation <code>norm_num</code> is designed for!</p>



<a name="197444197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197444197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197444197">(May 13 2020 at 17:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197390635">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> is there an API for <code>ring</code>-without-proofs? Like, I give it an <code>expr</code> and get a ring-normalized <code>expr</code> back without a proof that they're equal.</p>
</blockquote>
<p>No, but why would you want that? If you are normalizing the context, you will probably want to associate proofs during that phase too</p>



<a name="197449079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449079">(May 13 2020 at 17:38)</a>:</h4>
<p>Linarith works using ring for verification. It does ~no proving of its own, including in the step where it identifies atoms. So that step just needs to ask "are these exprs syntactically eq or defeq or ring-eq" depending on the context. Then it builds the linear problem, computes the coefficients, and if <code>ring</code> claimed that things were equal before, it should normalize them away in the end.</p>



<a name="197449329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449329">(May 13 2020 at 17:40)</a>:</h4>
<p>But there's a related "issue," the order of appearance of arguments to <code>ring</code> affects the normal form. This is kind of expected, since you need a deterministic term order. But <code>A*B</code> and <code>B*A</code> don't normalize to the same thing if you normalize them separately.</p>



<a name="197449555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449555">(May 13 2020 at 17:42)</a>:</h4>
<p>You should be operating in the <code>ring_m</code> monad</p>



<a name="197449569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449569">(May 13 2020 at 17:42)</a>:</h4>
<p>or in your own monad that extends it</p>



<a name="197449604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449604">(May 13 2020 at 17:42)</a>:</h4>
<p>that way you can share atoms between invocations</p>



<a name="197449976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/197449976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#197449976">(May 13 2020 at 17:45)</a>:</h4>
<p>Okay, that solves one issue. But I still can't get the normal form without a proof, right?</p>



<a name="200151209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200151209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200151209">(Jun 08 2020 at 20:22)</a>:</h4>
<p>I have an update to <code>linarith</code> that makes some progress here, effectively doing normalization of monomials+. It handles <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> 's example</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_nonneg</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">sub_nonneg_of_le</span> <span class="n">a_1</span><span class="o">),</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>and <span class="user-mention" data-user-id="260507">@Heather Macbeth</span> 's example cutting the two ugliest lines from the ugly proof. But in combination with Mario's nonlinear preprocessing it still doesn't match <code>nra</code> -- Heather's example still fails.</p>



<a name="200151356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200151356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200151356">(Jun 08 2020 at 20:23)</a>:</h4>
<p>AFAICT <code>linarith</code> is now comparable to <code>lra</code>, and <code>nlinarith</code> does everything the documentation of <code>nra</code> claims. So <code>nra</code> must be doing something extra.</p>



<a name="200151751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200151751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200151751">(Jun 08 2020 at 20:27)</a>:</h4>
<p>This fails:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">nlinarith</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>but this succeeds:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">nlinarith</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>so maybe <code>nra</code> is working with a bit more than just comparisons with 0?</p>



<a name="200151803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200151803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200151803">(Jun 08 2020 at 20:27)</a>:</h4>
<p>New <code>linarith</code> is here, btw: <a href="https://github.com/leanprover-community/mathlib/tree/linarith-update">https://github.com/leanprover-community/mathlib/tree/linarith-update</a></p>



<a name="200161303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200161303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200161303">(Jun 08 2020 at 22:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/200151209">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> 's example cutting the two ugliest lines from the ugly proof.</p>
</blockquote>
<p>Thanks for the update!  What do you mean by the "two ugliest lines", is it the two I could cut from a Lean/<code>linarith</code> proof <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197363077">here</a> while preserving a working Coq/<code>lra</code> proof?</p>



<a name="200161863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200161863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200161863">(Jun 08 2020 at 22:07)</a>:</h4>
<p>Yep! This works now, the Lean equivalent of your <code>lra</code> proof.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">y</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">≤</span> <span class="n">v</span> <span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="bp">→</span> <span class="o">(</span><span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">A</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_4</span> <span class="n">a_5</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_left</span> <span class="n">a_3</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_8</span><span class="o">)</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="o">(</span><span class="n">le_of_lt</span> <span class="n">a_7</span><span class="o">)</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_1</span> <span class="n">a_6</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">mul_le_mul_of_nonneg_right</span> <span class="n">a_2</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">linarith</span>
<span class="kn">end</span>
</code></pre></div>



<a name="200162148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200162148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200162148">(Jun 08 2020 at 22:10)</a>:</h4>
<p>As for the secret sauce of <code>nra</code>, one trivial possibility.  There was this discovery of Mario's:<br>
<span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/187764-Lean-for.20teaching/topic/Real.20analysis/near/197348935">said</a>:</p>
<blockquote>
<p>I think what they failed to mention is that constraints are already normalized to <code>0 &lt;= x</code>, <code>0 &lt; x</code> or <code>0 = x</code></p>
</blockquote>
<p>Is your <code>nlinarith</code> doing the same?</p>



<a name="200162894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200162894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200162894">(Jun 08 2020 at 22:20)</a>:</h4>
<p>I didn't update <code>nlinarith</code> beyond what Mario did, but no, I don't think it's doing that. At a glance I don't think that's what's going on, but maybe..</p>



<a name="200182000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200182000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200182000">(Jun 09 2020 at 04:46)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> I think that normalizing should be sufficient, but I think <code>linarith</code> is currently blocked by lack of normalization in cases like this:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">/</span> <span class="mi">8</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span> <span class="c1">-- fail</span>
</code></pre></div>


<p>which would be normalized by <code>ring</code> but are probably being treated as distinct by <code>linarith</code></p>



<a name="200182156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200182156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200182156">(Jun 09 2020 at 04:51)</a>:</h4>
<p>Assuming that <code>linarith</code> is able to normalize both of these terms to <code>1/8 * atom(A*B)</code>, it should be sufficient to normalize inequalities to <code>0 &lt;= x</code> to prove</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">nlinarith</span>
</code></pre></div>


<p>because the preprocessing will produce </p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">*</span> <span class="o">(</span><span class="n">B</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">:</span>
  <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span>
</code></pre></div>


<p>and I can confirm that after monomial processing <code>linarith</code> is able to prove this goal:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">B</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">-</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
  <span class="mi">0</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="bp">/</span><span class="mi">8</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span> <span class="c1">--works</span>
</code></pre></div>



<a name="200190198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200190198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200190198">(Jun 09 2020 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> did you see the <code>linarith</code> update I mentioned above? <a href="https://github.com/leanprover-community/mathlib/issues/2995">#2995</a></p>



<a name="200190241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200190241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200190241">(Jun 09 2020 at 07:40)</a>:</h4>
<p>It proves </p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="bp">/</span> <span class="mi">8</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">linarith</span>
</code></pre></div>



<a name="200190253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200190253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200190253">(Jun 09 2020 at 07:40)</a>:</h4>
<p>But not </p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">B</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">B</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">nlinarith</span>
</code></pre></div>



<a name="200190255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200190255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200190255">(Jun 09 2020 at 07:40)</a>:</h4>
<p>I saw it after this message; I saw that you noticed something similar</p>



<a name="200190285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200190285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200190285">(Jun 09 2020 at 07:41)</a>:</h4>
<p>Note that you have to be able to reduce <code>A * (B - 1)</code> to <code>A * B - A * 1</code> during monomial processing</p>



<a name="200197968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200197968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200197968">(Jun 09 2020 at 09:06)</a>:</h4>
<p>Okay, yeah, I think you're right. Normalizing hypotheses to <code>0 &lt;</code> and running the current <code>nlinarith</code> preprocessing creates a problem that <code>lra</code> can solve. In principle <code>linarith</code> should solve it too, but it hits an implementation bottleneck. Fixable in theory, <code>lra</code> is more or less instant.</p>



<a name="200198006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200198006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200198006">(Jun 09 2020 at 09:06)</a>:</h4>
<p>(This is on the more complicated example.)</p>



<a name="200198211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200198211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200198211">(Jun 09 2020 at 09:08)</a>:</h4>
<p>It did give me a stack overflow in JSCoq but the native version has no trouble, heh.</p>



<a name="200198412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200198412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200198412">(Jun 09 2020 at 09:10)</a>:</h4>
<p>ooh, how have I not heard about jscoq before</p>



<a name="200216335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200216335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200216335">(Jun 09 2020 at 12:18)</a>:</h4>
<p>Confirmed. I refactored linarith to avoid a very expensive comparison between <code>rb_map</code>s. Surprised that didn't turn up as a bottleneck earlier. It now solves this (~8 seconds on my laptop, so still room for improvement).</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">test7</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="n">x</span> <span class="n">y</span> <span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span>
<span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_1</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">A</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">B</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_3</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">B</span> <span class="bp">-</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_4</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">B</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_5</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">u</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_6</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;=</span> <span class="n">v</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_7</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">-</span> <span class="n">u</span><span class="o">)</span>
<span class="o">(</span><span class="n">a_8</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">A</span> <span class="bp">-</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span>
 <span class="n">u</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">v</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">u</span> <span class="bp">*</span> <span class="n">v</span> <span class="bp">&lt;</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">A</span> <span class="bp">*</span> <span class="n">B</span> <span class="o">:=</span>
 <span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">nlinarith</span>
 <span class="kn">end</span>
</code></pre></div>



<a name="200216401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200216401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200216401">(Jun 09 2020 at 12:19)</a>:</h4>
<p>So the <code>nlinarith</code> preprocessing just needs to normalize things to <code>0 &lt;</code> before running, and we're there.</p>



<a name="200218684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200218684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200218684">(Jun 09 2020 at 12:31)</a>:</h4>
<p>Doesn't <code>linarith</code> already have to do this preprocessing? Perhaps <code>linarith</code> can split this processing out as a separate function so that <code>nlinarith</code> can insert itself after this processing but before the main work</p>



<a name="200220086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200220086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200220086">(Jun 09 2020 at 12:37)</a>:</h4>
<p>Yes, this can be part of a refactor of the whole <code>linarith</code> frontend.</p>



<a name="200220266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/187764-Lean%20for%20teaching/topic/Real%20analysis/near/200220266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/187764-Lean-for-teaching/topic/Real.20analysis.html#200220266">(Jun 09 2020 at 12:37)</a>:</h4>
<p>Thank you very much Rob and Mario for taking time to work on this.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>