---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/More.20elegant.20way.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html">More elegant way?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="199767051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767051">(Jun 04 2020 at 15:47)</a>:</h4>
<p>What could be a more elegant way to solve this? It looks like too many steps:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">example</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">/</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">ring</span><span class="o">,</span>
<span class="n">refine</span> <span class="o">(</span><span class="n">inv_mul_cancel</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="n">intro</span><span class="o">,</span>
<span class="n">linarith</span> <span class="o">[(</span><span class="n">real</span><span class="bp">.</span><span class="n">sqrt_eq_zero</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">))</span><span class="bp">.</span><span class="n">mp</span> <span class="n">a</span><span class="o">],</span>
<span class="kn">end</span>
</code></pre></div>



<a name="199767331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767331">(Jun 04 2020 at 15:49)</a>:</h4>
<p>you're missing <code>import tactic</code> to make this a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>



<a name="199767481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767481">(Jun 04 2020 at 15:50)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">example</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">/</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">ring</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">(</span><span class="n">inv_mul_cancel</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">norm_num</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="199767531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767531">(Jun 04 2020 at 15:50)</a>:</h4>
<p><code>norm_num</code> is the first thing i hit up when i want to prove something is not <code>0</code></p>



<a name="199767535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767535">(Jun 04 2020 at 15:50)</a>:</h4>
<p>Oh so sorry! How does it work for me?</p>



<a name="199767591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767591">(Jun 04 2020 at 15:51)</a>:</h4>
<p>uh, I assume you're running this codeblock inside of a file that already imported <code>tactic</code>?</p>



<a name="199767663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767663">(Jun 04 2020 at 15:51)</a>:</h4>
<p>oh, nevermind, I just had one of those "lean spits out a temporary error before it finishes compiling". I guess <code>data.real.basic</code> imports <code>tactic</code>?</p>



<a name="199767737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767737">(Jun 04 2020 at 15:52)</a>:</h4>
<p>Yup, certainly</p>



<a name="199767747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767747">(Jun 04 2020 at 15:52)</a>:</h4>
<p>No, it's just it's own file [Screen-Shot-2020-06-04-at-10.51.51-AM.png]<br>
(<a href="user_uploads/3121/gsrQOXPpBtrhTLj9BVx3OMdt/Screen-Shot-2020-06-04-at-10.51.51-AM.png">https://leanprover.zulipchat.com/user_uploads/3121/gsrQOXPpBtrhTLj9BVx3OMdt/Screen-Shot-2020-06-04-at-10.51.51-AM.png</a>)</p>
<div class="message_inline_image"><a href="user_uploads/3121/gsrQOXPpBtrhTLj9BVx3OMdt/Screen-Shot-2020-06-04-at-10.51.51-AM.png" title="https://leanprover.zulipchat.com/user_uploads/3121/gsrQOXPpBtrhTLj9BVx3OMdt/Screen-Shot-2020-06-04-at-10.51.51-AM.png"><img src="user_uploads/3121/gsrQOXPpBtrhTLj9BVx3OMdt/Screen-Shot-2020-06-04-at-10.51.51-AM.png"></a></div>



<a name="199767912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767912">(Jun 04 2020 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="252300">@Jalex Stark</span> Ah cool. Thanks for the <code>norm_num</code> hint.</p>



<a name="199767915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199767915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199767915">(Jun 04 2020 at 15:53)</a>:</h4>
<p>it's working for me now, too. the problem was on my end.</p>



<a name="199768045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199768045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199768045">(Jun 04 2020 at 15:54)</a>:</h4>
<p>you can just use <code>rw</code> instead of <code>refine</code></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">example</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">/</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">ring</span><span class="o">,</span> <span class="n">rw</span> <span class="n">inv_mul_cancel</span><span class="o">,</span> <span class="n">norm_num</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="199768138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199768138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199768138">(Jun 04 2020 at 15:54)</a>:</h4>
<p><code>rw</code> is usually how iff statements are meant to be used</p>



<a name="199768432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199768432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199768432">(Jun 04 2020 at 15:55)</a>:</h4>
<p>Very nice!</p>



<a name="199768617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199768617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199768617">(Jun 04 2020 at 15:56)</a>:</h4>
<p>I see <code>norm_num</code> still has a lot to improve...</p>



<a name="199768834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199768834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199768834">(Jun 04 2020 at 15:58)</a>:</h4>
<p>? do you want norm_num to be able to do everything ring can?</p>



<a name="199769296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199769296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199769296">(Jun 04 2020 at 16:00)</a>:</h4>
<p><code>norm_num</code> should close this goal without any help.</p>



<a name="199776359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776359">(Jun 04 2020 at 16:51)</a>:</h4>
<p>We can improve <code>norm_num</code> be writing the right simp lemmas</p>



<a name="199776467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776467">(Jun 04 2020 at 16:52)</a>:</h4>
<p>This might be related to Yury's recent question of making the <code>field_simp</code> simpset a subset of the normal simpset.</p>



<a name="199776564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776564">(Jun 04 2020 at 16:52)</a>:</h4>
<p>at some point it needs to know that it's supposed to prove a denominator is not equal to 0</p>



<a name="199776653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776653">(Jun 04 2020 at 16:53)</a>:</h4>
<p><code>field_simp</code> doesn't do any denominator-clearing unless you pass it a proof that something is not 0</p>



<a name="199776746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776746">(Jun 04 2020 at 16:54)</a>:</h4>
<p>I think <code>simp only [inv_mul_cancel]</code>doesn't do anything here</p>



<a name="199776788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776788">(Jun 04 2020 at 16:54)</a>:</h4>
<p>That's true. Still... since there are no variables here, I think that in principle <code>norm_num</code> ought to be able to tackle this alone.</p>



<a name="199776842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199776842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199776842">(Jun 04 2020 at 16:54)</a>:</h4>
<p>Yes, my point is that there is no variable.</p>



<a name="199777061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199777061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199777061">(Jun 04 2020 at 16:56)</a>:</h4>
<p>I guess the first target is</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">/</span><span class="mi">2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">norm_num</span>
</code></pre></div>



<a name="199777376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199777376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199777376">(Jun 04 2020 at 16:58)</a>:</h4>
<p>oh, norm_num does handle that, I should have tried it first...</p>



<a name="199777476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199777476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199777476">(Jun 04 2020 at 16:59)</a>:</h4>
<p>but not </p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">):=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="199777661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199777661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199777661">(Jun 04 2020 at 17:00)</a>:</h4>
<p>should I raise an issue?</p>



<a name="199778503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199778503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199778503">(Jun 04 2020 at 17:06)</a>:</h4>
<p>We can ask <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  first.</p>



<a name="199797724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797724">(Jun 04 2020 at 19:33)</a>:</h4>
<p>What do you think norm_num is? It can't just evaluate arbitrary real number expressions. (That's undecidable, remember?)</p>



<a name="199797788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797788">(Jun 04 2020 at 19:33)</a>:</h4>
<p>But this one isn't arbitrary!</p>



<a name="199797857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797857">(Jun 04 2020 at 19:34)</a>:</h4>
<p>More seriously... can we add some special tags or lemmas that will teach norm_num to evaluate this</p>



<a name="199797886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797886">(Jun 04 2020 at 19:34)</a>:</h4>
<p>Even though norm_num nominally works on real number expressions, that's only if they in fact describe rationals</p>



<a name="199797903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797903">(Jun 04 2020 at 19:34)</a>:</h4>
<p>Algebraic numbers are decidable right? (I actually don't know but they feel decidable!)</p>



<a name="199797978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199797978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199797978">(Jun 04 2020 at 19:34)</a>:</h4>
<p>Galois theory says yes</p>



<a name="199798006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798006">(Jun 04 2020 at 19:34)</a>:</h4>
<p>Algebraic numbers are decidable, yes. The algorithm is very complicated and I've never done it although I've looked at the proof</p>



<a name="199798017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798017">(Jun 04 2020 at 19:34)</a>:</h4>
<p>I guess you don't actually need galois theory for that</p>



<a name="199798049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798049">(Jun 04 2020 at 19:34)</a>:</h4>
<p>something to do with permanents</p>



<a name="199798113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798113">(Jun 04 2020 at 19:35)</a>:</h4>
<p>You probably need some float approximation too?</p>



<a name="199798119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798119">(Jun 04 2020 at 19:35)</a>:</h4>
<p>no</p>



<a name="199798171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798171">(Jun 04 2020 at 19:35)</a>:</h4>
<p>That might give a speed up, maybe?</p>



<a name="199798321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798321">(Jun 04 2020 at 19:36)</a>:</h4>
<p>Hmm interesting, I figured the operations would all be with the minimal polynomials, but then you need some approximation to distinguish roots occasionally</p>



<a name="199798336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798336">(Jun 04 2020 at 19:36)</a>:</h4>
<p>Evaluating algebraic numbers is a component in CAD</p>



<a name="199798365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798365">(Jun 04 2020 at 19:36)</a>:</h4>
<p><a href="http://fredrikj.net/calcium/index.html">http://fredrikj.net/calcium/index.html</a></p>



<a name="199798388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798388">(Jun 04 2020 at 19:36)</a>:</h4>
<p>and that needs some approximation too</p>



<a name="199798445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798445">(Jun 04 2020 at 19:36)</a>:</h4>
<p>You can express approximation problems as <code>alg_1 &lt; alg_2</code></p>



<a name="199798487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798487">(Jun 04 2020 at 19:37)</a>:</h4>
<p>His qqbar implementation uses some root finding, which is what put the idea in my head, its cool that its not needed!</p>



<a name="199798802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798802">(Jun 04 2020 at 19:39)</a>:</h4>
<p>There are multiple ways to express algebraic numbers. A minimal polynomial is not enough because polynomials have several roots. You can number and order them but this still basically requires you to locate all the roots. One popular method is to put a box around the root you want that excludes all the others</p>



<a name="199798928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199798928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199798928">(Jun 04 2020 at 19:40)</a>:</h4>
<p>another trick (for real algebraics) is to use the sequence of signs of all the derivatives of the minimal polynomial at the target number. Perhaps surprisingly this determines which root uniquely</p>



<a name="199799028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799028">(Jun 04 2020 at 19:41)</a>:</h4>
<p>But square roots are easier, right</p>



<a name="199799061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799061">(Jun 04 2020 at 19:41)</a>:</h4>
<p>Human beings have no problem calculating with roots and powers</p>



<a name="199799078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799078">(Jun 04 2020 at 19:41)</a>:</h4>
<p>They are acting more like simp though</p>



<a name="199799130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799130">(Jun 04 2020 at 19:42)</a>:</h4>
<p>So maybe <code>quadratic_closure rat</code> is tractible?</p>



<a name="199799148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799148">(Jun 04 2020 at 19:42)</a>:</h4>
<p>I don't think this is an appropriate goal for <code>norm_num</code></p>



<a name="199799154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799154">(Jun 04 2020 at 19:42)</a>:</h4>
<p>Yup... so we need some simp lemmas</p>



<a name="199799368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799368">(Jun 04 2020 at 19:44)</a>:</h4>
<p>I know people love their kitchen sink tactics, but I really think I should take a stand and say that this is out of scope for <code>norm_num</code>. <code>norm_num</code> assumes that all evaluable expressions have a normal form that is a rational numeral. Here that is not the case</p>



<a name="199799481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799481">(Jun 04 2020 at 19:45)</a>:</h4>
<p>It is really best if the tactic knows in advance what the normal form is. Currently we are using separate tactics for separate normal forms for separate decision procedures, e.g. <code>ring</code> vs <code>abel</code> vs <code>norm_num</code></p>



<a name="199799943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199799943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199799943">(Jun 04 2020 at 19:49)</a>:</h4>
<p>Ok, that's fine. Then we just need a new tactic.</p>



<a name="199811575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199811575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199811575">(Jun 04 2020 at 21:37)</a>:</h4>
<p>How does <code>field_simp</code> fare?</p>



<a name="199811766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199811766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199811766">(Jun 04 2020 at 21:39)</a>:</h4>
<p>It should be possible to prove this with <code>ring++</code></p>



<a name="199812023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199812023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199812023">(Jun 04 2020 at 21:41)</a>:</h4>
<p><code>field_simp</code> should work if you pass it a sqrt positivity lemma and use <code>norm_num</code> as discharger</p>



<a name="199993269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199993269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Walter Moreira <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199993269">(Jun 06 2020 at 21:09)</a>:</h4>
<p>As a continuation of this question,  I'm able to prove in one line that <code>phi^2 - phi - 1 = 0</code>, and deduce from there that <code>phi^2 = phi + 1</code>.</p>
<p>But when I try to prove directly that <code>phi^2 = phi + 1</code> (last example) I cannot find a simple chain of <code>rw</code>s to prove it.  Am I missing some more powerful technique for this?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">def</span> <span class="n">phi</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">phi_sol</span> <span class="o">:</span> <span class="n">phi</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">-</span> <span class="n">phi</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">unfold</span> <span class="n">phi</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="n">rw</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqr_sqrt</span><span class="bp">;</span> <span class="n">norm_num</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">phi</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="n">phi</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">rw</span> <span class="o">[</span><span class="err">←</span><span class="n">sub_eq_zero</span><span class="o">,</span> <span class="n">sub_add_eq_sub_sub</span><span class="o">,</span> <span class="n">phi_sol</span><span class="o">],</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">phi</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="n">phi</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">unfold</span> <span class="n">phi</span><span class="o">,</span>
<span class="n">sorry</span>
<span class="kn">end</span>
</code></pre></div>



<a name="199993564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199993564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199993564">(Jun 06 2020 at 21:18)</a>:</h4>
<p>I think this is again a trivial case of the missing Grobner basis tactic.</p>



<a name="199993569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/More%20elegant%20way%3F/near/199993569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/More.20elegant.20way.3F.html#199993569">(Jun 06 2020 at 21:18)</a>:</h4>
<p>Here you can <code>apply eq_of_sub_eq_zero</code> then <code>rw</code> and <code>ring</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>