---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/semialgebra.20setminus.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html">semialgebra setminus</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="230585444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230585444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230585444">(Mar 16 2021 at 20:27)</a>:</h4>
<p>What's wrong here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.finset.basic</span>

<span class="kn">open</span> <span class="n">set</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">semialgebra'</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">semialgebra'</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">semialgebra'</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">s1</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">s2</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_difference</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">)),</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="o">(</span><span class="n">finset.bUnion</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">s</span> <span class="bp">\</span> <span class="n">t</span><span class="o">)</span>

<span class="c1">-- type mismatch at application</span>
<span class="c1">--   has_sdiff.sdiff s</span>
<span class="c1">-- term</span>
<span class="c1">--   s</span>
<span class="c1">-- has type</span>
<span class="c1">--   set (set α) : Type ?</span>
<span class="c1">-- but is expected to have type</span>
<span class="c1">--   (set α → finset ?m_1) → finset ?m_1 : Type (max ? ?)</span>
</code></pre></div>



<a name="230588040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230588040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230588040">(Mar 16 2021 at 20:45)</a>:</h4>
<p>I think your definition has too many levels of nested sets,  <code>set X</code> is the power set <code>set (set X)</code> is subsets of the power set but <code>set (set X)) \to Prop</code> is another condition on those, so a further power set.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.finset.basic</span>

<span class="kn">open</span> <span class="n">set</span>


<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_difference</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">t</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="bp">∀</span> <span class="n">s'</span> <span class="bp">∈</span> <span class="n">c</span><span class="o">,</span> <span class="n">in_semialgebra</span> <span class="n">s'</span> <span class="bp">→</span> <span class="o">(</span><span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">s</span> <span class="bp">\</span> <span class="n">t</span><span class="o">)</span>
</code></pre></div>
<p>looks more like what I read on <a href="https://en.wikibooks.org/wiki/Measure_Theory/Basic_Structures_And_Definitions/Semialgebras,_Algebras_and_%CF%83-algebras">https://en.wikibooks.org/wiki/Measure_Theory/Basic_Structures_And_Definitions/Semialgebras,_Algebras_and_%CF%83-algebras</a> if that's what youre trying.</p>



<a name="230588120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230588120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230588120">(Mar 16 2021 at 20:45)</a>:</h4>
<p>I had to cast the finset to a set to take the set <a href="https://leanprover-community.github.io/mathlib_docs/find/set.sUnion">docs#set.sUnion</a> and also deleted the repeated introduction of alpha.</p>



<a name="230589174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230589174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230589174">(Mar 16 2021 at 20:52)</a>:</h4>
<p>I guess that page also includes a pairwise disjoint condition which is missing from what I wrote</p>



<a name="230591214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230591214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230591214">(Mar 16 2021 at 21:05)</a>:</h4>
<p>I see. That <code>in_</code> naming scheme is very clarifying. I was confused thinking the first component's argument was the semialgebra instead of a member of it.</p>



<a name="230599628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230599628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230599628">(Mar 16 2021 at 22:06)</a>:</h4>
<p><a href="/user_uploads/3121/cVZ6MAxOJy0zVmrTiVWYqC3u/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/cVZ6MAxOJy0zVmrTiVWYqC3u/image.png" title="image.png"><img src="/user_uploads/3121/cVZ6MAxOJy0zVmrTiVWYqC3u/image.png"></a></div><p>is the "disjoint" condition actually doing any work or can I just delete it?</p>



<a name="230599893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230599893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230599893">(Mar 16 2021 at 22:07)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.finset.basic</span>

<span class="kn">open</span> <span class="n">set</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">semialgebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
</code></pre></div>



<a name="230601067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230601067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230601067">(Mar 16 2021 at 22:13)</a>:</h4>
<p>(Also, why is that definition so different from the one on wikibooks)</p>



<a name="230782024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230782024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230782024">(Mar 17 2021 at 22:46)</a>:</h4>
<p>I thought it was gonna ask me to show that empty is <em>in</em> <code>I</code>, but it's asking for nullset <em>equals</em> <code>I</code>. I guess I've made the same mistake again, but I don't see how.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="bp">//</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">Icc</span> <span class="n">a</span> <span class="n">b</span><span class="o">})</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">I</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="n">heq</span> <span class="n">I</span><span class="o">,</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="n">_</span>
<span class="o">}</span>

<span class="c1">-- don't know how to synthesize placeholder</span>
<span class="c1">-- context:</span>
<span class="c1">-- I : {s // ∃ (a b : ℝ), s = Icc a b}</span>
<span class="c1">-- ⊢ I == ∅</span>
</code></pre></div>



<a name="230783343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230783343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230783343">(Mar 17 2021 at 22:59)</a>:</h4>
<p>Are you sure you want <code>heq I</code> as your <code>in_semi_algebra</code>?</p>



<a name="230783391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230783391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230783391">(Mar 17 2021 at 22:59)</a>:</h4>
<p>It's very rare to want <a href="https://leanprover-community.github.io/mathlib_docs/find/heq">docs#heq</a> unless you're really running into dependently-typed trouble</p>



<a name="230783605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230783605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230783605">(Mar 17 2021 at 23:01)</a>:</h4>
<p>Is it possible you wanted this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="c1">-- the semialgebra contains closed intervals of ℝ</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">Icc</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="gr">sorry</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="o">}</span>
</code></pre></div>



<a name="230783872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230783872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230783872">(Mar 17 2021 at 23:03)</a>:</h4>
<p>That looks more right, I'll try that</p>



<a name="230784060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230784060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230784060">(Mar 17 2021 at 23:05)</a>:</h4>
<p>I guess that's actually asking me to show <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">[0,0] = \emptyset</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span> which probably isn't true. So maybe my statement of the problem is broken in the first place.</p>



<a name="230788168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230788168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230788168">(Mar 17 2021 at 23:51)</a>:</h4>
<p>Oh yeah, I forgot what closed meant!</p>



<a name="230925159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230925159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230925159">(Mar 18 2021 at 19:36)</a>:</h4>
<p>What is this error?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>


<span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="n">s</span> <span class="bp">=</span> <span class="bp">∅</span> <span class="bp">∨</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>  <span class="o">(</span><span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">)),</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="n">or.inl</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">h1</span> <span class="n">h1</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">h2</span> <span class="n">h2</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">left</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">h1</span><span class="o">,</span> <span class="n">empty_inter</span><span class="o">],</span>
      <span class="o">},</span>
      <span class="o">{</span>
        <span class="n">left</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">h1</span><span class="o">,</span> <span class="n">empty_inter</span><span class="o">],</span>
      <span class="o">},</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h2</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">left</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">h2</span><span class="o">,</span> <span class="n">inter_empty</span><span class="o">],</span>
      <span class="o">},</span>
      <span class="o">{</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a1</span> <span class="n">h1</span><span class="o">,</span>
        <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">b1</span> <span class="n">h1</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
        <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">a2</span> <span class="n">h2</span><span class="o">,</span>
        <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">b2</span> <span class="n">h2</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
        <span class="o">{</span>
          <span class="n">use</span> <span class="n">a1</span> <span class="bp">⊔</span> <span class="n">a2</span><span class="o">,</span>
          <span class="n">use</span> <span class="n">b1</span> <span class="bp">⊓</span> <span class="n">b2</span><span class="o">,</span>
          <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
          <span class="n">rw</span> <span class="n">Ioc_inter_Ioc</span><span class="o">,</span>
        <span class="o">},</span>
        <span class="o">{</span>
          <span class="n">apply</span> <span class="o">(</span><span class="n">classical.em</span> <span class="o">(</span><span class="n">a2</span> <span class="bp">&lt;</span> <span class="n">b2</span><span class="o">)),</span>
          <span class="c1">-- invalid apply tactic, failed to unify</span>
          <span class="c1">--   a2 &lt; b2</span>
          <span class="c1">-- with</span>
          <span class="c1">--   a2 &lt; b2 ∨ ¬a2 &lt; b2</span>
          <span class="c1">-- state:</span>
          <span class="c1">-- s1 s2 : set ℝ,</span>
          <span class="c1">-- a1 b1 : ℝ,</span>
          <span class="c1">-- h1 : a1 &lt; b1 → s1 = Ioc a1 b1,</span>
          <span class="c1">-- a2 b2 : ℝ,</span>
          <span class="c1">-- h2 : a2 &lt; b2 → s2 = Ioc a2 b2</span>
          <span class="c1">-- ⊢ a2 &lt; b2</span>
        <span class="o">},</span>
        <span class="o">{</span>
          <span class="gr">sorry</span><span class="o">,</span>
        <span class="o">},</span>
      <span class="o">},</span>
    <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="230925264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230925264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230925264">(Mar 18 2021 at 19:37)</a>:</h4>
<p>Do you understand what the <code>apply</code> tactic does? It changes a goal of the form <code>Q</code> to a goal of the form <code>P</code> if you <code>apply f : P -&gt; Q</code>.</p>



<a name="230925298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230925298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230925298">(Mar 18 2021 at 19:37)</a>:</h4>
<p>Where is your function of the form P -&gt; Q which you're applying?</p>



<a name="230926876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230926876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230926876">(Mar 18 2021 at 19:49)</a>:</h4>
<p>It's in h2</p>



<a name="230926977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230926977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230926977">(Mar 18 2021 at 19:49)</a>:</h4>
<p>if <code>h2</code> is of the form <code>P -&gt; Q</code> then you should apply <code>h2</code> instead, and it will work as long as your goal is <code>Q</code>. You are applying a theorem of the form "P or Q is true" and this isn't a function so you can't apply it.</p>



<a name="230927395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230927395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230927395">(Mar 18 2021 at 19:52)</a>:</h4>
<p>Er that's not right. h2 is P -&gt; Q and I have P in goal. I think I should be able to say P is either true or it isn't. In case it's true, that's sufficient; in case it isn't I'm gonna try to find a contradiction.</p>



<a name="230927473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230927473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230927473">(Mar 18 2021 at 19:53)</a>:</h4>
<p>Sure you can do that but <code>apply</code> doesn't do that. Maybe you want the <code>by_cases</code> tactic?</p>



<a name="230927583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230927583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230927583">(Mar 18 2021 at 19:54)</a>:</h4>
<p>Oh if <code>P</code> is your goal then maybe <code>by_contra</code> is a quicker way to get where you want to go</p>



<a name="230927672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230927672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230927672">(Mar 18 2021 at 19:54)</a>:</h4>
<p>Aah -- you use <code>cases</code> to split <code>P or Q</code> into a <code>P</code> line and a <code>Q</code> line so maybe another approach is to just change your <code>apply</code> to a <code>cases</code>. But <code>by_contra</code> will get you there more quickly.</p>



<a name="230928193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230928193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230928193">(Mar 18 2021 at 19:58)</a>:</h4>
<p>That goal looks untrue to me</p>



<a name="230928428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230928428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230928428">(Mar 18 2021 at 20:00)</a>:</h4>
<p><code>∃ (a b : ℝ),  (a &lt; b → s = (Ioc a b))</code> should surely be "a &lt; b and s = ...". Otherwise such a and b always exist, just take a=1 and b=0.</p>



<a name="230928998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230928998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230928998">(Mar 18 2021 at 20:03)</a>:</h4>
<p>Like this? <code>in_semialgebra := λ s, s = ∅ ∨ ∀ (a b : ℝ),  (a &lt; b ∧ s = (Ioc a b)),</code></p>



<a name="230929184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230929184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230929184">(Mar 18 2021 at 20:05)</a>:</h4>
<p>That looks right, but why not just drop a &lt; b and the s = emptyset as well, because when a&gt;=b <code>Ioc a b</code> is just the empty set anyway.</p>



<a name="230929562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230929562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230929562">(Mar 18 2021 at 20:08)</a>:</h4>
<p>Oh that's much nicer</p>



<a name="230929711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230929711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230929711">(Mar 18 2021 at 20:09)</a>:</h4>
<p>It's crazy how these things sometimes come out really super-nicely sometimes.</p>



<a name="230930008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930008">(Mar 18 2021 at 20:12)</a>:</h4>
<p>I think I missed something. If the statement is just <code>  in_semialgebra := λ s, ∀ (a b : ℝ), s = (Ioc a b),</code> then <code>semialgebra_empty</code> will ask me to show that forall a b, Ioc a b = emptyset, which doesn't seem true.</p>



<a name="230930144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930144">(Mar 18 2021 at 20:13)</a>:</h4>
<p>There's something wrong with compl as well. Right now you can just let c = {s^compl}. If you restrict to all the elements of c being in your semialgebra then you can't make the complement of [0,1) because every set in your semialgebra has finite measure and so a finite union will do too. I think you might need the infinity versions of Ioc. I've forgotten what they're called though.</p>



<a name="230930340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930340">(Mar 18 2021 at 20:14)</a>:</h4>
<p>Iic?</p>



<a name="230930389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930389">(Mar 18 2021 at 20:14)</a>:</h4>
<p>yes it could well be that</p>



<a name="230930416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930416">(Mar 18 2021 at 20:15)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/set.Iic">docs#set.Iic</a></p>



<a name="230930486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930486">(Mar 18 2021 at 20:15)</a>:</h4>
<p>Yes, that. But I don't want to tell you what your semialgebra is -- it's your definition.</p>



<a name="230930715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930715">(Mar 18 2021 at 20:17)</a>:</h4>
<p>I'm trying to copy <a href="/user_uploads/3121/Z1Q0JWtyIRuCOldrbwW9sFSj/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/Z1Q0JWtyIRuCOldrbwW9sFSj/image.png" title="image.png"><img src="/user_uploads/3121/Z1Q0JWtyIRuCOldrbwW9sFSj/image.png"></a></div>



<a name="230930809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930809">(Mar 18 2021 at 20:18)</a>:</h4>
<p>But one dimensional for now</p>



<a name="230930935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930935">(Mar 18 2021 at 20:19)</a>:</h4>
<p>note the possibility that a and b can be infinity.</p>



<a name="230930974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230930974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230930974">(Mar 18 2021 at 20:19)</a>:</h4>
<p>Well I guess I was sorta mixing that with <a href="/user_uploads/3121/vQQzgVt4Q6mLg9KQrjwbqkca/image.png">image.png</a> from <a href="https://en.wikibooks.org/wiki/Measure_Theory/Basic_Structures_And_Definitions/Semialgebras,_Algebras_and_%CF%83-algebras">https://en.wikibooks.org/wiki/Measure_Theory/Basic_Structures_And_Definitions/Semialgebras,_Algebras_and_%CF%83-algebras</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/vQQzgVt4Q6mLg9KQrjwbqkca/image.png" title="image.png"><img src="/user_uploads/3121/vQQzgVt4Q6mLg9KQrjwbqkca/image.png"></a></div>



<a name="230931034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230931034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230931034">(Mar 18 2021 at 20:19)</a>:</h4>
<p>But maybe those definitions are actually not talking about the same object</p>



<a name="230931317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230931317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230931317">(Mar 18 2021 at 20:21)</a>:</h4>
<p>(deleted)</p>



<a name="230931948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230931948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230931948">(Mar 18 2021 at 20:26)</a>:</h4>
<p>Yeah this can't be right</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>


<span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ereal</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="kd">begin</span>
      <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="c1">-- a b: ereal</span>
  <span class="c1">-- ⊢ ∅ = Ioc a b</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="gr">sorry</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="230932818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230932818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230932818">(Mar 18 2021 at 20:32)</a>:</h4>
<p>Gotta be </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ereal</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="gr">sorry</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span>
</code></pre></div>



<a name="230934572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230934572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230934572">(Mar 18 2021 at 20:44)</a>:</h4>
<p>Isn't that what I posted earlier?</p>



<a name="230934680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230934680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230934680">(Mar 18 2021 at 20:45)</a>:</h4>
<p>Ah, Ioc instead of Icc</p>



<a name="230935250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230935250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230935250">(Mar 18 2021 at 20:49)</a>:</h4>
<p>It's very close, also changed real to ereal</p>



<a name="230957650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230957650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230957650">(Mar 19 2021 at 00:31)</a>:</h4>
<p>I'm trying to make a finset with this these two elements but Lean doesn't know how to put the elements in the finset.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ereal</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a1</span> <span class="n">ha1</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">ha1</span> <span class="k">with</span> <span class="n">b1</span> <span class="n">hb1</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">a2</span> <span class="n">ha2</span><span class="o">,</span>
        <span class="o">{</span>
          <span class="n">cases</span> <span class="n">ha2</span> <span class="k">with</span> <span class="n">b2</span> <span class="n">hb2</span><span class="o">,</span>
          <span class="n">use</span> <span class="n">a1</span> <span class="bp">⊔</span> <span class="n">a2</span><span class="o">,</span>
          <span class="n">use</span> <span class="n">b1</span> <span class="bp">⊓</span> <span class="n">b2</span><span class="o">,</span>
          <span class="n">rw</span> <span class="o">[</span><span class="n">hb1</span><span class="o">,</span> <span class="n">hb2</span><span class="o">,</span> <span class="n">Ioc_inter_Ioc</span><span class="o">],</span>
        <span class="o">},</span>
      <span class="o">},</span>
    <span class="o">},</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">b</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">ereal</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{(</span><span class="n">Iic</span> <span class="n">a</span><span class="o">)</span> <span class="o">,</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">b</span><span class="o">)},</span>
<span class="c1">-- failed to synthesize type class instance for</span>
<span class="c1">-- s : set ereal,</span>
<span class="c1">-- a b : ereal,</span>
<span class="c1">-- h : s = Ioc a b</span>
<span class="c1">-- ⊢ has_insert ?m_1 (finset (set ereal))</span>
<span class="c1">-- state:</span>
<span class="c1">-- s : set ereal,</span>
<span class="c1">-- a b : ereal,</span>
<span class="c1">-- h : s = Ioc a b</span>
<span class="c1">-- ⊢ ∃ (c : finset (set ereal)), ⋃₀↑c = (Ioc a b)ᶜ</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="230958521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230958521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230958521">(Mar 19 2021 at 00:42)</a>:</h4>
<p>Are you just missing <code>decidable</code> instances? What happens if you <code>open_locale classical</code>, or use <code>classical</code> at the beginning of the proof?</p>



<a name="230958769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230958769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230958769">(Mar 19 2021 at 00:45)</a>:</h4>
<p>Yeah that was it</p>



<a name="230990966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230990966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230990966">(Mar 19 2021 at 08:44)</a>:</h4>
<p>How can I solve this? </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">lemma</span> <span class="n">compl_Ioc</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span><span class="bp">ᶜ</span>  <span class="bp">=</span> <span class="n">Iic</span> <span class="n">a</span> <span class="bp">∪</span> <span class="n">Ioi</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="230991693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230991693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230991693">(Mar 19 2021 at 08:51)</a>:</h4>
<p>I <em>think</em> it's true</p>



<a name="230992078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/230992078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#230992078">(Mar 19 2021 at 08:55)</a>:</h4>
<p>Does <code>ext</code> get you started?</p>



<a name="231005748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231005748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231005748">(Mar 19 2021 at 11:01)</a>:</h4>
<p><code>rw [mem_union_eq, mem_Ioi, mem_Iic, mem_compl_eq, mem_Ioc]</code> will then get you most of the way to finished</p>



<a name="231006093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231006093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231006093">(Mar 19 2021 at 11:04)</a>:</h4>
<p>I think it might be worth PRing that lemma, once golfed to:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">compl_Ioc</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">Iic</span> <span class="n">a</span> <span class="bp">∪</span> <span class="n">Ioi</span> <span class="n">b</span> <span class="o">:=</span>
<span class="n">set.ext</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">not_and_distrib.trans</span> <span class="o">(</span><span class="n">or_congr</span> <span class="n">not_lt</span> <span class="n">not_le</span><span class="o">)</span>
</code></pre></div>



<a name="231006118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231006118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231006118">(Mar 19 2021 at 11:04)</a>:</h4>
<p>Along with the other three variants of <code>o</code> and <code>c</code></p>



<a name="231094778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231094778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231094778">(Mar 19 2021 at 21:52)</a>:</h4>
<p>This works now. How can I make it shorter?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>


<span class="kd">lemma</span> <span class="n">compl_Ioc</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">Iic</span> <span class="n">a</span> <span class="bp">∪</span> <span class="n">Ioi</span> <span class="n">b</span> <span class="o">:=</span>
<span class="n">set.ext</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">not_and_distrib.trans</span> <span class="o">(</span><span class="n">or_congr</span> <span class="n">not_lt</span> <span class="n">not_le</span><span class="o">)</span>


<span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ereal</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="o">(</span><span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_empty_eq</span><span class="o">,</span> <span class="n">forall_const</span><span class="o">,</span> <span class="n">not_false_iff</span><span class="o">,</span> <span class="n">Ioc_self</span><span class="o">],⟩,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a1</span> <span class="n">ha1</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">ha1</span> <span class="k">with</span> <span class="n">b1</span> <span class="n">hb1</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">a2</span> <span class="n">ha2</span><span class="o">,</span>
        <span class="o">{</span>
          <span class="n">cases</span> <span class="n">ha2</span> <span class="k">with</span> <span class="n">b2</span> <span class="n">hb2</span><span class="o">,</span>
          <span class="n">use</span> <span class="n">a1</span> <span class="bp">⊔</span> <span class="n">a2</span><span class="o">,</span>
          <span class="n">use</span> <span class="n">b1</span> <span class="bp">⊓</span> <span class="n">b2</span><span class="o">,</span>
          <span class="n">rw</span> <span class="o">[</span><span class="n">hb1</span><span class="o">,</span> <span class="n">hb2</span><span class="o">,</span> <span class="n">Ioc_inter_Ioc</span><span class="o">],</span>
        <span class="o">},</span>
      <span class="o">},</span>
    <span class="o">},</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">b</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">let</span> <span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">ereal</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{(</span><span class="n">Iic</span> <span class="n">a</span><span class="o">)</span> <span class="o">,</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">b</span><span class="o">)},</span>
    <span class="n">use</span> <span class="n">t</span><span class="o">,</span>
    <span class="k">have</span><span class="o">:</span> <span class="bp">⋃₀↑</span><span class="n">t</span> <span class="bp">=</span>  <span class="o">(</span><span class="n">Iic</span> <span class="n">a</span><span class="o">)</span> <span class="bp">∪</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">b</span><span class="o">),</span>
    <span class="k">from</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_insert</span><span class="o">,</span> <span class="n">sUnion_singleton</span><span class="o">,</span> <span class="n">finset.coe_singleton</span><span class="o">,</span> <span class="n">sUnion_insert</span><span class="o">],</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">],</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">compl_Ioc</span><span class="o">],</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="231095400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231095400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231095400">(Mar 19 2021 at 21:59)</a>:</h4>
<p>Yours intros and four cases tactics can be combined into a single <code>rintros</code></p>



<a name="231095610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231095610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231095610">(Mar 19 2021 at 22:00)</a>:</h4>
<p><code>rintros s1 s2 ⟨a1, b1, rfl⟩ ⟨a2, b2, rfl⟩</code></p>



<a name="231137277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231137277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231137277">(Mar 20 2021 at 10:14)</a>:</h4>
<p>Here's how I'd golf the whole thing:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="n">semialgebra</span> <span class="n">ereal</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_semialgebra</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ereal</span><span class="o">),</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">Ioc</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">semialgebra_empty</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">Ioc_self</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">⟩,</span>
  <span class="n">semialgebra_inter</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">⟨</span><span class="n">a1</span><span class="o">,</span> <span class="n">b1</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">a2</span><span class="o">,</span> <span class="n">b2</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">a1</span> <span class="bp">⊔</span> <span class="n">a2</span><span class="o">,</span> <span class="n">b1</span> <span class="bp">⊓</span> <span class="n">b2</span><span class="o">,</span> <span class="n">Ioc_inter_Ioc</span><span class="o">⟩,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">semialgebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">s</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
    <span class="n">refine</span> <span class="o">⟨{</span><span class="n">Iic</span> <span class="n">a</span><span class="o">,</span> <span class="n">Ioi</span> <span class="n">b</span><span class="o">},</span> <span class="n">eq.trans</span> <span class="n">_</span> <span class="o">(</span><span class="n">compl_Ioc</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_insert</span><span class="o">,</span> <span class="n">sUnion_singleton</span><span class="o">,</span> <span class="n">finset.coe_singleton</span><span class="o">,</span> <span class="n">sUnion_insert</span><span class="o">],</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>



<a name="231170299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231170299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231170299">(Mar 20 2021 at 20:43)</a>:</h4>
<p><code>rintros s1 s2 ⟨a1, b1, rfl⟩ ⟨a2, b2, rfl⟩,</code> works but if I replace it with <code>rintros s1 s2 ⟨a1, b1, _⟩ ⟨a2, b2, _⟩,</code> then it doesn't work. What is the difference?</p>



<a name="231170709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231170709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231170709">(Mar 20 2021 at 20:50)</a>:</h4>
<p><code>rfl</code> is like introducing <code>h</code> then immediately doing <code>rw h</code></p>



<a name="231170735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231170735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231170735">(Mar 20 2021 at 20:50)</a>:</h4>
<p>Although that's a bit of a simplification</p>



<a name="231170758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231170758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231170758">(Mar 20 2021 at 20:51)</a>:</h4>
<p>Whereas the <code>_</code> is just introducing <code>h</code>?</p>



<a name="231171250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231171250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231171250">(Mar 20 2021 at 21:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rintros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">⟨</span><span class="n">a1</span><span class="o">,</span> <span class="n">b1</span><span class="o">,</span> <span class="n">h1</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">a2</span><span class="o">,</span> <span class="n">b2</span><span class="o">,</span> <span class="n">h2</span><span class="o">⟩,</span>
<span class="n">rw</span> <span class="o">[</span><span class="n">h1</span><span class="o">,</span> <span class="n">h2</span><span class="o">],</span>
</code></pre></div>
<p>does work</p>



<a name="231173178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231173178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231173178">(Mar 20 2021 at 21:37)</a>:</h4>
<p>Yeah, <code>_</code> just tells lean to pick a name for you</p>



<a name="231193000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231193000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231193000">(Mar 21 2021 at 04:46)</a>:</h4>
<p>This works, what does a shorter version look like?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="n">open_locale</span> <span class="n">classical</span>
<span class="kd">noncomputable theory</span>


<span class="kd">structure</span> <span class="n">algebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_algebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_empty</span> <span class="o">:</span> <span class="n">in_algebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_union</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∪</span> <span class="n">s2</span><span class="o">))</span>


<span class="kd">lemma</span> <span class="n">eq_compl_of_compl_eq</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span><span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="kd">begin</span>
<span class="n">ext</span><span class="o">,</span>
<span class="n">split</span><span class="bp">;</span>
<span class="o">{</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_compl_eq</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="o">},</span>
<span class="kd">end</span>


<span class="kd">example</span> <span class="o">:</span> <span class="n">algebra'</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_algebra</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">s</span> <span class="bp">=</span> <span class="n">t</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">s</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">t</span><span class="o">),</span>
  <span class="n">algebra_empty</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">finset.empty</span><span class="o">,</span> <span class="n">or.inl</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">algebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">intros</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hs</span> <span class="k">with</span> <span class="n">t</span> <span class="n">ht</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ht</span> <span class="k">with</span> <span class="n">h</span> <span class="n">ht</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">t</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">compl_compl</span><span class="o">],</span>
      <span class="n">right</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">t</span><span class="o">,</span>
      <span class="n">left</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">ht</span><span class="o">,</span>
    <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">algebra_union</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">⟨</span><span class="n">t1</span><span class="o">,</span> <span class="n">h1</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">t2</span><span class="o">,</span> <span class="n">h2</span><span class="o">⟩,</span>
    <span class="n">cases</span> <span class="n">h1</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h2</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">use</span> <span class="n">t1</span> <span class="bp">∪</span> <span class="n">t2</span><span class="o">,</span>
        <span class="n">left</span><span class="o">,</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_union</span><span class="o">],</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">],</span>
      <span class="o">},</span>
      <span class="o">{</span>
        <span class="n">use</span> <span class="n">t2.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s1</span><span class="o">),</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">compl_union</span><span class="o">],</span>
        <span class="n">ext</span><span class="o">,</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_sep_eq</span><span class="o">,</span> <span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">,</span> <span class="n">finset.coe_filter</span><span class="o">],</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">and_imp</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
        <span class="o">{</span>
          <span class="n">intros</span> <span class="n">h</span> <span class="n">h'</span><span class="o">,</span>
          <span class="n">split</span><span class="o">,</span>
          <span class="o">{</span>
            <span class="k">have</span><span class="o">:</span> <span class="n">s2</span> <span class="bp">=</span> <span class="n">t2</span><span class="bp">ᶜ</span><span class="o">,</span>
            <span class="k">from</span> <span class="kd">by</span> <span class="o">{</span>
              <span class="n">apply</span> <span class="n">eq_compl_of_compl_eq</span><span class="o">,</span>
              <span class="n">exact</span> <span class="n">h2</span><span class="o">,</span>
            <span class="o">},</span>
            <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">not_not</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
          <span class="o">},</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
        <span class="o">},</span>
        <span class="o">{</span>
          <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
          <span class="n">split</span><span class="o">,</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="n">h.2</span><span class="o">,</span>  <span class="o">},</span>
          <span class="o">{</span>
            <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
            <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">mem_compl_eq</span><span class="o">],</span>
            <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
          <span class="o">},</span>
        <span class="o">},</span>
      <span class="o">},</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h2</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">use</span> <span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s2</span><span class="o">),</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">compl_union</span><span class="o">],</span>
        <span class="n">ext</span><span class="o">,</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span>
          <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
          <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">mem_sep_eq</span><span class="o">,</span> <span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">not_false_iff</span><span class="o">,</span> <span class="n">and_self</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">,</span> <span class="n">finset.coe_filter</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
        <span class="o">},</span>
        <span class="o">{</span>
          <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
          <span class="k">have</span><span class="o">:</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">t1</span><span class="bp">ᶜ</span><span class="o">,</span>
          <span class="k">from</span> <span class="kd">by</span> <span class="o">{</span>
            <span class="n">apply</span> <span class="n">eq_compl_of_compl_eq</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">h1</span><span class="o">,</span>
          <span class="o">},</span>
          <span class="o">{</span>
            <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">mem_sep_eq</span><span class="o">,</span> <span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">not_false_iff</span><span class="o">,</span> <span class="n">and_self</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">,</span> <span class="n">finset.coe_filter</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
          <span class="o">},</span>
        <span class="o">},</span>
      <span class="o">},</span>
      <span class="o">{</span>
        <span class="n">use</span> <span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">t2</span><span class="o">),</span>
        <span class="k">have</span> <span class="n">h1'</span><span class="o">:</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">t1</span><span class="bp">ᶜ</span><span class="o">,</span>
        <span class="k">from</span> <span class="kd">by</span> <span class="o">{</span>
          <span class="n">apply</span> <span class="n">eq_compl_of_compl_eq</span><span class="o">,</span>
          <span class="n">exact</span> <span class="n">h1</span><span class="o">,</span>
        <span class="o">},</span>
        <span class="k">have</span><span class="o">:</span> <span class="n">s2</span> <span class="bp">=</span> <span class="n">t2</span><span class="bp">ᶜ</span><span class="o">,</span>
        <span class="k">from</span> <span class="kd">by</span> <span class="o">{</span>
          <span class="n">apply</span> <span class="n">eq_compl_of_compl_eq</span><span class="o">,</span>
          <span class="n">exact</span> <span class="n">h2</span><span class="o">,</span>
        <span class="o">},</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">ext</span><span class="o">,</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">mem_sep_eq</span><span class="o">,</span> <span class="n">compl_union</span><span class="o">,</span> <span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">iff_self</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">finset.coe_filter</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
      <span class="o">},</span>
    <span class="o">},</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="231201245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201245">(Mar 21 2021 at 08:04)</a>:</h4>
<p>"have, from by apply exact" can all be done in one line, and one has to question whether it's even necessary given that you're about to close the goal with a simp * -- just throw the proof directly into the list of things in the list</p>



<a name="231201253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201253">(Mar 21 2021 at 08:04)</a>:</h4>
<p>intros, cases can be done with rintro</p>



<a name="231201293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201293">(Mar 21 2021 at 08:05)</a>:</h4>
<p>Did you try library_search for eq_compl_of_compl_eq?</p>



<a name="231201741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201741">(Mar 21 2021 at 08:16)</a>:</h4>
<p>What is the <code>rintros</code>-only version of <code>rintros s ⟨t, ht⟩, cases ht with h,</code>?</p>



<a name="231201776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201776">(Mar 21 2021 at 08:17)</a>:</h4>
<p><code>library_search</code> didn't work for <code>eq_compl_of_compl_eq</code> ("excessive memory consumption")</p>



<a name="231201940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231201940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231201940">(Mar 21 2021 at 08:21)</a>:</h4>
<p>Try looking for the iff version? The rintros version probably replaces <code>ht</code> with (h1 | h2)</p>



<a name="231202095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202095">(Mar 21 2021 at 08:25)</a>:</h4>
<p>I tried replacing the have/from like <code>simp only [*, not_not, finset.mem_coe, mem_compl_eq, eq_compl_of_compl_eq, h2] at *,</code> but it said <code>invalid simplification lemma 'eq_compl_of_compl_eq'</code></p>



<a name="231202171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202171">(Mar 21 2021 at 08:27)</a>:</h4>
<p>Indeed that is a useless simp lemma by itself. I'm suggesting you add the full proof ie eq_compl_of_compl_eq h1</p>



<a name="231202223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202223">(Mar 21 2021 at 08:28)</a>:</h4>
<p>Replacing <code>rintros s ⟨t, ht⟩, cases ht with h,</code> with <code>rintros s ⟨t, ⟨h1 | h2⟩⟩, </code> leaves me with <a href="/user_uploads/3121/G3VfJ5JMd0bvk98JR1320ZR1/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/G3VfJ5JMd0bvk98JR1320ZR1/image.png" title="image.png"><img src="/user_uploads/3121/G3VfJ5JMd0bvk98JR1320ZR1/image.png"></a></div>



<a name="231202224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202224">(Mar 21 2021 at 08:28)</a>:</h4>
<p>You can just use <code>simp</code> to close goals, you don't need all this simp only stuff</p>



<a name="231202240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202240">(Mar 21 2021 at 08:29)</a>:</h4>
<p>I read somewhere that it's bad style to just use simp because the simp rules change over time, so I normally write squeeze_simp and just use whatever it says</p>



<a name="231202245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202245">(Mar 21 2021 at 08:29)</a>:</h4>
<p>You need round brackets like I used, not pointy ones. Sorry I can't help more, I'm not at lean right now.</p>



<a name="231202298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202298">(Mar 21 2021 at 08:30)</a>:</h4>
<p>It's bad style to use simp <em>to not close a goal</em>. If it's solving the goal it's fine.</p>



<a name="231202406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202406">(Mar 21 2021 at 08:33)</a>:</h4>
<blockquote>
<p>can all be done in one line</p>
</blockquote>
<p>what are the rules for what's done in a single line?</p>



<a name="231202508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202508">(Mar 21 2021 at 08:34)</a>:</h4>
<p>btw dunno what's wrong with those <code>()</code>in the screenshot but it always wraps weird like that when there's a <code>\compl</code></p>



<a name="231202591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231202591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231202591">(Mar 21 2021 at 08:36)</a>:</h4>
<blockquote>
<p>Try looking for the iff version?</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_compl_of_compl_eq</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span><span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s1</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="kd">begin</span>
<span class="n">library_search</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>didn't work either</p>



<a name="231204111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231204111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231204111">(Mar 21 2021 at 09:13)</a>:</h4>
<p>I think Kevin is describing</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_compl_iff_compl_eq</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span><span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">s1</span> <span class="bp">=</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="bp">↔</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">library_search</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>does that work?</p>



<a name="231233770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231233770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231233770">(Mar 21 2021 at 18:49)</a>:</h4>
<p>No</p>



<a name="231233954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231233954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231233954">(Mar 21 2021 at 18:52)</a>:</h4>
<p>How about the statement <code>function.involutive (has_compl.compl : set X \to set X)</code>?</p>



<a name="231234337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231234337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231234337">(Mar 21 2021 at 18:58)</a>:</h4>
<p>If you mean </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">:</span> <span class="n">function.involutive</span> <span class="o">(</span><span class="n">has_compl.compl</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">library_search</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>then no</p>



<a name="231234960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231234960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231234960">(Mar 21 2021 at 19:08)</a>:</h4>
<p>It's in there somewhere. Why not just read data.set.basic? Find the section on compl.</p>



<a name="231237916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231237916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231237916">(Mar 21 2021 at 20:04)</a>:</h4>
<p>Maybe it's in a form I don't recognize, but I don't see it. <a href="https://leanprover-community.github.io/mathlib_docs/data/set/basic.html#lemmas-about-complement">https://leanprover-community.github.io/mathlib_docs/data/set/basic.html#lemmas-about-complement</a></p>



<a name="231239734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231239734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231239734">(Mar 21 2021 at 20:41)</a>:</h4>
<p>There's also a bunch of stuff in order/boolean_algebra but I can't see it there either. Here are some shorter proofs:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data.set.basic</span>

<span class="kn">namespace</span> <span class="n">set</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">lemma</span> <span class="n">eq_compl_of_compl_eq</span> <span class="o">{</span><span class="n">s1</span> <span class="n">s2</span><span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rintro</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">compl_compl</span> <span class="n">s1</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">eq_compl_iff_compl_eq</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span> <span class="bp">↔</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">eq_compl_of_compl_eq</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">eq_compl_of_compl_eq</span> <span class="n">h.symm</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">⟩</span>

<span class="kd">end</span> <span class="n">set</span>
</code></pre></div>



<a name="231240115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231240115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231240115">(Mar 21 2021 at 20:48)</a>:</h4>
<p>These should definitely be added to mathlib (in <code>order/boolean_algebra</code>).</p>



<a name="231241420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231241420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231241420">(Mar 21 2021 at 21:11)</a>:</h4>
<p>Why is the <code>have</code> necessary?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="n">open_locale</span> <span class="n">classical</span>
<span class="kd">noncomputable theory</span>





<span class="kd">structure</span> <span class="n">algebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_algebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_empty</span> <span class="o">:</span> <span class="n">in_algebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_union</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∪</span> <span class="n">s2</span><span class="o">))</span>



<span class="kd">lemma</span> <span class="n">eq_compl_of_compl_eq</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span><span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span><span class="o">)</span> <span class="o">:</span> <span class="n">s1</span> <span class="bp">=</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="o">:=</span>
<span class="kd">begin</span>
<span class="n">ext</span><span class="o">,</span>
<span class="n">split</span><span class="bp">;</span>
<span class="o">{</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_compl_eq</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="o">},</span>
<span class="kd">end</span>



<span class="kd">example</span> <span class="o">:</span> <span class="n">algebra'</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_algebra</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">s</span> <span class="bp">=</span> <span class="n">t</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">s</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">t</span><span class="o">),</span>
  <span class="n">algebra_empty</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">finset.empty</span><span class="o">,</span> <span class="n">or.inl</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">algebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">s</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">⟩,</span> <span class="n">cases</span> <span class="n">ht</span> <span class="k">with</span> <span class="n">h</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">t</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">compl_compl</span><span class="o">],</span> <span class="n">right</span><span class="o">,</span> <span class="n">exact</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">t</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">exact</span> <span class="n">ht</span><span class="o">,</span> <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">algebra_union</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintros</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">⟨</span><span class="n">t1</span><span class="o">,</span> <span class="o">(</span><span class="n">h11</span> <span class="bp">|</span><span class="n">h12</span><span class="o">)⟩</span> <span class="o">⟨</span><span class="n">t2</span><span class="o">,</span> <span class="o">(</span><span class="n">h21</span> <span class="bp">|</span> <span class="n">h22</span><span class="o">)⟩,</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">t1</span> <span class="bp">∪</span> <span class="n">t2</span><span class="o">,</span>
      <span class="n">left</span><span class="o">,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_union</span><span class="o">,</span> <span class="bp">*</span><span class="o">],</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">t2.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s1</span><span class="o">),</span>
      <span class="n">right</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">compl_union</span><span class="o">],</span>
      <span class="n">ext</span><span class="o">,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mem_sep_eq</span><span class="o">,</span> <span class="n">mem_inter_eq</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">mem_compl_eq</span><span class="o">,</span> <span class="n">finset.coe_filter</span><span class="o">],</span>
      <span class="n">split</span><span class="o">,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">and_imp</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
      <span class="o">{</span>
        <span class="n">intros</span> <span class="n">h</span> <span class="n">h'</span><span class="o">,</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span> <span class="c1">-- have: s2 = t2ᶜ, from by {  apply eq_compl_of_compl_eq, exact h22, },</span>
          <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">eq_compl_of_compl_eq</span> <span class="n">s2</span><span class="o">,</span> <span class="n">eq_compl_of_compl_eq</span> <span class="n">t2</span><span class="bp">ᶜ</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>  <span class="o">},</span>
        <span class="o">{</span> <span class="n">exact</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
      <span class="o">},</span>
      <span class="o">{</span>
        <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span> <span class="n">exact</span> <span class="n">h.2</span><span class="o">,</span>  <span class="o">},</span>
        <span class="o">{</span> <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
          <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">mem_compl_eq</span><span class="o">],</span>
          <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">finset.mem_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>   <span class="o">},</span>
      <span class="o">},</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">use</span> <span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s2</span><span class="o">),</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">rw</span> <span class="o">[</span><span class="n">compl_union</span><span class="o">],</span>
        <span class="n">ext</span><span class="o">,</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="o">},</span>
        <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">eq_compl_of_compl_eq</span> <span class="n">s1</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,},</span> <span class="o">},</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">use</span> <span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">t2</span><span class="o">),</span>
        <span class="n">right</span><span class="o">,</span>
        <span class="n">ext</span><span class="o">,</span>
        <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">eq_compl_of_compl_eq</span> <span class="n">s1</span><span class="o">,</span> <span class="n">eq_compl_of_compl_eq</span> <span class="n">s2</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="o">},</span>
  <span class="kd">end</span>
<span class="o">}</span>


<span class="n">simp_all</span> <span class="n">tactic</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">simplify</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span><span class="o">,</span>
<span class="n">t1</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℤ</span><span class="o">,</span>
<span class="n">h11</span> <span class="o">:</span> <span class="n">s1</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">t1</span><span class="o">,</span>
<span class="n">t2</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℤ</span><span class="o">,</span>
<span class="n">h22</span> <span class="o">:</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">t2</span><span class="o">,</span>
<span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">t1</span><span class="o">,</span>
<span class="n">h'</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s2</span>
<span class="bp">⊢</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">t2</span>
</code></pre></div>



<a name="231241540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231241540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231241540">(Mar 21 2021 at 21:13)</a>:</h4>
<p>Anyway that's a good reduction in verbosity, but still pretty large</p>



<a name="231316855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231316855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231316855">(Mar 22 2021 at 14:16)</a>:</h4>
<p>You may want to double-check, but I think that this is a simplified version of what you had:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">compl_eq_iff</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">s1</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s2</span> <span class="bp">↔</span> <span class="n">s2</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">s1</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">refine</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩</span><span class="bp">;</span> <span class="n">rintros</span> <span class="n">rfl</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">compl_compl</span> <span class="n">_</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">algebra'</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">in_algebra</span> <span class="o">:=</span> <span class="bp">λ</span><span class="n">s</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">s</span> <span class="bp">=</span> <span class="n">t</span><span class="o">)</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">s</span><span class="bp">ᶜ</span> <span class="bp">=</span> <span class="n">t</span><span class="o">),</span>
  <span class="n">algebra_empty</span> <span class="o">:=</span>
  <span class="o">⟨</span><span class="n">finset.empty</span><span class="o">,</span> <span class="n">or.inl</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="n">algebra_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintro</span> <span class="n">s</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">rfl</span> <span class="bp">|</span> <span class="n">h</span><span class="o">⟩,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">compl_compl</span> <span class="bp">↑</span><span class="n">t</span><span class="o">)⟩</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">or.inl</span> <span class="n">h</span><span class="o">⟩</span> <span class="o">}</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">algebra_union</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintro</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">⟨</span><span class="n">t1</span><span class="o">,</span> <span class="n">rfl</span> <span class="bp">|</span> <span class="n">h</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">t2</span><span class="o">,</span> <span class="n">rfl</span> <span class="bp">|</span> <span class="n">k</span><span class="o">⟩,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">t1</span> <span class="bp">∪</span> <span class="n">t2</span><span class="o">,</span> <span class="n">or.inl</span> <span class="o">(</span><span class="n">finset.coe_union</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">⟩</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="o">(</span><span class="n">compl_eq_iff</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">k</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">⟨</span><span class="n">t2.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">t1</span><span class="o">),</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">and_comm</span><span class="o">]))⟩</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="o">(</span><span class="n">compl_eq_iff</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">⟨</span><span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">t2</span><span class="o">),</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">and_comm</span><span class="o">]))⟩</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="bp">←</span> <span class="o">(</span><span class="n">compl_eq_iff</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">⟨</span><span class="n">t1.filter</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∉</span> <span class="n">s2</span><span class="o">),</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">and_comm</span><span class="o">]))⟩</span> <span class="o">},</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>



<a name="231320068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231320068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231320068">(Mar 22 2021 at 14:35)</a>:</h4>
<p>Also, while I have not worked with it, it might be better to make implicit some of the inputs in your definition of <code>algebra'</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">algebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_algebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_empty</span> <span class="o">:</span> <span class="n">in_algebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">},</span> <span class="n">in_algebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>  <span class="c1">-- made `s` implicit</span>
<span class="o">(</span><span class="n">algebra_union</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">},</span> <span class="n">in_algebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∪</span> <span class="n">s2</span><span class="o">))</span>  <span class="c1">-- made `s1 s2` implicit</span>
</code></pre></div>



<a name="231375208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231375208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231375208">(Mar 22 2021 at 19:58)</a>:</h4>
<p>That's quite an improvement! Thanks <span class="user-mention" data-user-id="321459">@Damiano Testa</span></p>



<a name="231692224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231692224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231692224">(Mar 24 2021 at 19:14)</a>:</h4>
<p>How can I express "the set of finite disjoint unions of sets in S"?<br>
<a href="/user_uploads/3121/BWRWr7oHJP9nwk6VxmzAh5SN/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/BWRWr7oHJP9nwk6VxmzAh5SN/image.png" title="image.png"><img src="/user_uploads/3121/BWRWr7oHJP9nwk6VxmzAh5SN/image.png"></a></div><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory.measure_space</span>
<span class="kn">import</span> <span class="n">data.real.ereal</span>

<span class="kn">open</span> <span class="n">measure_theory</span> <span class="n">measure_theory.measure_space</span> <span class="n">classical</span> <span class="n">set</span> <span class="n">real</span>

<span class="n">open_locale</span> <span class="n">classical</span>
<span class="kd">noncomputable theory</span>

<span class="kd">structure</span> <span class="n">algebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_algebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_empty</span> <span class="o">:</span> <span class="n">in_algebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
<span class="o">(</span><span class="n">algebra_union</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_algebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_algebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∪</span> <span class="n">s2</span><span class="o">))</span>

<span class="kd">structure</span> <span class="n">semialgebra</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
</code></pre></div>



<a name="231692921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231692921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231692921">(Mar 24 2021 at 19:19)</a>:</h4>
<p>You could define it recursively. Or you might want to check that the finite disjoint unions are just the same as the finite unions, which would be easier to define and work with -- I think they are.</p>



<a name="231694163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231694163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231694163">(Mar 24 2021 at 19:26)</a>:</h4>
<p>by 'check that ...' do you mean check that this result holds for finite unions in general?</p>



<a name="231694383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231694383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231694383">(Mar 24 2021 at 19:27)</a>:</h4>
<p>(deleted)</p>



<a name="231697802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231697802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231697802">(Mar 24 2021 at 19:50)</a>:</h4>
<p>I can't make sense of your lemma 1.1.3. How does one see that "the definition of S implies S_i^c \in S-bar"? I can't immediately see how to deduce it from your formal definition of semialgebra -- you know that the complement is a union of things in the semialgebra but you don't know the union is disjoint, right?</p>



<a name="231697914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231697914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231697914">(Mar 24 2021 at 19:51)</a>:</h4>
<p>For me, the algebra generated by the semialgebra seems to naturally be the finite union of elements of the semialgebra and then the proof that it's an algebra goes through; moreover it's clearly the smallest algebra containing the semialgebra, at least if we go via the definitions you have formalised.</p>



<a name="231706243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231706243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231706243">(Mar 24 2021 at 20:51)</a>:</h4>
<p>This text does use 'disjoint' in the definition of semialgebra <a href="/user_uploads/3121/bEhvOTqrivq5rscWL4OcpJub/image.png">image.png</a> <br>
so maybe I should try to include that in my lean semialgebra definition</p>
<div class="message_inline_image"><a href="/user_uploads/3121/bEhvOTqrivq5rscWL4OcpJub/image.png" title="image.png"><img src="/user_uploads/3121/bEhvOTqrivq5rscWL4OcpJub/image.png"></a></div>



<a name="231706311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231706311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231706311">(Mar 24 2021 at 20:51)</a>:</h4>
<p>Or maybe that's unnecessary complication</p>



<a name="231708426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231708426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231708426">(Mar 24 2021 at 21:06)</a>:</h4>
<p>Is that like this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">semialgebra'</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">in_semialgebra</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_empty</span> <span class="o">:</span> <span class="n">in_semialgebra</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">semialgebra_inter</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s1</span> <span class="n">s2</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s1</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="n">s2</span> <span class="bp">→</span> <span class="n">in_semialgebra</span> <span class="o">(</span><span class="n">s1</span> <span class="bp">∩</span> <span class="n">s2</span><span class="o">))</span>
<span class="o">(</span><span class="n">semialgebra_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="n">in_semialgebra</span> <span class="n">s</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span>  <span class="bp">∈</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">∈</span> <span class="n">c</span><span class="o">),</span>  <span class="n">x</span> <span class="bp">∩</span> <span class="n">y</span> <span class="bp">=</span> <span class="bp">∅</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">sUnion</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">))</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
</code></pre></div>



<a name="231761060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231761060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231761060">(Mar 25 2021 at 08:12)</a>:</h4>
<p>If you change the definition from the book then you'll have a different definition. Your definition of pairwise disjoint above is incorrect because you can have x=y. There might already be a way of saying "pairwise disjoint" in mathlib but I don't personally know it</p>



<a name="231763264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/semialgebra%20setminus/near/231763264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/semialgebra.20setminus.html#231763264">(Mar 25 2021 at 08:33)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/complete_lattice.independent">docs#complete_lattice.independent</a> I think is equivalent for sets?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>