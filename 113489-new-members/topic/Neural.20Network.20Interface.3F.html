---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html">Neural Network Interface?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="305962415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305962415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305962415">(Oct 25 2022 at 06:13)</a>:</h4>
<p>Hi all,</p>
<p>I'm an AI PhD student, new to Lean (I have some experience with Agda, and I've played around a bit with the Lean tutorials).  So far I'm really enjoying Lean, thinking of sticking with it long-term.  (Quotient and topological structures in Lean are especially nice!  I've had a lot of trouble dealing with those in Agda in the past.)</p>
<p>I've read a lot of discussion on here about using neural networks to assist theorem proving in Lean.  But I'm working the other way around:  Use formal verification (say in Lean) to check that a neural network has nice properties.</p>
<p>My question is:  Is there an already implemented / canonical way to interface neural networks with Lean?  Ideally I'd like to be able to have a neural network written in (say) C++ with Tensorflow, and then do the verification via Lean's FFI.  But I'm aware that Lean's FFI only handles primitive types, so this probably wouldn't work.  Alternatively, I could implement a neural network library in Lean, but I'd really rather not reinvent the wheel.</p>
<p>Thanks for your time!<br>
Caleb</p>



<a name="305965025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965025">(Oct 25 2022 at 06:39)</a>:</h4>
<p>Hi Caleb! I'm not aware of any work having been done in that direction, but that's definitely something that would be very cool (I'd personally be very interested in that)</p>



<a name="305965242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965242">(Oct 25 2022 at 06:41)</a>:</h4>
<p>In terms of the mathematics needed, Lean definitely has everything you would need to define fully connected neural networks</p>



<a name="305965355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965355">(Oct 25 2022 at 06:42)</a>:</h4>
<p>Welcome <span class="user-mention" data-user-id="556217">@Caleb Kisby</span> . There are a few projects which use NNs in conjunction with Lean. Off the top of my head, we have <a class="stream" data-stream-id="274007" href="/#narrow/stream/274007-lean-gptf">#lean-gptf</a> , which is a stream you might want to subscribe to. There is also Azerbayev and Ayers' Lean Chat, see <a href="https://xenaproject.wordpress.com/2022/08/16/the-future-of-interactive-theorem-proving/">this blog post</a>.</p>



<a name="305965384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965384">(Oct 25 2022 at 06:43)</a>:</h4>
<p>You might also be interested in the <a class="stream" data-stream-id="219941" href="/#narrow/stream/219941-Machine-Learning-for-Theorem-Proving">#Machine Learning for Theorem Proving</a> stream</p>



<a name="305965592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965592">(Oct 25 2022 at 06:45)</a>:</h4>
<p><span class="user-mention" data-user-id="556217">@Caleb Kisby</span> what sort of mathematical properties of neural networks would you be studying ?</p>



<a name="305965873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305965873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305965873">(Oct 25 2022 at 06:47)</a>:</h4>
<p><span class="user-mention" data-user-id="376152">@Paul Lezeau</span> Well, sure, I could implement it myself.  I suppose I'm hoping there's a nice library or FFI way to avoid me writing it from scratch (plus, this would make it easier for people to plug their own net into my system!).</p>
<p>Thanks for the welcome and suggestions <span class="user-mention" data-user-id="282271">@Bolton Bailey</span>!  I'll check out the Lean Chat github to see how they interface the net.</p>



<a name="305966149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305966149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305966149">(Oct 25 2022 at 06:50)</a>:</h4>
<p><span class="user-mention" data-user-id="556217">@Caleb Kisby</span> That's fair enough ! But I'm sure that's something you could get other people interested in working on with you were you to end up doing it ;)</p>



<a name="305966871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305966871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305966871">(Oct 25 2022 at 06:57)</a>:</h4>
<p><span class="user-mention" data-user-id="376152">@Paul Lezeau</span> Whoops, I missed your very first comment (I'm new to Zulip)!  I didn't mean to be rude :-)</p>
<p>At the moment I have a humble modal logic with modalities T ('typically', interpreted as the neural network's activation pattern on an input) and [P+] (interpreted as a Hebbian update operator on the net).  The idea is that axioms stated in this language express properties about what the net finds typical after unsupervised (Hebbian) learning, e.g.<br>
[P+}TQ -&gt; T[P+]Q<br>
says (roughly) "if after learning P, the neural network predicts Q, then the neural network would have expected Q in the first place"</p>



<a name="305967160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305967160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305967160">(Oct 25 2022 at 06:59)</a>:</h4>
<p>The language is basic, and I'm still figuring out what things it can express.  But I do have soundness results, and I'm starting by implementing these (hopefully in Lean).  Plus, since it's a modal logic it's at least decidable. <br>
(Shameless plug for my paper:  <a href="https://journals.flvc.org/FLAIRS/article/download/130735/133901">https://journals.flvc.org/FLAIRS/article/download/130735/133901</a>)</p>



<a name="305968213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305968213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305968213">(Oct 25 2022 at 07:07)</a>:</h4>
<p>So technically I'd like to prove in Lean properties of the <em>logic</em>, but the logic is defined using functions from the neural network.  I might just bite the bullet and whip up a quick ANN in Lean... <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="305968824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305968824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305968824">(Oct 25 2022 at 07:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="556217">Caleb Kisby</span> <a href="#narrow/stream/113489-new-members/topic/Neural.20Network.20Interface.3F/near/305966871">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="376152">Paul Lezeau</span> Whoops, I missed your very first comment (I'm new to Zulip)!  I didn't mean to be rude :-)</p>
<p>At the moment I have a humble modal logic with modalities T ('typically', interpreted as the neural network's activation pattern on an input) and [P+] (interpreted as a Hebbian update operator on the net).  The idea is that axioms stated in this language express properties about what the net finds typical after unsupervised (Hebbian) learning, e.g.<br>
[P+}TQ -&gt; T[P+]Q<br>
says (roughly) "if after learning P, the neural network predicts Q, then the neural network would have expected Q in the first place"</p>
</blockquote>
<p>No worries at all;)</p>



<a name="305968869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305968869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305968869">(Oct 25 2022 at 07:13)</a>:</h4>
<p>I had no area this kind of stuff was being researched in AI, that's pretty cool!</p>



<a name="305969135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305969135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305969135">(Oct 25 2022 at 07:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="556217">Caleb Kisby</span> <a href="#narrow/stream/113489-new-members/topic/Neural.20Network.20Interface.3F/near/305968213">said</a>:</p>
<blockquote>
<p>So technically I'd like to prove in Lean properties of the <em>logic</em>, but the logic is defined using functions from the neural network.  I might just bite the bullet and whip up a quick ANN in Lean... <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>
</blockquote>
<p>I see ! Well that's definitely something I'm interested in so feel free to ping me if you ever want someone to have a look at you code;)</p>



<a name="305969217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305969217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305969217">(Oct 25 2022 at 07:16)</a>:</h4>
<p><span class="user-mention" data-user-id="556217">@Caleb Kisby</span> You might be interested in <a href="https://github.com/dselsam/certigrad">https://github.com/dselsam/certigrad</a></p>



<a name="305969363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305969363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305969363">(Oct 25 2022 at 07:17)</a>:</h4>
<p>Right!?  At the moment, there are only a handful of people bridging connectionism and logic in this specific way -- I'm sort of resuscitating some forgotten work from the 90's, since it's helpful to the neuro-symbolic crowd.  Thanks for the support, I'll keep you updated!</p>



<a name="305970082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305970082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Caleb Kisby <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305970082">(Oct 25 2022 at 07:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113489-new-members/topic/Neural.20Network.20Interface.3F/near/305969217">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="556217">Caleb Kisby</span> You might be interested in <a href="https://github.com/dselsam/certigrad">https://github.com/dselsam/certigrad</a></p>
</blockquote>
<p>Whoah, nice!  And they have Lean code for training a neural network!  This might be exactly what I was hoping for <span aria-label="smile cat" class="emoji emoji-1f638" role="img" title="smile cat">:smile_cat:</span></p>



<a name="305972140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305972140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tomas Skrivan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305972140">(Oct 25 2022 at 07:37)</a>:</h4>
<p>In the <a href="#narrow/stream/113489-new-members/topic/starting.20Lean.20and.20Lean.20version">recent thread</a> <span class="user-mention" data-user-id="416965">@Martin (egLanghaus)</span>  is interested in somewhat similar thing i.e. reasoning about neural networks.</p>



<a name="305976763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Neural%20Network%20Interface%3F/near/305976763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin (egLanghaus) <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Neural.20Network.20Interface.3F.html#305976763">(Oct 25 2022 at 08:10)</a>:</h4>
<p>Currently reading the ONNX and ONNX-ML syntax and semantics <a href="https://github.com/onnx/onnx/blob/main/docs/IR.md">here</a>.</p>
<p>Goal is to read actual architectures into Lean and prove input/output relations with an eye toward XAI (explainability), and to check if in fact (as has been claimed) that DNNs are so complex as to make interactive proof assistants useless in verifying them.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>