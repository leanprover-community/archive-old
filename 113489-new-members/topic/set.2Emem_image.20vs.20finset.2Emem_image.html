---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html">set.mem_image vs finset.mem_image</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="265412519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265412519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265412519">(Dec 18 2021 at 11:08)</a>:</h4>
<p>Here is the definition of  <a href="https://leanprover-community.github.io/mathlib_docs/find/set.mem_image">docs#set.mem_image</a></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="kd">theorem</span> <span class="n">set.mem_image</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
<span class="n">y</span> <span class="bp">∈</span> <span class="n">f</span> <span class="bp">''</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">∧</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span>
</code></pre></div>
<p>and of <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.mem_image">docs#finset.mem_image</a></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="kd">theorem</span> <span class="n">finset.mem_image</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">β</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span>
<span class="n">b</span> <span class="bp">∈</span> <span class="n">finset.image</span> <span class="n">f</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span>
</code></pre></div>
<p>Besides the specific notation <code>''</code> for set images, you see that the right hand sides have different forms, which (it seems to me) makes the automatic translation from one to the other a bit awkward. (I noticed that while trying to pass a proof from <code>set</code>s to <code>finset</code>s.)<br>
Should “one” wish to unify them ? and which form would be the preferred one?</p>



<a name="265412844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265412844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265412844">(Dec 18 2021 at 11:16)</a>:</h4>
<p>I think we should definitely unify them to have the same form on the RHS</p>



<a name="265412865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265412865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265412865">(Dec 18 2021 at 11:17)</a>:</h4>
<p>I'd lean towards the second one, since them <code>simp</code> can be used to take it into the first one if desired</p>



<a name="265412870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265412870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265412870">(Dec 18 2021 at 11:17)</a>:</h4>
<p>But it doesn't matter much</p>



<a name="265412996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265412996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265412996">(Dec 18 2021 at 11:20)</a>:</h4>
<p>You mean that <code>simp</code> can create an <code>and</code> but tailord not to destruct it?<br>
If I wish to do this unification, do I have to proceed as <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> proposed me to do for commutators?</p>



<a name="265413322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265413322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265413322">(Dec 18 2021 at 11:27)</a>:</h4>
<p>Simp knows about <a href="https://leanprover-community.github.io/mathlib_docs/find/exists_prop">docs#exists_prop</a> which rewrites the second lemma into the first</p>



<a name="265413340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265413340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265413340">(Dec 18 2021 at 11:27)</a>:</h4>
<p>I'd wait for a second opinion on which is the better choice before embarking on the refactor</p>



<a name="265413395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265413395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265413395">(Dec 18 2021 at 11:28)</a>:</h4>
<p>You could do a <code>/poll</code></p>



<a name="265413502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265413502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265413502">(Dec 18 2021 at 11:31)</a>:</h4>
<p>In fact, I fell on this question while writing the following lemmas :</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic.basic</span>
<span class="kn">import</span> <span class="n">data.finset.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="n">function.left_inverse</span> <span class="n">g</span> <span class="n">f</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hb_fa</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="n">g</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">change</span> <span class="n">g</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">id</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">function.left_inverse.id</span> <span class="n">hfg</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">congr_arg</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hb_fa</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">test2</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="n">function.left_inverse</span> <span class="n">g</span> <span class="n">f</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hb_fs</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">finset.image</span> <span class="n">f</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">g</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">finset.mem_image.mp</span> <span class="n">hb_fs</span><span class="o">,</span>
  <span class="n">change</span> <span class="o">(</span><span class="n">g</span> <span class="bp">∘</span> <span class="n">f</span><span class="o">)</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">function.left_inverse.id</span> <span class="n">hfg</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hb</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">test3</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="n">function.right_inverse</span> <span class="n">g</span> <span class="n">f</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hb_fs</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∉</span> <span class="n">finset.image</span> <span class="n">f</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">g</span> <span class="n">a</span> <span class="bp">∉</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_contradiction</span> <span class="n">hga_s</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">hb_fs</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.mem_image.mpr</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">g</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">and.intro</span> <span class="n">hga_s</span><span class="o">,</span>
  <span class="n">change</span> <span class="o">(</span><span class="n">f</span> <span class="bp">∘</span> <span class="n">g</span><span class="o">)</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">function.right_inverse.id</span> <span class="n">hfg</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Three more questions :</p>
<p>1) Should it exist explicitly in the library, as well as the analogues for sets. <br>
(In the context of mul_action, <code>f</code> and <code>g</code> are actually an element of a group and its inverse, acting on a <code>finset</code>.  For <code>set</code>, here is <a href="https://leanprover-community.github.io/mathlib_docs/find/mem_smul_set_iff_inv_smul_mem">docs#mem_smul_set_iff_inv_smul_mem</a>, but this is kind of the analogues for <code>finset</code>.)</p>
<p>2) Certainly you can do it quicker, using some existing suff (which I couldn't find)</p>
<p>3) If the two variants (for sets and finsets) have to coexist, should the proof of that for finsets reduce to the one for sets, using <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.mem_coe">docs#finset.mem_coe</a> or should they both be done directly ?</p>



<a name="265414006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414006">(Dec 18 2021 at 11:43)</a>:</h4>
<p>It might be worth editing the topic of that message so that the original question doesn't get lost</p>



<a name="265414013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414013">(Dec 18 2021 at 11:44)</a>:</h4>
<p>Those lemmas look like they might be related to <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.preimage">docs#finset.preimage</a></p>



<a name="265414124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414124">(Dec 18 2021 at 11:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image/near/265414006">said</a>:</p>
<blockquote>
<p>It might be worth editing the topic of that message so that the original question doesn't get lost</p>
</blockquote>
<p>Do you have a suggestion? (In fact, I'm not sure of what you mean…)</p>



<a name="265414290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414290">(Dec 18 2021 at 11:52)</a>:</h4>
<p>You can edit a message and change its title.</p>



<a name="265414575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414575">(Dec 18 2021 at 11:58)</a>:</h4>
<p>I personally like <code>∃ x : α, x ∈ s ∧ f x = y</code> better. It looks more like what one would write on paper.</p>



<a name="265414745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265414745" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265414745">(Dec 18 2021 at 12:01)</a>:</h4>
<p>The advantage of the other proposition is that you only ever need to write <code>∃ x ∈ s, f x = y</code>, which looks ever more like what you would write on paper.</p>



<a name="265415736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265415736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265415736">(Dec 18 2021 at 12:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image/near/265414290">said</a>:</p>
<blockquote>
<p>You can edit a message and change its title.</p>
</blockquote>
<p>I found that but it is unclear what title you wish me to write. (I can change the title of what follows my second question, or change the title of the initial one…)</p>



<a name="265420166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/set.mem_image%20vs%20finset.mem_image/near/265420166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Chambert-Loir <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/set.2Emem_image.20vs.20finset.2Emem_image.html#265420166">(Dec 18 2021 at 14:04)</a>:</h4>
<p>I copy here links to a thread with answers of <span class="user-mention" data-user-id="112680">@Johan Commelin</span> and <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> : <br>
<a class="stream-topic" data-stream-id="113489" href="/#narrow/stream/113489-new-members/topic/Questions.20about.20lemmas.20regarding.20images.20of.20sets.2Ffinsets">#new members &gt; Questions about lemmas regarding images of sets/finsets</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>