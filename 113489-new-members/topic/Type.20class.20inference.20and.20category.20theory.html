---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html">Type class inference and category theory</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="271576325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271576325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271576325">(Feb 11 2022 at 13:31)</a>:</h4>
<p>I just began looking at the category theory part of the library and I do not understand how type class inference works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.single_obj</span>
<span class="kn">import</span> <span class="n">topology.sheaves.local_predicate</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kn">open</span> <span class="n">Top</span> <span class="n">category_theory</span>

<span class="kn">section</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">Top.</span><span class="o">{</span><span class="n">u</span><span class="o">})</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>

<span class="k">#check</span> <span class="n">sheaf_to_Type</span> <span class="n">X</span> <span class="n">T</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">t</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_open</span> <span class="o">(</span><span class="n">s</span> <span class="bp">∩</span> <span class="n">t</span><span class="o">)</span> <span class="o">:=</span> <span class="n">hs.inter</span> <span class="n">ht</span>

<span class="kd">end</span>

<span class="kn">section</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span>

<span class="k">#check</span> <span class="n">sheaf_to_Type</span> <span class="n">X</span> <span class="n">T</span> <span class="c1">-- this does not typecheck</span>

<span class="kd">end</span>
</code></pre></div>
<p>magically (I don't know how this is possible but it is super cool) <code>X : Top.{u}</code> gets recognized by type class inference as a topological space. But how do I go the other way around and get a standard topological space get recognized as an object in its category?</p>



<a name="271578855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271578855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271578855">(Feb 11 2022 at 13:50)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/Top.of">docs#Top.of</a></p>



<a name="271582073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271582073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271582073">(Feb 11 2022 at 14:12)</a>:</h4>
<p>Ok thank you!</p>



<a name="271582211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271582211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271582211">(Feb 11 2022 at 14:13)</a>:</h4>
<p>Why does <code>sheaf_to_top</code> only require one argument? I would guess that it should behave as <code>presheaf_to_top</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">s</span><span class="o">)</span>


<span class="k">#check</span> <span class="n">presheaf_to_Top</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">)</span>
<span class="k">#check</span> <span class="n">sheaf_to_Top</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">)</span>
</code></pre></div>



<a name="271582617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271582617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271582617">(Feb 11 2022 at 14:16)</a>:</h4>
<p>I think the idea is for you to write <code>sheaf_to_Top T : sheaf _ X</code> if you want to specify the <code>X</code> as well.</p>



<a name="271584821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271584821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271584821">(Feb 11 2022 at 14:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory/near/271582617">said</a>:</p>
<blockquote>
<p>I think the idea is for you to write <code>sheaf_to_Top T : sheaf _ X</code> if you want to specify the <code>X</code> as well.</p>
</blockquote>
<p>Why is that convenient? I mean why can <code>X</code> usually be inferred for sheaves?</p>



<a name="271585227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271585227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271585227">(Feb 11 2022 at 14:36)</a>:</h4>
<p>I think the idea is that this definition is used primarily in the context where you have other objects of the category <code>sheaf (Type*) X</code>. For example, if <code>Y : sheaf (Type*) X</code>, then you would be able to write <code>sheaf_to_Top T \hom Y</code> to obtain the type of morphisms of sheaves from this thing to the given sheaf <code>Y</code>.</p>



<a name="271588063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271588063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271588063">(Feb 11 2022 at 14:58)</a>:</h4>
<p>Ok thanks a lot! One more question:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Top</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">_</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>
  <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Type</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>

<span class="k">#check</span> <span class="n">g</span> <span class="n">x</span> <span class="c1">--typechecks</span>
<span class="k">#check</span> <span class="n">f</span> <span class="n">x</span> <span class="c1">--does not</span>
</code></pre></div>
<p>I understand that this does not work because despite <code>f</code> is really a <code>continuous_map s Y</code>, lean sees it as a <code>(of Y).sheaf_to_Top.val.obj (op ⟨s, hs⟩)</code> which is basically a type synonym for <code>continuous_map s Y</code>. Is there some trick to get lean recognize <code>f</code> as a <code>continuous_map</code> so that the above notation works?</p>



<a name="271588398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271588398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271588398">(Feb 11 2022 at 15:00)</a>:</h4>
<p>Use a type-ascription is the solution I suspect.</p>



<a name="271588468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271588468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271588468">(Feb 11 2022 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span>, I hit the exact same thing in <a href="https://github.com/leanprover-community/mathlib/pull/11968">#11968</a>. I assume there's no real solution here because Lean has too much to unfold?</p>



<a name="271588773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271588773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271588773">(Feb 11 2022 at 15:03)</a>:</h4>
<p>You could also add the appropriate <code>has_coe_to_fun</code> instance to help lean along...</p>



<a name="271588864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271588864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271588864">(Feb 11 2022 at 15:04)</a>:</h4>
<p>I suspect you could also get it to work by making certain definitions reducible, but I'd have to see the output of <code>set_option trace.class_instances true</code> to be sure. For now my advice is to either add new <code>has_coe_to_fun</code> instances or use type ascriptions.</p>



<a name="271589015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589015">(Feb 11 2022 at 15:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory/near/271588773">said</a>:</p>
<blockquote>
<p>You could also add the appropriate <code>has_coe_to_fun</code> instance to help lean along...</p>
</blockquote>
<p>Yes I mean I though about that too but my above question was wrong sorry, I do not only want to use the notation, I also want to use the whole API for <code>continuous_map</code></p>



<a name="271589075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589075">(Feb 11 2022 at 15:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory/near/271588398">said</a>:</p>
<blockquote>
<p>Use a type-ascription is the solution I suspect.</p>
</blockquote>
<p>What is type-ascription? haha</p>



<a name="271589240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589240">(Feb 11 2022 at 15:06)</a>:</h4>
<p>You can write <code>(f : continuous_map _ _) x</code></p>



<a name="271589347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589347">(Feb 11 2022 at 15:07)</a>:</h4>
<p>You should still be able to use the <code>continuous_map</code> api just fine since <code>f</code> is indeed a <code>continuous_map</code>.</p>



<a name="271589511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589511">(Feb 11 2022 at 15:08)</a>:</h4>
<p>Oh I see thanks haha I did not think about that</p>



<a name="271589669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589669">(Feb 11 2022 at 15:09)</a>:</h4>
<p>Well it is not working for me</p>



<a name="271589760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589760">(Feb 11 2022 at 15:10)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.single_obj</span>
<span class="kn">import</span> <span class="n">topology.sheaves.local_predicate</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kn">open</span> <span class="n">Top</span> <span class="n">category_theory</span> <span class="n">topological_space</span> <span class="n">opposite</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Top</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">_</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>
  <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Type</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>

<span class="k">#check</span> <span class="n">g</span> <span class="n">x</span> <span class="c1">--typechecks</span>
<span class="k">#check</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">continuous_map</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="n">x</span> <span class="c1">--does not</span>
</code></pre></div>



<a name="271589814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271589814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271589814">(Feb 11 2022 at 15:10)</a>:</h4>
<p>This does should be a mwe</p>



<a name="271590430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271590430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271590430">(Feb 11 2022 at 15:15)</a>:</h4>
<p>This looks like it's an issue with the type of <code>x</code> as opposed to <code>f</code>.</p>



<a name="271590938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271590938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271590938">(Feb 11 2022 at 15:18)</a>:</h4>
<p>Hmmm... maybe not.</p>



<a name="271592507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271592507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271592507">(Feb 11 2022 at 15:30)</a>:</h4>
<p>You have to fill in those underscores for it to work, else Lean is not unfolding them enough <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="271592950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271592950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271592950">(Feb 11 2022 at 15:33)</a>:</h4>
<p><span aria-label="expressionless" class="emoji emoji-1f611" role="img" title="expressionless">:expressionless:</span> </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.single_obj</span>
<span class="kn">import</span> <span class="n">topology.sheaves.local_predicate</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kn">open</span> <span class="n">Top</span> <span class="n">category_theory</span> <span class="n">topological_space</span> <span class="n">opposite</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_open</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Top</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">_</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>
  <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="o">(</span><span class="n">sheaf_to_Type</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">Top.of</span> <span class="n">Y</span><span class="o">))</span><span class="bp">.</span><span class="n">val.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hs</span><span class="o">⟩))</span>

<span class="k">#check</span> <span class="k">let</span> <span class="n">e</span> <span class="o">:</span> <span class="n">C</span><span class="o">(</span><span class="n">s</span><span class="o">,</span><span class="n">Y</span><span class="o">):=</span> <span class="n">f</span> <span class="k">in</span> <span class="n">e</span> <span class="n">x</span>
</code></pre></div>



<a name="271593023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Type%20class%20inference%20and%20category%20theory/near/271593023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Type.20class.20inference.20and.20category.20theory.html#271593023">(Feb 11 2022 at 15:34)</a>:</h4>
<p>I can't get it to work with type ascriptions.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>