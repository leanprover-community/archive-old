---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/integral.20domain.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html">integral domain</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="208106297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106297">(Aug 26 2020 at 15:20)</a>:</h4>
<p>Dear All,</p>
<p>I am trying to prove that a ring is an integral domain.  I can prove that  a ring isomorphic to the one that I want is an integral domain (all apparently confirmed by Lean), but I cannot deduce that my initial ring is an integral domain!  I realize that I must be missing a very silly command, but I have been unable to find it...</p>
<p>Extra question: after this is done, how can I get Lean to confirm that the ideal by which I divide is prime, since the quotient is an integral domain?</p>
<p>Thank you very much!</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">polynomial</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">open</span> <span class="n">polynomial</span>
<span class="kn">open</span> <span class="n">ideal</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">lemma</span> <span class="n">quoprime</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">is_prime</span> <span class="n">P</span><span class="o">)</span> <span class="o">:</span> <span class="n">integral_domain</span> <span class="o">(</span><span class="n">quotient</span> <span class="o">(</span><span class="n">map</span> <span class="n">C</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="o">(</span><span class="n">polynomial</span> <span class="n">R</span><span class="o">)))</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="k">let</span> <span class="n">quo</span> <span class="o">:=</span> <span class="n">polynomial</span> <span class="o">(</span><span class="n">quotient</span> <span class="n">P</span><span class="o">),</span>
    <span class="k">let</span> <span class="n">quot</span> <span class="o">:=</span> <span class="n">quotient</span> <span class="o">(</span><span class="n">map</span> <span class="n">C</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="o">(</span><span class="n">polynomial</span> <span class="n">R</span><span class="o">)),</span>
    <span class="k">have</span> <span class="n">idq</span> <span class="o">:</span> <span class="n">integral_domain</span> <span class="n">quo</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">integral_domain</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">iso</span> <span class="o">:</span> <span class="n">quo</span> <span class="err">≃</span><span class="bp">+*</span> <span class="n">quot</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact</span> <span class="n">polynomial_quotient_equiv_quotient_polynomial</span><span class="o">,</span>
        <span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="208106450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106450">(Aug 26 2020 at 15:21)</a>:</h4>
<p>Can you prove that if R and S are isomorphic rings, and R is an integral domain, then so is S? I think there is a tactic-in-progress to do this, but it is not "true by definition", there's some argument here which is completely mechanical.</p>



<a name="208106610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106610">(Aug 26 2020 at 15:22)</a>:</h4>
<p>As for the other question I guess you need to find a lemma saying R/P is an ID iff P is prime. It will probably be there somewhere...</p>



<a name="208106709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106709">(Aug 26 2020 at 15:23)</a>:</h4>
<p>I think that I convinced Lean that one of the rings is an integral domain and that the two rings are isomorphic.  This is where I am stuck...</p>



<a name="208106731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106731">(Aug 26 2020 at 15:23)</a>:</h4>
<p>(The code above should also contain a proof of this)</p>



<a name="208106779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106779">(Aug 26 2020 at 15:23)</a>:</h4>
<p>Right. And what I'm saying is that now we need a tactic which rewrites mathematically sane statements along isomorphisms of structures</p>



<a name="208106781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106781">(Aug 26 2020 at 15:23)</a>:</h4>
<p>I will keep looking for how to transport under isomorphisms</p>



<a name="208106807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106807">(Aug 26 2020 at 15:24)</a>:</h4>
<p>Ah, I understand what you are saying now...</p>



<a name="208106910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106910">(Aug 26 2020 at 15:24)</a>:</h4>
<p>You could either prove it yourself, or take a look at the current state of the tactic, which I think is called something like <code>equiv_rw</code></p>



<a name="208106948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106948">(Aug 26 2020 at 15:24)</a>:</h4>
<p>ok, I will take a look: thanks for the pointer!</p>



<a name="208106993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208106993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208106993">(Aug 26 2020 at 15:25)</a>:</h4>
<p>Do you know where quotient rings are defined? I've found integral domains but the file makes no mention of quotients.</p>



<a name="208107078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107078">(Aug 26 2020 at 15:25)</a>:</h4>
<p>I am not sure where quotient rings are defined...</p>



<a name="208107171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107171">(Aug 26 2020 at 15:26)</a>:</h4>
<p>you have them in your file so you can just right click. It's OK, I did it now</p>



<a name="208107285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107285">(Aug 26 2020 at 15:27)</a>:</h4>
<p>I am still lacking in these basic skills, sorry...</p>



<a name="208107314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107314">(Aug 26 2020 at 15:27)</a>:</h4>
<p>It's in ring_theory.ideal.basic; line 304 is the direction you don't want.</p>



<a name="208107780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107780">(Aug 26 2020 at 15:30)</a>:</h4>
<p>(sorry, I need to go: I will dig into this later, and will report on what I find!)</p>



<a name="208107790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107790">(Aug 26 2020 at 15:30)</a>:</h4>
<p>thank you!</p>



<a name="208107864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208107864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208107864">(Aug 26 2020 at 15:30)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">all</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">hI</span> <span class="o">:</span> <span class="n">integral_domain</span> <span class="n">I</span><span class="bp">.</span><span class="n">quotient</span><span class="o">)</span> <span class="o">:</span> <span class="n">I</span><span class="bp">.</span><span class="n">is_prime</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">library_search</span> <span class="c1">-- fails</span>
<span class="kn">end</span>
</code></pre></div>


<p>I don't think it's there!</p>



<a name="208108066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208108066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208108066">(Aug 26 2020 at 15:32)</a>:</h4>
<p>More stuff to write!</p>



<a name="208109541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208109541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208109541">(Aug 26 2020 at 15:44)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.integral_domain">docs#ring_equiv.integral_domain</a> is what you want right?</p>



<a name="208109617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208109617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208109617">(Aug 26 2020 at 15:45)</a>:</h4>
<p>Wow, can I do <a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.discrete_valuation_ring">docs#ring_equiv.discrete_valuation_ring</a> and it just works?</p>



<a name="208109717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208109717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208109717">(Aug 26 2020 at 15:46)</a>:</h4>
<p>apparently not. So what's the deal here? People just write them if they need them?</p>



<a name="208109785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208109785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208109785">(Aug 26 2020 at 15:46)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.principal_ideal_domain">docs#ring_equiv.principal_ideal_domain</a> <a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.euclidean_domain">docs#ring_equiv.euclidean_domain</a> <a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.unique_factorization_domain">docs#ring_equiv.unique_factorization_domain</a> <a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.local_ring">docs#ring_equiv.local_ring</a></p>



<a name="208109817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208109817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208109817">(Aug 26 2020 at 15:47)</a>:</h4>
<p>oh man, you just got lucky</p>



<a name="208110033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208110033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208110033">(Aug 26 2020 at 15:49)</a>:</h4>
<p>Hahaha well I grepped to find its name first then posted the doc link, but we are all lucky it exists in mathlib already I guess <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="208113825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208113825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208113825">(Aug 26 2020 at 16:19)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/3951">#3951</a></p>



<a name="208114819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208114819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208114819">(Aug 26 2020 at 16:27)</a>:</h4>
<p>That is awesome!  Thank you very much <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> and <span class="user-mention" data-user-id="127136">@Alex J. Best</span></p>



<a name="208114942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208114942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208114942">(Aug 26 2020 at 16:28)</a>:</h4>
<p>Note that <code>integral_domain</code> is a Type, and <code>is_integral_domain</code> is a Prop, but the stuff I quote in the PR is the API for converting between them.</p>



<a name="208115993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208115993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208115993">(Aug 26 2020 at 16:37)</a>:</h4>
<p>Thanks for the explanation: I am no longer in front of my computer, but will try to use this as soon as I get back!</p>



<a name="208117892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208117892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208117892">(Aug 26 2020 at 16:53)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/ring_equiv.is_integral_domain">docs#ring_equiv.is_integral_domain</a> is more relevant if you already have a ring isomorphism.</p>



<a name="208118354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208118354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208118354">(Aug 26 2020 at 16:56)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Looks like just what I want!  Perfect!</p>



<a name="208120588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208120588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208120588">(Aug 26 2020 at 17:14)</a>:</h4>
<p>Johan: should we have <code>is_field</code>? Is there an issue here with <code>inv</code>?</p>



<a name="208121177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208121177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208121177">(Aug 26 2020 at 17:18)</a>:</h4>
<p>Yup, that will quickly lead to defeq issues with <code>inv</code></p>



<a name="208121432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208121432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208121432">(Aug 26 2020 at 17:20)</a>:</h4>
<p>Only if people move from is_field to field.</p>



<a name="208124389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208124389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208124389">(Aug 26 2020 at 17:46)</a>:</h4>
<p>Which is bound to happen</p>



<a name="208136781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208136781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208136781">(Aug 26 2020 at 19:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="c">/-</span><span class="cm">- A predicate to express that a ring is a field.</span>

<span class="cm"> This is mainly useful because such a predicate does not contain data,</span>
<span class="cm"> and can therefore be easily transported along ring isomorphisms. -/</span>
 <span class="kn">structure</span> <span class="n">is_field</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">exists_pair_ne</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="n">x</span> <span class="bp">≠</span> <span class="n">y</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_inv_cancel&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">},</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>

 <span class="c">/-</span><span class="cm">- Every field satisfies the predicate for integral domains. -/</span>
 <span class="kn">lemma</span> <span class="n">field</span><span class="bp">.</span><span class="n">to_is_field</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
   <span class="n">is_field</span> <span class="n">R</span> <span class="o">:=</span>
 <span class="o">{</span> <span class="n">mul_inv_cancel&#39;</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">a</span><span class="bp">⁻¹</span><span class="o">,</span> <span class="n">field</span><span class="bp">.</span><span class="n">mul_inv_cancel</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
   <span class="bp">..</span> <span class="o">(</span><span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="o">:</span> <span class="n">field</span> <span class="n">R</span><span class="o">)</span> <span class="o">}</span>

<span class="n">open_locale</span> <span class="n">classical</span>

 <span class="c">/-</span><span class="cm">- If a ring satisfies the predicate for integral domains,</span>
<span class="cm"> then it can be endowed with an `integral_domain` instance</span>
<span class="cm"> whose data is definitionally equal to the existing data. -/</span>
 <span class="n">noncomputable</span> <span class="n">def</span> <span class="n">is_field</span><span class="bp">.</span><span class="n">to_field</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_field</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
   <span class="n">field</span> <span class="n">R</span> <span class="o">:=</span>
 <span class="o">{</span> <span class="n">inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="k">if</span> <span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">is_field</span><span class="bp">.</span><span class="n">mul_inv_cancel&#39;</span> <span class="n">h</span> <span class="n">ha</span><span class="o">),</span>
   <span class="n">inv_zero</span> <span class="o">:=</span> <span class="n">dif_pos</span> <span class="n">rfl</span><span class="o">,</span>
   <span class="n">mul_inv_cancel</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">convert</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">is_field</span><span class="bp">.</span><span class="n">mul_inv_cancel&#39;</span> <span class="n">h</span> <span class="n">ha</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">dif_neg</span> <span class="n">ha</span>
   <span class="kn">end</span><span class="o">,</span>
   <span class="bp">..</span> <span class="o">(</span><span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="o">:</span> <span class="n">ring</span> <span class="n">R</span><span class="o">),</span> <span class="bp">..</span> <span class="o">(</span><span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="o">:</span> <span class="n">is_field</span> <span class="n">R</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>


<p>Interested?</p>



<a name="208187610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208187610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208187610">(Aug 27 2020 at 07:59)</a>:</h4>
<p>Thank you all again so much!  I have laboriously worked through the thread, managed to prove both <code>integral_domain</code> and <code>is_integral_domain</code>, as well as showing that the ideal that I wanted was prime!  The subtleties among the presence or absence of <code>is_</code> are not entirely clear to me, but I can prove both, so that is ok!</p>
<p>Also, I am very happy to now there is a lemma <code>R/P integral domain iff P prime</code>: even though I did not have anything to do with this, I still feel that I am starting to contribute to mathlib!  Ahahaha</p>



<a name="208188542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208188542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208188542">(Aug 27 2020 at 08:09)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Do you want an explanation of the subtleties? (It doesn't have real mathematical content, as you probably guessed.)</p>



<a name="208190900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208190900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208190900">(Aug 27 2020 at 08:40)</a>:</h4>
<p>Maybe yes, if you have the time, or if you can point me to somewhere where it is already explained...</p>



<a name="208194178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194178">(Aug 27 2020 at 09:21)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Do you know the difference between "definitional equality" and "propositional equality"?</p>



<a name="208194319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194319">(Aug 27 2020 at 09:23)</a>:</h4>
<p>"defeq" means two things are equal by simply unfolding the definitions <em>and nothing else</em>.<br>
Propositional equality means that two things are equal because you can prove it (and maybe even use an axiom, like choice).</p>



<a name="208194363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194363">(Aug 27 2020 at 09:23)</a>:</h4>
<p>So, in the natural numbers, you can prove <code>n + 0 = n</code> with <code>rfl</code>. Because that is the definition of <code>n + 0</code>.</p>



<a name="208194455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194455">(Aug 27 2020 at 09:24)</a>:</h4>
<p>On the other hand, <code>0 + n</code> is defined by induction on <code>n</code>. So to prove <code>0 + n = n</code>, you need to really do something (namely, repeat the induction on <code>n</code>, and at some point <code>rw</code> along the induction hypothesis.</p>



<a name="208194468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194468">(Aug 27 2020 at 09:25)</a>:</h4>
<p>So <code>0 + n = n</code> is only a propositional equality.</p>



<a name="208194474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194474">(Aug 27 2020 at 09:25)</a>:</h4>
<p>Ok, I have a (probably intuitive) understanding of this: in my mind, it is coded as "defeq : could be an axiom" or "propeq : could be deduced from the axioms"</p>



<a name="208194486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194486">(Aug 27 2020 at 09:25)</a>:</h4>
<p>Yup, that sounds about right.</p>



<a name="208194492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194492">(Aug 27 2020 at 09:25)</a>:</h4>
<p>Now why does this matter...</p>



<a name="208194497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194497">(Aug 27 2020 at 09:25)</a>:</h4>
<p>indeed!</p>



<a name="208194507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194507">(Aug 27 2020 at 09:26)</a>:</h4>
<p>Lean is trying to help us by automatically finding the semiring structure on <code>nat</code></p>



<a name="208194552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194552">(Aug 27 2020 at 09:26)</a>:</h4>
<p>Or the integral domain structure on one of your two rings, etc...</p>



<a name="208194553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194553">(Aug 27 2020 at 09:26)</a>:</h4>
<p>This is type class inference.</p>



<a name="208194586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194586">(Aug 27 2020 at 09:27)</a>:</h4>
<p>Now suppose that I am using the addition on <code>nat</code> from mathlib, but you had an addition on <code>nat</code> where you define <code>m + n</code> by induction on <code>m</code> (instead of <code>n</code>, like mathlib does).</p>



<a name="208194589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194589">(Aug 27 2020 at 09:27)</a>:</h4>
<p>(deleted)</p>



<a name="208194599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194599">(Aug 27 2020 at 09:27)</a>:</h4>
<p><del>Oops, you are right. Let me edit it.</del></p>



<a name="208194607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194607">(Aug 27 2020 at 09:27)</a>:</h4>
<p>ok, I will erase my comment, then!</p>



<a name="208194677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194677">(Aug 27 2020 at 09:28)</a>:</h4>
<p>Now you might want to apply the lemma <code>add_comm : m + n = n + m</code>.</p>



<a name="208194702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194702">(Aug 27 2020 at 09:28)</a>:</h4>
<p>What does this lemma actually say under the hood?</p>



<a name="208194720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194720">(Aug 27 2020 at 09:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208194553">said</a>:</p>
<blockquote>
<p>This is type class inference.</p>
</blockquote>
<p>I had read/heard these words, but not really internalized their meaning</p>



<a name="208194741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194741">(Aug 27 2020 at 09:29)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">print</span> <span class="n">add_comm</span>
<span class="kn">theorem</span> <span class="n">add_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">add_comm_semigroup</span> <span class="n">G</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">G</span><span class="o">),</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">a</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">add_comm_semigroup</span> <span class="n">G</span><span class="o">],</span> <span class="n">add_comm_semigroup</span><span class="bp">.</span><span class="n">add_comm</span>
</code></pre></div>



<a name="208194816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194816">(Aug 27 2020 at 09:30)</a>:</h4>
<p>So lean says, ok, I'll need to find some <code>add_comm_semigroup</code> structure on the natural numbers, and it happily goes away and finds, mine. Out of that, it pulls the definition of addition.</p>



<a name="208194828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194828">(Aug 27 2020 at 09:30)</a>:</h4>
<p>Let me explain a bit more.</p>



<a name="208194839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194839">(Aug 27 2020 at 09:30)</a>:</h4>
<p>In <code>a + b</code>, the <code>+</code> is notation for <code>has_add.add</code></p>



<a name="208194852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194852">(Aug 27 2020 at 09:31)</a>:</h4>
<p>And lean knows that it can pull <code>has_add.add</code> out of an <code>add_comm_semigroup</code>.</p>



<a name="208194872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194872">(Aug 27 2020 at 09:31)</a>:</h4>
<p>So, in the end, it will reduce the <code>m + n</code> to <code>nat.add m n</code>.</p>



<a name="208194892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194892">(Aug 27 2020 at 09:31)</a>:</h4>
<p>However, in your <code>m + n</code>, it had figured out a different <code>nat.add' m n</code> where addition is defined by inducting on <code>m</code>.</p>



<a name="208194941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194941">(Aug 27 2020 at 09:32)</a>:</h4>
<p>And now it is stuck... because it doesn't know why the two are the same.</p>



<a name="208194954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194954">(Aug 27 2020 at 09:32)</a>:</h4>
<p>Of course <em>we</em> can prove that they are the same. But Lean can't do so automatically.</p>



<a name="208194971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194971">(Aug 27 2020 at 09:32)</a>:</h4>
<p>I see: this makes sense also in math!  You gave two different definitions of the same additions, but did not prove that they are indeed the same.  Is this what is happening?</p>



<a name="208194981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208194981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208194981">(Aug 27 2020 at 09:33)</a>:</h4>
<p>So you proofs no longer go smooth, because you will have to remind Lean all the time that two definitions are doing the same thing.</p>



<a name="208195020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195020">(Aug 27 2020 at 09:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208194971">said</a>:</p>
<blockquote>
<p>I see: this makes sense also in math!  You gave two different definitions of the same additions, but did not prove that they are indeed the same.  Is this what is happening?</p>
</blockquote>
<p>Almost. The trouble is. Even if we prove a lemma</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">add_eq_add&#39;</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add</span> <span class="n">m</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add&#39;</span> <span class="n">m</span> <span class="n">n</span>
</code></pre></div>


<p>we would still need to mention this lemma <em>all the time</em>.</p>



<a name="208195066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195066">(Aug 27 2020 at 09:34)</a>:</h4>
<p>Whereas in maths, once you prove it, you can forget about it.</p>



<a name="208195077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195077">(Aug 27 2020 at 09:34)</a>:</h4>
<p>This is starting to become clearer.  And it is also clear that I need to understand more about how things are defined in Lean in order to avoid such traps...</p>



<a name="208195081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195081">(Aug 27 2020 at 09:34)</a>:</h4>
<p>The two defintions will merge into one thing.</p>



<a name="208195107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195107">(Aug 27 2020 at 09:34)</a>:</h4>
<p>There is actually one really painful occurence of this issue in mathlib/Lean.</p>



<a name="208195124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195124">(Aug 27 2020 at 09:34)</a>:</h4>
<p>The definition of <code>nat.pow</code> is not defeq to powers in arbitrary monoids.</p>



<a name="208195132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195132">(Aug 27 2020 at 09:35)</a>:</h4>
<p>(But you don't see this in the notation.)</p>



<a name="208195157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195157">(Aug 27 2020 at 09:35)</a>:</h4>
<p>Ah, the slogan that I heard from Kevin <em><code>=</code> is not an equivalence relation in Lean</em> surfaces in my mind</p>



<a name="208195165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195165">(Aug 27 2020 at 09:35)</a>:</h4>
<p>So we have to rewrite with <code>nat.pow_eq_pow</code>. (And you have to guess in which direction <span aria-label="scream" class="emoji emoji-1f631" role="img" title="scream">:scream:</span>)</p>



<a name="208195196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195196">(Aug 27 2020 at 09:35)</a>:</h4>
<p>This is something that we have to fix. But nobody has gone through the trouble so far.</p>



<a name="208195265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195265">(Aug 27 2020 at 09:36)</a>:</h4>
<p>There are actually other instances as well. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span> is a module over itself in two different ways.</p>



<a name="208195280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195280">(Aug 27 2020 at 09:36)</a>:</h4>
<ol>
<li>every abelian group is a module over <code>int</code>.</li>
<li>every ring is a module over itself.</li>
</ol>



<a name="208195288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195288">(Aug 27 2020 at 09:36)</a>:</h4>
<p>Ok, it helps a lot to understand the separation between mathematical issues and computer issues.  I feel that I am quite comfortable with the mathematical ones, that the computer ones have "mirrors" in maths, but I am not yet able to see through the mirror</p>



<a name="208195297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195297">(Aug 27 2020 at 09:37)</a>:</h4>
<p>Currently these two are not defeq. Which causes pain.</p>



<a name="208195341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195341">(Aug 27 2020 at 09:37)</a>:</h4>
<p>It would help a lot if we could teach lean: "hey, all module instances of anything over <code>int</code> are always propositionally equal. Just use this fact an move on."</p>



<a name="208195389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195389">(Aug 27 2020 at 09:38)</a>:</h4>
<p>Ok, so is this where the trouble with <code>is_integral_domain</code> and <code>integral_domain</code> begins?  That they are not defeq?</p>



<a name="208195392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195392">(Aug 27 2020 at 09:38)</a>:</h4>
<p>But currently we don't have a way to teach Lean such a fact.</p>



<a name="208195405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195405">(Aug 27 2020 at 09:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208195389">said</a>:</p>
<blockquote>
<p>Ok, so is this where the trouble with <code>is_integral_domain</code> and <code>integral_domain</code> begins?  That they are not defeq?</p>
</blockquote>
<p>Not really.</p>



<a name="208195423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195423">(Aug 27 2020 at 09:38)</a>:</h4>
<p>So let me try to explain that.</p>



<a name="208195429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195429">(Aug 27 2020 at 09:38)</a>:</h4>
<p>ok, thanks!</p>



<a name="208195451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195451">(Aug 27 2020 at 09:39)</a>:</h4>
<p>Here is one very important fact: in Lean (but not in all other systems) we have <em>proof irrelevance</em>.</p>



<a name="208195495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195495">(Aug 27 2020 at 09:39)</a>:</h4>
<p>Yes, I read about this and I am not sure where my (mathematical) stance is on this one!</p>



<a name="208195516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195516">(Aug 27 2020 at 09:39)</a>:</h4>
<p>But I accept it!  Ahahaa</p>



<a name="208195517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195517">(Aug 27 2020 at 09:39)</a>:</h4>
<p>That means that if <code>P : Prop</code>, and <code>h1</code> and <code>h2</code> are proofs of <code>P</code>. In other words <code>h1 : P</code> and <code>h2 : P</code>. Then <code>h1</code> and <code>h2</code> are defeq.</p>



<a name="208195534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195534">(Aug 27 2020 at 09:39)</a>:</h4>
<p>This is baked into Lean core.</p>



<a name="208195604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195604">(Aug 27 2020 at 09:40)</a>:</h4>
<p>Ok, now I can also follow with the defeq definition from before!  This is great!  :)</p>



<a name="208195652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195652">(Aug 27 2020 at 09:41)</a>:</h4>
<p>Yes, and it means that if we have a definition that depends on a proof of <code>P</code>. (Say <code>fin n</code>, which consists of <code>i : nat</code> and <code>h : i &lt; n</code>)</p>



<a name="208195681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195681">(Aug 27 2020 at 09:41)</a>:</h4>
<p>Then <code>(i, h1)</code> is defeq to <code>(i, h2)</code>.</p>



<a name="208195695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195695">(Aug 27 2020 at 09:41)</a>:</h4>
<p>So we don't care how to prove <code>i &lt; n</code>.</p>



<a name="208195763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195763">(Aug 27 2020 at 09:42)</a>:</h4>
<p>Now, <code>is_integral_domain R : Prop</code>, because it assumes <code>[comm_ring R]</code> under the hood as an argument.</p>



<a name="208195780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195780">(Aug 27 2020 at 09:42)</a>:</h4>
<p>So it doesn't matter how you prove <code>is_integral_domain R</code>, all of them are the same to Lean.</p>



<a name="208195806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195806">(Aug 27 2020 at 09:43)</a>:</h4>
<p>But <code>integral_domain R</code> records all the data, because it <em>extends</em> <code>has_add</code> and <code>has_mul</code>, etc...</p>



<a name="208195840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195840">(Aug 27 2020 at 09:43)</a>:</h4>
<p>So, in your setup, you has <code>A</code> and <code>B</code>, and both of them already had a <code>comm_ring</code> instance.</p>



<a name="208195847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208195847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208195847">(Aug 27 2020 at 09:43)</a>:</h4>
<p>So Lean already knew about <code>has_add A</code> and <code>has_add B</code>.</p>



<a name="208196065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196065">(Aug 27 2020 at 09:46)</a>:</h4>
<p>So now, what you really don't want to do, is transfer <code>has_add B</code> along an equivalence to obtain a new version of <code>has_add A</code>.</p>



<a name="208196082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196082">(Aug 27 2020 at 09:46)</a>:</h4>
<p>Because then, all of a sudden, there are two. And they are only propositionally equal.</p>



<a name="208196116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196116">(Aug 27 2020 at 09:47)</a>:</h4>
<p>This would be a (dire) consequence of using <code>is_integral_domain</code> as opposed to <code>integral_domain</code>, right?</p>



<a name="208196120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196120">(Aug 27 2020 at 09:47)</a>:</h4>
<p>So, when you extend <code>comm_ring A</code> to <code>integral_domain A</code>, you need to make sure that all the data fields are defeq to what you had. But for the fields that are props, it doesn't matter what you do.</p>



<a name="208196137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196137">(Aug 27 2020 at 09:47)</a>:</h4>
<p>So transferring <code>is_integral_domain</code> is harmless.</p>



<a name="208196143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196143">(Aug 27 2020 at 09:47)</a>:</h4>
<p>But transferring <code>integral_domain</code> can be dangerous.</p>



<a name="208196228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196228">(Aug 27 2020 at 09:48)</a>:</h4>
<p>Ah, I got it mixed up...</p>



<a name="208196265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196265">(Aug 27 2020 at 09:49)</a>:</h4>
<p>I need to think this through more carefully, then</p>



<a name="208196383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196383">(Aug 27 2020 at 09:50)</a>:</h4>
<p>this is all theoretical</p>



<a name="208196387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196387">(Aug 27 2020 at 09:50)</a>:</h4>
<p>you'll internalize it once you run into errors</p>



<a name="208196419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196419">(Aug 27 2020 at 09:51)</a>:</h4>
<p>I am a little puzzled about this <code>has_add</code> not remembering the proof.  I could put two ring structures on a set with 4 elements: Z/4 and (Z/2)^2.  If Lean forgets how I proved that there was an addition, how will it know which addition to use?</p>



<a name="208196516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196516">(Aug 27 2020 at 09:52)</a>:</h4>
<p><code>has_add</code> is data</p>



<a name="208196523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196523">(Aug 27 2020 at 09:52)</a>:</h4>
<p>I don't understand what you mean by not remembering the proof</p>



<a name="208196535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196535">(Aug 27 2020 at 09:52)</a>:</h4>
<p>proof irrelevance only concerns propositions not data</p>



<a name="208196704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208196704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208196704">(Aug 27 2020 at 09:54)</a>:</h4>
<p>I was trying to contrast this with </p>
<p><a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208196065">said</a>:</p>
<blockquote>
<p>So now, what you really don't want to do, is transfer <code>has_add B</code> along an equivalence to obtain a new version of <code>has_add A</code>.</p>
</blockquote>



<a name="208197094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197094">(Aug 27 2020 at 09:58)</a>:</h4>
<p>For the moment, I have been able to prove both results <code>integral_domain R</code> and <code>is_integral_domain R</code>, so I am happy.  The discussion here has helped clarify a lot of hazy stuff, but I still need time to process these concepts.  Thank you all for your time and help!</p>



<a name="208197364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197364">(Aug 27 2020 at 10:02)</a>:</h4>
<p><code>has_add</code> is data, not a proof, so proof irrelevance doesn't apply to it. We don't say things like "I proved that there was an addition" (it's imprecise at best even in ordinary mathematics).</p>



<a name="208197446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197446">(Aug 27 2020 at 10:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208195495">said</a>:</p>
<blockquote>
<p>Yes, I read about this and I am not sure where my (mathematical) stance is on this one!</p>
</blockquote>
<p>This might be because you are identifying some things as proofs that Lean doesn't consider to be proofs.</p>



<a name="208197464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197464">(Aug 27 2020 at 10:03)</a>:</h4>
<p>Ah, so this is precisely the reason why the addition is carried along an equivalence and might cause problems <em>on the other side</em>?</p>



<a name="208197566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197566">(Aug 27 2020 at 10:04)</a>:</h4>
<p>It is carried along, because it contains actual instructions on how to perform the addition that have nothing to do with proving stuff about it.  Maybe I am understanding what is going on</p>



<a name="208197793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197793">(Aug 27 2020 at 10:07)</a>:</h4>
<p>I think that I see my mistake: when I read that <code>has_add</code> was passed along an equivalence, I thought that Lean simply remembered that there was an addition on one of the two sides.  However, if I understand correctly, Lean remembers exactly how to perform the addition and now has two well-defined additions on the same type and can be stuck.  Hopefully this is correct!</p>



<a name="208197809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197809">(Aug 27 2020 at 10:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208197464">said</a>:</p>
<blockquote>
<p>Ah, so this is precisely the reason why the addition is carried along an equivalence and might cause problems <em>on the other side</em>?</p>
</blockquote>
<p>Right!</p>



<a name="208197831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197831">(Aug 27 2020 at 10:08)</a>:</h4>
<p>You want to transfer the proof that addition is commutative. But not the defintion of addition itself.</p>



<a name="208197893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208197893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208197893">(Aug 27 2020 at 10:08)</a>:</h4>
<p>I don't really know what the context was, but:</p>
<ul>
<li>Even in ordinary math, you could certainly define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span></span></span></span> on something in two different ways. Generally we try to pick just one way because otherwise things would get confusing quickly.</li>
<li>In Lean, if we have two definitions of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span></span></span></span> on something, it's not sufficient that they be merely equal by a theorem, because Lean doesn't just know this theorem. You really want them to be the same by definiiton.</li>
</ul>



<a name="208198054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208198054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208198054">(Aug 27 2020 at 10:10)</a>:</h4>
<p>Ok, I am getting the hang of this: thank you so much!</p>



<a name="208262076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208262076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208262076">(Aug 27 2020 at 19:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113489-new-members/topic/integral.20domain/near/208195341">said</a>:</p>
<blockquote>
<p>It would help a lot if we could teach lean: "hey, all module instances of anything over <code>int</code> are always propositionally equal. Just use this fact an move on."</p>
</blockquote>
<p>import tactic<br>
import algebra.module.basic</p>
<p>example (M : Type) [add_comm_group M] : subsingleton (module ℤ M) := by apply_instance</p>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>



<a name="208262219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208262219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208262219">(Aug 27 2020 at 19:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> Sure, but that's not enough</p>



<a name="208262246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208262246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208262246">(Aug 27 2020 at 19:08)</a>:</h4>
<p>Because Lean doesn't use that fact when it hits a wall</p>



<a name="208262346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integral%20domain/near/208262346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integral.20domain.html#208262346">(Aug 27 2020 at 19:09)</a>:</h4>
<p>And of course there is the other problem that <code>has_scalar Z M</code> is not a subsingleton... so if it hits two different <code>has_scalar</code> instances then there's a nastier issue</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>