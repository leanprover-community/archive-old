---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html">recurrence on fermat numbers</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="266732030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Peter Ross <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732030">(Jan 03 2022 at 20:16)</a>:</h4>
<p>Hello I am new to Lean,  and I would like help with proving a recurrence on the fermat numbers, which in latex is</p>
<div class="codehilite" data-code-language="TeX"><pre><span></span><code><span class="k">\prod</span><span class="nb">_{</span>k=0<span class="nb">}^{</span>n-1<span class="nb">}</span> F<span class="nb">_</span>k = F<span class="nb">_</span>n-2
</code></pre></div>
<p>I tried to write it in Lean as </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- define a fermat number</span>
<span class="kd">def</span> <span class="n">fermat_number</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">)</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">^</span><span class="mi">2</span><span class="bp">^</span><span class="n">p</span> <span class="bp">+</span><span class="mi">1</span>
<span class="c1">-- prove the recurrence on the Fermat numbers</span>
<span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span> <span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span><span class="o">(</span><span class="n">n</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">2</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>but the error said "unexpected token". I don't know how to solve this because I am new to using Lean, so I would appreciate it if anyone would help me.</p>



<a name="266732229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732229">(Jan 03 2022 at 20:18)</a>:</h4>
<p>You're looking for something more like <code>∏ x in range(n-1), fermat_number x = fermat_number n - 2</code></p>



<a name="266732251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732251">(Jan 03 2022 at 20:18)</a>:</h4>
<p>you'll want <code>open_locale big_operators</code> too</p>



<a name="266732313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732313">(Jan 03 2022 at 20:19)</a>:</h4>
<p>And <code>range n</code> instead of <code>range (n - 1)</code> most likely.</p>



<a name="266732419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732419">(Jan 03 2022 at 20:20)</a>:</h4>
<p>(natural number subtraction is annoying in Lean)</p>



<a name="266732691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732691">(Jan 03 2022 at 20:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="c1">-- define a fermat number</span>
<span class="kd">def</span> <span class="n">fermat_number</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">^</span><span class="mi">2</span><span class="bp">^</span><span class="n">p</span> <span class="bp">+</span><span class="mi">1</span>

<span class="c1">-- prove the recurrence on the Fermat numbers</span>
<span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">n</span><span class="o">,</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266732937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266732937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266732937">(Jan 03 2022 at 20:26)</a>:</h4>
<p>To avoid the subtraction would it be better to write this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">2</span><span class="o">),</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266733119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733119">(Jan 03 2022 at 20:28)</a>:</h4>
<p>Nonono, the brackets aren't there. It's (fermat_number n) +2</p>



<a name="266733199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733199">(Jan 03 2022 at 20:29)</a>:</h4>
<p>The formalisation is fine with the subtraction because the Fermat numbers are all &gt;= 3.</p>



<a name="266733410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733410">(Jan 03 2022 at 20:31)</a>:</h4>
<p>I think that the correct way to avoid nat subtraction is not to use nat:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="c1">-- define a Fermat number as an integer</span>
<span class="kd">def</span> <span class="n">fermat_number</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">p</span> <span class="bp">+</span> <span class="mi">1</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="c1">-- prove the recurrence on the Fermat numbers</span>
<span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266733424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733424">(Jan 03 2022 at 20:31)</a>:</h4>
<p>It appears to be true in lean:</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="c1">-- define a fermat number</span>
<span class="kd">def</span> <span class="n">fermat_number</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">^</span><span class="mi">2</span><span class="bp">^</span><span class="n">p</span> <span class="bp">+</span><span class="mi">1</span>

<span class="c1">-- prove the recurrence on the Fermat numbers</span>
<span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">n</span><span class="o">,</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fermat_number</span><span class="o">],</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">nat.succ_eq_add_one</span><span class="o">,</span> <span class="n">finset.prod_range_succ</span><span class="o">,</span> <span class="n">nat.succ_sub_succ_eq_sub</span><span class="o">,</span>
      <span class="n">finset.prod_congr</span><span class="o">,</span> <span class="n">ih</span><span class="o">],</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">,</span> <span class="bp">←</span><span class="n">nat.sq_sub_sq</span><span class="o">,</span> <span class="n">pow_succ'</span> <span class="n">_</span> <span class="n">n</span><span class="o">,</span> <span class="n">pow_mul</span><span class="o">,</span> <span class="n">one_pow</span><span class="o">],</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
</div></div>



<a name="266733742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733742">(Jan 03 2022 at 20:35)</a>:</h4>
<p>The proof is simpler if you use integers.</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="c1">-- define a Fermat number as an integer</span>
<span class="kd">def</span> <span class="n">fermat_number</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">p</span> <span class="bp">+</span> <span class="mi">1</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="c1">-- prove the recurrence on the Fermat numbers</span>
<span class="kd">lemma</span> <span class="n">fermat_recurrence</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">fermat_number</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">fermat_number</span> <span class="n">n</span> <span class="bp">-</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fermat_number</span><span class="o">],</span> <span class="c1">-- replace `fermat_number` by its definition</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span> <span class="c1">-- induction on n</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span> <span class="c1">-- base case is easy</span>
  <span class="o">{</span> <span class="c1">-- inductive step: use prod to n = prod to n-1 * n'th term and inductive hypo,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">finset.prod_range_succ</span><span class="o">,</span> <span class="n">hd</span><span class="o">],</span>
    <span class="c1">-- and then just tidy up</span>
    <span class="n">ring_exp</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
</div></div>



<a name="266733758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733758">(Jan 03 2022 at 20:35)</a>:</h4>
<p>Isn't it always :)</p>



<a name="266733860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/recurrence%20on%20fermat%20numbers/near/266733860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/recurrence.20on.20fermat.20numbers.html#266733860">(Jan 03 2022 at 20:36)</a>:</h4>
<p>Furthermore I would argue that the <em>moment</em> you use subtraction you're saying "I am assuming subtraction makes sense hence I am assuming these things are integers". I would argue that the integer version is a more correct way of translating into Lean the meaning of the original question, as well as being easier to work with.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>