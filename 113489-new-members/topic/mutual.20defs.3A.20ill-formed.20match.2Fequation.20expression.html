---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html">mutual defs: ill-formed match/equation expression</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="204515407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204515407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204515407">(Jul 21 2020 at 06:19)</a>:</h4>
<p>Hmm... I'm sorry that I can't really help you.</p>



<a name="204515412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204515412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204515412">(Jul 21 2020 at 06:19)</a>:</h4>
<p>I don't have experience with mutual defs</p>



<a name="204541612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204541612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204541612">(Jul 21 2020 at 12:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression/near/204514901">said</a>:</p>
<blockquote>
<p>It looks like the issue is that <code>tensor_power</code> appears in the type of <code>add_comm_monoid</code>, not just the definition.</p>
</blockquote>
<p>Yes, I think this means the desugaring would produce a definition which appears in its own type, which is not possible</p>



<a name="204543114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204543114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204543114">(Jul 21 2020 at 12:53)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">Module</span><span class="bp">.</span><span class="n">monoidal</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">category</span><span class="bp">.</span><span class="n">CommRing</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">open</span> <span class="n">category_theory</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">monoidal_category</span> <span class="n">C</span><span class="o">]</span>

<span class="n">def</span> <span class="n">tensor_power</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">:</span> <span class="bp">‚Ñï</span> <span class="bp">‚Üí</span> <span class="n">C</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="mi">ùüô</span><span class="bp">_</span> <span class="n">C</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="n">X</span> <span class="err">‚äó</span> <span class="n">tensor_power</span> <span class="n">n</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="n">CommRing</span><span class="o">}</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">Module</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">Module</span> <span class="n">R</span> <span class="o">:=</span> <span class="n">tensor_power</span> <span class="n">M</span> <span class="mi">17</span>

<span class="c1">-- And if you want to do this with unbundled objects:</span>

<span class="n">universes</span> <span class="n">u</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>

<span class="n">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">tensor_power</span> <span class="o">(</span><span class="n">Module</span><span class="bp">.</span><span class="n">of</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="mi">17</span> <span class="o">:</span> <span class="n">Module</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">foo</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span> <span class="n">delta</span> <span class="n">foo1</span><span class="o">,</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="o">}</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">foo</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span> <span class="n">delta</span> <span class="n">foo1</span><span class="o">,</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="o">}</span>
</code></pre></div>



<a name="204545572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204545572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204545572">(Jul 21 2020 at 13:14)</a>:</h4>
<p>I'm a bit confused by that example. For one, I don't see any import of tensor_product.</p>
<p>My bigger concern is it seems like everything is defined twice, once in <code>category</code> and once not. How should I pick between them? Is there a plan to unify at some later point?</p>



<a name="204548555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204548555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204548555">(Jul 21 2020 at 13:43)</a>:</h4>
<p><code>import algebra.category.Module.monoidal</code> transitively imports <code>linear_algebra.tensor_product</code>. This is defeq to what you want.</p>



<a name="204548591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204548591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204548591">(Jul 21 2020 at 13:43)</a>:</h4>
<p>You're right that there is becoming worrying amounts of duplication, but in fact this isn't part of it.</p>



<a name="204549174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204549174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204549174">(Jul 21 2020 at 13:48)</a>:</h4>
<p>The other worrying part is that I don't know any category theory...</p>



<a name="204555613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204555613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204555613">(Jul 21 2020 at 14:41)</a>:</h4>
<p>But this is a concrete category so you can just think of it as some sort of overlay on top of the stuff you know</p>



<a name="204561887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mutual%20defs%3A%20ill-formed%20match/equation%20expression/near/204561887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Utensil Song <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mutual.20defs.3A.20ill-formed.20match.2Fequation.20expression.html#204561887">(Jul 21 2020 at 15:24)</a>:</h4>
<p>I only know basic category theory (that is, covering about half of the concepts in <a href="https://www.youtube.com/watch?v=1NUc-ZNC_2s">https://www.youtube.com/watch?v=1NUc-ZNC_2s</a> ) but if we only scratch the surface (like using it to define <code>tensor_power</code> ) we'll manage. Plus, category_theory in lean seems to have good automation.</p>
<p>B.T.W. Clifford Algebra can be defined categorically too, see 1.2 in <a href="https://empg.maths.ed.ac.uk/Activities/Spin/Lecture1.pdf">PG course on Spin Geometry - Lecture 1: Clifford algebras: basic notions</a>.</p>
<div class="youtube-video message_inline_image"><a data-id="1NUc-ZNC_2s" href="https://www.youtube.com/watch?v=1NUc-ZNC_2s"><img src="https://i.ytimg.com/vi/1NUc-ZNC_2s/default.jpg"></a></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>